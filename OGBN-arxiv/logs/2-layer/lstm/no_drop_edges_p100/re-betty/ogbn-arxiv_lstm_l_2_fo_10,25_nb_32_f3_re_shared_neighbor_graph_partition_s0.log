[23:24:58] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28961398 edges into 32 parts and get 9130784 edge cuts
main start at this time 1652225073.3237846
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.020601511001586914
global_2_local spend time (sec) 0.044114112854003906
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004599332809448242
A = g.adjacency_matrix() spent  0.020649433135986328
auxiliary_graph
Graph(num_nodes=154710, num_edges=29052339,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.16610217094421387
remove nodes length
63769
auxiliary_graph.remove_nodes spent  1.7140271663665771
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29052339,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.302718162536621

the counter of shared neighbor distribution
Counter({1.0: 23396418, 2.0: 4042542, 3.0: 1009392, 4.0: 305652, 5.0: 111008, 6.0: 48054, 7.0: 22158, 8.0: 11680, 9.0: 5998, 10.0: 3494, 11.0: 1958, 12.0: 1128, 13.0: 668, 14.0: 442, 15.0: 276, 16.0: 212, 17.0: 174, 18.0: 66, 19.0: 58, 20.0: 10, 21.0: 6, 22.0: 4})
28961398
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28961395, 28961396, 28961397])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23396418, 2.0: 4042542, 3.0: 1009392, 4.0: 305652, 5.0: 111008, 6.0: 48054, 7.0: 22158, 8.0: 11680, 9.0: 5998, 10.0: 3494, 11.0: 1958, 12.0: 1128, 13.0: 668, 14.0: 442, 15.0: 276, 16.0: 212, 17.0: 174, 18.0: 66, 19.0: 58, 20.0: 10, 21.0: 6, 22.0: 4})
Convert a graph into a bidirected graph: 2.159 seconds
Metis partitioning: 6.565 seconds
Split the graph: 1.103 seconds
Construct subgraphs: 0.114 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.957438945770264
2805
2839
2899
2878
2819
2759
2907
2927
2889
2911
2899
2771
2879
2901
2922
2885
2779
2759
2918
2773
2764
2874
2910
2927
2765
2758
2867
2758
2760
2758
2923
2758
total k batches seeds list generation spend  22.483338594436646
after graph partition
graph partition algorithm spend time 22.586718797683716
2805
2839
2899
2878
2819
2759
2907
2927
2889
2911
2899
2771
2879
2901
2922
2885
2779
2759
2918
2773
2764
2874
2910
2927
2765
2758
2867
2758
2760
2758
2923
2758
partition_len_list
[6469, 6259, 5900, 6223, 6314, 8310, 7655, 7704, 5535, 5240, 6645, 6950, 5858, 6947, 7101, 5240, 11577, 10054, 8619, 10689, 10189, 6787, 7980, 9306, 15732, 15451, 18377, 16990, 16283, 16526, 17386, 19184]
shared_neighbor_graph_partition_s0 selection method  spend 22.68584132194519
time for parepare:  0.019163846969604492
local_output_nid generation:  0.00048065185546875
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.0011296272277832031
r_  generation:  0.008202552795410156
local_output_nid generation:  0.0006122589111328125
local_in_edges_tensor generation:  0.0006794929504394531
mini_batch_src_global generation:  0.0009553432464599609
r_  generation:  0.007979393005371094
local_output_nid generation:  0.0006811618804931641
local_in_edges_tensor generation:  0.0006906986236572266
mini_batch_src_global generation:  0.0009551048278808594
r_  generation:  0.009495973587036133
local_output_nid generation:  0.0007052421569824219
local_in_edges_tensor generation:  0.0006728172302246094
mini_batch_src_global generation:  0.0008289813995361328
r_  generation:  0.009113311767578125
local_output_nid generation:  0.0006732940673828125
local_in_edges_tensor generation:  0.0006721019744873047
mini_batch_src_global generation:  0.00074005126953125
r_  generation:  0.007775068283081055
local_output_nid generation:  0.0006554126739501953
local_in_edges_tensor generation:  0.0006244182586669922
mini_batch_src_global generation:  0.0007083415985107422
r_  generation:  0.00751805305480957
local_output_nid generation:  0.0012698173522949219
local_in_edges_tensor generation:  0.0006735324859619141
mini_batch_src_global generation:  0.0008747577667236328
r_  generation:  0.009264230728149414
local_output_nid generation:  0.0007045269012451172
local_in_edges_tensor generation:  0.0006883144378662109
mini_batch_src_global generation:  0.0010437965393066406
r_  generation:  0.01013803482055664
local_output_nid generation:  0.0006783008575439453
local_in_edges_tensor generation:  0.0006256103515625
mini_batch_src_global generation:  0.0006780624389648438
r_  generation:  0.006725788116455078
local_output_nid generation:  0.0006518363952636719
local_in_edges_tensor generation:  0.0006213188171386719
mini_batch_src_global generation:  0.0005486011505126953
r_  generation:  0.006142139434814453
local_output_nid generation:  0.0006358623504638672
local_in_edges_tensor generation:  0.0006520748138427734
mini_batch_src_global generation:  0.0007567405700683594
r_  generation:  0.008824586868286133
local_output_nid generation:  0.0005955696105957031
local_in_edges_tensor generation:  0.0006170272827148438
mini_batch_src_global generation:  0.0006871223449707031
r_  generation:  0.0071370601654052734
local_output_nid generation:  0.0005881786346435547
local_in_edges_tensor generation:  0.0006530284881591797
mini_batch_src_global generation:  0.0008165836334228516
r_  generation:  0.008133172988891602
local_output_nid generation:  0.0006043910980224609
local_in_edges_tensor generation:  0.0006854534149169922
mini_batch_src_global generation:  0.0007610321044921875
r_  generation:  0.008593559265136719
local_output_nid generation:  0.0006012916564941406
local_in_edges_tensor generation:  0.0007359981536865234
mini_batch_src_global generation:  0.0007712841033935547
r_  generation:  0.008544445037841797
local_output_nid generation:  0.0005772113800048828
local_in_edges_tensor generation:  0.0006668567657470703
mini_batch_src_global generation:  0.0006823539733886719
r_  generation:  0.007551670074462891
local_output_nid generation:  0.0005428791046142578
local_in_edges_tensor generation:  0.0006353855133056641
mini_batch_src_global generation:  0.0009982585906982422
r_  generation:  0.008477449417114258
local_output_nid generation:  0.0005409717559814453
local_in_edges_tensor generation:  0.0006837844848632812
mini_batch_src_global generation:  0.0006785392761230469
r_  generation:  0.006821393966674805
local_output_nid generation:  0.0005574226379394531
local_in_edges_tensor generation:  0.0007636547088623047
mini_batch_src_global generation:  0.0008661746978759766
r_  generation:  0.0076596736907958984
local_output_nid generation:  0.0005314350128173828
local_in_edges_tensor generation:  0.0006053447723388672
mini_batch_src_global generation:  0.00064849853515625
r_  generation:  0.006797075271606445
local_output_nid generation:  0.0005228519439697266
local_in_edges_tensor generation:  0.0007135868072509766
mini_batch_src_global generation:  0.0007708072662353516
r_  generation:  0.00839996337890625
local_output_nid generation:  0.0005514621734619141
local_in_edges_tensor generation:  0.0006716251373291016
mini_batch_src_global generation:  0.0006506443023681641
r_  generation:  0.0073223114013671875
local_output_nid generation:  0.0005583763122558594
local_in_edges_tensor generation:  0.0006425380706787109
mini_batch_src_global generation:  0.0006763935089111328
r_  generation:  0.0076160430908203125
local_output_nid generation:  0.0005617141723632812
local_in_edges_tensor generation:  0.0006625652313232422
mini_batch_src_global generation:  0.0008516311645507812
r_  generation:  0.009406328201293945
local_output_nid generation:  0.0005447864532470703
local_in_edges_tensor generation:  0.0006735324859619141
mini_batch_src_global generation:  0.0008978843688964844
r_  generation:  0.009358644485473633
local_output_nid generation:  0.0005655288696289062
local_in_edges_tensor generation:  0.005089998245239258
mini_batch_src_global generation:  0.0019805431365966797
r_  generation:  0.013938665390014648
local_output_nid generation:  0.0005986690521240234
local_in_edges_tensor generation:  0.0007774829864501953
mini_batch_src_global generation:  0.001970529556274414
r_  generation:  0.01381373405456543
local_output_nid generation:  0.0005936622619628906
local_in_edges_tensor generation:  0.0006878376007080078
mini_batch_src_global generation:  0.0012180805206298828
r_  generation:  0.0112762451171875
local_output_nid generation:  0.0005998611450195312
local_in_edges_tensor generation:  0.0006756782531738281
mini_batch_src_global generation:  0.001094818115234375
r_  generation:  0.011783123016357422
local_output_nid generation:  0.0006160736083984375
local_in_edges_tensor generation:  0.0007293224334716797
mini_batch_src_global generation:  0.0010869503021240234
r_  generation:  0.011563539505004883
local_output_nid generation:  0.0006582736968994141
local_in_edges_tensor generation:  0.0008826255798339844
mini_batch_src_global generation:  0.0021283626556396484
r_  generation:  0.01657891273498535
local_output_nid generation:  0.0006487369537353516
local_in_edges_tensor generation:  0.0006818771362304688
mini_batch_src_global generation:  0.0013232231140136719
r_  generation:  0.012228250503540039
----------------------check_connections_block total spend ----------------------------- 0.4645671844482422
generate_one_block  0.018152475357055664
generate_one_block  0.012615203857421875
generate_one_block  0.013596057891845703
generate_one_block  0.01309061050415039
generate_one_block  0.011180877685546875
generate_one_block  0.011365175247192383
generate_one_block  0.013387680053710938
generate_one_block  0.014563560485839844
generate_one_block  0.00922703742980957
generate_one_block  0.008812189102172852
generate_one_block  0.012276887893676758
generate_one_block  0.010192155838012695
generate_one_block  0.010967254638671875
generate_one_block  0.011937141418457031
generate_one_block  0.012038707733154297
generate_one_block  0.010166406631469727
generate_one_block  0.01483011245727539
generate_one_block  0.010519742965698242
generate_one_block  0.010920047760009766
generate_one_block  0.010675907135009766
generate_one_block  0.011751174926757812
generate_one_block  0.009905099868774414
generate_one_block  0.011197090148925781
generate_one_block  0.014311790466308594
generate_one_block  0.015340089797973633
generate_one_block  0.019150257110595703
generate_one_block  0.02059006690979004
generate_one_block  0.01782512664794922
generate_one_block  0.01707911491394043
generate_one_block  0.017414093017578125
generate_one_block  0.023235321044921875
generate_one_block  0.019726991653442383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05341029167175293
gen group dst list time:  0.010333776473999023
time for parepare:  0.025728225708007812
local_output_nid generation:  0.0010669231414794922
local_in_edges_tensor generation:  0.013246536254882812
mini_batch_src_global generation:  0.0018224716186523438
r_  generation:  0.018227815628051758
local_output_nid generation:  0.0019559860229492188
local_in_edges_tensor generation:  0.0015552043914794922
mini_batch_src_global generation:  0.0017817020416259766
r_  generation:  0.01660609245300293
local_output_nid generation:  0.0015523433685302734
local_in_edges_tensor generation:  0.0011856555938720703
mini_batch_src_global generation:  0.0012869834899902344
r_  generation:  0.017092466354370117
local_output_nid generation:  0.0013968944549560547
local_in_edges_tensor generation:  0.0011703968048095703
mini_batch_src_global generation:  0.0013430118560791016
r_  generation:  0.01714015007019043
local_output_nid generation:  0.0014235973358154297
local_in_edges_tensor generation:  0.0012247562408447266
mini_batch_src_global generation:  0.001295328140258789
r_  generation:  0.016342878341674805
local_output_nid generation:  0.0016298294067382812
local_in_edges_tensor generation:  0.0015420913696289062
mini_batch_src_global generation:  0.0017595291137695312
r_  generation:  0.02224111557006836
local_output_nid generation:  0.0014798641204833984
local_in_edges_tensor generation:  0.0017480850219726562
mini_batch_src_global generation:  0.0018694400787353516
r_  generation:  0.021515607833862305
local_output_nid generation:  0.001543283462524414
local_in_edges_tensor generation:  0.0016074180603027344
mini_batch_src_global generation:  0.0020751953125
r_  generation:  0.022776126861572266
local_output_nid generation:  0.001194000244140625
local_in_edges_tensor generation:  0.0011227130889892578
mini_batch_src_global generation:  0.0013010501861572266
r_  generation:  0.013492345809936523
local_output_nid generation:  0.0010564327239990234
local_in_edges_tensor generation:  0.002724170684814453
mini_batch_src_global generation:  0.0009944438934326172
r_  generation:  0.010884761810302734
local_output_nid generation:  0.0015010833740234375
local_in_edges_tensor generation:  0.00145721435546875
mini_batch_src_global generation:  0.0013835430145263672
r_  generation:  0.0184938907623291
local_output_nid generation:  0.00162506103515625
local_in_edges_tensor generation:  0.0014681816101074219
mini_batch_src_global generation:  0.0016405582427978516
r_  generation:  0.018059730529785156
local_output_nid generation:  0.0013430118560791016
local_in_edges_tensor generation:  0.0012142658233642578
mini_batch_src_global generation:  0.0012826919555664062
r_  generation:  0.015336990356445312
local_output_nid generation:  0.001424551010131836
local_in_edges_tensor generation:  0.0013267993927001953
mini_batch_src_global generation:  0.0013892650604248047
r_  generation:  0.01836872100830078
local_output_nid generation:  0.0014729499816894531
local_in_edges_tensor generation:  0.001483917236328125
mini_batch_src_global generation:  0.0015914440155029297
r_  generation:  0.019136667251586914
local_output_nid generation:  0.0010647773742675781
local_in_edges_tensor generation:  0.0010287761688232422
mini_batch_src_global generation:  0.0011539459228515625
r_  generation:  0.012106895446777344
local_output_nid generation:  0.0022957324981689453
local_in_edges_tensor generation:  0.003197193145751953
mini_batch_src_global generation:  0.0036554336547851562
r_  generation:  0.03760552406311035
local_output_nid generation:  0.0020971298217773438
local_in_edges_tensor generation:  0.002926349639892578
mini_batch_src_global generation:  0.002958536148071289
r_  generation:  0.029411792755126953
local_output_nid generation:  0.0018780231475830078
local_in_edges_tensor generation:  0.0016798973083496094
mini_batch_src_global generation:  0.0019605159759521484
r_  generation:  0.025229930877685547
local_output_nid generation:  0.002386808395385742
local_in_edges_tensor generation:  0.002183198928833008
mini_batch_src_global generation:  0.002530813217163086
r_  generation:  0.03232884407043457
local_output_nid generation:  0.002239704132080078
local_in_edges_tensor generation:  0.0023310184478759766
mini_batch_src_global generation:  0.0026378631591796875
r_  generation:  0.03151273727416992
local_output_nid generation:  0.0015552043914794922
local_in_edges_tensor generation:  0.0014014244079589844
[23:25:04] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2758 nodes and 750480 edges into 2 parts and get 139222 edge cuts
mini_batch_src_global generation:  0.0017156600952148438
r_  generation:  0.018052339553833008
local_output_nid generation:  0.0017855167388916016
local_in_edges_tensor generation:  0.0015914440155029297
mini_batch_src_global generation:  0.0016262531280517578
r_  generation:  0.02129507064819336
local_output_nid generation:  0.0019409656524658203
local_in_edges_tensor generation:  0.0018215179443359375
mini_batch_src_global generation:  0.0021283626556396484
r_  generation:  0.028641462326049805
local_output_nid generation:  0.0035572052001953125
local_in_edges_tensor generation:  0.005071401596069336
mini_batch_src_global generation:  0.0051229000091552734
r_  generation:  0.05545663833618164
local_output_nid generation:  0.0035028457641601562
local_in_edges_tensor generation:  0.003973245620727539
mini_batch_src_global generation:  0.0059010982513427734
r_  generation:  0.054947853088378906
local_output_nid generation:  0.004146099090576172
local_in_edges_tensor generation:  0.005880832672119141
mini_batch_src_global generation:  0.006597757339477539
r_  generation:  0.06575465202331543
local_output_nid generation:  0.004187583923339844
local_in_edges_tensor generation:  0.004318952560424805
mini_batch_src_global generation:  0.005881309509277344
r_  generation:  0.05947446823120117
local_output_nid generation:  0.004071712493896484
local_in_edges_tensor generation:  0.004370212554931641
mini_batch_src_global generation:  0.005517721176147461
r_  generation:  0.05569720268249512
local_output_nid generation:  0.003945827484130859
local_in_edges_tensor generation:  0.004940509796142578
mini_batch_src_global generation:  0.005433082580566406
r_  generation:  0.05688810348510742
local_output_nid generation:  0.003892660140991211
local_in_edges_tensor generation:  0.0050084590911865234
mini_batch_src_global generation:  0.005930423736572266
r_  generation:  0.061655282974243164
local_output_nid generation:  0.004477262496948242
local_in_edges_tensor generation:  0.007190704345703125
mini_batch_src_global generation:  0.006407022476196289
r_  generation:  0.07008814811706543
----------------------check_connections_block total spend ----------------------------- 1.4609041213989258
generate_one_block  0.025246143341064453
generate_one_block  0.02239537239074707
generate_one_block  0.02237081527709961
generate_one_block  0.022442340850830078
generate_one_block  0.021340370178222656
generate_one_block  0.029958724975585938
generate_one_block  0.028226375579833984
generate_one_block  0.029699325561523438
generate_one_block  0.01654219627380371
generate_one_block  0.013540983200073242
generate_one_block  0.025530576705932617
generate_one_block  0.030677318572998047
generate_one_block  0.020004987716674805
generate_one_block  0.024317264556884766
generate_one_block  0.025133848190307617
generate_one_block  0.016098499298095703
generate_one_block  0.05067086219787598
generate_one_block  0.03960442543029785
generate_one_block  0.031186580657958984
generate_one_block  0.04540419578552246
generate_one_block  0.04040098190307617
generate_one_block  0.024536848068237305
generate_one_block  0.027662992477416992
generate_one_block  0.036176204681396484
generate_one_block  0.0694570541381836
generate_one_block  0.07189464569091797
generate_one_block  0.0853114128112793
generate_one_block  0.0783395767211914
generate_one_block  0.0740504264831543
generate_one_block  0.07527923583984375
generate_one_block  0.08195877075195312
generate_one_block  0.10692667961120605
global_2_local spend time (sec) 0.0037126541137695312
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007386207580566406
A = g.adjacency_matrix() spent  0.0006082057952880859
auxiliary_graph
Graph(num_nodes=19184, num_edges=753238,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.01255941390991211
remove nodes length
16426
auxiliary_graph.remove_nodes spent  0.02587103843688965
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2758, num_edges=753238,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.024021148681640625

the counter of shared neighbor distribution
Counter({1.0: 607630, 2.0: 109890, 3.0: 24154, 4.0: 5978, 5.0: 1794, 6.0: 658, 7.0: 228, 8.0: 90, 9.0: 26, 10.0: 16, 11.0: 8, 15.0: 2, 14.0: 2, 16.0: 2, 13.0: 2})
750480
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 750477, 750478, 750479])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 607630, 2.0: 109890, 3.0: 24154, 4.0: 5978, 5.0: 1794, 6.0: 658, 7.0: 228, 8.0: 90, 9.0: 26, 10.0: 16, 11.0: 8, 15.0: 2, 14.0: 2, 16.0: 2, 13.0: 2})
Convert a graph into a bidirected graph: 0.023 seconds
Metis partitioning: 0.059 seconds
Split the graph: 0.092 seconds
Construct subgraphs: 0.029 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.20195746421813965
1359
1399
total k batches seeds list generation spend  0.5376443862915039
after graph partition
graph partition algorithm spend time 0.5738308429718018
1359
1399
time for parepare:  0.02137279510498047
local_output_nid generation:  0.00022172927856445312
local_in_edges_tensor generation:  0.0007402896881103516
mini_batch_src_global generation:  0.0007622241973876953
r_  generation:  0.005204677581787109
local_output_nid generation:  0.0002231597900390625
local_in_edges_tensor generation:  0.0005254745483398438
mini_batch_src_global generation:  0.0009272098541259766
r_  generation:  0.006825923919677734
----------------------check_connections_block total spend ----------------------------- 0.04285621643066406
generate_one_block  0.009866714477539062
generate_one_block  0.011078596115112305
time for parepare:  0.020117759704589844
local_output_nid generation:  0.0015501976013183594
local_in_edges_tensor generation:  0.003978252410888672
mini_batch_src_global generation:  0.007760763168334961
r_  generation:  0.03600788116455078
local_output_nid generation:  0.002810239791870117
local_in_edges_tensor generation:  0.0035943984985351562
mini_batch_src_global generation:  0.008862018585205078
r_  generation:  0.044026851654052734
----------------------check_connections_block total spend ----------------------------- 0.15625214576721191
generate_one_block  0.049736976623535156
generate_one_block  0.060506343841552734
----------===============-------------===============-------------the number of batches *****---- 33

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.4609041213989258
block generation total time  1.3123860359191895
average batch blocks generation time:  0.04101206362247467
pseudo mini batch 0 input nodes size: 16561
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8427734375 GB
    Memory Allocated: 0.010674476623535156  GigaBytes
Max Memory Allocated: 0.010674476623535156  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8427734375 GB
    Memory Allocated: 0.010695457458496094  GigaBytes
Max Memory Allocated: 0.010695457458496094  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8427734375 GB
    Memory Allocated: 0.010695457458496094  GigaBytes
Max Memory Allocated: 0.010695457458496094  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8916015625 GB
    Memory Allocated: 0.011180877685546875  GigaBytes
Max Memory Allocated: 0.011180877685546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8916015625 GB
    Memory Allocated: 0.011180877685546875  GigaBytes
Max Memory Allocated: 0.011180877685546875  GigaBytes

first layer input nodes number: 16561
first layer output nodes number: 6469
edges number: 43439
input nodes number: 6469
output nodes number: 2805
edges number: 21581
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6689453125 GB
    Memory Allocated: 0.6801838874816895  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6689453125 GB
    Memory Allocated: 0.6801848411560059  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.015322685241699219  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

pseudo mini batch 1 input nodes size: 15659
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013889789581298828  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013889789581298828  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.021356582641601562  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.021378040313720703  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013460159301757812  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013909339904785156  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013909339904785156  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

first layer input nodes number: 15659
first layer output nodes number: 6259
edges number: 39631
input nodes number: 6259
output nodes number: 2839
edges number: 20584
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.6394400596618652  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.6394405364990234  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.014806747436523438  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

pseudo mini batch 2 input nodes size: 12510
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013465404510498047  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013465404510498047  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.01943063735961914  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.019452571868896484  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.01196432113647461  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.012466907501220703  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.012466907501220703  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

first layer input nodes number: 12510
first layer output nodes number: 5900
edges number: 41738
input nodes number: 5900
output nodes number: 2899
edges number: 25575
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7978515625 GB
    Memory Allocated: 0.7262825965881348  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7978515625 GB
    Memory Allocated: 0.726283073425293  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013428688049316406  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

pseudo mini batch 3 input nodes size: 13679
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.011972904205322266  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.011972904205322266  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.018495559692382812  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.018517017364501953  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.012529850006103516  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013020992279052734  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013020992279052734  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

first layer input nodes number: 13679
first layer output nodes number: 6223
edges number: 41476
input nodes number: 6223
output nodes number: 2878
edges number: 24297
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.7064943313598633  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.7064948081970215  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013965129852294922  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

pseudo mini batch 4 input nodes size: 14079
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.012526988983154297  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.012526988983154297  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.019570350646972656  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.019591808319091797  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.01304769515991211  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013483524322509766  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013483524322509766  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

first layer input nodes number: 14079
first layer output nodes number: 6314
edges number: 38437
input nodes number: 6314
output nodes number: 2819
edges number: 19916
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.6279087066650391  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.6279091835021973  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.014338493347167969  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

pseudo mini batch 5 input nodes size: 21204
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.01303863525390625  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.01303863525390625  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.023149490356445312  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.02317047119140625  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.01610565185546875  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.0166473388671875  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.0166473388671875  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

first layer input nodes number: 21204
first layer output nodes number: 8310
edges number: 53430
input nodes number: 8310
output nodes number: 2759
edges number: 19130
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.7304835319519043  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.7304840087890625  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.017699241638183594  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

pseudo mini batch 6 input nodes size: 15529
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.016097068786621094  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.016097068786621094  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.023501873016357422  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.023523807525634766  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.013391971588134766  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.013967037200927734  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.013967037200927734  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

first layer input nodes number: 15529
first layer output nodes number: 7655
edges number: 52493
input nodes number: 7655
output nodes number: 2907
edges number: 24506
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.7975063323974609  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.7975068092346191  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.015067577362060547  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

pseudo mini batch 7 input nodes size: 15838
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.01341390609741211  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.01341390609741211  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.020966053009033203  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.020987987518310547  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.013561248779296875  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.014185905456542969  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.014185905456542969  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

first layer input nodes number: 15838
first layer output nodes number: 7704
edges number: 56645
input nodes number: 7704
output nodes number: 2927
edges number: 27115
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.864346981048584  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.8643474578857422  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015340328216552734  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 8 input nodes size: 11298
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013564109802246094  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013564109802246094  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.018951416015625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.018973350524902344  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011399269104003906  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011734962463378906  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011734962463378906  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 11298
first layer output nodes number: 5535
edges number: 28789
input nodes number: 5535
output nodes number: 2889
edges number: 16216
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.49480724334716797  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.49480772018432617  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01242828369140625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 9 input nodes size: 9176
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011393547058105469  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011393547058105469  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015769004821777344  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015790939331054688  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010381698608398438  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010671615600585938  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010671615600585938  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 9176
first layer output nodes number: 5240
edges number: 24369
input nodes number: 5240
output nodes number: 2911
edges number: 14374
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.4329051971435547  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.4329056739807129  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01129150390625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 10 input nodes size: 16213
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01038503646850586  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01038503646850586  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.018115997314453125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01813793182373047  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01374053955078125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014247894287109375  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014247894287109375  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 16213
first layer output nodes number: 6645
edges number: 44877
input nodes number: 6645
output nodes number: 2899
edges number: 23163
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.720606803894043  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.7206072807312012  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015228748321533203  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 11 input nodes size: 17788
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013738632202148438  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013738632202148438  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.022220611572265625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.022241592407226562  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014488697052001953  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01493692398071289  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01493692398071289  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 17788
first layer output nodes number: 6950
edges number: 42131
input nodes number: 6950
output nodes number: 2771
edges number: 17890
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6288037300109863  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6288042068481445  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015820026397705078  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 12 input nodes size: 11722
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014469623565673828  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014469623565673828  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.02005910873413086  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.02008056640625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011577606201171875  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011993408203125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011993408203125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 11722
first layer output nodes number: 5858
edges number: 35246
input nodes number: 5858
output nodes number: 2879
edges number: 20396
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6017436981201172  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6017441749572754  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.012829780578613281  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 13 input nodes size: 15873
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011593818664550781  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011593818664550781  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.019162654876708984  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.019184589385986328  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013573646545410156  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014063835144042969  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014063835144042969  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 15873
first layer output nodes number: 6947
edges number: 43630
input nodes number: 6947
output nodes number: 2901
edges number: 22143
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6966118812561035  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6966123580932617  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015030384063720703  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 14 input nodes size: 15944
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013576984405517578  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013576984405517578  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.021179676055908203  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.021201610565185547  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01361083984375  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.0141143798828125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.0141143798828125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 15944
first layer output nodes number: 7101
edges number: 45506
input nodes number: 7101
output nodes number: 2922
edges number: 21999
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.7063660621643066  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.7063665390014648  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015096664428710938  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 15 input nodes size: 10316
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013614177703857422  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013614177703857422  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01853322982788086  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.018555164337158203  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010930538177490234  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01128530502319336  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01128530502319336  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 10316
first layer output nodes number: 5240
edges number: 28668
input nodes number: 5240
output nodes number: 2885
edges number: 18851
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.5271744728088379  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.5271749496459961  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.012002944946289062  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 16 input nodes size: 30634
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010924816131591797  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010924816131591797  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.025532245635986328  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.025553226470947266  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.020612239837646484  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.021445751190185547  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.021445751190185547  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 30634
first layer output nodes number: 11577
edges number: 89201
input nodes number: 11577
output nodes number: 2779
edges number: 22573
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2001953125 GB
    Memory Allocated: 1.0678153038024902  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2001953125 GB
    Memory Allocated: 1.0678157806396484  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.022951602935791016  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 17 input nodes size: 31373
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02059650421142578  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02059650421142578  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03555631637573242  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03557729721069336  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02094888687133789  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021593570709228516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021593570709228516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 31373
first layer output nodes number: 10054
edges number: 69544
input nodes number: 10054
output nodes number: 2759
edges number: 16816
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8363094329833984  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8363099098205566  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02285289764404297  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 18 input nodes size: 24855
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.020946025848388672  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.020946025848388672  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.032797813415527344  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03281974792480469  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01783895492553711  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01839303970336914  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01839303970336914  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 24855
first layer output nodes number: 8619
edges number: 55706
input nodes number: 8619
output nodes number: 2918
edges number: 18484
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.7460761070251465  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.7460765838623047  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01952075958251953  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 19 input nodes size: 36375
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017862319946289062  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017862319946289062  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.035207271575927734  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03522825241088867  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.023354530334472656  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.024039268493652344  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.024039268493652344  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 36375
first layer output nodes number: 10689
edges number: 74816
input nodes number: 10689
output nodes number: 2773
edges number: 16964
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.874547004699707  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8745474815368652  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02537250518798828  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 20 input nodes size: 31511
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.023333072662353516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.023333072662353516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03835868835449219  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.038379669189453125  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021013736724853516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021692752838134766  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021692752838134766  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 31511
first layer output nodes number: 10189
edges number: 71342
input nodes number: 10189
output nodes number: 2764
edges number: 19611
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8822736740112305  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8822741508483887  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.023012638092041016  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 21 input nodes size: 17552
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021012306213378906  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021012306213378906  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.029381752014160156  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.029403209686279297  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014356613159179688  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014787673950195312  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014787673950195312  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 17552
first layer output nodes number: 6787
edges number: 40472
input nodes number: 6787
output nodes number: 2874
edges number: 17189
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.6029801368713379  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.6029806137084961  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01568126678466797  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 22 input nodes size: 20538
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014373302459716797  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014373302459716797  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.024166584014892578  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.024188518524169922  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01579761505126953  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01630878448486328  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01630878448486328  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 20538
first layer output nodes number: 7980
edges number: 49486
input nodes number: 7980
output nodes number: 2910
edges number: 18953
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.6984906196594238  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.698491096496582  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01733255386352539  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 23 input nodes size: 25001
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.015802860260009766  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.015802860260009766  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.027724266052246094  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.027746200561523438  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017930984497070312  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.018609046936035156  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.018609046936035156  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 25001
first layer output nodes number: 9306
edges number: 66277
input nodes number: 9306
output nodes number: 2927
edges number: 24657
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.9246153831481934  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.9246158599853516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.019901752471923828  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 24 input nodes size: 47069
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017933368682861328  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017933368682861328  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.04037761688232422  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.040398597717285156  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.028455257415771484  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02958059310913086  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02958059310913086  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 47069
first layer output nodes number: 15732
edges number: 126548
input nodes number: 15732
output nodes number: 2765
edges number: 24413
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5615234375 GB
    Memory Allocated: 1.3943395614624023  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.5615234375 GB
    Memory Allocated: 1.3943400382995605  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.031598567962646484  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

pseudo mini batch 25 input nodes size: 38514
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.028431415557861328  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.028431415557861328  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.046796321868896484  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.04681730270385742  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.024352073669433594  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.025583267211914062  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.025583267211914062  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

first layer input nodes number: 38514
first layer output nodes number: 15451
edges number: 131734
input nodes number: 15451
output nodes number: 2758
edges number: 33286
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8955078125 GB
    Memory Allocated: 1.5514216423034668  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8955078125 GB
    Memory Allocated: 1.551422119140625  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.02772665023803711  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

pseudo mini batch 26 input nodes size: 47388
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.024350643157958984  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.024350643157958984  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.047788143157958984  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.047809600830078125  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.02942371368408203  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.03084564208984375  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.03084564208984375  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

first layer input nodes number: 47388
first layer output nodes number: 18377
edges number: 157161
input nodes number: 18377
output nodes number: 2867
edges number: 33553
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.7585396766662598  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.758540153503418  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.03333234786987305  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

pseudo mini batch 27 input nodes size: 46552
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.029439926147460938  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.029439926147460938  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.05163764953613281  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.05165863037109375  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02819967269897461  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.029480457305908203  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.029480457305908203  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

first layer input nodes number: 46552
first layer output nodes number: 16990
edges number: 142989
input nodes number: 16990
output nodes number: 2758
edges number: 28687
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.5803513526916504  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.5803518295288086  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.03171873092651367  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

pseudo mini batch 28 input nodes size: 43098
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.028183460235595703  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.028183460235595703  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.0496678352355957  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.04968881607055664  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.027470111846923828  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.028707027435302734  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.028707027435302734  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

first layer input nodes number: 43098
first layer output nodes number: 16283
edges number: 137201
input nodes number: 16283
output nodes number: 2760
edges number: 28692
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.5267534255981445  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.5267539024353027  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.030877113342285156  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

pseudo mini batch 29 input nodes size: 42852
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02747058868408203  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02747058868408203  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.047904014587402344  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.04792499542236328  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.026419639587402344  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.027681350708007812  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.027681350708007812  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

first layer input nodes number: 42852
first layer output nodes number: 16526
edges number: 139956
input nodes number: 16526
output nodes number: 2758
edges number: 29296
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.567251205444336  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.5672516822814941  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02988290786743164  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

pseudo mini batch 30 input nodes size: 38575
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02641916275024414  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02641916275024414  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.04481315612792969  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.04483509063720703  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02438068389892578  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.0258331298828125  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.0258331298828125  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

first layer input nodes number: 38575
first layer output nodes number: 17386
edges number: 154209
input nodes number: 17386
output nodes number: 2923
edges number: 40625
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8994140625 GB
    Memory Allocated: 1.8185510635375977  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8994140625 GB
    Memory Allocated: 1.8185515403747559  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02832317352294922  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 31 input nodes size: 33377
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.024405479431152344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.024405479431152344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.04032087326049805  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.040331363677978516  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.021915435791015625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02268218994140625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02268218994140625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 33377
first layer output nodes number: 10230
edges number: 88158
input nodes number: 10230
output nodes number: 1359
edges number: 14642
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.9397716522216797  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.9397721290588379  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.0238189697265625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 32 input nodes size: 35870
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.021682262420654297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.021682262420654297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03878641128540039  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03879690170288086  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.022871017456054688  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.023777008056640625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.023777008056640625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 35870
first layer output nodes number: 11580
edges number: 103417
input nodes number: 11580
output nodes number: 1399
edges number: 18073
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 1.111220359802246  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 1.1112208366394043  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025367259979248047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.030917644500732422  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes
[23:25:36] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 29070896 edges into 32 parts and get 9209378 edge cuts

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.030917644500732422  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00878792820554791 |0.013877919225981741 |0.14913458535165497 |0.00013824665185176966 |0.1271022160847982 |0.009347677230834961 |
----------------------------------------------------------pseudo_mini_loss sum 5.297268867492676
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1142629
Number of first layer input nodes during this epoch:  824523
Number of first layer output nodes during this epoch:  318106
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03091716766357422  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022260665893554688
global_2_local spend time (sec) 0.048156023025512695
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0043659210205078125
A = g.adjacency_matrix() spent  0.006325960159301758
auxiliary_graph
Graph(num_nodes=154609, num_edges=29161837,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.174285888671875
remove nodes length
63668
auxiliary_graph.remove_nodes spent  1.9468066692352295
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29161837,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2426164150238037

the counter of shared neighbor distribution
Counter({1.0: 23512832, 2.0: 4033528, 3.0: 1010720, 4.0: 307066, 5.0: 110996, 6.0: 47742, 7.0: 21964, 8.0: 11366, 9.0: 6212, 10.0: 3480, 11.0: 1996, 12.0: 1116, 13.0: 654, 14.0: 456, 15.0: 268, 16.0: 194, 17.0: 166, 18.0: 66, 19.0: 50, 20.0: 18, 21.0: 6})
29070896
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 29070893, 29070894, 29070895])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23512832, 2.0: 4033528, 3.0: 1010720, 4.0: 307066, 5.0: 110996, 6.0: 47742, 7.0: 21964, 8.0: 11366, 9.0: 6212, 10.0: 3480, 11.0: 1996, 12.0: 1116, 13.0: 654, 14.0: 456, 15.0: 268, 16.0: 194, 17.0: 166, 18.0: 66, 19.0: 50, 20.0: 18, 21.0: 6})
Convert a graph into a bidirected graph: 2.111 seconds
Metis partitioning: 6.680 seconds
Split the graph: 0.880 seconds
Construct subgraphs: 0.135 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.820100545883179
2904
2911
2880
2875
2907
2888
2903
2886
2927
2778
2760
2927
2875
2844
2927
2762
2760
2927
2915
2893
2758
2788
2767
2790
2778
2884
2777
2764
2758
2758
2758
2912
total k batches seeds list generation spend  22.511813402175903
after graph partition
graph partition algorithm spend time 22.617719411849976
2904
2911
2880
2875
2907
2888
2903
2886
2927
2778
2760
2927
2875
2844
2927
2762
2760
2927
2915
2893
2758
2788
2767
2790
2778
2884
2777
2764
2758
2758
2758
2912
partition_len_list
[5663, 7073, 6704, 6122, 5432, 5391, 7167, 6815, 7497, 6665, 8334, 7621, 6214, 5977, 6292, 7091, 8011, 9208, 7702, 8107, 15237, 9867, 12101, 9188, 18622, 18431, 13549, 13813, 16316, 17382, 16027, 17243]
shared_neighbor_graph_partition_s0 selection method  spend 22.729017972946167
time for parepare:  0.021521568298339844
local_output_nid generation:  0.0006251335144042969
local_in_edges_tensor generation:  0.0009763240814208984
mini_batch_src_global generation:  0.0009579658508300781
r_  generation:  0.008162498474121094
local_output_nid generation:  0.0007331371307373047
local_in_edges_tensor generation:  0.0008497238159179688
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.009928226470947266
local_output_nid generation:  0.0007693767547607422
local_in_edges_tensor generation:  0.0008063316345214844
mini_batch_src_global generation:  0.0009944438934326172
r_  generation:  0.00945734977722168
local_output_nid generation:  0.0008127689361572266
local_in_edges_tensor generation:  0.0007734298706054688
mini_batch_src_global generation:  0.0008313655853271484
r_  generation:  0.0073816776275634766
local_output_nid generation:  0.0008130073547363281
local_in_edges_tensor generation:  0.0007374286651611328
mini_batch_src_global generation:  0.0006539821624755859
r_  generation:  0.007406473159790039
local_output_nid generation:  0.0007798671722412109
local_in_edges_tensor generation:  0.0007941722869873047
mini_batch_src_global generation:  0.0006067752838134766
r_  generation:  0.0068356990814208984
local_output_nid generation:  0.0007681846618652344
local_in_edges_tensor generation:  0.0007541179656982422
mini_batch_src_global generation:  0.0008630752563476562
r_  generation:  0.00981760025024414
local_output_nid generation:  0.0007486343383789062
local_in_edges_tensor generation:  0.0007338523864746094
mini_batch_src_global generation:  0.0009741783142089844
r_  generation:  0.009753227233886719
local_output_nid generation:  0.0007431507110595703
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.0009903907775878906
r_  generation:  0.01103520393371582
local_output_nid generation:  0.0007014274597167969
local_in_edges_tensor generation:  0.0007333755493164062
mini_batch_src_global generation:  0.001028299331665039
r_  generation:  0.010308980941772461
local_output_nid generation:  0.0006868839263916016
local_in_edges_tensor generation:  0.0007722377777099609
mini_batch_src_global generation:  0.0008568763732910156
r_  generation:  0.008884906768798828
local_output_nid generation:  0.0007293224334716797
local_in_edges_tensor generation:  0.0007421970367431641
mini_batch_src_global generation:  0.0009868144989013672
r_  generation:  0.011146068572998047
local_output_nid generation:  0.0007281303405761719
local_in_edges_tensor generation:  0.0007326602935791016
mini_batch_src_global generation:  0.0009784698486328125
r_  generation:  0.009845733642578125
local_output_nid generation:  0.0007078647613525391
local_in_edges_tensor generation:  0.000705718994140625
mini_batch_src_global generation:  0.0007340908050537109
r_  generation:  0.007410287857055664
local_output_nid generation:  0.0007250308990478516
local_in_edges_tensor generation:  0.0007331371307373047
mini_batch_src_global generation:  0.0008826255798339844
r_  generation:  0.010781288146972656
local_output_nid generation:  0.0006811618804931641
local_in_edges_tensor generation:  0.0007402896881103516
mini_batch_src_global generation:  0.0008232593536376953
r_  generation:  0.00869894027709961
local_output_nid generation:  0.0006744861602783203
local_in_edges_tensor generation:  0.0006902217864990234
mini_batch_src_global generation:  0.0007407665252685547
r_  generation:  0.00787806510925293
local_output_nid generation:  0.0007281303405761719
local_in_edges_tensor generation:  0.0007352828979492188
mini_batch_src_global generation:  0.0009710788726806641
r_  generation:  0.011177778244018555
local_output_nid generation:  0.0007185935974121094
local_in_edges_tensor generation:  0.0007052421569824219
mini_batch_src_global generation:  0.0008177757263183594
r_  generation:  0.008343219757080078
local_output_nid generation:  0.0007140636444091797
local_in_edges_tensor generation:  0.0006988048553466797
mini_batch_src_global generation:  0.0008115768432617188
r_  generation:  0.008816719055175781
local_output_nid generation:  0.0006768703460693359
local_in_edges_tensor generation:  0.0007455348968505859
mini_batch_src_global generation:  0.0017139911651611328
r_  generation:  0.0147705078125
local_output_nid generation:  0.0007157325744628906
local_in_edges_tensor generation:  0.0007371902465820312
mini_batch_src_global generation:  0.0008776187896728516
r_  generation:  0.00763702392578125
local_output_nid generation:  0.000705718994140625
local_in_edges_tensor generation:  0.0007359981536865234
mini_batch_src_global generation:  0.0009655952453613281
r_  generation:  0.01029658317565918
local_output_nid generation:  0.0007278919219970703
local_in_edges_tensor generation:  0.0007343292236328125
mini_batch_src_global generation:  0.0007874965667724609
r_  generation:  0.007956981658935547
local_output_nid generation:  0.0007300376892089844
local_in_edges_tensor generation:  0.000759124755859375
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.012406110763549805
local_output_nid generation:  0.0007662773132324219
local_in_edges_tensor generation:  0.0007812976837158203
mini_batch_src_global generation:  0.0013821125030517578
r_  generation:  0.012977123260498047
local_output_nid generation:  0.0007607936859130859
local_in_edges_tensor generation:  0.0007801055908203125
mini_batch_src_global generation:  0.0009484291076660156
r_  generation:  0.009433984756469727
local_output_nid generation:  0.0007677078247070312
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.0009789466857910156
r_  generation:  0.011236190795898438
local_output_nid generation:  0.0007500648498535156
local_in_edges_tensor generation:  0.0007688999176025391
mini_batch_src_global generation:  0.0011103153228759766
r_  generation:  0.012136220932006836
local_output_nid generation:  0.0007579326629638672
local_in_edges_tensor generation:  0.0007736682891845703
mini_batch_src_global generation:  0.0011451244354248047
r_  generation:  0.012387752532958984
local_output_nid generation:  0.0007650852203369141
local_in_edges_tensor generation:  0.0008041858673095703
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.012425422668457031
local_output_nid generation:  0.0008077621459960938
local_in_edges_tensor generation:  0.0007967948913574219
mini_batch_src_global generation:  0.0020117759704589844
r_  generation:  0.017137527465820312
----------------------check_connections_block total spend ----------------------------- 0.5058519840240479
generate_one_block  0.018299341201782227
generate_one_block  0.016133546829223633
generate_one_block  0.014249086380004883
generate_one_block  0.010635614395141602
generate_one_block  0.010398387908935547
generate_one_block  0.009681463241577148
generate_one_block  0.014348983764648438
generate_one_block  0.013809919357299805
generate_one_block  0.016086578369140625
generate_one_block  0.014723777770996094
generate_one_block  0.013387441635131836
generate_one_block  0.016071796417236328
generate_one_block  0.013746023178100586
generate_one_block  0.012751102447509766
generate_one_block  0.018718242645263672
generate_one_block  0.013929367065429688
generate_one_block  0.016293048858642578
generate_one_block  0.017509937286376953
generate_one_block  0.012250185012817383
generate_one_block  0.012862682342529297
generate_one_block  0.02218031883239746
generate_one_block  0.012289762496948242
generate_one_block  0.015463590621948242
generate_one_block  0.011891841888427734
generate_one_block  0.02077937126159668
generate_one_block  0.022082805633544922
generate_one_block  0.01636981964111328
generate_one_block  0.016892433166503906
generate_one_block  0.019472599029541016
generate_one_block  0.019362211227416992
generate_one_block  0.01932525634765625
generate_one_block  0.024890422821044922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03938150405883789
gen group dst list time:  0.01139211654663086
time for parepare:  0.027192354202270508
local_output_nid generation:  0.0011734962463378906
local_in_edges_tensor generation:  0.009580135345458984
mini_batch_src_global generation:  0.0021331310272216797
r_  generation:  0.014582395553588867
local_output_nid generation:  0.002360105514526367
local_in_edges_tensor generation:  0.0014786720275878906
mini_batch_src_global generation:  0.002794027328491211
r_  generation:  0.021127939224243164
local_output_nid generation:  0.0018243789672851562
local_in_edges_tensor generation:  0.0014574527740478516
mini_batch_src_global generation:  0.0023796558380126953
r_  generation:  0.019034862518310547
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0013012886047363281
mini_batch_src_global generation:  0.001867055892944336
r_  generation:  0.01601719856262207
local_output_nid generation:  0.0012657642364501953
local_in_edges_tensor generation:  0.0013222694396972656
mini_batch_src_global generation:  0.0010535717010498047
r_  generation:  0.01205897331237793
local_output_nid generation:  0.001207113265991211
local_in_edges_tensor generation:  0.0010921955108642578
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.011589527130126953
local_output_nid generation:  0.0015630722045898438
local_in_edges_tensor generation:  0.00153350830078125
mini_batch_src_global generation:  0.002201557159423828
r_  generation:  0.020835399627685547
local_output_nid generation:  0.0014138221740722656
local_in_edges_tensor generation:  0.0014119148254394531
mini_batch_src_global generation:  0.0024657249450683594
r_  generation:  0.01983642578125
local_output_nid generation:  0.00312042236328125
local_in_edges_tensor generation:  0.0015692710876464844
mini_batch_src_global generation:  0.002574920654296875
r_  generation:  0.022442340850830078
local_output_nid generation:  0.0014789104461669922
local_in_edges_tensor generation:  0.0013580322265625
mini_batch_src_global generation:  0.0024437904357910156
r_  generation:  0.018484830856323242
local_output_nid generation:  0.001779317855834961
local_in_edges_tensor generation:  0.001631021499633789
mini_batch_src_global generation:  0.00653076171875
r_  generation:  0.024652957916259766
local_output_nid generation:  0.001491546630859375
local_in_edges_tensor generation:  0.0017762184143066406
mini_batch_src_global generation:  0.002818584442138672
r_  generation:  0.02361774444580078
local_output_nid generation:  0.0013663768768310547
local_in_edges_tensor generation:  0.0012853145599365234
mini_batch_src_global generation:  0.0023338794708251953
r_  generation:  0.042973995208740234
local_output_nid generation:  0.0027265548706054688
local_in_edges_tensor generation:  0.003242015838623047
mini_batch_src_global generation:  0.00323486328125
r_  generation:  0.029512643814086914
local_output_nid generation:  0.0023658275604248047
local_in_edges_tensor generation:  0.0022706985473632812
mini_batch_src_global generation:  0.003335237503051758
r_  generation:  0.03151130676269531
local_output_nid generation:  0.001986980438232422
local_in_edges_tensor generation:  0.002102375030517578
mini_batch_src_global generation:  0.0031125545501708984
r_  generation:  0.029162168502807617
local_output_nid generation:  0.002138853073120117
local_in_edges_tensor generation:  0.0023391246795654297
mini_batch_src_global generation:  0.0028831958770751953
r_  generation:  0.0248110294342041
local_output_nid generation:  0.0021636486053466797
local_in_edges_tensor generation:  0.002331972122192383
mini_batch_src_global generation:  0.0034754276275634766
r_  generation:  0.029714107513427734
local_output_nid generation:  0.0019116401672363281
local_in_edges_tensor generation:  0.0017154216766357422
mini_batch_src_global generation:  0.0026731491088867188
r_  generation:  0.021433115005493164
local_output_nid generation:  0.0018723011016845703
local_in_edges_tensor generation:  0.001664876937866211
mini_batch_src_global generation:  0.002633333206176758
r_  generation:  0.02307915687561035
local_output_nid generation:  0.003468036651611328
local_in_edges_tensor generation:  0.0039310455322265625
mini_batch_src_global generation:  0.005503177642822266
r_  generation:  0.05312633514404297
local_output_nid generation:  0.002588510513305664
local_in_edges_tensor generation:  0.003103971481323242
mini_batch_src_global generation:  0.003957509994506836
r_  generation:  0.03004288673400879
local_output_nid generation:  0.0029833316802978516
local_in_edges_tensor generation: [23:25:42] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2778 nodes and 298084 edges into 2 parts and get 42833 edge cuts
 0.002686738967895508
mini_batch_src_global generation:  0.004332780838012695
r_  generation:  0.040506601333618164
local_output_nid generation:  0.00226593017578125
local_in_edges_tensor generation:  0.002179861068725586
mini_batch_src_global generation:  0.003354310989379883
r_  generation:  0.028280258178710938
local_output_nid generation:  0.004523515701293945
local_in_edges_tensor generation:  0.00612330436706543
mini_batch_src_global generation:  0.006429433822631836
r_  generation:  0.07091522216796875
local_output_nid generation:  0.0047397613525390625
local_in_edges_tensor generation:  0.004931211471557617
mini_batch_src_global generation:  0.007387399673461914
r_  generation:  0.0670008659362793
local_output_nid generation:  0.0038497447967529297
local_in_edges_tensor generation:  0.0037076473236083984
mini_batch_src_global generation:  0.0050907135009765625
r_  generation:  0.04526925086975098
local_output_nid generation:  0.0036067962646484375
local_in_edges_tensor generation:  0.003478527069091797
mini_batch_src_global generation:  0.004512786865234375
r_  generation:  0.04781627655029297
local_output_nid generation:  0.004156351089477539
local_in_edges_tensor generation:  0.00388336181640625
mini_batch_src_global generation:  0.0052242279052734375
r_  generation:  0.05769538879394531
local_output_nid generation:  0.004415035247802734
local_in_edges_tensor generation:  0.0047113895416259766
mini_batch_src_global generation:  0.006583213806152344
r_  generation:  0.12623214721679688
local_output_nid generation:  0.007504463195800781
local_in_edges_tensor generation:  0.00760650634765625
mini_batch_src_global generation:  0.011670351028442383
r_  generation:  0.09438347816467285
local_output_nid generation:  0.005825519561767578
local_in_edges_tensor generation:  0.005213022232055664
mini_batch_src_global generation:  0.006699085235595703
r_  generation:  0.06658339500427246
----------------------check_connections_block total spend ----------------------------- 1.7616760730743408
generate_one_block  0.0200808048248291
generate_one_block  0.03527998924255371
generate_one_block  0.02596592903137207
generate_one_block  0.020071029663085938
generate_one_block  0.016490936279296875
generate_one_block  0.015481948852539062
generate_one_block  0.02722930908203125
generate_one_block  0.025634050369262695
generate_one_block  0.02931833267211914
generate_one_block  0.024924516677856445
generate_one_block  0.032208919525146484
generate_one_block  0.03036212921142578
generate_one_block  0.023202180862426758
generate_one_block  0.01888442039489746
generate_one_block  0.024003982543945312
generate_one_block  0.02855968475341797
generate_one_block  0.03133749961853027
generate_one_block  0.03913307189941406
generate_one_block  0.027330398559570312
generate_one_block  0.030275821685791016
generate_one_block  0.07627248764038086
generate_one_block  0.04164934158325195
generate_one_block  0.05400514602661133
generate_one_block  0.03606986999511719
generate_one_block  0.09288382530212402
generate_one_block  0.0907285213470459
generate_one_block  0.06210660934448242
generate_one_block  0.06245017051696777
generate_one_block  0.07883143424987793
generate_one_block  0.149092435836792
generate_one_block  0.08121299743652344
generate_one_block  0.14822626113891602
global_2_local spend time (sec) 0.004128456115722656
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007975101470947266
A = g.adjacency_matrix() spent  0.0005960464477539062
auxiliary_graph
Graph(num_nodes=18622, num_edges=300862,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.012379646301269531
remove nodes length
15844
auxiliary_graph.remove_nodes spent  0.012257575988769531
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2778, num_edges=300862,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.01127934455871582

the counter of shared neighbor distribution
Counter({1.0: 243968, 2.0: 39910, 3.0: 9930, 4.0: 2734, 5.0: 932, 6.0: 370, 7.0: 132, 8.0: 64, 9.0: 14, 10.0: 12, 11.0: 10, 15.0: 4, 12.0: 2, 14.0: 2})
298084
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 298081, 298082, 298083])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 243968, 2.0: 39910, 3.0: 9930, 4.0: 2734, 5.0: 932, 6.0: 370, 7.0: 132, 8.0: 64, 9.0: 14, 10.0: 12, 11.0: 10, 15.0: 4, 12.0: 2, 14.0: 2})
Convert a graph into a bidirected graph: 0.009 seconds
Metis partitioning: 0.030 seconds
Split the graph: 0.026 seconds
Construct subgraphs: 0.011 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.07738685607910156
1399
1379
total k batches seeds list generation spend  0.2293078899383545
after graph partition
graph partition algorithm spend time 0.23317575454711914
1399
1379
time for parepare:  0.020007610321044922
local_output_nid generation:  0.00026154518127441406
local_in_edges_tensor generation:  0.0006575584411621094
mini_batch_src_global generation:  0.0007698535919189453
r_  generation:  0.005254983901977539
local_output_nid generation:  0.00025200843811035156
local_in_edges_tensor generation:  0.00058746337890625
mini_batch_src_global generation:  0.0009095668792724609
r_  generation:  0.005900382995605469
----------------------check_connections_block total spend ----------------------------- 0.04230856895446777
generate_one_block  0.01079416275024414
generate_one_block  0.010265588760375977
time for parepare:  0.020665645599365234
local_output_nid generation:  0.0018520355224609375
local_in_edges_tensor generation:  0.0032727718353271484
mini_batch_src_global generation:  0.003309488296508789
r_  generation:  0.03599262237548828
local_output_nid generation:  0.0024695396423339844
local_in_edges_tensor generation:  0.0028467178344726562
mini_batch_src_global generation:  0.0037806034088134766
r_  generation:  0.03622865676879883
----------------------check_connections_block total spend ----------------------------- 0.13057351112365723
generate_one_block  0.05267214775085449
generate_one_block  0.05119657516479492
----------===============-------------===============-------------the number of batches *****---- 33

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03091716766357422  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

connection checking time:  1.7616760730743408
block generation total time  1.4993040561676025
average batch blocks generation time:  0.04685325175523758
block dataloader generation time/epoch 27.843085765838623
pseudo mini batch 0 input nodes size: 10670
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.028426647186279297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.028426647186279297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03351449966430664  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.033536434173583984  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016421794891357422  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016799449920654297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016799449920654297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 10670
first layer output nodes number: 5663
edges number: 32086
input nodes number: 5663
output nodes number: 2904
edges number: 18540
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.5582833290100098  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.5582842826843262  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.017780780792236328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 1 input nodes size: 15674
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016646862030029297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016646862030029297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.024120807647705078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.024142742156982422  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019032955169677734  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019548892974853516  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019548892974853516  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 15674
first layer output nodes number: 7073
edges number: 45739
input nodes number: 7073
output nodes number: 2911
edges number: 23392
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.7335524559020996  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.7335529327392578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020549297332763672  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 2 input nodes size: 15593
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01903390884399414  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01903390884399414  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02646923065185547  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02649068832397461  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018994808197021484  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01947927474975586  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01947927474975586  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 15593
first layer output nodes number: 6704
edges number: 42866
input nodes number: 6704
output nodes number: 2880
edges number: 22057
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.693568229675293  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.6935687065124512  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020423412322998047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 3 input nodes size: 14579
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018990039825439453  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018990039825439453  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025941848754882812  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025963306427001953  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018506526947021484  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018871784210205078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018871784210205078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 14579
first layer output nodes number: 6122
edges number: 33171
input nodes number: 6122
output nodes number: 2875
edges number: 15690
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.530036449432373  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.5300369262695312  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019632339477539062  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 4 input nodes size: 10330
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01850605010986328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01850605010986328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.023431777954101562  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.023453712463378906  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016480445861816406  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016806602478027344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016806602478027344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 10330
first layer output nodes number: 5432
edges number: 27832
input nodes number: 5432
output nodes number: 2907
edges number: 15823
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.48670434951782227  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.48670482635498047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01748800277709961  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 5 input nodes size: 11061
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016485214233398438  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016485214233398438  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.021759510040283203  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.021781444549560547  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016833782196044922  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.017138004302978516  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.017138004302978516  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 11061
first layer output nodes number: 5391
edges number: 26431
input nodes number: 5391
output nodes number: 2888
edges number: 14274
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.45474910736083984  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.45474958419799805  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.017783641815185547  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 6 input nodes size: 17354
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016830921173095703  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.016830921173095703  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025228500366210938  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02525043487548828  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019954204559326172  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020479679107666016  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020479679107666016  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 17354
first layer output nodes number: 7167
edges number: 47137
input nodes number: 7167
output nodes number: 2903
edges number: 23199
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.7464432716369629  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.7464437484741211  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.021503925323486328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 7 input nodes size: 16969
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019956588745117188  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019956588745117188  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.028048038482666016  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02806997299194336  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01965045928955078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020145416259765625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020145416259765625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 16969
first layer output nodes number: 6815
edges number: 44080
input nodes number: 6815
output nodes number: 2886
edges number: 22223
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.709104061126709  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.7091045379638672  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02111673355102539  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 8 input nodes size: 15226
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019647598266601562  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019647598266601562  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.026907920837402344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.026929855346679688  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018816471099853516  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01940298080444336  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01940298080444336  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 15226
first layer output nodes number: 7497
edges number: 51970
input nodes number: 7497
output nodes number: 2927
edges number: 26624
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.8374724388122559  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.8374729156494141  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02050924301147461  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 9 input nodes size: 15154
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018822669982910156  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018822669982910156  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.026048660278320312  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02606964111328125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018787384033203125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019301414489746094  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019301414489746094  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 15154
first layer output nodes number: 6665
edges number: 44080
input nodes number: 6665
output nodes number: 2778
edges number: 24765
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.7403345108032227  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.7403349876403809  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020273685455322266  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 10 input nodes size: 19329
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01876544952392578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01876544952392578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.027982234954833984  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.028003215789794922  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020756244659423828  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.021337032318115234  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.021337032318115234  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 19329
first layer output nodes number: 8334
edges number: 57145
input nodes number: 8334
output nodes number: 2760
edges number: 20624
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.7869119644165039  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.7869124412536621  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02243328094482422  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 11 input nodes size: 15414
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02075338363647461  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02075338363647461  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.028103351593017578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.028125286102294922  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01888751983642578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019498825073242188  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019498825073242188  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 15414
first layer output nodes number: 7621
edges number: 55413
input nodes number: 7621
output nodes number: 2927
edges number: 26515
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.8531155586242676  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.8531160354614258  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02065277099609375  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 12 input nodes size: 14329
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018912315368652344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018912315368652344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025744915008544922  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025766372680664062  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01839447021484375  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01887226104736328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01887226104736328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 14329
first layer output nodes number: 6214
edges number: 41119
input nodes number: 6214
output nodes number: 2875
edges number: 22791
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.6887345314025879  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.6887350082397461  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019792556762695312  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 13 input nodes size: 13630
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.0183868408203125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.0183868408203125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025226116180419922  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025247573852539062  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018393516540527344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01874542236328125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.01874542236328125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 13630
first layer output nodes number: 5977
edges number: 31562
input nodes number: 5977
output nodes number: 2844
edges number: 15537
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.5153164863586426  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.5153169631958008  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.019477367401123047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 14 input nodes size: 13643
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018388748168945312  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018388748168945312  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02522134780883789  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025243282318115234  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018382549285888672  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018905162811279297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.018905162811279297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 13643
first layer output nodes number: 6292
edges number: 44436
input nodes number: 6292
output nodes number: 2927
edges number: 25538
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7531189918518066  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7531194686889648  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.01990795135498047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 15 input nodes size: 19447
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.018394947052001953  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.018394947052001953  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.027667999267578125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.027688980102539062  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02083444595336914  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.021341800689697266  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.021341800689697266  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 19447
first layer output nodes number: 7091
edges number: 48253
input nodes number: 7091
output nodes number: 2762
edges number: 19734
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7043037414550781  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7043042182922363  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.022308349609375  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 16 input nodes size: 22928
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02081012725830078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02081012725830078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03174304962158203  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03176403045654297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02246999740600586  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02298879623413086  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02298879623413086  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 22928
first layer output nodes number: 8011
edges number: 52023
input nodes number: 8011
output nodes number: 2760
edges number: 17509
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7050809860229492  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7050814628601074  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.024020671844482422  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 17 input nodes size: 24594
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.022469520568847656  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.022469520568847656  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03419685363769531  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.034218788146972656  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02326488494873047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.023962020874023438  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.023962020874023438  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 24594
first layer output nodes number: 9208
edges number: 67142
input nodes number: 9208
output nodes number: 2927
edges number: 26350
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.9531912803649902  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.9531917572021484  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.025302886962890625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 18 input nodes size: 18540
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02328968048095703  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02328968048095703  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03213024139404297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03215217590332031  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.020402908325195312  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.020882606506347656  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.020882606506347656  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 18540
first layer output nodes number: 7702
edges number: 45950
input nodes number: 7702
output nodes number: 2915
edges number: 18337
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.6709885597229004  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.6709890365600586  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.021842479705810547  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 19 input nodes size: 21643
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0204010009765625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0204010009765625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.030721187591552734  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.030743122100830078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.021880626678466797  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.022409915924072266  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.022409915924072266  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 21643
first layer output nodes number: 8107
edges number: 51223
input nodes number: 8107
output nodes number: 2893
edges number: 19678
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.733616828918457  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7336173057556152  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.023459911346435547  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 20 input nodes size: 38290
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.021877765655517578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.021877765655517578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.040135860443115234  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.04015684127807617  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.029814720153808594  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.031024932861328125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.031024932861328125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 38290
first layer output nodes number: 15237
edges number: 129442
input nodes number: 15237
output nodes number: 2758
edges number: 32880
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.5231051445007324  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.5231056213378906  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03311920166015625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 21 input nodes size: 31976
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02979421615600586  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02979421615600586  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.045041561126708984  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.04506254196166992  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.026783466339111328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.027393817901611328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.027393817901611328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 31976
first layer output nodes number: 9867
edges number: 65684
input nodes number: 9867
output nodes number: 2788
edges number: 16102
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.8104510307312012  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.8104515075683594  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.028621196746826172  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 22 input nodes size: 31558
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02678823471069336  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02678823471069336  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.04183626174926758  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.041857242584228516  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.026588916778564453  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.027472972869873047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.027472972869873047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 31558
first layer output nodes number: 12101
edges number: 94809
input nodes number: 12101
output nodes number: 2767
edges number: 23709
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.1273150444030762  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.1273155212402344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.029069900512695312  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 23 input nodes size: 25753
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02658557891845703  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02658557891845703  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03886556625366211  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03888654708862305  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02381753921508789  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.024413585662841797  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.024413585662841797  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 25753
first layer output nodes number: 9188
edges number: 62563
input nodes number: 9188
output nodes number: 2790
edges number: 17391
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7885160446166992  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7885165214538574  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02557229995727539  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 24 input nodes size: 49309
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.023820877075195312  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.023820877075195312  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0473332405090332  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.04735517501831055  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03505420684814453  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.036457061767578125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.036457061767578125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 49309
first layer output nodes number: 18431
edges number: 157003
input nodes number: 18431
output nodes number: 2884
edges number: 31173
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.7355928421020508  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.735593318939209  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03891944885253906  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 25 input nodes size: 42208
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.035068511962890625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.035068511962890625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.055194854736328125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.05521583557128906  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03168153762817383  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.032628536224365234  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.032628536224365234  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 42208
first layer output nodes number: 13549
edges number: 105554
input nodes number: 13549
output nodes number: 2777
edges number: 21400
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.188260555267334  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.1882610321044922  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03436899185180664  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 26 input nodes size: 39182
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03166532516479492  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03166532516479492  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.05119657516479492  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.05121755599975586  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.031070232391357422  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.032076358795166016  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.032076358795166016  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 39182
first layer output nodes number: 13813
edges number: 109160
input nodes number: 13813
output nodes number: 2764
edges number: 25815
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.2740864753723145  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.2740869522094727  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.033905982971191406  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 27 input nodes size: 42210
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.051195621490478516  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.05121660232543945  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.031664371490478516  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03291749954223633  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03291749954223633  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 42210
first layer output nodes number: 16316
edges number: 139075
input nodes number: 16316
output nodes number: 2758
edges number: 28936
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.5532341003417969  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.553234577178955  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.035097599029541016  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 28 input nodes size: 47673
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03166341781616211  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03166341781616211  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.05510091781616211  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.05512189865112305  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0362858772277832  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0362858772277832  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 47673
first layer output nodes number: 17382
edges number: 147252
input nodes number: 17382
output nodes number: 2758
edges number: 28744
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.6127119064331055  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.6127123832702637  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.038588523864746094  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 29 input nodes size: 40531
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0545048713684082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.05452585220336914  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.032292842864990234  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.032292842864990234  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 40531
first layer output nodes number: 16027
edges number: 135154
input nodes number: 16027
output nodes number: 2758
edges number: 29200
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.5189461708068848  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.518946647644043  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03443002700805664  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 30 input nodes size: 39841
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0505986213684082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.05062055587768555  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03249692916870117  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03249692916870117  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 39841
first layer output nodes number: 17243
edges number: 152372
input nodes number: 17243
output nodes number: 2912
edges number: 39256
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.7916007041931152  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.7916011810302734  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0349574089050293  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 31 input nodes size: 35615
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03109121322631836  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03109121322631836  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.048073768615722656  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.048084259033203125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02853107452392578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.029300689697265625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.029300689697265625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 35615
first layer output nodes number: 10323
edges number: 88485
input nodes number: 10323
output nodes number: 1399
edges number: 14690
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.9525561332702637  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.9525566101074219  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.030467987060546875  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 32 input nodes size: 32247
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.028306007385253906  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.028306007385253906  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.04368257522583008  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.04369306564331055  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02670001983642578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02748394012451172  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02748394012451172  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 32247
first layer output nodes number: 10208
edges number: 89247
input nodes number: 10208
output nodes number: 1379
edges number: 15754
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.9547290802001953  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.9547295570373535  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.028867721557617188  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.028867721557617188  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.028867721557617188  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008578170429576527 |0.00223441557450728 |0.13118032253149783 |0.00012718547474254262 |0.128379200444077 |0.008189201354980469 |[23:26:13] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 29010640 edges into 32 parts and get 8897067 edge cuts

----------------------------------------------------------pseudo_mini_loss sum 5.247544288635254
Total (block generation + training)time/epoch 36.97164797782898
Training time/epoch 9.128285646438599
Training time without block to device /epoch 9.054549932479858
Training time without total dataloading part /epoch 8.577850580215454
load block tensor time/epoch 0.2830796241760254
block to device time/epoch 0.07373571395874023
input features size transfer per epoch 4.425644874572754e-06
blocks size to device per epoch 2.950429916381836e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1141271
Number of first layer input nodes during this epoch:  822500
Number of first layer output nodes during this epoch:  318771
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.028867244720458984  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02658224105834961
global_2_local spend time (sec) 0.0611567497253418
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0046389102935791016
A = g.adjacency_matrix() spent  0.011306285858154297
auxiliary_graph
Graph(num_nodes=154715, num_edges=29101581,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10546350479125977
remove nodes length
63774
auxiliary_graph.remove_nodes spent  1.490384578704834
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29101581,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.319216012954712

the counter of shared neighbor distribution
Counter({1.0: 23486600, 2.0: 4015792, 3.0: 1001110, 4.0: 300986, 5.0: 109994, 6.0: 47458, 7.0: 22542, 8.0: 11416, 9.0: 6208, 10.0: 3562, 11.0: 1972, 12.0: 1148, 13.0: 654, 14.0: 388, 15.0: 284, 16.0: 206, 17.0: 180, 18.0: 72, 19.0: 50, 20.0: 10, 21.0: 8})
29010640
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 29010637, 29010638, 29010639])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23486600, 2.0: 4015792, 3.0: 1001110, 4.0: 300986, 5.0: 109994, 6.0: 47458, 7.0: 22542, 8.0: 11416, 9.0: 6208, 10.0: 3562, 11.0: 1972, 12.0: 1148, 13.0: 654, 14.0: 388, 15.0: 284, 16.0: 206, 17.0: 180, 18.0: 72, 19.0: 50, 20.0: 10, 21.0: 8})
Convert a graph into a bidirected graph: 2.161 seconds
Metis partitioning: 7.061 seconds
Split the graph: 1.019 seconds
Construct subgraphs: 0.126 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.384065866470337
2849
2870
2789
2813
2759
2785
2758
2881
2758
2809
2774
2925
2758
2758
2905
2758
2875
2891
2879
2891
2905
2893
2821
2873
2909
2886
2870
2875
2927
2770
2926
2801
total k batches seeds list generation spend  22.55379557609558
after graph partition
graph partition algorithm spend time 22.663106203079224
2849
2870
2789
2813
2759
2785
2758
2881
2758
2809
2774
2925
2758
2758
2905
2758
2875
2891
2879
2891
2905
2893
2821
2873
2909
2886
2870
2875
2927
2770
2926
2801
partition_len_list
[9065, 6798, 8375, 8883, 9781, 11438, 11075, 7670, 15123, 15126, 16700, 19738, 19088, 16424, 18187, 16284, 6775, 5448, 6062, 7641, 6727, 5225, 5371, 5622, 6449, 6222, 6916, 5987, 7921, 7440, 7722, 6928]
shared_neighbor_graph_partition_s0 selection method  spend 22.78618597984314
time for parepare:  0.01994919776916504
local_output_nid generation:  0.0005843639373779297
local_in_edges_tensor generation:  0.0010807514190673828
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.009217977523803711
local_output_nid generation:  0.0007379055023193359
local_in_edges_tensor generation:  0.0008640289306640625
mini_batch_src_global generation:  0.0012466907501220703
r_  generation:  0.009890079498291016
local_output_nid generation:  0.0007679462432861328
local_in_edges_tensor generation:  0.0007798671722412109
mini_batch_src_global generation:  0.0008053779602050781
r_  generation:  0.008129119873046875
local_output_nid generation:  0.0007851123809814453
local_in_edges_tensor generation:  0.0007433891296386719
mini_batch_src_global generation:  0.0007929801940917969
r_  generation:  0.00829172134399414
local_output_nid generation:  0.0007495880126953125
local_in_edges_tensor generation:  0.0007281303405761719
mini_batch_src_global generation:  0.0007436275482177734
r_  generation:  0.0073206424713134766
local_output_nid generation:  0.0007710456848144531
local_in_edges_tensor generation:  0.0007429122924804688
mini_batch_src_global generation:  0.001150369644165039
r_  generation:  0.00984644889831543
local_output_nid generation:  0.0007278919219970703
local_in_edges_tensor generation:  0.0007379055023193359
mini_batch_src_global generation:  0.0007634162902832031
r_  generation:  0.00747227668762207
local_output_nid generation:  0.000751495361328125
local_in_edges_tensor generation:  0.0007448196411132812
mini_batch_src_global generation:  0.0007135868072509766
r_  generation:  0.008104562759399414
local_output_nid generation:  0.0006990432739257812
local_in_edges_tensor generation:  0.0007894039154052734
mini_batch_src_global generation:  0.0012061595916748047
r_  generation:  0.013041496276855469
local_output_nid generation:  0.0007646083831787109
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.0011856555938720703
r_  generation:  0.010382890701293945
local_output_nid generation:  0.0007236003875732422
local_in_edges_tensor generation:  0.0007727146148681641
mini_batch_src_global generation:  0.001115560531616211
r_  generation:  0.011619091033935547
local_output_nid generation:  0.0007767677307128906
local_in_edges_tensor generation:  0.001020193099975586
mini_batch_src_global generation:  0.0020389556884765625
r_  generation:  0.015946626663208008
local_output_nid generation:  0.0007469654083251953
local_in_edges_tensor generation:  0.0011718273162841797
mini_batch_src_global generation:  0.0014350414276123047
r_  generation:  0.013097524642944336
local_output_nid generation:  0.0007638931274414062
local_in_edges_tensor generation:  0.0008718967437744141
mini_batch_src_global generation:  0.0011298656463623047
r_  generation:  0.01141047477722168
local_output_nid generation:  0.0008115768432617188
local_in_edges_tensor generation:  0.0010769367218017578
mini_batch_src_global generation:  0.002012968063354492
r_  generation:  0.017176151275634766
local_output_nid generation:  0.000766754150390625
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0013632774353027344
r_  generation:  0.012415647506713867
local_output_nid generation:  0.0008242130279541016
local_in_edges_tensor generation:  0.0007741451263427734
mini_batch_src_global generation:  0.0009925365447998047
r_  generation:  0.009526729583740234
local_output_nid generation:  0.0007913112640380859
local_in_edges_tensor generation:  0.0007805824279785156
mini_batch_src_global generation:  0.0008237361907958984
r_  generation:  0.008717536926269531
local_output_nid generation:  0.0007860660552978516
local_in_edges_tensor generation:  0.0007326602935791016
mini_batch_src_global generation:  0.0007486343383789062
r_  generation:  0.008196830749511719
local_output_nid generation:  0.0007748603820800781
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.0009875297546386719
r_  generation:  0.00938868522644043
local_output_nid generation:  0.0007605552673339844
local_in_edges_tensor generation:  0.0007600784301757812
mini_batch_src_global generation:  0.0008020401000976562
r_  generation:  0.00841832160949707
local_output_nid generation:  0.0007345676422119141
local_in_edges_tensor generation:  0.0007736682891845703
mini_batch_src_global generation:  0.0006167888641357422
r_  generation:  0.006523847579956055
local_output_nid generation:  0.0007166862487792969
local_in_edges_tensor generation:  0.0007009506225585938
mini_batch_src_global generation:  0.0005786418914794922
r_  generation:  0.006556510925292969
local_output_nid generation:  0.0007145404815673828
local_in_edges_tensor generation:  0.000759124755859375
mini_batch_src_global generation:  0.0006535053253173828
r_  generation:  0.007372856140136719
local_output_nid generation:  0.0007169246673583984
local_in_edges_tensor generation:  0.0007538795471191406
mini_batch_src_global generation:  0.0008151531219482422
r_  generation:  0.009128332138061523
local_output_nid generation:  0.0007092952728271484
local_in_edges_tensor generation:  0.0007805824279785156
mini_batch_src_global generation:  0.0008897781372070312
r_  generation:  0.00969386100769043
local_output_nid generation:  0.0006995201110839844
local_in_edges_tensor generation:  0.0007369518280029297
mini_batch_src_global generation:  0.00087738037109375
r_  generation:  0.009027719497680664
local_output_nid generation:  0.0006833076477050781
local_in_edges_tensor generation:  0.0008451938629150391
mini_batch_src_global generation:  0.0010941028594970703
r_  generation:  0.010442972183227539
local_output_nid generation:  0.0007169246673583984
local_in_edges_tensor generation:  0.0008635520935058594
mini_batch_src_global generation:  0.0010044574737548828
r_  generation:  0.010885238647460938
local_output_nid generation:  0.0006840229034423828
local_in_edges_tensor generation:  0.0008416175842285156
mini_batch_src_global generation:  0.0008141994476318359
r_  generation:  0.008252143859863281
local_output_nid generation:  0.0007245540618896484
local_in_edges_tensor generation:  0.0007765293121337891
mini_batch_src_global generation:  0.0009589195251464844
r_  generation:  0.010930061340332031
local_output_nid generation:  0.0006818771362304688
local_in_edges_tensor generation:  0.0008480548858642578
mini_batch_src_global generation:  0.0008471012115478516
r_  generation:  0.008663415908813477
----------------------check_connections_block total spend ----------------------------- 0.4967830181121826
generate_one_block  0.022547483444213867
generate_one_block  0.015231847763061523
generate_one_block  0.013020753860473633
generate_one_block  0.013099908828735352
generate_one_block  0.011949539184570312
generate_one_block  0.015870094299316406
generate_one_block  0.012168645858764648
generate_one_block  0.011999130249023438
generate_one_block  0.0211946964263916
generate_one_block  0.016735315322875977
generate_one_block  0.01925039291381836
generate_one_block  0.0244143009185791
generate_one_block  0.02242112159729004
generate_one_block  0.02046680450439453
generate_one_block  0.02508401870727539
generate_one_block  0.02056431770324707
generate_one_block  0.016510963439941406
generate_one_block  0.012677431106567383
generate_one_block  0.01149296760559082
generate_one_block  0.01409602165222168
generate_one_block  0.012130975723266602
generate_one_block  0.009421586990356445
generate_one_block  0.009400606155395508
generate_one_block  0.010542154312133789
generate_one_block  0.013050079345703125
generate_one_block  0.013856172561645508
generate_one_block  0.013010501861572266
generate_one_block  0.014576196670532227
generate_one_block  0.01634669303894043
generate_one_block  0.012351512908935547
generate_one_block  0.01599407196044922
generate_one_block  0.012497425079345703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04445910453796387
gen group dst list time:  0.010000944137573242
time for parepare:  0.023850679397583008
local_output_nid generation:  0.001943826675415039
local_in_edges_tensor generation:  0.010585784912109375
mini_batch_src_global generation:  0.0033245086669921875
r_  generation:  0.029916048049926758
local_output_nid generation:  0.0022258758544921875
local_in_edges_tensor generation:  0.0024323463439941406
mini_batch_src_global generation:  0.0030498504638671875
r_  generation:  0.02146625518798828
local_output_nid generation:  0.0026814937591552734
local_in_edges_tensor generation:  0.0021314620971679688
mini_batch_src_global generation:  0.0028488636016845703
r_  generation:  0.024995088577270508
local_output_nid generation:  0.0024611949920654297
local_in_edges_tensor generation:  0.0020656585693359375
mini_batch_src_global generation:  0.0029146671295166016
r_  generation:  0.027601003646850586
local_output_nid generation:  0.0026674270629882812
local_in_edges_tensor generation:  0.0022194385528564453
mini_batch_src_global generation:  0.003271818161010742
r_  generation:  0.029847383499145508
local_output_nid generation:  0.002762317657470703
local_in_edges_tensor generation:  0.0033245086669921875
mini_batch_src_global generation:  0.004115581512451172
r_  generation:  0.037712812423706055
local_output_nid generation:  0.0028045177459716797
local_in_edges_tensor generation:  0.002557992935180664
mini_batch_src_global generation:  0.003913402557373047
r_  generation:  0.0344388484954834
local_output_nid generation:  0.0019268989562988281
local_in_edges_tensor generation:  0.0019528865814208984
mini_batch_src_global generation:  0.0027909278869628906
r_  generation:  0.021261930465698242
local_output_nid generation:  0.0035119056701660156
local_in_edges_tensor generation:  0.004348039627075195
mini_batch_src_global generation:  0.005346536636352539
r_  generation:  0.05271100997924805
local_output_nid generation:  0.0040018558502197266
local_in_edges_tensor generation:  0.0054531097412109375
mini_batch_src_global generation:  0.005922794342041016
r_  generation:  0.0551753044128418
local_output_nid generation:  0.004813194274902344
local_in_edges_tensor generation:  0.007078886032104492
mini_batch_src_global generation:  0.00962686538696289
r_  generation:  0.06160140037536621
local_output_nid generation:  0.005078792572021484
local_in_edges_tensor generation:  0.006288051605224609
mini_batch_src_global generation:  0.0074307918548583984
r_  generation:  0.07175517082214355
local_output_nid generation:  0.005039691925048828
local_in_edges_tensor generation:  0.007050991058349609
mini_batch_src_global generation:  0.006850242614746094
r_  generation:  0.06911373138427734
local_output_nid generation:  0.004433393478393555
local_in_edges_tensor generation:  0.004765033721923828
mini_batch_src_global generation:  0.006054401397705078
r_  generation:  0.0582582950592041
local_output_nid generation:  0.004506349563598633
local_in_edges_tensor generation:  0.00480198860168457
mini_batch_src_global generation:  0.00615382194519043
r_  generation:  0.06512022018432617
local_output_nid generation:  0.004057884216308594
local_in_edges_tensor generation:  0.0044705867767333984
mini_batch_src_global generation:  0.005587577819824219
r_  generation:  0.05685305595397949
local_output_nid generation:  0.0019469261169433594
local_in_edges_tensor generation:  0.0018634796142578125
mini_batch_src_global generation:  0.0029189586639404297
r_  generation:  0.019884347915649414
local_output_nid generation:  0.0014600753784179688
local_in_edges_tensor generation:  0.0013413429260253906
mini_batch_src_global generation:  0.0015053749084472656
r_  generation:  0.013712406158447266
local_output_nid generation:  0.0015141963958740234
local_in_edges_tensor generation:  0.0016202926635742188
mini_batch_src_global generation:  0.001238107681274414
r_  generation:  0.015509605407714844
local_output_nid generation:  0.0018427371978759766
local_in_edges_tensor generation:  0.0018405914306640625
mini_batch_src_global generation:  0.001661062240600586
r_  generation:  0.0207521915435791
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0016796588897705078
mini_batch_src_global generation:  0.0014920234680175781
r_  generation:  0.017650365829467773
local_output_nid generation:  0.0011627674102783203
local_in_edges_tensor generation:  0.0012671947479248047
mini_batch_src_global generation:  0.0011181831359863281
r_  generation:  0.010773420333862305
local_output_nid generation:  0.0012156963348388672
local_in_edges_tensor generation: [23:26:19] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2925 nodes and 1849142 edges into 2 parts and get 315923 edge cuts
 0.0011725425720214844
mini_batch_src_global generation:  0.0010793209075927734
r_  generation:  0.012296438217163086
local_output_nid generation:  0.0012290477752685547
local_in_edges_tensor generation:  0.0012443065643310547
mini_batch_src_global generation:  0.0011224746704101562
r_  generation:  0.013134002685546875
local_output_nid generation:  0.001401662826538086
local_in_edges_tensor generation:  0.0014328956604003906
mini_batch_src_global generation:  0.0013272762298583984
r_  generation:  0.017623186111450195
local_output_nid generation:  0.001283407211303711
local_in_edges_tensor generation:  0.0013611316680908203
mini_batch_src_global generation:  0.0023598670959472656
r_  generation:  0.017740726470947266
local_output_nid generation:  0.0016226768493652344
local_in_edges_tensor generation:  0.0033338069915771484
mini_batch_src_global generation:  0.0014836788177490234
r_  generation:  0.019700288772583008
local_output_nid generation:  0.0012555122375488281
local_in_edges_tensor generation:  0.0014529228210449219
mini_batch_src_global generation:  0.0014781951904296875
r_  generation:  0.01762080192565918
local_output_nid generation:  0.0016834735870361328
local_in_edges_tensor generation:  0.0018608570098876953
mini_batch_src_global generation:  0.0017309188842773438
r_  generation:  0.023621797561645508
local_output_nid generation:  0.0014812946319580078
local_in_edges_tensor generation:  0.0016286373138427734
mini_batch_src_global generation:  0.0016803741455078125
r_  generation:  0.020829200744628906
local_output_nid generation:  0.0014870166778564453
local_in_edges_tensor generation:  0.001583099365234375
mini_batch_src_global generation:  0.0018169879913330078
r_  generation:  0.022306203842163086
local_output_nid generation:  0.0013873577117919922
local_in_edges_tensor generation:  0.001477956771850586
mini_batch_src_global generation:  0.0016090869903564453
r_  generation:  0.018868684768676758
----------------------check_connections_block total spend ----------------------------- 1.5158343315124512
generate_one_block  0.039041996002197266
generate_one_block  0.04349946975708008
generate_one_block  0.033612728118896484
generate_one_block  0.03549599647521973
generate_one_block  0.039877891540527344
generate_one_block  0.05149507522583008
generate_one_block  0.04757332801818848
generate_one_block  0.03620576858520508
generate_one_block  0.0740671157836914
generate_one_block  0.07164359092712402
generate_one_block  0.0802152156829834
generate_one_block  0.09613227844238281
generate_one_block  0.09236431121826172
generate_one_block  0.07761216163635254
generate_one_block  0.08845353126525879
generate_one_block  0.07876157760620117
generate_one_block  0.025482892990112305
generate_one_block  0.018572568893432617
generate_one_block  0.019627809524536133
generate_one_block  0.028208255767822266
generate_one_block  0.02349090576171875
generate_one_block  0.014675617218017578
generate_one_block  0.016376018524169922
generate_one_block  0.01714468002319336
generate_one_block  0.02333545684814453
generate_one_block  0.021883726119995117
generate_one_block  0.026464462280273438
generate_one_block  0.023117780685424805
generate_one_block  0.03124380111694336
generate_one_block  0.027962446212768555
generate_one_block  0.029783248901367188
generate_one_block  0.025324106216430664
global_2_local spend time (sec) 0.004152536392211914
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0008914470672607422
A = g.adjacency_matrix() spent  0.0007312297821044922
auxiliary_graph
Graph(num_nodes=19738, num_edges=1852067,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.013674497604370117
remove nodes length
16813
auxiliary_graph.remove_nodes spent  0.07156181335449219
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2925, num_edges=1852067,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.060495853424072266

the counter of shared neighbor distribution
Counter({1.0: 1624972, 2.0: 185142, 3.0: 30656, 4.0: 5894, 5.0: 1614, 6.0: 478, 7.0: 216, 8.0: 82, 9.0: 38, 10.0: 22, 11.0: 10, 12.0: 6, 14.0: 4, 13.0: 4, 17.0: 2, 15.0: 2})
1849142
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 1849139, 1849140, 1849141])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 1624972, 2.0: 185142, 3.0: 30656, 4.0: 5894, 5.0: 1614, 6.0: 478, 7.0: 216, 8.0: 82, 9.0: 38, 10.0: 22, 11.0: 10, 12.0: 6, 14.0: 4, 13.0: 4, 17.0: 2, 15.0: 2})
Convert a graph into a bidirected graph: 0.062 seconds
Metis partitioning: 0.106 seconds
Split the graph: 0.145 seconds
Construct subgraphs: 0.013 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.32697606086730957
1463
1462
total k batches seeds list generation spend  1.0861084461212158
after graph partition
graph partition algorithm spend time 1.0910758972167969
1463
1462
time for parepare:  0.020217180252075195
local_output_nid generation:  0.00027871131896972656
local_in_edges_tensor generation:  0.0025658607482910156
mini_batch_src_global generation:  0.0010492801666259766
r_  generation:  0.00713658332824707
local_output_nid generation:  0.00028204917907714844
local_in_edges_tensor generation:  0.0011286735534667969
mini_batch_src_global generation:  0.0009095668792724609
r_  generation:  0.006264686584472656
----------------------check_connections_block total spend ----------------------------- 0.047453880310058594
generate_one_block  0.013468503952026367
generate_one_block  0.01140737533569336
time for parepare:  0.02022576332092285
local_output_nid generation:  0.0018601417541503906
local_in_edges_tensor generation:  0.004856109619140625
mini_batch_src_global generation:  0.004325389862060547
r_  generation:  0.0432276725769043
local_output_nid generation:  0.002229452133178711
local_in_edges_tensor generation:  0.002849578857421875
mini_batch_src_global generation:  0.003856658935546875
r_  generation:  0.03402853012084961
----------------------check_connections_block total spend ----------------------------- 0.13700056076049805
generate_one_block  0.061926841735839844
generate_one_block  0.04963827133178711
----------===============-------------===============-------------the number of batches *****---- 33

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.028867244720458984  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

connection checking time:  1.5158343315124512
block generation total time  1.358745813369751
average batch blocks generation time:  0.04246080666780472
block dataloader generation time/epoch 28.10309934616089
pseudo mini batch 0 input nodes size: 24922
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.026695728302001953  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.026695728302001953  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.038579463958740234  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.038600921630859375  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.023213863372802734  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.023857593536376953  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.023857593536376953  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 24922
first layer output nodes number: 9065
edges number: 63777
input nodes number: 9065
output nodes number: 2849
edges number: 22503
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.8696579933166504  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.8696589469909668  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.025310993194580078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 1 input nodes size: 17838
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.023434162139892578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.023434162139892578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03193998336791992  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03196144104003906  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02005624771118164  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.020592212677001953  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.020592212677001953  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 17838
first layer output nodes number: 6798
edges number: 47465
input nodes number: 6798
output nodes number: 2870
edges number: 24412
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7637906074523926  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7637910842895508  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02163219451904297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 2 input nodes size: 22487
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02005910873413086  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02005910873413086  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03078174591064453  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03080272674560547  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.022275447845458984  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02282857894897461  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02282857894897461  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 22487
first layer output nodes number: 8375
edges number: 55161
input nodes number: 8375
output nodes number: 2789
edges number: 18989
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7524662017822266  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7524666786193848  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.023899078369140625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 3 input nodes size: 26394
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.022263526916503906  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.022263526916503906  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03484916687011719  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.034870147705078125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.024126529693603516  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.024719715118408203  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.024719715118408203  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 26394
first layer output nodes number: 8883
edges number: 60067
input nodes number: 8883
output nodes number: 2813
edges number: 19340
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7951769828796387  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.7951774597167969  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02588939666748047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 4 input nodes size: 29921
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02413034439086914  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02413034439086914  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.038397789001464844  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03841876983642578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.025812149047851562  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02644062042236328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02644062042236328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 29921
first layer output nodes number: 9781
edges number: 67575
input nodes number: 9781
output nodes number: 2759
edges number: 16768
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.8168749809265137  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.8168754577636719  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.027659893035888672  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 5 input nodes size: 29198
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02580404281616211  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02580404281616211  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03972673416137695  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03974771499633789  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02545928955078125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.026297569274902344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.026297569274902344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 29198
first layer output nodes number: 11438
edges number: 88907
input nodes number: 11438
output nodes number: 2785
edges number: 23510
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.0865507125854492  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.0865511894226074  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.027821063995361328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 6 input nodes size: 35838
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.025463104248046875  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.025463104248046875  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.04255199432373047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.042572975158691406  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.028629302978515625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.029341697692871094  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.029341697692871094  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 35838
first layer output nodes number: 11075
edges number: 78390
input nodes number: 11075
output nodes number: 2758
edges number: 17035
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.9127302169799805  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.9127306938171387  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03072500228881836  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 7 input nodes size: 17733
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.028625011444091797  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.028625011444091797  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03708076477050781  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.037102699279785156  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.019992828369140625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.020465850830078125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.020465850830078125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 17733
first layer output nodes number: 7670
edges number: 45554
input nodes number: 7670
output nodes number: 2881
edges number: 17891
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.6646275520324707  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.6646280288696289  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02142810821533203  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 8 input nodes size: 37307
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.020011425018310547  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.020011425018310547  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03780078887939453  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03782176971435547  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.02934408187866211  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.030552387237548828  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.030552387237548828  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 37307
first layer output nodes number: 15123
edges number: 129317
input nodes number: 15123
output nodes number: 2758
edges number: 32669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.5280113220214844  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.5280117988586426  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03263521194458008  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 9 input nodes size: 45750
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.029325485229492188  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.029325485229492188  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.051140785217285156  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.051161766052246094  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03335142135620117  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03444337844848633  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03444337844848633  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 45750
first layer output nodes number: 15126
edges number: 121979
input nodes number: 15126
output nodes number: 2809
edges number: 24499
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.3537397384643555  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.3537402153015137  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03643798828125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 10 input nodes size: 46316
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03335905075073242  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03335905075073242  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.05544424057006836  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0554652214050293  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03362894058227539  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0348973274230957  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0348973274230957  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 46316
first layer output nodes number: 16700
edges number: 141488
input nodes number: 16700
output nodes number: 2774
edges number: 28555
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.5735721588134766  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 1.5735726356506348  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.0371246337890625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 11 input nodes size: 48227
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.033623695373535156  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.033623695373535156  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.057061195373535156  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.057082176208496094  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03497600555419922  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03644847869873047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9443359375 GB
    Memory Allocated: 0.03644847869873047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 48227
first layer output nodes number: 19088
edges number: 165102
input nodes number: 19088
output nodes number: 2758
edges number: 32497
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 1.8163127899169922  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 1.8163132667541504  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.03898000717163086  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 12 input nodes size: 43851
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.0564579963684082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.05647897720336914  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.03424882888793945  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.03424882888793945  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 43851
first layer output nodes number: 16424
edges number: 137362
input nodes number: 16424
output nodes number: 2758
edges number: 27293
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 1.5137567520141602  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 1.5137572288513184  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.0364079475402832  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 13 input nodes size: 40315
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.0525517463684082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.05257368087768555  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.03257131576538086  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0927734375 GB
    Memory Allocated: 0.03257131576538086  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 40315
first layer output nodes number: 18187
edges number: 161502
input nodes number: 18187
output nodes number: 2905
edges number: 40178
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0986328125 GB
    Memory Allocated: 1.883779525756836  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0986328125 GB
    Memory Allocated: 1.8837800025939941  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.035137176513671875  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 14 input nodes size: 40709
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.031090259552001953  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.031090259552001953  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.05062150955200195  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.05064249038696289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.031089305877685547  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.03235197067260742  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.03235197067260742  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 40709
first layer output nodes number: 16284
edges number: 138881
input nodes number: 16284
output nodes number: 2758
edges number: 30402
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 1.5695381164550781  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 1.5695385932922363  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.03452014923095703  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 15 input nodes size: 15832
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.03861665725708008  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.03863811492919922  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01908588409423828  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01957416534423828  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01957416534423828  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 15832
first layer output nodes number: 6775
edges number: 43821
input nodes number: 6775
output nodes number: 2875
edges number: 21543
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.6963753700256348  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.696375846862793  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020543575286865234  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 16 input nodes size: 10833
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019103527069091797  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019103527069091797  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.025226116180419922  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.025248050689697266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01767730712890625  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01806926727294922  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01806926727294922  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 10833
first layer output nodes number: 5448
edges number: 32114
input nodes number: 5448
output nodes number: 2891
edges number: 20458
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.5848388671875  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.5848393440246582  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.018853187561035156  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 17 input nodes size: 12992
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.017679691314697266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.017679691314697266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.023874759674072266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.023896217346191406  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.017751693725585938  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01814746856689453  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01814746856689453  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 12992
first layer output nodes number: 6062
edges number: 34746
input nodes number: 6062
output nodes number: 2879
edges number: 18177
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.5769734382629395  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.5769739151000977  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.018943309783935547  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 18 input nodes size: 17840
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.017749786376953125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.017749786376953125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.026256561279296875  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02627849578857422  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020061969757080078  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020592212677001953  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020592212677001953  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 17840
first layer output nodes number: 7641
edges number: 48754
input nodes number: 7641
output nodes number: 2891
edges number: 22354
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.7427873611450195  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.7427878379821777  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.021628856658935547  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 19 input nodes size: 15285
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02006387710571289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02006387710571289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.027352333068847656  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.027374267578125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.018845558166503906  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019287109375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019287109375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 15285
first layer output nodes number: 6727
edges number: 39885
input nodes number: 6727
output nodes number: 2905
edges number: 19266
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.6289291381835938  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.628929615020752  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020173072814941406  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 20 input nodes size: 9630
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01884746551513672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01884746551513672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.023439407348632812  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.023461341857910156  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.016150951385498047  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.016428470611572266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.016428470611572266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 9630
first layer output nodes number: 5225
edges number: 23452
input nodes number: 5225
output nodes number: 2893
edges number: 13594
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.4243602752685547  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.4243607521057129  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01702880859375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 21 input nodes size: 11687
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.016149520874023438  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.016149520874023438  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02172231674194336  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.0217437744140625  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.017129898071289062  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.0174407958984375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.0174407958984375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 11687
first layer output nodes number: 5371
edges number: 27471
input nodes number: 5371
output nodes number: 2821
edges number: 14169
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.46066999435424805  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.46067047119140625  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01808643341064453  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 22 input nodes size: 11891
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01711893081665039  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01711893081665039  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02278900146484375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02281045913696289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.017216205596923828  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01756143569946289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01756143569946289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 11891
first layer output nodes number: 5622
edges number: 29606
input nodes number: 5622
output nodes number: 2873
edges number: 16629
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.5129833221435547  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.5129837989807129  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.018285274505615234  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 23 input nodes size: 16193
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.017223834991455078  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.017223834991455078  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02494525909423828  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.024967193603515625  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019275665283203125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019742965698242188  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019742965698242188  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 16193
first layer output nodes number: 6449
edges number: 41039
input nodes number: 6449
output nodes number: 2909
edges number: 21541
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.6703853607177734  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.6703858375549316  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020676136016845703  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 24 input nodes size: 12866
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019281387329101562  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019281387329101562  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02541637420654297  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.025438308715820312  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.017694950103759766  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.018160343170166016  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.018160343170166016  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 12866
first layer output nodes number: 6222
edges number: 38975
input nodes number: 6222
output nodes number: 2886
edges number: 23408
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.6794681549072266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.6794686317443848  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01906585693359375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 25 input nodes size: 17955
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01769113540649414  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01769113540649414  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02625274658203125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02627420425415039  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02011728286743164  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020615100860595703  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020615100860595703  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 17955
first layer output nodes number: 6916
edges number: 45646
input nodes number: 6916
output nodes number: 2870
edges number: 21001
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.7023639678955078  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.702364444732666  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.021590709686279297  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 26 input nodes size: 12824
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020114898681640625  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020114898681640625  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.0262298583984375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02625131607055664  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01766824722290039  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.018168926239013672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.018168926239013672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 12824
first layer output nodes number: 5987
edges number: 41838
input nodes number: 5987
output nodes number: 2875
edges number: 25267
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.7260575294494629  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.7260580062866211  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01912212371826172  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 27 input nodes size: 15673
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.017669200897216797  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.017669200897216797  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.025226116180419922  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.025248050689697266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01911163330078125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019741058349609375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019741058349609375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 15673
first layer output nodes number: 7921
edges number: 57413
input nodes number: 7921
output nodes number: 2927
edges number: 26921
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.8787374496459961  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.8787379264831543  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020906448364257812  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 28 input nodes size: 16686
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.0191192626953125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.0191192626953125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.027075767517089844  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02709674835205078  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019517898559570312  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020028114318847656  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020028114318847656  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 16686
first layer output nodes number: 7440
edges number: 49372
input nodes number: 7440
output nodes number: 2770
edges number: 19070
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.7070083618164062  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.7070088386535645  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.0209808349609375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 29 input nodes size: 16051
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01949453353881836  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01949453353881836  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02714824676513672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.027170181274414062  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01919269561767578  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01979351043701172  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.01979351043701172  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 16051
first layer output nodes number: 7722
edges number: 53650
input nodes number: 7722
output nodes number: 2926
edges number: 26832
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.8525943756103516  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.8525948524475098  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02094411849975586  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 30 input nodes size: 16582
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019216060638427734  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019216060638427734  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.027122974395751953  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02714395523071289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019468307495117188  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019945144653320312  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019945144653320312  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 16582
first layer output nodes number: 6928
edges number: 43638
input nodes number: 6928
output nodes number: 2801
edges number: 20347
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.6764764785766602  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.6764769554138184  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.020866870880126953  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 31 input nodes size: 38060
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019449710845947266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.019449710845947266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.0375981330871582  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.037609100341796875  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.02968120574951172  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.03064441680908203  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.03064441680908203  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 38060
first layer output nodes number: 12088
edges number: 109100
input nodes number: 12088
output nodes number: 1463
edges number: 20034
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 1.1724934577941895  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 1.1724939346313477  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.03212928771972656  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 32 input nodes size: 30589
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.029481887817382812  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.029481887817382812  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.0440678596496582  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.044078826904296875  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.025919437408447266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.026677608489990234  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.026677608489990234  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 30589
first layer output nodes number: 9911
edges number: 84576
input nodes number: 9911
output nodes number: 1462
edges number: 17098
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.9427499771118164  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.9427504539489746  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.028029918670654297  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.028029918670654297  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.1005859375 GB
    Memory Allocated: 0.028029918670654297  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00797317244789817 |0.0017124450567996864 |0.12798650336988043 |0.00012524922688802084 |0.138827692378651 |0.0069353580474853516 |Using backend: pytorch

----------------------------------------------------------pseudo_mini_loss sum 4.013051986694336
Total (block generation + training)time/epoch 37.32830810546875
Training time/epoch 9.32160210609436
Training time without block to device /epoch 9.26509141921997
Training time without total dataloading part /epoch 8.815937042236328
load block tensor time/epoch 0.26311469078063965
block to device time/epoch 0.05651068687438965
input features size transfer per epoch 4.425644874572754e-06
blocks size to device per epoch 2.950429916381836e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1122747
Number of first layer input nodes during this epoch:  806275
Number of first layer output nodes during this epoch:  316472
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
