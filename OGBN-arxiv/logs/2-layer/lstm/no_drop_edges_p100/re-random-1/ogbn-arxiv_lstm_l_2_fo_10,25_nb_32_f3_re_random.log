[23:04:17] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28961398 edges into 32 parts and get 9130784 edge cuts
main start at this time 1652223831.4013095
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030718326568603516
global_2_local spend time (sec) 0.04669690132141113
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0042264461517333984
A = g.adjacency_matrix() spent  0.006238460540771484
auxiliary_graph
Graph(num_nodes=154710, num_edges=29052339,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09846901893615723
remove nodes length
63769
auxiliary_graph.remove_nodes spent  1.4118635654449463
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29052339,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2637903690338135

the counter of shared neighbor distribution
Counter({1.0: 23396418, 2.0: 4042542, 3.0: 1009392, 4.0: 305652, 5.0: 111008, 6.0: 48054, 7.0: 22158, 8.0: 11680, 9.0: 5998, 10.0: 3494, 11.0: 1958, 12.0: 1128, 13.0: 668, 14.0: 442, 15.0: 276, 16.0: 212, 17.0: 174, 18.0: 66, 19.0: 58, 20.0: 10, 21.0: 6, 22.0: 4})
28961398
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28961395, 28961396, 28961397])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23396418, 2.0: 4042542, 3.0: 1009392, 4.0: 305652, 5.0: 111008, 6.0: 48054, 7.0: 22158, 8.0: 11680, 9.0: 5998, 10.0: 3494, 11.0: 1958, 12.0: 1128, 13.0: 668, 14.0: 442, 15.0: 276, 16.0: 212, 17.0: 174, 18.0: 66, 19.0: 58, 20.0: 10, 21.0: 6, 22.0: 4})
Convert a graph into a bidirected graph: 2.133 seconds
Metis partitioning: 6.543 seconds
Split the graph: 1.123 seconds
Construct subgraphs: 0.116 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.929786205291748
2805
2839
2899
2878
2819
2759
2907
2927
2889
2911
2899
2771
2879
2901
2922
2885
2779
2759
2918
2773
2764
2874
2910
2927
2765
2758
2867
2758
2760
2758
2923
2758
total k batches seeds list generation spend  23.353163957595825
after graph partition
graph partition algorithm spend time 23.45887541770935
2805
2839
2899
2878
2819
2759
2907
2927
2889
2911
2899
2771
2879
2901
2922
2885
2779
2759
2918
2773
2764
2874
2910
2927
2765
2758
2867
2758
2760
2758
2923
2758
partition_len_list
[6469, 6259, 5900, 6223, 6314, 8310, 7655, 7704, 5535, 5240, 6645, 6950, 5858, 6947, 7101, 5240, 11577, 10054, 8619, 10689, 10189, 6787, 7980, 9306, 15732, 15451, 18377, 16990, 16283, 16526, 17386, 19184]
shared_neighbor_graph_partition_s0 selection method  spend 23.56331968307495
time for parepare:  0.02022242546081543
local_output_nid generation:  0.0005362033843994141
local_in_edges_tensor generation:  0.0008623600006103516
mini_batch_src_global generation:  0.0011212825775146484
r_  generation:  0.008405208587646484
local_output_nid generation:  0.0006873607635498047
local_in_edges_tensor generation:  0.0007121562957763672
mini_batch_src_global generation:  0.0009663105010986328
r_  generation:  0.008202075958251953
local_output_nid generation:  0.0007252693176269531
local_in_edges_tensor generation:  0.0008957386016845703
mini_batch_src_global generation:  0.0010755062103271484
r_  generation:  0.009664773941040039
local_output_nid generation:  0.0007510185241699219
local_in_edges_tensor generation:  0.0007138252258300781
mini_batch_src_global generation:  0.0008394718170166016
r_  generation:  0.00919961929321289
local_output_nid generation:  0.0007143020629882812
local_in_edges_tensor generation:  0.0006666183471679688
mini_batch_src_global generation:  0.0007545948028564453
r_  generation:  0.00790262222290039
local_output_nid generation:  0.0006923675537109375
local_in_edges_tensor generation:  0.0006489753723144531
mini_batch_src_global generation:  0.0007166862487792969
r_  generation:  0.00752568244934082
local_output_nid generation:  0.0006885528564453125
local_in_edges_tensor generation:  0.00070953369140625
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.009905576705932617
local_output_nid generation:  0.0006995201110839844
local_in_edges_tensor generation:  0.0007145404815673828
mini_batch_src_global generation:  0.0010509490966796875
r_  generation:  0.010225057601928711
local_output_nid generation:  0.0006842613220214844
local_in_edges_tensor generation:  0.0006556510925292969
mini_batch_src_global generation:  0.0006892681121826172
r_  generation:  0.006857633590698242
local_output_nid generation:  0.0006761550903320312
local_in_edges_tensor generation:  0.0006515979766845703
mini_batch_src_global generation:  0.0005581378936767578
r_  generation:  0.0062160491943359375
local_output_nid generation:  0.0006511211395263672
local_in_edges_tensor generation:  0.0006833076477050781
mini_batch_src_global generation:  0.0007719993591308594
r_  generation:  0.009393692016601562
local_output_nid generation:  0.0006453990936279297
local_in_edges_tensor generation:  0.0006496906280517578
mini_batch_src_global generation:  0.0007185935974121094
r_  generation:  0.00726628303527832
local_output_nid generation:  0.0006537437438964844
local_in_edges_tensor generation:  0.0006756782531738281
mini_batch_src_global generation:  0.0007393360137939453
r_  generation:  0.008267402648925781
local_output_nid generation:  0.0006604194641113281
local_in_edges_tensor generation:  0.0006866455078125
mini_batch_src_global generation:  0.0007884502410888672
r_  generation:  0.008681535720825195
local_output_nid generation:  0.0006608963012695312
local_in_edges_tensor generation:  0.0006890296936035156
mini_batch_src_global generation:  0.0008013248443603516
r_  generation:  0.009459972381591797
local_output_nid generation:  0.0006816387176513672
local_in_edges_tensor generation:  0.0006644725799560547
mini_batch_src_global generation:  0.0007073879241943359
r_  generation:  0.0076751708984375
local_output_nid generation:  0.0006053447723388672
local_in_edges_tensor generation:  0.0006766319274902344
mini_batch_src_global generation:  0.0008394718170166016
r_  generation:  0.008966922760009766
local_output_nid generation:  0.0006234645843505859
local_in_edges_tensor generation:  0.0006377696990966797
mini_batch_src_global generation:  0.0007050037384033203
r_  generation:  0.006934404373168945
local_output_nid generation:  0.0006487369537353516
local_in_edges_tensor generation:  0.0006673336029052734
mini_batch_src_global generation:  0.0008175373077392578
r_  generation:  0.007730007171630859
local_output_nid generation:  0.0006122589111328125
local_in_edges_tensor generation:  0.0006341934204101562
mini_batch_src_global generation:  0.0006885528564453125
r_  generation:  0.006845712661743164
local_output_nid generation:  0.0005946159362792969
local_in_edges_tensor generation:  0.0006513595581054688
mini_batch_src_global generation:  0.0007233619689941406
r_  generation:  0.007989645004272461
local_output_nid generation:  0.0006225109100341797
local_in_edges_tensor generation:  0.0007383823394775391
mini_batch_src_global generation:  0.0006723403930664062
r_  generation:  0.007332324981689453
local_output_nid generation:  0.0006284713745117188
local_in_edges_tensor generation:  0.0006659030914306641
mini_batch_src_global generation:  0.0006945133209228516
r_  generation:  0.008310556411743164
local_output_nid generation:  0.0006356239318847656
local_in_edges_tensor generation:  0.0008764266967773438
mini_batch_src_global generation:  0.0011208057403564453
r_  generation:  0.009548187255859375
local_output_nid generation:  0.0005950927734375
local_in_edges_tensor generation:  0.0009546279907226562
mini_batch_src_global generation:  0.0009329319000244141
r_  generation:  0.009997844696044922
local_output_nid generation:  0.0006442070007324219
local_in_edges_tensor generation:  0.005370378494262695
mini_batch_src_global generation:  0.002127408981323242
r_  generation:  0.014288902282714844
local_output_nid generation:  0.0006427764892578125
local_in_edges_tensor generation:  0.0008232593536376953
mini_batch_src_global generation:  0.0020766258239746094
r_  generation:  0.016244173049926758
local_output_nid generation:  0.0017206668853759766
local_in_edges_tensor generation:  0.00506138801574707
mini_batch_src_global generation:  0.001836538314819336
r_  generation:  0.011224031448364258
local_output_nid generation:  0.0010180473327636719
local_in_edges_tensor generation:  0.00133514404296875
mini_batch_src_global generation:  0.0012052059173583984
r_  generation:  0.011733293533325195
local_output_nid generation:  0.0009467601776123047
local_in_edges_tensor generation:  0.0007801055908203125
mini_batch_src_global generation:  0.0011515617370605469
r_  generation:  0.011308670043945312
local_output_nid generation:  0.0009183883666992188
local_in_edges_tensor generation:  0.0009467601776123047
mini_batch_src_global generation:  0.0021126270294189453
r_  generation:  0.01694178581237793
local_output_nid generation:  0.0009171962738037109
local_in_edges_tensor generation:  0.0008275508880615234
mini_batch_src_global generation:  0.0013186931610107422
r_  generation:  0.012380838394165039
----------------------check_connections_block total spend ----------------------------- 0.49545884132385254
generate_one_block  0.01862478256225586
generate_one_block  0.01599597930908203
generate_one_block  0.015748977661132812
generate_one_block  0.013799667358398438
generate_one_block  0.011658906936645508
generate_one_block  0.012193441390991211
generate_one_block  0.013772249221801758
generate_one_block  0.014824390411376953
generate_one_block  0.00942540168762207
generate_one_block  0.009054422378540039
generate_one_block  0.012673377990722656
generate_one_block  0.010469198226928711
generate_one_block  0.011405467987060547
generate_one_block  0.013370752334594727
generate_one_block  0.012110471725463867
generate_one_block  0.010304689407348633
generate_one_block  0.013651132583618164
generate_one_block  0.01059103012084961
generate_one_block  0.011030435562133789
generate_one_block  0.010698318481445312
generate_one_block  0.013096094131469727
generate_one_block  0.009959936141967773
generate_one_block  0.011139154434204102
generate_one_block  0.013958215713500977
generate_one_block  0.015804529190063477
generate_one_block  0.019387483596801758
generate_one_block  0.021274566650390625
generate_one_block  0.018091201782226562
generate_one_block  0.01728343963623047
generate_one_block  0.017749309539794922
generate_one_block  0.02413487434387207
generate_one_block  0.019997358322143555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03934979438781738
gen group dst list time:  0.010496854782104492
time for parepare:  0.027059316635131836
local_output_nid generation:  0.0011322498321533203
local_in_edges_tensor generation:  0.013033151626586914
mini_batch_src_global generation:  0.002549886703491211
r_  generation:  0.01896381378173828
local_output_nid generation:  0.0020151138305664062
local_in_edges_tensor generation:  0.001489877700805664
mini_batch_src_global generation:  0.00261688232421875
r_  generation:  0.01809406280517578
local_output_nid generation:  0.0016086101531982422
local_in_edges_tensor generation:  0.001218557357788086
mini_batch_src_global generation:  0.002057790756225586
r_  generation:  0.018047809600830078
local_output_nid generation:  0.001504659652709961
local_in_edges_tensor generation:  0.0011949539184570312
mini_batch_src_global generation:  0.002135753631591797
r_  generation:  0.01855635643005371
local_output_nid generation:  0.001493692398071289
local_in_edges_tensor generation:  0.0012235641479492188
mini_batch_src_global generation:  0.002027750015258789
r_  generation:  0.01729726791381836
local_output_nid generation:  0.0020248889923095703
local_in_edges_tensor generation:  0.0017974376678466797
mini_batch_src_global generation:  0.0027663707733154297
r_  generation:  0.02396988868713379
local_output_nid generation:  0.001867055892944336
local_in_edges_tensor generation:  0.0017087459564208984
mini_batch_src_global generation:  0.002801656723022461
r_  generation:  0.02251291275024414
local_output_nid generation:  0.0015408992767333984
local_in_edges_tensor generation:  0.0014960765838623047
mini_batch_src_global generation:  0.0027320384979248047
r_  generation:  0.02402520179748535
local_output_nid generation:  0.0012736320495605469
local_in_edges_tensor generation:  0.0011534690856933594
mini_batch_src_global generation:  0.0013341903686523438
r_  generation:  0.013515472412109375
local_output_nid generation:  0.001149892807006836
local_in_edges_tensor generation:  0.0010564327239990234
mini_batch_src_global generation:  0.0009551048278808594
r_  generation:  0.010984659194946289
local_output_nid generation:  0.0015110969543457031
local_in_edges_tensor generation:  0.001384735107421875
mini_batch_src_global generation:  0.0021314620971679688
r_  generation:  0.019427776336669922
local_output_nid generation:  0.001659393310546875
local_in_edges_tensor generation:  0.0013659000396728516
mini_batch_src_global generation:  0.0024535655975341797
r_  generation:  0.019164562225341797
local_output_nid generation:  0.0013418197631835938
local_in_edges_tensor generation:  0.0011637210845947266
mini_batch_src_global generation:  0.0019600391387939453
r_  generation:  0.016239404678344727
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0013480186462402344
mini_batch_src_global generation:  0.0022118091583251953
r_  generation:  0.019510984420776367
local_output_nid generation:  0.0014617443084716797
local_in_edges_tensor generation:  0.001371622085571289
mini_batch_src_global generation:  0.002526521682739258
r_  generation:  0.019979000091552734
local_output_nid generation:  0.0010981559753417969
local_in_edges_tensor generation:  0.001068115234375
mini_batch_src_global generation:  0.0011730194091796875
r_  generation:  0.012438535690307617
local_output_nid generation:  0.0024728775024414062
local_in_edges_tensor generation:  0.0023026466369628906
mini_batch_src_global generation:  0.003646373748779297
r_  generation:  0.03780961036682129
local_output_nid generation:  0.0022439956665039062
local_in_edges_tensor generation:  0.0031728744506835938
mini_batch_src_global generation:  0.004006147384643555
r_  generation:  0.030779361724853516
local_output_nid generation:  0.002017974853515625
local_in_edges_tensor generation:  0.0018110275268554688
mini_batch_src_global generation:  0.002910137176513672
r_  generation:  0.026079177856445312
local_output_nid generation:  0.0025146007537841797
local_in_edges_tensor generation:  0.002185344696044922
mini_batch_src_global generation:  0.0034248828887939453
r_  generation:  0.03386735916137695
local_output_nid generation:  0.002326488494873047
local_in_edges_tensor generation:  0.0023322105407714844
mini_batch_src_global generation:  0.0036134719848632812
r_  generation:  0.03322243690490723
local_output_nid generation:  0.0016293525695800781
local_in_edges_tensor generation:  0.0014150142669677734
mini_batch_src_global generation:  0.002576589584350586[23:04:23] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2758 nodes and 750480 edges into 2 parts and get 135797 edge cuts

r_  generation:  0.019784212112426758
local_output_nid generation:  0.0018391609191894531
local_in_edges_tensor generation:  0.0016388893127441406
mini_batch_src_global generation:  0.0024886131286621094
r_  generation:  0.022637128829956055
local_output_nid generation:  0.0021131038665771484
local_in_edges_tensor generation:  0.0018544197082519531
mini_batch_src_global generation:  0.0030603408813476562
r_  generation:  0.02940988540649414
local_output_nid generation:  0.0035982131958007812
local_in_edges_tensor generation:  0.006290435791015625
mini_batch_src_global generation:  0.0067882537841796875
r_  generation:  0.05661296844482422
local_output_nid generation:  0.003742218017578125
local_in_edges_tensor generation:  0.006001710891723633
mini_batch_src_global generation:  0.006433010101318359
r_  generation:  0.0561060905456543
local_output_nid generation:  0.004547595977783203
local_in_edges_tensor generation:  0.005595207214355469
mini_batch_src_global generation:  0.008333444595336914
r_  generation:  0.06676626205444336
local_output_nid generation:  0.00440526008605957
local_in_edges_tensor generation:  0.006824970245361328
mini_batch_src_global generation:  0.007026195526123047
r_  generation:  0.061603546142578125
local_output_nid generation:  0.0044057369232177734
local_in_edges_tensor generation:  0.005097866058349609
mini_batch_src_global generation:  0.006395578384399414
r_  generation:  0.05800127983093262
local_output_nid generation:  0.00426173210144043
local_in_edges_tensor generation:  0.00516510009765625
mini_batch_src_global generation:  0.006407260894775391
r_  generation:  0.05859971046447754
local_output_nid generation:  0.004143953323364258
local_in_edges_tensor generation:  0.005211353302001953
mini_batch_src_global generation:  0.008625507354736328
r_  generation:  0.0632326602935791
local_output_nid generation:  0.00478816032409668
local_in_edges_tensor generation:  0.005850315093994141
mini_batch_src_global generation:  0.009285211563110352
r_  generation:  0.07317996025085449
----------------------check_connections_block total spend ----------------------------- 1.5368573665618896
generate_one_block  0.025014638900756836
generate_one_block  0.02270197868347168
generate_one_block  0.023148298263549805
generate_one_block  0.024247169494628906
generate_one_block  0.021928787231445312
generate_one_block  0.030362844467163086
generate_one_block  0.02872443199157715
generate_one_block  0.030394554138183594
generate_one_block  0.016964197158813477
generate_one_block  0.013675212860107422
generate_one_block  0.024353981018066406
generate_one_block  0.031241893768310547
generate_one_block  0.020466089248657227
generate_one_block  0.025014162063598633
generate_one_block  0.025855541229248047
generate_one_block  0.016646146774291992
generate_one_block  0.0512545108795166
generate_one_block  0.04204154014587402
generate_one_block  0.03185009956359863
generate_one_block  0.04476809501647949
generate_one_block  0.04193305969238281
generate_one_block  0.024028301239013672
generate_one_block  0.030153989791870117
generate_one_block  0.037645578384399414
generate_one_block  0.07218527793884277
generate_one_block  0.07297086715698242
generate_one_block  0.08702397346496582
generate_one_block  0.07942438125610352
generate_one_block  0.07497215270996094
generate_one_block  0.0770101547241211
generate_one_block  0.08257317543029785
generate_one_block  0.11378693580627441
global_2_local spend time (sec) 0.0037479400634765625
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0006830692291259766
A = g.adjacency_matrix() spent  0.0005459785461425781
auxiliary_graph
Graph(num_nodes=19184, num_edges=753238,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.012941360473632812
remove nodes length
16426
auxiliary_graph.remove_nodes spent  0.025897502899169922
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2758, num_edges=753238,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0239713191986084

the counter of shared neighbor distribution
Counter({1.0: 607630, 2.0: 109890, 3.0: 24154, 4.0: 5978, 5.0: 1794, 6.0: 658, 7.0: 228, 8.0: 90, 9.0: 26, 10.0: 16, 11.0: 8, 15.0: 2, 14.0: 2, 16.0: 2, 13.0: 2})
750480
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.022 seconds
Metis partitioning: 0.060 seconds
Split the graph: 0.043 seconds
Construct subgraphs: 0.013 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.13894438743591309
1367
1391
total k batches seeds list generation spend  0.37390685081481934
after graph partition
graph partition algorithm spend time 0.37825489044189453
1367
1391
time for parepare:  0.021178245544433594
local_output_nid generation:  0.0002315044403076172
local_in_edges_tensor generation:  0.0005466938018798828
mini_batch_src_global generation:  0.0007612705230712891
r_  generation:  0.005140781402587891
local_output_nid generation:  0.0002205371856689453
local_in_edges_tensor generation:  0.0004947185516357422
mini_batch_src_global generation:  0.0009407997131347656
r_  generation:  0.006645679473876953
----------------------check_connections_block total spend ----------------------------- 0.04235363006591797
generate_one_block  0.010086536407470703
generate_one_block  0.011059761047363281
time for parepare:  0.020404338836669922
local_output_nid generation:  0.0014886856079101562
local_in_edges_tensor generation:  0.002712249755859375
mini_batch_src_global generation:  0.003345012664794922
r_  generation:  0.03454184532165527
local_output_nid generation:  0.002835988998413086
local_in_edges_tensor generation:  0.003083944320678711
mini_batch_src_global generation:  0.0045888423919677734
r_  generation:  0.042879343032836914
----------------------check_connections_block total spend ----------------------------- 0.13628363609313965
generate_one_block  0.050382137298583984
generate_one_block  0.06143069267272949
----------===============-------------===============-------------the number of batches *****---- 33

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.5368573665618896
block generation total time  1.3443620204925537
average batch blocks generation time:  0.0420113131403923
pseudo mini batch 0 input nodes size: 16561
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8232421875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8427734375 GB
    Memory Allocated: 0.010674476623535156  GigaBytes
Max Memory Allocated: 0.010674476623535156  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8427734375 GB
    Memory Allocated: 0.010695457458496094  GigaBytes
Max Memory Allocated: 0.010695457458496094  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8427734375 GB
    Memory Allocated: 0.010695457458496094  GigaBytes
Max Memory Allocated: 0.010695457458496094  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8916015625 GB
    Memory Allocated: 0.011180877685546875  GigaBytes
Max Memory Allocated: 0.011180877685546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8916015625 GB
    Memory Allocated: 0.011180877685546875  GigaBytes
Max Memory Allocated: 0.011180877685546875  GigaBytes

first layer input nodes number: 16561
first layer output nodes number: 6469
edges number: 43439
input nodes number: 6469
output nodes number: 2805
edges number: 21581
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6689453125 GB
    Memory Allocated: 0.6801838874816895  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6689453125 GB
    Memory Allocated: 0.6801848411560059  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.015322685241699219  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

pseudo mini batch 1 input nodes size: 15659
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013889789581298828  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013889789581298828  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.021356582641601562  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.021378040313720703  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013460159301757812  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013909339904785156  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013909339904785156  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

first layer input nodes number: 15659
first layer output nodes number: 6259
edges number: 39631
input nodes number: 6259
output nodes number: 2839
edges number: 20584
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.6394400596618652  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.6394405364990234  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.014806747436523438  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

pseudo mini batch 2 input nodes size: 12510
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013465404510498047  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.013465404510498047  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.01943063735961914  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.019452571868896484  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.01196432113647461  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.012466907501220703  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7119140625 GB
    Memory Allocated: 0.012466907501220703  GigaBytes
Max Memory Allocated: 0.7062110900878906  GigaBytes

first layer input nodes number: 12510
first layer output nodes number: 5900
edges number: 41738
input nodes number: 5900
output nodes number: 2899
edges number: 25575
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7978515625 GB
    Memory Allocated: 0.7262825965881348  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7978515625 GB
    Memory Allocated: 0.726283073425293  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013428688049316406  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

pseudo mini batch 3 input nodes size: 13679
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.011972904205322266  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.011972904205322266  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.018495559692382812  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.018517017364501953  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.012529850006103516  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013020992279052734  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013020992279052734  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

first layer input nodes number: 13679
first layer output nodes number: 6223
edges number: 41476
input nodes number: 6223
output nodes number: 2878
edges number: 24297
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.7064943313598633  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.7064948081970215  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013965129852294922  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

pseudo mini batch 4 input nodes size: 14079
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.012526988983154297  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.012526988983154297  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.019570350646972656  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.019591808319091797  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.01304769515991211  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013483524322509766  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.013483524322509766  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

first layer input nodes number: 14079
first layer output nodes number: 6314
edges number: 38437
input nodes number: 6314
output nodes number: 2819
edges number: 19916
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.6279087066650391  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.6279091835021973  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.014338493347167969  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

pseudo mini batch 5 input nodes size: 21204
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.01303863525390625  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.01303863525390625  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.023149490356445312  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.02317047119140625  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.01610565185546875  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.0166473388671875  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8486328125 GB
    Memory Allocated: 0.0166473388671875  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

first layer input nodes number: 21204
first layer output nodes number: 8310
edges number: 53430
input nodes number: 8310
output nodes number: 2759
edges number: 19130
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.7304835319519043  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.7304840087890625  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.017699241638183594  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

pseudo mini batch 6 input nodes size: 15529
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.016097068786621094  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.016097068786621094  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.023501873016357422  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.023523807525634766  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.013391971588134766  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.013967037200927734  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8779296875 GB
    Memory Allocated: 0.013967037200927734  GigaBytes
Max Memory Allocated: 0.7557978630065918  GigaBytes

first layer input nodes number: 15529
first layer output nodes number: 7655
edges number: 52493
input nodes number: 7655
output nodes number: 2907
edges number: 24506
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.7975063323974609  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.7975068092346191  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.015067577362060547  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

pseudo mini batch 7 input nodes size: 15838
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.01341390609741211  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.01341390609741211  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.020966053009033203  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.020987987518310547  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.013561248779296875  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.014185905456542969  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.014185905456542969  GigaBytes
Max Memory Allocated: 0.8259906768798828  GigaBytes

first layer input nodes number: 15838
first layer output nodes number: 7704
edges number: 56645
input nodes number: 7704
output nodes number: 2927
edges number: 27115
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.864346981048584  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9169921875 GB
    Memory Allocated: 0.8643474578857422  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015340328216552734  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 8 input nodes size: 11298
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013564109802246094  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013564109802246094  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.018951416015625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.018973350524902344  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011399269104003906  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011734962463378906  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011734962463378906  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 11298
first layer output nodes number: 5535
edges number: 28789
input nodes number: 5535
output nodes number: 2889
edges number: 16216
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.49480724334716797  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.49480772018432617  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01242828369140625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 9 input nodes size: 9176
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011393547058105469  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011393547058105469  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015769004821777344  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015790939331054688  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010381698608398438  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010671615600585938  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010671615600585938  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 9176
first layer output nodes number: 5240
edges number: 24369
input nodes number: 5240
output nodes number: 2911
edges number: 14374
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.4329051971435547  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.4329056739807129  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01129150390625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 10 input nodes size: 16213
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01038503646850586  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01038503646850586  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.018115997314453125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01813793182373047  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01374053955078125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014247894287109375  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014247894287109375  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 16213
first layer output nodes number: 6645
edges number: 44877
input nodes number: 6645
output nodes number: 2899
edges number: 23163
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.720606803894043  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.7206072807312012  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015228748321533203  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 11 input nodes size: 17788
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013738632202148438  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013738632202148438  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.022220611572265625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.022241592407226562  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014488697052001953  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01493692398071289  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01493692398071289  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 17788
first layer output nodes number: 6950
edges number: 42131
input nodes number: 6950
output nodes number: 2771
edges number: 17890
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6288037300109863  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6288042068481445  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015820026397705078  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 12 input nodes size: 11722
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014469623565673828  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014469623565673828  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.02005910873413086  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.02008056640625  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011577606201171875  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011993408203125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011993408203125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 11722
first layer output nodes number: 5858
edges number: 35246
input nodes number: 5858
output nodes number: 2879
edges number: 20396
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6017436981201172  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6017441749572754  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.012829780578613281  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 13 input nodes size: 15873
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011593818664550781  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.011593818664550781  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.019162654876708984  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.019184589385986328  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013573646545410156  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014063835144042969  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.014063835144042969  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 15873
first layer output nodes number: 6947
edges number: 43630
input nodes number: 6947
output nodes number: 2901
edges number: 22143
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6966118812561035  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.6966123580932617  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015030384063720703  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 14 input nodes size: 15944
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013576984405517578  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013576984405517578  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.021179676055908203  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.021201610565185547  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01361083984375  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.0141143798828125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.0141143798828125  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 15944
first layer output nodes number: 7101
edges number: 45506
input nodes number: 7101
output nodes number: 2922
edges number: 21999
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.7063660621643066  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.7063665390014648  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.015096664428710938  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 15 input nodes size: 10316
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013614177703857422  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.013614177703857422  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01853322982788086  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.018555164337158203  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010930538177490234  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01128530502319336  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.01128530502319336  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 10316
first layer output nodes number: 5240
edges number: 28668
input nodes number: 5240
output nodes number: 2885
edges number: 18851
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.5271744728088379  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.5271749496459961  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.012002944946289062  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

pseudo mini batch 16 input nodes size: 30634
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010924816131591797  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.010924816131591797  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.025532245635986328  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.025553226470947266  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.020612239837646484  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.021445751190185547  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9716796875 GB
    Memory Allocated: 0.021445751190185547  GigaBytes
Max Memory Allocated: 0.8953738212585449  GigaBytes

first layer input nodes number: 30634
first layer output nodes number: 11577
edges number: 89201
input nodes number: 11577
output nodes number: 2779
edges number: 22573
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2001953125 GB
    Memory Allocated: 1.0678153038024902  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2001953125 GB
    Memory Allocated: 1.0678157806396484  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.022951602935791016  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 17 input nodes size: 31373
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02059650421142578  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02059650421142578  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03555631637573242  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03557729721069336  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02094888687133789  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021593570709228516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021593570709228516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 31373
first layer output nodes number: 10054
edges number: 69544
input nodes number: 10054
output nodes number: 2759
edges number: 16816
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8363094329833984  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8363099098205566  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02285289764404297  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 18 input nodes size: 24855
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.020946025848388672  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.020946025848388672  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.032797813415527344  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03281974792480469  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01783895492553711  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01839303970336914  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01839303970336914  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 24855
first layer output nodes number: 8619
edges number: 55706
input nodes number: 8619
output nodes number: 2918
edges number: 18484
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.7460761070251465  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.7460765838623047  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01952075958251953  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 19 input nodes size: 36375
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017862319946289062  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017862319946289062  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.035207271575927734  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03522825241088867  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.023354530334472656  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.024039268493652344  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.024039268493652344  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 36375
first layer output nodes number: 10689
edges number: 74816
input nodes number: 10689
output nodes number: 2773
edges number: 16964
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.874547004699707  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8745474815368652  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02537250518798828  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 20 input nodes size: 31511
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.023333072662353516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.023333072662353516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.03835868835449219  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.038379669189453125  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021013736724853516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021692752838134766  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021692752838134766  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 31511
first layer output nodes number: 10189
edges number: 71342
input nodes number: 10189
output nodes number: 2764
edges number: 19611
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8822736740112305  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.8822741508483887  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.023012638092041016  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 21 input nodes size: 17552
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021012306213378906  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.021012306213378906  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.029381752014160156  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.029403209686279297  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014356613159179688  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014787673950195312  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014787673950195312  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 17552
first layer output nodes number: 6787
edges number: 40472
input nodes number: 6787
output nodes number: 2874
edges number: 17189
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.6029801368713379  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.6029806137084961  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01568126678466797  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 22 input nodes size: 20538
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014373302459716797  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.014373302459716797  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.024166584014892578  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.024188518524169922  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01579761505126953  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01630878448486328  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01630878448486328  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 20538
first layer output nodes number: 7980
edges number: 49486
input nodes number: 7980
output nodes number: 2910
edges number: 18953
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.6984906196594238  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.698491096496582  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.01733255386352539  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 23 input nodes size: 25001
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.015802860260009766  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.015802860260009766  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.027724266052246094  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.027746200561523438  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017930984497070312  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.018609046936035156  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.018609046936035156  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 25001
first layer output nodes number: 9306
edges number: 66277
input nodes number: 9306
output nodes number: 2927
edges number: 24657
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.9246153831481934  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.9246158599853516  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.019901752471923828  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

pseudo mini batch 24 input nodes size: 47069
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017933368682861328  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.017933368682861328  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.04037761688232422  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.040398597717285156  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.028455257415771484  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02958059310913086  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2470703125 GB
    Memory Allocated: 0.02958059310913086  GigaBytes
Max Memory Allocated: 1.094235897064209  GigaBytes

first layer input nodes number: 47069
first layer output nodes number: 15732
edges number: 126548
input nodes number: 15732
output nodes number: 2765
edges number: 24413
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5615234375 GB
    Memory Allocated: 1.3943395614624023  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.5615234375 GB
    Memory Allocated: 1.3943400382995605  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.031598567962646484  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

pseudo mini batch 25 input nodes size: 38514
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.028431415557861328  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.028431415557861328  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.046796321868896484  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.04681730270385742  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.024352073669433594  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.025583267211914062  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5849609375 GB
    Memory Allocated: 0.025583267211914062  GigaBytes
Max Memory Allocated: 1.4243192672729492  GigaBytes

first layer input nodes number: 38514
first layer output nodes number: 15451
edges number: 131734
input nodes number: 15451
output nodes number: 2758
edges number: 33286
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8955078125 GB
    Memory Allocated: 1.5514216423034668  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8955078125 GB
    Memory Allocated: 1.551422119140625  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.02772665023803711  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

pseudo mini batch 26 input nodes size: 47388
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.024350643157958984  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.024350643157958984  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.047788143157958984  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.047809600830078125  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.02942371368408203  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.03084564208984375  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9287109375 GB
    Memory Allocated: 0.03084564208984375  GigaBytes
Max Memory Allocated: 1.5986342430114746  GigaBytes

first layer input nodes number: 47388
first layer output nodes number: 18377
edges number: 157161
input nodes number: 18377
output nodes number: 2867
edges number: 33553
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.7585396766662598  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.758540153503418  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.03333234786987305  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

pseudo mini batch 27 input nodes size: 46552
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.029439926147460938  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.029439926147460938  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.05163764953613281  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.05165863037109375  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02819967269897461  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.029480457305908203  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.029480457305908203  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

first layer input nodes number: 46552
first layer output nodes number: 16990
edges number: 142989
input nodes number: 16990
output nodes number: 2758
edges number: 28687
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.5803513526916504  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.5803518295288086  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.03171873092651367  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

pseudo mini batch 28 input nodes size: 43098
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.028183460235595703  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.028183460235595703  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.0496678352355957  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.04968881607055664  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.027470111846923828  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.028707027435302734  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.028707027435302734  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

first layer input nodes number: 43098
first layer output nodes number: 16283
edges number: 137201
input nodes number: 16283
output nodes number: 2760
edges number: 28692
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.5267534255981445  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.5267539024353027  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.030877113342285156  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

pseudo mini batch 29 input nodes size: 42852
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02747058868408203  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02747058868408203  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.047904014587402344  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.04792499542236328  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.026419639587402344  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.027681350708007812  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.027681350708007812  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

first layer input nodes number: 42852
first layer output nodes number: 16526
edges number: 139956
input nodes number: 16526
output nodes number: 2758
edges number: 29296
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.567251205444336  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 1.5672516822814941  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02988290786743164  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

pseudo mini batch 30 input nodes size: 38575
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02641916275024414  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02641916275024414  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.04481315612792969  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.04483509063720703  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.02438068389892578  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.0258331298828125  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4248046875 GB
    Memory Allocated: 0.0258331298828125  GigaBytes
Max Memory Allocated: 1.8038091659545898  GigaBytes

first layer input nodes number: 38575
first layer output nodes number: 17386
edges number: 154209
input nodes number: 17386
output nodes number: 2923
edges number: 40625
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8994140625 GB
    Memory Allocated: 1.8185510635375977  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8994140625 GB
    Memory Allocated: 1.8185515403747559  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02832317352294922  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 31 input nodes size: 31925
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.024405479431152344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.024405479431152344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03962850570678711  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03963899612426758  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.021223068237304688  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02196979522705078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02196979522705078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 31925
first layer output nodes number: 9929
edges number: 85413
input nodes number: 9929
output nodes number: 1367
edges number: 14683
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.9081401824951172  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.9081406593322754  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.0230712890625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 32 input nodes size: 36912
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02099132537841797  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02099132537841797  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03859233856201172  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03860282897949219  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.023369312286376953  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.024299144744873047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.024299144744873047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 36912
first layer output nodes number: 11928
edges number: 106673
input nodes number: 11928
output nodes number: 1391
edges number: 18032
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 1.1273102760314941  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 1.1273107528686523  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025925636291503906  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03147602081298828  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03147602081298828  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009910901387532553 |0.013875932404489227 |0.13192433299440326 |0.00013834779912775213 |0.1399201046336781 |0.008201837539672852 |
----------------------------------------------------------pseudo_mini_loss sum 5.297259330749512[23:04:54] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 29070896 edges into 32 parts and get 9246247 edge cuts

 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1142266
Number of first layer input nodes during this epoch:  824113
Number of first layer output nodes during this epoch:  318153
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03147554397583008  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02254486083984375
global_2_local spend time (sec) 0.05145072937011719
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004343271255493164
A = g.adjacency_matrix() spent  0.006119966506958008
auxiliary_graph
Graph(num_nodes=154609, num_edges=29161837,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10186219215393066
remove nodes length
63668
auxiliary_graph.remove_nodes spent  1.5476553440093994
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29161837,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.299109697341919

the counter of shared neighbor distribution
Counter({1.0: 23512832, 2.0: 4033528, 3.0: 1010720, 4.0: 307066, 5.0: 110996, 6.0: 47742, 7.0: 21964, 8.0: 11366, 9.0: 6212, 10.0: 3480, 11.0: 1996, 12.0: 1116, 13.0: 654, 14.0: 456, 15.0: 268, 16.0: 194, 17.0: 166, 18.0: 66, 19.0: 50, 20.0: 18, 21.0: 6})
29070896
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 29070893, 29070894, 29070895])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23512832, 2.0: 4033528, 3.0: 1010720, 4.0: 307066, 5.0: 110996, 6.0: 47742, 7.0: 21964, 8.0: 11366, 9.0: 6212, 10.0: 3480, 11.0: 1996, 12.0: 1116, 13.0: 654, 14.0: 456, 15.0: 268, 16.0: 194, 17.0: 166, 18.0: 66, 19.0: 50, 20.0: 18, 21.0: 6})
Convert a graph into a bidirected graph: 2.105 seconds
Metis partitioning: 6.501 seconds
Split the graph: 1.010 seconds
Construct subgraphs: 0.118 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.749823808670044
2864
2920
2927
2804
2758
2833
2770
2759
2759
2758
2914
2758
2784
2788
2758
2808
2758
2927
2900
2875
2764
2822
2892
2913
2881
2913
2924
2891
2910
2927
2891
2791
total k batches seeds list generation spend  21.787200212478638
after graph partition
graph partition algorithm spend time 21.885488033294678
2864
2920
2927
2804
2758
2833
2770
2759
2759
2758
2914
2758
2784
2788
2758
2808
2758
2927
2900
2875
2764
2822
2892
2913
2881
2913
2924
2891
2910
2927
2891
2791
partition_len_list
[7621, 6913, 9489, 8508, 15175, 9739, 9562, 12728, 15783, 17365, 18002, 17748, 14207, 13903, 17657, 18123, 9485, 7861, 6743, 7608, 6242, 6488, 6656, 6021, 5584, 5271, 6632, 7933, 5860, 6927, 6450, 4580]
shared_neighbor_graph_partition_s0 selection method  spend 21.9962317943573
time for parepare:  0.01985454559326172
local_output_nid generation:  0.0005819797515869141
local_in_edges_tensor generation:  0.0009264945983886719
mini_batch_src_global generation:  0.0009212493896484375
r_  generation:  0.006882667541503906
local_output_nid generation:  0.0006976127624511719
local_in_edges_tensor generation:  0.0007741451263427734
mini_batch_src_global generation:  0.0009052753448486328
r_  generation:  0.0072994232177734375
local_output_nid generation:  0.0007851123809814453
local_in_edges_tensor generation:  0.0008113384246826172
mini_batch_src_global generation:  0.0010492801666259766
r_  generation:  0.009821653366088867
local_output_nid generation:  0.0008132457733154297
local_in_edges_tensor generation:  0.0006663799285888672
mini_batch_src_global generation:  0.0008158683776855469
r_  generation:  0.007534027099609375
local_output_nid generation:  0.0007750988006591797
local_in_edges_tensor generation:  0.0007865428924560547
mini_batch_src_global generation:  0.0012667179107666016
r_  generation:  0.012032747268676758
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.0006628036499023438
mini_batch_src_global generation:  0.0009279251098632812
r_  generation:  0.007425785064697266
local_output_nid generation:  0.0007774829864501953
local_in_edges_tensor generation:  0.0007038116455078125
mini_batch_src_global generation:  0.0006697177886962891
r_  generation:  0.006958484649658203
local_output_nid generation:  0.0007498264312744141
local_in_edges_tensor generation:  0.0007205009460449219
mini_batch_src_global generation:  0.0009071826934814453
r_  generation:  0.00970768928527832
local_output_nid generation:  0.0007464885711669922
local_in_edges_tensor generation:  0.0007388591766357422
mini_batch_src_global generation:  0.0010771751403808594
r_  generation:  0.01122903823852539
local_output_nid generation:  0.0007600784301757812
local_in_edges_tensor generation:  0.0020673274993896484
mini_batch_src_global generation:  0.0011987686157226562
r_  generation:  0.011028528213500977
local_output_nid generation:  0.0009241104125976562
local_in_edges_tensor generation:  0.0008044242858886719
mini_batch_src_global generation:  0.0020842552185058594
r_  generation:  0.01618027687072754
local_output_nid generation:  0.0008711814880371094
local_in_edges_tensor generation:  0.0007426738739013672
mini_batch_src_global generation:  0.001901388168334961
r_  generation:  0.014368772506713867
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.0007421970367431641
mini_batch_src_global generation:  0.0010993480682373047
r_  generation:  0.010324954986572266
local_output_nid generation:  0.0008499622344970703
local_in_edges_tensor generation:  0.0006914138793945312
mini_batch_src_global generation:  0.000946044921875
r_  generation:  0.009791374206542969
local_output_nid generation:  0.0008552074432373047
local_in_edges_tensor generation:  0.0007114410400390625
mini_batch_src_global generation:  0.0010886192321777344
r_  generation:  0.011119365692138672
local_output_nid generation:  0.001954317092895508
local_in_edges_tensor generation:  0.0011298656463623047
mini_batch_src_global generation:  0.0019450187683105469
r_  generation:  0.01210331916809082
local_output_nid generation:  0.0010046958923339844
local_in_edges_tensor generation:  0.0007765293121337891
mini_batch_src_global generation:  0.0008158683776855469
r_  generation:  0.007748603820800781
local_output_nid generation:  0.0009679794311523438
local_in_edges_tensor generation:  0.0007851123809814453
mini_batch_src_global generation:  0.0009691715240478516
r_  generation:  0.010700464248657227
local_output_nid generation:  0.0009527206420898438
local_in_edges_tensor generation:  0.0007402896881103516
mini_batch_src_global generation:  0.0009000301361083984
r_  generation:  0.008841753005981445
local_output_nid generation:  0.0009100437164306641
local_in_edges_tensor generation:  0.0007970333099365234
mini_batch_src_global generation:  0.0010044574737548828
r_  generation:  0.009936094284057617
local_output_nid generation:  0.0008223056793212891
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0008685588836669922
r_  generation:  0.008716583251953125
local_output_nid generation:  0.0008361339569091797
local_in_edges_tensor generation:  0.0007026195526123047
mini_batch_src_global generation:  0.0007822513580322266
r_  generation:  0.008629798889160156
local_output_nid generation:  0.0008449554443359375
local_in_edges_tensor generation:  0.0007724761962890625
mini_batch_src_global generation:  0.0008754730224609375
r_  generation:  0.009530067443847656
local_output_nid generation:  0.0009076595306396484
local_in_edges_tensor generation:  0.0007410049438476562
mini_batch_src_global generation:  0.0009148120880126953
r_  generation:  0.010034322738647461
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.000789642333984375
r_  generation:  0.006406068801879883
local_output_nid generation:  0.0008766651153564453
local_in_edges_tensor generation:  0.0008444786071777344
mini_batch_src_global generation:  0.0006079673767089844
r_  generation:  0.006824970245361328
local_output_nid generation:  0.0008280277252197266
local_in_edges_tensor generation:  0.0007252693176269531
mini_batch_src_global generation:  0.0008041858673095703
r_  generation:  0.008923768997192383
local_output_nid generation:  0.0008454322814941406
local_in_edges_tensor generation:  0.0007290840148925781
mini_batch_src_global generation:  0.0008111000061035156
r_  generation:  0.008589029312133789
local_output_nid generation:  0.0008084774017333984
local_in_edges_tensor generation:  0.0006973743438720703
mini_batch_src_global generation:  0.0007522106170654297
r_  generation:  0.008690118789672852
local_output_nid generation:  0.0008282661437988281
local_in_edges_tensor generation:  0.0007882118225097656
mini_batch_src_global generation:  0.0009982585906982422
r_  generation:  0.009081363677978516
local_output_nid generation:  0.0008041858673095703
local_in_edges_tensor generation:  0.0007119178771972656
mini_batch_src_global generation:  0.0008213520050048828
r_  generation:  0.009820222854614258
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.0007414817810058594
mini_batch_src_global generation:  0.0006704330444335938
r_  generation:  0.006880998611450195
----------------------check_connections_block total spend ----------------------------- 0.4894120693206787
generate_one_block  0.023415803909301758
generate_one_block  0.01282358169555664
generate_one_block  0.01589202880859375
generate_one_block  0.011581659317016602
generate_one_block  0.021013975143432617
generate_one_block  0.011365175247192383
generate_one_block  0.010920286178588867
generate_one_block  0.01486659049987793
generate_one_block  0.017640113830566406
generate_one_block  0.01832294464111328
generate_one_block  0.02257227897644043
generate_one_block  0.04536294937133789
generate_one_block  0.03246331214904785
generate_one_block  0.024599790573120117
generate_one_block  0.0294647216796875
generate_one_block  0.023410320281982422
generate_one_block  0.016960859298706055
generate_one_block  0.015120744705200195
generate_one_block  0.012512445449829102
generate_one_block  0.014675378799438477
generate_one_block  0.012251615524291992
generate_one_block  0.011886358261108398
generate_one_block  0.013275861740112305
generate_one_block  0.01433706283569336
generate_one_block  0.009050130844116211
generate_one_block  0.009417295455932617
generate_one_block  0.012605428695678711
generate_one_block  0.012276411056518555
generate_one_block  0.011107206344604492
generate_one_block  0.012663602828979492
generate_one_block  0.012437820434570312
generate_one_block  0.009415388107299805
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.050008535385131836
gen group dst list time:  0.011216402053833008
time for parepare:  0.02619338035583496
local_output_nid generation:  0.00165557861328125
local_in_edges_tensor generation:  0.011876583099365234
mini_batch_src_global generation:  0.002573728561401367
r_  generation:  0.020500659942626953
local_output_nid generation:  0.0023119449615478516
local_in_edges_tensor generation:  0.001909017562866211
mini_batch_src_global generation:  0.0051670074462890625
r_  generation:  0.037491798400878906
local_output_nid generation:  0.0036773681640625
local_in_edges_tensor generation:  0.003083467483520508
mini_batch_src_global generation:  0.004678487777709961
r_  generation:  0.0374760627746582
local_output_nid generation:  0.0022096633911132812
local_in_edges_tensor generation:  0.0025284290313720703
mini_batch_src_global generation:  0.003000020980834961
r_  generation:  0.026934385299682617
local_output_nid generation:  0.00380706787109375
local_in_edges_tensor generation:  0.004092693328857422
mini_batch_src_global generation:  0.005551338195800781
r_  generation:  0.052582502365112305
local_output_nid generation:  0.0027163028717041016
local_in_edges_tensor generation:  0.0024368762969970703
mini_batch_src_global generation:  0.0037775039672851562
r_  generation:  0.029261112213134766
local_output_nid generation:  0.002525806427001953
local_in_edges_tensor generation:  0.0021300315856933594
mini_batch_src_global generation:  0.003175020217895508
r_  generation:  0.02937459945678711
local_output_nid generation:  0.0030257701873779297
local_in_edges_tensor generation:  0.0030434131622314453
mini_batch_src_global generation:  0.004422903060913086
r_  generation:  0.04238414764404297
local_output_nid generation:  0.0041010379791259766
local_in_edges_tensor generation:  0.0047872066497802734
mini_batch_src_global generation:  0.006790876388549805
r_  generation:  0.05541872978210449
local_output_nid generation:  0.004464864730834961
local_in_edges_tensor generation:  0.005339622497558594
mini_batch_src_global generation:  0.009289264678955078
r_  generation:  0.06490731239318848
local_output_nid generation:  0.004664897918701172
local_in_edges_tensor generation:  0.0056378841400146484
mini_batch_src_global generation:  0.007322072982788086
r_  generation:  0.06563234329223633
local_output_nid generation:  0.004454851150512695
local_in_edges_tensor generation:  0.006513833999633789
mini_batch_src_global generation:  0.007063150405883789
r_  generation:  0.06357765197753906
local_output_nid generation:  0.0037708282470703125
local_in_edges_tensor generation:  0.004218339920043945
mini_batch_src_global generation:  0.00566864013671875
r_  generation:  0.048653364181518555
local_output_nid generation:  0.0036911964416503906
local_in_edges_tensor generation:  0.0032804012298583984
mini_batch_src_global generation:  0.005048513412475586
r_  generation:  0.048308372497558594
local_output_nid generation:  0.0045337677001953125
local_in_edges_tensor generation:  0.004461765289306641
mini_batch_src_global generation:  0.006593227386474609
r_  generation:  0.06859254837036133
local_output_nid generation:  0.0047223567962646484
local_in_edges_tensor generation:  0.006419181823730469
mini_batch_src_global generation:  0.0067746639251708984
r_  generation:  0.06614971160888672
local_output_nid generation:  0.0028116703033447266
local_in_edges_tensor generation:  0.002357959747314453
mini_batch_src_global generation:  0.004086494445800781
r_  generation:  0.03028416633605957
local_output_nid generation:  0.002161741256713867
local_in_edges_tensor generation:  0.001977682113647461
mini_batch_src_global generation:  0.002150297164916992
r_  generation:  0.024547100067138672
local_output_nid generation:  0.0017285346984863281
local_in_edges_tensor generation:  0.0015425682067871094
mini_batch_src_global generation:  0.0016770362854003906
r_  generation:  0.019416332244873047
local_output_nid generation:  0.0018045902252197266
local_in_edges_tensor generation:  0.0015532970428466797
mini_batch_src_global generation:  0.0017597675323486328
r_  generation:  0.022176504135131836
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.0013821125030517578
mini_batch_src_global generation:  0.001558065414428711
r_  generation:  0.018275976181030273
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0014007091522216797
mini_batch_src_global generation:  0.0014636516571044922
r_  generation:  0.018271923065185547
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0014328956604003906
mini_batch_src_global generation:  0.0014944076538085938
r_  generation:  0.019308090209960938
local_output_nid generation:  0.0013985633850097656
local_in_edges_tensor generation:  0.0012822151184082031
mini_batch_src_global generation:  0.001474142074584961
r_  generation:  0.017844200134277344
local_output_nid generation:  0.001360177993774414
local_in_edges_tensor generation:  0.0012366771697998047
mini_batch_src_global generation:  0.001300811767578125
r_  generation:  0.013143777847290039
local_output_nid generation: [23:05:00] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2808 nodes and 1253798 edges into 2 parts and get 262609 edge cuts
 0.0012142658233642578
local_in_edges_tensor generation:  0.0013210773468017578
mini_batch_src_global generation:  0.001012563705444336
r_  generation:  0.011546850204467773
local_output_nid generation:  0.0016224384307861328
local_in_edges_tensor generation:  0.0014317035675048828
mini_batch_src_global generation:  0.0013625621795654297
r_  generation:  0.01885986328125
local_output_nid generation:  0.001817941665649414
local_in_edges_tensor generation:  0.0016624927520751953
mini_batch_src_global generation:  0.0016753673553466797
r_  generation:  0.021776199340820312
local_output_nid generation:  0.0014047622680664062
local_in_edges_tensor generation:  0.0012753009796142578
mini_batch_src_global generation:  0.0013387203216552734
r_  generation:  0.015654325485229492
local_output_nid generation:  0.001524209976196289
local_in_edges_tensor generation:  0.001447916030883789
mini_batch_src_global generation:  0.0014569759368896484
r_  generation:  0.019345521926879883
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.0014564990997314453
mini_batch_src_global generation:  0.00145721435546875
r_  generation:  0.017630815505981445
local_output_nid generation:  0.0010838508605957031
local_in_edges_tensor generation:  0.0009894371032714844
mini_batch_src_global generation:  0.0010223388671875
r_  generation:  0.010226726531982422
----------------------check_connections_block total spend ----------------------------- 1.5820889472961426
generate_one_block  0.02670598030090332
generate_one_block  0.03151130676269531
generate_one_block  0.04001474380493164
generate_one_block  0.03263664245605469
generate_one_block  0.07341670989990234
generate_one_block  0.037886619567871094
generate_one_block  0.03748631477355957
generate_one_block  0.05790281295776367
generate_one_block  0.07613325119018555
generate_one_block  0.08402514457702637
generate_one_block  0.08909964561462402
generate_one_block  0.08581709861755371
generate_one_block  0.0646514892578125
generate_one_block  0.0633230209350586
generate_one_block  0.08377361297607422
generate_one_block  0.08636164665222168
generate_one_block  0.038079261779785156
generate_one_block  0.03136587142944336
generate_one_block  0.024798154830932617
generate_one_block  0.028539657592773438
generate_one_block  0.023929119110107422
generate_one_block  0.023847341537475586
generate_one_block  0.025007247924804688
generate_one_block  0.0230863094329834
generate_one_block  0.016948699951171875
generate_one_block  0.014677286148071289
generate_one_block  0.025432586669921875
generate_one_block  0.02894449234008789
generate_one_block  0.01941657066345215
generate_one_block  0.025471925735473633
generate_one_block  0.022776126861572266
generate_one_block  0.013906478881835938
global_2_local spend time (sec) 0.0036263465881347656
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0006690025329589844
A = g.adjacency_matrix() spent  0.0004734992980957031
auxiliary_graph
Graph(num_nodes=18123, num_edges=1256606,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.012398958206176758
remove nodes length
15315
auxiliary_graph.remove_nodes spent  0.04362368583679199
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2808, num_edges=1256606,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0433802604675293

the counter of shared neighbor distribution
Counter({1.0: 1134282, 2.0: 100254, 3.0: 14520, 4.0: 3124, 5.0: 834, 6.0: 396, 7.0: 158, 8.0: 98, 9.0: 54, 10.0: 36, 12.0: 18, 11.0: 16, 15.0: 2, 14.0: 2, 17.0: 2, 13.0: 2})
1253798
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.038 seconds
Metis partitioning: 0.075 seconds
Split the graph: 0.154 seconds
Construct subgraphs: 0.032 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.29906296730041504
1420
1388
total k batches seeds list generation spend  0.6460356712341309
after graph partition
graph partition algorithm spend time 0.6830179691314697
1420
1388
time for parepare:  0.03283190727233887
local_output_nid generation:  0.0003418922424316406
local_in_edges_tensor generation:  0.003118276596069336
mini_batch_src_global generation:  0.0012273788452148438
r_  generation:  0.009052753448486328
local_output_nid generation:  0.0003173351287841797
local_in_edges_tensor generation:  0.0014820098876953125
mini_batch_src_global generation:  0.0008952617645263672
r_  generation:  0.006089448928833008
----------------------check_connections_block total spend ----------------------------- 0.06326055526733398
generate_one_block  0.01732945442199707
generate_one_block  0.008208990097045898
time for parepare:  0.019771814346313477
local_output_nid generation:  0.001968860626220703
local_in_edges_tensor generation:  0.006272554397583008
mini_batch_src_global generation:  0.013843536376953125
r_  generation:  0.07812714576721191
local_output_nid generation:  0.002877473831176758
local_in_edges_tensor generation:  0.003492116928100586
mini_batch_src_global generation:  0.006226062774658203
r_  generation:  0.03423023223876953
----------------------check_connections_block total spend ----------------------------- 0.19978094100952148
generate_one_block  0.06720328330993652
generate_one_block  0.039153337478637695
----------===============-------------===============-------------the number of batches *****---- 33

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03147554397583008  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

connection checking time:  1.5820889472961426
block generation total time  1.3569731712341309
average batch blocks generation time:  0.04240541160106659
block dataloader generation time/epoch 27.361239433288574
pseudo mini batch 0 input nodes size: 18688
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.028922080993652344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.028922080993652344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.037833213806152344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.037854671478271484  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020243167877197266  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020696163177490234  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020696163177490234  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 18688
first layer output nodes number: 7621
edges number: 43736
input nodes number: 7621
output nodes number: 2864
edges number: 16991
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.6351618766784668  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.6351628303527832  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.021839618682861328  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 1 input nodes size: 18533
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02046346664428711  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02046346664428711  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.029300689697265625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02932262420654297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020390033721923828  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020828723907470703  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020828723907470703  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 18533
first layer output nodes number: 6913
edges number: 41348
input nodes number: 6913
output nodes number: 2920
edges number: 17383
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.6177806854248047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.6177811622619629  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02173328399658203  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 2 input nodes size: 25319
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020398616790771484  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.020398616790771484  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.032471656799316406  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03249359130859375  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02363443374633789  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.024329662322998047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.024329662322998047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 25319
first layer output nodes number: 9489
edges number: 67865
input nodes number: 9489
output nodes number: 2927
edges number: 25311
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.9439244270324707  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.9439249038696289  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.0256500244140625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 3 input nodes size: 23453
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.023635387420654297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.023635387420654297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03481864929199219  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.034839630126953125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02274465560913086  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.023296833038330078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.023296833038330078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 23453
first layer output nodes number: 8508
edges number: 55923
input nodes number: 8508
output nodes number: 2804
edges number: 18174
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.7470149993896484  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.7470154762268066  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02436351776123047  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 4 input nodes size: 38550
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02272653579711914  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02272653579711914  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.04110860824584961  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.04112958908081055  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02992534637451172  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03111553192138672  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03111553192138672  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 38550
first layer output nodes number: 15175
edges number: 128031
input nodes number: 15175
output nodes number: 2758
edges number: 31605
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 1.5022501945495605  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 1.5022506713867188  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03319358825683594  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 5 input nodes size: 30013
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.029918193817138672  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.029918193817138672  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.04422950744628906  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.0442509651184082  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025847911834716797  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.026454448699951172  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.026454448699951172  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 30013
first layer output nodes number: 9739
edges number: 63663
input nodes number: 9739
output nodes number: 2833
edges number: 17543
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.8091769218444824  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.8091773986816406  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.027679443359375  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 6 input nodes size: 27197
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025859355926513672  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025859355926513672  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03953123092651367  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03955221176147461  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025219440460205078  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025830745697021484  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025830745697021484  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 27197
first layer output nodes number: 9562
edges number: 65278
input nodes number: 9562
output nodes number: 2770
edges number: 16754
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.8011364936828613  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.8011369705200195  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.027006149291992188  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 7 input nodes size: 33329
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025209903717041016  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.025209903717041016  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.04110240936279297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.041123390197753906  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02743053436279297  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.028359413146972656  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.028359413146972656  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 33329
first layer output nodes number: 12728
edges number: 100321
input nodes number: 12728
output nodes number: 2759
edges number: 24280
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 1.1834101676940918  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 1.18341064453125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.030033111572265625  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 8 input nodes size: 41358
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02742910385131836  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.02742910385131836  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.0471501350402832  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.04717111587524414  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03125762939453125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.032462120056152344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.032462120056152344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 41358
first layer output nodes number: 15783
edges number: 133279
input nodes number: 15783
output nodes number: 2759
edges number: 28176
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 1.492034912109375  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 1.4920353889465332  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.034571170806884766  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 9 input nodes size: 46685
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03125762939453125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03125762939453125  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.05351877212524414  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.05353975296020508  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.0337977409362793  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03509855270385742  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03509855270385742  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 46685
first layer output nodes number: 17365
edges number: 145834
input nodes number: 17365
output nodes number: 2758
edges number: 28578
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 1.6042985916137695  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 1.6042990684509277  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.03738117218017578  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

pseudo mini batch 10 input nodes size: 42283
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.033797264099121094  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.033797264099121094  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.05395936965942383  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.05398130416870117  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.031699180603027344  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.033179283142089844  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9384765625 GB
    Memory Allocated: 0.033179283142089844  GigaBytes
Max Memory Allocated: 1.875990390777588  GigaBytes

first layer input nodes number: 42283
first layer output nodes number: 18002
edges number: 159478
input nodes number: 18002
output nodes number: 2914
edges number: 39053
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0791015625 GB
    Memory Allocated: 1.868433952331543  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0791015625 GB
    Memory Allocated: 1.8684344291687012  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.035726070404052734  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 11 input nodes size: 43315
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0317225456237793  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0317225456237793  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0532069206237793  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.053227901458740234  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.033043861389160156  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03444194793701172  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03444194793701172  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 43315
first layer output nodes number: 17748
edges number: 154220
input nodes number: 17748
output nodes number: 2758
edges number: 33403
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.7269377708435059  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.726938247680664  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03681755065917969  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 12 input nodes size: 40742
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0525517463684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.05257272720336914  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03209829330444336  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03209829330444336  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 40742
first layer output nodes number: 14207
edges number: 112717
input nodes number: 14207
output nodes number: 2784
edges number: 25554
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.3037762641906738  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.303776741027832  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03397655487060547  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 13 input nodes size: 41735
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.031071186065673828  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.031071186065673828  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.05097198486328125  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.05099296569824219  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03144073486328125  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.032439231872558594  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.032439231872558594  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 41735
first layer output nodes number: 13903
edges number: 110352
input nodes number: 13903
output nodes number: 2788
edges number: 23525
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.259890079498291  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.2598905563354492  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.034268856048583984  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 14 input nodes size: 48210
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.031441688537597656  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.031441688537597656  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.054879188537597656  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.054900169372558594  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.034978389739990234  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03631448745727539  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03631448745727539  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 48210
first layer output nodes number: 17657
edges number: 150086
input nodes number: 17657
output nodes number: 2758
edges number: 29105
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.634378433227539  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.6343789100646973  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03864908218383789  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 15 input nodes size: 27095
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0486454963684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.04866647720336914  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025207996368408203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025821208953857422  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025821208953857422  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 27095
first layer output nodes number: 9485
edges number: 64449
input nodes number: 9485
output nodes number: 2758
edges number: 17665
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.8104677200317383  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.8104681968688965  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02701425552368164  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 16 input nodes size: 16122
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025207996368408203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025207996368408203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.032895565032958984  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03291749954223633  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01922464370727539  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019855022430419922  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019855022430419922  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 16122
first layer output nodes number: 7861
edges number: 57611
input nodes number: 7861
output nodes number: 2927
edges number: 26768
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.8745970726013184  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.8745975494384766  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02104043960571289  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 17 input nodes size: 15612
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019249916076660156  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019249916076660156  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026694297790527344  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026716232299804688  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019006729125976562  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019499778747558594  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019499778747558594  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 15612
first layer output nodes number: 6743
edges number: 43940
input nodes number: 6743
output nodes number: 2900
edges number: 22119
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.705747127532959  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7057476043701172  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020454883575439453  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 18 input nodes size: 16035
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019002914428710938  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019002914428710938  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026648998260498047  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026670455932617188  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019204139709472656  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019786834716796875  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019786834716796875  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 16035
first layer output nodes number: 7608
edges number: 52373
input nodes number: 7608
output nodes number: 2875
edges number: 25647
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.8222556114196777  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.8222560882568359  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02088022232055664  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 19 input nodes size: 15051
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01920032501220703  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01920032501220703  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026377201080322266  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026398181915283203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018730640411376953  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01920461654663086  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01920461654663086  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 15051
first layer output nodes number: 6242
edges number: 41484
input nodes number: 6242
output nodes number: 2764
edges number: 21918
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.6837420463562012  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.6837425231933594  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020110130310058594  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 20 input nodes size: 16017
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018713951110839844  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018713951110839844  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026351451873779297  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026372909545898438  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019175052642822266  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01963663101196289  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01963663101196289  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 16017
first layer output nodes number: 6488
edges number: 40866
input nodes number: 6488
output nodes number: 2822
edges number: 20918
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.6608881950378418  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.660888671875  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02056121826171875  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 21 input nodes size: 14933
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019183635711669922  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019183635711669922  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026304244995117188  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02632617950439453  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018667221069335938  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019178390502929688  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019178390502929688  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 14933
first layer output nodes number: 6656
edges number: 44672
input nodes number: 6656
output nodes number: 2892
edges number: 23855
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7341480255126953  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7341485023498535  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020172595977783203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 22 input nodes size: 12765
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018677711486816406  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018677711486816406  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02522897720336914  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025250911712646484  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018108367919921875  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018611907958984375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018611907958984375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 12765
first layer output nodes number: 6021
edges number: 42059
input nodes number: 6021
output nodes number: 2913
edges number: 25418
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7313385009765625  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7313389778137207  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019573211669921875  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 23 input nodes size: 11445
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018111705780029297  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018111705780029297  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.023569107055664062  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.023591041564941406  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.017017841339111328  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.017334461212158203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.017334461212158203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 11445
first layer output nodes number: 5584
edges number: 27777
input nodes number: 5584
output nodes number: 2881
edges number: 14551
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.47002077102661133  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.47002124786376953  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01799917221069336  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 24 input nodes size: 9222
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.017013072967529297  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.017013072967529297  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.021410465240478516  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02143239974975586  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01595306396484375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.016265869140625  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.016265869140625  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 9222
first layer output nodes number: 5271
edges number: 26043
input nodes number: 5271
output nodes number: 2913
edges number: 15775
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.47327566146850586  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.47327613830566406  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.016922950744628906  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 25 input nodes size: 16513
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01595783233642578  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01595783233642578  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.023831844329833984  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.023853778839111328  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019434452056884766  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019936084747314453  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019936084747314453  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 16513
first layer output nodes number: 6632
edges number: 44391
input nodes number: 6632
output nodes number: 2924
edges number: 22865
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7219181060791016  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7219185829162598  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02091503143310547  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 26 input nodes size: 19000
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019435882568359375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019435882568359375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02849578857421875  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.028517723083496094  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020621776580810547  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.021149158477783203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.021149158477783203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 19000
first layer output nodes number: 7933
edges number: 49788
input nodes number: 7933
output nodes number: 2891
edges number: 20937
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7395038604736328  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.739504337310791  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02218008041381836  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 27 input nodes size: 11193
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020617008209228516  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020617008209228516  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025954246520996094  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025976181030273438  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01689434051513672  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01729583740234375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01729583740234375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 11193
first layer output nodes number: 5860
edges number: 34113
input nodes number: 5860
output nodes number: 2910
edges number: 19629
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.5876879692077637  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.5876884460449219  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018095016479492188  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 28 input nodes size: 15215
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.016897201538085938  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.016897201538085938  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.024152278900146484  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.024174213409423828  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018815040588378906  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019316673278808594  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019316673278808594  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 15215
first layer output nodes number: 6927
edges number: 44454
input nodes number: 6927
output nodes number: 2927
edges number: 22718
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7201647758483887  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7201652526855469  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020293235778808594  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 29 input nodes size: 14266
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018817424774169922  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018817424774169922  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025619983673095703  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025641918182373047  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018364906311035156  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01883220672607422  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01883220672607422  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 14266
first layer output nodes number: 6450
edges number: 40589
input nodes number: 6450
output nodes number: 2891
edges number: 21995
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.6750106811523438  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.675011157989502  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019742488861083984  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 30 input nodes size: 8562
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018359661102294922  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.018359661102294922  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.022442340850830078  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.022463321685791016  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.01563882827758789  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.015934467315673828  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.015934467315673828  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 8562
first layer output nodes number: 4580
edges number: 23084
input nodes number: 4580
output nodes number: 2791
edges number: 16441
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.4553031921386719  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.4553036689758301  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.016536712646484375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 31 input nodes size: 38534
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.015624046325683594  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.015624046325683594  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03399848937988281  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.034009456634521484  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02990579605102539  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.030834674835205078  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.030834674835205078  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 38534
first layer output nodes number: 12005
edges number: 106651
input nodes number: 12005
output nodes number: 1420
edges number: 17834
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.1340913772583008  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.134091854095459  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.032265663146972656  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 32 input nodes size: 29187
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02970123291015625  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02970123291015625  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.04361867904663086  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.04362916946411133  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025243759155273438  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02582836151123047  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02582836151123047  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 29187
first layer output nodes number: 8157
edges number: 66581
input nodes number: 8157
output nodes number: 1388
edges number: 11762
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7242364883422852  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7242369651794434  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026912689208984375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026912689208984375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026912689208984375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009386351614287405 |0.002544439200199012 |0.1181796391805013 |0.00013809493093779594 |0.13688460263338956 |0.007030487060546875 |
----------------------------------------------------------pseudo_mini_loss sum 5.261863708496094
Total (block generation + training)time/epoch 36.39760971069336
Training time/epoch 9.036039352416992
Training time without block to device /epoch 8.952072858810425
Training time without total dataloading part /epoch 8.428707599639893
load block tensor time/epoch 0.3097496032714844
block to device time/epoch 0.08396649360656738
input features size transfer per epoch 4.425644874572754e-06[23:05:30] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 29010640 edges into 32 parts and get 8897067 edge cuts

blocks size to device per epoch 2.950429916381836e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1147080
Number of first layer input nodes during this epoch:  826177
Number of first layer output nodes during this epoch:  320903
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026912212371826172  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.023931264877319336
global_2_local spend time (sec) 0.05725908279418945
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0044019222259521484
A = g.adjacency_matrix() spent  0.011195659637451172
auxiliary_graph
Graph(num_nodes=154715, num_edges=29101581,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10454344749450684
remove nodes length
63774
auxiliary_graph.remove_nodes spent  1.397933006286621
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29101581,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2259228229522705

the counter of shared neighbor distribution
Counter({1.0: 23486600, 2.0: 4015792, 3.0: 1001110, 4.0: 300986, 5.0: 109994, 6.0: 47458, 7.0: 22542, 8.0: 11416, 9.0: 6208, 10.0: 3562, 11.0: 1972, 12.0: 1148, 13.0: 654, 14.0: 388, 15.0: 284, 16.0: 206, 17.0: 180, 18.0: 72, 19.0: 50, 20.0: 10, 21.0: 8})
29010640
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 29010637, 29010638, 29010639])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23486600, 2.0: 4015792, 3.0: 1001110, 4.0: 300986, 5.0: 109994, 6.0: 47458, 7.0: 22542, 8.0: 11416, 9.0: 6208, 10.0: 3562, 11.0: 1972, 12.0: 1148, 13.0: 654, 14.0: 388, 15.0: 284, 16.0: 206, 17.0: 180, 18.0: 72, 19.0: 50, 20.0: 10, 21.0: 8})
Convert a graph into a bidirected graph: 1.902 seconds
Metis partitioning: 6.529 seconds
Split the graph: 0.896 seconds
Construct subgraphs: 0.121 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.463140964508057
2849
2870
2789
2813
2759
2785
2758
2881
2758
2809
2774
2925
2758
2758
2905
2758
2875
2891
2879
2891
2905
2893
2821
2873
2909
2886
2870
2875
2927
2770
2926
2801
total k batches seeds list generation spend  21.338995695114136
after graph partition
graph partition algorithm spend time 21.435759782791138
2849
2870
2789
2813
2759
2785
2758
2881
2758
2809
2774
2925
2758
2758
2905
2758
2875
2891
2879
2891
2905
2893
2821
2873
2909
2886
2870
2875
2927
2770
2926
2801
partition_len_list
[9065, 6798, 8375, 8883, 9781, 11438, 11075, 7670, 15123, 15126, 16700, 19738, 19088, 16424, 18187, 16284, 6775, 5448, 6062, 7641, 6727, 5225, 5371, 5622, 6449, 6222, 6916, 5987, 7921, 7440, 7722, 6928]
shared_neighbor_graph_partition_s0 selection method  spend 21.55262780189514
time for parepare:  0.018056392669677734
local_output_nid generation:  0.0006105899810791016
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.0012354850769042969
r_  generation:  0.008682727813720703
local_output_nid generation:  0.0007536411285400391
local_in_edges_tensor generation:  0.0008113384246826172
mini_batch_src_global generation:  0.0012555122375488281
r_  generation:  0.00927591323852539
local_output_nid generation:  0.0007815361022949219
local_in_edges_tensor generation:  0.0007069110870361328
mini_batch_src_global generation:  0.0007596015930175781
r_  generation:  0.007624626159667969
local_output_nid generation:  0.0007917881011962891
local_in_edges_tensor generation:  0.0006661415100097656
mini_batch_src_global generation:  0.000736236572265625
r_  generation:  0.007748126983642578
local_output_nid generation:  0.0007526874542236328
local_in_edges_tensor generation:  0.0006625652313232422
mini_batch_src_global generation:  0.0006814002990722656
r_  generation:  0.006852865219116211
local_output_nid generation:  0.0007677078247070312
local_in_edges_tensor generation:  0.0006821155548095703
mini_batch_src_global generation:  0.0008411407470703125
r_  generation:  0.009263277053833008
local_output_nid generation:  0.0007355213165283203
local_in_edges_tensor generation:  0.00063323974609375
mini_batch_src_global generation:  0.0007147789001464844
r_  generation:  0.0069942474365234375
local_output_nid generation:  0.0007598400115966797
local_in_edges_tensor generation:  0.0006756782531738281
mini_batch_src_global generation:  0.0006678104400634766
r_  generation:  0.00757598876953125
local_output_nid generation:  0.0006916522979736328
local_in_edges_tensor generation:  0.0007073879241943359
mini_batch_src_global generation:  0.0011262893676757812
r_  generation:  0.012186288833618164
local_output_nid generation:  0.0007410049438476562
local_in_edges_tensor generation:  0.0006849765777587891
mini_batch_src_global generation:  0.0011036396026611328
r_  generation:  0.010367870330810547
local_output_nid generation:  0.0008058547973632812
local_in_edges_tensor generation:  0.0007297992706298828
mini_batch_src_global generation:  0.0010502338409423828
r_  generation:  0.010868072509765625
local_output_nid generation:  0.0008611679077148438
local_in_edges_tensor generation:  0.0009665489196777344
mini_batch_src_global generation:  0.002026796340942383
r_  generation:  0.015190839767456055
local_output_nid generation:  0.0007984638214111328
local_in_edges_tensor generation:  0.0007255077362060547
mini_batch_src_global generation:  0.0012655258178710938
r_  generation:  0.012229204177856445
local_output_nid generation:  0.0008058547973632812
local_in_edges_tensor generation:  0.0007390975952148438
mini_batch_src_global generation:  0.0010457038879394531
r_  generation:  0.011379480361938477
local_output_nid generation:  0.0008654594421386719
local_in_edges_tensor generation:  0.0008196830749511719
mini_batch_src_global generation:  0.0019507408142089844
r_  generation:  0.01639389991760254
local_output_nid generation:  0.0008046627044677734
local_in_edges_tensor generation:  0.000911712646484375
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.011566162109375
local_output_nid generation:  0.0010197162628173828
local_in_edges_tensor generation:  0.0006909370422363281
mini_batch_src_global generation:  0.0009219646453857422
r_  generation:  0.009055376052856445
local_output_nid generation:  0.0008220672607421875
local_in_edges_tensor generation:  0.0007543563842773438
mini_batch_src_global generation:  0.0007557868957519531
r_  generation:  0.008134603500366211
local_output_nid generation:  0.0008029937744140625
local_in_edges_tensor generation:  0.0006775856018066406
mini_batch_src_global generation:  0.0006861686706542969
r_  generation:  0.007659912109375
local_output_nid generation:  0.0007734298706054688
local_in_edges_tensor generation:  0.0007030963897705078
mini_batch_src_global generation:  0.0008063316345214844
r_  generation:  0.008925437927246094
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.0008144378662109375
r_  generation:  0.008000373840332031
local_output_nid generation:  0.0007727146148681641
local_in_edges_tensor generation:  0.0007102489471435547
mini_batch_src_global generation:  0.0005717277526855469
r_  generation:  0.006050825119018555
local_output_nid generation:  0.0007433891296386719
local_in_edges_tensor generation:  0.0006301403045654297
mini_batch_src_global generation:  0.0005383491516113281
r_  generation:  0.00617218017578125
local_output_nid generation:  0.0007650852203369141
local_in_edges_tensor generation:  0.0006716251373291016
mini_batch_src_global generation:  0.0006012916564941406
r_  generation:  0.006898403167724609
local_output_nid generation:  0.0007355213165283203
local_in_edges_tensor generation:  0.0007965564727783203
mini_batch_src_global generation:  0.0007503032684326172
r_  generation:  0.008730649948120117
local_output_nid generation:  0.0007288455963134766
local_in_edges_tensor generation:  0.0006966590881347656
mini_batch_src_global generation:  0.0009241104125976562
r_  generation:  0.009119987487792969
local_output_nid generation:  0.0007076263427734375
local_in_edges_tensor generation:  0.000682830810546875
mini_batch_src_global generation:  0.0007731914520263672
r_  generation:  0.008411407470703125
local_output_nid generation:  0.0007059574127197266
local_in_edges_tensor generation:  0.0007185935974121094
mini_batch_src_global generation:  0.0010149478912353516
r_  generation:  0.010282278060913086
local_output_nid generation:  0.0007631778717041016
local_in_edges_tensor generation:  0.0007812976837158203
mini_batch_src_global generation:  0.0011928081512451172
r_  generation:  0.010343313217163086
local_output_nid generation:  0.0007069110870361328
local_in_edges_tensor generation:  0.0006902217864990234
mini_batch_src_global generation:  0.0010309219360351562
r_  generation:  0.007793426513671875
local_output_nid generation:  0.0007574558258056641
local_in_edges_tensor generation:  0.000698089599609375
mini_batch_src_global generation:  0.0008890628814697266
r_  generation:  0.010254144668579102
local_output_nid generation:  0.0007317066192626953
local_in_edges_tensor generation:  0.0006816387176513672
mini_batch_src_global generation:  0.0008006095886230469
r_  generation:  0.00830984115600586
----------------------check_connections_block total spend ----------------------------- 0.4707059860229492
generate_one_block  0.02166295051574707
generate_one_block  0.01407766342163086
generate_one_block  0.012208700180053711
generate_one_block  0.012123584747314453
generate_one_block  0.01133584976196289
generate_one_block  0.014660358428955078
generate_one_block  0.011266708374023438
generate_one_block  0.01118326187133789
generate_one_block  0.02007293701171875
generate_one_block  0.015535831451416016
generate_one_block  0.018395662307739258
generate_one_block  0.022552967071533203
generate_one_block  0.020760536193847656
generate_one_block  0.017179012298583984
generate_one_block  0.023312807083129883
generate_one_block  0.019370079040527344
generate_one_block  0.015381813049316406
generate_one_block  0.011534690856933594
generate_one_block  0.01058650016784668
generate_one_block  0.013748645782470703
generate_one_block  0.011428594589233398
generate_one_block  0.008556604385375977
generate_one_block  0.008996963500976562
generate_one_block  0.0098724365234375
generate_one_block  0.01237177848815918
generate_one_block  0.01282954216003418
generate_one_block  0.011996269226074219
generate_one_block  0.013521194458007812
generate_one_block  0.014975786209106445
generate_one_block  0.011407852172851562
generate_one_block  0.014935970306396484
generate_one_block  0.011548280715942383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03291773796081543
gen group dst list time:  0.009688138961791992
time for parepare:  0.022319316864013672
local_output_nid generation:  0.0019783973693847656
local_in_edges_tensor generation:  0.009937047958374023
mini_batch_src_global generation:  0.0033965110778808594
r_  generation:  0.02816176414489746
local_output_nid generation:  0.0022478103637695312
local_in_edges_tensor generation:  0.0020728111267089844
mini_batch_src_global generation:  0.0030364990234375
r_  generation:  0.020590543746948242
local_output_nid generation:  0.0024721622467041016
local_in_edges_tensor generation:  0.0016989707946777344
mini_batch_src_global generation:  0.0020546913146972656
r_  generation:  0.023900985717773438
local_output_nid generation:  0.002327442169189453
local_in_edges_tensor generation:  0.0020182132720947266
mini_batch_src_global generation:  0.002093791961669922
r_  generation:  0.026597023010253906
local_output_nid generation:  0.0027854442596435547
local_in_edges_tensor generation:  0.002168416976928711
mini_batch_src_global generation:  0.002284526824951172
r_  generation:  0.029175758361816406
local_output_nid generation:  0.0028533935546875
local_in_edges_tensor generation:  0.002838134765625
mini_batch_src_global generation:  0.0035746097564697266
r_  generation:  0.04116225242614746
local_output_nid generation:  0.0038843154907226562
local_in_edges_tensor generation:  0.0032088756561279297
mini_batch_src_global generation:  0.007213592529296875
r_  generation:  0.04021191596984863
local_output_nid generation:  0.002688169479370117
local_in_edges_tensor generation:  0.002381563186645508
mini_batch_src_global generation:  0.006635189056396484
r_  generation:  0.02346515655517578
local_output_nid generation:  0.004652261734008789
local_in_edges_tensor generation:  0.004949331283569336
mini_batch_src_global generation:  0.008339643478393555
r_  generation:  0.05396294593811035
local_output_nid generation:  0.004265785217285156
local_in_edges_tensor generation:  0.005092620849609375
mini_batch_src_global generation:  0.009505748748779297
r_  generation:  0.055507659912109375
local_output_nid generation:  0.004697084426879883
local_in_edges_tensor generation:  0.005563259124755859
mini_batch_src_global generation:  0.015617132186889648
r_  generation:  0.07959890365600586
local_output_nid generation:  0.005425214767456055
local_in_edges_tensor generation:  0.006560087203979492
mini_batch_src_global generation:  0.007069826126098633
r_  generation:  0.07287335395812988
local_output_nid generation:  0.005597591400146484
local_in_edges_tensor generation:  0.005320549011230469
mini_batch_src_global generation:  0.006947517395019531
r_  generation:  0.07277941703796387
local_output_nid generation:  0.0053212642669677734
local_in_edges_tensor generation:  0.00544428825378418
mini_batch_src_global generation:  0.006458282470703125
r_  generation:  0.05755424499511719
local_output_nid generation:  0.004715442657470703
local_in_edges_tensor generation:  0.00514984130859375
mini_batch_src_global generation:  0.008552074432373047
r_  generation:  0.06612730026245117
local_output_nid generation:  0.004487037658691406
local_in_edges_tensor generation:  0.004912614822387695
mini_batch_src_global generation:  0.005764961242675781
r_  generation:  0.05909442901611328
local_output_nid generation:  0.0021398067474365234
local_in_edges_tensor generation:  0.0022001266479492188
mini_batch_src_global generation:  0.0025882720947265625
r_  generation:  0.02001333236694336
local_output_nid generation:  0.001611471176147461
local_in_edges_tensor generation:  0.001401662826538086
mini_batch_src_global generation:  0.0014984607696533203
r_  generation:  0.016214609146118164
local_output_nid generation:  0.0026519298553466797
local_in_edges_tensor generation:  0.004529714584350586
mini_batch_src_global generation:  0.0015063285827636719
r_  generation:  0.015758752822875977
local_output_nid generation:  0.0020411014556884766
local_in_edges_tensor generation:  0.0022335052490234375
mini_batch_src_global generation:  0.0016632080078125
r_  generation:  0.021593809127807617
local_output_nid generation:  0.0017571449279785156
local_in_edges_tensor generation:  0.0016093254089355469
mini_batch_src_global generation:  0.0015363693237304688
r_  generation:  0.017795324325561523
local_output_nid generation:  0.0013546943664550781
local_in_edges_tensor generation:  0.0013098716735839844
mini_batch_src_global generation:  0.0010738372802734375
r_  generation:  0.01191401481628418
local_output_nid generation:  0.0014443397521972656
local_in_edges_tensor generation:  0.0012505054473876953
mini_batch_src_global generation:  0.001074075698852539
r_  generation:  0.012338638305664062
local_output_nid generation:  0.0014023780822753906
local_in_edges_tensor generation:  0.0012309551239013672
mini_batch_src_global generation:  0.001165151596069336
r_  generation:  0.013289690017700195
local_output_nid generation:  0.0017256736755371094
local_in_edges_tensor generation:  0.0016698837280273438
mini_batch_src_global generation:  0.0014538764953613281
r_  generation: [23:05:36] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2925 nodes and 1849142 edges into 2 parts and get 330187 edge cuts
 0.01799488067626953
local_output_nid generation:  0.0016260147094726562
local_in_edges_tensor generation:  0.0014083385467529297
mini_batch_src_global generation:  0.0014252662658691406
r_  generation:  0.017006397247314453
local_output_nid generation:  0.0018129348754882812
local_in_edges_tensor generation:  0.0015692710876464844
mini_batch_src_global generation:  0.00147247314453125
r_  generation:  0.020086288452148438
local_output_nid generation:  0.0015032291412353516
local_in_edges_tensor generation:  0.0013515949249267578
mini_batch_src_global generation:  0.0014891624450683594
r_  generation:  0.017791032791137695
local_output_nid generation:  0.0019371509552001953
local_in_edges_tensor generation:  0.0017991065979003906
mini_batch_src_global generation:  0.0017800331115722656
r_  generation:  0.023785114288330078
local_output_nid generation:  0.0016586780548095703
local_in_edges_tensor generation:  0.0017478466033935547
mini_batch_src_global generation:  0.0017085075378417969
r_  generation:  0.021074771881103516
local_output_nid generation:  0.0017058849334716797
local_in_edges_tensor generation:  0.0016891956329345703
mini_batch_src_global generation:  0.0017681121826171875
r_  generation:  0.02262711524963379
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0015361309051513672
mini_batch_src_global generation:  0.0015780925750732422
r_  generation:  0.019426345825195312
----------------------check_connections_block total spend ----------------------------- 1.612356185913086
generate_one_block  0.04497885704040527
generate_one_block  0.049601078033447266
generate_one_block  0.03331780433654785
generate_one_block  0.039183616638183594
generate_one_block  0.04068613052368164
generate_one_block  0.05052351951599121
generate_one_block  0.047907352447509766
generate_one_block  0.02685403823852539
generate_one_block  0.07339000701904297
generate_one_block  0.07088232040405273
generate_one_block  0.08391332626342773
generate_one_block  0.10148906707763672
generate_one_block  0.10673356056213379
generate_one_block  0.08017706871032715
generate_one_block  0.09000945091247559
generate_one_block  0.08129286766052246
generate_one_block  0.025948286056518555
generate_one_block  0.018564939498901367
generate_one_block  0.019646644592285156
generate_one_block  0.02932000160217285
generate_one_block  0.023708105087280273
generate_one_block  0.016476154327392578
generate_one_block  0.017438411712646484
generate_one_block  0.017285585403442383
generate_one_block  0.024030685424804688
generate_one_block  0.022388696670532227
generate_one_block  0.026737689971923828
generate_one_block  0.02329397201538086
generate_one_block  0.031543731689453125
generate_one_block  0.02790999412536621
generate_one_block  0.03547787666320801
generate_one_block  0.028985023498535156
global_2_local spend time (sec) 0.00452423095703125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0009229183197021484
A = g.adjacency_matrix() spent  0.0007221698760986328
auxiliary_graph
Graph(num_nodes=19738, num_edges=1852067,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.013477325439453125
remove nodes length
16813
auxiliary_graph.remove_nodes spent  0.06969237327575684
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2925, num_edges=1852067,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.05968952178955078

the counter of shared neighbor distribution
Counter({1.0: 1624972, 2.0: 185142, 3.0: 30656, 4.0: 5894, 5.0: 1614, 6.0: 478, 7.0: 216, 8.0: 82, 9.0: 38, 10.0: 22, 11.0: 10, 12.0: 6, 14.0: 4, 13.0: 4, 17.0: 2, 15.0: 2})
1849142
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.062 seconds
Metis partitioning: 0.120 seconds
Split the graph: 0.193 seconds
Construct subgraphs: 0.010 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.38750243186950684
1462
1463
total k batches seeds list generation spend  0.9000873565673828
after graph partition
graph partition algorithm spend time 0.9082334041595459
1462
1463
time for parepare:  0.033812522888183594
local_output_nid generation:  0.0003845691680908203
local_in_edges_tensor generation:  0.004050493240356445
mini_batch_src_global generation:  0.0015861988067626953
r_  generation:  0.011372566223144531
local_output_nid generation:  0.0003654956817626953
local_in_edges_tensor generation:  0.0016205310821533203
mini_batch_src_global generation:  0.001317739486694336
r_  generation:  0.009380578994750977
----------------------check_connections_block total spend ----------------------------- 0.07575297355651855
generate_one_block  0.023737668991088867
generate_one_block  0.011204242706298828
time for parepare:  0.02153635025024414
local_output_nid generation:  0.002189159393310547
local_in_edges_tensor generation:  0.00731658935546875
mini_batch_src_global generation:  0.0038361549377441406
r_  generation:  0.04413723945617676
local_output_nid generation:  0.002512216567993164
local_in_edges_tensor generation:  0.0028603076934814453
mini_batch_src_global generation:  0.0037682056427001953
r_  generation:  0.03646731376647949
----------------------check_connections_block total spend ----------------------------- 0.14969182014465332
generate_one_block  0.0640416145324707
generate_one_block  0.04898953437805176
----------===============-------------===============-------------the number of batches *****---- 33

original number of batches:  32
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026912212371826172  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

connection checking time:  1.612356185913086
block generation total time  1.4096958637237549
average batch blocks generation time:  0.04405299574136734
block dataloader generation time/epoch 27.220029950141907
pseudo mini batch 0 input nodes size: 24922
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025238037109375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025238037109375  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03712177276611328  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03714323043823242  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.023215293884277344  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.023859024047851562  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.023859024047851562  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 24922
first layer output nodes number: 9065
edges number: 63777
input nodes number: 9065
output nodes number: 2849
edges number: 22503
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.8696579933166504  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.8696589469909668  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025310993194580078  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 1 input nodes size: 17838
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.023434162139892578  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.023434162139892578  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03193998336791992  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03196144104003906  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02005624771118164  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020592212677001953  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020592212677001953  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 17838
first layer output nodes number: 6798
edges number: 47465
input nodes number: 6798
output nodes number: 2870
edges number: 24412
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7637906074523926  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7637910842895508  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02163219451904297  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 2 input nodes size: 22487
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02005910873413086  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02005910873413086  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03078174591064453  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03080272674560547  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.022275447845458984  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02282857894897461  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02282857894897461  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 22487
first layer output nodes number: 8375
edges number: 55161
input nodes number: 8375
output nodes number: 2789
edges number: 18989
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7524662017822266  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7524666786193848  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.023899078369140625  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 3 input nodes size: 26394
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.022263526916503906  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.022263526916503906  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03484916687011719  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.034870147705078125  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.024126529693603516  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.024719715118408203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.024719715118408203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 26394
first layer output nodes number: 8883
edges number: 60067
input nodes number: 8883
output nodes number: 2813
edges number: 19340
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7951769828796387  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.7951774597167969  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02588939666748047  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 4 input nodes size: 29921
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02413034439086914  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02413034439086914  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.038397789001464844  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03841876983642578  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025812149047851562  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02644062042236328  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02644062042236328  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 29921
first layer output nodes number: 9781
edges number: 67575
input nodes number: 9781
output nodes number: 2759
edges number: 16768
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.8168749809265137  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.8168754577636719  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.027659893035888672  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 5 input nodes size: 29198
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02580404281616211  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02580404281616211  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03972673416137695  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03974771499633789  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02545928955078125  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026297569274902344  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.026297569274902344  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 29198
first layer output nodes number: 11438
edges number: 88907
input nodes number: 11438
output nodes number: 2785
edges number: 23510
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.0865507125854492  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.0865511894226074  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.027821063995361328  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 6 input nodes size: 35838
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025463104248046875  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.025463104248046875  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.04255199432373047  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.042572975158691406  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.028629302978515625  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.029341697692871094  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.029341697692871094  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 35838
first layer output nodes number: 11075
edges number: 78390
input nodes number: 11075
output nodes number: 2758
edges number: 17035
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.9127302169799805  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.9127306938171387  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03072500228881836  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 7 input nodes size: 17733
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.028625011444091797  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.028625011444091797  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03708076477050781  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.037102699279785156  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.019992828369140625  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020465850830078125  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020465850830078125  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 17733
first layer output nodes number: 7670
edges number: 45554
input nodes number: 7670
output nodes number: 2881
edges number: 17891
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.6646275520324707  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.6646280288696289  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02142810821533203  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 8 input nodes size: 37307
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020011425018310547  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.020011425018310547  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03780078887939453  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03782176971435547  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.02934408187866211  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.030552387237548828  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.030552387237548828  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 37307
first layer output nodes number: 15123
edges number: 129317
input nodes number: 15123
output nodes number: 2758
edges number: 32669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.5280113220214844  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.5280117988586426  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03263521194458008  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 9 input nodes size: 45750
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.029325485229492188  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.029325485229492188  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.051140785217285156  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.051161766052246094  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03335142135620117  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03444337844848633  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03444337844848633  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 45750
first layer output nodes number: 15126
edges number: 121979
input nodes number: 15126
output nodes number: 2809
edges number: 24499
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.3537397384643555  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.3537402153015137  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03643798828125  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 10 input nodes size: 46316
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03335905075073242  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03335905075073242  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.05544424057006836  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0554652214050293  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03362894058227539  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0348973274230957  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0348973274230957  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 46316
first layer output nodes number: 16700
edges number: 141488
input nodes number: 16700
output nodes number: 2774
edges number: 28555
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.5735721588134766  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 1.5735726356506348  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.0371246337890625  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 11 input nodes size: 48227
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.033623695373535156  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.033623695373535156  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.057061195373535156  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.057082176208496094  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03497600555419922  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03644847869873047  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0810546875 GB
    Memory Allocated: 0.03644847869873047  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 48227
first layer output nodes number: 19088
edges number: 165102
input nodes number: 19088
output nodes number: 2758
edges number: 32497
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 1.8163127899169922  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 1.8163132667541504  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.03898000717163086  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 12 input nodes size: 43851
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.0564579963684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.05647897720336914  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.03424882888793945  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.03424882888793945  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 43851
first layer output nodes number: 16424
edges number: 137362
input nodes number: 16424
output nodes number: 2758
edges number: 27293
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 1.515275478363037  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 1.5152759552001953  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.0364079475402832  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

pseudo mini batch 13 input nodes size: 40315
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.0525517463684082  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.05257368087768555  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.03257131576538086  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2294921875 GB
    Memory Allocated: 0.03257131576538086  GigaBytes
Max Memory Allocated: 1.9223566055297852  GigaBytes

first layer input nodes number: 40315
first layer output nodes number: 18187
edges number: 161502
input nodes number: 18187
output nodes number: 2905
edges number: 40178
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2314453125 GB
    Memory Allocated: 1.883779525756836  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2314453125 GB
    Memory Allocated: 1.8837800025939941  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.035137176513671875  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 14 input nodes size: 40709
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.031090259552001953  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.031090259552001953  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.05062150955200195  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.05064249038696289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.031089305877685547  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.03235197067260742  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.03235197067260742  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 40709
first layer output nodes number: 16284
edges number: 138881
input nodes number: 16284
output nodes number: 2758
edges number: 30402
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 1.569897174835205  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 1.5698976516723633  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.03452014923095703  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 15 input nodes size: 15832
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.03861665725708008  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.03863811492919922  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01908588409423828  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01957416534423828  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01957416534423828  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 15832
first layer output nodes number: 6775
edges number: 43821
input nodes number: 6775
output nodes number: 2875
edges number: 21543
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.6963753700256348  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.696375846862793  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020543575286865234  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 16 input nodes size: 10833
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019103527069091797  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019103527069091797  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.025226116180419922  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.025248050689697266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01767730712890625  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01806926727294922  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01806926727294922  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 10833
first layer output nodes number: 5448
edges number: 32114
input nodes number: 5448
output nodes number: 2891
edges number: 20458
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.5848388671875  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.5848393440246582  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.018853187561035156  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 17 input nodes size: 12992
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.017679691314697266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.017679691314697266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.023874759674072266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.023896217346191406  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.017751693725585938  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01814746856689453  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01814746856689453  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 12992
first layer output nodes number: 6062
edges number: 34746
input nodes number: 6062
output nodes number: 2879
edges number: 18177
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.5769734382629395  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.5769739151000977  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.018943309783935547  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 18 input nodes size: 17840
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.017749786376953125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.017749786376953125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.026256561279296875  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02627849578857422  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020061969757080078  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020592212677001953  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020592212677001953  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 17840
first layer output nodes number: 7641
edges number: 48754
input nodes number: 7641
output nodes number: 2891
edges number: 22354
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.7427873611450195  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.7427878379821777  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.021628856658935547  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 19 input nodes size: 15285
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02006387710571289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02006387710571289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.027352333068847656  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.027374267578125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.018845558166503906  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019287109375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019287109375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 15285
first layer output nodes number: 6727
edges number: 39885
input nodes number: 6727
output nodes number: 2905
edges number: 19266
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.6289291381835938  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.628929615020752  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020173072814941406  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 20 input nodes size: 9630
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01884746551513672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01884746551513672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.023439407348632812  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.023461341857910156  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.016150951385498047  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.016428470611572266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.016428470611572266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 9630
first layer output nodes number: 5225
edges number: 23452
input nodes number: 5225
output nodes number: 2893
edges number: 13594
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.4243602752685547  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.4243607521057129  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01702880859375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 21 input nodes size: 11687
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.016149520874023438  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.016149520874023438  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02172231674194336  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.0217437744140625  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.017129898071289062  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.0174407958984375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.0174407958984375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 11687
first layer output nodes number: 5371
edges number: 27471
input nodes number: 5371
output nodes number: 2821
edges number: 14169
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.46066999435424805  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.46067047119140625  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01808643341064453  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 22 input nodes size: 11891
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01711893081665039  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01711893081665039  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02278900146484375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02281045913696289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.017216205596923828  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01756143569946289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01756143569946289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 11891
first layer output nodes number: 5622
edges number: 29606
input nodes number: 5622
output nodes number: 2873
edges number: 16629
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.5129833221435547  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.5129837989807129  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.018285274505615234  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 23 input nodes size: 16193
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.017223834991455078  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.017223834991455078  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02494525909423828  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.024967193603515625  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019275665283203125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019742965698242188  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019742965698242188  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 16193
first layer output nodes number: 6449
edges number: 41039
input nodes number: 6449
output nodes number: 2909
edges number: 21541
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.6703853607177734  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.6703858375549316  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020676136016845703  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 24 input nodes size: 12866
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019281387329101562  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019281387329101562  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02541637420654297  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.025438308715820312  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.017694950103759766  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.018160343170166016  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.018160343170166016  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 12866
first layer output nodes number: 6222
edges number: 38975
input nodes number: 6222
output nodes number: 2886
edges number: 23408
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.6794681549072266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.6794686317443848  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01906585693359375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 25 input nodes size: 17955
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01769113540649414  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01769113540649414  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02625274658203125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02627420425415039  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02011728286743164  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020615100860595703  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020615100860595703  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 17955
first layer output nodes number: 6916
edges number: 45646
input nodes number: 6916
output nodes number: 2870
edges number: 21001
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.7023639678955078  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.702364444732666  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.021590709686279297  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 26 input nodes size: 12824
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020114898681640625  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020114898681640625  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.0262298583984375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02625131607055664  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01766824722290039  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.018168926239013672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.018168926239013672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 12824
first layer output nodes number: 5987
edges number: 41838
input nodes number: 5987
output nodes number: 2875
edges number: 25267
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.7260575294494629  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.7260580062866211  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01912212371826172  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 27 input nodes size: 15673
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.017669200897216797  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.017669200897216797  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.025226116180419922  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.025248050689697266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01911163330078125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019741058349609375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019741058349609375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 15673
first layer output nodes number: 7921
edges number: 57413
input nodes number: 7921
output nodes number: 2927
edges number: 26921
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.8787374496459961  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.8787379264831543  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020906448364257812  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 28 input nodes size: 16686
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.0191192626953125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.0191192626953125  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.027075767517089844  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02709674835205078  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019517898559570312  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020028114318847656  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020028114318847656  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 16686
first layer output nodes number: 7440
edges number: 49372
input nodes number: 7440
output nodes number: 2770
edges number: 19070
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.7070083618164062  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.7070088386535645  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.0209808349609375  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 29 input nodes size: 16051
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01949453353881836  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01949453353881836  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02714824676513672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.027170181274414062  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01919269561767578  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01979351043701172  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.01979351043701172  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 16051
first layer output nodes number: 7722
edges number: 53650
input nodes number: 7722
output nodes number: 2926
edges number: 26832
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.8525943756103516  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.8525948524475098  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02094411849975586  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 30 input nodes size: 16582
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019216060638427734  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019216060638427734  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.027122974395751953  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02714395523071289  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019468307495117188  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019945144653320312  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019945144653320312  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 16582
first layer output nodes number: 6928
edges number: 43638
input nodes number: 6928
output nodes number: 2801
edges number: 20347
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.6764764785766602  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.6764769554138184  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.020866870880126953  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 31 input nodes size: 38032
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019449710845947266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.019449710845947266  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.037584781646728516  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.03759574890136719  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02966785430908203  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.03062725067138672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.03062725067138672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 38032
first layer output nodes number: 12074
edges number: 108779
input nodes number: 12074
output nodes number: 1462
edges number: 19889
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 1.170060157775879  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 1.170060634613037  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.032106876373291016  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

pseudo mini batch 32 input nodes size: 30991
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.029468059539794922  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.029468059539794922  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.04424571990966797  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.04425668716430664  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02611064910888672  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.026879310607910156  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.026879310607910156  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

first layer input nodes number: 30991
first layer output nodes number: 10015
edges number: 85763
input nodes number: 10015
output nodes number: 1463
edges number: 17243
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.9499235153198242  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.9499239921569824  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02825021743774414  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02825021743774414  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.2333984375 GB
    Memory Allocated: 0.02825021743774414  GigaBytes
Max Memory Allocated: 1.940969467163086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00841274405970718 |0.0024112065633138022 |0.11926077351425633 |0.00013004649769176137 |0.13874710689891467 |0.006127357482910156 |
----------------------------------------------------------pseudo_mini_loss sum 4.001804351806641
Total (block generation + training)time/epoch 36.28033685684204
Training time/epoch 9.083976984024048
Training time without block to device /epoch 9.004407167434692
Training time without total dataloading part /epoch 8.524678945541382
load block tensor time/epoch 0.2776205539703369
block to device time/epoch 0.07956981658935547
input features size transfer per epoch 4.425644874572754e-06
blocks size to device per epoch 2.950429916381836e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1123211
Number of first layer input nodes during this epoch:  806649
Number of first layer output nodes during this epoch: Using backend: pytorch
 316562
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
