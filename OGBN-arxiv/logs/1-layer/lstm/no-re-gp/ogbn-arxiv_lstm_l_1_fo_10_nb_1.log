main start at this time 1652665275.4790955
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
pseudo mini batch 0 input nodes size: 145054
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.06969738006591797  GigaBytes
Max Memory Allocated: 0.06969738006591797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.07037496566772461  GigaBytes
Max Memory Allocated: 0.07037496566772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.07037496566772461  GigaBytes
Max Memory Allocated: 0.07037496566772461  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.07420110702514648  GigaBytes
Max Memory Allocated: 0.07420110702514648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.07420110702514648  GigaBytes
Max Memory Allocated: 0.07420110702514648  GigaBytes

input nodes number: 145054
output nodes number: 90941
edges number: 513414
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 4.000125885009766  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 4.000126838684082  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 0.09475851058959961  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 0.09581899642944336  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 0.09581899642944336  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030614376068115234 |0.3431239128112793 |0.5109412670135498 |0.00018286705017089844 |0.021802425384521484 |0.004110813140869141 |
----------------------------------------------------------pseudo_mini_loss sum 3.8379831314086914
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  145054
Number of first layer input nodes during this epoch:  145054
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 0.09581851959228516  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 0.09581851959228516  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.02365851402282715
pseudo mini batch 0 input nodes size: 145011
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 0.08563756942749023  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 0.08563756942749023  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 0.1547842025756836  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 0.15546178817749023  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 0.0856170654296875  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 0.08944320678710938  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 0.08944320678710938  GigaBytes
Max Memory Allocated: 4.322143077850342  GigaBytes

input nodes number: 145011
output nodes number: 90941
edges number: 513414
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 3.99277925491333  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 3.9927802085876465  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.0952768325805664  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.0952768325805664  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.0952768325805664  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02764129638671875 |0.001967191696166992 |0.03690958023071289 |8.487701416015625e-05 |0.017340660095214844 |0.0024852752685546875 |
----------------------------------------------------------pseudo_mini_loss sum 3.2689828872680664
Total (block generation + training)time/epoch 0.12667179107666016
* Pure training time/epoch 0.08642888069152832

Training time/epoch 0.1027979850769043
Training time without block to device /epoch 0.1008307933807373
Training time without total dataloading part /epoch 0.05682039260864258
load block tensor time/epoch 0.02764129638671875
block to device time/epoch 0.001967191696166992
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  145011
Number of first layer input nodes during this epoch:  145011
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.0952763557434082  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.0952763557434082  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.019811511039733887
pseudo mini batch 0 input nodes size: 145027
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.08549690246582031  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.08549690246582031  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.15465116500854492  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.15532875061035156  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.08550453186035156  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.08933067321777344  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.08933067321777344  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

input nodes number: 145027
output nodes number: 90941
edges number: 513414
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 3.992095470428467  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 3.992096424102783  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.09525775909423828  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.09525775909423828  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.6971435546875 GB
    Memory Allocated: 0.09525775909423828  GigaBytes
Max Memory Allocated: 4.328693389892578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027957677841186523 |0.002039194107055664 |0.03683924674987793 |8.654594421386719e-05 |0.017450571060180664 |0.0024611949920654297 |
----------------------------------------------------------pseudo_mini_loss sum 3.169135808944702
Total (block generation + training)time/epoch 0.12285196781158447
* Pure training time/epoch 0.08683443069458008
Training time/epoch 0.10296344757080078
Training time without block to device /epoch 0.10092425346374512
Training time without total dataloading part /epoch 0.05683755874633789
load block tensor time/epoch 0.027957677841186523
block to device time/epoch 0.002039194107055664
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  145027
Number of first layer input nodes during this epoch:  145027
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
