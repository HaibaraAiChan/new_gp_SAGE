[00:38:04] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14364480 edges into 16 parts and get 2403556 edge cuts
main start at this time 1652661471.011407
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.020841121673583984
global_2_local spend time (sec) 0.03446555137634277
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003513813018798828
A = g.adjacency_matrix() spent  0.0068492889404296875
auxiliary_graph
Graph(num_nodes=145054, num_edges=14455421,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07319903373718262
remove nodes length
54113
auxiliary_graph.remove_nodes spent  0.647324800491333
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14455421,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6068999767303467

the counter of shared neighbor distribution
Counter({1.0: 12983840, 2.0: 1168162, 3.0: 166454, 4.0: 33624, 5.0: 8820, 6.0: 2638, 7.0: 736, 8.0: 176, 9.0: 24, 10.0: 6})
14364480
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14364477, 14364478, 14364479])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12983840, 2.0: 1168162, 3.0: 166454, 4.0: 33624, 5.0: 8820, 6.0: 2638, 7.0: 736, 8.0: 176, 9.0: 24, 10.0: 6})
Convert a graph into a bidirected graph: 0.650 seconds
Metis partitioning: 2.771 seconds
Split the graph: 0.532 seconds
Construct subgraphs: 0.070 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.0311503410339355
5854
5837
5532
5535
5517
5854
5850
5854
5517
5518
5593
5853
5854
5523
5733
5517
total k batches seeds list generation spend  9.202220439910889
after graph partition
graph partition algorithm spend time 9.267477750778198
5854
5837
5532
5535
5517
5854
5850
5854
5517
5518
5593
5853
5854
5523
5733
5517
partition_len_list
[10138, 11183, 11525, 10816, 11918, 11621, 10461, 9618, 15096, 12840, 11996, 13977, 20789, 19109, 21212, 20010]
shared_neighbor_graph_partition_s0 selection method  spend 9.35233736038208
time for parepare:  0.01670241355895996
local_output_nid generation:  0.0011627674102783203
local_in_edges_tensor generation:  0.0015132427215576172
mini_batch_src_global generation:  0.0016789436340332031
r_  generation:  0.01552891731262207
local_output_nid generation:  0.0013051033020019531
local_in_edges_tensor generation:  0.0013310909271240234
mini_batch_src_global generation:  0.001424551010131836
r_  generation:  0.009338617324829102
local_output_nid generation:  0.0013191699981689453
local_in_edges_tensor generation:  0.0011868476867675781
mini_batch_src_global generation:  0.0011382102966308594
r_  generation:  0.009794473648071289
local_output_nid generation:  0.0013272762298583984
local_in_edges_tensor generation:  0.0011699199676513672
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.010056495666503906
local_output_nid generation:  0.0013501644134521484
local_in_edges_tensor generation:  0.0011334419250488281
mini_batch_src_global generation:  0.0010826587677001953
r_  generation:  0.009723186492919922
local_output_nid generation:  0.001434326171875
local_in_edges_tensor generation:  0.0011632442474365234
mini_batch_src_global generation:  0.0013318061828613281
r_  generation:  0.014707803726196289
local_output_nid generation:  0.001481771469116211
local_in_edges_tensor generation:  0.0012063980102539062
mini_batch_src_global generation:  0.0011937618255615234
r_  generation:  0.00993204116821289
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.00115203857421875
mini_batch_src_global generation:  0.0010640621185302734
r_  generation:  0.00989222526550293
local_output_nid generation:  0.0014171600341796875
local_in_edges_tensor generation:  0.001093149185180664
mini_batch_src_global generation:  0.0010786056518554688
r_  generation:  0.009252071380615234
local_output_nid generation:  0.0014102458953857422
local_in_edges_tensor generation:  0.001088857650756836
mini_batch_src_global generation:  0.0010273456573486328
r_  generation:  0.008992195129394531
local_output_nid generation:  0.001447916030883789
local_in_edges_tensor generation:  0.0011026859283447266
mini_batch_src_global generation:  0.0010259151458740234
r_  generation:  0.009334087371826172
local_output_nid generation:  0.0014812946319580078
local_in_edges_tensor generation:  0.001135110855102539
mini_batch_src_global generation:  0.0012505054473876953
r_  generation:  0.014559745788574219
local_output_nid generation:  0.0015158653259277344
local_in_edges_tensor generation:  0.0013377666473388672
mini_batch_src_global generation:  0.0016131401062011719
r_  generation:  0.016904592514038086
local_output_nid generation:  0.0014624595642089844
local_in_edges_tensor generation:  0.0013201236724853516
mini_batch_src_global generation:  0.0014569759368896484
r_  generation:  0.01191401481628418
local_output_nid generation:  0.0015330314636230469
local_in_edges_tensor generation:  0.0012328624725341797
mini_batch_src_global generation:  0.0011949539184570312
r_  generation:  0.014132976531982422
local_output_nid generation:  0.0015468597412109375
local_in_edges_tensor generation:  0.0011334419250488281
mini_batch_src_global generation:  0.0014164447784423828
r_  generation:  0.010683298110961914
----------------------check_connections_block total spend ----------------------------- 0.3259563446044922
generate_one_block  0.01698756217956543
generate_one_block  0.01388096809387207
generate_one_block  0.014425277709960938
generate_one_block  0.013635396957397461
generate_one_block  0.017598390579223633
generate_one_block  0.014917850494384766
generate_one_block  0.014078378677368164
generate_one_block  0.013905763626098633
generate_one_block  0.01369619369506836
generate_one_block  0.012104511260986328
generate_one_block  0.012679576873779297
generate_one_block  0.01688551902770996
generate_one_block  0.03590130805969238
generate_one_block  0.01793670654296875
generate_one_block  0.02091813087463379
generate_one_block  0.017648696899414062
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
0
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0.3259563446044922
block generation total time  0.267200231552124
average batch blocks generation time:  0.01670001447200775
pseudo mini batch 0 input nodes size: 10138
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.005364418029785156  GigaBytes
Max Memory Allocated: 0.005364418029785156  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.005408287048339844  GigaBytes
Max Memory Allocated: 0.005408287048339844  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.005408287048339844  GigaBytes
Max Memory Allocated: 0.005408287048339844  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005694389343261719  GigaBytes
Max Memory Allocated: 0.005694389343261719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005694389343261719  GigaBytes
Max Memory Allocated: 0.005694389343261719  GigaBytes

input nodes number: 10138
output nodes number: 5854
edges number: 38316
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.29615306854248047  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5174560546875 GB
    Memory Allocated: 0.2961540222167969  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.007525920867919922  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

pseudo mini batch 1 input nodes size: 11183
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.006812095642089844  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.006812095642089844  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.01214456558227539  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.012188434600830078  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.007310390472412109  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.007514476776123047  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.007514476776123047  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

input nodes number: 11183
output nodes number: 5837
edges number: 27366
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.2185535430908203  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.21855401992797852  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.007865428924560547  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

pseudo mini batch 2 input nodes size: 11525
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.007308006286621094  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.007308006286621094  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.013694286346435547  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.013735771179199219  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.008359432220458984  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.008587360382080078  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.008587360382080078  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

input nodes number: 11525
output nodes number: 5532
edges number: 30575
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.24396705627441406  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.24396753311157227  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.008918285369873047  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

pseudo mini batch 3 input nodes size: 10816
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.008313655853271484  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.008313655853271484  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.013646125793457031  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.013687610626220703  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.007259845733642578  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.007494449615478516  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.007494449615478516  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

input nodes number: 10816
output nodes number: 5535
edges number: 31407
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.24820947647094727  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.24820995330810547  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007872581481933594  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

pseudo mini batch 4 input nodes size: 11918
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007260322570800781  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007260322570800781  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.013646602630615234  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.013688087463378906  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008314132690429688  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.00853729248046875  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.00853729248046875  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

input nodes number: 11918
output nodes number: 5517
edges number: 29943
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.23595380783081055  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.23595428466796875  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.00890970230102539  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

pseudo mini batch 5 input nodes size: 11621
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008311748504638672  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008311748504638672  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.013853073120117188  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.013896942138671875  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.00746917724609375  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007718086242675781  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007718086242675781  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

input nodes number: 11621
output nodes number: 5854
edges number: 33312
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.26471424102783203  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.26471471786499023  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.00816965103149414  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

pseudo mini batch 6 input nodes size: 10461
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007519245147705078  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007519245147705078  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.012507438659667969  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.012551307678222656  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.006966114044189453  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007178783416748047  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007178783416748047  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

input nodes number: 10461
output nodes number: 5850
edges number: 28417
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.2251286506652832  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.2251291275024414  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007534980773925781  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

pseudo mini batch 7 input nodes size: 9618
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.00696563720703125  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.00696563720703125  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.012506961822509766  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.012550830841064453  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007518768310546875  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007739067077636719  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007739067077636719  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

input nodes number: 9618
output nodes number: 5854
edges number: 29482
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.233856201171875  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.2338566780090332  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008097648620605469  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

pseudo mini batch 8 input nodes size: 15096
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007519245147705078  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007519245147705078  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.014717578887939453  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.014759063720703125  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.009173870086669922  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.009383678436279297  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.009383678436279297  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

input nodes number: 15096
output nodes number: 5517
edges number: 28141
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.22469663619995117  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.22469711303710938  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.00971841812133789  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

pseudo mini batch 9 input nodes size: 12840
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.009123802185058594  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.009123802185058594  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.015246391296386719  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.01528787612915039  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008048057556152344  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008240699768066406  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008240699768066406  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

input nodes number: 12840
output nodes number: 5518
edges number: 25824
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.20545101165771484  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.20545148849487305  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008591651916503906  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

pseudo mini batch 10 input nodes size: 11996
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008048057556152344  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008048057556152344  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.013768196105957031  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.013810157775878906  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007646083831787109  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.00785207748413086  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.00785207748413086  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

input nodes number: 11996
output nodes number: 5593
edges number: 27595
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.21848106384277344  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.21848154067993164  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008221626281738281  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

pseudo mini batch 11 input nodes size: 13977
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007657051086425781  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.007657051086425781  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.01432180404663086  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.014365673065185547  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008603572845458984  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008849620819091797  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008849620819091797  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

input nodes number: 13977
output nodes number: 5853
edges number: 32943
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.26090049743652344  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.26090097427368164  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.009305000305175781  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

pseudo mini batch 12 input nodes size: 20789
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.00864267349243164  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.00864267349243164  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.018555641174316406  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.018599510192871094  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.011890888214111328  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.012217998504638672  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.012217998504638672  GigaBytes
Max Memory Allocated: 0.3220977783203125  GigaBytes

input nodes number: 20789
output nodes number: 5854
edges number: 43897
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.340728759765625  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.3407292366027832  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012765884399414062  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

pseudo mini batch 13 input nodes size: 19109
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.011890888214111328  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.011890888214111328  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.021002769470214844  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.021044254302978516  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.011087417602539062  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.0113372802734375  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.0113372802734375  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

input nodes number: 19109
output nodes number: 5523
edges number: 33485
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.2660255432128906  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.26602602005004883  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.011742591857910156  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

pseudo mini batch 14 input nodes size: 21212
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.011037826538085938  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.011037826538085938  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.021152496337890625  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.021195411682128906  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012042045593261719  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012343406677246094  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012343406677246094  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

input nodes number: 21212
output nodes number: 5733
edges number: 40432
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.3152637481689453  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.3152642250061035  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012898921966552734  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

pseudo mini batch 15 input nodes size: 20010
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012073516845703125  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes
[00:38:15] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14292522 edges into 16 parts and get 2481612 edge cuts

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012073516845703125  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.021615028381347656  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.021656513214111328  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.01149892807006836  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.01174020767211914  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.01174020767211914  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

input nodes number: 20010
output nodes number: 5517
edges number: 32279
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.25612306594848633  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.25612354278564453  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.0121612548828125  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.01322174072265625  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.01322174072265625  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006739035248756409 |0.02254617214202881 |0.04651370644569397 |8.417665958404541e-05 |0.012729212641716003 |0.002283811569213867 |
----------------------------------------------------------pseudo_mini_loss sum 3.837982416152954
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  222309
Number of first layer input nodes during this epoch:  222309
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.013221263885498047  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024366140365600586
global_2_local spend time (sec) 0.03667449951171875
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003492593765258789
A = g.adjacency_matrix() spent  0.005858421325683594
auxiliary_graph
Graph(num_nodes=145011, num_edges=14383463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07514524459838867
remove nodes length
54070
auxiliary_graph.remove_nodes spent  0.63889479637146
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14383463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.5893294811248779

the counter of shared neighbor distribution
Counter({1.0: 12899386, 2.0: 1178670, 3.0: 168286, 4.0: 33534, 5.0: 8856, 6.0: 2754, 7.0: 796, 8.0: 198, 9.0: 40, 10.0: 2})
14292522
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14292519, 14292520, 14292521])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12899386, 2.0: 1178670, 3.0: 168286, 4.0: 33534, 5.0: 8856, 6.0: 2754, 7.0: 796, 8.0: 198, 9.0: 40, 10.0: 2})
Convert a graph into a bidirected graph: 0.568 seconds
Metis partitioning: 2.752 seconds
Split the graph: 0.510 seconds
Construct subgraphs: 0.058 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  3.8952925205230713
5548
5517
5517
5789
5836
5640
5518
5517
5517
5854
5802
5709
5854
5852
5794
5677
total k batches seeds list generation spend  8.887061357498169
after graph partition
graph partition algorithm spend time 8.951937913894653
5548
5517
5517
5789
5836
5640
5518
5517
5517
5854
5802
5709
5854
5852
5794
5677
partition_len_list
[20793, 20088, 19323, 21788, 14085, 12075, 16020, 14914, 11319, 11320, 9929, 10816, 10859, 11864, 10086, 10293]
shared_neighbor_graph_partition_s0 selection method  spend 9.042083263397217
time for parepare:  0.01744222640991211
local_output_nid generation:  0.0012242794036865234
local_in_edges_tensor generation:  0.001363515853881836
mini_batch_src_global generation:  0.00135040283203125
r_  generation:  0.011654853820800781
local_output_nid generation:  0.0013468265533447266
local_in_edges_tensor generation:  0.0013093948364257812
mini_batch_src_global generation:  0.0018596649169921875
r_  generation:  0.00990915298461914
local_output_nid generation:  0.0015516281127929688
local_in_edges_tensor generation:  0.0011830329895019531
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.012151241302490234
local_output_nid generation:  0.0017082691192626953
local_in_edges_tensor generation:  0.0017514228820800781
mini_batch_src_global generation:  0.0012760162353515625
r_  generation:  0.014748096466064453
local_output_nid generation:  0.0018334388732910156
local_in_edges_tensor generation:  0.0011730194091796875
mini_batch_src_global generation:  0.0011854171752929688
r_  generation:  0.012532234191894531
local_output_nid generation:  0.0017981529235839844
local_in_edges_tensor generation:  0.0011930465698242188
mini_batch_src_global generation:  0.001180887222290039
r_  generation:  0.009645223617553711
local_output_nid generation:  0.001856088638305664
local_in_edges_tensor generation:  0.0011043548583984375
mini_batch_src_global generation:  0.0011987686157226562
r_  generation:  0.009452581405639648
local_output_nid generation:  0.0018203258514404297
local_in_edges_tensor generation:  0.0010852813720703125
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.00981903076171875
local_output_nid generation:  0.0018203258514404297
local_in_edges_tensor generation:  0.0010614395141601562
mini_batch_src_global generation:  0.001157522201538086
r_  generation:  0.009652853012084961
local_output_nid generation:  0.0018982887268066406
local_in_edges_tensor generation:  0.0011353492736816406
mini_batch_src_global generation:  0.0010683536529541016
r_  generation:  0.012779712677001953
local_output_nid generation:  0.0018265247344970703
local_in_edges_tensor generation:  0.0011768341064453125
mini_batch_src_global generation:  0.000988006591796875
r_  generation:  0.012494802474975586
local_output_nid generation:  0.001714944839477539
local_in_edges_tensor generation:  0.0011522769927978516
mini_batch_src_global generation:  0.0011096000671386719
r_  generation:  0.018909931182861328
local_output_nid generation:  0.004174232482910156
local_in_edges_tensor generation:  0.002115488052368164
mini_batch_src_global generation:  0.0019636154174804688
r_  generation:  0.021696090698242188
local_output_nid generation:  0.002552509307861328
local_in_edges_tensor generation:  0.0012698173522949219
mini_batch_src_global generation:  0.0013780593872070312
r_  generation:  0.010690927505493164
local_output_nid generation:  0.002239227294921875
local_in_edges_tensor generation:  0.0011501312255859375
mini_batch_src_global generation:  0.0011858940124511719
r_  generation:  0.009341955184936523
local_output_nid generation:  0.0020694732666015625
local_in_edges_tensor generation:  0.0011250972747802734
mini_batch_src_global generation:  0.0011644363403320312
r_  generation:  0.00949859619140625
----------------------check_connections_block total spend ----------------------------- 0.34417152404785156
generate_one_block  0.043955326080322266
generate_one_block  0.018601655960083008
generate_one_block  0.017290592193603516
generate_one_block  0.022337913513183594
generate_one_block  0.016384363174438477
generate_one_block  0.013866424560546875
generate_one_block  0.014301300048828125
generate_one_block  0.013842344284057617
generate_one_block  0.013074636459350586
generate_one_block  0.016310930252075195
generate_one_block  0.016419649124145508
generate_one_block  0.01653146743774414
generate_one_block  0.015622854232788086
generate_one_block  0.013733148574829102
generate_one_block  0.011785030364990234
generate_one_block  0.012361764907836914
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
0
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.013221263885498047  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

connection checking time:  0.34417152404785156
block generation total time  0.27641940116882324
average batch blocks generation time:  0.017276212573051453
block dataloader generation time/epoch 9.73023772239685
pseudo mini batch 0 input nodes size: 20793
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012526512145996094  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012526512145996094  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.022441387176513672  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.022482872009277344  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.01289987564086914  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.013161182403564453  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.013161182403564453  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

input nodes number: 20793
output nodes number: 5548
edges number: 35037
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.28080034255981445  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.28080129623413086  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.013645172119140625  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

pseudo mini batch 1 input nodes size: 20088
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012905120849609375  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012905120849609375  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.02248382568359375  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.022525310516357422  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012568950653076172  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012794017791748047  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012794017791748047  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

input nodes number: 20088
output nodes number: 5517
edges number: 30125
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.24683666229248047  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.24683713912963867  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.013226985931396484  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

pseudo mini batch 2 input nodes size: 19323
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012564659118652344  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012564659118652344  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.021778583526611328  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.021820068359375  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012199878692626953  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012463092803955078  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012463092803955078  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

input nodes number: 19323
output nodes number: 5517
edges number: 35210
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.2790412902832031  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.27904176712036133  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012932777404785156  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

pseudo mini batch 3 input nodes size: 21788
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012199878692626953  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.012199878692626953  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.02258920669555664  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.022632598876953125  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.013377189636230469  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.013705253601074219  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.013705253601074219  GigaBytes
Max Memory Allocated: 0.3763132095336914  GigaBytes

input nodes number: 21788
output nodes number: 5789
edges number: 43959
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.34143877029418945  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.34143924713134766  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.014301776885986328  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 4 input nodes size: 14085
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.013417720794677734  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.013417720794677734  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.02013397216796875  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.020177841186523438  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.009745121002197266  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.009991168975830078  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.009991168975830078  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 14085
output nodes number: 5836
edges number: 32970
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26073408126831055  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26073455810546875  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.010415077209472656  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 5 input nodes size: 12075
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.00975179672241211  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.00975179672241211  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.015509605407714844  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.015552043914794922  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.008791923522949219  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.008996009826660156  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.008996009826660156  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 12075
output nodes number: 5640
edges number: 27320
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21895408630371094  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21895456314086914  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.009325027465820312  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 6 input nodes size: 16020
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.008762836456298828  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.008762836456298828  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.01640176773071289  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.016443252563476562  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.01064300537109375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.010853767395019531  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.010853767395019531  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 16020
output nodes number: 5518
edges number: 28268
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.22999191284179688  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.22999238967895508  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.011228561401367188  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 7 input nodes size: 14914
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.010624885559082031  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.010624885559082031  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.017736434936523438  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.01777791976928711  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.010097503662109375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.010315895080566406  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.010315895080566406  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 14914
output nodes number: 5517
edges number: 29248
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.23351097106933594  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.23351144790649414  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.010708332061767578  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 8 input nodes size: 11319
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.010097503662109375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.010097503662109375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.015494823455810547  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.015536308288574219  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.00838327407836914  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.008597850799560547  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.008597850799560547  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 11319
output nodes number: 5517
edges number: 28792
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.22950077056884766  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.22950124740600586  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.008959293365478516  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 9 input nodes size: 11320
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.00838327407836914  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.00838327407836914  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.014704704284667969  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.014748573303222656  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.009309768676757812  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.009577751159667969  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.009577751159667969  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 11320
output nodes number: 5854
edges number: 35892
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.28273820877075195  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.28273868560791016  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.010046005249023438  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 10 input nodes size: 9929
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.00935983657836914  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.00935983657836914  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.014757156372070312  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.014800548553466797  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.008435249328613281  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.008696556091308594  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.008696556091308594  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 9929
output nodes number: 5802
edges number: 34964
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2722311019897461  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2722315788269043  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009089946746826172  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 11 input nodes size: 10816
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008427619934082031  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008427619934082031  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013585090637207031  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013628005981445312  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008187294006347656  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008446693420410156  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008446693420410156  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 10816
output nodes number: 5709
edges number: 34767
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2727231979370117  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2727236747741699  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008837223052978516  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 12 input nodes size: 10859
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008173465728759766  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008173465728759766  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013570785522460938  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013614654541015625  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008414268493652344  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008657455444335938  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008657455444335938  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 10859
output nodes number: 5854
edges number: 32524
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2557835578918457  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2557840347290039  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009068965911865234  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 13 input nodes size: 11864
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008435726165771484  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008435726165771484  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.014757156372070312  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.014801025390625  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00935983657836914  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009589672088623047  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009589672088623047  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 11864
output nodes number: 5852
edges number: 30727
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.24574565887451172  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.24574613571166992  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009973526000976562  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 14 input nodes size: 10086
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009359359741210938  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes
[00:38:25] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14284864 edges into 16 parts and get 2476247 edge cuts

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009359359741210938  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01475667953491211  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.014800071716308594  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008434772491455078  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008629322052001953  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008629322052001953  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 10086
output nodes number: 5794
edges number: 26095
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2110438346862793  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2110443115234375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008955955505371094  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 15 input nodes size: 10293
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008426189422607422  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008426189422607422  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013334274291992188  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013376712799072266  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00793600082397461  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008141040802001953  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008141040802001953  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 10293
output nodes number: 5677
edges number: 27516
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.22011661529541016  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.22011709213256836  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008469581604003906  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008469581604003906  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008469581604003906  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005311876535415649 |0.0005559623241424561 |0.020095020532608032 |9.760260581970215e-05 |0.012959852814674377 |0.002329111099243164 |
----------------------------------------------------------pseudo_mini_loss sum 3.2689831256866455
Total (block generation + training)time/epoch 10.425880432128906
* Pure training time/epoch 0.6266541481018066
Training time/epoch 0.6953611373901367
Training time without block to device /epoch 0.6864657402038574
Training time without total dataloading part /epoch 0.532768726348877
load block tensor time/epoch 0.08499002456665039
block to device time/epoch 0.008895397186279297
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  225572
Number of first layer input nodes during this epoch:  225572
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008469104766845703  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017972469329833984
global_2_local spend time (sec) 0.04891681671142578
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0036945343017578125
A = g.adjacency_matrix() spent  0.0072667598724365234
auxiliary_graph
Graph(num_nodes=145027, num_edges=14375805,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07730865478515625
remove nodes length
54086
auxiliary_graph.remove_nodes spent  0.6507449150085449
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14375805,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.5882241725921631

the counter of shared neighbor distribution
Counter({1.0: 12899956, 2.0: 1173186, 3.0: 165808, 4.0: 33362, 5.0: 8940, 6.0: 2608, 7.0: 762, 8.0: 204, 9.0: 36, 10.0: 2})
14284864
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14284861, 14284862, 14284863])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12899956, 2.0: 1173186, 3.0: 165808, 4.0: 33362, 5.0: 8940, 6.0: 2608, 7.0: 762, 8.0: 204, 9.0: 36, 10.0: 2})
Convert a graph into a bidirected graph: 0.620 seconds
Metis partitioning: 2.820 seconds
Split the graph: 0.472 seconds
Construct subgraphs: 0.081 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.000556707382202
5854
5809
5704
5517
5854
5768
5842
5791
5524
5559
5517
5718
5601
5840
5521
5522
total k batches seeds list generation spend  8.998134136199951
after graph partition
graph partition algorithm spend time 9.068331956863403
5854
5809
5704
5517
5854
5768
5842
5791
5524
5559
5517
5718
5601
5840
5521
5522
partition_len_list
[10156, 10014, 11427, 11737, 11508, 9949, 12102, 13073, 18425, 20659, 20874, 19701, 12016, 12273, 15294, 15899]
shared_neighbor_graph_partition_s0 selection method  spend 9.173695802688599
time for parepare:  0.017405986785888672
local_output_nid generation:  0.0012753009796142578
local_in_edges_tensor generation:  0.001547098159790039
mini_batch_src_global generation:  0.0015523433685302734
r_  generation:  0.012947797775268555
local_output_nid generation:  0.0014412403106689453
local_in_edges_tensor generation:  0.0014290809631347656
mini_batch_src_global generation:  0.001581430435180664
r_  generation:  0.01056814193725586
local_output_nid generation:  0.0015375614166259766
local_in_edges_tensor generation:  0.0013043880462646484
mini_batch_src_global generation:  0.0013065338134765625
r_  generation:  0.01007080078125
local_output_nid generation:  0.0015368461608886719
local_in_edges_tensor generation:  0.0012013912200927734
mini_batch_src_global generation:  0.0013515949249267578
r_  generation:  0.011884689331054688
local_output_nid generation:  0.0017330646514892578
local_in_edges_tensor generation:  0.0012307167053222656
mini_batch_src_global generation:  0.0012047290802001953
r_  generation:  0.010349750518798828
local_output_nid generation:  0.0016603469848632812
local_in_edges_tensor generation:  0.0012068748474121094
mini_batch_src_global generation:  0.001077890396118164
r_  generation:  0.009666204452514648
local_output_nid generation:  0.001678466796875
local_in_edges_tensor generation:  0.0012009143829345703
mini_batch_src_global generation:  0.001005411148071289
r_  generation:  0.01206207275390625
local_output_nid generation:  0.0016984939575195312
local_in_edges_tensor generation:  0.001256704330444336
mini_batch_src_global generation:  0.0014662742614746094
r_  generation:  0.011232614517211914
local_output_nid generation:  0.0017344951629638672
local_in_edges_tensor generation:  0.0011699199676513672
mini_batch_src_global generation:  0.0011892318725585938
r_  generation:  0.009089231491088867
local_output_nid generation:  0.001708984375
local_in_edges_tensor generation:  0.0011944770812988281
mini_batch_src_global generation:  0.001184225082397461
r_  generation:  0.013933181762695312
local_output_nid generation:  0.003045320510864258
local_in_edges_tensor generation:  0.0012693405151367188
mini_batch_src_global generation:  0.01487874984741211
r_  generation:  0.014796733856201172
local_output_nid generation:  0.0018894672393798828
local_in_edges_tensor generation:  0.001253366470336914
mini_batch_src_global generation:  0.0016171932220458984
r_  generation:  0.016705989837646484
local_output_nid generation:  0.0018780231475830078
local_in_edges_tensor generation:  0.0011906623840332031
mini_batch_src_global generation:  0.00121307373046875
r_  generation:  0.009438276290893555
local_output_nid generation:  0.0019373893737792969
local_in_edges_tensor generation:  0.0012063980102539062
mini_batch_src_global generation:  0.0012123584747314453
r_  generation:  0.00982213020324707
local_output_nid generation:  0.001794576644897461
local_in_edges_tensor generation:  0.001134634017944336
mini_batch_src_global generation:  0.0012066364288330078
r_  generation:  0.009772300720214844
local_output_nid generation:  0.0017647743225097656
local_in_edges_tensor generation:  0.0011150836944580078
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.009547948837280273
----------------------check_connections_block total spend ----------------------------- 0.3439943790435791
generate_one_block  0.022624969482421875
generate_one_block  0.019756317138671875
generate_one_block  0.014799118041992188
generate_one_block  0.014045476913452148
generate_one_block  0.013516664505004883
generate_one_block  0.012556076049804688
generate_one_block  0.014856576919555664
generate_one_block  0.015964984893798828
generate_one_block  0.014697074890136719
generate_one_block  0.017406225204467773
generate_one_block  0.01872849464416504
generate_one_block  0.021126508712768555
generate_one_block  0.01360177993774414
generate_one_block  0.013646602630615234
generate_one_block  0.01428532600402832
generate_one_block  0.013549089431762695
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
0
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008469104766845703  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

connection checking time:  0.3439943790435791
block generation total time  0.2551612854003906
average batch blocks generation time:  0.015947580337524414
block dataloader generation time/epoch 9.78389585018158
pseudo mini batch 0 input nodes size: 10156
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00791788101196289  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00791788101196289  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013315200805664062  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01335906982421875  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008408546447753906  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008691787719726562  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008691787719726562  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 10156
output nodes number: 5854
edges number: 37995
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.3015298843383789  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.3015308380126953  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009143829345703125  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 1 input nodes size: 10014
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008435726165771484  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008435726165771484  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013210773468017578  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013254165649414062  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.007812976837158203  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008044719696044922  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008044719696044922  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 10014
output nodes number: 5809
edges number: 31102
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.24486160278320312  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.24486207962036133  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008409976959228516  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 2 input nodes size: 11427
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.007806301116943359  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.007806301116943359  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013255119323730469  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01329803466796875  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008479595184326172  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00871419906616211  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00871419906616211  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 11427
output nodes number: 5704
edges number: 31425
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.24863815307617188  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.24863862991333008  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009082794189453125  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 3 input nodes size: 11737
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008463859558105469  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008463859558105469  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01473379135131836  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.014775276184082031  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00928354263305664  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009521007537841797  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009521007537841797  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 11737
output nodes number: 5517
edges number: 31764
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.25150156021118164  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.25150203704833984  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009881019592285156  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 4 input nodes size: 11508
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00925588607788086  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00925588607788086  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.014743328094482422  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01478719711303711  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008475780487060547  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008702754974365234  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008702754974365234  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 11508
output nodes number: 5854
edges number: 30460
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2401261329650879  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2401266098022461  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009131431579589844  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 5 input nodes size: 9949
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008525848388671875  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008525848388671875  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013269901275634766  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01331329345703125  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.007781982421875  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.007993698120117188  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.007993698120117188  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 9949
output nodes number: 5768
edges number: 28369
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2270493507385254  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2270498275756836  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008332252502441406  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 6 input nodes size: 12102
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.007769107818603516  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.007769107818603516  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013539791107177734  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013583660125732422  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008796215057373047  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009048938751220703  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009048938751220703  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 12102
output nodes number: 5842
edges number: 33848
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2644166946411133  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2644171714782715  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009469032287597656  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 7 input nodes size: 13073
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008807182312011719  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008807182312011719  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.015040874481201172  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.015084266662597656  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00926971435546875  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.0095062255859375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.0095062255859375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 13073
output nodes number: 5791
edges number: 31714
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2513084411621094  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2513089179992676  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009898185729980469  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 8 input nodes size: 18425
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.0092620849609375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.0092620849609375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.018047809600830078  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01808929443359375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.011812210083007812  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.012021064758300781  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.012021064758300781  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 18425
output nodes number: 5524
edges number: 27976
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.22524785995483398  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2252483367919922  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01239013671875  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 9 input nodes size: 20659
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.011772632598876953  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.011772632598876953  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.021623611450195312  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.021665096282958984  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.012837886810302734  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013111591339111328  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013111591339111328  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 20659
output nodes number: 5559
edges number: 36684
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2937049865722656  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.29370546340942383  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013607025146484375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 10 input nodes size: 20874
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.012843132019042969  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.012843132019042969  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.022796630859375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.022838115692138672  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01294565200805664  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01321268081665039  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01321268081665039  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 20874
output nodes number: 5517
edges number: 35735
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2872605323791504  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2872610092163086  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013691902160644531  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 11 input nodes size: 19701
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.012939453125  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.012939453125  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.022333621978759766  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.022376537322998047  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.012381553649902344  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.012700080871582031  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.012700080871582031  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 19701
output nodes number: 5718
edges number: 42751
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.34120893478393555  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.34120941162109375  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.013259410858154297  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 12 input nodes size: 12016
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.012411117553710938  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.012411117553710938  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.018140792846679688  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.018182754516601562  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008745670318603516  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00894308090209961  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00894308090209961  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 12016
output nodes number: 5601
edges number: 26393
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2133326530456543  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2133331298828125  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.00927591323852539  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 13 input nodes size: 12273
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008728504180908203  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008728504180908203  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.014717578887939453  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01476144790649414  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.008989810943603516  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009206295013427734  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009206295013427734  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 12273
output nodes number: 5840
edges number: 29026
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2302384376525879  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2302389144897461  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009615421295166016  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 14 input nodes size: 15294
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009025096893310547  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.009025096893310547  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01631784439086914  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.016359329223632812  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.010326385498046875  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.010547637939453125  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.010547637939453125  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 15294
output nodes number: 5521
edges number: 29639
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.23531150817871094  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.23531198501586914  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.010898113250732422  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

pseudo mini batch 15 input nodes size: 15899
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.010279178619384766  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.010279178619384766  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01786041259765625  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.017901897430419922  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.010567665100097656  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01078033447265625  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.01078033447265625  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

input nodes number: 15899
output nodes number: 5522
edges number: 28533
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.2283954620361328  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.22839593887329102  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.011174201965332031  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.011174201965332031  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.011174201965332031  GigaBytes
Max Memory Allocated: 0.3771195411682129  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004767134785652161 |0.00042933225631713867 |0.01802229881286621 |8.55475664138794e-05 |0.011480003595352173 |0.0027637481689453125 |
----------------------------------------------------------pseudo_mini_loss sum 3.1691360473632812
Total (block generation + training)time/epoch 10.447441577911377
* Pure training time/epoch 0.5593128204345703
Training time/epoch 0.6311626434326172
Training time without block to device /epoch 0.624293327331543
Training time without total dataloading part /epoch 0.4761693477630615
load block tensor time/epoch 0.07627415657043457
block to device time/epoch 0.006869316101074219Using backend: pytorch

input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  225107
Number of first layer input nodes during this epoch:  225107
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
