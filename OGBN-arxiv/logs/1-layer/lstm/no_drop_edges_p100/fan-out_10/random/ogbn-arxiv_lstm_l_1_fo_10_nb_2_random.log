main start at this time 1651799404.7382634
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032095909118652344
number of batches is  2
batch size is  45471
random selection method spend 0.007592201232910156
time for parepare:  0.02098703384399414
local_output_nid generation:  0.014700889587402344
local_in_edges_tensor generation:  0.020163297653198242
mini_batch_src_global generation:  0.009358644485473633
r_  generation:  0.14409279823303223
local_output_nid generation:  0.02262711524963379
local_in_edges_tensor generation:  0.012646913528442383
mini_batch_src_global generation:  0.012508153915405273
r_  generation:  0.15187931060791016
----------------------check_connections_block total spend ----------------------------- 0.47173190116882324
generate_one_block  0.1514420509338379
generate_one_block  0.148451566696167
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 115251
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8779296875 GB
    Memory Allocated: 0.055486202239990234  GigaBytes
Max Memory Allocated: 0.055486202239990234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8779296875 GB
    Memory Allocated: 0.055825233459472656  GigaBytes
Max Memory Allocated: 0.055825233459472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8779296875 GB
    Memory Allocated: 0.055825233459472656  GigaBytes
Max Memory Allocated: 0.055825233459472656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.9287109375 GB
    Memory Allocated: 0.05773735046386719  GigaBytes
Max Memory Allocated: 0.05773735046386719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.9287109375 GB
    Memory Allocated: 0.05773735046386719  GigaBytes
Max Memory Allocated: 0.05773735046386719  GigaBytes

input nodes number: 115251
output nodes number: 45471
edges number: 256569
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 2.0128531455993652  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 2.0128540992736816  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.06832408905029297  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

pseudo mini batch 1 input nodes size: 115134
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.06313228607177734  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.06313228607177734  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.11803245544433594  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.11837148666381836  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.06307649612426758  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.06499052047729492  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.06499052047729492  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

input nodes number: 115134
output nodes number: 45470
edges number: 256845
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 2.0169010162353516  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 2.0169014930725098  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 0.06827116012573242  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 0.06933164596557617  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 0.06933164596557617  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03936421871185303 |0.19950032234191895 |0.2693067789077759 |0.0003064870834350586 |0.026909828186035156 |0.0057103633880615234 |
----------------------------------------------------------pseudo_mini_loss sum 3.8380470275878906
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  230385
Number of first layer input nodes during this epoch:  230385
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 0.06933116912841797  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.013767719268798828
number of batches is  2
batch size is  45471
random selection method spend 0.011564254760742188
time for parepare:  0.03370165824890137
local_output_nid generation:  0.02294445037841797
local_in_edges_tensor generation:  0.01736140251159668
mini_batch_src_global generation:  0.010058403015136719
r_  generation:  0.14219212532043457
local_output_nid generation:  0.021809101104736328
local_in_edges_tensor generation:  0.01256871223449707
mini_batch_src_global generation:  0.011784553527832031
r_  generation:  0.15704941749572754
----------------------check_connections_block total spend ----------------------------- 0.4915614128112793
generate_one_block  0.1620960235595703
generate_one_block  0.15933942794799805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 0.06933116912841797  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.8862659931182861
pseudo mini batch 0 input nodes size: 115295
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 0.06413602828979492  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 0.06413602828979492  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 0.11911296844482422  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 0.11945199966430664  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 0.06421279907226562  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 0.06613445281982422  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3701171875 GB
    Memory Allocated: 0.06613445281982422  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

input nodes number: 115295
output nodes number: 45471
edges number: 257849
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 2.0487704277038574  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 2.048771381378174  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06942510604858398  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

pseudo mini batch 1 input nodes size: 115390
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06421375274658203  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06421375274658203  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.11923599243164062  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.11957502365112305  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06425905227661133  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06616353988647461  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06616353988647461  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

input nodes number: 115390
output nodes number: 45470
edges number: 255565
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 2.0040693283081055  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 2.0040698051452637  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06943655014038086  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06943655014038086  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06943655014038086  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024226903915405273 |0.0013604164123535156 |0.03438866138458252 |0.000738978385925293 |0.025265932083129883 |0.0023293495178222656 |
----------------------------------------------------------pseudo_mini_loss sum 3.2683944702148438
Total (block generation + training)time/epoch 1.0714352130889893
Training time/epoch 0.18497586250305176
Training time without block to device /epoch 0.18225502967834473
Training time without total dataloading part /epoch 0.12311649322509766
load block tensor time/epoch 0.04845380783081055
block to device time/epoch 0.0027208328247070312
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  230685
Number of first layer input nodes during this epoch:  230685
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06943607330322266  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03379082679748535
number of batches is  2
batch size is  45471
random selection method spend 0.008361339569091797
time for parepare:  0.023102521896362305
local_output_nid generation:  0.015062332153320312
local_in_edges_tensor generation:  0.018551349639892578
mini_batch_src_global generation:  0.012965679168701172
r_  generation:  0.148207426071167
local_output_nid generation:  0.026443004608154297
local_in_edges_tensor generation:  0.015472650527954102
mini_batch_src_global generation:  0.013231039047241211
r_  generation:  0.15025067329406738
----------------------check_connections_block total spend ----------------------------- 0.4887692928314209
generate_one_block  0.15988588333129883
generate_one_block  0.14905571937561035
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06943607330322266  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.8776148557662964
pseudo mini batch 0 input nodes size: 115374
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06425809860229492  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06425809860229492  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes
Using backend: pytorch

----------------------------------------after batch input features to device
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.11927270889282227  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.11961174011230469  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06425046920776367  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06616735458374023  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06616735458374023  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

input nodes number: 115374
output nodes number: 45471
edges number: 257265
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 2.0484237670898438  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 2.04842472076416  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06945371627807617  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

pseudo mini batch 1 input nodes size: 115412
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06425142288208008  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06425142288208008  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.11928415298461914  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.11962318420410156  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.0642695426940918  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06617879867553711  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.06617879867553711  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

input nodes number: 115412
output nodes number: 45470
edges number: 256149
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 2.0114917755126953  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 2.0114922523498535  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.0694570541381836  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.0694570541381836  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.5068359375 GB
    Memory Allocated: 0.0694570541381836  GigaBytes
Max Memory Allocated: 2.2170753479003906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02969801425933838 |0.0015170574188232422 |0.03488779067993164 |0.00015270709991455078 |0.02006518840789795 |0.0036356449127197266 |
----------------------------------------------------------pseudo_mini_loss sum 3.169322967529297
Total (block generation + training)time/epoch 1.0646311044692993
Training time/epoch 0.18862366676330566
Training time without block to device /epoch 0.18558955192565918
Training time without total dataloading part /epoch 0.11384701728820801
load block tensor time/epoch 0.05939602851867676
block to device time/epoch 0.0030341148376464844
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  230786
Number of first layer input nodes during this epoch:  230786
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
