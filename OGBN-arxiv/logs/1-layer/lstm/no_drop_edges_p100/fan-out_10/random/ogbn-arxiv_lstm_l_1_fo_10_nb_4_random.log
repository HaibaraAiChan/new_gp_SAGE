main start at this time 1651799419.5174537
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0825798511505127
number of batches is  4
batch size is  22736
random selection method spend 0.007825851440429688
time for parepare:  0.0194244384765625
local_output_nid generation:  0.0070285797119140625
local_in_edges_tensor generation:  0.010602474212646484
mini_batch_src_global generation:  0.006094217300415039
r_  generation:  0.06304931640625
local_output_nid generation:  0.009851932525634766
local_in_edges_tensor generation:  0.0056378841400146484
mini_batch_src_global generation:  0.006894826889038086
r_  generation:  0.06651735305786133
local_output_nid generation:  0.009940862655639648
local_in_edges_tensor generation:  0.005667448043823242
mini_batch_src_global generation:  0.00561213493347168
r_  generation:  0.06890535354614258
local_output_nid generation:  0.010216712951660156
local_in_edges_tensor generation:  0.00494837760925293
mini_batch_src_global generation:  0.005597352981567383
r_  generation:  0.06876397132873535
----------------------check_connections_block total spend ----------------------------- 0.43680524826049805
generate_one_block  0.07846593856811523
generate_one_block  0.07759428024291992
generate_one_block  0.07812237739562988
generate_one_block  0.0777885913848877
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 80248
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8603515625 GB
    Memory Allocated: 0.039592742919921875  GigaBytes
Max Memory Allocated: 0.039592742919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8603515625 GB
    Memory Allocated: 0.03976249694824219  GigaBytes
Max Memory Allocated: 0.03976249694824219  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8603515625 GB
    Memory Allocated: 0.03976249694824219  GigaBytes
Max Memory Allocated: 0.03976249694824219  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.9091796875 GB
    Memory Allocated: 0.04071617126464844  GigaBytes
Max Memory Allocated: 0.04071617126464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.9091796875 GB
    Memory Allocated: 0.04071617126464844  GigaBytes
Max Memory Allocated: 0.04071617126464844  GigaBytes

input nodes number: 80248
output nodes number: 22736
edges number: 127931
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0556640625 GB
    Memory Allocated: 1.0317482948303223  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0556640625 GB
    Memory Allocated: 1.0317492485046387  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0576171875 GB
    Memory Allocated: 0.04644155502319336  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

pseudo mini batch 1 input nodes size: 80951
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0576171875 GB
    Memory Allocated: 0.04368162155151367  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0576171875 GB
    Memory Allocated: 0.04368162155151367  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0576171875 GB
    Memory Allocated: 0.08228206634521484  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0576171875 GB
    Memory Allocated: 0.08245182037353516  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0576171875 GB
    Memory Allocated: 0.043219566345214844  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0576171875 GB
    Memory Allocated: 0.04417896270751953  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0576171875 GB
    Memory Allocated: 0.04417896270751953  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

input nodes number: 80951
output nodes number: 22736
edges number: 128648
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 1.0216283798217773  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 1.0216288566589355  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.04599618911743164  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

pseudo mini batch 2 input nodes size: 80466
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.043219566345214844  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.043219566345214844  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.08228206634521484  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.08245182037353516  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.04368162155151367  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.04463911056518555  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.04463911056518555  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

input nodes number: 80466
output nodes number: 22736
edges number: 128429
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 1.0239653587341309  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 1.023965835571289  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.04645109176635742  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

pseudo mini batch 3 input nodes size: 80520
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.04368162155151367  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.04368162155151367  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.0820765495300293  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.08224630355834961  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.0430140495300293  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.04397153854370117  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.04397153854370117  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

input nodes number: 80520
output nodes number: 22733
edges number: 128406
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.020500659942627  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.0205011367797852  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04578399658203125  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.046844482421875  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.046844482421875  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01831650733947754 |0.09820598363876343 |0.13338208198547363 |0.00014793872833251953 |0.02389591932296753 |0.0020372867584228516 |
----------------------------------------------------------pseudo_mini_loss sum 3.838047504425049
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  322185
Number of first layer input nodes during this epoch:  322185
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.0468440055847168  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.011511802673339844
number of batches is  4
batch size is  22736
random selection method spend 0.007341861724853516
time for parepare:  0.01904439926147461
local_output_nid generation:  0.00709843635559082
local_in_edges_tensor generation:  0.009277105331420898
mini_batch_src_global generation:  0.005942344665527344
r_  generation:  0.06193208694458008
local_output_nid generation:  0.010095834732055664
local_in_edges_tensor generation:  0.004869937896728516
mini_batch_src_global generation:  0.006864070892333984
r_  generation:  0.0654599666595459
local_output_nid generation:  0.009925127029418945
local_in_edges_tensor generation:  0.005117893218994141
mini_batch_src_global generation:  0.0053577423095703125
r_  generation:  0.06671953201293945
local_output_nid generation:  0.010343313217163086
local_in_edges_tensor generation:  0.005866050720214844
mini_batch_src_global generation:  0.0055162906646728516
r_  generation:  0.06787586212158203
----------------------check_connections_block total spend ----------------------------- 0.42788004875183105
generate_one_block  0.07879781723022461
generate_one_block  0.07855844497680664
generate_one_block  0.07809615135192871
generate_one_block  0.0793905258178711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.0468440055847168  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.7934432029724121
pseudo mini batch 0 input nodes size: 80481
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04407358169555664  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04407358169555664  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08313608169555664  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08330583572387695  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.044741153717041016  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.045697689056396484  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.045697689056396484  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

input nodes number: 80481
output nodes number: 22736
edges number: 128381
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.020946979522705  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.0209479331970215  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04750967025756836  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

pseudo mini batch 1 input nodes size: 80670
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08320856094360352  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08337831497192383  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.044146060943603516  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04511117935180664  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04511117935180664  GigaBytes
Max Memory Allocated: 1.1100664138793945  GigaBytes

input nodes number: 80670
output nodes number: 22736
edges number: 129470
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.0309062004089355  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.0309066772460938  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.046932220458984375  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

pseudo mini batch 2 input nodes size: 80748
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.044146060943603516  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.044146060943603516  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08320856094360352  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08337831497192383  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04569387435913086  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04569387435913086  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

input nodes number: 80748
output nodes number: 22736
edges number: 127735
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.0225830078125  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.0225834846496582  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04750204086303711  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

pseudo mini batch 3 input nodes size: 80404
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08308172225952148  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.0832514762878418  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.044019222259521484  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04497194290161133  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04497194290161133  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

input nodes number: 80404
output nodes number: 22733
edges number: 127828
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.018733024597168  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.0187335014343262  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04677867889404297  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04677867889404297  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04677867889404297  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012575626373291016 |0.0006617903709411621 |0.021464407444000244 |0.00010842084884643555 |0.023308098316192627 |0.0024421215057373047 |
----------------------------------------------------------pseudo_mini_loss sum 3.268394947052002
Total (block generation + training)time/epoch 1.0479860305786133
Training time/epoch 0.2543494701385498
Training time without block to device /epoch 0.25170230865478516
Training time without total dataloading part /epoch 0.18196582794189453
load block tensor time/epoch 0.05030250549316406
block to device time/epoch 0.0026471614837646484
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  322303
Number of first layer input nodes during this epoch:  322303
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.046778202056884766  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01204681396484375
number of batches is  4
batch size is  22736
random selection method spend 0.006861209869384766
time for parepare:  0.01914191246032715
local_output_nid generation:  0.0071332454681396484
local_in_edges_tensor generation:  0.009945154190063477
mini_batch_src_global generation:  0.006025552749633789
r_  generation:  0.0638270378112793
local_output_nid generation:  0.012785196304321289
local_in_edges_tensor generation:  0.008056879043579102
mini_batch_src_global generation:  0.007212638854980469
r_  generation:  0.06667685508728027
local_output_nid generation:  0.01031184196472168
local_in_edges_tensor generation:  0.00619959831237793
mini_batch_src_global generation:  0.005462169647216797
r_  generation:  0.06858992576599121
local_output_nid generation:  0.010371923446655273
local_in_edges_tensor generation:  0.005908966064453125
mini_batch_src_global generation:  0.009044170379638672
r_  generation:  0.0690469741821289
----------------------check_connections_block total spend ----------------------------- 0.45442628860473633
generate_one_block  0.07869148254394531
generate_one_block  0.08312201499938965
generate_one_block  0.07890748977661133
generate_one_block  0.07820749282836914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.046778202056884766  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.8143459558486938
pseudo mini batch 0 input nodes size: 80788
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04401826858520508  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04401826858520508  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08308076858520508  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08325052261352539  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.044741153717041016  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04570150375366211  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04570150375366211  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

input nodes number: 80788
output nodes number: 22736
edges number: 128814
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.0269975662231445  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.026998519897461  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.047519683837890625  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

pseudo mini batch 1 input nodes size: 80644
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08319616317749023  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08336591720581055  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.044133663177490234  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04509115219116211  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04509115219116211  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

input nodes number: 80644
output nodes number: 22736
edges number: 128461
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.0210304260253906  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.0210309028625488  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.046904563903808594  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

pseudo mini batch 2 input nodes size: 80807
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.044133663177490234  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.044133663177490234  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08319616317749023  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08336591720581055  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.045697689056396484  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.045697689056396484  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

input nodes number: 80807
output nodes number: 22736
edges number: 128137
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.0207276344299316  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 1.0207281112670898  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04751014709472656  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

pseudo mini batch 3 input nodes size: 80268
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes
Using backend: pytorch

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08301687240600586  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.08318662643432617  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.04395437240600586  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.044909000396728516  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1904296875 GB
    Memory Allocated: 0.044909000396728516  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

input nodes number: 80268
output nodes number: 22733
edges number: 128002
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1923828125 GB
    Memory Allocated: 1.0174870491027832  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1923828125 GB
    Memory Allocated: 1.0174875259399414  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1923828125 GB
    Memory Allocated: 0.04671669006347656  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.1923828125 GB
    Memory Allocated: 0.04671669006347656  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.1923828125 GB
    Memory Allocated: 0.04671669006347656  GigaBytes
Max Memory Allocated: 1.1158742904663086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01857781410217285 |0.0010930895805358887 |0.032193899154663086 |0.0001558065414428711 |0.023961186408996582 |0.003282308578491211 |
----------------------------------------------------------pseudo_mini_loss sum 3.169323205947876
Total (block generation + training)time/epoch 1.105699896812439
Training time/epoch 0.3280308246612549
Training time without block to device /epoch 0.32365846633911133
Training time without total dataloading part /epoch 0.22852587699890137
load block tensor time/epoch 0.0743112564086914
block to device time/epoch 0.004372358322143555
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  322507
Number of first layer input nodes during this epoch:  322507
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
