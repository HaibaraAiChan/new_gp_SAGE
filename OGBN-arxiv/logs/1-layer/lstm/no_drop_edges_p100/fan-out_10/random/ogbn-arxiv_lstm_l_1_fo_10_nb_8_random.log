main start at this time 1651799434.5543375
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.015518426895141602
number of batches is  8
batch size is  11368
random selection method spend 0.00737762451171875
time for parepare:  0.021293163299560547
local_output_nid generation:  0.0036742687225341797
local_in_edges_tensor generation:  0.007103681564331055
mini_batch_src_global generation:  0.002373218536376953
r_  generation:  0.031488656997680664
local_output_nid generation:  0.0047969818115234375
local_in_edges_tensor generation:  0.003256082534790039
mini_batch_src_global generation:  0.0029256343841552734
r_  generation:  0.029964685440063477
local_output_nid generation:  0.005154132843017578
local_in_edges_tensor generation:  0.002299070358276367
mini_batch_src_global generation:  0.002134561538696289
r_  generation:  0.030620098114013672
local_output_nid generation:  0.005401611328125
local_in_edges_tensor generation:  0.002351045608520508
mini_batch_src_global generation:  0.001970529556274414
r_  generation:  0.030144214630126953
local_output_nid generation:  0.005202054977416992
local_in_edges_tensor generation:  0.002251148223876953
mini_batch_src_global generation:  0.001993894577026367
r_  generation:  0.03078484535217285
local_output_nid generation:  0.0052318572998046875
local_in_edges_tensor generation:  0.002446413040161133
mini_batch_src_global generation:  0.002023935317993164
r_  generation:  0.029924631118774414
local_output_nid generation:  0.005088329315185547
local_in_edges_tensor generation:  0.0022554397583007812
mini_batch_src_global generation:  0.002035379409790039
r_  generation:  0.031829833984375
local_output_nid generation:  0.005010843276977539
local_in_edges_tensor generation:  0.002267122268676758
mini_batch_src_global generation:  0.001992940902709961
r_  generation:  0.03189659118652344
----------------------check_connections_block total spend ----------------------------- 0.40850830078125
generate_one_block  0.041382789611816406
generate_one_block  0.0404207706451416
generate_one_block  0.04122638702392578
generate_one_block  0.04008936882019043
generate_one_block  0.042891502380371094
generate_one_block  0.03993701934814453
generate_one_block  0.040489912033081055
generate_one_block  0.04044532775878906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 50292
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8466796875 GB
    Memory Allocated: 0.024511337280273438  GigaBytes
Max Memory Allocated: 0.024511337280273438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8466796875 GB
    Memory Allocated: 0.024596214294433594  GigaBytes
Max Memory Allocated: 0.024596214294433594  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8466796875 GB
    Memory Allocated: 0.024596214294433594  GigaBytes
Max Memory Allocated: 0.024596214294433594  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8955078125 GB
    Memory Allocated: 0.025069236755371094  GigaBytes
Max Memory Allocated: 0.025069236755371094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8955078125 GB
    Memory Allocated: 0.025069236755371094  GigaBytes
Max Memory Allocated: 0.025069236755371094  GigaBytes

input nodes number: 50292
output nodes number: 11368
edges number: 63487
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5009765625 GB
    Memory Allocated: 0.5127034187316895  GigaBytes
Max Memory Allocated: 0.5515899658203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5009765625 GB
    Memory Allocated: 0.5127043724060059  GigaBytes
Max Memory Allocated: 0.5515899658203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5009765625 GB
    Memory Allocated: 0.02826976776123047  GigaBytes
Max Memory Allocated: 0.5515899658203125  GigaBytes

pseudo mini batch 1 input nodes size: 50556
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5009765625 GB
    Memory Allocated: 0.026821613311767578  GigaBytes
Max Memory Allocated: 0.5515899658203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5009765625 GB
    Memory Allocated: 0.026821613311767578  GigaBytes
Max Memory Allocated: 0.5515899658203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5009765625 GB
    Memory Allocated: 0.050928592681884766  GigaBytes
Max Memory Allocated: 0.5515899658203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5009765625 GB
    Memory Allocated: 0.05101346969604492  GigaBytes
Max Memory Allocated: 0.5515899658203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5009765625 GB
    Memory Allocated: 0.026947498321533203  GigaBytes
Max Memory Allocated: 0.5515899658203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5009765625 GB
    Memory Allocated: 0.027428150177001953  GigaBytes
Max Memory Allocated: 0.5515899658203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5009765625 GB
    Memory Allocated: 0.027428150177001953  GigaBytes
Max Memory Allocated: 0.5515899658203125  GigaBytes

input nodes number: 50556
output nodes number: 11368
edges number: 64444
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.5181527137756348  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.518153190612793  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.028412818908691406  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

pseudo mini batch 2 input nodes size: 50869
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.026947498321533203  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.026947498321533203  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.05120372772216797  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.051288604736328125  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.02709674835205078  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.027579307556152344  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.027579307556152344  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

input nodes number: 50869
output nodes number: 11368
edges number: 64642
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.5178990364074707  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.5178995132446289  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.028568267822265625  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

pseudo mini batch 3 input nodes size: 50734
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.02709674835205078  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.02709674835205078  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.051288604736328125  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.05137348175048828  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.02703237533569336  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.02751016616821289  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.02751016616821289  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

input nodes number: 50734
output nodes number: 11368
edges number: 64006
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.5142297744750977  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.5142302513122559  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.028493404388427734  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

pseudo mini batch 4 input nodes size: 50798
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.02703237533569336  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.02703237533569336  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.0512547492980957  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.05133962631225586  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.02706289291381836  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.027546405792236328  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.027546405792236328  GigaBytes
Max Memory Allocated: 0.5592904090881348  GigaBytes

input nodes number: 50798
output nodes number: 11368
edges number: 64846
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.5261468887329102  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.5261473655700684  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.028535842895507812  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

pseudo mini batch 5 input nodes size: 50509
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.02706289291381836  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.02706289291381836  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.0511474609375  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.051232337951660156  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.026925086975097656  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.027399063110351562  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.027399063110351562  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

input nodes number: 50509
output nodes number: 11368
edges number: 63583
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5143246650695801  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5143251419067383  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028377056121826172  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

pseudo mini batch 6 input nodes size: 50558
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.026925086975097656  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.026925086975097656  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05103302001953125  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.051117897033691406  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02694845199584961  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027428150177001953  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027428150177001953  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

input nodes number: 50558
output nodes number: 11368
edges number: 64277
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5160608291625977  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5160613059997559  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028411865234375  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

pseudo mini batch 7 input nodes size: 50635
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02694845199584961  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02694845199584961  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.051093101501464844  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.051177978515625  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02698516845703125  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027463912963867188  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027463912963867188  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

input nodes number: 50635
output nodes number: 11365
edges number: 64129
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5135879516601562  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5135884284973145  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02844715118408203  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02950763702392578  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02950763702392578  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01648581027984619 |0.05013146996498108 |0.08284509181976318 |0.0001614391803741455 |0.023974448442459106 |0.004182338714599609 |
----------------------------------------------------------pseudo_mini_loss sum 3.8380470275878906
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  404951
Number of first layer input nodes during this epoch:  404951
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029507160186767578  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017900943756103516
number of batches is  8
batch size is  11368
random selection method spend 0.010784626007080078
time for parepare:  0.034490108489990234
local_output_nid generation:  0.006154537200927734
local_in_edges_tensor generation:  0.006735801696777344
mini_batch_src_global generation:  0.0033075809478759766
r_  generation:  0.033040761947631836
local_output_nid generation:  0.006387948989868164
local_in_edges_tensor generation:  0.0030829906463623047
mini_batch_src_global generation:  0.0032210350036621094
r_  generation:  0.030672073364257812
local_output_nid generation:  0.0057103633880615234
local_in_edges_tensor generation:  0.0023987293243408203
mini_batch_src_global generation:  0.002222299575805664
r_  generation:  0.03161931037902832
local_output_nid generation:  0.005642414093017578
local_in_edges_tensor generation:  0.002572774887084961
mini_batch_src_global generation:  0.002289295196533203
r_  generation:  0.03234267234802246
local_output_nid generation:  0.00545501708984375
local_in_edges_tensor generation:  0.002986431121826172
mini_batch_src_global generation:  0.002222299575805664
r_  generation:  0.030364274978637695
local_output_nid generation:  0.005265235900878906
local_in_edges_tensor generation:  0.003547191619873047
mini_batch_src_global generation:  0.0023272037506103516
r_  generation:  0.030633926391601562
local_output_nid generation:  0.0054204463958740234
local_in_edges_tensor generation:  0.0025441646575927734
mini_batch_src_global generation:  0.002287626266479492
r_  generation:  0.030832767486572266
local_output_nid generation:  0.0052754878997802734
local_in_edges_tensor generation:  0.0024552345275878906
mini_batch_src_global generation:  0.0023047924041748047
r_  generation:  0.03387594223022461
----------------------check_connections_block total spend ----------------------------- 0.44287896156311035
generate_one_block  0.0447697639465332
generate_one_block  0.042716264724731445
generate_one_block  0.04156851768493652
generate_one_block  0.041724443435668945
generate_one_block  0.04355263710021973
generate_one_block  0.045590877532958984
generate_one_block  0.04157376289367676
generate_one_block  0.04508829116821289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029507160186767578  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.8531579971313477
pseudo mini batch 0 input nodes size: 50413
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02804422378540039  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02804422378540039  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05208301544189453  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05216789245605469  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027938365936279297  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028417110443115234  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028417110443115234  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

input nodes number: 50413
output nodes number: 11368
edges number: 64219
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5164065361022949  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5164074897766113  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029400348663330078  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

pseudo mini batch 1 input nodes size: 50520
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027939796447753906  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027939796447753906  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05202960968017578  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05211448669433594  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02799081802368164  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028469562530517578  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028469562530517578  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

input nodes number: 50520
output nodes number: 11368
edges number: 64162
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5161576271057129  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5161581039428711  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02945232391357422  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

pseudo mini batch 2 input nodes size: 50669
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02799081802368164  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02799081802368164  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05215167999267578  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05223655700683594  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028061866760253906  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028542518615722656  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028542518615722656  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

input nodes number: 50669
output nodes number: 11368
edges number: 64475
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5188989639282227  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5188994407653809  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029528141021728516  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

pseudo mini batch 3 input nodes size: 50719
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028061866760253906  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028061866760253906  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.0522465705871582  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05233144760131836  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028085708618164062  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028570175170898438  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028570175170898438  GigaBytes
Max Memory Allocated: 0.568476676940918  GigaBytes

input nodes number: 50719
output nodes number: 11368
edges number: 64995
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.530055046081543  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5300555229187012  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029560089111328125  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

pseudo mini batch 4 input nodes size: 50668
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028085708618164062  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028085708618164062  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05224609375  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.052330970764160156  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028061389923095703  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028537273406982422  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028537273406982422  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

input nodes number: 50668
output nodes number: 11368
edges number: 63819
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.512092113494873  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5120925903320312  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02951812744140625  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

pseudo mini batch 5 input nodes size: 50704
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028061389923095703  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028061389923095703  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05223894119262695  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05232381820678711  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028078556060791016  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02855539321899414  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02855539321899414  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

input nodes number: 50704
output nodes number: 11368
edges number: 63916
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5155301094055176  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5155305862426758  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.03040933609008789  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

pseudo mini batch 6 input nodes size: 50435
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028950214385986328  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028950214385986328  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05299949645996094  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.053084373474121094  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028821945190429688  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029297828674316406  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029297828674316406  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

input nodes number: 50435
output nodes number: 11368
edges number: 63831
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5122809410095215  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5122814178466797  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029405593872070312  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

pseudo mini batch 7 input nodes size: 50605
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027950286865234375  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027950286865234375  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.052080631256103516  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05216550827026367  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028031349182128906  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02850818634033203  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02850818634033203  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

input nodes number: 50605
output nodes number: 11365
edges number: 63997
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5144143104553223  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5144147872924805  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02948904037475586  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02948904037475586  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02948904037475586  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008411645889282227 |0.0006048083305358887 |0.01934787631034851 |0.00011155009269714355 |0.021535813808441162 |0.0016558170318603516 |
----------------------------------------------------------pseudo_mini_loss sum 3.268394708633423
Total (block generation + training)time/epoch 1.2837233543395996
Training time/epoch 0.4303622245788574
Training time without block to device /epoch 0.4255237579345703
Training time without total dataloading part /epoch 0.3296177387237549
load block tensor time/epoch 0.06729316711425781
block to device time/epoch 0.004838466644287109
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  404733
Number of first layer input nodes during this epoch:  404733
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029488563537597656  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018756389617919922
number of batches is  8
batch size is  11368
random selection method spend 0.006819486618041992
time for parepare:  0.023331642150878906
local_output_nid generation:  0.003763437271118164
local_in_edges_tensor generation:  0.008697032928466797
mini_batch_src_global generation:  0.0027513504028320312
r_  generation:  0.030452728271484375
local_output_nid generation:  0.006279706954956055
local_in_edges_tensor generation:  0.0027883052825927734
mini_batch_src_global generation:  0.003202676773071289
r_  generation:  0.031360626220703125
local_output_nid generation:  0.005830526351928711
local_in_edges_tensor generation:  0.003453969955444336
mini_batch_src_global generation:  0.002222299575805664
r_  generation:  0.031438350677490234
local_output_nid generation:  0.004852294921875
local_in_edges_tensor generation:  0.0030074119567871094
mini_batch_src_global generation:  0.002176046371459961
r_  generation:  0.03013896942138672
local_output_nid generation:  0.005231618881225586
local_in_edges_tensor generation:  0.0025730133056640625
mini_batch_src_global generation:  0.0022475719451904297
r_  generation:  0.030437946319580078
local_output_nid generation:  0.004934787750244141
local_in_edges_tensor generation:  0.003604888916015625
mini_batch_src_global generation:  0.0024678707122802734
r_  generation:  0.030025482177734375
local_output_nid generation:  0.004716634750366211
local_in_edges_tensor generation:  0.003041982650756836
mini_batch_src_global generation:  0.0022466182708740234
r_  generation:  0.0326385498046875
local_output_nid generation:  0.005070924758911133
local_in_edges_tensor generation:  0.002907276153564453
mini_batch_src_global generation:  0.0024666786193847656
r_  generation:  0.030121564865112305
----------------------check_connections_block total spend ----------------------------- 0.42084169387817383
generate_one_block  0.04499673843383789
generate_one_block  0.04034113883972168
generate_one_block  0.0400998592376709
generate_one_block  0.03971266746520996
generate_one_block  0.04101085662841797
generate_one_block  0.039780616760253906
generate_one_block  0.03989768028259277
generate_one_block  0.0403437614440918
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029488563537597656  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.8269153833389282
pseudo mini batch 0 input nodes size: 50756
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028029918670654297  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028029918670654297  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05223226547241211  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.052317142486572266  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02810192108154297  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028581619262695312  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028581619262695312  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

input nodes number: 50756
output nodes number: 11368
edges number: 64383
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5179524421691895  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5179533958435059  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02956867218017578  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

pseudo mini batch 1 input nodes size: 50970
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028103351593017578  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028103351593017578  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05240774154663086  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.052492618560791016  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028205394744873047  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028686046600341797  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028686046600341797  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

input nodes number: 50970
output nodes number: 11368
edges number: 64431
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5189385414123535  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5189390182495117  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029674053192138672  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

pseudo mini batch 2 input nodes size: 50614
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028205394744873047  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028205394744873047  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.052340030670166016  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05242490768432617  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028035640716552734  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028514385223388672  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028514385223388672  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

input nodes number: 50614
output nodes number: 11368
edges number: 64163
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5140566825866699  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5140571594238281  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029497623443603516  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

pseudo mini batch 3 input nodes size: 50677
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028035640716552734  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028035640716552734  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.0522003173828125  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.052285194396972656  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02806568145751953  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028545379638671875  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028545379638671875  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

input nodes number: 50677
output nodes number: 11368
edges number: 64298
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5186915397644043  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5186920166015625  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029530048370361328  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

pseudo mini batch 4 input nodes size: 50691
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02806568145751953  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02806568145751953  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05223703384399414  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.0523219108581543  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028072357177734375  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028554916381835938  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028554916381835938  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

input nodes number: 50691
output nodes number: 11368
edges number: 64744
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.521885871887207  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5218863487243652  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029542922973632812  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

pseudo mini batch 5 input nodes size: 50734
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028072357177734375  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028072357177734375  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05226421356201172  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.052349090576171875  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02809286117553711  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02856588363647461  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02856588363647461  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

input nodes number: 50734
output nodes number: 11368
edges number: 63393
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5131163597106934  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5131168365478516  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.030438899993896484  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

pseudo mini batch 6 input nodes size: 50442
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028987407684326172  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028987407684326172  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.0530400276184082  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05312490463256836  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02884817123413086  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029329776763916016  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029329776763916016  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

input nodes number: 50442
output nodes number: 11368
edges number: 64602
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5210738182067871  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5210742950439453  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02942037582397461  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

pseudo mini batch 7 input nodes size: 50201
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027953624725341797  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027953624725341797  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.051891326904296875  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05197620391845703  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027838706970214844  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028311729431152344  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028311729431152344  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

input nodes number: 50201
output nodes number: 11365
edges number: 63400
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5129022598266602  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5129027366638184  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029285907745361328  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029285907745361328  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.029285907745361328  GigaBytes
Max Memory Allocated: 0.5733280181884766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009152084589004517 |0.0006549060344696045 |0.018224716186523438 |0.00010392069816589355 |0.02241760492324829 |0.0016026496887207031 |
----------------------------------------------------------pseudo_mini_loss sum 3.169322967529297
Total (block generation + training)time/epoch 1.2595452070236206
Training time/epoch 0.4345662593841553
Training time without block to device /epoch 0.42932701110839844
Training time without total dataloading part /epoch 0.3275725841522217
load block tensor time/epoch 0.07321667671203613
block to device time/epoch 0.005239248275756836
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  405085
Number of first layer input nodes during this epoch:  405085
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])Using backend: pytorch

layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
