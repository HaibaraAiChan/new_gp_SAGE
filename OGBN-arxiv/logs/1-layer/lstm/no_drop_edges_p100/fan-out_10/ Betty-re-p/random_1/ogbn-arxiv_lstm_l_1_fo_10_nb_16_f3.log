[21:32:14] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14089438 edges into 16 parts and get 2500723 edge cuts
main start at this time 1651872719.4993076
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.015574216842651367
global_2_local spend time (sec) 0.041522979736328125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0033292770385742188
A = g.adjacency_matrix() spent  0.005725383758544922
auxiliary_graph
Graph(num_nodes=145031, num_edges=14180379,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09519076347351074
remove nodes length
54090
auxiliary_graph.remove_nodes spent  0.6971447467803955
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14180379,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6474325656890869

the counter of shared neighbor distribution
Counter({1.0: 12728892, 2.0: 1148578, 3.0: 165860, 4.0: 33436, 5.0: 8994, 6.0: 2692, 7.0: 738, 8.0: 218, 9.0: 28, 10.0: 2})
14089438
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14089435, 14089436, 14089437])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12728892, 2.0: 1148578, 3.0: 165860, 4.0: 33436, 5.0: 8994, 6.0: 2692, 7.0: 738, 8.0: 218, 9.0: 28, 10.0: 2})
Convert a graph into a bidirected graph: 1.052 seconds
Metis partitioning: 3.503 seconds
Split the graph: 0.716 seconds
Construct subgraphs: 0.049 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.330921411514282
5548
5517
5811
5776
5520
5583
5840
5517
5517
5615
5518
5854
5853
5768
5853
5851
total k batches seeds list generation spend  11.306346654891968
after graph partition
graph partition algorithm spend time 11.372054815292358
5548
5517
5811
5776
5520
5583
5840
5517
5517
5615
5518
5854
5853
5768
5853
5851
partition_len_list
[14550, 16688, 12698, 11594, 19413, 20938, 20050, 20774, 9836, 9556, 10634, 11709, 13572, 12508, 11671, 10317]
shared_neighbor_graph_partition_s0 selection method  spend 11.465407133102417
time for parepare:  0.017550230026245117
local_output_nid generation:  0.0008480548858642578
local_in_edges_tensor generation:  0.0012214183807373047
mini_batch_src_global generation:  0.0013473033905029297
r_  generation:  0.011669158935546875
local_output_nid generation:  0.0011110305786132812
local_in_edges_tensor generation:  0.001096487045288086
mini_batch_src_global generation:  0.0014541149139404297
r_  generation:  0.011791467666625977
local_output_nid generation:  0.0011777877807617188
local_in_edges_tensor generation:  0.0010631084442138672
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.013141393661499023
local_output_nid generation:  0.0011570453643798828
local_in_edges_tensor generation:  0.0010495185852050781
mini_batch_src_global generation:  0.001007080078125
r_  generation:  0.011704206466674805
local_output_nid generation:  0.0010695457458496094
local_in_edges_tensor generation:  0.0010101795196533203
mini_batch_src_global generation:  0.0011439323425292969
r_  generation:  0.013036966323852539
local_output_nid generation:  0.0010709762573242188
local_in_edges_tensor generation:  0.00104522705078125
mini_batch_src_global generation:  0.001528024673461914
r_  generation:  0.014970541000366211
local_output_nid generation:  0.0011739730834960938
local_in_edges_tensor generation:  0.0010776519775390625
mini_batch_src_global generation:  0.0015878677368164062
r_  generation:  0.0171201229095459
local_output_nid generation:  0.0011157989501953125
local_in_edges_tensor generation:  0.0010199546813964844
mini_batch_src_global generation:  0.0013840198516845703
r_  generation:  0.01449441909790039
local_output_nid generation:  0.001117706298828125
local_in_edges_tensor generation:  0.0010116100311279297
mini_batch_src_global generation:  0.0012500286102294922
r_  generation:  0.014336109161376953
local_output_nid generation:  0.0011174678802490234
local_in_edges_tensor generation:  0.0010175704956054688
mini_batch_src_global generation:  0.001291036605834961
r_  generation:  0.013473272323608398
local_output_nid generation:  0.0012023448944091797
local_in_edges_tensor generation:  0.0010182857513427734
mini_batch_src_global generation:  0.0011944770812988281
r_  generation:  0.01410365104675293
local_output_nid generation:  0.001203775405883789
local_in_edges_tensor generation:  0.0010461807250976562
mini_batch_src_global generation:  0.0011718273162841797
r_  generation:  0.01424551010131836
local_output_nid generation:  0.0013175010681152344
local_in_edges_tensor generation:  0.0010974407196044922
mini_batch_src_global generation:  0.0012497901916503906
r_  generation:  0.01483011245727539
local_output_nid generation:  0.001190185546875
local_in_edges_tensor generation:  0.0010344982147216797
mini_batch_src_global generation:  0.0011806488037109375
r_  generation:  0.014423847198486328
local_output_nid generation:  0.0011491775512695312
local_in_edges_tensor generation:  0.0010340213775634766
mini_batch_src_global generation:  0.001291036605834961
r_  generation:  0.013898611068725586
local_output_nid generation:  0.0011453628540039062
local_in_edges_tensor generation:  0.0010466575622558594
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.012963294982910156
----------------------check_connections_block total spend ----------------------------- 0.34932494163513184
generate_one_block  0.017733097076416016
generate_one_block  0.017711877822875977
generate_one_block  0.016533374786376953
generate_one_block  0.015736818313598633
generate_one_block  0.022913694381713867
generate_one_block  0.02321457862854004
generate_one_block  0.025327205657958984
generate_one_block  0.022803068161010742
generate_one_block  0.018463850021362305
generate_one_block  0.017372608184814453
generate_one_block  0.017348289489746094
generate_one_block  0.01871776580810547
generate_one_block  0.019396305084228516
generate_one_block  0.019156217575073242
generate_one_block  0.017539024353027344
generate_one_block  0.016999244689941406
global_2_local spend time (sec) 0.0044214725494384766
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0006964206695556641
A = g.adjacency_matrix() spent  0.0006594657897949219
auxiliary_graph
Graph(num_nodes=20938, num_edges=1453283,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.013446569442749023
remove nodes length
15355
auxiliary_graph.remove_nodes spent  0.03957939147949219
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5583, num_edges=1453283,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.04740643501281738

the counter of shared neighbor distribution
Counter({1.0: 1373862, 2.0: 67552, 3.0: 5148, 4.0: 778, 5.0: 230, 6.0: 102, 7.0: 20, 8.0: 6, 9.0: 2})[21:32:16] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5583 nodes and 1447700 edges into 2 parts and get 111732 edge cuts

1447700
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.048 seconds
Metis partitioning: 0.115 seconds
Split the graph: 0.206 seconds
Construct subgraphs: 0.024 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.3956789970397949
2827
2756
total k batches seeds list generation spend  0.7735042572021484
after graph partition
graph partition algorithm spend time 0.8073368072509766
2827
2756
time for parepare:  0.028914213180541992
local_output_nid generation:  0.0005958080291748047
local_in_edges_tensor generation:  0.0010993480682373047
mini_batch_src_global generation:  0.0014238357543945312
r_  generation:  0.012318849563598633
local_output_nid generation:  0.0005981922149658203
local_in_edges_tensor generation:  0.0009336471557617188
mini_batch_src_global generation:  0.0011844635009765625
r_  generation:  0.009074211120605469
----------------------check_connections_block total spend ----------------------------- 0.06523728370666504
generate_one_block  0.01944875717163086
generate_one_block  0.011870861053466797
----------===============-------------===============-------------the number of batches ***** 17

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 14550
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.007468223571777344  GigaBytes
Max Memory Allocated: 0.007468223571777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.007509708404541016  GigaBytes
Max Memory Allocated: 0.007509708404541016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.007509708404541016  GigaBytes
Max Memory Allocated: 0.007509708404541016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.007725238800048828  GigaBytes
Max Memory Allocated: 0.007725238800048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.007725238800048828  GigaBytes
Max Memory Allocated: 0.007725238800048828  GigaBytes

input nodes number: 14550
output nodes number: 5548
edges number: 28842
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1943359375 GB
    Memory Allocated: 0.23020219802856445  GigaBytes
Max Memory Allocated: 0.24762344360351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1943359375 GB
    Memory Allocated: 0.23020315170288086  GigaBytes
Max Memory Allocated: 0.24762344360351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1962890625 GB
    Memory Allocated: 0.009469985961914062  GigaBytes
Max Memory Allocated: 0.24762344360351562  GigaBytes

pseudo mini batch 1 input nodes size: 16688
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1962890625 GB
    Memory Allocated: 0.008867740631103516  GigaBytes
Max Memory Allocated: 0.24762344360351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1962890625 GB
    Memory Allocated: 0.008867740631103516  GigaBytes
Max Memory Allocated: 0.24762344360351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1962890625 GB
    Memory Allocated: 0.016825199127197266  GigaBytes
Max Memory Allocated: 0.24762344360351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1962890625 GB
    Memory Allocated: 0.016866683959960938  GigaBytes
Max Memory Allocated: 0.24762344360351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1962890625 GB
    Memory Allocated: 0.009887218475341797  GigaBytes
Max Memory Allocated: 0.24762344360351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1962890625 GB
    Memory Allocated: 0.010105609893798828  GigaBytes
Max Memory Allocated: 0.24762344360351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1962890625 GB
    Memory Allocated: 0.010105609893798828  GigaBytes
Max Memory Allocated: 0.24762344360351562  GigaBytes

input nodes number: 16688
output nodes number: 5517
edges number: 29226
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.23297595977783203  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.23297643661499023  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.010506629943847656  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

pseudo mini batch 2 input nodes size: 12698
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.009882926940917969  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.009882926940917969  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.016820907592773438  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.016864299774169922  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.0088653564453125  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.0090789794921875  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.0090789794921875  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

input nodes number: 12698
output nodes number: 5811
edges number: 28672
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.22776365280151367  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.22776412963867188  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.009496212005615234  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

pseudo mini batch 3 input nodes size: 11594
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.008908748626708984  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.008908748626708984  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.014437198638916016  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.0144805908203125  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.007499217987060547  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.007702350616455078  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.007702350616455078  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

input nodes number: 11594
output nodes number: 5776
edges number: 27179
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.21606779098510742  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.21606826782226562  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.008052349090576172  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

pseudo mini batch 4 input nodes size: 19413
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.0074939727783203125  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.0074939727783203125  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.016750812530517578  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.01679229736328125  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.011220455169677734  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.01144552230834961  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.01144552230834961  GigaBytes
Max Memory Allocated: 0.25167369842529297  GigaBytes

input nodes number: 19413
output nodes number: 5520
edges number: 30189
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.24013185501098633  GigaBytes
Max Memory Allocated: 0.259401798248291  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.24013233184814453  GigaBytes
Max Memory Allocated: 0.259401798248291  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.011839866638183594  GigaBytes
Max Memory Allocated: 0.259401798248291  GigaBytes

pseudo mini batch 5 input nodes size: 20050
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.011182308197021484  GigaBytes
Max Memory Allocated: 0.259401798248291  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.011182308197021484  GigaBytes
Max Memory Allocated: 0.259401798248291  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.02074289321899414  GigaBytes
Max Memory Allocated: 0.259401798248291  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.020786762237548828  GigaBytes
Max Memory Allocated: 0.259401798248291  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.01148843765258789  GigaBytes
Max Memory Allocated: 0.259401798248291  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.011806964874267578  GigaBytes
Max Memory Allocated: 0.259401798248291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2158203125 GB
    Memory Allocated: 0.011806964874267578  GigaBytes
Max Memory Allocated: 0.259401798248291  GigaBytes

input nodes number: 20050
output nodes number: 5840
edges number: 42683
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.3305635452270508  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.330564022064209  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.01238870620727539  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 6 input nodes size: 20774
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.011536121368408203  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.011536121368408203  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.021506786346435547  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.02154827117919922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.011943817138671875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.012205123901367188  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.012205123901367188  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 20774
output nodes number: 5517
edges number: 35018
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.2790651321411133  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.2790656089782715  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.012636184692382812  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 7 input nodes size: 9836
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.011896133422851562  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.011896133422851562  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.0165863037109375  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.016627788543701172  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.006615638732910156  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.0068645477294921875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3505859375 GB
    Memory Allocated: 0.0068645477294921875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 9836
output nodes number: 5517
edges number: 33371
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.2583160400390625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.2583165168762207  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.007249355316162109  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 8 input nodes size: 9556
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.006615638732910156  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.006615638732910156  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.011172294616699219  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.011214256286621094  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.006482601165771484  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.006715297698974609  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.006715297698974609  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 9556
output nodes number: 5615
edges number: 31153
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.24251651763916016  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.24251699447631836  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.007096767425537109  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 9 input nodes size: 10634
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.006496906280517578  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.006496906280517578  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.01156759262084961  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.011609077453613281  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.007010459899902344  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.0072479248046875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.0072479248046875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 10634
output nodes number: 5518
edges number: 31766
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.24831485748291016  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.24831533432006836  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.007613182067871094  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 10 input nodes size: 11709
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.00699615478515625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.00699615478515625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.01257944107055664  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.012623310089111328  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.007511138916015625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.007747650146484375  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.007747650146484375  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 11709
output nodes number: 5854
edges number: 31622
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.24659252166748047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.24659299850463867  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.008187294006347656  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 11 input nodes size: 13572
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.007561206817626953  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.007561206817626953  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.014032840728759766  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.014076709747314453  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.008449554443359375  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.008703231811523438  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3583984375 GB
    Memory Allocated: 0.008703231811523438  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 13572
output nodes number: 5853
edges number: 33949
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.26479530334472656  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.26479578018188477  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.009124279022216797  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 12 input nodes size: 12508
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.008449554443359375  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.008449554443359375  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.014413833618164062  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.014457225799560547  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007941722869873047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.008189678192138672  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.008189678192138672  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 12508
output nodes number: 5768
edges number: 33155
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2596621513366699  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2596626281738281  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.008583545684814453  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 13 input nodes size: 11671
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007928848266601562  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007928848266601562  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.013494014739990234  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.013537883758544922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.00753021240234375  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007755279541015625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007755279541015625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 11671
output nodes number: 5853
edges number: 30149
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.23786401748657227  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.23786449432373047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.008146286010742188  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 14 input nodes size: 10317
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007543087005615234  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007543087005615234  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.012462615966796875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.012506484985351562  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.006897449493408203  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007122516632080078  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007122516632080078  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 10317
output nodes number: 5851
edges number: 30114
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2384495735168457  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2384500503540039  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.0074901580810546875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 15 input nodes size: 12840
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.00689697265625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.00689697265625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.013019561767578125  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.013041019439697266  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.008077621459960938  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.008233070373535156  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.008233070373535156  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 12840
output nodes number: 2827
edges number: 20799
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.163970947265625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.1639714241027832  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.008066177368164062  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 16 input nodes size: 9907
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007627010345458984  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007627010345458984  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.012351036071777344  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.012372016906738281  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.006227970123291016  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.006344318389892578  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.006344318389892578  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 9907
output nodes number: 2756
edges number: 15527
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.12365865707397461  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.12365913391113281  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.0065555572509765625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.0076160430908203125  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.0076160430908203125  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008510659722720875 |0.02401155583998736 |0.055748701095581055 |0.00016752411337459788 |0.02492998628055348 |0.004861116409301758 |
----------------------------------------------------------pseudo_mini_loss sum 3.837966203689575
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  228317
Number of first layer input nodes during this epoch:  228317
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007615566253662109  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032575130462646484
number of batches is  17
batch size is  5350
random selection method spend 0.011425018310546875
time for parepare:  0.029006004333496094
local_output_nid generation:  0.0023720264434814453
local_in_edges_tensor generation:  0.014926671981811523
mini_batch_src_global generation:  0.002150297164916992
r_  generation:  0.012803077697753906
local_output_nid generation:  0.003031015396118164
local_in_edges_tensor generation:  0.001499176025390625
mini_batch_src_global generation:  0.0015439987182617188
r_  generation:  0.01336216926574707
local_output_nid generation:  0.002690553665161133
local_in_edges_tensor generation:  0.0010554790496826172
mini_batch_src_global generation:  0.0010564327239990234
r_  generation:  0.012782096862792969
local_output_nid generation:  0.002566814422607422
local_in_edges_tensor generation:  0.0012698173522949219
mini_batch_src_global generation:  0.0010247230529785156
r_  generation:  0.012563228607177734
local_output_nid generation:  0.0024366378784179688
local_in_edges_tensor generation:  0.001050710678100586
mini_batch_src_global generation:  0.0010890960693359375
r_  generation:  0.013681888580322266
local_output_nid generation:  0.0023682117462158203
local_in_edges_tensor generation:  0.0010535717010498047
mini_batch_src_global generation:  0.0009937286376953125
r_  generation:  0.012732982635498047
local_output_nid generation:  0.0023119449615478516
local_in_edges_tensor generation:  0.0010554790496826172
mini_batch_src_global generation:  0.00101470947265625
r_  generation:  0.013051748275756836
local_output_nid generation:  0.0023162364959716797
local_in_edges_tensor generation:  0.0010704994201660156
mini_batch_src_global generation:  0.0010006427764892578
r_  generation:  0.013395547866821289
local_output_nid generation:  0.002297639846801758
local_in_edges_tensor generation:  0.0010650157928466797
mini_batch_src_global generation:  0.001009225845336914
r_  generation:  0.013103961944580078
local_output_nid generation:  0.0022461414337158203
local_in_edges_tensor generation:  0.0010833740234375
mini_batch_src_global generation:  0.0010192394256591797
r_  generation:  0.013408184051513672
local_output_nid generation:  0.002281665802001953
local_in_edges_tensor generation:  0.001062154769897461
mini_batch_src_global generation:  0.0010190010070800781
r_  generation:  0.013753652572631836
local_output_nid generation:  0.0023398399353027344
local_in_edges_tensor generation:  0.0011281967163085938
mini_batch_src_global generation:  0.0010495185852050781
r_  generation:  0.01370096206665039
local_output_nid generation:  0.002269744873046875
local_in_edges_tensor generation:  0.0010793209075927734
mini_batch_src_global generation:  0.0011301040649414062
r_  generation:  0.013306379318237305
local_output_nid generation:  0.0022437572479248047
local_in_edges_tensor generation:  0.0010612010955810547
mini_batch_src_global generation:  0.0010221004486083984
r_  generation:  0.013202667236328125
local_output_nid generation:  0.0022280216217041016
local_in_edges_tensor generation:  0.0010581016540527344
mini_batch_src_global generation:  0.0010192394256591797
r_  generation:  0.013185262680053711
local_output_nid generation:  0.002232789993286133
local_in_edges_tensor generation:  0.0010647773742675781
mini_batch_src_global generation:  0.0010402202606201172
r_  generation:  0.01402425765991211
local_output_nid generation:  0.0022058486938476562
local_in_edges_tensor generation:  0.0010826587677001953
mini_batch_src_global generation:  0.0010192394256591797
r_  generation:  0.013901710510253906
----------------------check_connections_block total spend ----------------------------- 0.4067261219024658
generate_one_block  0.02470541000366211
generate_one_block  0.020511627197265625
generate_one_block  0.019477128982543945
generate_one_block  0.019160032272338867
generate_one_block  0.019347190856933594
generate_one_block  0.019321918487548828
generate_one_block  0.01934361457824707
generate_one_block  0.019622087478637695
generate_one_block  0.019483566284179688
generate_one_block  0.01947927474975586
generate_one_block  0.01930546760559082
generate_one_block  0.019663572311401367
generate_one_block  0.019608259201049805
generate_one_block  0.019554853439331055
generate_one_block  0.019464969635009766
generate_one_block  0.02170252799987793
generate_one_block  0.01930832862854004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007615566253662109  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.8412492275238037
pseudo mini batch 0 input nodes size: 28332
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007277011871337891  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.007277011871337891  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.020786762237548828  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02082681655883789  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016081809997558594  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016312599182128906  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016312599182128906  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28332
output nodes number: 5350
edges number: 30866
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.25095510482788086  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.25095605850219727  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017201900482177734  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 1 input nodes size: 28083
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01646900177001953  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01646900177001953  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02986001968383789  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029900074005126953  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016350269317626953  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016578197479248047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016578197479248047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28083
output nodes number: 5350
edges number: 30482
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24769353866577148  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2476940155029297  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017075538635253906  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 2 input nodes size: 28005
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016350269317626953  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016350269317626953  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02970409393310547  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02974414825439453  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01631307601928711  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016541004180908203  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016541004180908203  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28005
output nodes number: 5350
edges number: 30480
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24996471405029297  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24996519088745117  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01703786849975586  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 3 input nodes size: 27807
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01631307601928711  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01631307601928711  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029572486877441406  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02961254119873047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01621866226196289  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016441822052001953  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016441822052001953  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27807
output nodes number: 5350
edges number: 29891
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2431931495666504  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2431936264038086  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01693248748779297  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 4 input nodes size: 27895
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01621866226196289  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01621866226196289  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029520034790039062  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029560089111328125  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016260623931884766  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016484737396240234  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016484737396240234  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27895
output nodes number: 5350
edges number: 30060
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24743270874023438  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24743318557739258  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01697683334350586  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 5 input nodes size: 27657
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016260623931884766  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016260623931884766  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029448509216308594  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029488563537597656  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016147136688232422  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016369342803955078  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016369342803955078  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27657
output nodes number: 5350
edges number: 29779
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2423243522644043  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2423248291015625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01685810089111328  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 6 input nodes size: 27947
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016147136688232422  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016147136688232422  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029473304748535156  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02951335906982422  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016285419464111328  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016510486602783203  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016510486602783203  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27947
output nodes number: 5350
edges number: 30152
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2449784278869629  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2449789047241211  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017004013061523438  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 7 input nodes size: 27974
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016285419464111328  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016285419464111328  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029624462127685547  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02966451644897461  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016298294067382812  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016523361206054688  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016523361206054688  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27974
output nodes number: 5350
edges number: 30185
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2456369400024414  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2456374168395996  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017017364501953125  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 8 input nodes size: 28107
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016298294067382812  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016298294067382812  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029700756072998047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02974081039428711  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016361713409423828  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016588687896728516  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016588687896728516  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28107
output nodes number: 5350
edges number: 30396
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2483234405517578  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24832391738891602  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017085552215576172  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 9 input nodes size: 28009
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016361713409423828  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016361713409423828  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029717445373535156  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02975749969482422  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016314983367919922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016541004180908203  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016541004180908203  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28009
output nodes number: 5350
edges number: 30320
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24768447875976562  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24768495559692383  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017035961151123047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 10 input nodes size: 27950
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016314983367919922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016314983367919922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029642581939697266  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029682636260986328  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016286849975585938  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016510963439941406  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016510963439941406  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27950
output nodes number: 5350
edges number: 30066
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24459409713745117  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24459457397460938  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017003536224365234  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 11 input nodes size: 27925
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016286849975585938  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016286849975585938  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029602527618408203  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029642581939697266  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01627492904663086  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01650094985961914  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01650094985961914  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27925
output nodes number: 5350
edges number: 30259
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.25048160552978516  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.25048208236694336  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01699542999267578  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 12 input nodes size: 28088
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01627492904663086  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01627492904663086  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029668331146240234  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029708385467529297  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01635265350341797  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016579627990722656  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016579627990722656  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28088
output nodes number: 5350
edges number: 30457
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.25060510635375977  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.25060558319091797  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01707601547241211  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 13 input nodes size: 27837
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01635265350341797  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01635265350341797  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02962636947631836  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029666423797607422  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016232967376708984  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016457080841064453  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016457080841064453  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27837
output nodes number: 5350
edges number: 30030
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24421453475952148  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2442150115966797  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016948699951171875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 14 input nodes size: 27752
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016232967376708984  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016232967376708984  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02946615219116211  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029506206512451172  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01619243621826172  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016416549682617188  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016416549682617188  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27752
output nodes number: 5350
edges number: 30065
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24708175659179688  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24708223342895508  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016907691955566406  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 15 input nodes size: 27846
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01619243621826172  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01619243621826172  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029470443725585938  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029510498046875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016237258911132812  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016462326049804688  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016462326049804688  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27846
output nodes number: 5350
edges number: 30188
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24515724182128906  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24515771865844727  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01695537567138672  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 16 input nodes size: 27609
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016237258911132812  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016237258911132812  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02940225601196289  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029442310333251953  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016124248504638672  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016346454620361328  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016346454620361328  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27609
output nodes number: 5341
edges number: 29738
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24200725555419922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24200773239135742  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016833782196044922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016833782196044922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016833782196044922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006392478942871094 |0.0004520276013542624 |0.026206858017865348 |0.00014601034276625689 |0.02462314156924977 |0.0033240318298339844 |
----------------------------------------------------------pseudo_mini_loss sum 3.26849365234375
Total (block generation + training)time/epoch 1.907707929611206
Training time/epoch 1.0662379264831543
Training time without block to device /epoch 1.0585534572601318
Training time without total dataloading part /epoch 0.8699162006378174
load block tensor time/epoch 0.1086721420288086
block to device time/epoch 0.007684469223022461
input features size transfer per epoch 2.2798776626586914e-06
blocks size to device per epoch 1.519918441772461e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  474823
Number of first layer input nodes during this epoch:  474823
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01683330535888672  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0145263671875
number of batches is  17
batch size is  5350
random selection method spend 0.010073661804199219
time for parepare:  0.03144049644470215
local_output_nid generation:  0.002938508987426758
local_in_edges_tensor generation:  0.007389545440673828
mini_batch_src_global generation:  0.002615213394165039
r_  generation:  0.0191802978515625
local_output_nid generation:  0.004082202911376953
local_in_edges_tensor generation:  0.0017626285552978516
mini_batch_src_global generation:  0.002218484878540039
r_  generation:  0.016824722290039062
local_output_nid generation:  0.003259420394897461
local_in_edges_tensor generation:  0.0013108253479003906
mini_batch_src_global generation:  0.0012683868408203125
r_  generation:  0.013009309768676758
local_output_nid generation:  0.003026247024536133
local_in_edges_tensor generation:  0.0012753009796142578
mini_batch_src_global generation:  0.0011358261108398438
r_  generation:  0.013159513473510742
local_output_nid generation:  0.0028574466705322266
local_in_edges_tensor generation:  0.0012829303741455078
mini_batch_src_global generation:  0.0010879039764404297
r_  generation:  0.013390541076660156
local_output_nid generation:  0.0027379989624023438
local_in_edges_tensor generation:  0.0011794567108154297
mini_batch_src_global generation:  0.0010762214660644531
r_  generation:  0.013321638107299805
local_output_nid generation:  0.002686023712158203
local_in_edges_tensor generation:  0.0012328624725341797
mini_batch_src_global generation:  0.0010859966278076172
r_  generation:  0.013428211212158203
local_output_nid generation:  0.0026535987854003906
local_in_edges_tensor generation:  0.0012688636779785156
mini_batch_src_global generation:  0.0010526180267333984
r_  generation:  0.013513803482055664
local_output_nid generation:  0.00263214111328125
local_in_edges_tensor generation:  0.0012598037719726562
mini_batch_src_global generation:  0.0014579296112060547
r_  generation:  0.013207674026489258
local_output_nid generation:  0.002585172653198242
local_in_edges_tensor generation:  0.0012123584747314453
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.013612508773803711
local_output_nid generation:  0.0026047229766845703
local_in_edges_tensor generation:  0.0014684200286865234
mini_batch_src_global generation:  0.0010917186737060547
r_  generation:  0.013687849044799805
local_output_nid generation:  0.0031304359436035156
local_in_edges_tensor generation:  0.0012221336364746094
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.01335906982421875
local_output_nid generation:  0.0027251243591308594
local_in_edges_tensor generation:  0.00125885009765625
mini_batch_src_global generation:  0.0010902881622314453
r_  generation:  0.013453006744384766
local_output_nid generation:  0.0027222633361816406
local_in_edges_tensor generation:  0.0012362003326416016
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.013577699661254883
local_output_nid generation:  0.0026574134826660156
local_in_edges_tensor generation:  0.0011870861053466797
mini_batch_src_global generation:  0.0010967254638671875
r_  generation:  0.013522863388061523
local_output_nid generation:  0.0026564598083496094
local_in_edges_tensor generation:  0.0011713504791259766
mini_batch_src_global generation:  0.001355886459350586
r_  generation:  0.013464927673339844
local_output_nid generation:  0.002628326416015625
local_in_edges_tensor generation:  0.001190185546875
mini_batch_src_global generation:  0.0010905265808105469
r_  generation:  0.013547658920288086
----------------------check_connections_block total spend ----------------------------- 0.4349837303161621
generate_one_block  0.02109694480895996
generate_one_block  0.019368410110473633
generate_one_block  0.019802331924438477
generate_one_block  0.019870758056640625
generate_one_block  0.019533157348632812
generate_one_block  0.01949334144592285
generate_one_block  0.019498109817504883
generate_one_block  0.01953864097595215
generate_one_block  0.01932668685913086
generate_one_block  0.019477367401123047
generate_one_block  0.019617080688476562
generate_one_block  0.019311189651489258
generate_one_block  0.019532442092895508
generate_one_block  0.02022409439086914
generate_one_block  0.020593643188476562
generate_one_block  0.01940178871154785
generate_one_block  0.021490812301635742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01683330535888672  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.8386770486831665
pseudo mini batch 0 input nodes size: 27990
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01612234115600586  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01612234115600586  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029469013214111328  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02950906753540039  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01630401611328125  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01652812957763672  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01652812957763672  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27990
output nodes number: 5350
edges number: 30057
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2477254867553711  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2477264404296875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017023086547851562  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 1 input nodes size: 28049
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016305923461914062  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016305923461914062  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029680728912353516  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029720783233642578  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016334056854248047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016559123992919922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016559123992919922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28049
output nodes number: 5350
edges number: 30131
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24485254287719727  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24485301971435547  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017053604125976562  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 2 input nodes size: 28027
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016334056854248047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016334056854248047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02969837188720703  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029738426208496094  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016323566436767578  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016547679901123047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016547679901123047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28027
output nodes number: 5350
edges number: 30077
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24444198608398438  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24444246292114258  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017040729522705078  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 3 input nodes size: 27965
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016323566436767578  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016323566436767578  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02965831756591797  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02969837188720703  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016294002532958984  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016520023345947266  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016520023345947266  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27965
output nodes number: 5350
edges number: 30245
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24881601333618164  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24881649017333984  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017014503479003906  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 4 input nodes size: 27923
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016294002532958984  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016294002532958984  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029608726501464844  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029648780822753906  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016273975372314453  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01650094985961914  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01650094985961914  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27923
output nodes number: 5350
edges number: 30390
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.25024843215942383  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.25024890899658203  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016996383666992188  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 5 input nodes size: 28126
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016273975372314453  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016273975372314453  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029685497283935547  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02972555160522461  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016370773315429688  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01659679412841797  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01659679412841797  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28126
output nodes number: 5350
edges number: 30231
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24896907806396484  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24896955490112305  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01709270477294922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 6 input nodes size: 28169
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016370773315429688  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016370773315429688  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029802799224853516  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029842853546142578  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016391277313232422  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01661825180053711  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01661825180053711  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28169
output nodes number: 5350
edges number: 30395
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.25083303451538086  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.25083351135253906  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01711559295654297  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 7 input nodes size: 28078
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016391277313232422  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016391277313232422  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029779911041259766  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029819965362548828  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016347885131835938  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01657390594482422  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01657390594482422  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28078
output nodes number: 5350
edges number: 30317
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2499065399169922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2499070167541504  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017069339752197266  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 8 input nodes size: 27725
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016347885131835938  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016347885131835938  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029568195343017578  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02960824966430664  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016179561614990234  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016402721405029297  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016402721405029297  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27725
output nodes number: 5350
edges number: 29946
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2436838150024414  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2436842918395996  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01689291000366211  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 9 input nodes size: 28138
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016179561614990234  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016179561614990234  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029596805572509766  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029636859893798828  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016376495361328125  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016602516174316406  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016602516174316406  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28138
output nodes number: 5350
edges number: 30302
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2502727508544922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2502732276916504  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.017098426818847656  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 10 input nodes size: 27883
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016376495361328125  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016376495361328125  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02967214584350586  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029712200164794922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016254901885986328  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01648092269897461  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01648092269897461  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27883
output nodes number: 5350
edges number: 30250
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24612903594970703  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24612951278686523  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016974925994873047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 11 input nodes size: 27809
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016254901885986328  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016254901885986328  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02951526641845703  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029555320739746094  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016219615936279297  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016443729400634766  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016443729400634766  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27809
output nodes number: 5350
edges number: 30010
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24404478073120117  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24404525756835938  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016935348510742188  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 12 input nodes size: 27800
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016219615936279297  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016219615936279297  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029475688934326172  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029515743255615234  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01621532440185547  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016439437866210938  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016439437866210938  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27800
output nodes number: 5350
edges number: 29995
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2440485954284668  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.244049072265625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01693105697631836  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 13 input nodes size: 28153
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01621532440185547  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01621532440185547  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029639720916748047  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02967977523803711  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016383647918701172  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016612529754638672  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016612529754638672  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 28153
output nodes number: 5350
edges number: 30693
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24979257583618164  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24979305267333984  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01711130142211914  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 14 input nodes size: 27911
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016383647918701172  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016383647918701172  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029692649841308594  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029732704162597656  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016268253326416016  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016495227813720703  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016495227813720703  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27911
output nodes number: 5350
edges number: 30376
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2500462532043457  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.2500467300415039  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01699066162109375  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

pseudo mini batch 15 input nodes size: 27874
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016268253326416016  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016268253326416016  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029559612274169922  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029599666595458984  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.0162506103515625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01647472381591797  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01647472381591797  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27874
output nodes number: 5350
edges number: 30044
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24459362030029297  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24459409713745117  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016966819763183594  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes
Using backend: pytorch

pseudo mini batch 16 input nodes size: 27610
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.0162506103515625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.0162506103515625  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.02941608428955078  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.029456138610839844  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016124725341796875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016348838806152344  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.016348838806152344  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

input nodes number: 27610
output nodes number: 5341
edges number: 29955
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24358797073364258  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.24358844757080078  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01683807373046875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01683807373046875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3603515625 GB
    Memory Allocated: 0.01683807373046875  GigaBytes
Max Memory Allocated: 0.36397886276245117  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006521070704740637 |0.0005425425136790556 |0.027957649791941923 |0.00014812806073357076 |0.024828097399543312 |0.0034699440002441406 |
----------------------------------------------------------pseudo_mini_loss sum 3.169161796569824
Total (block generation + training)time/epoch 1.926288366317749
Training time/epoch 1.1086227893829346
Training time without block to device /epoch 1.0993995666503906
Training time without total dataloading part /epoch 0.9033458232879639
load block tensor time/epoch 0.11085820198059082
block to device time/epoch 0.009223222732543945
input features size transfer per epoch 2.2798776626586914e-06
blocks size to device per epoch 1.519918441772461e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  475230
Number of first layer input nodes during this epoch:  475230
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
