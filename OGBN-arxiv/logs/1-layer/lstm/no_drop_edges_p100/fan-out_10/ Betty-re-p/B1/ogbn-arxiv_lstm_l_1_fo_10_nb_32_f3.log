[21:39:46] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14089438 edges into 32 parts and get 3361938 edge cuts
main start at this time 1651873172.0912807
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.015694141387939453
global_2_local spend time (sec) 0.04021573066711426
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0031638145446777344
A = g.adjacency_matrix() spent  0.0051920413970947266
auxiliary_graph
Graph(num_nodes=145031, num_edges=14180379,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.15519380569458008
remove nodes length
54090
auxiliary_graph.remove_nodes spent  0.8447620868682861
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14180379,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6496331691741943

the counter of shared neighbor distribution
Counter({1.0: 12728892, 2.0: 1148578, 3.0: 165860, 4.0: 33436, 5.0: 8994, 6.0: 2692, 7.0: 738, 8.0: 218, 9.0: 28, 10.0: 2})
14089438
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14089435, 14089436, 14089437])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12728892, 2.0: 1148578, 3.0: 165860, 4.0: 33436, 5.0: 8994, 6.0: 2692, 7.0: 738, 8.0: 218, 9.0: 28, 10.0: 2})
Convert a graph into a bidirected graph: 1.011 seconds
Metis partitioning: 3.300 seconds
Split the graph: 0.411 seconds
Construct subgraphs: 0.060 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.789712429046631
2842
2828
2889
2812
2822
2758
2862
2885
2828
2868
2911
2900
2898
2894
2900
2924
2910
2897
2885
2825
2878
2778
2833
2758
2810
2822
2758
2793
2758
2899
2758
2758
total k batches seeds list generation spend  10.975199222564697
after graph partition
graph partition algorithm spend time 11.061282634735107
2842
2828
2889
2812
2822
2758
2862
2885
2828
2868
2911
2900
2898
2894
2900
2924
2910
2897
2885
2825
2878
2778
2833
2758
2810
2822
2758
2793
2758
2899
2758
2758
partition_len_list
[5458, 5935, 5351, 5748, 6664, 7604, 6460, 5624, 7748, 6117, 6764, 7000, 5609, 5040, 5533, 5517, 6368, 5485, 7063, 6119, 6835, 8501, 9732, 7830, 12598, 11798, 11086, 10264, 12203, 11994, 11343, 11160]
shared_neighbor_graph_partition_s0 selection method  spend 11.151580095291138
time for parepare:  0.018507957458496094
local_output_nid generation:  0.0004978179931640625
local_in_edges_tensor generation:  0.0008742809295654297
mini_batch_src_global generation:  0.000850677490234375
r_  generation:  0.0069577693939208984
local_output_nid generation:  0.0005853176116943359
local_in_edges_tensor generation:  0.0006601810455322266
mini_batch_src_global generation:  0.0007777214050292969
r_  generation:  0.0066797733306884766
local_output_nid generation:  0.0006363391876220703
local_in_edges_tensor generation:  0.0006389617919921875
mini_batch_src_global generation:  0.0006816387176513672
r_  generation:  0.006798267364501953
local_output_nid generation:  0.0006213188171386719
local_in_edges_tensor generation:  0.0006213188171386719
mini_batch_src_global generation:  0.0005984306335449219
r_  generation:  0.00647735595703125
local_output_nid generation:  0.0006122589111328125
local_in_edges_tensor generation:  0.0006313323974609375
mini_batch_src_global generation:  0.0006303787231445312
r_  generation:  0.006885051727294922
local_output_nid generation:  0.0005996227264404297
local_in_edges_tensor generation:  0.0006000995635986328
mini_batch_src_global generation:  0.0005748271942138672
r_  generation:  0.0059773921966552734
local_output_nid generation:  0.0006334781646728516
local_in_edges_tensor generation:  0.000621795654296875
mini_batch_src_global generation:  0.0005905628204345703
r_  generation:  0.006753683090209961
local_output_nid generation:  0.0006020069122314453
local_in_edges_tensor generation:  0.0006175041198730469
mini_batch_src_global generation:  0.0005507469177246094
r_  generation:  0.006048440933227539
local_output_nid generation:  0.0005736351013183594
local_in_edges_tensor generation:  0.0006232261657714844
mini_batch_src_global generation:  0.0006344318389892578
r_  generation:  0.0068950653076171875
local_output_nid generation:  0.0005686283111572266
local_in_edges_tensor generation:  0.0006196498870849609
mini_batch_src_global generation:  0.0005962848663330078
r_  generation:  0.006637096405029297
local_output_nid generation:  0.0005643367767333984
local_in_edges_tensor generation:  0.000629425048828125
mini_batch_src_global generation:  0.0006055831909179688
r_  generation:  0.006945371627807617
local_output_nid generation:  0.0005538463592529297
local_in_edges_tensor generation:  0.0006136894226074219
mini_batch_src_global generation:  0.0005650520324707031
r_  generation:  0.006184816360473633
local_output_nid generation:  0.0005362033843994141
local_in_edges_tensor generation:  0.0006220340728759766
mini_batch_src_global generation:  0.0005242824554443359
r_  generation:  0.00595855712890625
local_output_nid generation:  0.0005307197570800781
local_in_edges_tensor generation:  0.0006055831909179688
mini_batch_src_global generation:  0.0004999637603759766
r_  generation:  0.00583958625793457
local_output_nid generation:  0.0005173683166503906
local_in_edges_tensor generation:  0.0006110668182373047
mini_batch_src_global generation:  0.0005428791046142578
r_  generation:  0.006481170654296875
local_output_nid generation:  0.0005133152008056641
local_in_edges_tensor generation:  0.0006117820739746094
mini_batch_src_global generation:  0.0005304813385009766
r_  generation:  0.006026029586791992
local_output_nid generation:  0.0005009174346923828
local_in_edges_tensor generation:  0.0006086826324462891
mini_batch_src_global generation:  0.000514984130859375
r_  generation:  0.00599360466003418
local_output_nid generation:  0.0004980564117431641
local_in_edges_tensor generation:  0.0006279945373535156
mini_batch_src_global generation:  0.0004811286926269531
r_  generation:  0.005571842193603516
local_output_nid generation:  0.0004892349243164062
local_in_edges_tensor generation:  0.0006129741668701172
mini_batch_src_global generation:  0.0005674362182617188
r_  generation:  0.007047891616821289
local_output_nid generation:  0.00047969818115234375
local_in_edges_tensor generation:  0.0007131099700927734
mini_batch_src_global generation:  0.0005633831024169922
r_  generation:  0.0063877105712890625
local_output_nid generation:  0.00048041343688964844
local_in_edges_tensor generation:  0.0006508827209472656
mini_batch_src_global generation:  0.0005052089691162109
r_  generation:  0.005945920944213867
local_output_nid generation:  0.00047016143798828125
local_in_edges_tensor generation:  0.0005867481231689453
mini_batch_src_global generation:  0.0005083084106445312
r_  generation:  0.005766630172729492
local_output_nid generation:  0.00048279762268066406
local_in_edges_tensor generation: [21:39:48] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2810 nodes and 903056 edges into 2 parts and get 155584 edge cuts
 0.0006003379821777344
mini_batch_src_global generation:  0.0021827220916748047
r_  generation:  0.015720605850219727
local_output_nid generation:  0.0016837120056152344
local_in_edges_tensor generation:  0.0014052391052246094
mini_batch_src_global generation:  0.0011332035064697266
r_  generation:  0.011128425598144531
local_output_nid generation:  0.0015099048614501953
local_in_edges_tensor generation:  0.0014595985412597656
mini_batch_src_global generation:  0.002117156982421875
r_  generation:  0.017357587814331055
local_output_nid generation:  0.0010797977447509766
local_in_edges_tensor generation:  0.00821375846862793
mini_batch_src_global generation:  0.0017251968383789062
r_  generation:  0.014289379119873047
local_output_nid generation:  0.0008566379547119141
local_in_edges_tensor generation:  0.0015549659729003906
mini_batch_src_global generation:  0.001622915267944336
r_  generation:  0.013634204864501953
local_output_nid generation:  0.0008068084716796875
local_in_edges_tensor generation:  0.0010068416595458984
mini_batch_src_global generation:  0.001065969467163086
r_  generation:  0.010200262069702148
local_output_nid generation:  0.0007500648498535156
local_in_edges_tensor generation:  0.0010488033294677734
mini_batch_src_global generation:  0.0013484954833984375
r_  generation:  0.011335611343383789
local_output_nid generation:  0.0007750988006591797
local_in_edges_tensor generation:  0.0010631084442138672
mini_batch_src_global generation:  0.0013196468353271484
r_  generation:  0.011488914489746094
local_output_nid generation:  0.0007104873657226562
local_in_edges_tensor generation:  0.0008533000946044922
mini_batch_src_global generation:  0.0009851455688476562
r_  generation:  0.009347915649414062
local_output_nid generation:  0.0006959438323974609
local_in_edges_tensor generation:  0.0008203983306884766
mini_batch_src_global generation:  0.0008947849273681641
r_  generation:  0.007136344909667969
----------------------check_connections_block total spend ----------------------------- 0.43098902702331543
generate_one_block  0.011086702346801758
generate_one_block  0.009989261627197266
generate_one_block  0.0099639892578125
generate_one_block  0.00958561897277832
generate_one_block  0.010912179946899414
generate_one_block  0.009975433349609375
generate_one_block  0.009842872619628906
generate_one_block  0.008910179138183594
generate_one_block  0.010761737823486328
generate_one_block  0.009910106658935547
generate_one_block  0.010094881057739258
generate_one_block  0.009182929992675781
generate_one_block  0.00868535041809082
generate_one_block  0.008350610733032227
generate_one_block  0.00932168960571289
generate_one_block  0.008725881576538086
generate_one_block  0.008783102035522461
generate_one_block  0.008104324340820312
generate_one_block  0.010143518447875977
generate_one_block  0.00925445556640625
generate_one_block  0.008650541305541992
generate_one_block  0.009102106094360352
generate_one_block  0.010384798049926758
generate_one_block  0.00858616828918457
generate_one_block  0.011756658554077148
generate_one_block  0.011405706405639648
generate_one_block  0.012023210525512695
generate_one_block  0.009899139404296875
generate_one_block  0.01186990737915039
generate_one_block  0.012826919555664062
generate_one_block  0.011212348937988281
generate_one_block  0.010979652404785156
global_2_local spend time (sec) 0.0023889541625976562
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0006282329559326172
A = g.adjacency_matrix() spent  0.0003941059112548828
auxiliary_graph
Graph(num_nodes=12598, num_edges=905866,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.012030839920043945
remove nodes length
9788
auxiliary_graph.remove_nodes spent  0.04590654373168945
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2810, num_edges=905866,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.03341102600097656

the counter of shared neighbor distribution
Counter({1.0: 861854, 2.0: 38290, 3.0: 2560, 4.0: 280, 5.0: 60, 6.0: 12})
903056
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 903053, 903054, 903055])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 861854, 2.0: 38290, 3.0: 2560, 4.0: 280, 5.0: 60, 6.0: 12})
Convert a graph into a bidirected graph: 0.033 seconds
Metis partitioning: 0.059 seconds
Split the graph: 0.121 seconds
Construct subgraphs: 0.017 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.23029470443725586
1405
1405
total k batches seeds list generation spend  0.6267125606536865
after graph partition
graph partition algorithm spend time 0.6319241523742676
1405
1405
time for parepare:  0.031549692153930664
local_output_nid generation:  0.00033283233642578125
local_in_edges_tensor generation:  0.0007579326629638672
mini_batch_src_global generation:  0.0006611347198486328
r_  generation:  0.005573272705078125
local_output_nid generation:  0.0003268718719482422
local_in_edges_tensor generation:  0.0007269382476806641
mini_batch_src_global generation:  0.0008058547973632812
r_  generation:  0.0060214996337890625
----------------------check_connections_block total spend ----------------------------- 0.05446219444274902
generate_one_block  0.009248733520507812
generate_one_block  0.010268449783325195
----------===============-------------===============-------------the number of batches ***** 33

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 5458
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.0031328201293945312  GigaBytes
Max Memory Allocated: 0.0031328201293945312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.003154277801513672  GigaBytes
Max Memory Allocated: 0.003154277801513672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.003154277801513672  GigaBytes
Max Memory Allocated: 0.003154277801513672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.003287792205810547  GigaBytes
Max Memory Allocated: 0.003287792205810547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.003287792205810547  GigaBytes
Max Memory Allocated: 0.003287792205810547  GigaBytes

input nodes number: 5458
output nodes number: 2842
edges number: 17816
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.13871192932128906  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.13871288299560547  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.0044498443603515625  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 1 input nodes size: 5935
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004109382629394531  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004109382629394531  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.006939411163330078  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.006960868835449219  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004336833953857422  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004462718963623047  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004462718963623047  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 5935
output nodes number: 2828
edges number: 16786
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.13333749771118164  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.13333797454833984  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004662990570068359  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 2 input nodes size: 5351
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004334449768066406  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004334449768066406  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.0069370269775390625  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.006958961486816406  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004107475280761719  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004235267639160156  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004235267639160156  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 5351
output nodes number: 2889
edges number: 17027
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.13321590423583984  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.13321638107299805  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004445075988769531  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 3 input nodes size: 5748
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004116535186767578  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004116535186767578  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.006857395172119141  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.006878376007080078  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004253864288330078  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004374027252197266  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004374027252197266  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 5748
output nodes number: 2812
edges number: 16011
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.12590265274047852  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.12590312957763672  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004557132720947266  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 4 input nodes size: 6664
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004242420196533203  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004242420196533203  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.007420063018798828  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.007441520690917969  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004679679870605469  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004809379577636719  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004809379577636719  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 6664
output nodes number: 2822
edges number: 17357
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.1377730369567871  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.1377735137939453  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005023002624511719  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 5 input nodes size: 7604
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004681110382080078  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004681110382080078  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.00830698013305664  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.008327960968017578  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.0051288604736328125  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005236625671386719  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005236625671386719  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 7604
output nodes number: 2758
edges number: 14424
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.11495733261108398  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.11495780944824219  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005423069000244141  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 6 input nodes size: 6460
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.00511932373046875  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.00511932373046875  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.008199691772460938  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.008221149444580078  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004574298858642578  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004697322845458984  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004697322845458984  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 6460
output nodes number: 2862
edges number: 16389
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.1291813850402832  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.1291818618774414  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004916667938232422  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 7 input nodes size: 5624
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004590034484863281  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004590034484863281  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.008215904235839844  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.008237838745117188  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005136013031005859  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005244731903076172  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005244731903076172  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 5624
output nodes number: 2885
edges number: 14513
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.11633586883544922  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.11633634567260742  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005431652069091797  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 8 input nodes size: 7748
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005139350891113281  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005139350891113281  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.008833885192871094  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.008855342864990234  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005207538604736328  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005337238311767578  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005337238311767578  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 7748
output nodes number: 2828
edges number: 17370
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.13641071319580078  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.13641119003295898  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005548954010009766  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 9 input nodes size: 6117
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005198955535888672  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005198955535888672  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.008824825286865234  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.008846282958984375  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005130290985107422  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005248546600341797  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005248546600341797  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 6117
output nodes number: 2868
edges number: 15805
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.12516498565673828  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.12516546249389648  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005451202392578125  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 10 input nodes size: 6764
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.0051364898681640625  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.0051364898681640625  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.00836181640625  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.008383750915527344  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004736423492431641  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004861354827880859  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004861354827880859  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 6764
output nodes number: 2911
edges number: 16740
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.1332697868347168  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.133270263671875  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005075931549072266  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 11 input nodes size: 7000
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004742622375488281  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004742622375488281  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.008368492126464844  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.008390426635742188  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005143165588378906  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005252838134765625  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005252838134765625  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 7000
output nodes number: 2900
edges number: 14621
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.11674642562866211  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.11674690246582031  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005446434020996094  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 12 input nodes size: 5609
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005141735076904297  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.005141735076904297  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.007816314697265625  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.007838249206542969  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.0041904449462890625  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004294395446777344  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004294395446777344  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 5609
output nodes number: 2898
edges number: 13904
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.11150121688842773  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.11150169372558594  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.0044727325439453125  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 13 input nodes size: 5040
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004189968109130859  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004189968109130859  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.006593227386474609  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.006615161895751953  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.003918647766113281  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004019737243652344  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1005859375 GB
    Memory Allocated: 0.004019737243652344  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 5040
output nodes number: 2894
edges number: 13528
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.10692405700683594  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.10692453384399414  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004190921783447266  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 14 input nodes size: 5533
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.003918170928955078  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.003918170928955078  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.006556510925292969  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.0065784454345703125  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004153251647949219  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.0042705535888671875  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.0042705535888671875  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 5533
output nodes number: 2900
edges number: 15632
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.12404298782348633  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.12404346466064453  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.00446319580078125  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 15 input nodes size: 5517
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004154205322265625  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004154205322265625  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.006784915924072266  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.006806850433349609  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004146575927734375  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004252433776855469  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004252433776855469  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 5517
output nodes number: 2924
edges number: 14097
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.11306953430175781  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.11307001113891602  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004436016082763672  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 16 input nodes size: 6368
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004149913787841797  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004149913787841797  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.007186412811279297  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.007208347320556641  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004555702209472656  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004660606384277344  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004660606384277344  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 6368
output nodes number: 2910
edges number: 13982
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.11155080795288086  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.11155128479003906  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004844188690185547  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 17 input nodes size: 5485
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004553794860839844  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004553794860839844  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.007169246673583984  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.007191181182861328  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004132747650146484  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004228115081787109  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004228115081787109  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 5485
output nodes number: 2897
edges number: 12738
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.10311031341552734  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.10311079025268555  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004395484924316406  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 18 input nodes size: 7063
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004130840301513672  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004130840301513672  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.007498741149902344  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.0075206756591796875  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004883289337158203  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005008220672607422  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005008220672607422  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 7063
output nodes number: 2885
edges number: 16742
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.13184309005737305  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.13184356689453125  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005217075347900391  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 19 input nodes size: 6119
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004881381988525391  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004881381988525391  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.0077991485595703125  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.007820606231689453  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.0044307708740234375  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004544258117675781  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004544258117675781  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 6119
output nodes number: 2825
edges number: 15177
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.11921501159667969  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.11921548843383789  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004726886749267578  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 20 input nodes size: 6835
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004421710968017578  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004421710968017578  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.0076808929443359375  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.007702350616455078  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004763126373291016  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004863262176513672  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004863262176513672  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 6835
output nodes number: 2878
edges number: 13387
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.10883283615112305  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.10883331298828125  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005054950714111328  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 21 input nodes size: 8501
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004771232604980469  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.004771232604980469  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.008824825286865234  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.008845806121826172  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005565166473388672  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005666255950927734  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005666255950927734  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 8501
output nodes number: 2778
edges number: 13487
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.10928010940551758  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.10928058624267578  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005847454071044922  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 22 input nodes size: 9732
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005550384521484375  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005550384521484375  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.010190963745117188  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.010212421417236328  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.006137847900390625  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.006257057189941406  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.006257057189941406  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 9732
output nodes number: 2833
edges number: 15979
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.1283864974975586  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.1283869743347168  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.006489753723144531  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 23 input nodes size: 7830
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.006145954132080078  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.006145954132080078  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.009879589080810547  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.009900569915771484  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005238533020019531  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005331993103027344  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005331993103027344  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 7830
output nodes number: 2758
edges number: 12519
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.1007394790649414  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.10073995590209961  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005504131317138672  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

pseudo mini batch 24 input nodes size: 11798
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005227088928222656  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.005227088928222656  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.010852813720703125  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.010874271392822266  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.007119655609130859  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.007256031036376953  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1337890625 GB
    Memory Allocated: 0.007256031036376953  GigaBytes
Max Memory Allocated: 0.14982080459594727  GigaBytes

input nodes number: 11798
output nodes number: 2822
edges number: 18223
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1533203125 GB
    Memory Allocated: 0.1464982032775879  GigaBytes
Max Memory Allocated: 0.1594099998474121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1533203125 GB
    Memory Allocated: 0.1464986801147461  GigaBytes
Max Memory Allocated: 0.1594099998474121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1533203125 GB
    Memory Allocated: 0.0075225830078125  GigaBytes
Max Memory Allocated: 0.1594099998474121  GigaBytes

pseudo mini batch 25 input nodes size: 11086
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1533203125 GB
    Memory Allocated: 0.007129192352294922  GigaBytes
Max Memory Allocated: 0.1594099998474121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1533203125 GB
    Memory Allocated: 0.007129192352294922  GigaBytes
Max Memory Allocated: 0.1594099998474121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1533203125 GB
    Memory Allocated: 0.012660503387451172  GigaBytes
Max Memory Allocated: 0.1594099998474121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1533203125 GB
    Memory Allocated: 0.01268148422241211  GigaBytes
Max Memory Allocated: 0.1594099998474121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1533203125 GB
    Memory Allocated: 0.0070343017578125  GigaBytes
Max Memory Allocated: 0.1594099998474121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1533203125 GB
    Memory Allocated: 0.0071811676025390625  GigaBytes
Max Memory Allocated: 0.1594099998474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1533203125 GB
    Memory Allocated: 0.0071811676025390625  GigaBytes
Max Memory Allocated: 0.1594099998474121  GigaBytes

input nodes number: 11086
output nodes number: 2758
edges number: 19711
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.15457439422607422  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.15457487106323242  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0074329376220703125  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

pseudo mini batch 26 input nodes size: 10264
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0070247650146484375  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0070247650146484375  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.011919021606445312  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.01194000244140625  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0063877105712890625  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0065021514892578125  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0065021514892578125  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

input nodes number: 10264
output nodes number: 2793
edges number: 15271
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1236729621887207  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1236734390258789  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006730079650878906  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

pseudo mini batch 27 input nodes size: 12203
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006392955780029297  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006392955780029297  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.012211799621582031  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.012232780456542969  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007317543029785156  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0074615478515625  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0074615478515625  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

input nodes number: 12203
output nodes number: 2758
edges number: 19249
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1538066864013672  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1538071632385254  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0077228546142578125  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

pseudo mini batch 28 input nodes size: 11994
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007312297821044922  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007312297821044922  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013031482696533203  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013053417205810547  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007213592529296875  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007370948791503906  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007370948791503906  GigaBytes
Max Memory Allocated: 0.1695270538330078  GigaBytes

input nodes number: 11994
output nodes number: 2899
edges number: 21098
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.16535472869873047  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.16535520553588867  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007671833038330078  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 29 input nodes size: 11343
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0072345733642578125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0072345733642578125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.01264333724975586  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.012664318084716797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006923198699951172  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007055759429931641  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007055759429931641  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 11343
output nodes number: 2758
edges number: 17724
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13975954055786133  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13976001739501953  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007283687591552734  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 30 input nodes size: 11160
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006902217864990234  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006902217864990234  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.01222372055053711  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.012244701385498047  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0068149566650390625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006946563720703125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006946563720703125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 11160
output nodes number: 2758
edges number: 17585
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13969087600708008  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13969135284423828  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007193088531494141  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 31 input nodes size: 6094
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0068149566650390625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes
[21:40:02] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14237192 edges into 33 parts and get 3550504 edge cuts

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0068149566650390625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009720802307128906  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009731292724609375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0043888092041015625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004450798034667969  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004450798034667969  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6094
output nodes number: 1405
edges number: 8238
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.06619596481323242  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.06619644165039062  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004373073577880859  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 32 input nodes size: 7434
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004187583923339844  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004187583923339844  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007732391357421875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007742881774902344  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004826545715332031  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0049037933349609375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0049037933349609375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 7434
output nodes number: 1405
edges number: 10284
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.08271980285644531  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.08272027969360352  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0050525665283203125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0061130523681640625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0061130523681640625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005588712114276308 |0.011628736149181019 |0.043326948628281105 |0.00016096866492069128 |0.023763093081387607 |0.004656314849853516 |
----------------------------------------------------------pseudo_mini_loss sum 3.837965488433838
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  249481
Number of first layer input nodes during this epoch:  249481
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006112575531005859  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03030085563659668
global_2_local spend time (sec) 0.05438351631164551
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004240274429321289
A = g.adjacency_matrix() spent  0.005433797836303711
auxiliary_graph
Graph(num_nodes=144933, num_edges=14328133,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10991311073303223
remove nodes length
53992
auxiliary_graph.remove_nodes spent  0.8497893810272217
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14328133,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6567456722259521

the counter of shared neighbor distribution
Counter({1.0: 12862168, 2.0: 1164718, 3.0: 164710, 4.0: 33108, 5.0: 8804, 6.0: 2640, 7.0: 800, 8.0: 210, 9.0: 32, 10.0: 2})
14237192
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14237189, 14237190, 14237191])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12862168, 2.0: 1164718, 3.0: 164710, 4.0: 33108, 5.0: 8804, 6.0: 2640, 7.0: 800, 8.0: 210, 9.0: 32, 10.0: 2})
Convert a graph into a bidirected graph: 1.042 seconds
Metis partitioning: 3.334 seconds
Split the graph: 0.413 seconds
Construct subgraphs: 0.108 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.907978296279907
2764
2802
2784
2713
2712
2790
2755
2826
2805
2785
2816
2797
2760
2837
2788
2806
2775
2823
2817
2787
2773
2720
2681
2675
2711
2728
2675
2698
2690
2697
2675
2675
2801
total k batches seeds list generation spend  11.223493576049805
after graph partition
graph partition algorithm spend time 11.366410255432129
2764
2802
2784
2713
2712
2790
2755
2826
2805
2785
2816
2797
2760
2837
2788
2806
2775
2823
2817
2787
2773
2720
2681
2675
2711
2728
2675
2698
2690
2697
2675
2675
2801
partition_len_list
[5230, 5888, 5486, 5132, 5998, 6027, 6206, 6670, 5378, 5282, 6449, 5158, 5829, 6525, 5244, 4923, 7585, 6117, 7771, 7045, 6746, 6538, 8702, 7971, 11519, 10885, 10700, 9287, 10692, 10567, 12342, 11511, 12084]
shared_neighbor_graph_partition_s0 selection method  spend 11.493030786514282
time for parepare:  0.019913196563720703
local_output_nid generation:  0.0005123615264892578
local_in_edges_tensor generation:  0.0008525848388671875
mini_batch_src_global generation:  0.0009176731109619141
r_  generation:  0.006917715072631836
local_output_nid generation:  0.0006222724914550781
local_in_edges_tensor generation:  0.0006995201110839844
mini_batch_src_global generation:  0.0007505416870117188
r_  generation:  0.0063381195068359375
local_output_nid generation:  0.0006554126739501953
local_in_edges_tensor generation:  0.0006842613220214844
mini_batch_src_global generation:  0.0006520748138427734
r_  generation:  0.006852149963378906
local_output_nid generation:  0.0006587505340576172
local_in_edges_tensor generation:  0.0006949901580810547
mini_batch_src_global generation:  0.0005593299865722656
r_  generation:  0.006308794021606445
local_output_nid generation:  0.0006499290466308594
local_in_edges_tensor generation:  0.0006623268127441406
mini_batch_src_global generation:  0.0006127357482910156
r_  generation:  0.006137847900390625
local_output_nid generation:  0.000659942626953125
local_in_edges_tensor generation:  0.0006792545318603516
mini_batch_src_global generation:  0.0005474090576171875
r_  generation:  0.005942344665527344
local_output_nid generation:  0.0006432533264160156
local_in_edges_tensor generation:  0.0006918907165527344
mini_batch_src_global generation:  0.0006144046783447266
r_  generation:  0.006978750228881836
local_output_nid generation:  0.0006473064422607422
local_in_edges_tensor generation:  0.0006623268127441406
mini_batch_src_global generation:  0.0006265640258789062
r_  generation:  0.006927013397216797
local_output_nid generation:  0.0006318092346191406
local_in_edges_tensor generation:  0.0006463527679443359
mini_batch_src_global generation:  0.0005929470062255859
r_  generation:  0.006346225738525391
local_output_nid generation:  0.0006194114685058594
local_in_edges_tensor generation:  0.0006651878356933594
mini_batch_src_global generation:  0.0005338191986083984
r_  generation:  0.005909442901611328
local_output_nid generation:  0.0005941390991210938
local_in_edges_tensor generation:  0.0006623268127441406
mini_batch_src_global generation:  0.0005972385406494141
r_  generation:  0.006932497024536133
local_output_nid generation:  0.0005922317504882812
local_in_edges_tensor generation:  0.0006401538848876953
mini_batch_src_global generation:  0.0005381107330322266
r_  generation:  0.005861520767211914
local_output_nid generation:  0.0005731582641601562
local_in_edges_tensor generation:  0.0006580352783203125
mini_batch_src_global generation:  0.0006084442138671875
r_  generation:  0.006892681121826172
local_output_nid generation:  0.0005738735198974609
local_in_edges_tensor generation:  0.0006520748138427734
mini_batch_src_global generation:  0.0006096363067626953
r_  generation:  0.006818294525146484
local_output_nid generation:  0.0005717277526855469
local_in_edges_tensor generation:  0.0006451606750488281
mini_batch_src_global generation:  0.0005562305450439453
r_  generation:  0.006274223327636719
local_output_nid generation:  0.0005576610565185547
local_in_edges_tensor generation:  0.0006330013275146484
mini_batch_src_global generation:  0.0005068778991699219
r_  generation:  0.005753278732299805
local_output_nid generation:  0.0005419254302978516
local_in_edges_tensor generation:  0.0006318092346191406
mini_batch_src_global generation:  0.0005488395690917969
r_  generation:  0.006094694137573242
local_output_nid generation:  0.0005545616149902344
local_in_edges_tensor generation:  0.0006422996520996094
mini_batch_src_global generation:  0.0005750656127929688
r_  generation:  0.00586390495300293
local_output_nid generation:  0.0005583763122558594
local_in_edges_tensor generation:  0.0006427764892578125
mini_batch_src_global generation:  0.0005965232849121094
r_  generation:  0.006828784942626953
local_output_nid generation:  0.0005452632904052734
local_in_edges_tensor generation:  0.0006351470947265625
mini_batch_src_global generation:  0.0005507469177246094
r_  generation:  0.005900144577026367
local_output_nid generation:  0.0005495548248291016
local_in_edges_tensor generation:  0.0006814002990722656
mini_batch_src_global generation:  0.0005304813385009766
r_  generation:  0.005982637405395508
local_output_nid generation:  0.0005295276641845703
local_in_edges_tensor generation:  0.0006587505340576172
mini_batch_src_global generation:  0.0004930496215820312
r_  generation:  0.005336284637451172
local_output_nid generation:  0.0005335807800292969
local_in_edges_tensor generation:  0.000640869140625
mini_batch_src_global generation:  0.0005664825439453125
r_  generation:  0.006407976150512695
local_output_nid generation:  0.0005221366882324219
local_in_edges_tensor generation:  0.0006225109100341797
mini_batch_src_global generation:  0.0005178451538085938
r_  generation:  0.005219697952270508
local_output_nid generation:  0.0005164146423339844
local_in_edges_tensor generation:  0.0006258487701416016
mini_batch_src_global generation:  0.0007710456848144531
r_  generation:  0.00654149055480957
local_output_nid generation:  0.0005326271057128906
local_in_edges_tensor generation:  0.0007030963897705078
mini_batch_src_global generation:  0.0006961822509765625
r_  generation:  0.00695490837097168
local_output_nid generation:  0.0005393028259277344
local_in_edges_tensor generation:  0.0006341934204101562
mini_batch_src_global generation:  0.0008823871612548828
r_  generation:  0.007497072219848633
local_output_nid generation:  0.0005447864532470703
local_in_edges_tensor generation:  0.0006577968597412109
mini_batch_src_global generation:  0.0005738735198974609
r_  generation:  0.0055887699127197266
local_output_nid generation:  0.0005426406860351562
local_in_edges_tensor generation:  0.0006420612335205078
mini_batch_src_global generation:  0.00066375732421875
r_  generation:  0.0067059993743896484
local_output_nid generation:  0.0005307197570800781
local_in_edges_tensor generation:  0.0006265640258789062
mini_batch_src_global generation:  0.0006029605865478516
r_  generation:  0.006428956985473633
local_output_nid generation:  0.0005476474761962891
local_in_edges_tensor generation:  0.0006337165832519531
mini_batch_src_global generation:  0.0009124279022216797
r_  generation:  0.007572174072265625
local_output_nid generation:  0.0005910396575927734
local_in_edges_tensor generation:  0.0007700920104980469
mini_batch_src_global generation:  0.0007185935974121094
r_  generation:  0.007325172424316406
local_output_nid generation:  0.0005795955657958984
local_in_edges_tensor generation:  0.0006706714630126953
mini_batch_src_global generation:  0.0007574558258056641
r_  generation:  0.008007526397705078
----------------------check_connections_block total spend ----------------------------- 0.3514735698699951
generate_one_block  0.015089273452758789
generate_one_block  0.011332988739013672
generate_one_block  0.010586977005004883
generate_one_block  0.00897979736328125
generate_one_block  0.00991368293762207
generate_one_block  0.009252309799194336
generate_one_block  0.010088682174682617
generate_one_block  0.010190963745117188
generate_one_block  0.009073257446289062
generate_one_block  0.008408308029174805
generate_one_block  0.009869813919067383
generate_one_block  0.00826120376586914
generate_one_block  0.009969472885131836
generate_one_block  0.009697675704956055
generate_one_block  0.008678436279296875
generate_one_block  0.011414051055908203
generate_one_block  0.009604692459106445
generate_one_block  0.008457183837890625
generate_one_block  0.010334968566894531
generate_one_block  0.008628129959106445
generate_one_block  0.00877833366394043
generate_one_block  0.007907390594482422
generate_one_block  0.00992727279663086
generate_one_block  0.008431673049926758
generate_one_block  0.011047601699829102
generate_one_block  0.011035680770874023
generate_one_block  0.012591123580932617
generate_one_block  0.009030818939208984
generate_one_block  0.010556459426879883
generate_one_block  0.010072708129882812
generate_one_block  0.012046337127685547
generate_one_block  0.011756420135498047
generate_one_block  0.013782978057861328
global_2_local spend time (sec) 0.0027179718017578125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.000698089599609375
A = g.adjacency_matrix() spent  0.0004315376281738281
auxiliary_graph
Graph(num_nodes=12342, num_edges=522067,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})[21:40:04] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2675 nodes and 519392 edges into 2 parts and get 80921 edge cuts

get remove nodes spent  0.008758068084716797
remove nodes length
9667
auxiliary_graph.remove_nodes spent  0.01732015609741211
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2675, num_edges=522067,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.024293184280395508

the counter of shared neighbor distribution
Counter({1.0: 476990, 2.0: 38788, 3.0: 3164, 4.0: 334, 5.0: 78, 6.0: 20, 7.0: 12, 8.0: 6})
519392
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 519389, 519390, 519391])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 476990, 2.0: 38788, 3.0: 3164, 4.0: 334, 5.0: 78, 6.0: 20, 7.0: 12, 8.0: 6})
Convert a graph into a bidirected graph: 0.015 seconds
Metis partitioning: 0.043 seconds
Split the graph: 0.041 seconds
Construct subgraphs: 0.028 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.12717175483703613
1337
1338
total k batches seeds list generation spend  0.3522069454193115
after graph partition
graph partition algorithm spend time 0.35680389404296875
1337
1338
time for parepare:  0.020732402801513672
local_output_nid generation:  0.00024437904357910156
local_in_edges_tensor generation:  0.0030307769775390625
mini_batch_src_global generation:  0.0005030632019042969
r_  generation:  0.0033113956451416016
local_output_nid generation:  0.00023031234741210938
local_in_edges_tensor generation:  0.0010952949523925781
mini_batch_src_global generation:  0.0005497932434082031
r_  generation:  0.0037496089935302734
----------------------check_connections_block total spend ----------------------------- 0.03905653953552246
generate_one_block  0.00800943374633789
generate_one_block  0.00716400146484375
----------===============-------------===============-------------the number of batches ***** 34

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006112575531005859  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 12.689938068389893
pseudo mini batch 0 input nodes size: 5230
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005886077880859375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005886077880859375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008791923522949219  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008812904357910156  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005257606506347656  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0053882598876953125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0053882598876953125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5230
output nodes number: 2764
edges number: 17535
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13938140869140625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13938236236572266  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0057926177978515625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 1 input nodes size: 5888
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0054607391357421875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0054607391357421875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008268356323242188  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008289337158203125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005362510681152344  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0054779052734375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0054779052734375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5888
output nodes number: 2802
edges number: 15487
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12269258499145508  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12269306182861328  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0056743621826171875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 2 input nodes size: 5486
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005368232727050781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005368232727050781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008274078369140625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008295059204101562  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005466461181640625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005593299865722656  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005593299865722656  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5486
output nodes number: 2784
edges number: 16959
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1334981918334961  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1334986686706543  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005789756774902344  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 3 input nodes size: 5132
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005463600158691406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005463600158691406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007910728454589844  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007931232452392578  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005004405975341797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005110263824462891  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005110263824462891  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5132
output nodes number: 2713
edges number: 14185
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11243200302124023  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11243247985839844  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005275249481201172  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 4 input nodes size: 5998
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004993915557861328  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004993915557861328  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007899761199951172  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007920265197753906  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005452632904052734  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005566120147705078  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005566120147705078  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5998
output nodes number: 2712
edges number: 15118
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12043619155883789  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1204366683959961  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005755424499511719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 5 input nodes size: 6027
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005452632904052734  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005452632904052734  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008326530456542969  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008347511291503906  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005421161651611328  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005524158477783203  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005524158477783203  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6027
output nodes number: 2790
edges number: 13721
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11045503616333008  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11045551300048828  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005715370178222656  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 6 input nodes size: 6206
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005432605743408203  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005432605743408203  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008391857147216797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008412837982177734  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0055179595947265625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005644798278808594  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005644798278808594  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6206
output nodes number: 2755
edges number: 16992
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1354055404663086  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1354060173034668  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0058441162109375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 7 input nodes size: 6670
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005512714385986328  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005512714385986328  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008693218231201172  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008714675903320312  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005734443664550781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0058612823486328125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0058612823486328125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6670
output nodes number: 2826
edges number: 16966
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1338343620300293  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1338348388671875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006081581115722656  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 8 input nodes size: 5378
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005745410919189453  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005745410919189453  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00830984115600586  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008330821990966797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0051288604736328125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00524139404296875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00524139404296875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5378
output nodes number: 2805
edges number: 14992
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11994028091430664  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11994075775146484  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0054225921630859375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 9 input nodes size: 5282
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005125522613525391  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005125522613525391  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008306026458740234  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008327007293701172  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005741596221923828  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005843639373779297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005843639373779297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5282
output nodes number: 2785
edges number: 13577
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10965824127197266  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10965871810913086  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0060138702392578125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 10 input nodes size: 6449
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005738735198974609  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005738735198974609  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008813858032226562  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0088348388671875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005633354187011719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005756378173828125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005756378173828125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6449
output nodes number: 2816
edges number: 16393
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12918472290039062  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12918519973754883  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005963802337646484  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 11 input nodes size: 5158
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005637645721435547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005637645721435547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00881814956665039  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008839130401611328  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0057430267333984375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005843162536621094  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005843162536621094  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5158
output nodes number: 2797
edges number: 13388
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10754251480102539  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1075429916381836  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006011009216308594  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 12 input nodes size: 5829
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005740642547607422  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005740642547607422  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008520126342773438  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008541107177734375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005339622497558594  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005466461181640625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005466461181640625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5829
output nodes number: 2760
edges number: 17020
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1355571746826172  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1355576515197754  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0056629180908203125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 13 input nodes size: 6525
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005333900451660156  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005333900451660156  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008514404296875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00853586196899414  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0057353973388671875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005855560302734375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005855560302734375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6525
output nodes number: 2837
edges number: 16114
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1291646957397461  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1291651725769043  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006068229675292969  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 14 input nodes size: 5244
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0057468414306640625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0057468414306640625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00824737548828125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008268356323242188  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005066394805908203  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005174160003662109  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005174160003662109  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5244
output nodes number: 2788
edges number: 14390
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11444568634033203  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11444616317749023  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005345344543457031  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 15 input nodes size: 4923
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005059242248535156  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005059242248535156  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00823974609375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008260726928710938  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0057392120361328125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005837440490722656  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005837440490722656  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 4923
output nodes number: 2806
edges number: 13172
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10650396347045898  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10650444030761719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0060062408447265625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 16 input nodes size: 7585
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005741596221923828  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005741596221923828  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009358406066894531  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009379386901855469  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0061779022216796875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006287574768066406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006287574768066406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 7585
output nodes number: 2775
edges number: 14632
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11912107467651367  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11912155151367188  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006481170654296875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 17 input nodes size: 6117
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006173610687255859  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006173610687255859  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009354114532470703  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009375572204589844  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005737781524658203  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005838871002197266  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005838871002197266  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6117
output nodes number: 2823
edges number: 13550
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10876941680908203  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10876989364624023  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0060253143310546875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 18 input nodes size: 7771
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00574493408203125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00574493408203125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009450435638427734  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009471893310546875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006269931793212891  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006393909454345703  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006393909454345703  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 7771
output nodes number: 2817
edges number: 16595
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13156652450561523  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13156700134277344  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006607532501220703  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 19 input nodes size: 7045
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006268978118896484  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006268978118896484  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0096282958984375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009649276733398438  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0059223175048828125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006023406982421875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006023406982421875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 7045
output nodes number: 2787
edges number: 13494
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10984516143798828  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10984563827514648  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006204128265380859  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 20 input nodes size: 6746
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005917549133300781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005917549133300781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009134292602539062  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0091552734375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005774974822998047  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005877017974853516  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005877017974853516  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6746
output nodes number: 2773
edges number: 13693
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11025047302246094  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11025094985961914  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006059169769287109  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 21 input nodes size: 6538
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005773067474365234  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005773067474365234  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008890628814697266  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0089111328125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005673408508300781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005764007568359375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005764007568359375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6538
output nodes number: 2720
edges number: 12132
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.09843635559082031  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.09843683242797852  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005926609039306641  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 22 input nodes size: 8702
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005665302276611328  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005665302276611328  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009814739227294922  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009834766387939453  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0066967010498046875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0068111419677734375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0068111419677734375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 8702
output nodes number: 2681
edges number: 15238
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12274503707885742  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12274551391601562  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007014751434326172  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 23 input nodes size: 7971
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00669097900390625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00669097900390625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.01049184799194336  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.01051187515258789  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006342411041259766  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006433963775634766  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006433963775634766  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 7971
output nodes number: 2675
edges number: 12239
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1000514030456543  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1000518798828125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006614208221435547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 24 input nodes size: 11519
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006341457366943359  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006341457366943359  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.011834144592285156  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.01185464859008789  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00803375244140625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008157730102539062  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008157730102539062  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 11519
output nodes number: 2711
edges number: 16634
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13540315628051758  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13540363311767578  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008404254913330078  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 25 input nodes size: 10885
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008039474487304688  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008039474487304688  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013229846954345703  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013250350952148438  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007737159729003906  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007863044738769531  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007863044738769531  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 10885
output nodes number: 2728
edges number: 16812
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13674545288085938  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13674592971801758  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00810384750366211  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 26 input nodes size: 10700
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007739543914794922  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007739543914794922  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.01284170150756836  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.01286172866821289  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007650852203369141  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007791996002197266  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007791996002197266  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 10700
output nodes number: 2675
edges number: 18911
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.15063095092773438  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.15063142776489258  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00803518295288086  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 27 input nodes size: 9287
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0076427459716796875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0076427459716796875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.01207113265991211  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.012091636657714844  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006969451904296875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007068634033203125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007068634033203125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 9287
output nodes number: 2698
edges number: 13291
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11018896102905273  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11018943786621094  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007272243499755859  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 28 input nodes size: 10692
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0069732666015625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0069732666015625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.012075424194335938  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.012095928192138672  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007647037506103516  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007770061492919922  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007770061492919922  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 10692
output nodes number: 2690
edges number: 16394
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1313309669494629  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1313314437866211  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008002758026123047  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 29 input nodes size: 10567
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007645606994628906  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007645606994628906  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.012684345245361328  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.012704849243164062  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007582187652587891  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007697582244873047  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007697582244873047  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 10567
output nodes number: 2697
edges number: 15462
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12717294692993164  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12717342376708984  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007924079895019531  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 30 input nodes size: 11511
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007583141326904297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007583141326904297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013072013854980469  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013092041015625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008032798767089844  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008169174194335938  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008169174194335938  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 11511
output nodes number: 2675
edges number: 18243
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.14557504653930664  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.14557552337646484  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008418083190917969  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 31 input nodes size: 12084
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008029460906982422  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008029460906982422  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013791561126708984  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013812541961669922  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008303642272949219  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008459091186523438  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008459091186523438  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 12084
output nodes number: 2801
edges number: 20817
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.16423368453979492  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.16423416137695312  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008755207061767578  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 32 input nodes size: 6236
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008322715759277344  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008322715759277344  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.011296272277832031  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.011306285858154297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005523204803466797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005590915679931641  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005590915679931641  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6236
output nodes number: 1337[21:40:17] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14381252 edges into 34 parts and get 3653473 edge cuts

edges number: 9040
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.07413768768310547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.07413816452026367  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005502223968505859  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 33 input nodes size: 7302
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005304813385009766  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005304813385009766  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008786678314208984  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00879669189453125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005813121795654297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005889415740966797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005889415740966797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 7302
output nodes number: 1338
edges number: 10228
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0835719108581543  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0835723876953125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006036281585693359  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006036281585693359  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006036281585693359  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004583141383002786 |0.0004221200942993164 |0.02363434959860409 |0.0001263127607457778 |0.022489063880022836 |0.004697084426879883 |
----------------------------------------------------------pseudo_mini_loss sum 3.268494129180908
Total (block generation + training)time/epoch 14.562438726425171
Training time/epoch 1.872222900390625
Training time without block to device /epoch 1.8578708171844482
Training time without total dataloading part /epoch 1.5771877765655518
load block tensor time/epoch 0.15582680702209473
block to device time/epoch 0.014352083206176758
input features size transfer per epoch 4.559755325317383e-06
blocks size to device per epoch 3.039836883544922e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  250683
Number of first layer input nodes during this epoch:  250683
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006035804748535156  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024517536163330078
global_2_local spend time (sec) 0.05321907997131348
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003464221954345703
A = g.adjacency_matrix() spent  0.00603485107421875
auxiliary_graph
Graph(num_nodes=145065, num_edges=14472193,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10748934745788574
remove nodes length
54124
auxiliary_graph.remove_nodes spent  0.7465369701385498
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14472193,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6349389553070068

the counter of shared neighbor distribution
Counter({1.0: 12980392, 2.0: 1183048, 3.0: 170858, 4.0: 34106, 5.0: 9200, 6.0: 2692, 7.0: 720, 8.0: 192, 9.0: 38, 10.0: 6})
14381252
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14381249, 14381250, 14381251])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12980392, 2.0: 1183048, 3.0: 170858, 4.0: 34106, 5.0: 9200, 6.0: 2692, 7.0: 720, 8.0: 192, 9.0: 38, 10.0: 6})
Convert a graph into a bidirected graph: 1.078 seconds
Metis partitioning: 3.486 seconds
Split the graph: 0.425 seconds
Construct subgraphs: 0.105 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.102074861526489
2735
2723
2709
2734
2711
2667
2726
2722
2731
2717
2753
2647
2701
2646
2673
2745
2664
2604
2659
2720
2618
2713
2625
2666
2705
2632
2654
2603
2598
2597
2596
2596
2755
2596
total k batches seeds list generation spend  11.196262836456299
after graph partition
graph partition algorithm spend time 11.277079105377197
2735
2723
2709
2734
2711
2667
2726
2722
2731
2717
2753
2647
2701
2646
2673
2745
2664
2604
2659
2720
2618
2713
2625
2666
2705
2632
2654
2603
2598
2597
2596
2596
2755
2596
partition_len_list
[6893, 6615, 4702, 5627, 5200, 5152, 6302, 5666, 6431, 5202, 6273, 6910, 5915, 4959, 5081, 5521, 5752, 8187, 9503, 6844, 7100, 7705, 5124, 5976, 5176, 10741, 11923, 9971, 10860, 9989, 10517, 12332, 11466, 10727]
shared_neighbor_graph_partition_s0 selection method  spend 11.390206813812256
time for parepare:  0.01921677589416504
local_output_nid generation:  0.0005016326904296875
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0008912086486816406
r_  generation:  0.0065479278564453125
local_output_nid generation:  0.0006203651428222656
local_in_edges_tensor generation:  0.0007092952728271484
mini_batch_src_global generation:  0.0007581710815429688
r_  generation:  0.0063114166259765625
local_output_nid generation:  0.0006632804870605469
local_in_edges_tensor generation:  0.0007016658782958984
mini_batch_src_global generation:  0.0005080699920654297
r_  generation:  0.005425214767456055
local_output_nid generation:  0.0006814002990722656
local_in_edges_tensor generation:  0.0006589889526367188
mini_batch_src_global generation:  0.0005609989166259766
r_  generation:  0.006253719329833984
local_output_nid generation:  0.0007085800170898438
local_in_edges_tensor generation:  0.0006334781646728516
mini_batch_src_global generation:  0.0005581378936767578
r_  generation:  0.00881648063659668
local_output_nid generation:  0.0007417201995849609
local_in_edges_tensor generation:  0.0006499290466308594
mini_batch_src_global generation:  0.0005130767822265625
r_  generation:  0.005288124084472656
local_output_nid generation:  0.0007159709930419922
local_in_edges_tensor generation:  0.0006537437438964844
mini_batch_src_global generation:  0.0006029605865478516
r_  generation:  0.00651860237121582
local_output_nid generation:  0.00069427490234375
local_in_edges_tensor generation:  0.0006570816040039062
mini_batch_src_global generation:  0.0005791187286376953
r_  generation:  0.0059168338775634766
local_output_nid generation:  0.0006852149963378906
local_in_edges_tensor generation:  0.0006935596466064453
mini_batch_src_global generation:  0.0006618499755859375
r_  generation:  0.0070018768310546875
local_output_nid generation:  0.0006573200225830078
local_in_edges_tensor generation:  0.0006246566772460938
mini_batch_src_global generation:  0.00054931640625
r_  generation:  0.005602836608886719
local_output_nid generation:  0.0006496906280517578
local_in_edges_tensor generation:  0.0006380081176757812
mini_batch_src_global generation:  0.0006251335144042969
r_  generation:  0.007207155227661133
local_output_nid generation:  0.0006010532379150391
local_in_edges_tensor generation:  0.0006306171417236328
mini_batch_src_global generation:  0.0005676746368408203
r_  generation:  0.005818367004394531
local_output_nid generation:  0.0005986690521240234
local_in_edges_tensor generation:  0.0006437301635742188
mini_batch_src_global generation:  0.0005693435668945312
r_  generation:  0.006368398666381836
local_output_nid generation:  0.0005748271942138672
local_in_edges_tensor generation:  0.0006034374237060547
mini_batch_src_global generation:  0.0004839897155761719
r_  generation:  0.00505828857421875
local_output_nid generation:  0.0005822181701660156
local_in_edges_tensor generation:  0.00063323974609375
mini_batch_src_global generation:  0.0006587505340576172
r_  generation:  0.006850242614746094
local_output_nid generation:  0.0005826950073242188
local_in_edges_tensor generation:  0.0007851123809814453
mini_batch_src_global generation:  0.0006210803985595703
r_  generation:  0.006970882415771484
local_output_nid generation:  0.0005528926849365234
local_in_edges_tensor generation:  0.000614166259765625
mini_batch_src_global generation:  0.0005857944488525391
r_  generation:  0.0064547061920166016
local_output_nid generation:  0.0005512237548828125
local_in_edges_tensor generation:  0.0006222724914550781
mini_batch_src_global generation:  0.0005705356597900391
r_  generation:  0.005654096603393555
local_output_nid generation:  0.0005424022674560547
local_in_edges_tensor generation:  0.0006029605865478516
mini_batch_src_global generation:  0.0005619525909423828
r_  generation:  0.0056192874908447266
local_output_nid generation:  0.0005779266357421875
local_in_edges_tensor generation:  0.0006189346313476562
mini_batch_src_global generation:  0.0006299018859863281
r_  generation:  0.005975961685180664
local_output_nid generation:  0.0005383491516113281
local_in_edges_tensor generation:  0.0006051063537597656
mini_batch_src_global generation:  0.0005090236663818359
r_  generation:  0.005319833755493164
local_output_nid generation:  0.0005507469177246094
local_in_edges_tensor generation:  0.0006375312805175781
mini_batch_src_global generation:  0.0005741119384765625
r_  generation:  0.006440639495849609
local_output_nid generation:  0.0005280971527099609
local_in_edges_tensor generation:  0.0005984306335449219
mini_batch_src_global generation:  0.0004916191101074219
r_  generation:  0.0055904388427734375
local_output_nid generation:  0.0005381107330322266
local_in_edges_tensor generation:  0.0006365776062011719
mini_batch_src_global generation:  0.00047278404235839844
r_  generation:  0.005268096923828125
local_output_nid generation:  0.0005588531494140625
local_in_edges_tensor generation:  0.0006039142608642578
mini_batch_src_global generation:  0.00048470497131347656
r_  generation:  0.005473613739013672
local_output_nid generation:  0.0005295276641845703
local_in_edges_tensor generation:  0.0006155967712402344
mini_batch_src_global generation:  0.0007269382476806641
r_  generation:  0.0069293975830078125
local_output_nid generation:  0.0005404949188232422
local_in_edges_tensor generation:  0.0006306171417236328
mini_batch_src_global generation:  0.0008199214935302734
r_  generation:  0.006530046463012695
local_output_nid generation:  0.00055694580078125
local_in_edges_tensor generation:  0.0006361007690429688
mini_batch_src_global generation:  0.000579833984375
r_  generation:  0.00585627555847168
local_output_nid generation:  0.0005393028259277344
local_in_edges_tensor generation:  0.0006353855133056641
mini_batch_src_global generation:  0.0006802082061767578
r_  generation:  0.007349967956542969
local_output_nid generation:  0.0005600452423095703
local_in_edges_tensor generation:  0.0006136894226074219
mini_batch_src_global generation:  0.00063323974609375
r_  generation:  0.0062029361724853516
local_output_nid generation:  0.0005414485931396484
local_in_edges_tensor generation:  0.0006008148193359375
mini_batch_src_global generation:  0.0005869865417480469
r_  generation:  0.0059583187103271484
local_output_nid generation:  0.0005414485931396484
local_in_edges_tensor generation:  0.0006115436553955078
mini_batch_src_global generation:  0.0008835792541503906
r_  generation:  0.007005929946899414
local_output_nid generation:  0.0005891323089599609
local_in_edges_tensor generation:  0.0006570816040039062
mini_batch_src_global generation:  0.0007526874542236328
r_  generation:  0.007827997207641602
local_output_nid generation:  0.0005557537078857422
local_in_edges_tensor generation:  0.0007135868072509766
mini_batch_src_global generation:  0.0007231235504150391
r_  generation:  0.007315397262573242
----------------------check_connections_block total spend ----------------------------- 0.35477519035339355
generate_one_block  0.017764568328857422
generate_one_block  0.010604381561279297
generate_one_block  0.008136272430419922
generate_one_block  0.00922250747680664
generate_one_block  0.008646488189697266
generate_one_block  0.007672786712646484
generate_one_block  0.009456872940063477
generate_one_block  0.008678674697875977
generate_one_block  0.010267257690429688
generate_one_block  0.008019208908081055
generate_one_block  0.010336875915527344
generate_one_block  0.009986400604248047
generate_one_block  0.015450477600097656
generate_one_block  0.00879526138305664
generate_one_block  0.010472774505615234
generate_one_block  0.01431417465209961
generate_one_block  0.009708166122436523
generate_one_block  0.009835004806518555
generate_one_block  0.009534597396850586
generate_one_block  0.008715629577636719
generate_one_block  0.00813150405883789
generate_one_block  0.00984644889831543
generate_one_block  0.007494211196899414
generate_one_block  0.007953882217407227
generate_one_block  0.007836580276489258
generate_one_block  0.010878324508666992
generate_one_block  0.011165857315063477
generate_one_block  0.009624719619750977
generate_one_block  0.01158595085144043
generate_one_block  0.009927988052368164
generate_one_block  0.009842395782470703
generate_one_block  0.011611223220825195
generate_one_block  0.012824535369873047
generate_one_block  0.011631965637207031
global_2_local spend time (sec) 0.002698183059692383
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0006906986236572266
A = g.adjacency_matrix() spent  0.00043773651123046875
auxiliary_graph
Graph(num_nodes=12332, num_edges=444420,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.008852481842041016
remove nodes length
9736
auxiliary_graph.remove_nodes spent  0.013526201248168945
after remove non output nodes the auxiliary_graph
Graph(num_nodes=2596, num_edges=444420,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.014810323715209961

the counter of shared neighbor distribution
Counter({1.0: 411106, 2.0: 27896, 3.0: 2422, 4.0: 298, 5.0: 90, 6.0: 10, 7.0: 2})
441824
--------------------------------------- new test ---------------------[21:40:18] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 2596 nodes and 441824 edges into 2 parts and get 46896 edge cuts

--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 441821, 441822, 441823])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 411106, 2.0: 27896, 3.0: 2422, 4.0: 298, 5.0: 90, 6.0: 10, 7.0: 2})
Convert a graph into a bidirected graph: 0.014 seconds
Metis partitioning: 0.036 seconds
Split the graph: 0.076 seconds
Construct subgraphs: 0.032 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.15797901153564453
1298
1298
total k batches seeds list generation spend  0.35175156593322754
after graph partition
graph partition algorithm spend time 0.35763978958129883
1298
1298
time for parepare:  0.038132667541503906
local_output_nid generation:  0.00036597251892089844
local_in_edges_tensor generation:  0.0007939338684082031
mini_batch_src_global generation:  0.0008544921875
r_  generation:  0.00657200813293457
local_output_nid generation:  0.0003097057342529297
local_in_edges_tensor generation:  0.000698089599609375
mini_batch_src_global generation:  0.0007693767547607422
r_  generation:  0.005532979965209961
----------------------check_connections_block total spend ----------------------------- 0.06182360649108887
generate_one_block  0.011689186096191406
generate_one_block  0.009255170822143555
----------===============-------------===============-------------the number of batches ***** 35

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006035804748535156  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 12.659844875335693
pseudo mini batch 0 input nodes size: 6893
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005812644958496094  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005812644958496094  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009099483489990234  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009119987487792969  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005628108978271484  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005752086639404297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005752086639404297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6893
output nodes number: 2735
edges number: 16525
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13075590133666992  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13075685501098633  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006167411804199219  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 1 input nodes size: 6615
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005836963653564453  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005836963653564453  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009318828582763672  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009339332580566406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006031990051269531  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0061473846435546875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0061473846435546875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6615
output nodes number: 2723
edges number: 15375
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12216329574584961  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12216377258300781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006341457366943359  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 2 input nodes size: 4702
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006030082702636719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006030082702636719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008272171020507812  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008292675018310547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004790306091308594  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004883766174316406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004883766174316406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 4702
output nodes number: 2709
edges number: 12509
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10033941268920898  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10033988952636719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005041599273681641  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 3 input nodes size: 5627
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004788398742675781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004788398742675781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008270263671875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008290767669677734  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006028175354003906  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006140708923339844  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006140708923339844  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5627
output nodes number: 2734
edges number: 15007
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11957883834838867  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11957931518554688  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006330013275146484  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 4 input nodes size: 5200
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006031990051269531  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006031990051269531  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008511543273925781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008532047271728516  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0050296783447265625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005135536193847656  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005135536193847656  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5200
output nodes number: 2711
edges number: 14081
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1127781867980957  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1127786636352539  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0053081512451171875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 5 input nodes size: 5152
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005026340484619141  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005026340484619141  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007483005523681641  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007503032684326172  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0050029754638671875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005093574523925781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005093574523925781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5152
output nodes number: 2667
edges number: 12052
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0969533920288086  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0969538688659668  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005246162414550781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 6 input nodes size: 6302
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004996299743652344  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004996299743652344  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008001327514648438  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008021831512451172  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005545139312744141  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005662441253662109  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005662441253662109  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6302
output nodes number: 2726
edges number: 15660
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1244344711303711  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1244349479675293  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005866527557373047  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 7 input nodes size: 5666
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005553722381591797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005553722381591797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008255481719970703  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008275985717773438  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005250453948974609  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005355358123779297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005355358123779297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5666
output nodes number: 2722
edges number: 14073
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11335563659667969  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11335611343383789  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0055332183837890625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 8 input nodes size: 6431
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005249977111816406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005249977111816406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008316516876220703  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008337020874023438  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005614757537841797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005743503570556641  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005743503570556641  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6431
output nodes number: 2731
edges number: 17280
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13573265075683594  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13573312759399414  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0059528350830078125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 9 input nodes size: 5202
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005616188049316406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005616188049316406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008096694946289062  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008117198944091797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005030155181884766  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005126476287841797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005126476287841797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5202
output nodes number: 2717
edges number: 12924
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10565423965454102  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10565471649169922  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005290985107421875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 10 input nodes size: 6273
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005028247833251953  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005028247833251953  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00809478759765625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008115768432617188  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005614757537841797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005748271942138672  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005748271942138672  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6273
output nodes number: 2753
edges number: 17810
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.14009904861450195  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.14009952545166016  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005965709686279297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 11 input nodes size: 6910
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005620002746582031  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005620002746582031  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008914947509765625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008934974670410156  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005847454071044922  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005949497222900391  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005949497222900391  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6910
output nodes number: 2647
edges number: 13661
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11021757125854492  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11021804809570312  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006117343902587891  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 12 input nodes size: 5915
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005831718444824219  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005831718444824219  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008898258209228516  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00891876220703125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005603790283203125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005718231201171875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005718231201171875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5915
output nodes number: 2701
edges number: 15325
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12307262420654297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12307310104370117  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005916118621826172  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 13 input nodes size: 4959
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005611896514892578  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005611896514892578  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007976531982421875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007996559143066406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004909515380859375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0049953460693359375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0049953460693359375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 4959
output nodes number: 2646
edges number: 11434
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.09318780899047852  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.09318828582763672  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005139827728271484  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 14 input nodes size: 5081
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004900932312011719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004900932312011719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007967472076416016  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007987499237060547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005602836608886719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00572967529296875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00572967529296875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5081
output nodes number: 2673
edges number: 16968
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1336808204650879  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1336812973022461  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005928993225097656  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 15 input nodes size: 5521
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005607128143310547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005607128143310547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00823974609375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008260250091552734  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005173683166503906  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00530242919921875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00530242919921875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5521
output nodes number: 2745
edges number: 17214
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13434171676635742  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13434219360351562  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0055141448974609375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 16 input nodes size: 5752
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005184173583984375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005184173583984375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008250713348388672  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008270740509033203  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005617618560791016  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005734920501708984  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005734920501708984  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5752
output nodes number: 2664
edges number: 15689
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1250290870666504  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1250295639038086  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005913257598876953  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 17 input nodes size: 8187
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0056056976318359375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0056056976318359375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009509563446044922  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00952911376953125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006442546844482422  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006546497344970703  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006546497344970703  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 8187
output nodes number: 2604
edges number: 13901
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11314916610717773  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11314964294433594  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006731986999511719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 18 input nodes size: 9503
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0064334869384765625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0064334869384765625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.01096487045288086  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.01098489761352539  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007061481475830078  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007165431976318359  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007165431976318359  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 9503
output nodes number: 2659
edges number: 13890
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11464738845825195  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11464786529541016  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007378578186035156  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 19 input nodes size: 6844
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007069587707519531  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007069587707519531  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.010333061218261719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.010353565216064453  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005802154541015625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0059051513671875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0059051513671875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6844
output nodes number: 2720
edges number: 13729
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1106557846069336  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1106562614440918  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006099224090576172  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 20 input nodes size: 7100
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005811214447021484  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005811214447021484  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009196758270263672  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00921630859375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005932331085205078  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006025791168212891  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006025791168212891  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 7100
output nodes number: 2618
edges number: 12490
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10187196731567383  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10187244415283203  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006186962127685547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 21 input nodes size: 7705
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005917549133300781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005917549133300781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00959157943725586  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.009612083435058594  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006206989288330078  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006321430206298828  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006321430206298828  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 7705
output nodes number: 2713
edges number: 15341
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.122222900390625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1222233772277832  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00653839111328125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 22 input nodes size: 5124
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006220817565917969  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.006220817565917969  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008664131164550781  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008684158325195312  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0049896240234375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005077362060546875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005077362060546875  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5124
output nodes number: 2625
edges number: 11718
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0944528579711914  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.09445333480834961  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005220890045166016  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 23 input nodes size: 5976
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004976749420166016  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.004976749420166016  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00782632827758789  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007846355438232422  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005383014678955078  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005474567413330078  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005474567413330078  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5976
output nodes number: 2666
edges number: 12255
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.09928703308105469  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.09928750991821289  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005647182464599609  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 24 input nodes size: 5176
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005389213562011719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005389213562011719  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007857322692871094  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007877826690673828  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005008220672607422  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005101680755615234  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005101680755615234  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 5176
output nodes number: 2705
edges number: 12489
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10040616989135742  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.10040664672851562  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005270481109619141  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 25 input nodes size: 10741
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005013942718505859  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005013942718505859  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.010306835174560547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.010326862335205078  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007838249206542969  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007961273193359375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007961273193359375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 10741
output nodes number: 2632
edges number: 16510
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13359880447387695  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.13359928131103516  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008183479309082031  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 26 input nodes size: 11923
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007827281951904297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007827281951904297  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013512611389160156  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013532638549804688  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008219718933105469  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008348464965820312  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008348464965820312  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 11923
output nodes number: 2654
edges number: 17156
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1377577781677246  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1377582550048828  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00859975814819336  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 27 input nodes size: 9971
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00822305679321289  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00822305679321289  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013515949249267578  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013535499572753906  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007830142974853516  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007937908172607422  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007937908172607422  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 9971
output nodes number: 2603
edges number: 14379
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11777877807617188  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.11777925491333008  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00814199447631836  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 28 input nodes size: 10860
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007822513580322266  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007822513580322266  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013000965118408203  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013020515441894531  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007708072662353516  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007848262786865234  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007848262786865234  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 10860
output nodes number: 2598
edges number: 18692
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1496124267578125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.1496129035949707  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008098125457763672  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 29 input nodes size: 9989
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007707118988037109  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007707118988037109  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013000011444091797  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013019561767578125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00782155990600586  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00793600082397461  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00793600082397461  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 9989
output nodes number: 2597
edges number: 15338
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12485074996948242  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12485122680664062  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008154869079589844  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 30 input nodes size: 10517
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00782155990600586  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00782155990600586  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.012836456298828125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.012856006622314453  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0075435638427734375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007655143737792969  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007655143737792969  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 10517
output nodes number: 2596
edges number: 14870
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12005949020385742  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.12005996704101562  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.00787496566772461  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 31 input nodes size: 11466
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0075435638427734375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0075435638427734375  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013010978698730469  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013031959533691406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007997512817382812  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008149147033691406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008149147033691406  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 11466
output nodes number: 2755
edges number: 20326
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.16199254989624023  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.16199302673339844  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008441448211669922  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 32 input nodes size: 10727
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008020877838134766  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008020877838134766  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013135910034179688  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.013155460357666016  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007667064666748047  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007805347442626953  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007805347442626953  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 10727
output nodes number: 2596
edges number: 18551
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.14635848999023438  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.14635896682739258  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008029937744140625  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes
Using backend: pytorch

pseudo mini batch 33 input nodes size: 7126
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007643699645996094  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.007643699645996094  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.011041641235351562  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.011051654815673828  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005917072296142578  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005992412567138672  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005992412567138672  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 7126
output nodes number: 1298
edges number: 10005
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.08018350601196289  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.0801839828491211  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005942821502685547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

pseudo mini batch 34 input nodes size: 6242
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005723476409912109  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005723476409912109  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008699893951416016  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.008709907531738281  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005301952362060547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005362987518310547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005362987518310547  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

input nodes number: 6242
output nodes number: 1298
edges number: 8187
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.06818389892578125  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.06818437576293945  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005486011505126953  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005486011505126953  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.1728515625 GB
    Memory Allocated: 0.005486011505126953  GigaBytes
Max Memory Allocated: 0.18187808990478516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004926415852137975 |0.00048772948128836496 |0.0317251409803118 |0.0001636777605329241 |0.024122653688703265 |0.0030798912048339844 |
----------------------------------------------------------pseudo_mini_loss sum 3.169161319732666
Total (block generation + training)time/epoch 14.775127649307251
Training time/epoch 2.357755184173584
Training time without block to device /epoch 2.340684652328491
Training time without total dataloading part /epoch 1.9634814262390137
load block tensor time/epoch 0.1724245548248291
block to device time/epoch 0.017070531845092773
input features size transfer per epoch 4.693865776062012e-06
blocks size to device per epoch 3.129243850708008e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  253378
Number of first layer input nodes during this epoch:  253378
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
