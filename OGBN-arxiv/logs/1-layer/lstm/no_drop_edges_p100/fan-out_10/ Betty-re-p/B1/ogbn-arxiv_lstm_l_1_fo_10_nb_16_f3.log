[21:38:54] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14089438 edges into 16 parts and get 2794070 edge cuts
main start at this time 1651873119.8122075
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0377347469329834
global_2_local spend time (sec) 0.040876150131225586
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0031211376190185547
A = g.adjacency_matrix() spent  0.005133390426635742
auxiliary_graph
Graph(num_nodes=145031, num_edges=14180379,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0928201675415039
remove nodes length
54090
auxiliary_graph.remove_nodes spent  0.7045681476593018
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14180379,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6219935417175293

the counter of shared neighbor distribution
Counter({1.0: 12728892, 2.0: 1148578, 3.0: 165860, 4.0: 33436, 5.0: 8994, 6.0: 2692, 7.0: 738, 8.0: 218, 9.0: 28, 10.0: 2})
14089438
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14089435, 14089436, 14089437])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12728892, 2.0: 1148578, 3.0: 165860, 4.0: 33436, 5.0: 8994, 6.0: 2692, 7.0: 738, 8.0: 218, 9.0: 28, 10.0: 2})
Convert a graph into a bidirected graph: 1.101 seconds
Metis partitioning: 3.176 seconds
Split the graph: 0.622 seconds
Construct subgraphs: 0.091 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.998103857040405
5641
5645
5559
5780
5762
5784
5813
5781
5768
5630
5623
5811
5684
5517
5605
5538
total k batches seeds list generation spend  11.116089820861816
after graph partition
graph partition algorithm spend time 11.19160532951355
5641
5645
5559
5780
5762
5784
5813
5781
5768
5630
5623
5811
5684
5517
5605
5538
partition_len_list
[11002, 11307, 9863, 10672, 11607, 10373, 12747, 12235, 12866, 10718, 16503, 15022, 20797, 19763, 21857, 19579]
shared_neighbor_graph_partition_s0 selection method  spend 11.285572290420532
time for parepare:  0.019133567810058594
local_output_nid generation:  0.0009944438934326172
local_in_edges_tensor generation:  0.0012865066528320312
mini_batch_src_global generation:  0.001409769058227539
r_  generation:  0.012344837188720703
local_output_nid generation:  0.0013227462768554688
local_in_edges_tensor generation:  0.0011391639709472656
mini_batch_src_global generation:  0.0015447139739990234
r_  generation:  0.01400899887084961
local_output_nid generation:  0.0013189315795898438
local_in_edges_tensor generation:  0.0010783672332763672
mini_batch_src_global generation:  0.0012388229370117188
r_  generation:  0.014214754104614258
local_output_nid generation:  0.0012826919555664062
local_in_edges_tensor generation:  0.0012466907501220703
mini_batch_src_global generation:  0.0015075206756591797
r_  generation:  0.014124870300292969
local_output_nid generation:  0.001293182373046875
local_in_edges_tensor generation:  0.001077890396118164
mini_batch_src_global generation:  0.001119852066040039
r_  generation:  0.012871026992797852
local_output_nid generation:  0.0012516975402832031
local_in_edges_tensor generation:  0.001085042953491211
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.014339923858642578
local_output_nid generation:  0.0012722015380859375
local_in_edges_tensor generation:  0.0010919570922851562
mini_batch_src_global generation:  0.0011942386627197266
r_  generation:  0.014990568161010742
local_output_nid generation:  0.001264333724975586
local_in_edges_tensor generation:  0.001074075698852539
mini_batch_src_global generation:  0.00139617919921875
r_  generation:  0.014740467071533203
local_output_nid generation:  0.0012710094451904297
local_in_edges_tensor generation:  0.0010814666748046875
mini_batch_src_global generation:  0.001377105712890625
r_  generation:  0.01284027099609375
local_output_nid generation:  0.0012443065643310547
local_in_edges_tensor generation:  0.0010440349578857422
mini_batch_src_global generation:  0.0010523796081542969
r_  generation:  0.012714862823486328
local_output_nid generation:  0.001207590103149414
local_in_edges_tensor generation:  0.0010552406311035156
mini_batch_src_global generation:  0.001116037368774414
r_  generation:  0.013741493225097656
local_output_nid generation:  0.0012395381927490234
local_in_edges_tensor generation:  0.0010800361633300781
mini_batch_src_global generation:  0.0011568069458007812
r_  generation:  0.013915777206420898
local_output_nid generation:  0.0012710094451904297
local_in_edges_tensor generation:  0.0011005401611328125
mini_batch_src_global generation:  0.0014414787292480469
r_  generation:  0.016756057739257812
local_output_nid generation:  0.0012624263763427734
local_in_edges_tensor generation:  0.0010590553283691406
mini_batch_src_global generation:  0.0014107227325439453
r_  generation:  0.014535903930664062
local_output_nid generation:  0.0012426376342773438
local_in_edges_tensor generation:  0.0011262893676757812
mini_batch_src_global generation:  0.0013518333435058594
r_  generation:  0.015109062194824219
local_output_nid generation:  0.0012390613555908203
local_in_edges_tensor generation:  0.0010242462158203125
mini_batch_src_global generation:  0.0014519691467285156
r_  generation:  0.01270604133605957
----------------------check_connections_block total spend ----------------------------- 0.36101412773132324
generate_one_block  0.024782657623291016
generate_one_block  0.018979549407958984
generate_one_block  0.018813371658325195
generate_one_block  0.017923355102539062
generate_one_block  0.019655704498291016
generate_one_block  0.017594575881958008
generate_one_block  0.01917862892150879
generate_one_block  0.018542051315307617
generate_one_block  0.01686716079711914
generate_one_block  0.015619993209838867
generate_one_block  0.018570661544799805
generate_one_block  0.018085479736328125
generate_one_block  0.023981571197509766
generate_one_block  0.021248579025268555
generate_one_block  0.021921157836914062
generate_one_block  0.019176006317138672
global_2_local spend time (sec) 0.004663228988647461
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007193088531494141
A = g.adjacency_matrix() spent  0.0006875991821289062
auxiliary_graph
Graph(num_nodes=21857, num_edges=1173467,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.013979196548461914
remove nodes length
16252
auxiliary_graph.remove_nodes spent  0.05925154685974121
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5605, num_edges=1173467,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.03584599494934082

the counter of shared neighbor distribution
Counter({1.0: 1111228, 2.0: 51802, 3.0: 4142, 4.0: 512, 5.0: 122, 6.0: 42, 7.0: 8, 8.0: 4, 9.0: 2})[21:38:56] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5605 nodes and 1167862 edges into 2 parts and get 63434 edge cuts

1167862
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 1167859, 1167860, 1167861])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 1111228, 2.0: 51802, 3.0: 4142, 4.0: 512, 5.0: 122, 6.0: 42, 7.0: 8, 8.0: 4, 9.0: 2})
Convert a graph into a bidirected graph: 0.036 seconds
Metis partitioning: 0.098 seconds
Split the graph: 0.174 seconds
Construct subgraphs: 0.045 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.35481810569763184
2779
2826
total k batches seeds list generation spend  0.8572795391082764
after graph partition
graph partition algorithm spend time 0.8819682598114014
2779
2826
time for parepare:  0.025632858276367188
local_output_nid generation:  0.000518798828125
local_in_edges_tensor generation:  0.0009167194366455078
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.008646726608276367
local_output_nid generation:  0.000537872314453125
local_in_edges_tensor generation:  0.0008563995361328125
mini_batch_src_global generation:  0.0013165473937988281
r_  generation:  0.01009511947631836
----------------------check_connections_block total spend ----------------------------- 0.05761289596557617
generate_one_block  0.01057291030883789
generate_one_block  0.012300968170166016
----------===============-------------===============-------------the number of batches ***** 17

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 11002
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.005776405334472656  GigaBytes
Max Memory Allocated: 0.005776405334472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.005818843841552734  GigaBytes
Max Memory Allocated: 0.005818843841552734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.005818843841552734  GigaBytes
Max Memory Allocated: 0.005818843841552734  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.006042003631591797  GigaBytes
Max Memory Allocated: 0.006042003631591797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.006042003631591797  GigaBytes
Max Memory Allocated: 0.006042003631591797  GigaBytes

input nodes number: 11002
output nodes number: 5641
edges number: 29847
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.23289251327514648  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.2328934669494629  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.007782936096191406  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

pseudo mini batch 1 input nodes size: 11307
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.007190704345703125  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.007190704345703125  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.01258230209350586  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.012624740600585938  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.007336139678955078  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.007581233978271484  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.007581233978271484  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

input nodes number: 11307
output nodes number: 5645
edges number: 32813
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.25643396377563477  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.25643444061279297  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007975578308105469  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

pseudo mini batch 2 input nodes size: 9863
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007337093353271484  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007337093353271484  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.012583255767822266  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.012624740600585938  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007190704345703125  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007441520690917969  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007441520690917969  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

input nodes number: 9863
output nodes number: 5559
edges number: 33625
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.2608966827392578  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.260897159576416  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007815837860107422  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

pseudo mini batch 3 input nodes size: 10672
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007177829742431641  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007177829742431641  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.01226663589477539  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.012310028076171875  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007022380828857422  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007255077362060547  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007255077362060547  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

input nodes number: 10672
output nodes number: 5780
edges number: 31185
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.24635744094848633  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.24635791778564453  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.0076656341552734375  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

pseudo mini batch 4 input nodes size: 11607
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.0070552825927734375  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.0070552825927734375  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.01258993148803711  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.012633323669433594  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007501125335693359  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007709980010986328  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007709980010986328  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

input nodes number: 11607
output nodes number: 5762
edges number: 27963
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.22209978103637695  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.22210025787353516  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008068084716796875  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

pseudo mini batch 5 input nodes size: 10373
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007498264312744141  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007498264312744141  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.012444496154785156  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.01248788833618164  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.006909847259521484  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007145404815673828  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007145404815673828  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

input nodes number: 10373
output nodes number: 5784
edges number: 31536
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.2458200454711914  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.2458205223083496  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007527351379394531  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

pseudo mini batch 6 input nodes size: 12747
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.006913185119628906  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.006913185119628906  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.01299142837524414  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.013034820556640625  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008045196533203125  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.00830078125  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.00830078125  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

input nodes number: 12747
output nodes number: 5813
edges number: 34257
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.2675771713256836  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.2675776481628418  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008721351623535156  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

pseudo mini batch 7 input nodes size: 12235
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008049488067626953  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008049488067626953  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.013883590698242188  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.013926982879638672  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007805347442626953  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008045673370361328  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008045673370361328  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

input nodes number: 12235
output nodes number: 5781
edges number: 32176
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.25643491744995117  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.2564353942871094  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.0084381103515625  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

pseudo mini batch 8 input nodes size: 12866
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007800579071044922  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007800579071044922  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.013935565948486328  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.013978958129882812  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.008101463317871094  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.008318901062011719  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.008318901062011719  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

input nodes number: 12866
output nodes number: 5768
edges number: 29084
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.23073816299438477  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.23073863983154297  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.00869607925415039  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

pseudo mini batch 9 input nodes size: 10718
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.008099555969238281  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.008099555969238281  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.013210296630859375  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.01325225830078125  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007073879241943359  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007277965545654297  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007277965545654297  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

input nodes number: 10718
output nodes number: 5630
edges number: 27370
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.21720314025878906  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.21720361709594727  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.0076045989990234375  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

pseudo mini batch 10 input nodes size: 16503
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007053375244140625  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007053375244140625  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.015338897705078125  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.015380859375  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.010228157043457031  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.0104522705078125  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.0104522705078125  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

input nodes number: 16503
output nodes number: 5623
edges number: 29987
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.2376108169555664  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.2376112937927246  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.010861396789550781  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

pseudo mini batch 11 input nodes size: 15022
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.010227203369140625  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.010227203369140625  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.01739025115966797  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.017433643341064453  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.009106159210205078  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.009334087371826172  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.009334087371826172  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

input nodes number: 15022
output nodes number: 5811
edges number: 30584
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.24119186401367188  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.24119234085083008  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.00976705551147461  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

pseudo mini batch 12 input nodes size: 20797
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.00913381576538086  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.00913381576538086  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.01905059814453125  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.019093036651611328  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.0118865966796875  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.012197494506835938  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.012197494506835938  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

input nodes number: 20797
output nodes number: 5684
edges number: 41658
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.3233771324157715  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.3233776092529297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.012708663940429688  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 13 input nodes size: 19763
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.011868000030517578  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.011868000030517578  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.021291732788085938  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.02133321762084961  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.01137399673461914  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.011632442474365234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.011632442474365234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 19763
output nodes number: 5517
edges number: 34652
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.27248620986938477  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.27248668670654297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.01207590103149414  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 14 input nodes size: 19579
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.011349201202392578  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.011349201202392578  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.020685195922851562  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.020726680755615234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.011261463165283203  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.011487483978271484  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.011487483978271484  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 19579
output nodes number: 5538
edges number: 30279
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.24388647079467773  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.24388694763183594  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.01192474365234375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 15 input nodes size: 10538
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.011264324188232422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.011264324188232422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.016289234161376953  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.01631021499633789  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.006932735443115234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007052898406982422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007052898406982422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 10538
output nodes number: 2779
edges number: 16072
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.13110733032226562  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.13110780715942383  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.0068721771240234375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 16 input nodes size: 13085
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.006521701812744141  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.006521701812744141  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.012761116027832031  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.012782573699951172  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007736682891845703  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007888317108154297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007888317108154297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 13085
output nodes number: 2826
edges number: 20326
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.16040563583374023  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.16040611267089844  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.00817728042602539  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.00923776626586914  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.00923776626586914  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009475553736967198 |0.02224549125222599 |0.0573574795442469 |0.0001700906192555147 |0.024732211056877586 |0.009078264236450195 |
----------------------------------------------------------pseudo_mini_loss sum 3.837966203689575
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  228677
Number of first layer input nodes during this epoch:  228677
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.009237289428710938  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028851032257080078
global_2_local spend time (sec) 0.062239646911621094
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004183530807495117
A = g.adjacency_matrix() spent  0.004676342010498047
auxiliary_graph
Graph(num_nodes=144933, num_edges=14328133,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.1499018669128418
remove nodes length
53992
auxiliary_graph.remove_nodes spent  0.698185920715332
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14328133,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6210262775421143

the counter of shared neighbor distribution
Counter({1.0: 12862168, 2.0: 1164718, 3.0: 164710, 4.0: 33108, 5.0: 8804, 6.0: 2640, 7.0: 800, 8.0: 210, 9.0: 32, 10.0: 2})
14237192
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------[21:39:09] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14237192 edges into 17 parts and get 2981545 edge cuts
[21:39:11] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5193 nodes and 944712 edges into 2 parts and get 69309 edge cuts


before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14237189, 14237190, 14237191])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12862168, 2.0: 1164718, 3.0: 164710, 4.0: 33108, 5.0: 8804, 6.0: 2640, 7.0: 800, 8.0: 210, 9.0: 32, 10.0: 2})
Convert a graph into a bidirected graph: 1.050 seconds
Metis partitioning: 3.133 seconds
Split the graph: 0.778 seconds
Construct subgraphs: 0.107 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.076646566390991
5485
5483
5462
5449
5203
5454
5473
5495
5194
5257
5365
5268
5297
5230
5220
5413
5193
total k batches seeds list generation spend  11.088573694229126
after graph partition
graph partition algorithm spend time 11.16895055770874
5485
5483
5462
5449
5203
5454
5473
5495
5194
5257
5365
5268
5297
5230
5220
5413
5193
partition_len_list
[11333, 10888, 10371, 9538, 9674, 10950, 11531, 10782, 14179, 12062, 12085, 11165, 19725, 18440, 19094, 19175, 20500]
shared_neighbor_graph_partition_s0 selection method  spend 11.29238510131836
time for parepare:  0.019277334213256836
local_output_nid generation:  0.0009799003601074219
local_in_edges_tensor generation:  0.0012421607971191406
mini_batch_src_global generation:  0.0020971298217773438
r_  generation:  0.01575160026550293
local_output_nid generation:  0.0012693405151367188
local_in_edges_tensor generation:  0.0011043548583984375
mini_batch_src_global generation:  0.0016274452209472656
r_  generation:  0.013582706451416016
local_output_nid generation:  0.0012056827545166016
local_in_edges_tensor generation:  0.0010657310485839844
mini_batch_src_global generation:  0.00115966796875
r_  generation:  0.012569665908813477
local_output_nid generation:  0.0011341571807861328
local_in_edges_tensor generation:  0.00101470947265625
mini_batch_src_global generation:  0.0011074542999267578
r_  generation:  0.012129783630371094
local_output_nid generation:  0.0010600090026855469
local_in_edges_tensor generation:  0.000995635986328125
mini_batch_src_global generation:  0.0010852813720703125
r_  generation:  0.012794971466064453
local_output_nid generation:  0.0010693073272705078
local_in_edges_tensor generation:  0.0013108253479003906
mini_batch_src_global generation:  0.0021457672119140625
r_  generation:  0.01566028594970703
local_output_nid generation:  0.0010571479797363281
local_in_edges_tensor generation:  0.001077890396118164
mini_batch_src_global generation:  0.0012781620025634766
r_  generation:  0.012947797775268555
local_output_nid generation:  0.0010743141174316406
local_in_edges_tensor generation:  0.0009746551513671875
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.013376235961914062
local_output_nid generation:  0.0010635852813720703
local_in_edges_tensor generation:  0.0009264945983886719
mini_batch_src_global generation:  0.0011026859283447266
r_  generation:  0.011597633361816406
local_output_nid generation:  0.0011019706726074219
local_in_edges_tensor generation:  0.0009255409240722656
mini_batch_src_global generation:  0.0009770393371582031
r_  generation:  0.010389566421508789
local_output_nid generation:  0.001074075698852539
local_in_edges_tensor generation:  0.0009443759918212891
mini_batch_src_global generation:  0.0010516643524169922
r_  generation:  0.011356353759765625
local_output_nid generation:  0.001005411148071289
local_in_edges_tensor generation:  0.0009262561798095703
mini_batch_src_global generation:  0.0009918212890625
r_  generation:  0.011080741882324219
local_output_nid generation:  0.0009818077087402344
local_in_edges_tensor generation:  0.0009467601776123047
mini_batch_src_global generation:  0.00138092041015625
r_  generation:  0.012563943862915039
local_output_nid generation:  0.0009999275207519531
local_in_edges_tensor generation:  0.0010106563568115234
mini_batch_src_global generation:  0.0012238025665283203
r_  generation:  0.01295924186706543
local_output_nid generation:  0.001049041748046875
local_in_edges_tensor generation:  0.0010972023010253906
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.011960268020629883
local_output_nid generation:  0.0010828971862792969
local_in_edges_tensor generation:  0.0011363029479980469
mini_batch_src_global generation:  0.0023050308227539062
r_  generation:  0.016787290573120117
local_output_nid generation:  0.0010783672332763672
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.002110004425048828
r_  generation:  0.01604485511779785
----------------------check_connections_block total spend ----------------------------- 0.36234235763549805
generate_one_block  0.02687215805053711
generate_one_block  0.019022703170776367
generate_one_block  0.0161590576171875
generate_one_block  0.01568746566772461
generate_one_block  0.016225814819335938
generate_one_block  0.01850605010986328
generate_one_block  0.018618106842041016
generate_one_block  0.01779484748840332
generate_one_block  0.016434669494628906
generate_one_block  0.014202356338500977
generate_one_block  0.015267133712768555
generate_one_block  0.0149688720703125
generate_one_block  0.01944756507873535
generate_one_block  0.0187833309173584
generate_one_block  0.018072128295898438
generate_one_block  0.02239513397216797
generate_one_block  0.025594711303710938
global_2_local spend time (sec) 0.004619121551513672
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007207393646240234
A = g.adjacency_matrix() spent  0.0006799697875976562
auxiliary_graph
Graph(num_nodes=20500, num_edges=949905,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.013554096221923828
remove nodes length
15307
auxiliary_graph.remove_nodes spent  0.04244637489318848
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5193, num_edges=949905,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.023608684539794922

the counter of shared neighbor distribution
Counter({1.0: 862016, 2.0: 73820, 3.0: 7410, 4.0: 1030, 5.0: 298, 6.0: 82, 7.0: 36, 8.0: 18, 9.0: 2})
944712
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 944709, 944710, 944711])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 862016, 2.0: 73820, 3.0: 7410, 4.0: 1030, 5.0: 298, 6.0: 82, 7.0: 36, 8.0: 18, 9.0: 2})
Convert a graph into a bidirected graph: 0.031 seconds
Metis partitioning: 0.092 seconds
Split the graph: 0.107 seconds
Construct subgraphs: 0.038 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.27086472511291504
2596
2597
total k batches seeds list generation spend  0.6660518646240234
after graph partition
graph partition algorithm spend time 0.6746852397918701
2596
2597
time for parepare:  0.02907729148864746
local_output_nid generation:  0.0005395412445068359
local_in_edges_tensor generation:  0.003687143325805664
mini_batch_src_global generation:  0.0011725425720214844
r_  generation:  0.009414434432983398
local_output_nid generation:  0.0005130767822265625
local_in_edges_tensor generation:  0.0009748935699462891
mini_batch_src_global generation:  0.0012705326080322266
r_  generation:  0.009706735610961914
----------------------check_connections_block total spend ----------------------------- 0.06636214256286621
generate_one_block  0.012646675109863281
generate_one_block  0.011812925338745117
----------===============-------------===============-------------the number of batches ***** 18

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.009237289428710938  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 12.826294422149658
pseudo mini batch 0 input nodes size: 11333
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008803367614746094  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008803367614746094  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.01420736312866211  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.014248371124267578  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007987499237060547  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008237361907958984  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008237361907958984  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 11333
output nodes number: 5485
edges number: 33442
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.26074981689453125  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.26075077056884766  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.009030818939208984  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 1 input nodes size: 10888
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.00838470458984375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.00838470458984375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.013576507568359375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.013617515563964844  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.00817251205444336  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.00840139389038086  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.00840139389038086  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 10888
output nodes number: 5483
edges number: 30658
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.24094772338867188  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.24094820022583008  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008772850036621094  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 2 input nodes size: 10371
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008172035217285156  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008172035217285156  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.013117313385009766  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.013158321380615234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.00792551040649414  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008132457733154297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008132457733154297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 10371
output nodes number: 5462
edges number: 27758
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.21996402740478516  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.21996450424194336  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008475303649902344  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 3 input nodes size: 9538
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007922172546386719  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007922172546386719  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.013113975524902344  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.013154983520507812  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008168697357177734  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008367061614990234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008367061614990234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 9538
output nodes number: 5449
edges number: 26534
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.21251726150512695  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.21251773834228516  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008696556091308594  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 4 input nodes size: 9674
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008166790008544922  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008166790008544922  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.012779712677001953  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.01281881332397461  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007586002349853516  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007803440093994141  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007803440093994141  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 9674
output nodes number: 5203
edges number: 29139
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.2306208610534668  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.230621337890625  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008115291595458984  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 5 input nodes size: 10950
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007549285888671875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.007549285888671875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.012770652770996094  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.012811660766601562  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008159637451171875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008410453796386719  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3642578125 GB
    Memory Allocated: 0.008410453796386719  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 10950
output nodes number: 5454
edges number: 33541
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.260223388671875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.2602238655090332  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00884246826171875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 6 input nodes size: 11531
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008197307586669922  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008197307586669922  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.013695716857910156  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.013736724853515625  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008474349975585938  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00870513916015625  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00870513916015625  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 11531
output nodes number: 5473
edges number: 30865
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.2447338104248047  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.2447342872619629  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00908660888671875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 7 input nodes size: 10782
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008477210998535156  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008477210998535156  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.01361846923828125  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.013659477233886719  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008120059967041016  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008357524871826172  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008357524871826172  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 10782
output nodes number: 5495
edges number: 31869
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.24990606307983398  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.2499065399169922  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008740425109863281  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 8 input nodes size: 14179
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008123397827148438  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008123397827148438  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.014884471893310547  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.014923572540283203  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00974130630493164  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.009943485260009766  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.009943485260009766  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 14179
output nodes number: 5194
edges number: 27083
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.2159881591796875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.2159886360168457  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.010265350341796875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 9 input nodes size: 12062
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.009696483612060547  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.009696483612060547  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.01544809341430664  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.0154876708984375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008687496185302734  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00886392593383789  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00886392593383789  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 12062
output nodes number: 5257
edges number: 23676
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.1899571418762207  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.1899576187133789  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.009199142456054688  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 10 input nodes size: 12085
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008696556091308594  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008696556091308594  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.01445913314819336  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.014499187469482422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008708000183105469  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00890350341796875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00890350341796875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 12085
output nodes number: 5365
edges number: 26205
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.2085728645324707  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.2085733413696289  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.009265422821044922  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 11 input nodes size: 11165
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008724212646484375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008724212646484375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.014475822448730469  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.014515399932861328  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.0087127685546875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008905410766601562  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008905410766601562  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 11165
output nodes number: 5268
edges number: 25736
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.20533323287963867  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.20533370971679688  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.009226799011230469  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 12 input nodes size: 19725
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008698463439941406  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008698463439941406  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.018104076385498047  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.018143653869628906  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012352466583251953  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012588024139404297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012588024139404297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 19725
output nodes number: 5297
edges number: 31499
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.2515707015991211  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.2515711784362793  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.013034820556640625  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 13 input nodes size: 18440
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012356758117675781  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012356758117675781  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.021149635314941406  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.021188735961914062  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.011743545532226562  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.011974334716796875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.011974334716796875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 18440
output nodes number: 5230
edges number: 30938
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.25087451934814453  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.25087499618530273  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.01239156723022461  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 14 input nodes size: 19094
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.011733531951904297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.011733531951904297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.020838260650634766  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.020877361297607422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.01204538345336914  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012262821197509766  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012262821197509766  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 19094
output nodes number: 5220
edges number: 29130
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.23682403564453125  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.23682451248168945  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.0126800537109375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 15 input nodes size: 19175
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012043952941894531  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012043952941894531  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.021187305450439453  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.02122783660888672  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012084007263183594  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012371063232421875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012371063232421875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 19175
output nodes number: 5413
edges number: 38525
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.30875062942504883  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.30875110626220703  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012890815734863281  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 16 input nodes size: 11537
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012112617492675781  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012112617492675781  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.017613887786865234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.017633438110351562  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008449554443359375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008580207824707031  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008580207824707031  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 11537
output nodes number: 2596
edges number: 17467
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.14057493209838867  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.14057540893554688  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008407115936279297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 17 input nodes size: 11749
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008029937744140625  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008029937744140625  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.01363229751586914  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.013651847839355469  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008131027221679688  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008275985717773438  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008275985717773438  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 11749
output nodes number: 2597
edges number: 19349
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.15323543548583984  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.15323591232299805  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008538246154785156  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008538246154785156  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008538246154785156  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0057482851876152884 |0.0007021559609307183 |0.02800880538092719 |0.0001461505889892578 |0.024560014406840008 |0.003347158432006836 |
----------------------------------------------------------pseudo_mini_loss sum 3.268493413925171
Total (block generation + training)time/epoch 13.988844156265259
Training time/epoch 1.1622741222381592
Training time without block to device /epoch 1.1496353149414062
Training time without total dataloading part /epoch 0.952216625213623
load block tensor time/epoch 0.1034691333770752
block to device time/epoch 0.01263880729675293
input features size transfer per epoch 2.4139881134033203e-06
blocks size to device per epoch 1.6093254089355469e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  234278
Number of first layer input nodes during this epoch:  234278
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008537769317626953  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes
[21:39:23] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14381252 edges into 18 parts and get 2917667 edge cuts

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025580167770385742
global_2_local spend time (sec) 0.06271600723266602
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0032339096069335938
A = g.adjacency_matrix() spent  0.004338741302490234
auxiliary_graph
Graph(num_nodes=145065, num_edges=14472193,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09968876838684082
remove nodes length
54124
auxiliary_graph.remove_nodes spent  0.6966941356658936
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14472193,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6290631294250488

the counter of shared neighbor distribution
Counter({1.0: 12980392, 2.0: 1183048, 3.0: 170858, 4.0: 34106, 5.0: 9200, 6.0: 2692, 7.0: 720, 8.0: 192, 9.0: 38, 10.0: 6})
14381252
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14381249, 14381250, 14381251])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12980392, 2.0: 1183048, 3.0: 170858, 4.0: 34106, 5.0: 9200, 6.0: 2692, 7.0: 720, 8.0: 192, 9.0: 38, 10.0: 6})
Convert a graph into a bidirected graph: 0.990 seconds
Metis partitioning: 3.169 seconds
Split the graph: 0.613 seconds
Construct subgraphs: 0.154 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.93341588973999
5185
5114
5157
5152
5087
5138
4994
5188
5064
4958
4980
4956
4994
4936
5032
4904
4904
5198
total k batches seeds list generation spend  10.930731058120728
after graph partition
graph partition algorithm spend time 11.011505603790283
5185
5114
5157
5152
5087
5138
4994
5188
5064
4958
4980
4956
4994
4936
5032
4904
4904
5198
partition_len_list
[12939, 9497, 9428, 11360, 9733, 9038, 10628, 10365, 8943, 11498, 13961, 10840, 9986, 17696, 19621, 16720, 19637, 18503]
shared_neighbor_graph_partition_s0 selection method  spend 11.133337259292603
time for parepare:  0.020888090133666992
local_output_nid generation:  0.0012667179107666016
local_in_edges_tensor generation:  0.001233816146850586
mini_batch_src_global generation:  0.0015871524810791016
r_  generation:  0.01267695426940918
local_output_nid generation:  0.0013494491577148438
local_in_edges_tensor generation:  0.0010008811950683594
mini_batch_src_global generation:  0.0012676715850830078
r_  generation:  0.010789632797241211
local_output_nid generation:  0.0012292861938476562
local_in_edges_tensor generation:  0.0009887218475341797
mini_batch_src_global generation:  0.0010471343994140625
r_  generation:  0.011903762817382812
local_output_nid generation:  0.0011546611785888672
local_in_edges_tensor generation:  0.0009505748748779297
mini_batch_src_global generation:  0.0010731220245361328
r_  generation:  0.011498689651489258
local_output_nid generation:  0.0010433197021484375
local_in_edges_tensor generation:  0.0009469985961914062
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.011967897415161133
local_output_nid generation:  0.0010366439819335938
local_in_edges_tensor generation:  0.0009427070617675781
mini_batch_src_global generation:  0.0009999275207519531
r_  generation:  0.012989521026611328
local_output_nid generation:  0.0011322498321533203
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.0011000633239746094
r_  generation:  0.011998414993286133
local_output_nid generation:  0.0011186599731445312
local_in_edges_tensor generation:  0.0012235641479492188
mini_batch_src_global generation:  0.00122833251953125
r_  generation:  0.013169527053833008
local_output_nid generation:  0.001070261001586914
local_in_edges_tensor generation:  0.0009410381317138672
mini_batch_src_global generation:  0.0010945796966552734
r_  generation:  0.012338399887084961
local_output_nid generation:  0.000995635986328125
local_in_edges_tensor generation:  0.0009458065032958984
mini_batch_src_global generation:  0.0009768009185791016
r_  generation:  0.01081085205078125
local_output_nid generation:  0.001003265380859375
local_in_edges_tensor generation:  0.0009353160858154297
mini_batch_src_global generation:  0.0010056495666503906
r_  generation:  0.011062145233154297
local_output_nid generation:  0.0010063648223876953
local_in_edges_tensor generation:  0.0009045600891113281
mini_batch_src_global generation:  0.0008957386016845703
r_  generation:  0.00963902473449707
local_output_nid generation:  0.0009746551513671875
local_in_edges_tensor generation:  0.0021162033081054688
mini_batch_src_global generation:  0.0008914470672607422
r_  generation:  0.010023117065429688
local_output_nid generation:  0.0010802745819091797
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.012117385864257812
local_output_nid generation:  0.0010716915130615234
local_in_edges_tensor generation:  0.0009589195251464844
mini_batch_src_global generation:  0.001310110092163086
r_  generation:  0.012888193130493164
local_output_nid generation:  0.0010769367218017578
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.001102447509765625
r_  generation:  0.011974334716796875
local_output_nid generation:  0.0010769367218017578
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.0011906623840332031
r_  generation:  0.012871026992797852
local_output_nid generation:  0.0011260509490966797
local_in_edges_tensor generation:  0.0011487007141113281
mini_batch_src_global generation:  0.0023119449615478516
r_  generation:  0.01883721351623535
----------------------check_connections_block total spend ----------------------------- 0.35458898544311523
generate_one_block  0.027601242065429688
generate_one_block  0.015877962112426758
generate_one_block  0.015134334564208984
generate_one_block  0.015938758850097656
generate_one_block  0.015964269638061523
generate_one_block  0.017226696014404297
generate_one_block  0.01632833480834961
generate_one_block  0.017715930938720703
generate_one_block  0.016247272491455078
generate_one_block  0.014052152633666992
generate_one_block  0.0158078670501709
generate_one_block  0.013161420822143555
generate_one_block  0.013154268264770508
generate_one_block  0.019565582275390625
generate_one_block  0.019786357879638672
generate_one_block  0.0165250301361084
generate_one_block  0.019474029541015625
generate_one_block  0.023173093795776367
global_2_local spend time (sec) 0.004227161407470703
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007419586181640625
A = g.adjacency_matrix() spent  0.0005004405975341797
auxiliary_graph
Graph(num_nodes=19637, num_edges=918262,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.012485504150390625
remove nodes length
14733
auxiliary_graph.remove_nodes spent  0.033678531646728516
after remove non output nodes the auxiliary_graph
Graph(num_nodes=4904, num_edges=918262,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.030060291290283203

the counter of shared neighbor distribution
Counter({1.0: 836832, 2.0: 67780, 3.0: 7464, 4.0: 1012, 5.0: 212, 6.0: 34, 7.0: 12, 8.0: 12})
913358
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 913355, 913356, 913357])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 836832, 2.0: 67780, 3.0: 7464, 4.0: 1012, 5.0: 212, 6.0: 34, 7.0: 12, 8.0: 12})[21:39:25] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 4904 nodes and 913358 edges into 2 parts and get 98077 edge cuts

Convert a graph into a bidirected graph: 0.031 seconds
Metis partitioning: 0.088 seconds
Split the graph: 0.074 seconds
Construct subgraphs: 0.043 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.23830175399780273
2452
2452
total k batches seeds list generation spend  0.6383059024810791
after graph partition
graph partition algorithm spend time 0.6553430557250977
2452
2452
time for parepare:  0.03490805625915527
local_output_nid generation:  0.0006048679351806641
local_in_edges_tensor generation:  0.001398324966430664
mini_batch_src_global generation:  0.0012366771697998047
r_  generation:  0.009977102279663086
local_output_nid generation:  0.0005767345428466797
local_in_edges_tensor generation:  0.0010869503021240234
mini_batch_src_global generation:  0.0014259815216064453
r_  generation:  0.010769128799438477
----------------------check_connections_block total spend ----------------------------- 0.0719749927520752
generate_one_block  0.01621532440185547
generate_one_block  0.01557612419128418
----------===============-------------===============-------------the number of batches ***** 19

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008537769317626953  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 12.738251328468323
pseudo mini batch 0 input nodes size: 12939
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008130073547363281  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008130073547363281  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.014299869537353516  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.014338970184326172  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008717060089111328  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008952617645263672  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008952617645263672  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 12939
output nodes number: 5185
edges number: 31570
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.24660253524780273  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.24660348892211914  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.009730339050292969  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 1 input nodes size: 9497
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.009103775024414062  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.009103775024414062  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.01363229751586914  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.01367044448852539  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.0074615478515625  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007651329040527344  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007651329040527344  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 9497
output nodes number: 5114
edges number: 25392
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.20242929458618164  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.20242977142333984  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00795888900756836  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 2 input nodes size: 9428
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007451057434082031  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007451057434082031  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.011946678161621094  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.011985301971435547  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007418632507324219  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007616996765136719  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007616996765136719  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 9428
output nodes number: 5157
edges number: 26605
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.20960617065429688  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.20960664749145508  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007950305938720703  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 3 input nodes size: 11360
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007424831390380859  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007424831390380859  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.01284170150756836  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012880325317382812  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008346080780029297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008553028106689453  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008553028106689453  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 11360
output nodes number: 5152
edges number: 27694
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.21976280212402344  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.21976327896118164  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00890207290649414  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 4 input nodes size: 9733
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00834512710571289  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00834512710571289  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.01343536376953125  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.0134735107421875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008018016815185547  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00823354721069336  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00823354721069336  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 9733
output nodes number: 5087
edges number: 28831
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.22546815872192383  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.22546863555908203  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008569717407226562  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 5 input nodes size: 9038
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008008480072021484  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008008480072021484  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012318134307861328  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012356758117675781  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007228374481201172  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007428646087646484  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007428646087646484  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 9038
output nodes number: 5138
edges number: 26835
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.21215248107910156  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.21215295791625977  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007762432098388672  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 6 input nodes size: 10628
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007236003875732422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007236003875732422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012303829193115234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012341499328613281  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007993221282958984  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00821065902709961  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.00821065902709961  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 10628
output nodes number: 4994
edges number: 29101
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.2319498062133789  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.2319502830505371  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008543014526367188  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 7 input nodes size: 10365
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007971763610839844  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007971763610839844  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.012914180755615234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.01295328140258789  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.007847785949707031  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008090972900390625  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3681640625 GB
    Memory Allocated: 0.008090972900390625  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 10365
output nodes number: 5188
edges number: 32557
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.25254297256469727  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.25254344940185547  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.0084991455078125  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 8 input nodes size: 8943
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.007876873016357422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.007876873016357422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.013088226318359375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.013126373291015625  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008144855499267578  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.00836801528930664  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.00836801528930664  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 8943
output nodes number: 5064
edges number: 29888
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.23350763320922852  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.23350811004638672  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008696556091308594  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 9 input nodes size: 11498
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008126258850097656  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008126258850097656  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.013608932495117188  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.013646125793457031  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008396625518798828  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.00857400894165039  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.00857400894165039  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 11498
output nodes number: 4958
edges number: 23684
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.1901259422302246  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.1901264190673828  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008877277374267578  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 10 input nodes size: 13961
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008380889892578125  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008380889892578125  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.015038013458251953  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.015075206756591797  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.009555339813232422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.009752750396728516  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.009752750396728516  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 13961
output nodes number: 4980
edges number: 26411
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.2106919288635254  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.2106924057006836  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.010113716125488281  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 11 input nodes size: 10840
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.009558677673339844  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.009558677673339844  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.015041351318359375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.015078544616699219  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008384227752685547  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008548259735107422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008548259735107422  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 10840
output nodes number: 4956
edges number: 21948
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.17775583267211914  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.17775630950927734  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008845329284667969  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 12 input nodes size: 9986
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008380413055419922  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008380413055419922  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.013142108917236328  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.013179779052734375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.007659912109375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.007825851440429688  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.007825851440429688  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 9986
output nodes number: 4994
edges number: 22197
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.17934894561767578  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.17934942245483398  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008129119873046875  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 13 input nodes size: 17696
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.0076656341552734375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.0076656341552734375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.0169525146484375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.016989707946777344  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.01219034194946289  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.012415409088134766  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.012415409088134766  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 17696
output nodes number: 4936
edges number: 30124
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.23983383178710938  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.23983430862426758  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.012819766998291016  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 14 input nodes size: 19621
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.012181758880615234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.012181758880615234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.022426128387451172  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.02246379852294922  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.013139724731445312  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.0133819580078125  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.0133819580078125  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 19621
output nodes number: 5032
edges number: 32444
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.25917625427246094  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.25917673110961914  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.013841629028320312  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 15 input nodes size: 16720
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.013154029846191406  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.013154029846191406  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.021126747131347656  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.021163463592529297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.010881423950195312  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.011079788208007812  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.011079788208007812  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 16720
output nodes number: 4904
edges number: 26581
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.21632862091064453  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.21632909774780273  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.011439323425292969  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 16 input nodes size: 18503
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.010862350463867188  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.010862350463867188  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.01968526840209961  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.019724369049072266  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.011714935302734375  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.012007713317871094  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.012007713317871094  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 18503
output nodes number: 5198
edges number: 39280
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.31145381927490234  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.31145429611206055  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.01254129409790039  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 17 input nodes size: 10519
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.011758804321289062  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.011758804321289062  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.016774654388427734  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.016793251037597656  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.007931232452392578  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.00804281234741211  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.00804281234741211  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 10519
output nodes number: 2452
edges number: 14902
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.1201176643371582  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.1201181411743164  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.00785207748413086  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

pseudo mini batch 18 input nodes size: 11488
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.007522106170654297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.007522106170654297  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes
Using backend: pytorch

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.013214588165283203  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.013233184814453125  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008198738098144531  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008328437805175781  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008328437805175781  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

input nodes number: 11488
output nodes number: 2452
edges number: 17370
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.13925981521606445  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.13926029205322266  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008572101593017578  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008572101593017578  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3720703125 GB
    Memory Allocated: 0.008572101593017578  GigaBytes
Max Memory Allocated: 0.35680484771728516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009088566428736636 |0.0007255579295911287 |0.030823619742142528 |0.00015714294032046668 |0.02482957588998895 |0.0038487911224365234 |
----------------------------------------------------------pseudo_mini_loss sum 3.169161796569824
Total (block generation + training)time/epoch 13.997104048728943
Training time/epoch 1.354893684387207
Training time without block to device /epoch 1.3411080837249756
Training time without total dataloading part /epoch 1.0642452239990234
load block tensor time/epoch 0.1726827621459961
block to device time/epoch 0.013785600662231445
input features size transfer per epoch 2.5480985641479492e-06
blocks size to device per epoch 1.6987323760986328e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  232763
Number of first layer input nodes during this epoch:  232763
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
