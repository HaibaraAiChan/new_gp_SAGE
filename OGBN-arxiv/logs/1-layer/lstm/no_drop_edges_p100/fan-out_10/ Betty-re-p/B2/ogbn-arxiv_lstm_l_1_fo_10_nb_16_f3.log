[21:45:47] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14089438 edges into 16 parts and get 2794070 edge cuts
main start at this time 1651873532.5037918
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06559872627258301
global_2_local spend time (sec) 0.06134796142578125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0043718814849853516
A = g.adjacency_matrix() spent  0.0072596073150634766
auxiliary_graph
Graph(num_nodes=145031, num_edges=14180379,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10624313354492188
remove nodes length
54090
auxiliary_graph.remove_nodes spent  0.6899740695953369
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14180379,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6494872570037842

the counter of shared neighbor distribution
Counter({1.0: 12728892, 2.0: 1148578, 3.0: 165860, 4.0: 33436, 5.0: 8994, 6.0: 2692, 7.0: 738, 8.0: 218, 9.0: 28, 10.0: 2})
14089438
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14089435, 14089436, 14089437])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12728892, 2.0: 1148578, 3.0: 165860, 4.0: 33436, 5.0: 8994, 6.0: 2692, 7.0: 738, 8.0: 218, 9.0: 28, 10.0: 2})
Convert a graph into a bidirected graph: 1.113 seconds
Metis partitioning: 3.226 seconds
Split the graph: 0.710 seconds
Construct subgraphs: 0.096 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.153384685516357
5641
5645
5559
5780
5762
5784
5813
5781
5768
5630
5623
5811
5684
5517
5605
5538
total k batches seeds list generation spend  11.265700817108154
after graph partition
graph partition algorithm spend time 11.34731912612915
5641
5645
5559
5780
5762
5784
5813
5781
5768
5630
5623
5811
5684
5517
5605
5538
partition_len_list
[11002, 11307, 9863, 10672, 11607, 10373, 12747, 12235, 12866, 10718, 16503, 15022, 20797, 19763, 21857, 19579]
shared_neighbor_graph_partition_s0 selection method  spend 11.466755390167236
time for parepare:  0.01901555061340332
local_output_nid generation:  0.0009617805480957031
local_in_edges_tensor generation:  0.0013058185577392578
mini_batch_src_global generation:  0.0014481544494628906
r_  generation:  0.012467384338378906
local_output_nid generation:  0.0012636184692382812
local_in_edges_tensor generation:  0.0011701583862304688
mini_batch_src_global generation:  0.0016598701477050781
r_  generation:  0.014292716979980469
local_output_nid generation:  0.001300811767578125
local_in_edges_tensor generation:  0.0011823177337646484
mini_batch_src_global generation:  0.0012707710266113281
r_  generation:  0.014391422271728516
local_output_nid generation:  0.0013103485107421875
local_in_edges_tensor generation:  0.0010983943939208984
mini_batch_src_global generation:  0.0014309883117675781
r_  generation:  0.014199256896972656
local_output_nid generation:  0.001272439956665039
local_in_edges_tensor generation:  0.0010876655578613281
mini_batch_src_global generation:  0.0011289119720458984
r_  generation:  0.013038158416748047
local_output_nid generation:  0.0012371540069580078
local_in_edges_tensor generation:  0.0010864734649658203
mini_batch_src_global generation:  0.0011677742004394531
r_  generation:  0.014394283294677734
local_output_nid generation:  0.0012462139129638672
local_in_edges_tensor generation:  0.00109100341796875
mini_batch_src_global generation:  0.0012297630310058594
r_  generation:  0.015539884567260742
local_output_nid generation:  0.001955270767211914
local_in_edges_tensor generation:  0.003328561782836914
mini_batch_src_global generation:  0.0017330646514892578
r_  generation:  0.013927221298217773
local_output_nid generation:  0.0012867450714111328
local_in_edges_tensor generation:  0.0011248588562011719
mini_batch_src_global generation:  0.0014121532440185547
r_  generation:  0.013672113418579102
local_output_nid generation:  0.001222372055053711
local_in_edges_tensor generation:  0.0010421276092529297
mini_batch_src_global generation:  0.001064300537109375
r_  generation:  0.012244224548339844
local_output_nid generation:  0.0012171268463134766
local_in_edges_tensor generation:  0.0010423660278320312
mini_batch_src_global generation:  0.0011458396911621094
r_  generation:  0.016780614852905273
local_output_nid generation:  0.0014216899871826172
local_in_edges_tensor generation:  0.0010983943939208984
mini_batch_src_global generation:  0.0012209415435791016
r_  generation:  0.013112306594848633
local_output_nid generation:  0.0014035701751708984
local_in_edges_tensor generation:  0.0011022090911865234
mini_batch_src_global generation:  0.0014567375183105469
r_  generation:  0.016931533813476562
local_output_nid generation:  0.0013239383697509766
local_in_edges_tensor generation:  0.0010907649993896484
mini_batch_src_global generation:  0.0014560222625732422
r_  generation:  0.01475381851196289
local_output_nid generation:  0.0013201236724853516
local_in_edges_tensor generation:  0.0010821819305419922
mini_batch_src_global generation:  0.0014803409576416016
r_  generation:  0.015427589416503906
local_output_nid generation:  0.001291513442993164
local_in_edges_tensor generation:  0.001032114028930664
mini_batch_src_global generation:  0.0013742446899414062
r_  generation:  0.013761520385742188
----------------------check_connections_block total spend ----------------------------- 0.3836040496826172
generate_one_block  0.024744272232055664
generate_one_block  0.019333600997924805
generate_one_block  0.02228260040283203
generate_one_block  0.024160146713256836
generate_one_block  0.022482872009277344
generate_one_block  0.0180509090423584
generate_one_block  0.01964402198791504
generate_one_block  0.019158124923706055
generate_one_block  0.01713085174560547
generate_one_block  0.015850543975830078
generate_one_block  0.019079923629760742
generate_one_block  0.019978761672973633
generate_one_block  0.02544879913330078
generate_one_block  0.022231578826904297
generate_one_block  0.02253246307373047
generate_one_block  0.019745349884033203
global_2_local spend time (sec) 0.005281686782836914
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007848739624023438
A = g.adjacency_matrix() spent  0.0006947517395019531
auxiliary_graph
Graph(num_nodes=21857, num_edges=1173467,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.014302968978881836
remove nodes length
16252
auxiliary_graph.remove_nodes spent  0.06279802322387695
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5605, num_edges=1173467,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.036481618881225586

the counter of shared neighbor distribution
Counter({1.0: 1111228, 2.0: 51802, 3.0: 4142, 4.0: 512, 5.0: 122, 6.0: 42, 7.0: 8, 8.0: 4, 9.0: 2})[21:45:49] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5605 nodes and 1167862 edges into 2 parts and get 67566 edge cuts
[21:45:51] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5684 nodes and 2146408 edges into 2 parts and get 327491 edge cuts

1167862
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 1167859, 1167860, 1167861])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 1111228, 2.0: 51802, 3.0: 4142, 4.0: 512, 5.0: 122, 6.0: 42, 7.0: 8, 8.0: 4, 9.0: 2})
Convert a graph into a bidirected graph: 0.040 seconds
Metis partitioning: 0.100 seconds
Split the graph: 0.173 seconds
Construct subgraphs: 0.022 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.33537840843200684
2756
2849
total k batches seeds list generation spend  0.8516924381256104
after graph partition
graph partition algorithm spend time 0.8649554252624512
2756
2849
time for parepare:  0.029167652130126953
local_output_nid generation:  0.0005664825439453125
local_in_edges_tensor generation:  0.0010480880737304688
mini_batch_src_global generation:  0.0011510848999023438
r_  generation:  0.009594440460205078
local_output_nid generation:  0.0005486011505126953
local_in_edges_tensor generation:  0.0010061264038085938
mini_batch_src_global generation:  0.0014681816101074219
r_  generation:  0.011238574981689453
----------------------check_connections_block total spend ----------------------------- 0.06556153297424316
generate_one_block  0.014522790908813477
generate_one_block  0.013359785079956055
global_2_local spend time (sec) 0.0041658878326416016
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.000728607177734375
A = g.adjacency_matrix() spent  0.0007398128509521484
auxiliary_graph
Graph(num_nodes=20797, num_edges=2152092,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.013224124908447266
remove nodes length
15113
auxiliary_graph.remove_nodes spent  0.06265974044799805
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5684, num_edges=2152092,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.07651925086975098

the counter of shared neighbor distribution
Counter({1.0: 1903304, 2.0: 215376, 3.0: 24586, 4.0: 2734, 5.0: 308, 6.0: 64, 7.0: 20, 8.0: 14, 9.0: 2})
2146408
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 2146405, 2146406, 2146407])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 1903304, 2.0: 215376, 3.0: 24586, 4.0: 2734, 5.0: 308, 6.0: 64, 7.0: 20, 8.0: 14, 9.0: 2})
Convert a graph into a bidirected graph: 0.076 seconds
Metis partitioning: 0.209 seconds
Split the graph: 0.225 seconds
Construct subgraphs: 0.065 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.5780696868896484
2842
2842
total k batches seeds list generation spend  1.4163999557495117
after graph partition
graph partition algorithm spend time 1.4592933654785156
2842
2842
time for parepare:  0.02513432502746582
local_output_nid generation:  0.0005366802215576172
local_in_edges_tensor generation:  0.0011026859283447266
mini_batch_src_global generation:  0.0013892650604248047
r_  generation:  0.009918212890625
local_output_nid generation:  0.0006289482116699219
local_in_edges_tensor generation:  0.001007080078125
mini_batch_src_global generation:  0.0015146732330322266
r_  generation:  0.009465456008911133
----------------------check_connections_block total spend ----------------------------- 0.05927920341491699
generate_one_block  0.012687444686889648
generate_one_block  0.013465642929077148
----------===============-------------===============-------------the number of batches ***** 18

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 11002
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.005776405334472656  GigaBytes
Max Memory Allocated: 0.005776405334472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.005818843841552734  GigaBytes
Max Memory Allocated: 0.005818843841552734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.005818843841552734  GigaBytes
Max Memory Allocated: 0.005818843841552734  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.006042003631591797  GigaBytes
Max Memory Allocated: 0.006042003631591797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.006042003631591797  GigaBytes
Max Memory Allocated: 0.006042003631591797  GigaBytes

input nodes number: 11002
output nodes number: 5641
edges number: 29847
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.23289251327514648  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.2328934669494629  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.007782936096191406  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

pseudo mini batch 1 input nodes size: 11307
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.007190704345703125  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.007190704345703125  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.01258230209350586  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.012624740600585938  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.007336139678955078  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.007581233978271484  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2177734375 GB
    Memory Allocated: 0.007581233978271484  GigaBytes
Max Memory Allocated: 0.25148773193359375  GigaBytes

input nodes number: 11307
output nodes number: 5645
edges number: 32813
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.25643396377563477  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.25643444061279297  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007975578308105469  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

pseudo mini batch 2 input nodes size: 9863
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007337093353271484  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007337093353271484  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.012583255767822266  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.012624740600585938  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007190704345703125  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007441520690917969  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007441520690917969  GigaBytes
Max Memory Allocated: 0.27762317657470703  GigaBytes

input nodes number: 9863
output nodes number: 5559
edges number: 33625
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.2608966827392578  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.260897159576416  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007815837860107422  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

pseudo mini batch 3 input nodes size: 10672
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007177829742431641  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007177829742431641  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.01226663589477539  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.012310028076171875  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007022380828857422  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007255077362060547  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007255077362060547  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

input nodes number: 10672
output nodes number: 5780
edges number: 31185
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.24635744094848633  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.24635791778564453  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.0076656341552734375  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

pseudo mini batch 4 input nodes size: 11607
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.0070552825927734375  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.0070552825927734375  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.01258993148803711  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.012633323669433594  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007501125335693359  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007709980010986328  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007709980010986328  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

input nodes number: 11607
output nodes number: 5762
edges number: 27963
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.22209978103637695  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.22210025787353516  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008068084716796875  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

pseudo mini batch 5 input nodes size: 10373
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007498264312744141  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007498264312744141  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.012444496154785156  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.01248788833618164  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.006909847259521484  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007145404815673828  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007145404815673828  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

input nodes number: 10373
output nodes number: 5784
edges number: 31536
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.2458200454711914  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.2458205223083496  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007527351379394531  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

pseudo mini batch 6 input nodes size: 12747
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.006913185119628906  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.006913185119628906  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.01299142837524414  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.013034820556640625  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008045196533203125  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.00830078125  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.00830078125  GigaBytes
Max Memory Allocated: 0.28305768966674805  GigaBytes

input nodes number: 12747
output nodes number: 5813
edges number: 34257
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.2675771713256836  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.2675776481628418  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008721351623535156  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

pseudo mini batch 7 input nodes size: 12235
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008049488067626953  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008049488067626953  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.013883590698242188  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.013926982879638672  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.007805347442626953  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008045673370361328  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2470703125 GB
    Memory Allocated: 0.008045673370361328  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

input nodes number: 12235
output nodes number: 5781
edges number: 32176
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.25643491744995117  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.2564353942871094  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.0084381103515625  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

pseudo mini batch 8 input nodes size: 12866
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007800579071044922  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007800579071044922  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.013935565948486328  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.013978958129882812  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.008101463317871094  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.008318901062011719  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.008318901062011719  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

input nodes number: 12866
output nodes number: 5768
edges number: 29084
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.23073816299438477  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.23073863983154297  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.00869607925415039  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

pseudo mini batch 9 input nodes size: 10718
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.008099555969238281  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.008099555969238281  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.013210296630859375  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.01325225830078125  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007073879241943359  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007277965545654297  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007277965545654297  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

input nodes number: 10718
output nodes number: 5630
edges number: 27370
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.21720314025878906  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.21720361709594727  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.0076045989990234375  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

pseudo mini batch 10 input nodes size: 16503
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007053375244140625  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.007053375244140625  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.015338897705078125  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.015380859375  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.010228157043457031  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.0104522705078125  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.0104522705078125  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

input nodes number: 16503
output nodes number: 5623
edges number: 29987
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.2376108169555664  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.2376112937927246  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.010861396789550781  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

pseudo mini batch 11 input nodes size: 15022
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.010227203369140625  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.010227203369140625  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.01739025115966797  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.017433643341064453  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.009106159210205078  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.009334087371826172  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.009334087371826172  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

input nodes number: 15022
output nodes number: 5811
edges number: 30584
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.24119186401367188  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.24119234085083008  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.00976705551147461  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

pseudo mini batch 12 input nodes size: 19763
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.00913381576538086  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.00913381576538086  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.01855754852294922  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.01859903335571289  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.011392593383789062  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.011651039123535156  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2490234375 GB
    Memory Allocated: 0.011651039123535156  GigaBytes
Max Memory Allocated: 0.2895827293395996  GigaBytes

input nodes number: 19763
output nodes number: 5517
edges number: 34652
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.2721285820007324  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.2721290588378906  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.01207590103149414  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 13 input nodes size: 19579
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.011349201202392578  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.011349201202392578  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.020685195922851562  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.020726680755615234  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.011261463165283203  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.011487483978271484  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.011487483978271484  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 19579
output nodes number: 5538
edges number: 30279
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.24387216567993164  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.24387264251708984  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.01192474365234375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 14 input nodes size: 10562
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.011264324188232422  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.011264324188232422  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.016300678253173828  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.016321659088134766  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.006944179534912109  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007064342498779297  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007064342498779297  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 10562
output nodes number: 2756
edges number: 16043
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.1297464370727539  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.1297469139099121  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.006880760192871094  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 15 input nodes size: 13075
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.006529808044433594  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.006529808044433594  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.012764453887939453  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.012785911560058594  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.00772857666015625  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.00788116455078125  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.00788116455078125  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 13075
output nodes number: 2849
edges number: 20355
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.159759521484375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.1597599983215332  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.008177757263183594  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 16 input nodes size: 11961
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007742404937744141  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007742404937744141  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.013445854187011719  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.01346731185913086  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007211208343505859  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007355213165283203  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007355213165283203  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 11961
output nodes number: 2842
edges number: 19285
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.15449237823486328  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.15449285507202148  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.0076198577880859375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes
[21:46:04] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14237192 edges into 18 parts and get 2752728 edge cuts

pseudo mini batch 17 input nodes size: 12517
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007210254669189453  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007210254669189453  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.013178825378417969  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.01320028305053711  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007475376129150391  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007642269134521484  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007642269134521484  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 12517
output nodes number: 2842
edges number: 22373
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.17423391342163086  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.17423439025878906  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007935047149658203  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.008995532989501953  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.008995532989501953  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008913079897562662 |0.022563775380452473 |0.05481607384151883 |0.00016162130567762587 |0.024063852098253038 |0.003694772720336914 |
----------------------------------------------------------pseudo_mini_loss sum 3.837965965270996
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  232372
Number of first layer input nodes during this epoch:  232372
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.00899505615234375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021189212799072266
global_2_local spend time (sec) 0.039392948150634766
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003306150436401367
A = g.adjacency_matrix() spent  0.005881071090698242
auxiliary_graph
Graph(num_nodes=144933, num_edges=14328133,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09716129302978516
remove nodes length
53992
auxiliary_graph.remove_nodes spent  0.7052526473999023
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14328133,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.7447566986083984

the counter of shared neighbor distribution
Counter({1.0: 12862168, 2.0: 1164718, 3.0: 164710, 4.0: 33108, 5.0: 8804, 6.0: 2640, 7.0: 800, 8.0: 210, 9.0: 32, 10.0: 2})
14237192
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14237189, 14237190, 14237191])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12862168, 2.0: 1164718, 3.0: 164710, 4.0: 33108, 5.0: 8804, 6.0: 2640, 7.0: 800, 8.0: 210, 9.0: 32, 10.0: 2})
Convert a graph into a bidirected graph: 1.109 seconds
Metis partitioning: 3.327 seconds
Split the graph: 0.863 seconds
Construct subgraphs: 0.114 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.421195030212402
5201
5204
5200
5083
4968
5091
5187
5035
4905
4925
4923
5078
5067
4912
5148
4911
5199
4904
total k batches seeds list generation spend  11.513450384140015
after graph partition
graph partition algorithm spend time 11.591552257537842
5201
5204
5200
5083
4968
5091
5187
5035
4905
4925
4923
5078
5067
4912
5148
4911
5199
4904
partition_len_list
[9357, 10013, 11235, 9987, 9248, 9570, 9485, 10066, 10110, 11095, 11038, 11356, 13212, 16215, 19453, 19187, 18161, 19555]
shared_neighbor_graph_partition_s0 selection method  spend 11.688461542129517
time for parepare:  0.020729541778564453
local_output_nid generation:  0.0009365081787109375
local_in_edges_tensor generation:  0.001226663589477539
mini_batch_src_global generation:  0.0014252662658691406
r_  generation:  0.014314889907836914
local_output_nid generation:  0.001699686050415039
local_in_edges_tensor generation:  0.00115203857421875
mini_batch_src_global generation:  0.0014920234680175781
r_  generation:  0.011977910995483398
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0010895729064941406
mini_batch_src_global generation:  0.0012888908386230469
r_  generation:  0.012830257415771484
local_output_nid generation:  0.0014271736145019531
local_in_edges_tensor generation:  0.001020193099975586
mini_batch_src_global generation:  0.001018524169921875
r_  generation:  0.010550975799560547
local_output_nid generation:  0.0013234615325927734
local_in_edges_tensor generation:  0.0010235309600830078
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.012144327163696289
local_output_nid generation:  0.0012888908386230469
local_in_edges_tensor generation:  0.0009970664978027344
mini_batch_src_global generation:  0.0009415149688720703
r_  generation:  0.010512828826904297
local_output_nid generation:  0.001255035400390625
local_in_edges_tensor generation:  0.0011801719665527344
mini_batch_src_global generation:  0.0012540817260742188
r_  generation:  0.015189647674560547
local_output_nid generation:  0.0026013851165771484
local_in_edges_tensor generation:  0.001102447509765625
mini_batch_src_global generation:  0.0011713504791259766
r_  generation:  0.012150764465332031
local_output_nid generation:  0.0011394023895263672
local_in_edges_tensor generation:  0.0010433197021484375
mini_batch_src_global generation:  0.0010530948638916016
r_  generation:  0.011697053909301758
local_output_nid generation:  0.0011148452758789062
local_in_edges_tensor generation:  0.0009541511535644531
mini_batch_src_global generation:  0.0009369850158691406
r_  generation:  0.01016378402709961
local_output_nid generation:  0.0011076927185058594
local_in_edges_tensor generation:  0.0009505748748779297
mini_batch_src_global generation:  0.0009086132049560547
r_  generation:  0.010392427444458008
local_output_nid generation:  0.0010995864868164062
local_in_edges_tensor generation:  0.001148223876953125
mini_batch_src_global generation:  0.0009372234344482422
r_  generation:  0.010730504989624023
local_output_nid generation:  0.0010824203491210938[21:46:06] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 4904 nodes and 714764 edges into 2 parts and get 48287 edge cuts
[21:46:07] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5148 nodes and 1573618 edges into 2 parts and get 102887 edge cuts

local_in_edges_tensor generation:  0.0010821819305419922
mini_batch_src_global generation:  0.0012402534484863281
r_  generation:  0.013164281845092773
local_output_nid generation:  0.0011930465698242188
local_in_edges_tensor generation:  0.0012156963348388672
mini_batch_src_global generation:  0.0010116100311279297
r_  generation:  0.010547399520874023
local_output_nid generation:  0.0012433528900146484
local_in_edges_tensor generation:  0.0010464191436767578
mini_batch_src_global generation:  0.0014753341674804688
r_  generation:  0.015238761901855469
local_output_nid generation:  0.001230478286743164
local_in_edges_tensor generation:  0.0009891986846923828
mini_batch_src_global generation:  0.001239776611328125
r_  generation:  0.011674880981445312
local_output_nid generation:  0.0012600421905517578
local_in_edges_tensor generation:  0.0010428428649902344
mini_batch_src_global generation:  0.0013568401336669922
r_  generation:  0.01570725440979004
local_output_nid generation:  0.0011973381042480469
local_in_edges_tensor generation:  0.0009806156158447266
mini_batch_src_global generation:  0.001397848129272461
r_  generation:  0.014212846755981445
----------------------check_connections_block total spend ----------------------------- 0.366729736328125
generate_one_block  0.024733781814575195
generate_one_block  0.017988204956054688
generate_one_block  0.018095016479492188
generate_one_block  0.014243602752685547
generate_one_block  0.016516447067260742
generate_one_block  0.01405787467956543
generate_one_block  0.01830911636352539
generate_one_block  0.017112016677856445
generate_one_block  0.016061782836914062
generate_one_block  0.014040470123291016
generate_one_block  0.014159202575683594
generate_one_block  0.01480865478515625
generate_one_block  0.016060829162597656
generate_one_block  0.016161680221557617
generate_one_block  0.022455453872680664
generate_one_block  0.018395423889160156
generate_one_block  0.02231454849243164
generate_one_block  0.02155613899230957
global_2_local spend time (sec) 0.004198312759399414
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007808208465576172
A = g.adjacency_matrix() spent  0.0006887912750244141
auxiliary_graph
Graph(num_nodes=19555, num_edges=719668,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.023025989532470703
remove nodes length
14651
auxiliary_graph.remove_nodes spent  0.04157066345214844
after remove non output nodes the auxiliary_graph
Graph(num_nodes=4904, num_edges=719668,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.03201866149902344

the counter of shared neighbor distribution
Counter({1.0: 657408, 2.0: 51318, 3.0: 4954, 4.0: 722, 5.0: 228, 6.0: 78, 7.0: 38, 8.0: 18})
714764
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 714761, 714762, 714763])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 657408, 2.0: 51318, 3.0: 4954, 4.0: 722, 5.0: 228, 6.0: 78, 7.0: 38, 8.0: 18})
Convert a graph into a bidirected graph: 0.028 seconds
Metis partitioning: 0.071 seconds
Split the graph: 0.061 seconds
Construct subgraphs: 0.022 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.18227267265319824
2447
2457
total k batches seeds list generation spend  0.5331709384918213
after graph partition
graph partition algorithm spend time 0.5381193161010742
2447
2457
time for parepare:  0.017281293869018555
local_output_nid generation:  0.00039124488830566406
local_in_edges_tensor generation:  0.0006937980651855469
mini_batch_src_global generation:  0.0007762908935546875
r_  generation:  0.005956888198852539
local_output_nid generation:  0.0003840923309326172
local_in_edges_tensor generation:  0.0007038116455078125
mini_batch_src_global generation:  0.0009257793426513672
r_  generation:  0.006783962249755859
----------------------check_connections_block total spend ----------------------------- 0.040810346603393555
generate_one_block  0.010936498641967773
generate_one_block  0.011565446853637695
global_2_local spend time (sec) 0.003990888595581055
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0006361007690429688
A = g.adjacency_matrix() spent  0.0006525516510009766
auxiliary_graph
Graph(num_nodes=19453, num_edges=1578766,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.013092279434204102
remove nodes length
14305
auxiliary_graph.remove_nodes spent  0.034018754959106445
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5148, num_edges=1578766,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.058644771575927734

the counter of shared neighbor distribution
Counter({1.0: 1481390, 2.0: 84070, 3.0: 7074, 4.0: 896, 5.0: 138, 6.0: 36, 7.0: 12, 8.0: 2})
1573618
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 1573615, 1573616, 1573617])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 1481390, 2.0: 84070, 3.0: 7074, 4.0: 896, 5.0: 138, 6.0: 36, 7.0: 12, 8.0: 2})
Convert a graph into a bidirected graph: 0.055 seconds
Metis partitioning: 0.137 seconds
Split the graph: 0.186 seconds
Construct subgraphs: 0.056 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.4337623119354248
2560
2588
total k batches seeds list generation spend  1.058255910873413
after graph partition
graph partition algorithm spend time 1.0916087627410889
2560
2588
time for parepare:  0.024896621704101562
local_output_nid generation:  0.0005471706390380859
local_in_edges_tensor generation:  0.0009570121765136719
mini_batch_src_global generation:  0.0013005733489990234
r_  generation:  0.010799169540405273
local_output_nid generation:  0.0005574226379394531
local_in_edges_tensor generation:  0.0008673667907714844
mini_batch_src_global generation:  0.0013098716735839844
r_  generation:  0.00998997688293457
----------------------check_connections_block total spend ----------------------------- 0.06032419204711914
generate_one_block  0.016330957412719727
generate_one_block  0.012800455093383789
----------===============-------------===============-------------the number of batches ***** 20

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.00899505615234375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 14.248739957809448
pseudo mini batch 0 input nodes size: 9357
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.008534908294677734  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.008534908294677734  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.012996673583984375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.013035774230957031  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007045745849609375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.00725555419921875  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.00725555419921875  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 9357
output nodes number: 5201
edges number: 28155
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.2225961685180664  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.2225971221923828  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007946491241455078  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 1 input nodes size: 10013
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007398128509521484  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007398128509521484  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.012172698974609375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.012211799621582031  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007710933685302734  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007921695709228516  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.007921695709228516  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 10013
output nodes number: 5204
edges number: 28234
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.22155332565307617  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.22155380249023438  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.008266448974609375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 2 input nodes size: 11235
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.0077114105224609375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.0077114105224609375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.013068675994873047  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.013107776641845703  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.008294105529785156  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.008527755737304688  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.008527755737304688  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 11235
output nodes number: 5200
edges number: 31324
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.2457747459411621  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.2457752227783203  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.008903026580810547  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 3 input nodes size: 9987
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.00829315185546875  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.00829315185546875  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.01306772232055664  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.01310586929321289  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007709503173828125  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.0078887939453125  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.0078887939453125  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 9987
output nodes number: 5083
edges number: 23945
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.19298696517944336  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.19298744201660156  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.008183002471923828  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 4 input nodes size: 9248
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.0076923370361328125  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.0076923370361328125  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.012102127075195312  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.012139320373535156  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007326602935791016  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007544040679931641  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007544040679931641  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 9248
output nodes number: 4968
edges number: 29062
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.22759675979614258  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.22759723663330078  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007869243621826172  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 5 input nodes size: 9570
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007309436798095703  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007309436798095703  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.012084007263183594  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.012122154235839844  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.0076751708984375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007853507995605469  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007853507995605469  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 9570
output nodes number: 5091
edges number: 23838
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.1896047592163086  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.1896052360534668  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.0081787109375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 6 input nodes size: 9485
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007693290710449219  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007693290710449219  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.01221609115600586  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.012255191802978516  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007442474365234375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007687568664550781  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.007687568664550781  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 9485
output nodes number: 5187
edges number: 32865
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2861328125 GB
    Memory Allocated: 0.2551140785217285  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2861328125 GB
    Memory Allocated: 0.2551145553588867  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.008076667785644531  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 7 input nodes size: 10066
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.007456779479980469  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.007456779479980469  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.012256622314453125  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.012294292449951172  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.007732391357421875  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.007952690124511719  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.007952690124511719  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 10066
output nodes number: 5035
edges number: 29464
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.23075342178344727  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.23075389862060547  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.008282661437988281  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 8 input nodes size: 10110
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.007709980010986328  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.007709980010986328  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.012530803680419922  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.012567520141601562  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.007730007171630859  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00794076919555664  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00794076919555664  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 10110
output nodes number: 4905
edges number: 28228
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.22061538696289062  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.22061586380004883  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00826263427734375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 9 input nodes size: 11095
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.007710456848144531  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.007710456848144531  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.013000965118408203  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.013037681579589844  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00818014144897461  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00835275650024414  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00835275650024414  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 11095
output nodes number: 4925
edges number: 23140
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.1868896484375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.1868901252746582  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.0086669921875  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 10 input nodes size: 11038
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.008183479309082031  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.008183479309082031  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.013446807861328125  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.013483524322509766  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.008156299591064453  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00833272933959961  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00833272933959961  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 11038
output nodes number: 4923
edges number: 23640
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.1894669532775879  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.1894674301147461  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.008646488189697266  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 11 input nodes size: 11356
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00815582275390625  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00815582275390625  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.013570785522460938  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.013608932495117188  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.008308887481689453  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00849294662475586  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00849294662475586  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 11356
output nodes number: 5078
edges number: 24699
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.19953536987304688  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.19953584671020508  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.008841991424560547  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 12 input nodes size: 13212
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.008331775665283203  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.008331775665283203  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.014635562896728516  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.014673709869384766  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.009220600128173828  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00941610336303711  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.00941610336303711  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 13212
output nodes number: 5067
edges number: 26192
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.21027660369873047  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.21027708053588867  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.009766101837158203  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 13 input nodes size: 16215
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.009219169616699219  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.009219169616699219  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.01695108413696289  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.01698780059814453  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.010645866394042969  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.01082611083984375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.01082611083984375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 16215
output nodes number: 4912
edges number: 24142
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.19707012176513672  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.19707059860229492  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.011159420013427734  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 14 input nodes size: 19187
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.010622501373291016  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.010622501373291016  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.019771575927734375  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.019808292388916016  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.012039661407470703  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.012249469757080078  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.012249469757080078  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 19187
output nodes number: 4911
edges number: 28085
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.22641706466674805  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.22641754150390625  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.012657642364501953  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

pseudo mini batch 15 input nodes size: 18161
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.012039661407470703  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.012039661407470703  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.020699501037597656  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.020738601684570312  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.011552810668945312  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.011835098266601562  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2880859375 GB
    Memory Allocated: 0.011835098266601562  GigaBytes
Max Memory Allocated: 0.29801368713378906  GigaBytes

input nodes number: 18161
output nodes number: 5199
edges number: 37801
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.30098676681518555  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.30098724365234375  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.012354373931884766  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 16 input nodes size: 10109
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011595726013183594  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011595726013183594  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.016416072845458984  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.016434669494628906  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007735729217529297  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007853031158447266  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007853031158447266  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 10109
output nodes number: 2447
edges number: 15724
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.12701034545898438  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.12701082229614258  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007663726806640625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 17 input nodes size: 11801
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007325649261474609  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007325649261474609  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.013376712799072266  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.013395309448242188  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008556365966796875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008692741394042969  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008692741394042969  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 11801
output nodes number: 2457
edges number: 18227
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.14637327194213867  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.14637374877929688  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008946895599365234  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 18 input nodes size: 11677
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008557796478271484  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008557796478271484  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.014125823974609375  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0141448974609375  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008075237274169922  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008214473724365234  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008214473724365234  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 11677
output nodes number: 2560
edges number: 18681
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.14864015579223633  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.14864063262939453  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00848531723022461  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 19 input nodes size: 10215
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008090496063232422  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008090496063232422  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.012961387634277344  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.012980937957763672  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes
[21:46:19] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14381252 edges into 20 parts and get 3192972 edge cuts

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007393836975097656  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0075283050537109375  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0075283050537109375  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 10215
output nodes number: 2588
edges number: 17968
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.14402389526367188  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.14402437210083008  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007772922515869141  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007772922515869141  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007772922515869141  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007275772094726562 |0.0005355358123779296 |0.030187928676605226 |0.0001592874526977539 |0.024098873138427734 |0.004030704498291016 |
----------------------------------------------------------pseudo_mini_loss sum 3.26849365234375
Total (block generation + training)time/epoch 15.6081702709198
Training time/epoch 1.3591704368591309
Training time without block to device /epoch 1.3484597206115723
Training time without total dataloading part /epoch 1.0929524898529053
load block tensor time/epoch 0.14551544189453125
block to device time/epoch 0.010710716247558594
input features size transfer per epoch 2.682209014892578e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  233137
Number of first layer input nodes during this epoch:  233137
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0077724456787109375  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.017481088638305664
global_2_local spend time (sec) 0.06116032600402832
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004422903060913086
A = g.adjacency_matrix() spent  0.005825042724609375
auxiliary_graph
Graph(num_nodes=145065, num_edges=14472193,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10044384002685547
remove nodes length
54124
auxiliary_graph.remove_nodes spent  0.7645020484924316
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14472193,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.649573802947998

the counter of shared neighbor distribution
Counter({1.0: 12980392, 2.0: 1183048, 3.0: 170858, 4.0: 34106, 5.0: 9200, 6.0: 2692, 7.0: 720, 8.0: 192, 9.0: 38, 10.0: 6})
14381252
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14381249, 14381250, 14381251])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12980392, 2.0: 1183048, 3.0: 170858, 4.0: 34106, 5.0: 9200, 6.0: 2692, 7.0: 720, 8.0: 192, 9.0: 38, 10.0: 6})
Convert a graph into a bidirected graph: 1.070 seconds
Metis partitioning: 3.222 seconds
Split the graph: 0.602 seconds
Construct subgraphs: 0.089 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.9916181564331055
4645
4635
4680
4661
4644
4626
4663
4539
4589
4427
4651
4429
4568
4416
4458
4426
4451
4414
4605
4414
total k batches seeds list generation spend  11.122408628463745
after graph partition
graph partition algorithm spend time 11.204164266586304
4645
4635
4680
4661
4644
4626
4663
4539
4589
4427
4651
4429
4568
4416
4458
4426
4451
4414
4605
4414
partition_len_list
[7818, 8564, 10400, 9929, 9549, 9487, 9848, 8552, 8059, 7769, 9051, 11295, 10662, 15623, 13292, 18409, 16128, 16048, 18469, 16678]
shared_neighbor_graph_partition_s0 selection method  spend 11.328513860702515
time for parepare:  0.02083444595336914
local_output_nid generation:  0.001032114028930664
local_in_edges_tensor generation:  0.0011622905731201172
mini_batch_src_global generation:  0.0011680126190185547
r_  generation:  0.009751319885253906
local_output_nid generation:  0.0011563301086425781
local_in_edges_tensor generation:  0.0009653568267822266
mini_batch_src_global generation:  0.0012319087982177734
r_  generation:  0.010992288589477539
local_output_nid generation:  0.001119852066040039
local_in_edges_tensor generation:  0.0010745525360107422
mini_batch_src_global generation:  0.0010936260223388672
r_  generation:  0.01112675666809082
local_output_nid generation:  0.0011098384857177734
local_in_edges_tensor generation:  0.0009665489196777344
mini_batch_src_global generation:  0.00135040283203125
r_  generation:  0.012040138244628906
local_output_nid generation:  0.001039266586303711
local_in_edges_tensor generation:  0.0010335445404052734
mini_batch_src_global generation:  0.0010418891906738281
r_  generation:  0.011656761169433594
local_output_nid generation:  0.000988006591796875
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.0010571479797363281
r_  generation:  0.011337757110595703
local_output_nid generation:  0.0009984970092773438
local_in_edges_tensor generation:  0.0009315013885498047
mini_batch_src_global generation:  0.0010838508605957031
r_  generation:  0.012421369552612305
local_output_nid generation:  0.0010840892791748047
local_in_edges_tensor generation:  0.0009469985961914062
mini_batch_src_global generation:  0.0009284019470214844
r_  generation:  0.009716510772705078
local_output_nid generation:  0.001024484634399414
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0010616779327392578
r_  generation:  0.012346267700195312
local_output_nid generation:  0.0009779930114746094
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0010256767272949219
r_  generation:  0.011547327041625977
local_output_nid generation:  0.000997304916381836
local_in_edges_tensor generation:  0.0008831024169921875
mini_batch_src_global generation:  0.0008955001831054688
r_  generation:  0.009814262390136719
local_output_nid generation:  0.0009086132049560547
local_in_edges_tensor generation:  0.0008623600006103516
mini_batch_src_global generation:  0.0009133815765380859
r_  generation:  0.01015782356262207
local_output_nid generation:  0.0009217262268066406
local_in_edges_tensor generation:  0.0008690357208251953
mini_batch_src_global generation:  0.0009102821350097656
r_  generation:  0.011332035064697266
local_output_nid generation:  0.0022640228271484375
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.0012922286987304688
r_  generation:  0.011628866195678711
local_output_nid generation:  0.0010008811950683594[21:46:22] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 4605 nodes and 1864396 edges into 2 parts and get 237835 edge cuts
[21:46:23] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 4426 nodes and 1019936 edges into 2 parts and get 112633 edge cuts

local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.0010831356048583984
r_  generation:  0.011236906051635742
local_output_nid generation:  0.0009853839874267578
local_in_edges_tensor generation:  0.0008943080902099609
mini_batch_src_global generation:  0.0011217594146728516
r_  generation:  0.011492490768432617
local_output_nid generation:  0.0009827613830566406
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0010466575622558594
r_  generation:  0.010851383209228516
local_output_nid generation:  0.0009672641754150391
local_in_edges_tensor generation:  0.0008699893951416016
mini_batch_src_global generation:  0.0010271072387695312
r_  generation:  0.011043787002563477
local_output_nid generation:  0.0009958744049072266
local_in_edges_tensor generation:  0.0010852813720703125
mini_batch_src_global generation:  0.0013549327850341797
r_  generation:  0.01669764518737793
local_output_nid generation:  0.0011286735534667969
local_in_edges_tensor generation:  0.0015065670013427734
mini_batch_src_global generation:  0.0014073848724365234
r_  generation:  0.012219429016113281
----------------------check_connections_block total spend ----------------------------- 0.3710367679595947
generate_one_block  0.021308422088623047
generate_one_block  0.01606297492980957
generate_one_block  0.015988826751708984
generate_one_block  0.01691579818725586
generate_one_block  0.01594686508178711
generate_one_block  0.015514135360717773
generate_one_block  0.017374515533447266
generate_one_block  0.01298666000366211
generate_one_block  0.016437768936157227
generate_one_block  0.015383481979370117
generate_one_block  0.013302326202392578
generate_one_block  0.014346599578857422
generate_one_block  0.013877391815185547
generate_one_block  0.018295764923095703
generate_one_block  0.015641450881958008
generate_one_block  0.018735170364379883
generate_one_block  0.016592741012573242
generate_one_block  0.020714521408081055
generate_one_block  0.022846460342407227
generate_one_block  0.01899099349975586
global_2_local spend time (sec) 0.0040283203125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007648468017578125
A = g.adjacency_matrix() spent  0.0007174015045166016
auxiliary_graph
Graph(num_nodes=18469, num_edges=1869001,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.013221263885498047
remove nodes length
13864
auxiliary_graph.remove_nodes spent  0.07074689865112305
after remove non output nodes the auxiliary_graph
Graph(num_nodes=4605, num_edges=1869001,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.06418895721435547

the counter of shared neighbor distribution
Counter({1.0: 1661494, 2.0: 180432, 3.0: 20176, 4.0: 2040, 5.0: 214, 7.0: 18, 6.0: 18, 8.0: 4})
1864396
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 1864393, 1864394, 1864395])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 1661494, 2.0: 180432, 3.0: 20176, 4.0: 2040, 5.0: 214, 7.0: 18, 6.0: 18, 8.0: 4})
Convert a graph into a bidirected graph: 0.064 seconds
Metis partitioning: 0.180 seconds
Split the graph: 0.199 seconds
Construct subgraphs: 0.024 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.47104501724243164
2275
2330
total k batches seeds list generation spend  1.261749505996704
after graph partition
graph partition algorithm spend time 1.2701060771942139
2275
2330
time for parepare:  0.02881145477294922
local_output_nid generation:  0.0005269050598144531
local_in_edges_tensor generation:  0.0009593963623046875
mini_batch_src_global generation:  0.0012416839599609375
r_  generation:  0.01014399528503418
local_output_nid generation:  0.0005128383636474609
local_in_edges_tensor generation:  0.0008647441864013672
mini_batch_src_global generation:  0.0014333724975585938
r_  generation:  0.010457992553710938
----------------------check_connections_block total spend ----------------------------- 0.06492114067077637
generate_one_block  0.01592874526977539
generate_one_block  0.015072822570800781
global_2_local spend time (sec) 0.003751516342163086
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00058746337890625
A = g.adjacency_matrix() spent  0.0004527568817138672
auxiliary_graph
Graph(num_nodes=18409, num_edges=1024362,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.012020349502563477
remove nodes length
13983
auxiliary_graph.remove_nodes spent  0.018425703048706055
after remove non output nodes the auxiliary_graph
Graph(num_nodes=4426, num_edges=1024362,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.027666091918945312

the counter of shared neighbor distribution
Counter({1.0: 976450, 2.0: 39952, 3.0: 2922, 4.0: 482, 5.0: 100, 6.0: 16, 7.0: 10, 8.0: 2, 9.0: 2})
1019936
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 1019933, 1019934, 1019935])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 976450, 2.0: 39952, 3.0: 2922, 4.0: 482, 5.0: 100, 6.0: 16, 7.0: 10, 8.0: 2, 9.0: 2})
Convert a graph into a bidirected graph: 0.033 seconds
Metis partitioning: 0.083 seconds
Split the graph: 0.122 seconds
Construct subgraphs: 0.022 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.26152706146240234
2212
2214
total k batches seeds list generation spend  0.6485624313354492
after graph partition
graph partition algorithm spend time 0.6546049118041992
2212
2214
time for parepare:  0.02753615379333496
local_output_nid generation:  0.0004773139953613281
local_in_edges_tensor generation:  0.0008497238159179688
mini_batch_src_global generation:  0.0008194446563720703
r_  generation:  0.006741762161254883
local_output_nid generation:  0.0004401206970214844
local_in_edges_tensor generation:  0.0007987022399902344
mini_batch_src_global generation:  0.0011146068572998047
r_  generation:  0.008301734924316406
----------------------check_connections_block total spend ----------------------------- 0.0552058219909668
generate_one_block  0.011542320251464844
generate_one_block  0.0111083984375
----------===============-------------===============-------------the number of batches ***** 22

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0077724456787109375  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 14.233347415924072
pseudo mini batch 0 input nodes size: 7818
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007397174835205078  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007397174835205078  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.01112508773803711  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011159896850585938  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0062694549560546875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006426811218261719  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006426811218261719  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 7818
output nodes number: 4645
edges number: 21060
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.16851377487182617  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.16851472854614258  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007002830505371094  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 1 input nodes size: 8564
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006577014923095703  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006577014923095703  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010660648345947266  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010695457458496094  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006932735443115234  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007112979888916016  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007112979888916016  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 8564
output nodes number: 4635
edges number: 24135
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.1932072639465332  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.1932077407836914  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00740814208984375  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 2 input nodes size: 10400
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006931304931640625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006931304931640625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011890411376953125  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011925697326660156  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007807254791259766  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007995128631591797  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007995128631591797  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 10400
output nodes number: 4680
edges number: 25147
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.19874000549316406  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.19874048233032227  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008320331573486328  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 3 input nodes size: 9929
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00781393051147461  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00781393051147461  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.012548446655273438  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.012583255767822266  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007588863372802734  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007798671722412109  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007798671722412109  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 9929
output nodes number: 4661
edges number: 28111
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.2210073471069336  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.2210078239440918  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008132457733154297  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 4 input nodes size: 9549
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007586002349853516  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007586002349853516  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.012545108795166016  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.012579917907714844  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0078105926513671875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008008003234863281  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008008003234863281  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 9549
output nodes number: 4644
edges number: 26399
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.20796775817871094  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.20796823501586914  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008327007293701172  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 5 input nodes size: 9487
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007808208465576172  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007808208465576172  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.012331962585449219  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.012366771697998047  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007372856140136719  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007564544677734375  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007564544677734375  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 9487
output nodes number: 4626
edges number: 25673
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.20231962203979492  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.20232009887695312  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007876873016357422  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 6 input nodes size: 9848
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0073699951171875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0073699951171875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0123291015625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.012363910675048828  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007805347442626953  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00801992416381836  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00801992416381836  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 9848
output nodes number: 4663
edges number: 28676
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.22336244583129883  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.22336292266845703  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008366107940673828  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 7 input nodes size: 8552
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007811069488525391  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007811069488525391  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011888980865478516  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011922836303710938  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006928920745849609  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007084369659423828  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007084369659423828  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 8552
output nodes number: 4539
edges number: 20805
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.16862058639526367  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.16862106323242188  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007336139678955078  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 8 input nodes size: 8059
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0069103240966796875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0069103240966796875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011545181274414062  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011579513549804688  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007467746734619141  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007680416107177734  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007680416107177734  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 8059
output nodes number: 4589
edges number: 28532
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.22219324111938477  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.22219371795654297  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00801229476928711  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 9 input nodes size: 7769
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007475376129150391  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007475376129150391  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011179924011230469  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011213302612304688  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0065441131591796875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006739616394042969  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006739616394042969  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 7769
output nodes number: 4427
edges number: 26165
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.2057194709777832  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.2057199478149414  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00701904296875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 10 input nodes size: 9051
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006519794464111328  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006519794464111328  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010835647583007812  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.01087045669555664  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007132530212402344  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007290840148925781  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007290840148925781  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 9051
output nodes number: 4651
edges number: 21165
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.1691141128540039  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.1691145896911621  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007602691650390625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 11 input nodes size: 11295
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0071659088134765625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0071659088134765625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0128173828125  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.012850761413574219  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008500099182128906  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008667945861816406  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008667945861816406  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 11295
output nodes number: 4429
edges number: 22450
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.1800994873046875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.1800999641418457  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008937358856201172  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 12 input nodes size: 10662
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00846719741821289  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00846719741821289  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.01355123519897461  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.013585567474365234  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007900714874267578  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008063793182373047  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008063793182373047  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 10662
output nodes number: 4568
edges number: 21818
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.17495393753051758  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.17495441436767578  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00837850570678711  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 13 input nodes size: 15623
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007921218872070312  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007921218872070312  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.015370845794677734  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.01540374755859375  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010285377502441406  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010486602783203125  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010486602783203125  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 15623
output nodes number: 4416
edges number: 26959
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.21451520919799805  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.21451568603515625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010831356048583984  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 14 input nodes size: 13292
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010262489318847656  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010262489318847656  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.016600608825683594  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.016633987426757812  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.009151458740234375  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.009332656860351562  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.009332656860351562  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 13292
output nodes number: 4458
edges number: 24279
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.19442415237426758  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.19442462921142578  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.009669780731201172  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 15 input nodes size: 16128
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.009158134460449219  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.009158134460449219  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.01684856414794922  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.016881942749023438  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010510444641113281  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010694503784179688  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010694503784179688  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 16128
output nodes number: 4451
edges number: 24604
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.19705724716186523  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.19705772399902344  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.01104736328125  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 16 input nodes size: 16048
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010509014129638672  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010509014129638672  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.018161296844482422  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.018194198608398438  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010470390319824219  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010659217834472656  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010659217834472656  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 16048
output nodes number: 4414
edges number: 25323
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.20242929458618164  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.20242977142333984  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011012077331542969  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 17 input nodes size: 16678
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010465145111083984  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010465145111083984  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.018417835235595703  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.01845073699951172  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010765552520751953  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010978221893310547  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010978221893310547  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 16678
output nodes number: 4414
edges number: 28508
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.22512292861938477  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.22512340545654297  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011364936828613281  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 18 input nodes size: 10888
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010765552520751953  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.010765552520751953  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.016484737396240234  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.016501903533935547  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008516311645507812  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00864410400390625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.00864410400390625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 10888
output nodes number: 2275
edges number: 17117
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.13731145858764648  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.1373119354248047  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0085601806640625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 19 input nodes size: 10670
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008197307586669922  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008197307586669922  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.013285160064697266  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.013302803039550781  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0075664520263671875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007706642150878906  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007706642150878906  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 10670
output nodes number: 2330
edges number: 18784
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.14824533462524414  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.14824581146240234  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007961750030517578  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 20 input nodes size: 8816
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007575035095214844  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007575035095214844  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011778831481933594  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011795520782470703  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006690025329589844  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006778717041015625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006778717041015625  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 8816
output nodes number: 2212
edges number: 11783
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.09701204299926758  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.09701251983642578  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0069408416748046875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

pseudo mini batch 21 input nodes size: 11139
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006672382354736328  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.006672382354736328  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.011983871459960938  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.012000560760498047  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.0077800750732421875  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007899284362792969  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.007899284362792969  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

input nodes number: 11139
output nodes number: 2214
edges number: 15921
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.12895441055297852  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.12895488739013672  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008127212524414062  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008127212524414062  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3212890625 GB
    Memory Allocated: 0.008127212524414062  GigaBytes
Max Memory Allocated: 0.33069276809692383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006441679867831143 |0.0005339600823142312 |0.029911507259715687 |0.00015273961153897372 |0.02381519837812944 |0.0038220882415771484 |
----------------------------------------------------------pseudo_mini_loss sum 3.169161796569824
Total (block generation + training)time/epoch 15.645027995109558
Training time/epoch 1.463691234588623
Training time without block to device /epoch 1.45194411277771
Training time without total dataloading part /epoch 1.1891698837280273
load block tensor time/epoch 0.14171695709228516
block to device time/epoch 0.011747121810913086
input features size transfer per epoch 2.950429916381836e-06
blocks size to device per epoch 1.9669532775878906e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  240265
Number of first layer input nodes during this epoch:  240265
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])Using backend: pytorch

----------------------------------------
un-trainable parameters
