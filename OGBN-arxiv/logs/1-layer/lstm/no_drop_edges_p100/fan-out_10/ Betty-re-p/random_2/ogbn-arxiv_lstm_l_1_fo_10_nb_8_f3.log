[21:28:04] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14089438 edges into 8 parts and get 1638578 edge cuts
[21:28:07] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 11035 nodes and 2065512 edges into 2 parts and get 119908 edge cuts
main start at this time 1651872470.515326
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.016068220138549805
global_2_local spend time (sec) 0.03960824012756348
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003202676773071289
A = g.adjacency_matrix() spent  0.005576372146606445
auxiliary_graph
Graph(num_nodes=145031, num_edges=14180379,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09737920761108398
remove nodes length
54090
auxiliary_graph.remove_nodes spent  0.8239789009094238
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14180379,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6443271636962891

the counter of shared neighbor distribution
Counter({1.0: 12728892, 2.0: 1148578, 3.0: 165860, 4.0: 33436, 5.0: 8994, 6.0: 2692, 7.0: 738, 8.0: 218, 9.0: 28, 10.0: 2})
14089438
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14089435, 14089436, 14089437])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12728892, 2.0: 1148578, 3.0: 165860, 4.0: 33436, 5.0: 8994, 6.0: 2692, 7.0: 738, 8.0: 218, 9.0: 28, 10.0: 2})
Convert a graph into a bidirected graph: 1.024 seconds
Metis partitioning: 3.220 seconds
Split the graph: 1.147 seconds
Construct subgraphs: 0.048 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.448103666305542
11187
11406
11603
11591
11035
11311
11540
11268
total k batches seeds list generation spend  11.537698984146118
after graph partition
graph partition algorithm spend time 11.605851650238037
11187
11406
11603
11591
11035
11311
11540
11268
partition_len_list
[18251, 19847, 23245, 19234, 36440, 32952, 22669, 26656]
shared_neighbor_graph_partition_s0 selection method  spend 11.699272871017456
time for parepare:  0.017777681350708008
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0020029544830322266
mini_batch_src_global generation:  0.0026133060455322266
r_  generation:  0.02802276611328125
local_output_nid generation:  0.0019011497497558594
local_in_edges_tensor generation:  0.0018575191497802734
mini_batch_src_global generation:  0.0027875900268554688
r_  generation:  0.027390480041503906
local_output_nid generation:  0.0019207000732421875
local_in_edges_tensor generation:  0.0018460750579833984
mini_batch_src_global generation:  0.0025756359100341797
r_  generation:  0.028368473052978516
local_output_nid generation:  0.0018951892852783203
local_in_edges_tensor generation:  0.0018434524536132812
mini_batch_src_global generation:  0.0022649765014648438
r_  generation:  0.0261385440826416
local_output_nid generation:  0.0018634796142578125
local_in_edges_tensor generation:  0.0019621849060058594
mini_batch_src_global generation:  0.0026602745056152344
r_  generation:  0.03000020980834961
local_output_nid generation:  0.0019447803497314453
local_in_edges_tensor generation:  0.0021941661834716797
mini_batch_src_global generation:  0.0033197402954101562
r_  generation:  0.033757925033569336
local_output_nid generation:  0.0022263526916503906
local_in_edges_tensor generation:  0.0019032955169677734
mini_batch_src_global generation:  0.0023474693298339844
r_  generation:  0.027482986450195312
local_output_nid generation:  0.001998424530029297
local_in_edges_tensor generation:  0.0017971992492675781
mini_batch_src_global generation:  0.0020902156829833984
r_  generation:  0.025211572647094727
----------------------check_connections_block total spend ----------------------------- 0.34395599365234375
generate_one_block  0.035672903060913086
generate_one_block  0.03513216972351074
generate_one_block  0.0368494987487793
generate_one_block  0.03179812431335449
generate_one_block  0.043257951736450195
generate_one_block  0.04586195945739746
generate_one_block  0.0351564884185791
generate_one_block  0.035218000411987305
global_2_local spend time (sec) 0.008297443389892578
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0009081363677978516
A = g.adjacency_matrix() spent  0.0019066333770751953
auxiliary_graph
Graph(num_nodes=36440, num_edges=2076547,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.02328777313232422
remove nodes length
25405
auxiliary_graph.remove_nodes spent  0.06789207458496094
after remove non output nodes the auxiliary_graph
Graph(num_nodes=11035, num_edges=2076547,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.06719326972961426

the counter of shared neighbor distribution
Counter({1.0: 1951892, 2.0: 102396, 3.0: 9260, 4.0: 1438, 5.0: 356, 6.0: 134, 7.0: 28, 8.0: 8})
2065512
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.088 seconds
Metis partitioning: 0.237 seconds
Split the graph: 0.253 seconds
Construct subgraphs: 0.022 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.601935863494873
5462
5573
total k batches seeds list generation spend  1.1801412105560303
after graph partition
graph partition algorithm spend time 1.2250986099243164
5462
5573
time for parepare:  0.02946329116821289
local_output_nid generation:  0.0009152889251708984
local_in_edges_tensor generation:  0.004083395004272461
mini_batch_src_global generation:  0.0019519329071044922
r_  generation:  0.012854814529418945
local_output_nid generation:  0.000972747802734375
local_in_edges_tensor generation:  0.001203775405883789
mini_batch_src_global generation:  0.005432844161987305
r_  generation:  0.016786575317382812
----------------------check_connections_block total spend ----------------------------- 0.0907135009765625
generate_one_block  0.02930164337158203
generate_one_block  0.023070096969604492
global_2_local spend time (sec) 0.0073816776275634766
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0015633106231689453
A = g.adjacency_matrix() spent  0.0011315345764160156
auxiliary_graph
Graph(num_nodes=32952, num_edges=4554727,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.032457828521728516
remove nodes length
21641
auxiliary_graph.remove_nodes spent  0.21198177337646484
after remove non output nodes the auxiliary_graph
Graph(num_nodes=11311, num_edges=4554727,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.19621610641479492

the counter of shared neighbor distribution
Counter({1.0: 4090048, 2.0: 403320, 3.0: 44426, 4.0: 4790, 5.0: 586, 6.0: 144, 7.0: 70, 8.0: 30, 9.0: 2})[21:28:10] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 11311 nodes and 4543416 edges into 2 parts and get 691827 edge cuts

4543416
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.204 seconds
Metis partitioning: 0.528 seconds
Split the graph: 0.471 seconds
Construct subgraphs: 0.007 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  1.2135887145996094
5682
5629
total k batches seeds list generation spend  2.48903751373291
after graph partition
graph partition algorithm spend time 2.527740001678467
5682
5629
time for parepare:  0.031005144119262695
local_output_nid generation:  0.0009918212890625
local_in_edges_tensor generation:  0.004361391067504883
mini_batch_src_global generation:  0.0021622180938720703
r_  generation:  0.03557538986206055
local_output_nid generation:  0.0015058517456054688
local_in_edges_tensor generation:  0.002199411392211914
mini_batch_src_global generation:  0.0028429031372070312
r_  generation:  0.023443222045898438
----------------------check_connections_block total spend ----------------------------- 0.1304481029510498
generate_one_block  0.04896354675292969
generate_one_block  0.02161097526550293
----------===============-------------===============-------------the number of batches ***** 10

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 18251
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.00923299789428711  GigaBytes
Max Memory Allocated: 0.00923299789428711  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.009316444396972656  GigaBytes
Max Memory Allocated: 0.009316444396972656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.009316444396972656  GigaBytes
Max Memory Allocated: 0.009316444396972656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.009804725646972656  GigaBytes
Max Memory Allocated: 0.009804725646972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.009804725646972656  GigaBytes
Max Memory Allocated: 0.009804725646972656  GigaBytes

input nodes number: 18251
output nodes number: 11187
edges number: 65444
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.5069971084594727  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.5069980621337891  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.012753009796142578  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

pseudo mini batch 1 input nodes size: 19847
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.011514663696289062  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.011514663696289062  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.020978450775146484  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.021063804626464844  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.012277603149414062  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.012749671936035156  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.012749671936035156  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

input nodes number: 19847
output nodes number: 11406
edges number: 63256
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.4998931884765625  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.4998936653137207  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.013531208038330078  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

pseudo mini batch 2 input nodes size: 23245
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.012310504913330078  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.012310504913330078  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.02339458465576172  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.023481369018554688  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.013932228088378906  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.014417648315429688  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5576171875 GB
    Memory Allocated: 0.014417648315429688  GigaBytes
Max Memory Allocated: 0.5477104187011719  GigaBytes

input nodes number: 23245
output nodes number: 11603
edges number: 65122
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.5138912200927734  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.5138916969299316  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.01523590087890625  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 3 input nodes size: 19234
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.013961315155029297  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.013961315155029297  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.023132801055908203  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.023219585418701172  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.012048721313476562  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.012470245361328125  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.012470245361328125  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 19234
output nodes number: 11591
edges number: 56544
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.45420169830322266  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.45420217514038086  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.013164043426513672  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 4 input nodes size: 22669
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012047290802001953  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012047290802001953  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.022856712341308594  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.02294301986694336  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.013684749603271484  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.014132022857666016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.014132022857666016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 22669
output nodes number: 11540
edges number: 59946
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.47433996200561523  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.47434043884277344  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.014870643615722656  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 5 input nodes size: 26656
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.013677120208740234  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.013677120208740234  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.026387691497802734  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.026472091674804688  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.015576362609863281  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.015984535217285156  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.015984535217285156  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 26656
output nodes number: 11268
edges number: 54724
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.43833494186401367  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.4383354187011719  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.0166778564453125  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 6 input nodes size: 19102
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.015535831451416016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.015535831451416016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.025415897369384766  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.025456905364990234  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012661933898925781  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012904167175292969  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012904167175292969  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 19102
output nodes number: 5462
edges number: 32416
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.2580423355102539  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.2580428123474121  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012485027313232422  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 7 input nodes size: 22038
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.01179647445678711  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.01179647445678711  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.022305011749267578  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.022346973419189453  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012425899505615234  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012708187103271484  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012708187103271484  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 22038
output nodes number: 5573
edges number: 37809
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.29801273345947266  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.29801321029663086  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.013234615325927734  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 8 input nodes size: 21285
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012442588806152344  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012442588806152344  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.02259206771850586  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.022634506225585938  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012084007263183594  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012411117553710938  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012411117553710938  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 21285
output nodes number: 5682
edges number: 43819
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.34055089950561523  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.34055137634277344  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012977123260498047  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 9 input nodes size: 19298
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.0121002197265625  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.0121002197265625  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.021302223205566406  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.02134418487548828  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.011152267456054688  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.011408805847167969  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.011408805847167969  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 19298
output nodes number: 5629
edges number: 34334
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.2759218215942383  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.2759222984313965  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.011864662170410156  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012925148010253906  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012925148010253906  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009640169143676759 |0.04185130596160889 |0.07249746322631836 |0.0001813650131225586 |0.024826312065124513 |0.0037894248962402344 |
----------------------------------------------------------pseudo_mini_loss sum 3.837966203689575
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  211625
Number of first layer input nodes during this epoch:  211625
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012924671173095703  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022032976150512695
number of batches is  10
batch size is  9095
random selection method spend 0.008936882019042969
time for parepare:  0.0254366397857666
local_output_nid generation:  0.004094600677490234
local_in_edges_tensor generation:  0.010786771774291992
mini_batch_src_global generation:  0.0023283958435058594
r_  generation:  0.025188684463500977
local_output_nid generation:  0.007504463195800781
local_in_edges_tensor generation:  0.0036482810974121094
mini_batch_src_global generation:  0.0025119781494140625
r_  generation:  0.023856163024902344
local_output_nid generation:  0.004633903503417969
local_in_edges_tensor generation:  0.0018780231475830078
mini_batch_src_global generation:  0.0015609264373779297
r_  generation:  0.02325153350830078
local_output_nid generation:  0.004318952560424805
local_in_edges_tensor generation:  0.001758575439453125
mini_batch_src_global generation:  0.0015878677368164062
r_  generation:  0.024537324905395508
local_output_nid generation:  0.004513263702392578
local_in_edges_tensor generation:  0.002321958541870117
mini_batch_src_global generation:  0.0016369819641113281
r_  generation:  0.024402618408203125
local_output_nid generation:  0.004420757293701172
local_in_edges_tensor generation:  0.0019931793212890625
mini_batch_src_global generation:  0.0017278194427490234
r_  generation:  0.024828433990478516
local_output_nid generation:  0.004405975341796875
local_in_edges_tensor generation:  0.0020177364349365234
mini_batch_src_global generation:  0.0017592906951904297
r_  generation:  0.02743244171142578
local_output_nid generation:  0.0054280757904052734
local_in_edges_tensor generation:  0.0031414031982421875
mini_batch_src_global generation:  0.0023190975189208984
r_  generation:  0.025147438049316406
local_output_nid generation:  0.0043926239013671875
local_in_edges_tensor generation:  0.0021851062774658203
mini_batch_src_global generation:  0.0017092227935791016
r_  generation:  0.023959636688232422
local_output_nid generation:  0.0042078495025634766
local_in_edges_tensor generation:  0.0028231143951416016
mini_batch_src_global generation:  0.0024518966674804688
r_  generation:  0.02410125732421875
----------------------check_connections_block total spend ----------------------------- 0.4368584156036377
generate_one_block  0.05721426010131836
generate_one_block  0.0525970458984375
generate_one_block  0.033266544342041016
generate_one_block  0.034876108169555664
generate_one_block  0.03334379196166992
generate_one_block  0.033982038497924805
generate_one_block  0.03381776809692383
generate_one_block  0.033521175384521484
generate_one_block  0.03342747688293457
generate_one_block  0.03490138053894043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012924671173095703  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.8995919227600098
pseudo mini batch 0 input nodes size: 43264
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012204170227050781  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.012204170227050781  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.03283405303955078  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.03290224075317383  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.023658275604248047  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.024048328399658203  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5634765625 GB
    Memory Allocated: 0.024048328399658203  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 43264
output nodes number: 9095
edges number: 52302
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.4255800247192383  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.4255809783935547  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.025380611419677734  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 1 input nodes size: 42874
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.024175643920898438  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.024175643920898438  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.04461956024169922  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.044687747955322266  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02398967742919922  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.024374008178710938  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.024374008178710938  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42874
output nodes number: 9095
edges number: 51523
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.41528940200805664  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.41528987884521484  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.025180339813232422  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 2 input nodes size: 42573
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02398967742919922  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02398967742919922  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.04429006576538086  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.044358253479003906  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.023846149444580078  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.024225711822509766  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.024225711822509766  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42573
output nodes number: 9095
edges number: 50941
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.4099583625793457  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.4099588394165039  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.025025367736816406  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 3 input nodes size: 42629
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.023846149444580078  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.023846149444580078  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.044173240661621094  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.04424142837524414  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.023872852325439453  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02425241470336914  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02425241470336914  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42629
output nodes number: 9095
edges number: 50929
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.4121370315551758  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.412137508392334  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.025052547454833984  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 4 input nodes size: 43065
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.023872852325439453  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.023872852325439453  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.04440784454345703  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.04447603225708008  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.024080753326416016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.024463176727294922  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.024463176727294922  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 43065
output nodes number: 9095
edges number: 51279
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4130740165710449  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4130744934082031  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025269031524658203  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 5 input nodes size: 42976
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024080753326416016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024080753326416016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.044573307037353516  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04464149475097656  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024038314819335938  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024423599243164062  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024423599243164062  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42976
output nodes number: 9095
edges number: 51708
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.42145776748657227  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.42145824432373047  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02523183822631836  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 6 input nodes size: 42875
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024038314819335938  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024038314819335938  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04448270797729492  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04455089569091797  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023990154266357422  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024372577667236328  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024372577667236328  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42875
output nodes number: 9095
edges number: 51237
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4130573272705078  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.413057804107666  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025177001953125  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 7 input nodes size: 42887
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023990154266357422  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023990154266357422  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.044440269470214844  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04450845718383789  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02399587631225586  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024379253387451172  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024379253387451172  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42887
output nodes number: 9095
edges number: 51413
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4145536422729492  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4145541191101074  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025185108184814453  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 8 input nodes size: 42598
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02399587631225586  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02399587631225586  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04430818557739258  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.044376373291015625  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023858070373535156  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024239540100097656  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024239540100097656  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42598
output nodes number: 9095
edges number: 51165
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4113650321960449  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4113655090332031  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02504110336303711  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 9 input nodes size: 42641
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023858070373535156  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023858070373535156  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04419088363647461  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04425859451293945  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023878097534179688  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024257659912109375  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024257659912109375  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42641
output nodes number: 9086
edges number: 50917
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.41170549392700195  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.41170597076416016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025055408477783203  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025055408477783203  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025055408477783203  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00879652500152588 |0.0005797386169433594 |0.027150440216064452 |0.00014574527740478515 |0.024468636512756346 |0.0030601024627685547 |
----------------------------------------------------------pseudo_mini_loss sum 3.26849365234375
Total (block generation + training)time/epoch 1.5629794597625732
Training time/epoch 0.6630988121032715
Training time without block to device /epoch 0.6573014259338379
Training time without total dataloading part /epoch 0.5207083225250244
load block tensor time/epoch 0.08796525001525879
block to device time/epoch 0.005797386169433594
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  428382
Number of first layer input nodes during this epoch:  428382
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025054931640625  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.016572952270507812
number of batches is  10
batch size is  9095
random selection method spend 0.01095438003540039
time for parepare:  0.030982494354248047
local_output_nid generation:  0.004705905914306641
local_in_edges_tensor generation:  0.018513202667236328
mini_batch_src_global generation:  0.0027375221252441406
r_  generation:  0.03303790092468262
local_output_nid generation:  0.005847930908203125
local_in_edges_tensor generation:  0.0030710697174072266
mini_batch_src_global generation:  0.003513336181640625
r_  generation:  0.024165868759155273
local_output_nid generation:  0.005023002624511719
local_in_edges_tensor generation:  0.0024518966674804688
mini_batch_src_global generation:  0.0016469955444335938
r_  generation:  0.025067567825317383
local_output_nid generation:  0.004324913024902344
local_in_edges_tensor generation:  0.0022678375244140625
mini_batch_src_global generation:  0.0016100406646728516
r_  generation:  0.02368617057800293
local_output_nid generation:  0.004122495651245117
local_in_edges_tensor generation:  0.0018706321716308594
mini_batch_src_global generation:  0.0016317367553710938
r_  generation:  0.024520397186279297
local_output_nid generation:  0.004060506820678711
local_in_edges_tensor generation:  0.0023801326751708984
mini_batch_src_global generation:  0.0016486644744873047
r_  generation:  0.024857521057128906
local_output_nid generation:  0.004076242446899414
local_in_edges_tensor generation:  0.002211332321166992
mini_batch_src_global generation:  0.0016810894012451172
r_  generation:  0.024085283279418945
local_output_nid generation:  0.004166126251220703
local_in_edges_tensor generation:  0.0018699169158935547
mini_batch_src_global generation:  0.0017440319061279297
r_  generation:  0.024115324020385742
local_output_nid generation:  0.0047609806060791016
local_in_edges_tensor generation:  0.002580404281616211
mini_batch_src_global generation:  0.002536773681640625
r_  generation:  0.037215232849121094
local_output_nid generation:  0.005985260009765625
local_in_edges_tensor generation:  0.002947092056274414
mini_batch_src_global generation:  0.002572774887084961
r_  generation:  0.03658652305603027
----------------------check_connections_block total spend ----------------------------- 0.48768186569213867
generate_one_block  0.0503544807434082
generate_one_block  0.048067331314086914
generate_one_block  0.04905223846435547
generate_one_block  0.048655033111572266
generate_one_block  0.048931121826171875
generate_one_block  0.04830741882324219
generate_one_block  0.04455971717834473
generate_one_block  0.0334315299987793
generate_one_block  0.03366565704345703
generate_one_block  0.03306412696838379
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025054931640625  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.9460463523864746
pseudo mini batch 0 input nodes size: 43077
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023875713348388672  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023875713348388672  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04441642761230469  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.044484615325927734  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024084091186523438  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024466514587402344  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024466514587402344  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 43077
output nodes number: 9095
edges number: 51310
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.413515567779541  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4135165214538574  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025275230407714844  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 1 input nodes size: 42834
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024086475372314453  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024086475372314453  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04451131820678711  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.044579505920410156  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023970603942871094  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02435016632080078  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02435016632080078  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42834
output nodes number: 9095
edges number: 50888
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.40966367721557617  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4096641540527344  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025151729583740234  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 2 input nodes size: 43023
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023970603942871094  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023970603942871094  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04448556900024414  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04455375671386719  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024060726165771484  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024446964263916016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024446964263916016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 43023
output nodes number: 9095
edges number: 51793
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4232792854309082  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4232797622680664  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025256633758544922  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 3 input nodes size: 43055
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024060726165771484  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024060726165771484  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04459095001220703  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04465913772583008  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024075984954833984  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024460315704345703  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024460315704345703  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 43055
output nodes number: 9095
edges number: 51544
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.41721582412719727  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.41721630096435547  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025268077850341797  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 4 input nodes size: 42873
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024075984954833984  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024075984954833984  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04451942443847656  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04458761215209961  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023989200592041016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024372577667236328  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024372577667236328  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42873
output nodes number: 9095
edges number: 51394
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4137406349182129  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4137411117553711  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025177955627441406  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 5 input nodes size: 42849
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023989200592041016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023989200592041016  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04442119598388672  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.044489383697509766  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02397775650024414  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02435922622680664  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02435922622680664  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42849
output nodes number: 9095
edges number: 51198
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4136834144592285  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4136838912963867  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025162696838378906  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 6 input nodes size: 42640
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02397775650024414  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02397775650024414  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04431009292602539  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04437828063964844  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023878097534179688  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024259567260742188  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024259567260742188  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42640
output nodes number: 9095
edges number: 51126
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4120607376098633  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4120612144470215  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.025061607360839844  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 7 input nodes size: 42870
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023878097534179688  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023878097534179688  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.044320106506347656  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.0443882942199707  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023987770080566406  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024372100830078125  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024372100830078125  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42870
output nodes number: 9095
edges number: 51569
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.42313432693481445  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.42313480377197266  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02517843246459961  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 8 input nodes size: 42825
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023987770080566406  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023987770080566406  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.044408321380615234  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04447650909423828  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023966312408447266  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02435159683227539  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02435159683227539  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42825
output nodes number: 9095
edges number: 51619
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4231123924255371  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4231128692626953  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02515888214111328  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

pseudo mini batch 9 input nodes size: 42390
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023966312408447266  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023966312408447266  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes
Using backend: pytorch

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.044179439544677734  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.04424715042114258  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.023758411407470703  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024138927459716797  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.024138927459716797  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

input nodes number: 42390
output nodes number: 9086
edges number: 50973
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4094719886779785  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.4094724655151367  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02493572235107422  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02493572235107422  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5986328125 GB
    Memory Allocated: 0.02493572235107422  GigaBytes
Max Memory Allocated: 0.5558414459228516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00939953327178955 |0.001061415672302246 |0.028185725212097168 |0.00015316009521484374 |0.024663877487182618 |0.0026438236236572266 |
----------------------------------------------------------pseudo_mini_loss sum 3.1691620349884033
Total (block generation + training)time/epoch 1.6213011741638184
Training time/epoch 0.6869714260101318
Training time without block to device /epoch 0.6763572692871094
Training time without total dataloading part /epoch 0.5326714515686035
load block tensor time/epoch 0.09399533271789551
block to device time/epoch 0.010614156723022461
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  428436
Number of first layer input nodes during this epoch:  428436
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
