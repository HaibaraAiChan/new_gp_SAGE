main start at this time 1651799524.4061413
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028584003448486328
number of batches is  4
batch size is  22736
range selection method spend 0.014085054397583008
time for parepare:  0.020084142684936523
local_output_nid generation:  0.006280422210693359
local_in_edges_tensor generation:  0.009138345718383789
mini_batch_src_global generation:  0.005231380462646484
r_  generation:  0.0652158260345459
local_output_nid generation:  0.008226156234741211
local_in_edges_tensor generation:  0.0044062137603759766
mini_batch_src_global generation:  0.006181001663208008
r_  generation:  0.06655454635620117
local_output_nid generation:  0.00810098648071289
local_in_edges_tensor generation:  0.002920389175415039
mini_batch_src_global generation:  0.004563808441162109
r_  generation:  0.06885099411010742
local_output_nid generation:  0.007941007614135742
local_in_edges_tensor generation:  0.002928018569946289
mini_batch_src_global generation:  0.00480341911315918
r_  generation:  0.06871867179870605
----------------------check_connections_block total spend ----------------------------- 0.41660475730895996
generate_one_block  0.08243846893310547
generate_one_block  0.08014321327209473
generate_one_block  0.07994842529296875
generate_one_block  0.08019852638244629
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 80442
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8603515625 GB
    Memory Allocated: 0.039592742919921875  GigaBytes
Max Memory Allocated: 0.039592742919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8603515625 GB
    Memory Allocated: 0.03976249694824219  GigaBytes
Max Memory Allocated: 0.03976249694824219  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8603515625 GB
    Memory Allocated: 0.03976249694824219  GigaBytes
Max Memory Allocated: 0.03976249694824219  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.9091796875 GB
    Memory Allocated: 0.04071617126464844  GigaBytes
Max Memory Allocated: 0.04071617126464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.9091796875 GB
    Memory Allocated: 0.04071617126464844  GigaBytes
Max Memory Allocated: 0.04071617126464844  GigaBytes

input nodes number: 80442
output nodes number: 22736
edges number: 127916
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0732421875 GB
    Memory Allocated: 1.0309038162231445  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0732421875 GB
    Memory Allocated: 1.030904769897461  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0751953125 GB
    Memory Allocated: 0.04644298553466797  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

pseudo mini batch 1 input nodes size: 80389
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0751953125 GB
    Memory Allocated: 0.04368162155151367  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0751953125 GB
    Memory Allocated: 0.04368162155151367  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0751953125 GB
    Memory Allocated: 0.08201408386230469  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0751953125 GB
    Memory Allocated: 0.082183837890625  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0751953125 GB
    Memory Allocated: 0.04295158386230469  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0751953125 GB
    Memory Allocated: 0.043908119201660156  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0751953125 GB
    Memory Allocated: 0.043908119201660156  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

input nodes number: 80389
output nodes number: 22736
edges number: 128327
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1728515625 GB
    Memory Allocated: 1.0220508575439453  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1728515625 GB
    Memory Allocated: 1.0220513343811035  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1728515625 GB
    Memory Allocated: 0.04571866989135742  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

pseudo mini batch 2 input nodes size: 80951
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1728515625 GB
    Memory Allocated: 0.04295158386230469  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1728515625 GB
    Memory Allocated: 0.04295158386230469  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1728515625 GB
    Memory Allocated: 0.08201408386230469  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1728515625 GB
    Memory Allocated: 0.082183837890625  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1728515625 GB
    Memory Allocated: 0.04368162155151367  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1728515625 GB
    Memory Allocated: 0.04464387893676758  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1728515625 GB
    Memory Allocated: 0.04464387893676758  GigaBytes
Max Memory Allocated: 1.1092381477355957  GigaBytes

input nodes number: 80951
output nodes number: 22736
edges number: 129063
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.0287470817565918  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.02874755859375  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.046463966369628906  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

pseudo mini batch 3 input nodes size: 80669
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04368162155151367  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04368162155151367  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08214759826660156  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08231735229492188  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04308509826660156  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04403972625732422  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04403972625732422  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

input nodes number: 80669
output nodes number: 22733
edges number: 128108
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.020418643951416  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.0204191207885742  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.045850276947021484  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.046910762786865234  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.046910762786865234  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.022017717361450195 |0.10209465026855469 |0.13314425945281982 |0.00014716386795043945 |0.02248305082321167 |0.001986980438232422 |
----------------------------------------------------------pseudo_mini_loss sum 3.838047504425049
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  322451
Number of first layer input nodes during this epoch:  322451
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04691028594970703  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.011199474334716797
number of batches is  4
batch size is  22736
range selection method spend 0.013855218887329102
time for parepare:  0.01930069923400879
local_output_nid generation:  0.00624537467956543
local_in_edges_tensor generation:  0.0064067840576171875
mini_batch_src_global generation:  0.005235910415649414
r_  generation:  0.06451702117919922
local_output_nid generation:  0.008165359497070312
local_in_edges_tensor generation:  0.0029273033142089844
mini_batch_src_global generation:  0.006028652191162109
r_  generation:  0.06693387031555176
local_output_nid generation:  0.008058547973632812
local_in_edges_tensor generation:  0.0030117034912109375
mini_batch_src_global generation:  0.004431486129760742
r_  generation:  0.0670623779296875
local_output_nid generation:  0.008129119873046875
local_in_edges_tensor generation:  0.003052234649658203
mini_batch_src_global generation:  0.004730224609375
r_  generation:  0.06805849075317383
----------------------check_connections_block total spend ----------------------------- 0.40819549560546875
generate_one_block  0.08574867248535156
generate_one_block  0.07828092575073242
generate_one_block  0.07834267616271973
generate_one_block  0.08238887786865234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04691028594970703  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.7926716804504395
pseudo mini batch 0 input nodes size: 80153
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.044144630432128906  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.044144630432128906  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.0832071304321289  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08337688446044922  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.044741153717041016  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04569864273071289  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04569864273071289  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

input nodes number: 80153
output nodes number: 22736
edges number: 128490
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.0261025428771973  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.0261034965515137  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.047509193420410156  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

pseudo mini batch 1 input nodes size: 80589
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08316993713378906  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08333969116210938  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04410743713378906  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.045065879821777344  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.045065879821777344  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

input nodes number: 80589
output nodes number: 22736
edges number: 128634
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.0249652862548828  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.024965763092041  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04687976837158203  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

pseudo mini batch 2 input nodes size: 80464
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04410743713378906  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04410743713378906  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08316993713378906  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08333969116210938  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04569864273071289  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04569864273071289  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

input nodes number: 80464
output nodes number: 22736
edges number: 128321
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.0229392051696777  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.022939682006836  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04750967025756836  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

pseudo mini batch 3 input nodes size: 80769
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08325576782226562  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08342552185058594  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.044193267822265625  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.045146942138671875  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.045146942138671875  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

input nodes number: 80769
output nodes number: 22733
edges number: 127969
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.0221776962280273  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.0221781730651855  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04695749282836914  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04695749282836914  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04695749282836914  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01727372407913208 |0.0008061528205871582 |0.021160006523132324 |0.00011360645294189453 |0.022141456604003906 |0.0016200542449951172 |
----------------------------------------------------------pseudo_mini_loss sum 3.268394947052002
Total (block generation + training)time/epoch 1.055368185043335
Training time/epoch 0.2625100612640381
Training time without block to device /epoch 0.25928544998168945
Training time without total dataloading part /epoch 0.17528033256530762
load block tensor time/epoch 0.06909489631652832
block to device time/epoch 0.003224611282348633
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  321975
Number of first layer input nodes during this epoch:  321975
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04695701599121094  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02091383934020996
number of batches is  4
batch size is  22736
range selection method spend 0.014926910400390625
time for parepare:  0.020996809005737305
local_output_nid generation:  0.00638580322265625
local_in_edges_tensor generation:  0.008633852005004883
mini_batch_src_global generation:  0.005461454391479492
r_  generation:  0.06461930274963379
local_output_nid generation:  0.008204460144042969
local_in_edges_tensor generation:  0.003476381301879883
mini_batch_src_global generation:  0.007511138916015625
r_  generation:  0.06734442710876465
local_output_nid generation:  0.008239984512329102
local_in_edges_tensor generation:  0.003592252731323242
mini_batch_src_global generation:  0.004742622375488281
r_  generation:  0.06784558296203613
local_output_nid generation:  0.0081787109375
local_in_edges_tensor generation:  0.0030367374420166016
mini_batch_src_global generation:  0.004628181457519531
r_  generation:  0.07014632225036621
----------------------check_connections_block total spend ----------------------------- 0.41503262519836426
generate_one_block  0.0830698013305664
generate_one_block  0.07862138748168945
generate_one_block  0.07757258415222168
generate_one_block  0.07784557342529297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04695701599121094  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.7957789897918701
pseudo mini batch 0 input nodes size: 80542
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04419231414794922  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04419231414794922  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08325481414794922  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08342456817626953  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.044741153717041016  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04569196701049805  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04569196701049805  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

input nodes number: 80542
output nodes number: 22736
edges number: 127549
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.0201125144958496  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.020113468170166  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04749870300292969  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

pseudo mini batch 1 input nodes size: 80672
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08320951461791992  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08337926864624023  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04414701461791992  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.045102596282958984  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.045102596282958984  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

input nodes number: 80672
output nodes number: 22736
edges number: 128140
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.0181312561035156  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.0181317329406738  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.046914100646972656  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

pseudo mini batch 2 input nodes size: 80613
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04414701461791992  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04414701461791992  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08320951461791992  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08337926864624023  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.0456995964050293  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.0456995964050293  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

input nodes number: 80613
output nodes number: 22736
edges number: 128452
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.024810791015625  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 1.0248112678527832  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04751253128051758  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

pseudo mini batch 3 input nodes size: 80636
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes
Using backend: pytorch

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04474210739135742  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08319234848022461  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.08336210250854492  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04412984848022461  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04509305953979492  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2080078125 GB
    Memory Allocated: 0.04509305953979492  GigaBytes
Max Memory Allocated: 1.1134238243103027  GigaBytes

input nodes number: 80636
output nodes number: 22733
edges number: 129273
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2099609375 GB
    Memory Allocated: 1.0297050476074219  GigaBytes
Max Memory Allocated: 1.1142101287841797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2099609375 GB
    Memory Allocated: 1.02970552444458  GigaBytes
Max Memory Allocated: 1.1142101287841797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2099609375 GB
    Memory Allocated: 0.04691171646118164  GigaBytes
Max Memory Allocated: 1.1142101287841797  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.2099609375 GB
    Memory Allocated: 0.04691171646118164  GigaBytes
Max Memory Allocated: 1.1142101287841797  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.2099609375 GB
    Memory Allocated: 0.04691171646118164  GigaBytes
Max Memory Allocated: 1.1142101287841797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017532944679260254 |0.0007984042167663574 |0.025833189487457275 |0.00012493133544921875 |0.02230137586593628 |0.0033752918243408203 |
----------------------------------------------------------pseudo_mini_loss sum 3.169322967529297
Total (block generation + training)time/epoch 1.0704989433288574
Training time/epoch 0.28661274909973145
Training time without block to device /epoch 0.283419132232666
Training time without total dataloading part /epoch 0.19641327857971191
load block tensor time/epoch 0.07013177871704102
block to device time/epoch 0.0031936168670654297
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  322463
Number of first layer input nodes during this epoch:  322463
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
