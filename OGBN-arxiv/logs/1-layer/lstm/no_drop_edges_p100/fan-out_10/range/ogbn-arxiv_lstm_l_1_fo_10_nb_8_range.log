main start at this time 1651799539.5604684
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018434762954711914
number of batches is  8
batch size is  11368
range selection method spend 0.014799118041992188
time for parepare:  0.018791675567626953
local_output_nid generation:  0.0030167102813720703
local_in_edges_tensor generation:  0.009182214736938477
mini_batch_src_global generation:  0.0036008358001708984
r_  generation:  0.03057265281677246
local_output_nid generation:  0.0036792755126953125
local_in_edges_tensor generation:  0.0016837120056152344
mini_batch_src_global generation:  0.0040073394775390625
r_  generation:  0.030161142349243164
local_output_nid generation:  0.003330707550048828
local_in_edges_tensor generation:  0.0016512870788574219
mini_batch_src_global generation:  0.003405332565307617
r_  generation:  0.032384395599365234
local_output_nid generation:  0.003385782241821289
local_in_edges_tensor generation:  0.0014998912811279297
mini_batch_src_global generation:  0.003270864486694336
r_  generation:  0.03089737892150879
local_output_nid generation:  0.0033750534057617188
local_in_edges_tensor generation:  0.0014393329620361328
mini_batch_src_global generation:  0.003305196762084961
r_  generation:  0.06848788261413574
local_output_nid generation:  0.007684946060180664
local_in_edges_tensor generation:  0.0028831958770751953
mini_batch_src_global generation:  0.00299835205078125
r_  generation:  0.0392000675201416
local_output_nid generation:  0.004824638366699219
local_in_edges_tensor generation:  0.0018758773803710938
mini_batch_src_global generation:  0.0019104480743408203
r_  generation:  0.031148433685302734
local_output_nid generation:  0.004708528518676758
local_in_edges_tensor generation:  0.0015251636505126953
mini_batch_src_global generation:  0.001873016357421875
r_  generation:  0.03001999855041504
----------------------check_connections_block total spend ----------------------------- 0.44737839698791504
generate_one_block  0.04393649101257324
generate_one_block  0.03985428810119629
generate_one_block  0.03951430320739746
generate_one_block  0.03853440284729004
generate_one_block  0.07365202903747559
generate_one_block  0.08051133155822754
generate_one_block  0.04965543746948242
generate_one_block  0.0400238037109375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 50578
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8466796875 GB
    Memory Allocated: 0.02464771270751953  GigaBytes
Max Memory Allocated: 0.02464771270751953  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8466796875 GB
    Memory Allocated: 0.024732589721679688  GigaBytes
Max Memory Allocated: 0.024732589721679688  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8466796875 GB
    Memory Allocated: 0.024732589721679688  GigaBytes
Max Memory Allocated: 0.024732589721679688  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8955078125 GB
    Memory Allocated: 0.025211334228515625  GigaBytes
Max Memory Allocated: 0.025211334228515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8955078125 GB
    Memory Allocated: 0.025211334228515625  GigaBytes
Max Memory Allocated: 0.025211334228515625  GigaBytes

input nodes number: 50578
output nodes number: 11368
edges number: 64177
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.5158066749572754  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.5158076286315918  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.028419971466064453  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

pseudo mini batch 1 input nodes size: 50391
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.026957988739013672  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.026957988739013672  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.050986289978027344  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.0510711669921875  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.026868820190429688  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.02734375  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5595703125 GB
    Memory Allocated: 0.02734375  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

input nodes number: 50391
output nodes number: 11368
edges number: 63739
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.5120062828063965  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.5120067596435547  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.02832174301147461  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

pseudo mini batch 2 input nodes size: 50684
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.026868820190429688  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.026868820190429688  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.051036834716796875  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.05112171173095703  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.027008533477783203  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.027489185333251953  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5908203125 GB
    Memory Allocated: 0.027489185333251953  GigaBytes
Max Memory Allocated: 0.5553460121154785  GigaBytes

input nodes number: 50684
output nodes number: 11368
edges number: 64458
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5927734375 GB
    Memory Allocated: 0.5161871910095215  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5927734375 GB
    Memory Allocated: 0.5161876678466797  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5927734375 GB
    Memory Allocated: 0.028474807739257812  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

pseudo mini batch 3 input nodes size: 50440
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5927734375 GB
    Memory Allocated: 0.027008533477783203  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5927734375 GB
    Memory Allocated: 0.027008533477783203  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5927734375 GB
    Memory Allocated: 0.05106019973754883  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5927734375 GB
    Memory Allocated: 0.051145076751708984  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5927734375 GB
    Memory Allocated: 0.02689218521118164  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5927734375 GB
    Memory Allocated: 0.02736806869506836  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5927734375 GB
    Memory Allocated: 0.02736806869506836  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

input nodes number: 50440
output nodes number: 11368
edges number: 63869
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5117964744567871  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5117969512939453  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028347492218017578  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

pseudo mini batch 4 input nodes size: 50929
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02689218521118164  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02689218521118164  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.051177024841308594  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05126190185546875  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02712535858154297  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02760791778564453  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02760791778564453  GigaBytes
Max Memory Allocated: 0.5572433471679688  GigaBytes

input nodes number: 50929
output nodes number: 11368
edges number: 64692
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5185232162475586  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5185236930847168  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028597354888916016  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

pseudo mini batch 5 input nodes size: 50767
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02712535858154297  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.02712535858154297  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.051332950592041016  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05141782760620117  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027048110961914062  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027527809143066406  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027527809143066406  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

input nodes number: 50767
output nodes number: 11368
edges number: 64371
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5155429840087891  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.5155434608459473  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.028513431549072266  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

pseudo mini batch 6 input nodes size: 50708
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027048110961914062  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027048110961914062  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.051227569580078125  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.05131244659423828  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027019977569580078  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027498722076416016  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5947265625 GB
    Memory Allocated: 0.027498722076416016  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

input nodes number: 50708
output nodes number: 11368
edges number: 64178
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5134925842285156  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5134930610656738  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028482913970947266  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

pseudo mini batch 7 input nodes size: 50377
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027019977569580078  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027019977569580078  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.051041603088378906  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05112648010253906  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.026862144470214844  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02733898162841797  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02733898162841797  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

input nodes number: 50377
output nodes number: 11365
edges number: 63930
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5123424530029297  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5123429298400879  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028318405151367188  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029378890991210938  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029378890991210938  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014286577701568604 |0.050059974193573 |0.08226099610328674 |0.00016707181930541992 |0.022463858127593994 |0.004378080368041992 |
----------------------------------------------------------pseudo_mini_loss sum 3.838047504425049
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  404874
Number of first layer input nodes during this epoch:  404874
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029378414154052734  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.012974262237548828
number of batches is  8
batch size is  11368
range selection method spend 0.02072763442993164
time for parepare:  0.020439624786376953
local_output_nid generation:  0.003258228302001953
local_in_edges_tensor generation:  0.004930734634399414
mini_batch_src_global generation:  0.0024538040161132812
r_  generation:  0.02885150909423828
local_output_nid generation:  0.0035712718963623047
local_in_edges_tensor generation:  0.0015330314636230469
mini_batch_src_global generation:  0.002712249755859375
r_  generation:  0.02935791015625
local_output_nid generation:  0.003882169723510742
local_in_edges_tensor generation:  0.0015306472778320312
mini_batch_src_global generation:  0.001859426498413086
r_  generation:  0.029241323471069336
local_output_nid generation:  0.0039215087890625
local_in_edges_tensor generation:  0.0015482902526855469
mini_batch_src_global generation:  0.0018644332885742188
r_  generation:  0.029627323150634766
local_output_nid generation:  0.0040895938873291016
local_in_edges_tensor generation:  0.0015041828155517578
mini_batch_src_global generation:  0.0019316673278808594
r_  generation:  0.029735565185546875
local_output_nid generation:  0.003355741500854492
local_in_edges_tensor generation:  0.0014867782592773438
mini_batch_src_global generation:  0.0019559860229492188
r_  generation:  0.029257535934448242
local_output_nid generation:  0.0032804012298583984
local_in_edges_tensor generation:  0.0014858245849609375
mini_batch_src_global generation:  0.0019142627716064453
r_  generation:  0.029507875442504883
local_output_nid generation:  0.003293752670288086
local_in_edges_tensor generation:  0.001504659652709961
mini_batch_src_global generation:  0.0019254684448242188
r_  generation:  0.030328035354614258
----------------------check_connections_block total spend ----------------------------- 0.3661673069000244
generate_one_block  0.04305863380432129
generate_one_block  0.03934931755065918
generate_one_block  0.04011368751525879
generate_one_block  0.04095935821533203
generate_one_block  0.07361507415771484
generate_one_block  0.061125755310058594
generate_one_block  0.04056286811828613
generate_one_block  0.042038679122924805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029378414154052734  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.8157451152801514
pseudo mini batch 0 input nodes size: 50454
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027921199798583984  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027921199798583984  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05197954177856445  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05206441879272461  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027957916259765625  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02843952178955078  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02843952178955078  GigaBytes
Max Memory Allocated: 0.5595536231994629  GigaBytes

input nodes number: 50454
output nodes number: 11368
edges number: 64546
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5190939903259277  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5190949440002441  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029426097869873047  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

pseudo mini batch 1 input nodes size: 50588
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027959346771240234  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027959346771240234  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05208158493041992  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05216646194458008  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028023242950439453  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028500080108642578  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028500080108642578  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

input nodes number: 50588
output nodes number: 11368
edges number: 63944
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5131916999816895  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5131921768188477  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02948141098022461  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

pseudo mini batch 2 input nodes size: 50881
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028023242950439453  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028023242950439453  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.052285194396972656  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05237007141113281  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02816295623779297  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.0286407470703125  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.0286407470703125  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

input nodes number: 50881
output nodes number: 11368
edges number: 64109
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5151119232177734  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5151124000549316  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029625415802001953  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

pseudo mini batch 3 input nodes size: 50620
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02816295623779297  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02816295623779297  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.052300453186035156  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05238533020019531  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028038501739501953  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02852010726928711  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02852010726928711  GigaBytes
Max Memory Allocated: 0.5603394508361816  GigaBytes

input nodes number: 50620
output nodes number: 11368
edges number: 64525
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5197319984436035  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5197324752807617  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029506206512451172  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

pseudo mini batch 4 input nodes size: 50594
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028038501739501953  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028038501739501953  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05216360092163086  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.052248477935791016  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028026103973388672  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028505802154541016  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028505802154541016  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

input nodes number: 50594
output nodes number: 11368
edges number: 64324
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.516995906829834  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5169963836669922  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029489994049072266  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

pseudo mini batch 5 input nodes size: 50612
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028026103973388672  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028026103973388672  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.052159786224365234  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05224466323852539  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028034687042236328  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028511524200439453  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028511524200439453  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

input nodes number: 50612
output nodes number: 11368
edges number: 63997
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.516294002532959  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5162944793701172  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.03033590316772461  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

pseudo mini batch 6 input nodes size: 50708
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028877735137939453  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028877735137939453  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.053057193756103516  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05314207077026367  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028923511505126953  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029401302337646484  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029401302337646484  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

input nodes number: 50708
output nodes number: 11368
edges number: 64115
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5145807266235352  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5145812034606934  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029541492462158203  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

pseudo mini batch 7 input nodes size: 50623
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028080463409423828  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028080463409423828  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.052219390869140625  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05230426788330078  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028039932250976562  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02851581573486328  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02851581573486328  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

input nodes number: 50623
output nodes number: 11365
edges number: 63854
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5137214660644531  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5137219429016113  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029495716094970703  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029495716094970703  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029495716094970703  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009390383958816528 |0.0006875693798065186 |0.026135176420211792 |0.00014275312423706055 |0.02197280526161194 |0.003545045852661133 |
----------------------------------------------------------pseudo_mini_loss sum 3.268394947052002
Total (block generation + training)time/epoch 1.3318285942077637
Training time/epoch 0.5158154964447021
Training time without block to device /epoch 0.51031494140625
Training time without total dataloading part /epoch 0.38955092430114746
load block tensor time/epoch 0.07512307167053223
block to device time/epoch 0.0055005550384521484
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  405080
Number of first layer input nodes during this epoch:  405080
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.0294952392578125  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.014843225479125977
number of batches is  8
batch size is  11368
range selection method spend 0.02478814125061035
time for parepare:  0.028374671936035156
local_output_nid generation:  0.0048313140869140625
local_in_edges_tensor generation:  0.006175041198730469
mini_batch_src_global generation:  0.0035898685455322266
r_  generation:  0.029854297637939453
local_output_nid generation:  0.0038022994995117188
local_in_edges_tensor generation:  0.0015935897827148438
mini_batch_src_global generation:  0.003968954086303711
r_  generation:  0.030303955078125
local_output_nid generation:  0.0035500526428222656
local_in_edges_tensor generation:  0.0014722347259521484
mini_batch_src_global generation:  0.00724339485168457
r_  generation:  0.03204798698425293
local_output_nid generation:  0.003626108169555664
local_in_edges_tensor generation:  0.0015301704406738281
mini_batch_src_global generation:  0.003249645233154297
r_  generation:  0.0306243896484375
local_output_nid generation:  0.0034940242767333984
local_in_edges_tensor generation:  0.0014829635620117188
mini_batch_src_global generation:  0.0032858848571777344
r_  generation:  0.03307986259460449
local_output_nid generation:  0.003527402877807617
local_in_edges_tensor generation:  0.002050638198852539
mini_batch_src_global generation:  0.004662990570068359
r_  generation:  0.031168460845947266
local_output_nid generation:  0.0033576488494873047
local_in_edges_tensor generation:  0.0018620491027832031
mini_batch_src_global generation:  0.0034894943237304688
r_  generation:  0.03293871879577637
local_output_nid generation:  0.0033757686614990234
local_in_edges_tensor generation:  0.002362966537475586
mini_batch_src_global generation:  0.003366231918334961
r_  generation:  0.031511545181274414
----------------------check_connections_block total spend ----------------------------- 0.4120936393737793
generate_one_block  0.040502309799194336
generate_one_block  0.04599475860595703
generate_one_block  0.04934215545654297
generate_one_block  0.04249978065490723
generate_one_block  0.0421144962310791
generate_one_block  0.040219783782958984
generate_one_block  0.04492640495300293
generate_one_block  0.040500640869140625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.0294952392578125  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.8238067626953125
pseudo mini batch 0 input nodes size: 50287
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028038501739501953  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028038501739501953  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.0520172119140625  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.052102088928222656  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027878284454345703  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028353214263916016  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028353214263916016  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

input nodes number: 50287
output nodes number: 11368
edges number: 63633
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5133137702941895  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5133147239685059  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029331684112548828  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

pseudo mini batch 1 input nodes size: 50616
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027879714965820312  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027879714965820312  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05201530456542969  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.052100181579589844  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02803659439086914  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028513431549072266  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028513431549072266  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

input nodes number: 50616
output nodes number: 11368
edges number: 63916
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5134463310241699  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5134468078613281  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029494762420654297  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

pseudo mini batch 2 input nodes size: 50699
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02803659439086914  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02803659439086914  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.052211761474609375  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05229663848876953  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028076171875  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02855682373046875  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02855682373046875  GigaBytes
Max Memory Allocated: 0.5607509613037109  GigaBytes

input nodes number: 50699
output nodes number: 11368
edges number: 64455
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5200815200805664  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5200819969177246  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029542922973632812  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

pseudo mini batch 3 input nodes size: 50447
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028076171875  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028076171875  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05213117599487305  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.0522160530090332  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027956008911132812  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028430938720703125  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028430938720703125  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

input nodes number: 50447
output nodes number: 11368
edges number: 63685
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5127534866333008  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.512753963470459  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029409408569335938  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

pseudo mini batch 4 input nodes size: 50624
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027956008911132812  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.027956008911132812  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05209541320800781  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05218029022216797  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028040409088134766  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028518199920654297  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028518199920654297  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

input nodes number: 50624
output nodes number: 11368
edges number: 64127
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5160923004150391  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5160927772521973  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029500484466552734  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

pseudo mini batch 5 input nodes size: 50739
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028040409088134766  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028040409088134766  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.052234649658203125  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05231952667236328  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028095245361328125  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02857494354248047  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02857494354248047  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

input nodes number: 50739
output nodes number: 11368
edges number: 64325
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.517024040222168  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5170245170593262  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029560089111328125  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

pseudo mini batch 6 input nodes size: 50443
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028095245361328125  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028095245361328125  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05214834213256836  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.052233219146728516  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.0279541015625  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028436660766601562  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028436660766601562  GigaBytes
Max Memory Allocated: 0.5611052513122559  GigaBytes

input nodes number: 50443
output nodes number: 11368
edges number: 64642
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5204653739929199  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5204658508300781  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029422760009765625  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

pseudo mini batch 7 input nodes size: 51041
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.0279541015625  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.0279541015625  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.0522923469543457  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.05237722396850586  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.02823925018310547  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028720855712890625  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.028720855712890625  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

input nodes number: 51041
output nodes number: 11365
edges number: 64631
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5201826095581055  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.5201830863952637  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029709815979003906  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029709815979003906  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5966796875 GB
    Memory Allocated: 0.029709815979003906  GigaBytes
Max Memory Allocated: 0.5617485046386719  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010768234729766846 |0.0006980299949645996 |0.025698065757751465 |0.0001494288444519043 |0.02189040184020996 |0.0016109943389892578 |
----------------------------------------------------------pseudo_mini_loss sum 3.1693227291107178
Total (block generation + training)time/epoch 1.3404101133346558
Training time/epoch 0.5169379711151123
Training time without block to device /epoch 0.5113537311553955
Training time without total dataloading part /epoch 0.3835141658782959
load block tensor time/epoch 0.08614587783813477
block to device time/epoch 0.005584239959716797
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  404896
Number of first layer input nodes during this epoch:  404896
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])Using backend: pytorch

layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
