main start at this time 1651799509.5298574
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022950172424316406
number of batches is  2
batch size is  45471
range selection method spend 0.029061317443847656
time for parepare:  0.034623146057128906
local_output_nid generation:  0.020554065704345703
local_in_edges_tensor generation:  0.014470338821411133
mini_batch_src_global generation:  0.008793115615844727
r_  generation:  0.13416218757629395
local_output_nid generation:  0.013528823852539062
local_in_edges_tensor generation:  0.008754968643188477
mini_batch_src_global generation:  0.010533809661865234
r_  generation:  0.14074349403381348
----------------------check_connections_block total spend ----------------------------- 0.4336698055267334
generate_one_block  0.14901328086853027
generate_one_block  0.1488051414489746
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 115237
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8779296875 GB
    Memory Allocated: 0.05547952651977539  GigaBytes
Max Memory Allocated: 0.05547952651977539  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8779296875 GB
    Memory Allocated: 0.05581855773925781  GigaBytes
Max Memory Allocated: 0.05581855773925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8779296875 GB
    Memory Allocated: 0.05581855773925781  GigaBytes
Max Memory Allocated: 0.05581855773925781  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.9287109375 GB
    Memory Allocated: 0.057727813720703125  GigaBytes
Max Memory Allocated: 0.057727813720703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.9287109375 GB
    Memory Allocated: 0.057727813720703125  GigaBytes
Max Memory Allocated: 0.057727813720703125  GigaBytes

input nodes number: 115237
output nodes number: 45471
edges number: 256241
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 2.0141654014587402  GigaBytes
Max Memory Allocated: 2.1750378608703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 2.0141663551330566  GigaBytes
Max Memory Allocated: 2.1750378608703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.06831169128417969  GigaBytes
Max Memory Allocated: 2.1750378608703613  GigaBytes

pseudo mini batch 1 input nodes size: 115494
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.0631256103515625  GigaBytes
Max Memory Allocated: 2.1750378608703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.0631256103515625  GigaBytes
Max Memory Allocated: 2.1750378608703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.11819744110107422  GigaBytes
Max Memory Allocated: 2.1750378608703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.11853647232055664  GigaBytes
Max Memory Allocated: 2.1750378608703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.0632481575012207  GigaBytes
Max Memory Allocated: 2.1750378608703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.06516504287719727  GigaBytes
Max Memory Allocated: 2.1750378608703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2373046875 GB
    Memory Allocated: 0.06516504287719727  GigaBytes
Max Memory Allocated: 2.1750378608703613  GigaBytes

input nodes number: 115494
output nodes number: 45470
edges number: 257173
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 2.0205392837524414  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 2.0205397605895996  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 0.0684514045715332  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 0.06951189041137695  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 0.06951189041137695  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027347922325134277 |0.19842076301574707 |0.2642636299133301 |0.0003237724304199219 |0.027030229568481445 |0.005303382873535156 |
----------------------------------------------------------pseudo_mini_loss sum 3.838047504425049
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  230731
Number of first layer input nodes during this epoch:  230731
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 0.06951141357421875  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.013336181640625
number of batches is  2
batch size is  45471
range selection method spend 0.023380041122436523
time for parepare:  0.0292508602142334
local_output_nid generation:  0.013685464859008789
local_in_edges_tensor generation:  0.009588479995727539
mini_batch_src_global generation:  0.009380578994750977
r_  generation:  0.13749122619628906
local_output_nid generation:  0.015961408615112305
local_in_edges_tensor generation:  0.00899815559387207
mini_batch_src_global generation:  0.028730392456054688
r_  generation:  0.15808606147766113
----------------------check_connections_block total spend ----------------------------- 0.47835469245910645
generate_one_block  0.15245938301086426
generate_one_block  0.1528632640838623
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 0.06951141357421875  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.8647189140319824
pseudo mini batch 0 input nodes size: 114965
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 0.06430768966674805  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 0.06430768966674805  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 0.11912727355957031  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 0.11946630477905273  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 0.0640554428100586  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 0.06597137451171875  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3037109375 GB
    Memory Allocated: 0.06597137451171875  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

input nodes number: 114965
output nodes number: 45471
edges number: 257115
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 2.0197606086730957  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 2.019761562347412  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06925392150878906  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

pseudo mini batch 1 input nodes size: 115378
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.064056396484375  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.064056396484375  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.11907291412353516  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.11941194534301758  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06425333023071289  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06616353988647461  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06616353988647461  GigaBytes
Max Memory Allocated: 2.1881184577941895  GigaBytes

input nodes number: 115378
output nodes number: 45470
edges number: 256299
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 2.040191650390625  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 2.040192127227783  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.0694422721862793  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.0694422721862793  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.0694422721862793  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.022138118743896484 |0.0012853145599365234 |0.03277695178985596 |0.00012493133544921875 |0.024570584297180176 |0.0015993118286132812 |
----------------------------------------------------------pseudo_mini_loss sum 3.268394947052002
Total (block generation + training)time/epoch 1.043426752090454
Training time/epoch 0.17835783958435059
Training time without block to device /epoch 0.17578721046447754
Training time without total dataloading part /epoch 0.11654424667358398
load block tensor time/epoch 0.04427623748779297
block to device time/epoch 0.002570629119873047
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  230343
Number of first layer input nodes during this epoch:  230343
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.0694417953491211  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.011684894561767578
number of batches is  2
batch size is  45471
range selection method spend 0.015410900115966797
time for parepare:  0.018799543380737305
local_output_nid generation:  0.012588024139404297
local_in_edges_tensor generation:  0.009654998779296875
mini_batch_src_global generation:  0.008859872817993164
r_  generation:  0.1452312469482422
local_output_nid generation:  0.017405033111572266
local_in_edges_tensor generation:  0.0059163570404052734
mini_batch_src_global generation:  0.017803430557250977
r_  generation:  0.16286134719848633
----------------------check_connections_block total spend ----------------------------- 0.4546012878417969
generate_one_block  0.15858721733093262
generate_one_block  0.16086769104003906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.0694417953491211  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.8491439819335938
pseudo mini batch 0 input nodes size: 115451
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06425237655639648  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06425237655639648  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes
Using backend: pytorch

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.11930370330810547  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.11964273452758789  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06428718566894531  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.066192626953125  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.066192626953125  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

input nodes number: 115451
output nodes number: 45471
edges number: 255679
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 2.011620044708252  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 2.0116209983825684  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 0.06946802139282227  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

pseudo mini batch 1 input nodes size: 115324
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 0.06428813934326172  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 0.06428813934326172  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 0.1192789077758789  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 0.11961793899536133  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 0.06422758102416992  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 0.06614828109741211  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 0.06614828109741211  GigaBytes
Max Memory Allocated: 2.2077784538269043  GigaBytes

input nodes number: 115324
output nodes number: 45470
edges number: 257735
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 2.043126106262207  GigaBytes
Max Memory Allocated: 2.2107443809509277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 2.0431265830993652  GigaBytes
Max Memory Allocated: 2.2107443809509277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 0.06943702697753906  GigaBytes
Max Memory Allocated: 2.2107443809509277  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 0.06943702697753906  GigaBytes
Max Memory Allocated: 2.2107443809509277  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.3720703125 GB
    Memory Allocated: 0.06943702697753906  GigaBytes
Max Memory Allocated: 2.2107443809509277  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02227914333343506 |0.001184701919555664 |0.02841925621032715 |0.0001125335693359375 |0.025574803352355957 |0.003004312515258789 |
----------------------------------------------------------pseudo_mini_loss sum 3.1693224906921387
Total (block generation + training)time/epoch 1.0218843221664429
Training time/epoch 0.16665387153625488
Training time without block to device /epoch 0.16428446769714355
Training time without total dataloading part /epoch 0.11121749877929688
load block tensor time/epoch 0.04455828666687012
block to device time/epoch 0.002369403839111328
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  230775
Number of first layer input nodes during this epoch:  230775
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
