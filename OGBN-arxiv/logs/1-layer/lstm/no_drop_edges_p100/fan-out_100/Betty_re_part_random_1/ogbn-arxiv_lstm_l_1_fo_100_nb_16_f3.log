[02:00:48] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 42053666 edges into 16 parts and get 11003902 edge cuts
main start at this time 1652148014.6341174
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026964902877807617
global_2_local spend time (sec) 0.043621063232421875
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.005600929260253906
A = g.adjacency_matrix() spent  0.012135744094848633
auxiliary_graph
Graph(num_nodes=160237, num_edges=42144607,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.15693235397338867
remove nodes length
69296
auxiliary_graph.remove_nodes spent  2.241856813430786
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=42144607,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.9451658725738525

the counter of shared neighbor distribution
Counter({1.0: 30991370, 2.0: 7109668, 3.0: 2259214, 4.0: 837482, 5.0: 364674, 6.0: 181010, 7.0: 100010, 8.0: 60600, 9.0: 38780, 10.0: 26508, 11.0: 18062, 12.0: 13376, 13.0: 9864, 14.0: 7960, 15.0: 6130, 16.0: 4846, 17.0: 3908, 18.0: 3254, 19.0: 2488, 20.0: 2162, 21.0: 1788, 22.0: 1644, 23.0: 1146, 24.0: 1096, 25.0: 896, 26.0: 798, 27.0: 638, 28.0: 546, 29.0: 504, 30.0: 416, 31.0: 410, 32.0: 348, 33.0: 328, 34.0: 254, 35.0: 216, 38.0: 154, 37.0: 150, 36.0: 138, 39.0: 120, 40.0: 110, 42.0: 84, 41.0: 82, 44.0: 68, 43.0: 62, 45.0: 50, 46.0: 40, 47.0: 30, 51.0: 28, 50.0: 26, 48.0: 20, 49.0: 18, 52.0: 14, 55.0: 12, 56.0: 10, 53.0: 10, 59.0: 10, 57.0: 8, 54.0: 8, 64.0: 4, 67.0: 2, 76.0: 2, 70.0: 2, 89.0: 2, 66.0: 2, 58.0: 2, 81.0: 2, 68.0: 2})
42053666
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 42053663, 42053664, 42053665])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 30991370, 2.0: 7109668, 3.0: 2259214, 4.0: 837482, 5.0: 364674, 6.0: 181010, 7.0: 100010, 8.0: 60600, 9.0: 38780, 10.0: 26508, 11.0: 18062, 12.0: 13376, 13.0: 9864, 14.0: 7960, 15.0: 6130, 16.0: 4846, 17.0: 3908, 18.0: 3254, 19.0: 2488, 20.0: 2162, 21.0: 1788, 22.0: 1644, 23.0: 1146, 24.0: 1096, 25.0: 896, 26.0: 798, 27.0: 638, 28.0: 546, 29.0: 504, 30.0: 416, 31.0: 410, 32.0: 348, 33.0: 328, 34.0: 254, 35.0: 216, 38.0: 154, 37.0: 150, 36.0: 138, 39.0: 120, 40.0: 110, 42.0: 84, 41.0: 82, 44.0: 68, 43.0: 62, 45.0: 50, 46.0: 40, 47.0: 30, 51.0: 28, 50.0: 26, 48.0: 20, 49.0: 18, 52.0: 14, 55.0: 12, 56.0: 10, 53.0: 10, 59.0: 10, 57.0: 8, 54.0: 8, 64.0: 4, 67.0: 2, 76.0: 2, 70.0: 2, 89.0: 2, 66.0: 2, 58.0: 2, 81.0: 2, 68.0: 2})
Convert a graph into a bidirected graph: 3.010 seconds
Metis partitioning: 8.826 seconds
Split the graph: 2.537 seconds
Construct subgraphs: 0.136 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  14.529686212539673
5669
5839
5854
5517
5702
5853
5854
5832
5520
5854
5517
5540
5812
5517
5517
5544
total k batches seeds list generation spend  32.97650504112244
after graph partition
graph partition algorithm spend time 33.11865758895874
5669
5839
5854
5517
5702
5853
5854
5832
5520
5854
5517
5540
5812
5517
5517
5544
partition_len_list
[12081, 10835, 12809, 12930, 10614, 12855, 14383, 11645, 31693, 39232, 37766, 23236, 14157, 15951, 20668, 35098]
shared_neighbor_graph_partition_s0 selection method  spend 33.21849298477173
time for parepare:  0.019315719604492188
local_output_nid generation:  0.0008959770202636719
local_in_edges_tensor generation:  0.0013661384582519531
mini_batch_src_global generation:  0.0020852088928222656
r_  generation:  0.018886089324951172
local_output_nid generation:  0.0012083053588867188
local_in_edges_tensor generation:  0.001369476318359375
mini_batch_src_global generation:  0.0024950504302978516
r_  generation:  0.022614240646362305
local_output_nid generation:  0.001190185546875
local_in_edges_tensor generation:  0.00124359130859375
mini_batch_src_global generation:  0.0022478103637695312
r_  generation:  0.023276567459106445
local_output_nid generation:  0.0010914802551269531
local_in_edges_tensor generation:  0.0011363029479980469
mini_batch_src_global generation:  0.0018405914306640625
r_  generation:  0.01944589614868164
local_output_nid generation:  0.0010986328125
local_in_edges_tensor generation:  0.0010797977447509766
mini_batch_src_global generation:  0.0013725757598876953
r_  generation:  0.015180349349975586
local_output_nid generation:  0.001062154769897461
local_in_edges_tensor generation:  0.0011670589447021484
mini_batch_src_global generation:  0.0015141963958740234
r_  generation:  0.0185849666595459
local_output_nid generation:  0.0010538101196289062
local_in_edges_tensor generation:  0.0012230873107910156
mini_batch_src_global generation:  0.002024412155151367
r_  generation:  0.02333664894104004
local_output_nid generation:  0.0010833740234375
local_in_edges_tensor generation:  0.0011527538299560547
mini_batch_src_global generation:  0.0016772747039794922
r_  generation:  0.018845558166503906
local_output_nid generation:  0.0010383129119873047
local_in_edges_tensor generation:  0.0013651847839355469
mini_batch_src_global generation:  0.0035545825958251953
r_  generation:  0.035233497619628906
local_output_nid generation:  0.0013298988342285156
local_in_edges_tensor generation:  0.006300687789916992
mini_batch_src_global generation:  0.0062291622161865234
r_  generation:  0.054482221603393555
local_output_nid generation:  0.0016982555389404297
local_in_edges_tensor generation:  0.0026564598083496094
mini_batch_src_global generation:  0.0034720897674560547
r_  generation:  0.03240084648132324
local_output_nid generation:  0.0016486644744873047
local_in_edges_tensor generation:  0.0012319087982177734
mini_batch_src_global generation:  0.0018982887268066406
r_  generation:  0.019815444946289062
local_output_nid generation:  0.0015573501586914062
local_in_edges_tensor generation:  0.0012187957763671875
mini_batch_src_global generation:  0.001531362533569336
r_  generation:  0.017596006393432617
local_output_nid generation:  0.0013113021850585938
local_in_edges_tensor generation:  0.0011208057403564453
mini_batch_src_global generation:  0.0013687610626220703
r_  generation:  0.016470909118652344
local_output_nid generation:  0.0011839866638183594
local_in_edges_tensor generation:  0.0011453628540039062
mini_batch_src_global generation:  0.001581430435180664
r_  generation:  0.020282506942749023
local_output_nid generation:  0.0011394023895263672
local_in_edges_tensor generation:  0.0014002323150634766
mini_batch_src_global generation:  0.003360271453857422
r_  generation:  0.0392458438873291
----------------------check_connections_block total spend ----------------------------- 0.5865528583526611
generate_one_block  0.050933837890625
generate_one_block  0.035683631896972656
generate_one_block  0.034523725509643555
generate_one_block  0.026730775833129883
generate_one_block  0.02307724952697754
generate_one_block  [02:00:56] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5854 nodes and 6571446 edges into 2 parts and get 1465851 edge cuts
0.024924278259277344
generate_one_block  0.032850027084350586
generate_one_block  0.02388453483581543
generate_one_block  0.0596013069152832
generate_one_block  0.08159065246582031
generate_one_block  0.04629015922546387
generate_one_block  0.026139497756958008
generate_one_block  0.022909164428710938
generate_one_block  0.02216315269470215
generate_one_block  0.028554916381835938
generate_one_block  0.05716848373413086
global_2_local spend time (sec) 0.008736371994018555
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0013053417205810547
A = g.adjacency_matrix() spent  0.0015666484832763672
auxiliary_graph
Graph(num_nodes=39232, num_edges=6577300,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.025180339813232422
remove nodes length
33378
auxiliary_graph.remove_nodes spent  0.24313139915466309
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5854, num_edges=6577300,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.29789090156555176

the counter of shared neighbor distribution
Counter({1.0: 4244636, 2.0: 1461016, 3.0: 513444, 4.0: 186194, 5.0: 77656, 6.0: 35484, 7.0: 18990, 8.0: 10654, 9.0: 6578, 10.0: 4318, 11.0: 2730, 12.0: 1978, 13.0: 1498, 14.0: 1116, 15.0: 790, 16.0: 700, 17.0: 582, 18.0: 462, 19.0: 384, 20.0: 304, 22.0: 274, 21.0: 246, 23.0: 162, 24.0: 154, 25.0: 140, 26.0: 108, 27.0: 102, 28.0: 100, 29.0: 94, 30.0: 80, 31.0: 74, 33.0: 58, 32.0: 56, 35.0: 44, 34.0: 34, 38.0: 24, 40.0: 24, 36.0: 22, 39.0: 20, 37.0: 20, 41.0: 12, 42.0: 12, 43.0: 12, 46.0: 12, 44.0: 8, 45.0: 8, 47.0: 4, 56.0: 4, 54.0: 4, 52.0: 4, 51.0: 4, 48.0: 4, 53.0: 2, 59.0: 2, 50.0: 2, 49.0: 2})
6571446
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.350 seconds
Metis partitioning: 0.553 seconds
Split the graph: 0.518 seconds
Construct subgraphs: 0.022 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  1.4477434158325195
2992
2862
total k batches seeds list generation spend  3.3825523853302
after graph partition
graph partition algorithm spend time 3.4179210662841797
2992
2862
time for parepare:  0.03992462158203125
local_output_nid generation:  0.0006818771362304688
local_in_edges_tensor generation:  0.0067882537841796875
mini_batch_src_global generation:  0.0045702457427978516
r_  generation:  0.0440824031829834
local_output_nid generation:  0.0007615089416503906
local_in_edges_tensor generation:  0.0018582344055175781
mini_batch_src_global generation:  0.0033910274505615234
r_  generation:  0.02378559112548828
----------------------check_connections_block total spend ----------------------------- 0.1449902057647705
generate_one_block  0.05757737159729004
generate_one_block  0.03491473197937012
----------===============-------------===============-------------the number of batches ***** 17

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 12081
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.006290912628173828  GigaBytes
Max Memory Allocated: 0.006290912628173828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.006333351135253906  GigaBytes
Max Memory Allocated: 0.006333351135253906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.006333351135253906  GigaBytes
Max Memory Allocated: 0.006333351135253906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.0066890716552734375  GigaBytes
Max Memory Allocated: 0.0066890716552734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.0066890716552734375  GigaBytes
Max Memory Allocated: 0.0066890716552734375  GigaBytes

input nodes number: 12081
output nodes number: 5669
edges number: 47734
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3408203125 GB
    Memory Allocated: 0.3617854118347168  GigaBytes
Max Memory Allocated: 0.3890371322631836  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3408203125 GB
    Memory Allocated: 0.3617863655090332  GigaBytes
Max Memory Allocated: 0.3890371322631836  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3427734375 GB
    Memory Allocated: 0.008574962615966797  GigaBytes
Max Memory Allocated: 0.3890371322631836  GigaBytes

pseudo mini batch 1 input nodes size: 10835
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3427734375 GB
    Memory Allocated: 0.007709503173828125  GigaBytes
Max Memory Allocated: 0.3890371322631836  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3427734375 GB
    Memory Allocated: 0.007709503173828125  GigaBytes
Max Memory Allocated: 0.3890371322631836  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3427734375 GB
    Memory Allocated: 0.012876033782958984  GigaBytes
Max Memory Allocated: 0.3890371322631836  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3427734375 GB
    Memory Allocated: 0.012919902801513672  GigaBytes
Max Memory Allocated: 0.3890371322631836  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3427734375 GB
    Memory Allocated: 0.007116794586181641  GigaBytes
Max Memory Allocated: 0.3890371322631836  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3427734375 GB
    Memory Allocated: 0.007566928863525391  GigaBytes
Max Memory Allocated: 0.3890371322631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3427734375 GB
    Memory Allocated: 0.007566928863525391  GigaBytes
Max Memory Allocated: 0.3890371322631836  GigaBytes

input nodes number: 10835
output nodes number: 5839
edges number: 60296
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4619140625 GB
    Memory Allocated: 0.45253753662109375  GigaBytes
Max Memory Allocated: 0.48662662506103516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4619140625 GB
    Memory Allocated: 0.45253801345825195  GigaBytes
Max Memory Allocated: 0.48662662506103516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4619140625 GB
    Memory Allocated: 0.008189201354980469  GigaBytes
Max Memory Allocated: 0.48662662506103516  GigaBytes

pseudo mini batch 2 input nodes size: 12809
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4619140625 GB
    Memory Allocated: 0.007142066955566406  GigaBytes
Max Memory Allocated: 0.48662662506103516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4619140625 GB
    Memory Allocated: 0.007142066955566406  GigaBytes
Max Memory Allocated: 0.48662662506103516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4619140625 GB
    Memory Allocated: 0.013249874114990234  GigaBytes
Max Memory Allocated: 0.48662662506103516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4619140625 GB
    Memory Allocated: 0.013293743133544922  GigaBytes
Max Memory Allocated: 0.48662662506103516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4619140625 GB
    Memory Allocated: 0.008083343505859375  GigaBytes
Max Memory Allocated: 0.48662662506103516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4619140625 GB
    Memory Allocated: 0.008540153503417969  GigaBytes
Max Memory Allocated: 0.48662662506103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4619140625 GB
    Memory Allocated: 0.008540153503417969  GigaBytes
Max Memory Allocated: 0.48662662506103516  GigaBytes

input nodes number: 12809
output nodes number: 5854
edges number: 61189
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4677734375 GB
    Memory Allocated: 0.4598827362060547  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4677734375 GB
    Memory Allocated: 0.4598832130432129  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.009160995483398438  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

pseudo mini batch 3 input nodes size: 12930
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.00808572769165039  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.00808572769165039  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.014251232147216797  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.014292716979980469  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008141040802001953  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008510112762451172  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008510112762451172  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

input nodes number: 12930
output nodes number: 5517
edges number: 49439
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.3746767044067383  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.3746771812438965  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008988380432128906  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

pseudo mini batch 4 input nodes size: 10614
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008090972900390625  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008090972900390625  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.013152122497558594  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.013195037841796875  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.006988048553466797  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.007249355316162109  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.007249355316162109  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

input nodes number: 10614
output nodes number: 5702
edges number: 34992
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.2715439796447754  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.2715444564819336  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.007681369781494141  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

pseudo mini batch 5 input nodes size: 12855
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.007015228271484375  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.007015228271484375  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.013180732727050781  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.013224601745605469  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008120536804199219  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008457183837890625  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008457183837890625  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

input nodes number: 12855
output nodes number: 5853
edges number: 45057
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.34444570541381836  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.34444618225097656  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.00897836685180664  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

pseudo mini batch 6 input nodes size: 14383
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008143424987792969  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008143424987792969  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.015001773834228516  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.015045642852783203  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.00883626937866211  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.009285449981689453  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.009285449981689453  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

input nodes number: 14383
output nodes number: 5854
edges number: 60288
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.4542717933654785  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.4542722702026367  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.009907722473144531  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

pseudo mini batch 7 input nodes size: 11645
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.00883626937866211  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.00883626937866211  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.015001773834228516  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.015045642852783203  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008143424987792969  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008481025695800781  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008481025695800781  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

input nodes number: 11645
output nodes number: 5832
edges number: 45212
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.34506988525390625  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.34507036209106445  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008967876434326172  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

pseudo mini batch 8 input nodes size: 31693
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008140087127685547  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.008140087127685547  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.023252487182617188  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.02329397201538086  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.017084598541259766  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.017787456512451172  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4697265625 GB
    Memory Allocated: 0.017787456512451172  GigaBytes
Max Memory Allocated: 0.49399518966674805  GigaBytes

input nodes number: 31693
output nodes number: 5520
edges number: 94304
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.7055401802062988  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.705540657043457  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.01874256134033203  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

pseudo mini batch 9 input nodes size: 37766
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.01703786849975586  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.01703786849975586  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.03504610061645508  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.03508758544921875  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.019933700561523438  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.020542144775390625  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.020542144775390625  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

input nodes number: 37766
output nodes number: 5517
edges number: 81606
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.6171207427978516  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.6171212196350098  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.02149486541748047  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

pseudo mini batch 10 input nodes size: 23236
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.019933700561523438  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.019933700561523438  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.03101348876953125  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.031054973602294922  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.013005256652832031  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.013335227966308594  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.013335227966308594  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

input nodes number: 23236
output nodes number: 5540
edges number: 44215
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.3423752784729004  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.3423757553100586  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.013904571533203125  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

pseudo mini batch 11 input nodes size: 14157
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.013008594512939453  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.013008594512939453  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.019759178161621094  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.019802570343017578  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.008681297302246094  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.008985519409179688  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.008985519409179688  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

input nodes number: 14157
output nodes number: 5812
edges number: 40761
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.31322622299194336  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.31322669982910156  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.009501457214355469  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

pseudo mini batch 12 input nodes size: 15951
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.00872182846069336  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.00872182846069336  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.016327857971191406  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.016369342803955078  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.009575366973876953  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.009862422943115234  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.009862422943115234  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

input nodes number: 15951
output nodes number: 5517
edges number: 38437
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.2977890968322754  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.2977895736694336  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.010287284851074219  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

pseudo mini batch 13 input nodes size: 20668
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.009531497955322266  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.009531497955322266  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.019386768341064453  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.019428253173828125  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.011780738830566406  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.01215362548828125  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.01215362548828125  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

input nodes number: 20668
output nodes number: 5517
edges number: 49955
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.38177967071533203  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.38178014755249023  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.012742996215820312  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

pseudo mini batch 14 input nodes size: 35098
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.011780738830566406  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.011780738830566406  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.028516769409179688  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.02855825424194336  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.0186614990234375  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.01943492889404297  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7587890625 GB
    Memory Allocated: 0.01943492889404297  GigaBytes
Max Memory Allocated: 0.759160041809082  GigaBytes

input nodes number: 35098
output nodes number: 5544
edges number: 103803
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.7747726440429688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.774773120880127  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.020536422729492188  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 15 input nodes size: 30822
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.018665313720703125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.018665313720703125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.033362388610839844  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.03338479995727539  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.016607284545898438  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.017255783081054688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.017255783081054688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 30822
output nodes number: 2992
edges number: 87020
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.6469321250915527  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.6469326019287109  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.017787456512451172  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 16 input nodes size: 24619
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.016226768493652344  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.016226768493652344  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.027966022491455078  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02798748016357422  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.013267993927001953  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.013748645782470703  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.013748645782470703  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 24619
output nodes number: 2862
edges number: 64499
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.48166608810424805  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.48166656494140625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.014426231384277344  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.015486717224121094  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.015486717224121094  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01194608912748449 |0.02448117031770594 |0.6031927641700295 |0.0001607361961813534 |0.8440657222972197 |0.0054929256439208984 |
----------------------------------------------------------pseudo_mini_loss sum 3.8378288745880127
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  332162
Number of first layer input nodes during this epoch:  332162
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.01548624038696289  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04138755798339844
number of batches is  17
batch size is  5350
random selection method spend 0.007951021194458008
time for parepare:  0.0240628719329834
local_output_nid generation:  0.0021479129791259766
local_in_edges_tensor generation:  0.014065980911254883
mini_batch_src_global generation:  0.003290891647338867
r_  generation:  0.025377750396728516
local_output_nid generation:  0.003309488296508789
local_in_edges_tensor generation:  0.0016252994537353516
mini_batch_src_global generation:  0.0035152435302734375
r_  generation:  0.025595426559448242
local_output_nid generation:  0.002825021743774414
local_in_edges_tensor generation:  0.0016202926635742188
mini_batch_src_global generation:  0.002706289291381836
r_  generation:  0.024814128875732422
local_output_nid generation:  0.0027608871459960938
local_in_edges_tensor generation:  0.0013725757598876953
mini_batch_src_global generation:  0.0027098655700683594
r_  generation:  0.025316953659057617
local_output_nid generation:  0.0026950836181640625
local_in_edges_tensor generation:  0.0014047622680664062
mini_batch_src_global generation:  0.0027289390563964844
r_  generation:  0.025847196578979492
local_output_nid generation:  0.0026624202728271484
local_in_edges_tensor generation:  0.0013763904571533203
mini_batch_src_global generation:  0.0027573108673095703
r_  generation:  0.026300907135009766
local_output_nid generation:  0.002670764923095703
local_in_edges_tensor generation:  0.0013744831085205078
mini_batch_src_global generation:  0.0027894973754882812
r_  generation:  0.025742530822753906
local_output_nid generation:  0.002658367156982422
local_in_edges_tensor generation:  0.0013890266418457031
mini_batch_src_global generation:  0.002812623977661133
r_  generation:  0.02622246742248535
local_output_nid generation:  0.0026717185974121094
local_in_edges_tensor generation:  0.0013856887817382812
mini_batch_src_global generation:  0.0019757747650146484
r_  generation:  0.026803970336914062
local_output_nid generation:  0.0029315948486328125
local_in_edges_tensor generation:  0.0014824867248535156
mini_batch_src_global generation:  0.0020093917846679688
r_  generation:  0.028738975524902344
local_output_nid generation:  0.003785371780395508
local_in_edges_tensor generation:  0.0016930103302001953
mini_batch_src_global generation:  0.0020210742950439453
r_  generation:  0.028035879135131836
local_output_nid generation:  0.0032694339752197266
local_in_edges_tensor generation:  0.0017063617706298828
mini_batch_src_global generation:  0.0020427703857421875
r_  generation:  0.029054641723632812
local_output_nid generation:  0.0038368701934814453
local_in_edges_tensor generation:  0.0034856796264648438
mini_batch_src_global generation:  0.002214670181274414
r_  generation:  0.026949405670166016
local_output_nid generation:  0.0030951499938964844
local_in_edges_tensor generation:  0.0017082691192626953
mini_batch_src_global generation:  0.002046823501586914
r_  generation:  0.026397228240966797
local_output_nid generation:  0.0030570030212402344
local_in_edges_tensor generation:  0.0014750957489013672
mini_batch_src_global generation:  0.0020241737365722656
r_  generation:  0.03926229476928711
local_output_nid generation:  0.0029802322387695312
local_in_edges_tensor generation:  0.00145721435546875
mini_batch_src_global generation:  0.004028797149658203
r_  generation:  0.025994300842285156
local_output_nid generation:  0.0027103424072265625
local_in_edges_tensor generation:  0.0013518333435058594
mini_batch_src_global generation:  0.0028831958770751953
r_  generation:  0.02688908576965332
----------------------check_connections_block total spend ----------------------------- 0.7277243137359619
generate_one_block  0.049877166748046875
generate_one_block  0.04196357727050781
generate_one_block  0.04194998741149902
generate_one_block  0.04225802421569824
generate_one_block  0.04279351234436035
generate_one_block  0.04140305519104004
generate_one_block  0.04199957847595215
generate_one_block  0.04322528839111328
generate_one_block  0.043460845947265625
generate_one_block  0.04366445541381836
generate_one_block  0.043477773666381836
generate_one_block  0.04272580146789551
generate_one_block  0.042813777923583984
generate_one_block  0.04461979866027832
generate_one_block  0.041710615158081055
generate_one_block  0.04448080062866211
generate_one_block  0.04308772087097168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.01548624038696289  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.8478021621704102
pseudo mini batch 0 input nodes size: 45061
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.014308452606201172  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.014308452606201172  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.03579521179199219  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.03583526611328125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024074554443359375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024521827697753906  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024521827697753906  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 45061
output nodes number: 5350
edges number: 60023
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4675254821777344  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4675264358520508  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02573680877685547  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 1 input nodes size: 44168
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02444601058959961  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02444601058959961  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045506954193115234  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.0455470085144043  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02402019500732422  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024457931518554688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024457931518554688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44168
output nodes number: 5350
edges number: 58667
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4559478759765625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4559483528137207  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02528524398803711  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 2 input nodes size: 44625
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02402019500732422  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02402019500732422  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04529905319213867  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045339107513427734  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024238109588623047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024677753448486328  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024677753448486328  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44625
output nodes number: 5350
edges number: 58957
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4597358703613281  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.45973634719848633  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025510311126708984  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 3 input nodes size: 44728
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024238109588623047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024238109588623047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04556608200073242  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045606136322021484  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02428722381591797  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02472686767578125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02472686767578125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44728
output nodes number: 5350
edges number: 58961
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4589071273803711  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4589076042175293  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02555990219116211  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 4 input nodes size: 45389
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02428722381591797  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02428722381591797  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04593038558959961  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04597043991088867  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024602413177490234  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025052547454833984  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025052547454833984  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 45389
output nodes number: 5350
edges number: 60293
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4685235023498535  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4685239791870117  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025901317596435547  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 5 input nodes size: 44185
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024602413177490234  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024602413177490234  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04567146301269531  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045711517333984375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024028301239013672  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024462223052978516  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024462223052978516  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44185
output nodes number: 5350
edges number: 58115
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.451998233795166  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4519987106323242  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025285720825195312  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 6 input nodes size: 44529
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024028301239013672  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024028301239013672  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045261383056640625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04530143737792969  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024192333221435547  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024632930755615234  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024632930755615234  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44529
output nodes number: 5350
edges number: 59079
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4599618911743164  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4599623680114746  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02546548843383789  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 7 input nodes size: 45222
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024192333221435547  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024192333221435547  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045755863189697266  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04579591751098633  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024522781372070312  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024969100952148438  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024969100952148438  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 45222
output nodes number: 5350
edges number: 59886
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4659256935119629  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4659261703491211  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025812625885009766  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 8 input nodes size: 44636
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024522781372070312  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024522781372070312  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045806884765625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04584693908691406  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02424335479736328  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024686813354492188  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024686813354492188  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44636
output nodes number: 5350
edges number: 59429
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4623551368713379  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4623556137084961  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02552318572998047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 9 input nodes size: 45228
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02424335479736328  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02424335479736328  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04580974578857422  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04584980010986328  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02452564239501953  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024979591369628906  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024979591369628906  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 45228
output nodes number: 5350
edges number: 60906
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.47331666946411133  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.47331714630126953  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025830745697021484  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 10 input nodes size: 44538
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02452564239501953  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02452564239501953  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04576301574707031  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045803070068359375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024196624755859375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024631500244140625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024631500244140625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44538
output nodes number: 5350
edges number: 58329
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4551668167114258  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.455167293548584  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025458335876464844  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 11 input nodes size: 44546
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024196624755859375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024196624755859375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04543781280517578  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045477867126464844  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024200439453125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.0246429443359375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.0246429443359375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44546
output nodes number: 5350
edges number: 59375
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4619607925415039  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4619612693786621  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025477886199951172  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 12 input nodes size: 44702
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024200439453125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024200439453125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045516014099121094  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045556068420410156  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024274826049804688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024721145629882812  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024721145629882812  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44702
output nodes number: 5350
edges number: 59847
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4660148620605469  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4660153388977051  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025560855865478516  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 13 input nodes size: 45574
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024274826049804688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024274826049804688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.046006202697753906  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04604625701904297  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024690628051757812  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02514362335205078  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02514362335205078  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 45574
output nodes number: 5350
edges number: 60797
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4730191230773926  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4730195999145508  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025996685028076172  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 14 input nodes size: 44383
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024690628051757812  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024690628051757812  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04585409164428711  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04589414596557617  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02412271499633789  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024559497833251953  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024559497833251953  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44383
output nodes number: 5350
edges number: 58576
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.45653247833251953  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.45653295516967773  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025387287139892578  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 15 input nodes size: 44246
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02412271499633789  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02412271499633789  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04522085189819336  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04526090621948242  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024057388305664062  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02449512481689453  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02449512481689453  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44246
output nodes number: 5350
edges number: 58658
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4568605422973633  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4568610191345215  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025322914123535156  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 16 input nodes size: 44514
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024057388305664062  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024057388305664062  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04528331756591797  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04532337188720703  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.0241851806640625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02462482452392578  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02462482452392578  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44514
output nodes number: 5341
edges number: 58909
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4586210250854492  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4586215019226074  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025455474853515625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025455474853515625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025455474853515625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011682005489573759 |0.001205318114336799 |0.5989501616534065 |0.0001559117261101218 |1.0786714834325455 |0.0048787593841552734 |
----------------------------------------------------------pseudo_mini_loss sum 3.2670421600341797
Total (block generation + training)time/epoch 30.814184427261353
Training time/epoch 28.965761423110962
Training time without block to device /epoch 28.945271015167236
Training time without total dataloading part /epoch 28.52709722518921
load block tensor time/epoch 0.1985940933227539
block to device time/epoch 0.020490407943725586
input features size transfer per epoch 2.2798776626586914e-06
blocks size to device per epoch 1.519918441772461e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  760274
Number of first layer input nodes during this epoch:  760274
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025454998016357422  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027919292449951172
number of batches is  17
batch size is  5350
random selection method spend 0.007586956024169922
time for parepare:  0.023478269577026367
local_output_nid generation:  0.002197742462158203
local_in_edges_tensor generation:  0.012044429779052734
mini_batch_src_global generation:  0.003276348114013672
r_  generation:  0.02486729621887207
local_output_nid generation:  0.003310680389404297
local_in_edges_tensor generation:  0.0019278526306152344
mini_batch_src_global generation:  0.0034749507904052734
r_  generation:  0.025293350219726562
local_output_nid generation:  0.0029659271240234375
local_in_edges_tensor generation:  0.001377105712890625
mini_batch_src_global generation:  0.0026946067810058594
r_  generation:  0.024934053421020508
local_output_nid generation:  0.0028700828552246094
local_in_edges_tensor generation:  0.0013852119445800781
mini_batch_src_global generation:  0.002690553665161133
r_  generation:  0.02644658088684082
local_output_nid generation:  0.002798795700073242
local_in_edges_tensor generation:  0.0013279914855957031
mini_batch_src_global generation:  0.0027039051055908203
r_  generation:  0.026869773864746094
local_output_nid generation:  0.0027763843536376953
local_in_edges_tensor generation:  0.0020194053649902344
mini_batch_src_global generation:  0.0028870105743408203
r_  generation:  0.02773308753967285
local_output_nid generation:  0.0029790401458740234
local_in_edges_tensor generation:  0.001468658447265625
mini_batch_src_global generation:  0.002806425094604492
r_  generation:  0.025827884674072266
local_output_nid generation:  0.0028619766235351562
local_in_edges_tensor generation:  0.001373291015625
mini_batch_src_global generation:  0.004034519195556641
r_  generation:  0.02734065055847168
local_output_nid generation:  0.0028047561645507812
local_in_edges_tensor generation:  0.001314401626586914
mini_batch_src_global generation:  0.0028061866760253906
r_  generation:  0.02538609504699707
local_output_nid generation:  0.002786874771118164
local_in_edges_tensor generation:  0.0013382434844970703
mini_batch_src_global generation:  0.006261110305786133
r_  generation:  0.026014089584350586
local_output_nid generation:  0.0028531551361083984
local_in_edges_tensor generation:  0.0012805461883544922
mini_batch_src_global generation:  0.0027892589569091797
r_  generation:  0.025696516036987305
local_output_nid generation:  0.002767801284790039
local_in_edges_tensor generation:  0.0014088153839111328
mini_batch_src_global generation:  0.0028002262115478516
r_  generation:  0.026121854782104492
local_output_nid generation:  0.0029044151306152344
local_in_edges_tensor generation:  0.0013928413391113281
mini_batch_src_global generation:  0.002038240432739258
r_  generation:  0.026293039321899414
local_output_nid generation:  0.002827167510986328
local_in_edges_tensor generation:  0.001405954360961914
mini_batch_src_global generation:  0.002007007598876953
r_  generation:  0.02613544464111328
local_output_nid generation:  0.0028133392333984375
local_in_edges_tensor generation:  0.0013475418090820312
mini_batch_src_global generation:  0.002056121826171875
r_  generation:  0.027621030807495117
local_output_nid generation:  0.002796649932861328
local_in_edges_tensor generation:  0.001329183578491211
mini_batch_src_global generation:  0.0020008087158203125
r_  generation:  0.02613663673400879
local_output_nid generation:  0.0027456283569335938
local_in_edges_tensor generation:  0.0013203620910644531
mini_batch_src_global generation:  0.0019800662994384766
r_  generation:  0.025331974029541016
----------------------check_connections_block total spend ----------------------------- 0.7047204971313477
generate_one_block  0.04774904251098633
generate_one_block  0.04129624366760254
generate_one_block  0.04163241386413574
generate_one_block  0.041097402572631836
generate_one_block  0.04119110107421875
generate_one_block  0.04263758659362793
generate_one_block  0.04130959510803223
generate_one_block  0.04371142387390137
generate_one_block  0.040796756744384766
generate_one_block  0.041274309158325195
generate_one_block  0.0407559871673584
generate_one_block  0.04475665092468262
generate_one_block  0.041277170181274414
generate_one_block  0.042586326599121094
generate_one_block  0.04623699188232422
generate_one_block  0.04248237609863281
generate_one_block  0.04138517379760742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025454998016357422  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.8553340435028076
pseudo mini batch 0 input nodes size: 45058
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024183273315429688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024183273315429688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045668601989746094  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045708656311035156  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024442672729492188  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024885177612304688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024885177612304688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 45058
output nodes number: 5350
edges number: 59359
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.46247243881225586  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.46247339248657227  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025725841522216797  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 1 input nodes size: 44384
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024444580078125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024444580078125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.0456085205078125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04564857482910156  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024123191833496094  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024559974670410156  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024559974670410156  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44384
output nodes number: 5350
edges number: 58593
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4568061828613281  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.45680665969848633  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02538776397705078  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 2 input nodes size: 45068
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024123191833496094  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024123191833496094  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04561328887939453  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045653343200683594  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02444934844970703  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02488994598388672  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02488994598388672  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 45068
output nodes number: 5350
edges number: 59113
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4601116180419922  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4601120948791504  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025726795196533203  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 3 input nodes size: 44179
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02444934844970703  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02444934844970703  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04551553726196289  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04555559158325195  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024025440216064453  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02446126937866211  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02446126937866211  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44179
output nodes number: 5350
edges number: 58377
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4548325538635254  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4548330307006836  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02528667449951172  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 4 input nodes size: 44178
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024025440216064453  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024025440216064453  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04509115219116211  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04513120651245117  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02402496337890625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024463653564453125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024463653564453125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44178
output nodes number: 5350
edges number: 58854
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.457338809967041  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4573392868041992  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025291919708251953  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 5 input nodes size: 46097
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02402496337890625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02402496337890625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.0460057258605957  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.046045780181884766  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024940013885498047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025395870208740234  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025395870208740234  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 46097
output nodes number: 5350
edges number: 61071
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4743642807006836  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4743647575378418  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02625560760498047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 6 input nodes size: 44521
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024940013885498047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024940013885498047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.046169281005859375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04620933532714844  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024188518524169922  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024624347686767578  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024624347686767578  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44521
output nodes number: 5350
edges number: 58485
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.45505475997924805  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.45505523681640625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025452136993408203  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 7 input nodes size: 46552
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024188518524169922  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024188518524169922  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.0463862419128418  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04642629623413086  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02515697479248047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025626182556152344  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025626182556152344  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 46552
output nodes number: 5350
edges number: 62927
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.48763322830200195  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.48763370513916016  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.026502609252929688  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 8 input nodes size: 43736
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02515697479248047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02515697479248047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.046011924743652344  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.046051979064941406  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02381420135498047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024242401123046875  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024242401123046875  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 43736
output nodes number: 5350
edges number: 57466
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.44720935821533203  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.44720983505249023  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025056838989257812  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 9 input nodes size: 44640
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02381420135498047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02381420135498047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04510021209716797  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04514026641845703  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024245262145996094  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024682998657226562  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024682998657226562  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44640
output nodes number: 5350
edges number: 58687
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4569835662841797  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4569840431213379  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025513648986816406  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 10 input nodes size: 43826
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024245262145996094  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024245262145996094  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04514312744140625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04518318176269531  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02385711669921875  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024288177490234375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024288177490234375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 43826
output nodes number: 5350
edges number: 57805
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4496011734008789  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4496016502380371  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025105953216552734  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 11 input nodes size: 44368
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02385711669921875  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02385711669921875  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045013427734375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04505348205566406  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024115562438964844  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024553298950195312  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024553298950195312  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44368
output nodes number: 5350
edges number: 58659
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4573326110839844  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4573330879211426  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025382041931152344  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 12 input nodes size: 44454
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024115562438964844  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024115562438964844  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04531288146972656  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.045352935791015625  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024156570434570312  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024593353271484375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024593353271484375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44454
output nodes number: 5350
edges number: 58600
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.45656347274780273  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.45656394958496094  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025421619415283203  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 13 input nodes size: 45097
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024156570434570312  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024156570434570312  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04566049575805664  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.0457005500793457  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024463176727294922  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024918079376220703  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024918079376220703  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 45097
output nodes number: 5350
edges number: 60989
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4734649658203125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4734654426574707  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02576923370361328  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 14 input nodes size: 46007
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024463176727294922  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024463176727294922  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.046401023864746094  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.046441078186035156  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024897098541259766  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025359630584716797  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025359630584716797  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 46007
output nodes number: 5350
edges number: 62068
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4819149971008301  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4819154739379883  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02622509002685547  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 15 input nodes size: 44311
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024897098541259766  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024897098541259766  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04602622985839844  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.0460662841796875  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024088382720947266  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02452707290649414  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.02452707290649414  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44311
output nodes number: 5350
edges number: 58767
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4582228660583496  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4582233428955078  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025356292724609375  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

pseudo mini batch 16 input nodes size: 44458
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024088382720947266  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024088382720947266  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.0452876091003418  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.04532766342163086  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024158477783203125  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024598121643066406  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.024598121643066406  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

input nodes number: 44458
output nodes number: 5341
edges number: 58987
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.4591999053955078  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.459200382232666  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025428295135498047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025428295135498047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8857421875 GB
    Memory Allocated: 0.025428295135498047  GigaBytes
Max Memory Allocated: 0.833989143371582  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010085793102488798 |0.0013306421392104205 |0.5027118710910573 |0.00012578683740952436 |1.2552195717306698 |0.0037648677825927734 |
----------------------------------------------------------pseudo_mini_loss sum 3.1724462509155273
Total (block generation + training)time/epoch 31.475043773651123
Training time/epoch 30.272797346115112
Training time without block to device /epoch 30.250176429748535
Training time without total dataloading part /epoch 29.890737771987915
load block tensor time/epoch 0.17145848274230957
block to device time/epoch 0.02262091636657715
input features size transfer per epoch 2.2798776626586914e-06
blocks size to device per epoch 1.519918441772461e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  760934
Number of first layer input nodes during this epoch:  760934
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
