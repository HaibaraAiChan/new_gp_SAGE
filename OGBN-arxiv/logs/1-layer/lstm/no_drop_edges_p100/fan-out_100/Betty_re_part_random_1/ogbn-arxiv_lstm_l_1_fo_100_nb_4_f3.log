[01:57:41] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 42053666 edges into 4 parts and get 3676344 edge cuts
[01:58:02] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 22722 nodes and 27011588 edges into 2 parts and get 3754446 edge cuts
main start at this time 1652147829.172213
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02747941017150879
global_2_local spend time (sec) 0.039644718170166016
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0052683353424072266
A = g.adjacency_matrix() spent  0.011843204498291016
auxiliary_graph
Graph(num_nodes=160237, num_edges=42144607,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.11425018310546875
remove nodes length
69296
auxiliary_graph.remove_nodes spent  2.224642515182495
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=42144607,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.8318309783935547

the counter of shared neighbor distribution
Counter({1.0: 30991370, 2.0: 7109668, 3.0: 2259214, 4.0: 837482, 5.0: 364674, 6.0: 181010, 7.0: 100010, 8.0: 60600, 9.0: 38780, 10.0: 26508, 11.0: 18062, 12.0: 13376, 13.0: 9864, 14.0: 7960, 15.0: 6130, 16.0: 4846, 17.0: 3908, 18.0: 3254, 19.0: 2488, 20.0: 2162, 21.0: 1788, 22.0: 1644, 23.0: 1146, 24.0: 1096, 25.0: 896, 26.0: 798, 27.0: 638, 28.0: 546, 29.0: 504, 30.0: 416, 31.0: 410, 32.0: 348, 33.0: 328, 34.0: 254, 35.0: 216, 38.0: 154, 37.0: 150, 36.0: 138, 39.0: 120, 40.0: 110, 42.0: 84, 41.0: 82, 44.0: 68, 43.0: 62, 45.0: 50, 46.0: 40, 47.0: 30, 51.0: 28, 50.0: 26, 48.0: 20, 49.0: 18, 52.0: 14, 55.0: 12, 56.0: 10, 53.0: 10, 59.0: 10, 57.0: 8, 54.0: 8, 64.0: 4, 67.0: 2, 76.0: 2, 70.0: 2, 89.0: 2, 66.0: 2, 58.0: 2, 81.0: 2, 68.0: 2})
42053666
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 42053663, 42053664, 42053665])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 30991370, 2.0: 7109668, 3.0: 2259214, 4.0: 837482, 5.0: 364674, 6.0: 181010, 7.0: 100010, 8.0: 60600, 9.0: 38780, 10.0: 26508, 11.0: 18062, 12.0: 13376, 13.0: 9864, 14.0: 7960, 15.0: 6130, 16.0: 4846, 17.0: 3908, 18.0: 3254, 19.0: 2488, 20.0: 2162, 21.0: 1788, 22.0: 1644, 23.0: 1146, 24.0: 1096, 25.0: 896, 26.0: 798, 27.0: 638, 28.0: 546, 29.0: 504, 30.0: 416, 31.0: 410, 32.0: 348, 33.0: 328, 34.0: 254, 35.0: 216, 38.0: 154, 37.0: 150, 36.0: 138, 39.0: 120, 40.0: 110, 42.0: 84, 41.0: 82, 44.0: 68, 43.0: 62, 45.0: 50, 46.0: 40, 47.0: 30, 51.0: 28, 50.0: 26, 48.0: 20, 49.0: 18, 52.0: 14, 55.0: 12, 56.0: 10, 53.0: 10, 59.0: 10, 57.0: 8, 54.0: 8, 64.0: 4, 67.0: 2, 76.0: 2, 70.0: 2, 89.0: 2, 66.0: 2, 58.0: 2, 81.0: 2, 68.0: 2})
Convert a graph into a bidirected graph: 3.029 seconds
Metis partitioning: 7.645 seconds
Split the graph: 5.864 seconds
Construct subgraphs: 0.047 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  16.605067253112793
23235
22627
22357
22722
total k batches seeds list generation spend  34.0602867603302
after graph partition
graph partition algorithm spend time 34.22678995132446
23235
22627
22357
22722
partition_len_list
[41816, 36211, 62185, 76362]
shared_neighbor_graph_partition_s0 selection method  spend 34.32173490524292
time for parepare:  0.020076990127563477
local_output_nid generation:  0.0026979446411132812
local_in_edges_tensor generation:  0.004007577896118164
mini_batch_src_global generation:  0.011043071746826172
r_  generation:  0.0795750617980957
local_output_nid generation:  0.0036242008209228516
local_in_edges_tensor generation:  0.005280017852783203
mini_batch_src_global generation:  0.010195255279541016
r_  generation:  0.09254097938537598
local_output_nid generation:  0.0036673545837402344
local_in_edges_tensor generation:  0.0039501190185546875
mini_batch_src_global generation:  0.008211851119995117
r_  generation:  0.0790717601776123
local_output_nid generation:  0.003713369369506836
local_in_edges_tensor generation:  0.007481098175048828
mini_batch_src_global generation:  0.017136812210083008
r_  generation:  0.1618640422821045
----------------------check_connections_block total spend ----------------------------- 0.600264310836792
generate_one_block  0.11762619018554688
generate_one_block  0.11469435691833496
generate_one_block  0.10356926918029785
generate_one_block  0.22237181663513184
global_2_local spend time (sec) 0.017476558685302734
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0026178359985351562
A = g.adjacency_matrix() spent  0.00442051887512207
auxiliary_graph
Graph(num_nodes=76362, num_edges=27034310,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.05041980743408203
remove nodes length
53640
auxiliary_graph.remove_nodes spent  1.2420690059661865
after remove non output nodes the auxiliary_graph
Graph(num_nodes=22722, num_edges=27034310,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.132702112197876

the counter of shared neighbor distribution
Counter({1.0: 19466160, 2.0: 4908984, 3.0: 1573988, 4.0: 563644, 5.0: 231838, 6.0: 106602, 7.0: 56090, 8.0: 32030, 9.0: 19554, 10.0: 12984, 11.0: 8586, 12.0: 6194, 13.0: 4624, 14.0: 3642, 15.0: 2796, 16.0: 2226, 17.0: 1790, 18.0: 1532, 19.0: 1136, 20.0: 934, 21.0: 864, 22.0: 768, 23.0: 568, 24.0: 562, 25.0: 436, 26.0: 432, 27.0: 330, 28.0: 288, 29.0: 274, 30.0: 240, 31.0: 206, 32.0: 190, 33.0: 168, 34.0: 152, 35.0: 114, 37.0: 88, 38.0: 78, 40.0: 72, 39.0: 70, 36.0: 70, 41.0: 52, 42.0: 48, 43.0: 32, 44.0: 26, 45.0: 24, 46.0: 22, 50.0: 12, 47.0: 10, 49.0: 8, 56.0: 8, 51.0: 8, 48.0: 8, 52.0: 6, 54.0: 4, 59.0: 4, 55.0: 4, 57.0: 4, 67.0: 2, 53.0: 2})
27011588
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 1.520 seconds
Metis partitioning: 4.704 seconds
Split the graph: 2.869 seconds
Construct subgraphs: 0.043 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.150933027267456
11172
11550
total k batches seeds list generation spend  16.30541205406189
after graph partition
graph partition algorithm spend time 16.364635944366455
11172
11550
time for parepare:  0.02564263343811035
local_output_nid generation:  0.0021800994873046875
local_in_edges_tensor generation:  0.00687861442565918
mini_batch_src_global generation:  0.0073626041412353516
r_  generation:  0.07398533821105957
local_output_nid generation:  0.0032563209533691406
local_in_edges_tensor generation:  0.00613093376159668
mini_batch_src_global generation:  0.011446237564086914
r_  generation:  0.09996891021728516
----------------------check_connections_block total spend ----------------------------- 0.27539610862731934
generate_one_block  0.11350655555725098
generate_one_block  0.13359785079956055
----------===============-------------===============-------------the number of batches ***** 5

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 41816
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8427734375 GB
    Memory Allocated: 0.02046966552734375  GigaBytes
Max Memory Allocated: 0.02046966552734375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8427734375 GB
    Memory Allocated: 0.020643234252929688  GigaBytes
Max Memory Allocated: 0.020643234252929688  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8427734375 GB
    Memory Allocated: 0.020643234252929688  GigaBytes
Max Memory Allocated: 0.020643234252929688  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8935546875 GB
    Memory Allocated: 0.022039413452148438  GigaBytes
Max Memory Allocated: 0.022039413452148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8935546875 GB
    Memory Allocated: 0.022039413452148438  GigaBytes
Max Memory Allocated: 0.022039413452148438  GigaBytes

input nodes number: 41816
output nodes number: 23235
edges number: 187332
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4697265625 GB
    Memory Allocated: 1.4272780418395996  GigaBytes
Max Memory Allocated: 1.5332694053649902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4697265625 GB
    Memory Allocated: 1.427278995513916  GigaBytes
Max Memory Allocated: 1.5332694053649902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4697265625 GB
    Memory Allocated: 0.02800130844116211  GigaBytes
Max Memory Allocated: 1.5332694053649902  GigaBytes

pseudo mini batch 1 input nodes size: 36211
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.4697265625 GB
    Memory Allocated: 0.02463674545288086  GigaBytes
Max Memory Allocated: 1.5332694053649902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.4697265625 GB
    Memory Allocated: 0.02463674545288086  GigaBytes
Max Memory Allocated: 1.5332694053649902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.4697265625 GB
    Memory Allocated: 0.04190349578857422  GigaBytes
Max Memory Allocated: 1.5332694053649902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.4697265625 GB
    Memory Allocated: 0.042072296142578125  GigaBytes
Max Memory Allocated: 1.5332694053649902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.4697265625 GB
    Memory Allocated: 0.021959304809570312  GigaBytes
Max Memory Allocated: 1.5332694053649902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4697265625 GB
    Memory Allocated: 0.023565292358398438  GigaBytes
Max Memory Allocated: 1.5332694053649902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4697265625 GB
    Memory Allocated: 0.023565292358398438  GigaBytes
Max Memory Allocated: 1.5332694053649902  GigaBytes

input nodes number: 36211
output nodes number: 22627
edges number: 215496
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 1.62315034866333  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 1.6231508255004883  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.025603771209716797  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

pseudo mini batch 2 input nodes size: 62185
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.02186870574951172  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.02186870574951172  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.05152082443237305  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.05168771743774414  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.034252166748046875  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.03559398651123047  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.03559398651123047  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

input nodes number: 62185
output nodes number: 22357
edges number: 180079
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 1.3819561004638672  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 1.3819565773010254  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.03760957717895508  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

pseudo mini batch 3 input nodes size: 56382
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.03421211242675781  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.03421211242675781  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.061097145080566406  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.06118059158325195  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.03136157989501953  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.032708168029785156  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7626953125 GB
    Memory Allocated: 0.032708168029785156  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

input nodes number: 56382
output nodes number: 11172
edges number: 180661
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9736328125 GB
    Memory Allocated: 1.3499507904052734  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9736328125 GB
    Memory Allocated: 1.3499512672424316  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9755859375 GB
    Memory Allocated: 0.032933712005615234  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

pseudo mini batch 4 input nodes size: 50508
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9755859375 GB
    Memory Allocated: 0.02969503402709961  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9755859375 GB
    Memory Allocated: 0.02969503402709961  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9755859375 GB
    Memory Allocated: 0.05377912521362305  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9755859375 GB
    Memory Allocated: 0.05386543273925781  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9755859375 GB
    Memory Allocated: 0.026896953582763672  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9755859375 GB
    Memory Allocated: 0.028724193572998047  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9755859375 GB
    Memory Allocated: 0.028724193572998047  GigaBytes
Max Memory Allocated: 1.744692325592041  GigaBytes

input nodes number: 50508
output nodes number: 11550
edges number: 245239
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.8233942985534668  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.823394775390625  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.03111410140991211  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.03217458724975586  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.03217458724975586  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021186113357543945 |0.08384137153625489 |0.6618433475494385 |0.0001781940460205078 |1.0783126831054688 |0.004796504974365234 |
----------------------------------------------------------pseudo_mini_loss sum 3.8378286361694336
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  247102
Number of first layer input nodes during this epoch:  247102
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.032174110412597656  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030796527862548828
number of batches is  5
batch size is  18189
random selection method spend 0.008172750473022461
time for parepare:  0.02644205093383789
local_output_nid generation:  0.0063800811767578125
local_in_edges_tensor generation:  0.016245365142822266
mini_batch_src_global generation:  0.008492231369018555
r_  generation:  0.09465479850769043
local_output_nid generation:  0.009611129760742188
local_in_edges_tensor generation:  0.007512569427490234
mini_batch_src_global generation:  0.009816408157348633
r_  generation:  0.0960531234741211
local_output_nid generation:  0.010407447814941406
local_in_edges_tensor generation:  0.0054051876068115234
mini_batch_src_global generation:  0.007711887359619141
r_  generation:  0.09539008140563965
local_output_nid generation:  0.009746074676513672
local_in_edges_tensor generation:  0.005209445953369141
mini_batch_src_global generation:  0.008022546768188477
r_  generation:  0.10074830055236816
local_output_nid generation:  0.010566949844360352
local_in_edges_tensor generation:  0.0064508914947509766
mini_batch_src_global generation:  0.009079456329345703
r_  generation:  0.09788107872009277
----------------------check_connections_block total spend ----------------------------- 0.7337138652801514
generate_one_block  0.15253567695617676
generate_one_block  0.15549564361572266
generate_one_block  0.13927888870239258
generate_one_block  0.13981032371520996
generate_one_block  0.13079094886779785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.032174110412597656  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.6669466495513916
pseudo mini batch 0 input nodes size: 97744
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.028012752532958984  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.028012752532958984  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.07462072372436523  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.07475662231445312  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05058622360229492  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05208253860473633  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05208253860473633  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

input nodes number: 97744
output nodes number: 18189
edges number: 200708
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5374197959899902  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5374207496643066  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05550193786621094  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

pseudo mini batch 1 input nodes size: 98010
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05157661437988281  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05157661437988281  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.0983114242553711  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09844732284545898  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051703453063964844  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05321311950683594  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05321311950683594  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

input nodes number: 98010
output nodes number: 18189
edges number: 202559
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.55072021484375  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5507206916809082  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.055657386779785156  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

pseudo mini batch 2 input nodes size: 98343
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051703453063964844  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051703453063964844  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09859704971313477  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09873294830322266  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051862239837646484  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.0533747673034668  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.0533747673034668  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

input nodes number: 98343
output nodes number: 18189
edges number: 202965
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.553762435913086  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5537629127502441  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05582427978515625  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

pseudo mini batch 3 input nodes size: 97854
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051862239837646484  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051862239837646484  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09859704971313477  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09873294830322266  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051703453063964844  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.053214073181152344  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.053214073181152344  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

input nodes number: 97854
output nodes number: 18189
edges number: 202677
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5492019653320312  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5492024421691895  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05565786361694336  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

pseudo mini batch 4 input nodes size: 97579
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051703453063964844  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051703453063964844  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09823274612426758  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09836864471435547  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.0514979362487793  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05298757553100586  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05298757553100586  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

input nodes number: 97579
output nodes number: 18185
edges number: 199898
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5308756828308105  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5308761596679688  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05540752410888672  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05540752410888672  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05540752410888672  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02413039207458496 |0.0014265060424804687 |0.5527527809143067 |0.00013146400451660156 |1.0779665470123292 |0.0038864612579345703 |
----------------------------------------------------------pseudo_mini_loss sum 3.2670414447784424
Total (block generation + training)time/epoch 10.022470951080322
Training time/epoch 8.355250120162964
Training time without block to device /epoch 8.348117589950562
Training time without total dataloading part /epoch 8.158140420913696
load block tensor time/epoch 0.1206519603729248
block to device time/epoch 0.007132530212402344
input features size transfer per epoch 6.705522537231445e-07
blocks size to device per epoch 4.470348358154297e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  489530
Number of first layer input nodes during this epoch:  489530
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.055407047271728516  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03116464614868164
number of batches is  5
batch size is  18189
random selection method spend 0.007785320281982422
time for parepare:  0.024673938751220703
local_output_nid generation:  0.006764650344848633
local_in_edges_tensor generation:  0.022717714309692383
mini_batch_src_global generation:  0.01002812385559082
r_  generation:  0.09415674209594727
local_output_nid generation:  0.009506702423095703
local_in_edges_tensor generation:  0.005612850189208984
mini_batch_src_global generation:  0.009774208068847656
r_  generation:  0.09505820274353027
local_output_nid generation:  0.009687185287475586
local_in_edges_tensor generation:  0.005567073822021484
mini_batch_src_global generation:  0.006815671920776367
r_  generation:  0.09472227096557617
local_output_nid generation:  0.011158466339111328
local_in_edges_tensor generation:  0.005753040313720703
mini_batch_src_global generation:  0.007410526275634766
r_  generation:  0.09438943862915039
local_output_nid generation:  0.00964498519897461
local_in_edges_tensor generation:  0.0052928924560546875
mini_batch_src_global generation:  0.008050203323364258
r_  generation:  0.09811854362487793
----------------------check_connections_block total spend ----------------------------- 0.7288157939910889
generate_one_block  0.13288140296936035
generate_one_block  0.13228654861450195
generate_one_block  0.1292407512664795
generate_one_block  0.12986040115356445
generate_one_block  0.12999773025512695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.055407047271728516  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.6265690326690674
pseudo mini batch 0 input nodes size: 98217
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051496028900146484  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051496028900146484  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09832954406738281  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.0984654426574707  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05180025100708008  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05329465866088867  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05329465866088867  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

input nodes number: 98217
output nodes number: 18189
edges number: 200544
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.536386489868164  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5363874435424805  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05574178695678711  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

pseudo mini batch 1 input nodes size: 97931
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05181694030761719  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05181694030761719  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09851408004760742  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09864997863769531  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051680564880371094  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05319023132324219  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05319023132324219  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

input nodes number: 97931
output nodes number: 18189
edges number: 202590
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5498452186584473  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5498456954956055  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.055619239807128906  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

pseudo mini batch 2 input nodes size: 98036
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.0516657829284668  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.0516657829284668  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09841299057006836  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09854888916015625  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051715850830078125  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.053215980529785156  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.053215980529785156  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

input nodes number: 98036
output nodes number: 18189
edges number: 201341
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5414714813232422  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5414719581604004  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05565071105957031  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

pseudo mini batch 3 input nodes size: 97494
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051715850830078125  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.051715850830078125  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09841299057006836  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.09854888916015625  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.0516657829284668  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.053159236907958984  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.053159236907958984  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

input nodes number: 97494
output nodes number: 18189
edges number: 200330
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5347986221313477  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5347990989685059  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05558347702026367  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

pseudo mini batch 4 input nodes size: 98146
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.0516657829284668  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.0516657829284668  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.0984654426574707  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.0986013412475586  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05176830291748047  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05328845977783203  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05328845977783203  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

input nodes number: 98146
output nodes number: 18185
edges number: 204002
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5619239807128906  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 1.5619244575500488  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05576372146606445  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05576372146606445  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.1181640625 GB
    Memory Allocated: 0.05576372146606445  GigaBytes
Max Memory Allocated: 1.967421054840088  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024692487716674805 |0.0012556076049804687 |0.5407874584197998 |0.0001232624053955078 |1.069136953353882 |0.0037517547607421875 |
----------------------------------------------------------pseudo_mini_loss sum 3.172445774078369
Total (block generation + training)time/epoch 9.92547082901001
Training time/epoch 8.241982698440552
Training time without block to device /epoch 8.23570466041565
Training time without total dataloading part /epoch 8.053990125656128
load block tensor time/epoch 0.12346243858337402
block to device time/epoch 0.006278038024902344
input features size transfer per epoch 6.705522537231445e-07
blocks size to device per epoch 4.470348358154297e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  489824
Number of first layer input nodes during this epoch:  489824
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])Using backend: pytorch

layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
