main start at this time 1651811639.7398071
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023418903350830078
number of batches is  8
batch size is  11368
range selection method spend 0.014278888702392578
time for parepare:  0.021544456481933594
local_output_nid generation:  0.0031456947326660156
local_in_edges_tensor generation:  0.006472349166870117
mini_batch_src_global generation:  0.00500798225402832
r_  generation:  0.054450273513793945
local_output_nid generation:  0.0039789676666259766
local_in_edges_tensor generation:  0.002741098403930664
mini_batch_src_global generation:  0.005873203277587891
r_  generation:  0.0543212890625
local_output_nid generation:  0.004033327102661133
local_in_edges_tensor generation:  0.002235889434814453
mini_batch_src_global generation:  0.004622936248779297
r_  generation:  0.05675840377807617
local_output_nid generation:  0.004071474075317383
local_in_edges_tensor generation:  0.0018308162689208984
mini_batch_src_global generation:  0.004479646682739258
r_  generation:  0.05558156967163086
local_output_nid generation:  0.004063844680786133
local_in_edges_tensor generation:  0.0018460750579833984
mini_batch_src_global generation:  0.0045659542083740234
r_  generation:  0.05707597732543945
local_output_nid generation:  0.0040171146392822266
local_in_edges_tensor generation:  0.0018343925476074219
mini_batch_src_global generation:  0.0046863555908203125
r_  generation:  0.05794501304626465
local_output_nid generation:  0.004050254821777344
local_in_edges_tensor generation:  0.0018696784973144531
mini_batch_src_global generation:  0.0045320987701416016
r_  generation:  0.05661511421203613
local_output_nid generation:  0.004014015197753906
local_in_edges_tensor generation:  0.0018138885498046875
mini_batch_src_global generation:  0.004637718200683594
r_  generation:  0.05672121047973633
----------------------check_connections_block total spend ----------------------------- 0.6435520648956299
generate_one_block  0.07671976089477539
generate_one_block  0.07331275939941406
generate_one_block  0.07568979263305664
generate_one_block  0.07453370094299316
generate_one_block  0.07934069633483887
generate_one_block  0.07319355010986328
generate_one_block  0.07178783416748047
generate_one_block  0.07105135917663574
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 75215
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8583984375 GB
    Memory Allocated: 0.03639554977416992  GigaBytes
Max Memory Allocated: 0.03639554977416992  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8583984375 GB
    Memory Allocated: 0.03648042678833008  GigaBytes
Max Memory Allocated: 0.03648042678833008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8583984375 GB
    Memory Allocated: 0.03648042678833008  GigaBytes
Max Memory Allocated: 0.03648042678833008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.9072265625 GB
    Memory Allocated: 0.0374150276184082  GigaBytes
Max Memory Allocated: 0.0374150276184082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.9072265625 GB
    Memory Allocated: 0.0374150276184082  GigaBytes
Max Memory Allocated: 0.0374150276184082  GigaBytes

input nodes number: 75215
output nodes number: 11368
edges number: 125357
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9755859375 GB
    Memory Allocated: 0.9641509056091309  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9755859375 GB
    Memory Allocated: 0.9641518592834473  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9775390625 GB
    Memory Allocated: 0.04126310348510742  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

pseudo mini batch 1 input nodes size: 74305
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9775390625 GB
    Memory Allocated: 0.03870582580566406  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9775390625 GB
    Memory Allocated: 0.03870582580566406  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9775390625 GB
    Memory Allocated: 0.07413721084594727  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9775390625 GB
    Memory Allocated: 0.07422208786010742  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9775390625 GB
    Memory Allocated: 0.03827190399169922  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9775390625 GB
    Memory Allocated: 0.03919410705566406  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9775390625 GB
    Memory Allocated: 0.03919410705566406  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

input nodes number: 74305
output nodes number: 11368
edges number: 123734
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0380859375 GB
    Memory Allocated: 0.9535980224609375  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0380859375 GB
    Memory Allocated: 0.9535984992980957  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0380859375 GB
    Memory Allocated: 0.04079771041870117  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

pseudo mini batch 2 input nodes size: 75272
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0380859375 GB
    Memory Allocated: 0.03827190399169922  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0380859375 GB
    Memory Allocated: 0.03827190399169922  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0380859375 GB
    Memory Allocated: 0.07416439056396484  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0380859375 GB
    Memory Allocated: 0.074249267578125  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0380859375 GB
    Memory Allocated: 0.03873300552368164  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0380859375 GB
    Memory Allocated: 0.039685726165771484  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0380859375 GB
    Memory Allocated: 0.039685726165771484  GigaBytes
Max Memory Allocated: 1.031914234161377  GigaBytes

input nodes number: 75272
output nodes number: 11368
edges number: 127797
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9819416999816895  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9819421768188477  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04132699966430664  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

pseudo mini batch 3 input nodes size: 74895
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03873300552368164  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03873300552368164  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07444572448730469  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07453060150146484  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03855323791503906  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03948497772216797  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03948497772216797  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

input nodes number: 74895
output nodes number: 11368
edges number: 125043
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9621996879577637  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9622001647949219  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04110240936279297  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

pseudo mini batch 4 input nodes size: 76875
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03855323791503906  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03855323791503906  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07566261291503906  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07574748992919922  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039949893951416016  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0409235954284668  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0409235954284668  GigaBytes
Max Memory Allocated: 1.0517926216125488  GigaBytes

input nodes number: 76875
output nodes number: 11368
edges number: 130570
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 1.0027270317077637  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 1.0027275085449219  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04259777069091797  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 5 input nodes size: 75335
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039949893951416016  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039949893951416016  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07587242126464844  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0759572982788086  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03876304626464844  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03970527648925781  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03970527648925781  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 75335
output nodes number: 11368
edges number: 126436
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9717988967895508  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.971799373626709  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0413365364074707  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 6 input nodes size: 75055
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03876304626464844  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03876304626464844  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07455205917358398  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07463693618774414  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03862953186035156  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03956794738769531  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03956794738769531  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 75055
output nodes number: 11368
edges number: 125880
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.969144344329834  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9691448211669922  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04119300842285156  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 7 input nodes size: 74137
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03862953186035156  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03862953186035156  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07398080825805664  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0740656852722168  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.038191795349121094  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03911590576171875  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03911590576171875  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 74137
output nodes number: 11365
edges number: 123990
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9556674957275391  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9556679725646973  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04071950912475586  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04177999496459961  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04177999496459961  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.022005796432495117 |0.05097362399101257 |0.5783428251743317 |0.00014907121658325195 |0.9682097136974335 |0.004731178283691406 |
----------------------------------------------------------pseudo_mini_loss sum 3.8378477096557617
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  601089
Number of first layer input nodes during this epoch:  601089
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.041779518127441406  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028368711471557617
number of batches is  8
batch size is  11368
range selection method spend 0.015334606170654297
time for parepare:  0.023224592208862305
local_output_nid generation:  0.0035834312438964844
local_in_edges_tensor generation:  0.007594108581542969
mini_batch_src_global generation:  0.005750417709350586
r_  generation:  0.05638766288757324
local_output_nid generation:  0.00451970100402832
local_in_edges_tensor generation:  0.003401041030883789
mini_batch_src_global generation:  0.006048679351806641
r_  generation:  0.05523109436035156
local_output_nid generation:  0.004368782043457031
local_in_edges_tensor generation:  0.0019161701202392578
mini_batch_src_global generation:  0.004228830337524414
r_  generation:  0.05428171157836914
local_output_nid generation:  0.004242420196533203
local_in_edges_tensor generation:  0.0020368099212646484
mini_batch_src_global generation:  0.004297971725463867
r_  generation:  0.05670166015625
local_output_nid generation:  0.004252195358276367
local_in_edges_tensor generation:  0.0019047260284423828
mini_batch_src_global generation:  0.0043981075286865234
r_  generation:  0.05488944053649902
local_output_nid generation:  0.004469633102416992
local_in_edges_tensor generation:  0.001903533935546875
mini_batch_src_global generation:  0.004524707794189453
r_  generation:  0.0579524040222168
local_output_nid generation:  0.003746509552001953
local_in_edges_tensor generation:  0.0018377304077148438
mini_batch_src_global generation:  0.004536628723144531
r_  generation:  0.057744741439819336
local_output_nid generation:  0.003709077835083008
local_in_edges_tensor generation:  0.001806497573852539
mini_batch_src_global generation:  0.004670143127441406
r_  generation:  0.056670188903808594
----------------------check_connections_block total spend ----------------------------- 0.6524631977081299
generate_one_block  0.08902263641357422
generate_one_block  0.08210563659667969
generate_one_block  0.0853111743927002
generate_one_block  0.08210611343383789
generate_one_block  0.08307194709777832
generate_one_block  0.08514571189880371
generate_one_block  0.09368300437927246
generate_one_block  0.09047913551330566
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.041779518127441406  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.6446776390075684
pseudo mini batch 0 input nodes size: 74764
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039250850677490234  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039250850677490234  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07490110397338867  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07498598098754883  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039549827575683594  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.040493011474609375  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.040493011474609375  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 74764
output nodes number: 11368
edges number: 126514
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9738221168518066  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.973823070526123  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04212236404418945  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 1 input nodes size: 74882
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0395512580871582  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0395512580871582  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07525777816772461  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07534265518188477  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03960752487182617  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04054117202758789  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04054117202758789  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 74882
output nodes number: 11368
edges number: 125278
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9635396003723145  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9635400772094727  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0421605110168457  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 2 input nodes size: 75193
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03960752487182617  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03960752487182617  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07546234130859375  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0755472183227539  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039755821228027344  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04068565368652344  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04068565368652344  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 75193
output nodes number: 11368
edges number: 124745
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9604859352111816  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9604864120483398  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04230308532714844  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 3 input nodes size: 74820
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039755821228027344  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039755821228027344  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07543277740478516  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07551765441894531  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03957796096801758  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.040506839752197266  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.040506839752197266  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 74820
output nodes number: 11368
edges number: 124576
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9613943099975586  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9613947868347168  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.042120933532714844  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 4 input nodes size: 74797
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03957796096801758  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03957796096801758  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07524394989013672  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07532882690429688  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039566993713378906  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.040500640869140625  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.040500640869140625  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 74797
output nodes number: 11368
edges number: 125263
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9653143882751465  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9653148651123047  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04211902618408203  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 5 input nodes size: 74758
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039566993713378906  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039566993713378906  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07521438598632812  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07529926300048828  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039548397064208984  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0404810905456543  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0404810905456543  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 74758
output nodes number: 11368
edges number: 125155
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9641900062561035  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9641904830932617  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0420985221862793  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 6 input nodes size: 75655
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039548397064208984  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.039548397064208984  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.0756235122680664  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07570838928222656  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03997611999511719  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04093170166015625  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04093170166015625  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 75655
output nodes number: 11368
edges number: 128154
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9870481491088867  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.9870486259460449  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.042578697204589844  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 7 input nodes size: 76117
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03997611999511719  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.03997611999511719  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07627153396606445  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.07635641098022461  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04019641876220703  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04115867614746094  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1259765625 GB
    Memory Allocated: 0.04115867614746094  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 76117
output nodes number: 11365
edges number: 129122
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9919018745422363  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9919023513793945  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.043573856353759766  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.043573856353759766  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.043573856353759766  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02108985185623169 |0.0017058253288269043 |0.524681568145752 |0.00013515353202819824 |0.9273895621299744 |0.004414796829223633 |
----------------------------------------------------------pseudo_mini_loss sum 3.267111301422119
Total (block generation + training)time/epoch 13.55023980140686
Training time/epoch 11.905229568481445
Training time without block to device /epoch 11.89158296585083
Training time without total dataloading part /epoch 11.62206506729126
load block tensor time/epoch 0.16871881484985352
block to device time/epoch 0.013646602630615234
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  600986
Number of first layer input nodes during this epoch:  600986
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04357337951660156  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03306126594543457
number of batches is  8
batch size is  11368
range selection method spend 0.016477108001708984
time for parepare:  0.024235248565673828
local_output_nid generation:  0.0036745071411132812
local_in_edges_tensor generation:  0.008456945419311523
mini_batch_src_global generation:  0.005200862884521484
r_  generation:  0.05247616767883301
local_output_nid generation:  0.004343271255493164
local_in_edges_tensor generation:  0.0027773380279541016
mini_batch_src_global generation:  0.006226778030395508
r_  generation:  0.054703712463378906
local_output_nid generation:  0.004384279251098633
local_in_edges_tensor generation:  0.002743959426879883
mini_batch_src_global generation:  0.004726409912109375
r_  generation:  0.05688285827636719
local_output_nid generation:  0.004505157470703125
local_in_edges_tensor generation:  0.0020537376403808594
mini_batch_src_global generation:  0.0045888423919677734
r_  generation:  0.05529975891113281
local_output_nid generation:  0.004397153854370117
local_in_edges_tensor generation:  0.001983165740966797
mini_batch_src_global generation:  0.004459857940673828
r_  generation:  0.05554533004760742
local_output_nid generation:  0.0038213729858398438
local_in_edges_tensor generation:  0.0024213790893554688
mini_batch_src_global generation:  0.0045125484466552734
r_  generation:  0.056031227111816406
local_output_nid generation:  0.003817319869995117
local_in_edges_tensor generation:  0.0018651485443115234
mini_batch_src_global generation:  0.004923105239868164
r_  generation:  0.055254459381103516
local_output_nid generation:  0.0037949085235595703
local_in_edges_tensor generation:  0.0018756389617919922
mini_batch_src_global generation:  0.0046160221099853516
r_  generation:  0.055382490158081055
----------------------check_connections_block total spend ----------------------------- 0.6446371078491211
generate_one_block  0.08794975280761719
generate_one_block  0.08307003974914551
generate_one_block  0.08486032485961914
generate_one_block  0.08254480361938477
generate_one_block  0.08205437660217285
generate_one_block  0.08405256271362305
generate_one_block  0.08194875717163086
generate_one_block  0.08244514465332031
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04357337951660156  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.6268212795257568
pseudo mini batch 0 input nodes size: 74065
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.040953636169433594  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.040953636169433594  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07627058029174805  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.0763554573059082  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.03997516632080078  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04088401794433594  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04088401794433594  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 74065
output nodes number: 11368
edges number: 121866
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9407777786254883  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9407787322998047  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.041715145111083984  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 1 input nodes size: 74947
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.03921794891357422  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.03921794891357422  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07495546340942383  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07504034042358398  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.039638519287109375  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.040572166442871094  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.040572166442871094  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 74947
output nodes number: 11368
edges number: 125296
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9658350944519043  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9658355712890625  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04219198226928711  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 2 input nodes size: 75976
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.039638519287109375  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.039638519287109375  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07674789428710938  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07683277130126953  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.041010379791259766  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04196786880493164  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04196786880493164  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 75976
output nodes number: 11368
edges number: 128507
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9895286560058594  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9895291328430176  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04361915588378906  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 3 input nodes size: 74811
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.041010379791259766  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.041010379791259766  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07668304443359375  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.0767679214477539  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.03957366943359375  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.040511131286621094  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.040511131286621094  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 74811
output nodes number: 11368
edges number: 125755
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9676828384399414  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9676833152770996  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.042133331298828125  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 4 input nodes size: 75015
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.03957366943359375  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.03957366943359375  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07534360885620117  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07542848587036133  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.03967094421386719  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04061126708984375  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04061126708984375  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 75015
output nodes number: 11368
edges number: 126118
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9726643562316895  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9726648330688477  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04223823547363281  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 5 input nodes size: 76123
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.03967094421386719  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.03967094421386719  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07596921920776367  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07605409622192383  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04019927978515625  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04115581512451172  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04115581512451172  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 76123
output nodes number: 11368
edges number: 128374
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9859261512756348  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.985926628112793  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04280710220336914  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 6 input nodes size: 74560
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04019927978515625  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04019927978515625  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07575225830078125  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.0758371353149414  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.039453983306884766  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04039430618286133  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04039430618286133  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 74560
output nodes number: 11368
edges number: 126189
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9708957672119141  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9708962440490723  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.042017459869384766  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

pseudo mini batch 7 input nodes size: 75743
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.039453983306884766  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.039453983306884766  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07557106018066406  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.07565593719482422  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04001808166503906  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04096221923828125  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04096221923828125  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

input nodes number: 75743
output nodes number: 11365
edges number: 126702
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9759764671325684  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.9759769439697266  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04259777069091797  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04259777069091797  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.1396484375 GB
    Memory Allocated: 0.04259777069091797  GigaBytes
Max Memory Allocated: 1.073789119720459  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019260525703430176 |0.0013318061828613281 |0.5088588297367096 |0.00012788176536560059 |0.9401136338710785 |0.0035800933837890625 |
----------------------------------------------------------pseudo_mini_loss sum 3.172055959701538
Total (block generation + training)time/epoch 13.508175253868103
Training time/epoch 11.856958150863647
Training time without block to device /epoch 11.846303701400757
Training time without total dataloading part /epoch 11.596382856369019
load block tensor time/epoch 0.1540842056274414
block to device time/epoch 0.010654449462890625
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  601240
Number of first layer input nodes during this epoch:  601240
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])Using backend: pytorch

layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
