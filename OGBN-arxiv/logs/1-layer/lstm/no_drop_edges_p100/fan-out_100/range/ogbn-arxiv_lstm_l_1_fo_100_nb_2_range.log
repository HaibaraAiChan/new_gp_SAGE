main start at this time 1651811578.0116208
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06743574142456055
number of batches is  2
batch size is  45471
range selection method spend 0.025774717330932617
time for parepare:  0.03354907035827637
local_output_nid generation:  0.01645040512084961
local_in_edges_tensor generation:  0.01961493492126465
mini_batch_src_global generation:  0.01641392707824707
r_  generation:  0.24561858177185059
local_output_nid generation:  0.016009807586669922
local_in_edges_tensor generation:  0.013241052627563477
mini_batch_src_global generation:  0.021396875381469727
r_  generation:  0.2642199993133545
----------------------check_connections_block total spend ----------------------------- 0.7276759147644043
generate_one_block  0.28233838081359863
generate_one_block  0.2911980152130127
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 140157
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.06736230850219727  GigaBytes
Max Memory Allocated: 0.06736230850219727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.06770133972167969  GigaBytes
Max Memory Allocated: 0.06770133972167969  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.06770133972167969  GigaBytes
Max Memory Allocated: 0.06770133972167969  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.9580078125 GB
    Memory Allocated: 0.071441650390625  GigaBytes
Max Memory Allocated: 0.071441650390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.9580078125 GB
    Memory Allocated: 0.071441650390625  GigaBytes
Max Memory Allocated: 0.071441650390625  GigaBytes

input nodes number: 140157
output nodes number: 45471
edges number: 501929
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0576171875 GB
    Memory Allocated: 3.8144054412841797  GigaBytes
Max Memory Allocated: 4.084465503692627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0576171875 GB
    Memory Allocated: 3.814406394958496  GigaBytes
Max Memory Allocated: 4.084465503692627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0576171875 GB
    Memory Allocated: 0.08497190475463867  GigaBytes
Max Memory Allocated: 4.084465503692627  GigaBytes

pseudo mini batch 1 input nodes size: 140459
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0576171875 GB
    Memory Allocated: 0.07500839233398438  GigaBytes
Max Memory Allocated: 4.084465503692627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0576171875 GB
    Memory Allocated: 0.07500839233398438  GigaBytes
Max Memory Allocated: 4.084465503692627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0576171875 GB
    Memory Allocated: 0.1419844627380371  GigaBytes
Max Memory Allocated: 4.084465503692627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0576171875 GB
    Memory Allocated: 0.14232349395751953  GigaBytes
Max Memory Allocated: 4.084465503692627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0576171875 GB
    Memory Allocated: 0.07515239715576172  GigaBytes
Max Memory Allocated: 4.084465503692627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0576171875 GB
    Memory Allocated: 0.07892894744873047  GigaBytes
Max Memory Allocated: 4.084465503692627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0576171875 GB
    Memory Allocated: 0.07892894744873047  GigaBytes
Max Memory Allocated: 4.084465503692627  GigaBytes

input nodes number: 140459
output nodes number: 45470
edges number: 506878
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 3.8326492309570312  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 3.8326497077941895  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0850071907043457  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.08606767654418945  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.08606767654418945  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035134315490722656 |0.20170676708221436 |1.0582748651504517 |0.00021445751190185547 |1.296007752418518 |0.0044596195220947266 |
----------------------------------------------------------pseudo_mini_loss sum 3.8378472328186035
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  280616
Number of first layer input nodes during this epoch:  280616
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.08606719970703125  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03569293022155762
number of batches is  2
batch size is  45471
range selection method spend 0.014114856719970703
time for parepare:  0.0225372314453125
local_output_nid generation:  0.013034820556640625
local_in_edges_tensor generation:  0.015065908432006836
mini_batch_src_global generation:  0.016627073287963867
r_  generation:  0.24126887321472168
local_output_nid generation:  0.01608753204345703
local_in_edges_tensor generation:  0.012226104736328125
mini_batch_src_global generation:  0.02156829833984375
r_  generation:  0.26181983947753906
----------------------check_connections_block total spend ----------------------------- 0.7026550769805908
generate_one_block  0.3071465492248535
generate_one_block  0.3086671829223633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.08606719970703125  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.4618291854858398
pseudo mini batch 0 input nodes size: 139893
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07621192932128906  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07621192932128906  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.14291810989379883  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.14325714111328125  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0759420394897461  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07967567443847656  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07967567443847656  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

input nodes number: 139893
output nodes number: 45471
edges number: 501104
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 3.79349422454834  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 3.7934951782226562  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.08509397506713867  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

pseudo mini batch 1 input nodes size: 140483
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0759429931640625  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0759429931640625  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.1429305076599121  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.14326953887939453  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07622432708740234  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.08000755310058594  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.08000755310058594  GigaBytes
Max Memory Allocated: 4.111790180206299  GigaBytes

input nodes number: 140483
output nodes number: 45470
edges number: 507703
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 3.8537445068359375  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 3.8537449836730957  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0858159065246582  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0858159065246582  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0858159065246582  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03253459930419922 |0.004408001899719238 |0.50208580493927 |0.00012981891632080078 |1.2969945669174194 |0.00334930419921875 |
----------------------------------------------------------pseudo_mini_loss sum 3.267111301422119
Total (block generation + training)time/epoch 5.163893222808838
Training time/epoch 3.701521873474121
Training time without block to device /epoch 3.6927058696746826
Training time without total dataloading part /epoch 3.6017696857452393
load block tensor time/epoch 0.06506919860839844
block to device time/epoch 0.008816003799438477
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  280376
Number of first layer input nodes during this epoch:  280376
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0858154296875  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022289037704467773
number of batches is  2
batch size is  45471
range selection method spend 0.015074014663696289
time for parepare:  0.02164912223815918
local_output_nid generation:  0.012241363525390625
local_in_edges_tensor generation:  0.016104698181152344
mini_batch_src_global generation:  0.01802802085876465
r_  generation:  0.2206103801727295
local_output_nid generation:  0.015083074569702148
local_in_edges_tensor generation:  0.00829935073852539
mini_batch_src_global generation:  0.022478103637695312
r_  generation:  0.23666739463806152
----------------------check_connections_block total spend ----------------------------- 0.6521964073181152
generate_one_block  0.30072832107543945
generate_one_block  0.2972829341888428
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0858154296875  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.4221111536026
pseudo mini batch 0 input nodes size: 140187
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07622337341308594  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07622337341308594  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes
Using backend: pytorch

----------------------------------------after batch input features to device
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.14306974411010742  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.14340877532958984  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07608222961425781  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0804595947265625  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0804595947265625  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

input nodes number: 140187
output nodes number: 45471
edges number: 501414
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 3.812969207763672  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 3.8129701614379883  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.08587312698364258  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

pseudo mini batch 1 input nodes size: 140271
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07608318328857422  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07608318328857422  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.14296960830688477  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.1433086395263672  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07612323760986328  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07990455627441406  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.07990455627441406  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

input nodes number: 140271
output nodes number: 45470
edges number: 507393
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 3.8332529067993164  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 3.8332533836364746  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0857243537902832  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0857243537902832  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.3603515625 GB
    Memory Allocated: 0.0857243537902832  GigaBytes
Max Memory Allocated: 4.132452487945557  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027594447135925293 |0.002521514892578125 |0.529805064201355 |0.00018143653869628906 |1.3186653852462769 |0.0042116641998291016 |
----------------------------------------------------------pseudo_mini_loss sum 3.172055244445801
Total (block generation + training)time/epoch 5.167359232902527
Training time/epoch 3.788118600845337
Training time without block to device /epoch 3.7830755710601807
Training time without total dataloading part /epoch 3.7015154361724854
load block tensor time/epoch 0.055188894271850586
block to device time/epoch 0.00504302978515625
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  280458
Number of first layer input nodes during this epoch:  280458
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
