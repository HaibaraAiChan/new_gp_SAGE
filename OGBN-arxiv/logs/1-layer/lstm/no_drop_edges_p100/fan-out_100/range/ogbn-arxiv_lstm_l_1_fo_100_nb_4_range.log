main start at this time 1651811606.0712988
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0860910415649414
number of batches is  4
batch size is  22736
range selection method spend 0.014563798904418945
time for parepare:  0.02084660530090332
local_output_nid generation:  0.006134033203125
local_in_edges_tensor generation:  0.008189201354980469
mini_batch_src_global generation:  0.010388851165771484
r_  generation:  0.10707616806030273
local_output_nid generation:  0.006979703903198242
local_in_edges_tensor generation:  0.006582975387573242
mini_batch_src_global generation:  0.011840105056762695
r_  generation:  0.1169743537902832
local_output_nid generation:  0.0071141719818115234
local_in_edges_tensor generation:  0.0036149024963378906
mini_batch_src_global generation:  0.013573884963989258
r_  generation:  0.11949944496154785
local_output_nid generation:  0.007108211517333984
local_in_edges_tensor generation:  0.0036468505859375
mini_batch_src_global generation:  0.010157346725463867
r_  generation:  0.1196441650390625
----------------------check_connections_block total spend ----------------------------- 0.6608371734619141
generate_one_block  0.13596129417419434
generate_one_block  0.14005017280578613
generate_one_block  0.1400759220123291
generate_one_block  0.13637733459472656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 108537
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8740234375 GB
    Memory Allocated: 0.05228471755981445  GigaBytes
Max Memory Allocated: 0.05228471755981445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8740234375 GB
    Memory Allocated: 0.052454471588134766  GigaBytes
Max Memory Allocated: 0.052454471588134766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8740234375 GB
    Memory Allocated: 0.052454471588134766  GigaBytes
Max Memory Allocated: 0.052454471588134766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.9248046875 GB
    Memory Allocated: 0.054311275482177734  GigaBytes
Max Memory Allocated: 0.054311275482177734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.9248046875 GB
    Memory Allocated: 0.054311275482177734  GigaBytes
Max Memory Allocated: 0.054311275482177734  GigaBytes

input nodes number: 108537
output nodes number: 22736
edges number: 249091
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0322265625 GB
    Memory Allocated: 1.8985042572021484  GigaBytes
Max Memory Allocated: 2.0331954956054688  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0322265625 GB
    Memory Allocated: 1.8985052108764648  GigaBytes
Max Memory Allocated: 2.0331954956054688  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0322265625 GB
    Memory Allocated: 0.061150550842285156  GigaBytes
Max Memory Allocated: 2.0331954956054688  GigaBytes

pseudo mini batch 1 input nodes size: 108693
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0322265625 GB
    Memory Allocated: 0.05637359619140625  GigaBytes
Max Memory Allocated: 2.0331954956054688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0322265625 GB
    Memory Allocated: 0.05637359619140625  GigaBytes
Max Memory Allocated: 2.0331954956054688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0322265625 GB
    Memory Allocated: 0.10820245742797852  GigaBytes
Max Memory Allocated: 2.0331954956054688  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0322265625 GB
    Memory Allocated: 0.10837221145629883  GigaBytes
Max Memory Allocated: 2.0331954956054688  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0322265625 GB
    Memory Allocated: 0.05644798278808594  GigaBytes
Max Memory Allocated: 2.0331954956054688  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0322265625 GB
    Memory Allocated: 0.05833244323730469  GigaBytes
Max Memory Allocated: 2.0331954956054688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0322265625 GB
    Memory Allocated: 0.05833244323730469  GigaBytes
Max Memory Allocated: 2.0331954956054688  GigaBytes

input nodes number: 108693
output nodes number: 22736
edges number: 252840
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1708984375 GB
    Memory Allocated: 1.9289674758911133  GigaBytes
Max Memory Allocated: 2.0686168670654297  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1708984375 GB
    Memory Allocated: 1.9289679527282715  GigaBytes
Max Memory Allocated: 2.0686168670654297  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1708984375 GB
    Memory Allocated: 0.061281681060791016  GigaBytes
Max Memory Allocated: 2.0686168670654297  GigaBytes

pseudo mini batch 2 input nodes size: 109892
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1708984375 GB
    Memory Allocated: 0.05644798278808594  GigaBytes
Max Memory Allocated: 2.0686168670654297  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1708984375 GB
    Memory Allocated: 0.05644798278808594  GigaBytes
Max Memory Allocated: 2.0686168670654297  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1708984375 GB
    Memory Allocated: 0.10918235778808594  GigaBytes
Max Memory Allocated: 2.0686168670654297  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1708984375 GB
    Memory Allocated: 0.10935211181640625  GigaBytes
Max Memory Allocated: 2.0686168670654297  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1708984375 GB
    Memory Allocated: 0.05735349655151367  GigaBytes
Max Memory Allocated: 2.0686168670654297  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1708984375 GB
    Memory Allocated: 0.05926847457885742  GigaBytes
Max Memory Allocated: 2.0686168670654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1708984375 GB
    Memory Allocated: 0.05926847457885742  GigaBytes
Max Memory Allocated: 2.0686168670654297  GigaBytes

input nodes number: 109892
output nodes number: 22736
edges number: 257006
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 1.9569611549377441  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 1.9569616317749023  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06225728988647461  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

pseudo mini batch 3 input nodes size: 108605
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05735349655151367  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05735349655151367  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.10914039611816406  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.10931015014648438  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05640602111816406  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05826854705810547  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05826854705810547  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

input nodes number: 108605
output nodes number: 22733
edges number: 249870
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 1.9084529876708984  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 1.9084534645080566  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06119489669799805  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.0622553825378418  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.0622553825378418  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021669447422027588 |0.09976053237915039 |0.6468035578727722 |0.0001455545425415039 |0.968673050403595 |0.005595207214355469 |
----------------------------------------------------------pseudo_mini_loss sum 3.8378472328186035
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  435727
Number of first layer input nodes during this epoch:  435727
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.062254905700683594  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02555227279663086
number of batches is  4
batch size is  22736
range selection method spend 0.014958858489990234
time for parepare:  0.021254777908325195
local_output_nid generation:  0.006261110305786133
local_in_edges_tensor generation:  0.011761665344238281
mini_batch_src_global generation:  0.01001429557800293
r_  generation:  0.11545324325561523
local_output_nid generation:  0.007151603698730469
local_in_edges_tensor generation:  0.0040378570556640625
mini_batch_src_global generation:  0.011911392211914062
r_  generation:  0.10904335975646973
local_output_nid generation:  0.007339000701904297
local_in_edges_tensor generation:  0.0036211013793945312
mini_batch_src_global generation:  0.010003805160522461
r_  generation:  0.11879849433898926
local_output_nid generation:  0.007184743881225586
local_in_edges_tensor generation:  0.003667593002319336
mini_batch_src_global generation:  0.010289907455444336
r_  generation:  0.11705970764160156
----------------------check_connections_block total spend ----------------------------- 0.6550159454345703
generate_one_block  0.15639042854309082
generate_one_block  0.15141010284423828
generate_one_block  0.15207409858703613
generate_one_block  0.15738511085510254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.062254905700683594  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.442098617553711
pseudo mini batch 0 input nodes size: 108412
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.057465553283691406  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.057465553283691406  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.1091604232788086  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.1093301773071289  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.0573735237121582  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.0592503547668457  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.0592503547668457  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

input nodes number: 108412
output nodes number: 22736
edges number: 251792
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 1.9186244010925293  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 1.9186253547668457  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06219053268432617  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

pseudo mini batch 1 input nodes size: 108733
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05737447738647461  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05737447738647461  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.109222412109375  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.10939216613769531  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05752754211425781  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05938529968261719  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05938529968261719  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

input nodes number: 108733
output nodes number: 22736
edges number: 249321
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 1.90547513961792  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 1.9054756164550781  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06230783462524414  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

pseudo mini batch 2 input nodes size: 108680
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05752754211425781  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05752754211425781  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.11026191711425781  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.11043167114257812  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06028032302856445  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06028032302856445  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

input nodes number: 108680
output nodes number: 22736
edges number: 250418
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 1.9100241661071777  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 1.910024642944336  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.06321144104003906  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

pseudo mini batch 3 input nodes size: 109661
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.11070442199707031  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.11087417602539062  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.05797004699707031  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.059886932373046875  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3056640625 GB
    Memory Allocated: 0.059886932373046875  GigaBytes
Max Memory Allocated: 2.0986876487731934  GigaBytes

input nodes number: 109661
output nodes number: 22733
edges number: 257276
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 1.9628663063049316  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 1.9628667831420898  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.06287574768066406  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.06287574768066406  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.06287574768066406  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021771788597106934 |0.0019881725311279297 |0.4887884855270386 |0.00013494491577148438 |0.9723161458969116 |0.0034821033477783203 |
----------------------------------------------------------pseudo_mini_loss sum 3.2671117782592773
Total (block generation + training)time/epoch 7.433377265930176
Training time/epoch 5.990749359130859
Training time without block to device /epoch 5.982796669006348
Training time without total dataloading part /epoch 5.848440408706665
load block tensor time/epoch 0.08708715438842773
block to device time/epoch 0.007952690124511719
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  435486
Number of first layer input nodes during this epoch:  435486
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.06287527084350586  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02472519874572754
number of batches is  4
batch size is  22736
range selection method spend 0.015027284622192383
time for parepare:  0.02269768714904785
local_output_nid generation:  0.0062296390533447266
local_in_edges_tensor generation:  0.011705398559570312
mini_batch_src_global generation:  0.010033369064331055
r_  generation:  0.10698747634887695
local_output_nid generation:  0.007356166839599609
local_in_edges_tensor generation:  0.005150794982910156
mini_batch_src_global generation:  0.012205839157104492
r_  generation:  0.11794447898864746
local_output_nid generation:  0.007339000701904297
local_in_edges_tensor generation:  0.0045855045318603516
mini_batch_src_global generation:  0.009932518005371094
r_  generation:  0.11504411697387695
local_output_nid generation:  0.0074176788330078125
local_in_edges_tensor generation:  0.003621339797973633
mini_batch_src_global generation:  0.01019430160522461
r_  generation:  0.1171116828918457
----------------------check_connections_block total spend ----------------------------- 0.6551592350006104
generate_one_block  0.15404748916625977
generate_one_block  0.15336203575134277
generate_one_block  0.15258097648620605
generate_one_block  0.15286874771118164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.06287527084350586  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.4442732334136963
pseudo mini batch 0 input nodes size: 108579
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.057969093322753906  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.057969093322753906  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.1107034683227539  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.11087322235107422  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.058413028717041016  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.060254573822021484  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.060254573822021484  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

input nodes number: 108579
output nodes number: 22736
edges number: 247162
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 1.889655590057373  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 1.8896565437316895  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.06316089630126953  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

pseudo mini batch 1 input nodes size: 109302
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.11053323745727539  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.1107029914855957  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05779886245727539  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05969381332397461  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05969381332397461  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

input nodes number: 109302
output nodes number: 22736
edges number: 254262
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 1.9380507469177246  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 1.9380512237548828  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.06265783309936523  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

pseudo mini batch 2 input nodes size: 109191
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05779886245727539  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05779886245727539  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.11053323745727539  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.1107029914855957  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.06031084060668945  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.06031084060668945  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

input nodes number: 109191
output nodes number: 22736
edges number: 254492
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 1.9410533905029297  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 1.941053867340088  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.06327629089355469  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

pseudo mini batch 3 input nodes size: 108703
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes
Using backend: pytorch

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.11024761199951172  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.11041736602783203  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05751323699951172  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05939769744873047  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.05939769744873047  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

input nodes number: 108703
output nodes number: 22733
edges number: 252891
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 1.929154396057129  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 1.929154872894287  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.0623469352722168  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.0623469352722168  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.3212890625 GB
    Memory Allocated: 0.0623469352722168  GigaBytes
Max Memory Allocated: 2.1039657592773438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0218355655670166 |0.0016049742698669434 |0.4959079623222351 |0.00012862682342529297 |0.9647841453552246 |0.004157066345214844 |
----------------------------------------------------------pseudo_mini_loss sum 3.172056198120117
Total (block generation + training)time/epoch 7.43140721321106
Training time/epoch 5.98278021812439
Training time without block to device /epoch 5.976360321044922
Training time without total dataloading part /epoch 5.847440004348755
load block tensor time/epoch 0.0873422622680664
block to device time/epoch 0.0064198970794677734
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  435775
Number of first layer input nodes during this epoch:  435775
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
