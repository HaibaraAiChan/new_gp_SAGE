main start at this time 1651811108.2259371
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02982020378112793
number of batches is  8
batch size is  11368
random selection method spend 0.007220029830932617
time for parepare:  0.0223386287689209
local_output_nid generation:  0.004164457321166992
local_in_edges_tensor generation:  0.007984638214111328
mini_batch_src_global generation:  0.00494694709777832
r_  generation:  0.05573081970214844
local_output_nid generation:  0.006795406341552734
local_in_edges_tensor generation:  0.004352569580078125
mini_batch_src_global generation:  0.00620722770690918
r_  generation:  0.05574798583984375
local_output_nid generation:  0.005949974060058594
local_in_edges_tensor generation:  0.0031201839447021484
mini_batch_src_global generation:  0.0041615962982177734
r_  generation:  0.05594944953918457
local_output_nid generation:  0.005856990814208984
local_in_edges_tensor generation:  0.00313568115234375
mini_batch_src_global generation:  0.004282951354980469
r_  generation:  0.057048797607421875
local_output_nid generation:  0.00579524040222168
local_in_edges_tensor generation:  0.0030536651611328125
mini_batch_src_global generation:  0.004454374313354492
r_  generation:  0.05823826789855957
local_output_nid generation:  0.00569915771484375
local_in_edges_tensor generation:  0.003212451934814453
mini_batch_src_global generation:  0.004613161087036133
r_  generation:  0.05785489082336426
local_output_nid generation:  0.00578618049621582
local_in_edges_tensor generation:  0.0031499862670898438
mini_batch_src_global generation:  0.0045490264892578125
r_  generation:  0.05589151382446289
local_output_nid generation:  0.005723714828491211
local_in_edges_tensor generation:  0.0028982162475585938
mini_batch_src_global generation:  0.00456547737121582
r_  generation:  0.05631661415100098
----------------------check_connections_block total spend ----------------------------- 0.6780862808227539
generate_one_block  0.07445836067199707
generate_one_block  0.07412457466125488
generate_one_block  0.07529759407043457
generate_one_block  0.07598137855529785
generate_one_block  0.07842636108398438
generate_one_block  0.07586383819580078
generate_one_block  0.07474136352539062
generate_one_block  0.0745096206665039
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 74366
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8583984375 GB
    Memory Allocated: 0.03599071502685547  GigaBytes
Max Memory Allocated: 0.03599071502685547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8583984375 GB
    Memory Allocated: 0.036075592041015625  GigaBytes
Max Memory Allocated: 0.036075592041015625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8583984375 GB
    Memory Allocated: 0.036075592041015625  GigaBytes
Max Memory Allocated: 0.036075592041015625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.9072265625 GB
    Memory Allocated: 0.03699207305908203  GigaBytes
Max Memory Allocated: 0.03699207305908203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.9072265625 GB
    Memory Allocated: 0.03699207305908203  GigaBytes
Max Memory Allocated: 0.03699207305908203  GigaBytes

input nodes number: 74366
output nodes number: 11368
edges number: 123004
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9580078125 GB
    Memory Allocated: 0.9470605850219727  GigaBytes
Max Memory Allocated: 1.012601375579834  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9580078125 GB
    Memory Allocated: 0.9470615386962891  GigaBytes
Max Memory Allocated: 1.012601375579834  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9580078125 GB
    Memory Allocated: 0.04081535339355469  GigaBytes
Max Memory Allocated: 1.012601375579834  GigaBytes

pseudo mini batch 1 input nodes size: 74698
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9580078125 GB
    Memory Allocated: 0.03830099105834961  GigaBytes
Max Memory Allocated: 1.012601375579834  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9580078125 GB
    Memory Allocated: 0.03830099105834961  GigaBytes
Max Memory Allocated: 1.012601375579834  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9580078125 GB
    Memory Allocated: 0.07391977310180664  GigaBytes
Max Memory Allocated: 1.012601375579834  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9580078125 GB
    Memory Allocated: 0.0740046501159668  GigaBytes
Max Memory Allocated: 1.012601375579834  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9580078125 GB
    Memory Allocated: 0.03845930099487305  GigaBytes
Max Memory Allocated: 1.012601375579834  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9580078125 GB
    Memory Allocated: 0.039392948150634766  GigaBytes
Max Memory Allocated: 1.012601375579834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9580078125 GB
    Memory Allocated: 0.039392948150634766  GigaBytes
Max Memory Allocated: 1.012601375579834  GigaBytes

input nodes number: 74698
output nodes number: 11368
edges number: 125304
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0205078125 GB
    Memory Allocated: 0.9648947715759277  GigaBytes
Max Memory Allocated: 1.03436279296875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0205078125 GB
    Memory Allocated: 0.9648952484130859  GigaBytes
Max Memory Allocated: 1.03436279296875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0205078125 GB
    Memory Allocated: 0.04101085662841797  GigaBytes
Max Memory Allocated: 1.03436279296875  GigaBytes

pseudo mini batch 2 input nodes size: 75633
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0205078125 GB
    Memory Allocated: 0.03845930099487305  GigaBytes
Max Memory Allocated: 1.03436279296875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0205078125 GB
    Memory Allocated: 0.03845930099487305  GigaBytes
Max Memory Allocated: 1.03436279296875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0205078125 GB
    Memory Allocated: 0.07452392578125  GigaBytes
Max Memory Allocated: 1.03436279296875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0205078125 GB
    Memory Allocated: 0.07460880279541016  GigaBytes
Max Memory Allocated: 1.03436279296875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0205078125 GB
    Memory Allocated: 0.03890514373779297  GigaBytes
Max Memory Allocated: 1.03436279296875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0205078125 GB
    Memory Allocated: 0.03985881805419922  GigaBytes
Max Memory Allocated: 1.03436279296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0205078125 GB
    Memory Allocated: 0.03985881805419922  GigaBytes
Max Memory Allocated: 1.03436279296875  GigaBytes

input nodes number: 75633
output nodes number: 11368
edges number: 127942
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.9818978309631348  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.981898307800293  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.0415034294128418  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

pseudo mini batch 3 input nodes size: 75583
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03890514373779297  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03890514373779297  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.07494592666625977  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.07503080368041992  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03888130187988281  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.039826393127441406  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.039826393127441406  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

input nodes number: 75583
output nodes number: 11368
edges number: 126789
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.9748516082763672  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.9748520851135254  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.041461944580078125  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

pseudo mini batch 4 input nodes size: 75372
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03888130187988281  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03888130187988281  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.07482147216796875  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.0749063491821289  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03878068923950195  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.039736270904541016  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.039736270904541016  GigaBytes
Max Memory Allocated: 1.0518269538879395  GigaBytes

input nodes number: 75372
output nodes number: 11368
edges number: 128187
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.9833779335021973  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.9833784103393555  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.041380882263183594  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

pseudo mini batch 5 input nodes size: 75430
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03878068923950195  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03878068923950195  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.07474851608276367  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.07483339309692383  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.038808345794677734  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.0397486686706543  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.0397486686706543  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

input nodes number: 75430
output nodes number: 11368
edges number: 126112
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.971125602722168  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.9711260795593262  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.04137849807739258  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

pseudo mini batch 6 input nodes size: 74570
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.038808345794677734  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.038808345794677734  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.07436609268188477  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.07445096969604492  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03839826583862305  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03933095932006836  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03933095932006836  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

input nodes number: 74570
output nodes number: 11368
edges number: 125141
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.9612350463867188  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.961235523223877  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.04094696044921875  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

pseudo mini batch 7 input nodes size: 75041
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03839826583862305  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03839826583862305  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.07418060302734375  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.0742654800415039  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03862285614013672  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03956413269042969  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03956413269042969  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

input nodes number: 75041
output nodes number: 11365
edges number: 126328
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.9710893630981445  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.9710898399353027  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.04119157791137695  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.0422520637512207  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.0422520637512207  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020289480686187744 |0.050109416246414185 |0.5639821887016296 |0.00014266371726989746 |0.9641461074352264 |0.004495859146118164 |
----------------------------------------------------------pseudo_mini_loss sum 3.8378472328186035
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  600693
Number of first layer input nodes during this epoch:  600693
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.0422515869140625  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030400991439819336
number of batches is  8
batch size is  11368
random selection method spend 0.0077724456787109375
time for parepare:  0.02544689178466797
local_output_nid generation:  0.004553318023681641
local_in_edges_tensor generation:  0.009038448333740234
mini_batch_src_global generation:  0.005796194076538086
r_  generation:  0.05537819862365723
local_output_nid generation:  0.006195068359375
local_in_edges_tensor generation:  0.0043048858642578125
mini_batch_src_global generation:  0.0067958831787109375
r_  generation:  0.05905866622924805
local_output_nid generation:  0.006025552749633789
local_in_edges_tensor generation:  0.003398895263671875
mini_batch_src_global generation:  0.005029916763305664
r_  generation:  0.05925130844116211
local_output_nid generation:  0.006375789642333984
local_in_edges_tensor generation:  0.003399372100830078
mini_batch_src_global generation:  0.00528717041015625
r_  generation:  0.05841422080993652
local_output_nid generation:  0.006048440933227539
local_in_edges_tensor generation:  0.0031576156616210938
mini_batch_src_global generation:  0.005204200744628906
r_  generation:  0.05711007118225098
local_output_nid generation:  0.006058454513549805
local_in_edges_tensor generation:  0.0031070709228515625
mini_batch_src_global generation:  0.005432605743408203
r_  generation:  0.05762362480163574
local_output_nid generation:  0.005977630615234375
local_in_edges_tensor generation:  0.003365039825439453
mini_batch_src_global generation:  0.005433082580566406
r_  generation:  0.06011366844177246
local_output_nid generation:  0.005895137786865234
local_in_edges_tensor generation:  0.003172636032104492
mini_batch_src_global generation:  0.00545811653137207
r_  generation:  0.06060028076171875
----------------------check_connections_block total spend ----------------------------- 0.7050378322601318
generate_one_block  0.09115457534790039
generate_one_block  0.08847713470458984
generate_one_block  0.08516955375671387
generate_one_block  0.08594417572021484
generate_one_block  0.08383321762084961
generate_one_block  0.08343005180358887
generate_one_block  0.08583855628967285
generate_one_block  0.08548831939697266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.0422515869140625  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.674924612045288
pseudo mini batch 0 input nodes size: 74881
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03968191146850586  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03968191146850586  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.07538795471191406  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.07547283172607422  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03960561752319336  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.040544986724853516  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.040544986724853516  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

input nodes number: 74881
output nodes number: 11368
edges number: 126035
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.9703407287597656  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.970341682434082  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.042171478271484375  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

pseudo mini batch 1 input nodes size: 76089
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03960704803466797  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.03960704803466797  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.07588911056518555  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.0759739875793457  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.040183067321777344  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.041146278381347656  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1240234375 GB
    Memory Allocated: 0.041146278381347656  GigaBytes
Max Memory Allocated: 1.053112506866455  GigaBytes

input nodes number: 76089
output nodes number: 11368
edges number: 129220
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9917621612548828  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.991762638092041  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04280376434326172  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

pseudo mini batch 2 input nodes size: 75178
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.040183067321777344  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.040183067321777344  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07603073120117188  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07611560821533203  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.0397486686706543  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04069089889526367  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04069089889526367  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

input nodes number: 75178
output nodes number: 11368
edges number: 126449
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9716320037841797  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9716324806213379  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04232072830200195  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

pseudo mini batch 3 input nodes size: 75454
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.0397486686706543  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.0397486686706543  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07572793960571289  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07581281661987305  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03988027572631836  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04083585739135742  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04083585739135742  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

input nodes number: 75454
output nodes number: 11368
edges number: 128177
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9841103553771973  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9841108322143555  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.0424809455871582  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

pseudo mini batch 4 input nodes size: 74699
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03988027572631836  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03988027572631836  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.0754995346069336  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07558441162109375  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.039520263671875  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.040444374084472656  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.040444374084472656  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

input nodes number: 74699
output nodes number: 11368
edges number: 124028
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9556846618652344  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9556851387023926  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.0420527458190918  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

pseudo mini batch 5 input nodes size: 74823
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.039520263671875  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.039520263671875  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07519865036010742  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07528352737426758  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03957939147949219  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04050445556640625  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04050445556640625  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

input nodes number: 74823
output nodes number: 11368
edges number: 124046
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9567356109619141  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9567360877990723  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.0421147346496582  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

pseudo mini batch 6 input nodes size: 74945
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03957939147949219  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03957939147949219  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07531595230102539  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07540082931518555  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03963756561279297  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.040569305419921875  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.040569305419921875  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

input nodes number: 74945
output nodes number: 11368
edges number: 125008
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9624910354614258  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.962491512298584  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04218721389770508  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

pseudo mini batch 7 input nodes size: 75252
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03963756561279297  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03963756561279297  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07552051544189453  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07560539245605469  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03978395462036133  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04072237014770508  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04072237014770508  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

input nodes number: 75252
output nodes number: 11365
edges number: 125844
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9685416221618652  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9685420989990234  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.042348384857177734  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.042348384857177734  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.042348384857177734  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01967751979827881 |0.00157243013381958 |0.5125420093536377 |0.0001240074634552002 |0.9489540457725525 |0.003980159759521484 |
----------------------------------------------------------pseudo_mini_loss sum 3.2671117782592773
Total (block generation + training)time/epoch 13.635807037353516
Training time/epoch 11.960553884506226
Training time without block to device /epoch 11.947974443435669
Training time without total dataloading part /epoch 11.696940660476685
load block tensor time/epoch 0.15742015838623047
block to device time/epoch 0.01257944107055664
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  601321
Number of first layer input nodes during this epoch:  601321
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04234790802001953  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024590253829956055
number of batches is  8
batch size is  11368
random selection method spend 0.007687807083129883
time for parepare:  0.023902416229248047
local_output_nid generation:  0.004488706588745117
local_in_edges_tensor generation:  0.010784626007080078
mini_batch_src_global generation:  0.005831718444824219
r_  generation:  0.055555105209350586
local_output_nid generation:  0.006395101547241211
local_in_edges_tensor generation:  0.004242658615112305
mini_batch_src_global generation:  0.006719350814819336
r_  generation:  0.05896878242492676
local_output_nid generation:  0.0060863494873046875
local_in_edges_tensor generation:  0.004296541213989258
mini_batch_src_global generation:  0.005060434341430664
r_  generation:  0.05554842948913574
local_output_nid generation:  0.00616002082824707
local_in_edges_tensor generation:  0.003454446792602539
mini_batch_src_global generation:  0.005111217498779297
r_  generation:  0.05637931823730469
local_output_nid generation:  0.005971670150756836
local_in_edges_tensor generation:  0.003508329391479492
mini_batch_src_global generation:  0.005278348922729492
r_  generation:  0.05952930450439453
local_output_nid generation:  0.006104469299316406
local_in_edges_tensor generation:  0.003473520278930664
mini_batch_src_global generation:  0.005480289459228516
r_  generation:  0.056101322174072266
local_output_nid generation:  0.006082057952880859
local_in_edges_tensor generation:  0.0032663345336914062
mini_batch_src_global generation:  0.00536036491394043
r_  generation:  0.05819392204284668
local_output_nid generation:  0.006051301956176758
local_in_edges_tensor generation:  0.0032634735107421875
mini_batch_src_global generation:  0.0053555965423583984
r_  generation:  0.057366371154785156
----------------------check_connections_block total spend ----------------------------- 0.6971750259399414
generate_one_block  0.09708023071289062
generate_one_block  0.08718705177307129
generate_one_block  0.0840609073638916
generate_one_block  0.08420848846435547
generate_one_block  0.08755111694335938
generate_one_block  0.08358120918273926
generate_one_block  0.08536410331726074
generate_one_block  0.08095765113830566
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04234790802001953  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.6689436435699463
pseudo mini batch 0 input nodes size: 75314
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03978252410888672  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03978252410888672  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07569503784179688  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07577991485595703  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03981208801269531  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04075908660888672  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04075908660888672  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

input nodes number: 75314
output nodes number: 11368
edges number: 127024
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9762482643127441  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.9762492179870605  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04239606857299805  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

pseudo mini batch 1 input nodes size: 76663
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03981351852416992  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.03981351852416992  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.0763692855834961  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.07645416259765625  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04045677185058594  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04141712188720703  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1318359375 GB
    Memory Allocated: 0.04141712188720703  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

input nodes number: 76663
output nodes number: 11368
edges number: 128817
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.9915108680725098  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.991511344909668  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.0430760383605957  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

pseudo mini batch 2 input nodes size: 74855
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04045677185058594  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04045677185058594  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.07615041732788086  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.07623529434204102  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.03959465026855469  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04052543640136719  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04052543640136719  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

input nodes number: 74855
output nodes number: 11368
edges number: 124869
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.9620485305786133  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.9620490074157715  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04214143753051758  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

pseudo mini batch 3 input nodes size: 75018
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.03959465026855469  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.03959465026855469  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.07536602020263672  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.07545089721679688  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.0396723747253418  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04061746597290039  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04061746597290039  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

input nodes number: 75018
output nodes number: 11368
edges number: 126845
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.9753918647766113  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.9753923416137695  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.042249202728271484  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

pseudo mini batch 4 input nodes size: 75726
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.0396723747253418  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.0396723747253418  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.07578134536743164  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.0758662223815918  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04000997543334961  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04097795486450195  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04097795486450195  GigaBytes
Max Memory Allocated: 1.0631694793701172  GigaBytes

input nodes number: 75726
output nodes number: 11368
edges number: 129859
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.9970602989196777  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.9970607757568359  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04263782501220703  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

pseudo mini batch 5 input nodes size: 74696
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04000997543334961  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04000997543334961  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.07562780380249023  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.07571268081665039  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.03951883316040039  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04043722152709961  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04043722152709961  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

input nodes number: 74696
output nodes number: 11368
edges number: 123253
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.9511356353759766  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.9511361122131348  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04203987121582031  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

pseudo mini batch 6 input nodes size: 74993
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.03951883316040039  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.03951883316040039  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.07527828216552734  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.0753631591796875  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.03966045379638672  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.040615081787109375  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.040615081787109375  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

input nodes number: 74993
output nodes number: 11368
edges number: 128089
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.9861245155334473  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.9861249923706055  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.04225587844848633  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

pseudo mini batch 7 input nodes size: 73469
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.03966045379638672  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.03966045379638672  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.07469320297241211  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.07477807998657227  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.038933753967285156  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.03982830047607422  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.03982830047607422  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

input nodes number: 73469
output nodes number: 11365
edges number: 120051
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.9272079467773438  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.927208423614502  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.0413970947265625  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.0413970947265625  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.1337890625 GB
    Memory Allocated: 0.0413970947265625  GigaBytes
Max Memory Allocated: 1.0684723854064941  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018528103828430176 |0.0015806853771209717 |0.5006653368473053 |0.00012251734733581543 |0.9500333964824677 |0.0034101009368896484 |
----------------------------------------------------------pseudo_mini_loss sum 3.172056198120117
Total (block generation + training)time/epoch 13.583112001419067
Training time/epoch 11.867263317108154
Training time without block to device /epoch 11.854617834091187
Training time without total dataloading part /epoch 11.60998010635376
load block tensor time/epoch 0.1482248306274414
block to device time/epoch 0.012645483016967773
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  600734
Number of first layer input nodes during this epoch:  600734
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])Using backend: pytorch

layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
