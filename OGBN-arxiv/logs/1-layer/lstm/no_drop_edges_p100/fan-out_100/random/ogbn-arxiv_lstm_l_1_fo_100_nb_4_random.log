main start at this time 1651811073.7100828
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03638625144958496
number of batches is  4
batch size is  22736
random selection method spend 0.007950067520141602
time for parepare:  0.021608352661132812
local_output_nid generation:  0.007248878479003906
local_in_edges_tensor generation:  0.014632225036621094
mini_batch_src_global generation:  0.009959220886230469
r_  generation:  0.10727882385253906
local_output_nid generation:  0.010367870330810547
local_in_edges_tensor generation:  0.008645296096801758
mini_batch_src_global generation:  0.011991500854492188
r_  generation:  0.11298823356628418
local_output_nid generation:  0.011056184768676758
local_in_edges_tensor generation:  0.006596565246582031
mini_batch_src_global generation:  0.010154008865356445
r_  generation:  0.11592459678649902
local_output_nid generation:  0.011084556579589844
local_in_edges_tensor generation:  0.0067272186279296875
mini_batch_src_global generation:  0.010430097579956055
r_  generation:  0.11534476280212402
----------------------check_connections_block total spend ----------------------------- 0.6861176490783691
generate_one_block  0.13650274276733398
generate_one_block  0.14023828506469727
generate_one_block  0.13892912864685059
generate_one_block  0.1381990909576416
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 108356
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8740234375 GB
    Memory Allocated: 0.05219841003417969  GigaBytes
Max Memory Allocated: 0.05219841003417969  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8740234375 GB
    Memory Allocated: 0.0523681640625  GigaBytes
Max Memory Allocated: 0.0523681640625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8740234375 GB
    Memory Allocated: 0.0523681640625  GigaBytes
Max Memory Allocated: 0.0523681640625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.9248046875 GB
    Memory Allocated: 0.054218292236328125  GigaBytes
Max Memory Allocated: 0.054218292236328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.9248046875 GB
    Memory Allocated: 0.054218292236328125  GigaBytes
Max Memory Allocated: 0.054218292236328125  GigaBytes

input nodes number: 108356
output nodes number: 22736
edges number: 248308
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0263671875 GB
    Memory Allocated: 1.8950133323669434  GigaBytes
Max Memory Allocated: 2.0301156044006348  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0263671875 GB
    Memory Allocated: 1.8950142860412598  GigaBytes
Max Memory Allocated: 2.0301156044006348  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0263671875 GB
    Memory Allocated: 0.0610499382019043  GigaBytes
Max Memory Allocated: 2.0301156044006348  GigaBytes

pseudo mini batch 1 input nodes size: 109591
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0263671875 GB
    Memory Allocated: 0.056287288665771484  GigaBytes
Max Memory Allocated: 2.0301156044006348  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0263671875 GB
    Memory Allocated: 0.056287288665771484  GigaBytes
Max Memory Allocated: 2.0301156044006348  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0263671875 GB
    Memory Allocated: 0.10854434967041016  GigaBytes
Max Memory Allocated: 2.0301156044006348  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0263671875 GB
    Memory Allocated: 0.10871410369873047  GigaBytes
Max Memory Allocated: 2.0301156044006348  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0263671875 GB
    Memory Allocated: 0.056876182556152344  GigaBytes
Max Memory Allocated: 2.0301156044006348  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0263671875 GB
    Memory Allocated: 0.05877494812011719  GigaBytes
Max Memory Allocated: 2.0301156044006348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0263671875 GB
    Memory Allocated: 0.05877494812011719  GigaBytes
Max Memory Allocated: 2.0301156044006348  GigaBytes

input nodes number: 109591
output nodes number: 22736
edges number: 254731
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9432902336120605  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9432907104492188  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06174516677856445  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

pseudo mini batch 2 input nodes size: 109021
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.056876182556152344  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.056876182556152344  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.10961055755615234  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.10978031158447266  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05735349655151367  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05924844741821289  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05924844741821289  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

input nodes number: 109021
output nodes number: 22736
edges number: 254299
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.936746597290039  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9367470741271973  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.0622105598449707  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

pseudo mini batch 3 input nodes size: 108226
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05735349655151367  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05735349655151367  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.10895967483520508  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.10912942886352539  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05622529983520508  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05809926986694336  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05809926986694336  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

input nodes number: 108226
output nodes number: 22733
edges number: 251469
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.917628288269043  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9176287651062012  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.0610346794128418  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06209516525268555  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06209516525268555  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026774227619171143 |0.10209178924560547 |0.6537966132164001 |0.00016182661056518555 |0.9641002416610718 |0.00505375862121582 |
----------------------------------------------------------pseudo_mini_loss sum 3.8378472328186035
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  435194
Number of first layer input nodes during this epoch:  435194
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.062094688415527344  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029721498489379883
number of batches is  4
batch size is  22736
random selection method spend 0.007791996002197266
time for parepare:  0.02306222915649414
local_output_nid generation:  0.0072672367095947266
local_in_edges_tensor generation:  0.016731739044189453
mini_batch_src_global generation:  0.010134458541870117
r_  generation:  0.108245849609375
local_output_nid generation:  0.010899066925048828
local_in_edges_tensor generation:  0.006139278411865234
mini_batch_src_global generation:  0.011459589004516602
r_  generation:  0.11300516128540039
local_output_nid generation:  0.011228084564208984
local_in_edges_tensor generation:  0.006457090377807617
mini_batch_src_global generation:  0.008887052536010742
r_  generation:  0.11151289939880371
local_output_nid generation:  0.011195898056030273
local_in_edges_tensor generation:  0.006452083587646484
mini_batch_src_global generation:  0.009654521942138672
r_  generation:  0.11668038368225098
----------------------check_connections_block total spend ----------------------------- 0.6791207790374756
generate_one_block  0.1584329605102539
generate_one_block  0.15514707565307617
generate_one_block  0.15039992332458496
generate_one_block  0.1567668914794922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.062094688415527344  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.46868896484375
pseudo mini batch 0 input nodes size: 109301
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05728483200073242  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05728483200073242  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.11001920700073242  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.11018896102905273  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.058413028717041016  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.060315608978271484  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.060315608978271484  GigaBytes
Max Memory Allocated: 2.0831809043884277  GigaBytes

input nodes number: 109301
output nodes number: 22736
edges number: 255255
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9464564323425293  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9464573860168457  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06328821182250977  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

pseudo mini batch 1 input nodes size: 109087
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.11043071746826172  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.11060047149658203  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05769634246826172  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.059594154357910156  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.059594154357910156  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

input nodes number: 109087
output nodes number: 22736
edges number: 254626
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9436650276184082  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9436655044555664  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06255960464477539  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

pseudo mini batch 2 input nodes size: 108506
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05769634246826172  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05769634246826172  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.10943603515625  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.10960578918457031  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.0574193000793457  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05926847457885742  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05926847457885742  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

input nodes number: 108506
output nodes number: 22736
edges number: 248074
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.8915324211120605  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.8915328979492188  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06218099594116211  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

pseudo mini batch 3 input nodes size: 108877
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.0574193000793457  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.0574193000793457  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.10933589935302734  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.10950565338134766  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05759620666503906  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05946540832519531  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05946540832519531  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

input nodes number: 108877
output nodes number: 22733
edges number: 250852
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9151597023010254  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9151601791381836  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06240081787109375  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06240081787109375  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06240081787109375  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02421504259109497 |0.0027543306350708008 |0.49996453523635864 |0.00013196468353271484 |0.9750360250473022 |0.003154754638671875 |
----------------------------------------------------------pseudo_mini_loss sum 3.2671117782592773
Total (block generation + training)time/epoch 7.528645992279053
Training time/epoch 6.059685230255127
Training time without block to device /epoch 6.048667907714844
Training time without total dataloading part /epoch 5.903684854507446
load block tensor time/epoch 0.09686017036437988
block to device time/epoch 0.011017322540283203
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  435771
Number of first layer input nodes during this epoch:  435771
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06240034103393555  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02568531036376953
number of batches is  4
batch size is  22736
random selection method spend 0.007053852081298828
time for parepare:  0.025344133377075195
local_output_nid generation:  0.0076253414154052734
local_in_edges_tensor generation:  0.01610589027404785
mini_batch_src_global generation:  0.010236978530883789
r_  generation:  0.12295293807983398
local_output_nid generation:  0.01227712631225586
local_in_edges_tensor generation:  0.00826883316040039
mini_batch_src_global generation:  0.011620759963989258
r_  generation:  0.124786376953125
local_output_nid generation:  0.012884855270385742
local_in_edges_tensor generation:  0.007608652114868164
mini_batch_src_global generation:  0.009841442108154297
r_  generation:  0.13613295555114746
local_output_nid generation:  0.013743877410888672
local_in_edges_tensor generation:  0.008252859115600586
mini_batch_src_global generation:  0.010151386260986328
r_  generation:  0.12303733825683594
----------------------check_connections_block total spend ----------------------------- 0.7582907676696777
generate_one_block  0.1832275390625
generate_one_block  0.16001534461975098
generate_one_block  0.1605842113494873
generate_one_block  0.15638446807861328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06240034103393555  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.5248149633407593
pseudo mini batch 0 input nodes size: 109860
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.057595252990722656  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.057595252990722656  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.11032962799072266  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.11049938201904297  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.058413028717041016  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06031942367553711  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06031942367553711  GigaBytes
Max Memory Allocated: 2.087514877319336  GigaBytes

input nodes number: 109860
output nodes number: 22736
edges number: 255841
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9485349655151367  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9485359191894531  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06330013275146484  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

pseudo mini batch 1 input nodes size: 108863
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.11032390594482422  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.11049365997314453  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05758953094482422  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05946540832519531  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05946540832519531  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

input nodes number: 108863
output nodes number: 22736
edges number: 251714
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9177823066711426  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9177827835083008  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06240701675415039  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

pseudo mini batch 2 input nodes size: 109026
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05758953094482422  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05758953094482422  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.11032390594482422  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.11049365997314453  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.060300350189208984  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.060300350189208984  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

input nodes number: 109026
output nodes number: 22736
edges number: 253112
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9307684898376465  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.9307689666748047  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06325387954711914  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

pseudo mini batch 3 input nodes size: 107943
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes
Using backend: pytorch

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.10988521575927734  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.11005496978759766  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.057150840759277344  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05900001525878906  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.05900001525878906  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

input nodes number: 107943
output nodes number: 22733
edges number: 248140
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.8945488929748535  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 1.8945493698120117  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06190824508666992  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06190824508666992  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.1904296875 GB
    Memory Allocated: 0.06190824508666992  GigaBytes
Max Memory Allocated: 2.0885825157165527  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02365487813949585 |0.001440882682800293 |0.4976680874824524 |0.00012731552124023438 |0.9709979295730591 |0.004140138626098633 |
----------------------------------------------------------pseudo_mini_loss sum 3.172056198120117
Total (block generation + training)time/epoch 7.565823435783386
Training time/epoch 6.02173376083374
Training time without block to device /epoch 6.015970230102539
Training time without total dataloading part /epoch 5.8793134689331055
load block tensor time/epoch 0.0946195125579834
block to device time/epoch 0.005763530731201172
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  435692
Number of first layer input nodes during this epoch:  435692
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
