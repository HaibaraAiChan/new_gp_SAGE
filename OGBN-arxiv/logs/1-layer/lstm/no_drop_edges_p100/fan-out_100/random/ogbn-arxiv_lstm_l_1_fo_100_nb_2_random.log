main start at this time 1651811045.649257
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04493832588195801
number of batches is  2
batch size is  45471
random selection method spend 0.007042884826660156
time for parepare:  0.02264237403869629
local_output_nid generation:  0.01486063003540039
local_in_edges_tensor generation:  0.023874282836914062
mini_batch_src_global generation:  0.01667618751525879
r_  generation:  0.2326035499572754
local_output_nid generation:  0.020043134689331055
local_in_edges_tensor generation:  0.017594099044799805
mini_batch_src_global generation:  0.022144794464111328
r_  generation:  0.2272202968597412
----------------------check_connections_block total spend ----------------------------- 0.6872134208679199
generate_one_block  0.26714277267456055
generate_one_block  0.27066969871520996
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 140323
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.06744146347045898  GigaBytes
Max Memory Allocated: 0.06744146347045898  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.0677804946899414  GigaBytes
Max Memory Allocated: 0.0677804946899414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.0677804946899414  GigaBytes
Max Memory Allocated: 0.0677804946899414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.9580078125 GB
    Memory Allocated: 0.07152843475341797  GigaBytes
Max Memory Allocated: 0.07152843475341797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.9580078125 GB
    Memory Allocated: 0.07152843475341797  GigaBytes
Max Memory Allocated: 0.07152843475341797  GigaBytes

input nodes number: 140323
output nodes number: 45471
edges number: 502967
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0634765625 GB
    Memory Allocated: 3.8247342109680176  GigaBytes
Max Memory Allocated: 4.094762325286865  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0634765625 GB
    Memory Allocated: 3.824735164642334  GigaBytes
Max Memory Allocated: 4.094762325286865  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0634765625 GB
    Memory Allocated: 0.08498430252075195  GigaBytes
Max Memory Allocated: 4.094762325286865  GigaBytes

pseudo mini batch 1 input nodes size: 139893
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0634765625 GB
    Memory Allocated: 0.0750875473022461  GigaBytes
Max Memory Allocated: 4.094762325286865  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0634765625 GB
    Memory Allocated: 0.0750875473022461  GigaBytes
Max Memory Allocated: 4.094762325286865  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0634765625 GB
    Memory Allocated: 0.14179372787475586  GigaBytes
Max Memory Allocated: 4.094762325286865  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0634765625 GB
    Memory Allocated: 0.14213275909423828  GigaBytes
Max Memory Allocated: 4.094762325286865  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0634765625 GB
    Memory Allocated: 0.07488250732421875  GigaBytes
Max Memory Allocated: 4.094762325286865  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0634765625 GB
    Memory Allocated: 0.07865142822265625  GigaBytes
Max Memory Allocated: 4.094762325286865  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0634765625 GB
    Memory Allocated: 0.07865142822265625  GigaBytes
Max Memory Allocated: 4.094762325286865  GigaBytes

input nodes number: 139893
output nodes number: 45470
edges number: 505840
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 3.8297739028930664  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 3.8297743797302246  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 0.08446741104125977  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 0.08552789688110352  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 0.08552789688110352  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07232177257537842 |0.2019563913345337 |1.0936555862426758 |0.00021028518676757812 |1.0016902685165405 |0.004641532897949219 |
----------------------------------------------------------pseudo_mini_loss sum 3.8378469944000244
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  280216
Number of first layer input nodes during this epoch:  280216
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 0.08552742004394531  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03630638122558594
number of batches is  2
batch size is  45471
random selection method spend 0.007235288619995117
time for parepare:  0.023645639419555664
local_output_nid generation:  0.015087604522705078
local_in_edges_tensor generation:  0.01952052116394043
mini_batch_src_global generation:  0.017166852951049805
r_  generation:  0.24790573120117188
local_output_nid generation:  0.023387432098388672
local_in_edges_tensor generation:  0.018201828002929688
mini_batch_src_global generation:  0.021784305572509766
r_  generation:  0.25313782691955566
----------------------check_connections_block total spend ----------------------------- 0.7354543209075928
generate_one_block  0.33396291732788086
generate_one_block  0.3072214126586914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 0.08552742004394531  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.5166957378387451
pseudo mini batch 0 input nodes size: 140408
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 0.0759420394897461  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 0.0759420394897461  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 0.14289379119873047  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 0.1432328224182129  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 0.0761876106262207  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 0.0799870491027832  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3056640625 GB
    Memory Allocated: 0.0799870491027832  GigaBytes
Max Memory Allocated: 4.108163833618164  GigaBytes

input nodes number: 140408
output nodes number: 45471
edges number: 509879
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 3.8797988891601562  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 3.8797998428344727  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.08578205108642578  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

pseudo mini batch 1 input nodes size: 140228
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.07618856430053711  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.07618856430053711  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.14305448532104492  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.14339351654052734  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.07610273361206055  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.07982015609741211  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.07982015609741211  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

input nodes number: 140228
output nodes number: 45470
edges number: 498928
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 3.7744345664978027  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 3.774435043334961  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.08571529388427734  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.08571529388427734  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.08571529388427734  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035768985748291016 |0.004752516746520996 |0.5456552505493164 |0.00014829635620117188 |1.3159035444259644 |0.0035736560821533203 |
----------------------------------------------------------pseudo_mini_loss sum 3.267110824584961
Total (block generation + training)time/epoch 5.3515849113464355
Training time/epoch 3.8343489170074463
Training time without block to device /epoch 3.8248438835144043
Training time without total dataloading part /epoch 3.726987838745117
load block tensor time/epoch 0.07153797149658203
block to device time/epoch 0.009505033493041992
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  280636
Number of first layer input nodes during this epoch:  280636
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.08571481704711914  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029839754104614258
number of batches is  2
batch size is  45471
random selection method spend 0.0071070194244384766
time for parepare:  0.025033235549926758
local_output_nid generation:  0.015376567840576172
local_in_edges_tensor generation:  0.03799867630004883
mini_batch_src_global generation:  0.018560409545898438
r_  generation:  0.22270441055297852
local_output_nid generation:  0.021763324737548828
local_in_edges_tensor generation:  0.0182034969329834
mini_batch_src_global generation:  0.021404743194580078
r_  generation:  0.23001718521118164
----------------------check_connections_block total spend ----------------------------- 0.7015013694763184
generate_one_block  0.3193187713623047
generate_one_block  0.2887859344482422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.08571481704711914  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.476474404335022
pseudo mini batch 0 input nodes size: 140610
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.07610177993774414  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.07610177993774414  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes
Using backend: pytorch

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.14314985275268555  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.14348888397216797  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.07628393173217773  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.08006620407104492  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5927734375 GB
    Memory Allocated: 0.08006620407104492  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

input nodes number: 140610
output nodes number: 45471
edges number: 507541
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 3.8394980430603027  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 3.839498996734619  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 0.08583307266235352  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

pseudo mini batch 1 input nodes size: 139894
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 0.07628488540649414  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 0.07628488540649414  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 0.1429915428161621  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 0.14333057403564453  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 0.0759434700012207  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 0.0804295539855957  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 0.0804295539855957  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

input nodes number: 139894
output nodes number: 45470
edges number: 501266
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 3.8099985122680664  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 3.8099989891052246  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 0.08582639694213867  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 0.08582639694213867  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.6025390625 GB
    Memory Allocated: 0.08582639694213867  GigaBytes
Max Memory Allocated: 4.159435272216797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03281521797180176 |0.0024368762969970703 |0.5311604738235474 |0.00017070770263671875 |1.3221375942230225 |0.0038595199584960938 |
----------------------------------------------------------pseudo_mini_loss sum 3.172056198120117
Total (block generation + training)time/epoch 5.296691298484802
Training time/epoch 3.805208921432495
Training time without block to device /epoch 3.800335168838501
Training time without total dataloading part /epoch 3.710797071456909
load block tensor time/epoch 0.06563043594360352
block to device time/epoch 0.004873752593994141
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  280504
Number of first layer input nodes during this epoch:  280504
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
