[04:12:21] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 42055170 edges into 16 parts and get 10998200 edge cuts
main start at this time 1651810308.7645848
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030483007431030273
global_2_local spend time (sec) 0.03992176055908203
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.005176544189453125
A = g.adjacency_matrix() spent  0.012106657028198242
auxiliary_graph
Graph(num_nodes=160291, num_edges=42146111,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09725713729858398
remove nodes length
69350
auxiliary_graph.remove_nodes spent  2.3635315895080566
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=42146111,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.802846908569336

the counter of shared neighbor distribution
Counter({1.0: 30971422, 2.0: 7127264, 3.0: 2263826, 4.0: 839656, 5.0: 364856, 6.0: 179646, 7.0: 99368, 8.0: 60356, 9.0: 38278, 10.0: 26308, 11.0: 17936, 12.0: 13416, 13.0: 9940, 14.0: 7776, 15.0: 6242, 16.0: 4962, 17.0: 3814, 18.0: 3156, 19.0: 2480, 20.0: 2192, 21.0: 1786, 22.0: 1616, 23.0: 1228, 24.0: 1024, 25.0: 900, 26.0: 778, 27.0: 674, 29.0: 558, 28.0: 512, 30.0: 448, 31.0: 384, 32.0: 318, 33.0: 316, 34.0: 236, 37.0: 202, 35.0: 184, 38.0: 154, 36.0: 150, 40.0: 126, 39.0: 104, 44.0: 90, 41.0: 72, 42.0: 68, 43.0: 62, 45.0: 52, 46.0: 32, 50.0: 30, 51.0: 26, 47.0: 22, 48.0: 22, 49.0: 12, 53.0: 12, 52.0: 12, 55.0: 10, 54.0: 10, 57.0: 8, 59.0: 8, 56.0: 6, 67.0: 4, 70.0: 4, 58.0: 4, 64.0: 4, 73.0: 2, 89.0: 2, 77.0: 2, 60.0: 2})
42055170
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 42055167, 42055168, 42055169])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 30971422, 2.0: 7127264, 3.0: 2263826, 4.0: 839656, 5.0: 364856, 6.0: 179646, 7.0: 99368, 8.0: 60356, 9.0: 38278, 10.0: 26308, 11.0: 17936, 12.0: 13416, 13.0: 9940, 14.0: 7776, 15.0: 6242, 16.0: 4962, 17.0: 3814, 18.0: 3156, 19.0: 2480, 20.0: 2192, 21.0: 1786, 22.0: 1616, 23.0: 1228, 24.0: 1024, 25.0: 900, 26.0: 778, 27.0: 674, 29.0: 558, 28.0: 512, 30.0: 448, 31.0: 384, 32.0: 318, 33.0: 316, 34.0: 236, 37.0: 202, 35.0: 184, 38.0: 154, 36.0: 150, 40.0: 126, 39.0: 104, 44.0: 90, 41.0: 72, 42.0: 68, 43.0: 62, 45.0: 52, 46.0: 32, 50.0: 30, 51.0: 26, 47.0: 22, 48.0: 22, 49.0: 12, 53.0: 12, 52.0: 12, 55.0: 10, 54.0: 10, 57.0: 8, 59.0: 8, 56.0: 6, 67.0: 4, 70.0: 4, 58.0: 4, 64.0: 4, 73.0: 2, 89.0: 2, 77.0: 2, 60.0: 2})
Convert a graph into a bidirected graph: 2.786 seconds
Metis partitioning: 8.375 seconds
Split the graph: 2.123 seconds
Construct subgraphs: 0.091 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  13.39409875869751
5658
5517
5517
5517
5854
5517
5549
5517
5669
5801
5688
5731
5854
5854
5844
5854
total k batches seeds list generation spend  30.819772720336914
after graph partition
graph partition algorithm spend time 30.955204010009766
5658
5517
5517
5517
5854
5517
5549
5517
5669
5801
5688
5731
5854
5854
5844
5854
partition_len_list
[14724, 16840, 29657, 24045, 37765, 33782, 38435, 29941, 12116, 10726, 12304, 13553, 12865, 14919, 10900, 13455]
shared_neighbor_graph_partition_s0 selection method  spend 31.04963493347168
time for parepare:  0.019351720809936523
local_output_nid generation:  0.0008044242858886719
local_in_edges_tensor generation:  0.001483917236328125
mini_batch_src_global generation:  0.0031812191009521484
r_  generation:  0.017300844192504883
local_output_nid generation:  0.0011446475982666016
local_in_edges_tensor generation:  0.0011601448059082031
mini_batch_src_global generation:  0.0028798580169677734
r_  generation:  0.01652050018310547
local_output_nid generation:  0.0010027885437011719
local_in_edges_tensor generation:  0.0013682842254638672
mini_batch_src_global generation:  0.004495859146118164
r_  generation:  0.03521299362182617
local_output_nid generation:  0.0012192726135253906
local_in_edges_tensor generation:  0.0012140274047851562
mini_batch_src_global generation:  0.003307819366455078
r_  generation:  0.019923686981201172
local_output_nid generation:  0.0012259483337402344
local_in_edges_tensor generation:  0.003388643264770508
mini_batch_src_global generation:  0.006679058074951172
r_  generation:  0.05313992500305176
local_output_nid generation:  0.0014967918395996094
local_in_edges_tensor generation:  0.0020914077758789062
mini_batch_src_global generation:  0.0054857730865478516
r_  generation:  0.037667274475097656
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.001924276351928711
mini_batch_src_global generation:  0.004461526870727539
r_  generation:  0.03638458251953125
local_output_nid generation:  0.0015413761138916016
local_in_edges_tensor generation:  0.0012192726135253906
mini_batch_src_global generation:  0.0023429393768310547
r_  generation:  0.021578073501586914
local_output_nid generation:  0.001438140869140625
local_in_edges_tensor generation:  0.001199960708618164
mini_batch_src_global generation:  0.0018148422241210938
r_  generation:  0.020402193069458008
local_output_nid generation:  0.001306295394897461
local_in_edges_tensor generation:  0.0013117790222167969
mini_batch_src_global generation:  0.003062725067138672
r_  generation:  0.02313828468322754
local_output_nid generation:  0.001237630844116211
local_in_edges_tensor generation:  0.0011968612670898438
mini_batch_src_global generation:  0.0032470226287841797
r_  generation:  0.02641916275024414
local_output_nid generation:  0.0026557445526123047
local_in_edges_tensor generation:  0.0012202262878417969
mini_batch_src_global generation:  0.003464937210083008
r_  generation:  0.02108001708984375
local_output_nid generation:  0.0011470317840576172
local_in_edges_tensor generation:  0.001161336898803711
mini_batch_src_global generation:  0.0017838478088378906
r_  generation:  0.01903843879699707
local_output_nid generation:  0.0010707378387451172
local_in_edges_tensor generation:  0.001256704330444336
mini_batch_src_global generation:  0.002070188522338867
r_  generation:  0.023409128189086914
local_output_nid generation:  0.0010678768157958984
local_in_edges_tensor generation:  0.001188516616821289
mini_batch_src_global generation:  0.0057370662689208984
r_  generation:  0.016980648040771484
local_output_nid generation:  0.0011813640594482422
local_in_edges_tensor generation:  0.0015151500701904297
mini_batch_src_global generation:  0.00529026985168457
r_  generation:  0.01958322525024414
----------------------check_connections_block total spend ----------------------------- 0.6295971870422363
generate_one_block  0.030836105346679688
generate_one_block  0.02294015884399414
generate_one_block  0.049134016036987305
generate_one_block  0.02649378776550293
generate_one_block  0.08266973495483398
generate_one_block  0.05162310600280762
[04:12:27] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5549 nodes and 3458124 edges into 2 parts and get 626104 edge cuts
[04:12:31] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5854 nodes and 6898452 edges into 2 parts and get 1497995 edge cuts
generate_one_block  0.05339980125427246
generate_one_block  0.029732465744018555
generate_one_block  0.02414250373840332
generate_one_block  0.0282900333404541
generate_one_block  0.02993178367614746
generate_one_block  0.027449369430541992
generate_one_block  0.023899555206298828
generate_one_block  0.058527469635009766
generate_one_block  0.026677608489990234
generate_one_block  0.0254361629486084
global_2_local spend time (sec) 0.008227825164794922
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0012934207916259766
A = g.adjacency_matrix() spent  0.0013191699981689453
auxiliary_graph
Graph(num_nodes=38435, num_edges=3463673,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.02420806884765625
remove nodes length
32886
auxiliary_graph.remove_nodes spent  0.11478424072265625
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5549, num_edges=3463673,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.13700079917907715

the counter of shared neighbor distribution
Counter({1.0: 2864778, 2.0: 434866, 3.0: 96708, 4.0: 30850, 5.0: 13116, 6.0: 6518, 7.0: 3556, 8.0: 2282, 9.0: 1442, 10.0: 932, 11.0: 620, 12.0: 590, 13.0: 364, 14.0: 294, 15.0: 192, 16.0: 192, 18.0: 124, 17.0: 122, 19.0: 100, 20.0: 70, 21.0: 66, 22.0: 58, 23.0: 44, 24.0: 28, 26.0: 28, 25.0: 24, 30.0: 24, 27.0: 20, 32.0: 14, 33.0: 12, 35.0: 12, 31.0: 12, 29.0: 10, 28.0: 10, 34.0: 6, 40.0: 6, 37.0: 4, 44.0: 4, 50.0: 4, 38.0: 4, 41.0: 4, 49.0: 2, 39.0: 2, 51.0: 2, 36.0: 2, 46.0: 2, 48.0: 2, 57.0: 2})
3458124
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 3458121, 3458122, 3458123])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 2864778, 2.0: 434866, 3.0: 96708, 4.0: 30850, 5.0: 13116, 6.0: 6518, 7.0: 3556, 8.0: 2282, 9.0: 1442, 10.0: 932, 11.0: 620, 12.0: 590, 13.0: 364, 14.0: 294, 15.0: 192, 16.0: 192, 18.0: 124, 17.0: 122, 19.0: 100, 20.0: 70, 21.0: 66, 22.0: 58, 23.0: 44, 24.0: 28, 26.0: 28, 25.0: 24, 30.0: 24, 27.0: 20, 32.0: 14, 33.0: 12, 35.0: 12, 31.0: 12, 29.0: 10, 28.0: 10, 34.0: 6, 40.0: 6, 37.0: 4, 44.0: 4, 50.0: 4, 38.0: 4, 41.0: 4, 49.0: 2, 39.0: 2, 51.0: 2, 36.0: 2, 46.0: 2, 48.0: 2, 57.0: 2})
Convert a graph into a bidirected graph: 0.134 seconds
Metis partitioning: 0.278 seconds
Split the graph: 0.299 seconds
Construct subgraphs: 0.044 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.7592120170593262
2808
2741
total k batches seeds list generation spend  2.194152593612671
after graph partition
graph partition algorithm spend time 2.2390687465667725
2808
2741
time for parepare:  0.032683372497558594
local_output_nid generation:  0.0005905628204345703
local_in_edges_tensor generation:  0.0014202594757080078
mini_batch_src_global generation:  0.004620790481567383
r_  generation:  0.023799657821655273
local_output_nid generation:  0.0005114078521728516
local_in_edges_tensor generation:  0.0008690357208251953
mini_batch_src_global generation:  0.0023059844970703125
r_  generation:  0.01441335678100586
----------------------check_connections_block total spend ----------------------------- 0.0949862003326416
generate_one_block  0.035161733627319336
generate_one_block  0.021578550338745117
global_2_local spend time (sec) 0.008212566375732422
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0011212825775146484
A = g.adjacency_matrix() spent  0.0014009475708007812
auxiliary_graph
Graph(num_nodes=37765, num_edges=6904306,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.023850440979003906
remove nodes length
31911
auxiliary_graph.remove_nodes spent  0.28197479248046875
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5854, num_edges=6904306,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.2981846332550049

the counter of shared neighbor distribution
Counter({1.0: 4390804, 2.0: 1551804, 3.0: 569470, 4.0: 210310, 5.0: 86704, 6.0: 38344, 7.0: 19232, 8.0: 10600, 9.0: 6068, 10.0: 3916, 11.0: 2492, 12.0: 1706, 13.0: 1282, 14.0: 948, 15.0: 782, 16.0: 628, 17.0: 472, 18.0: 430, 19.0: 312, 20.0: 290, 21.0: 248, 22.0: 246, 23.0: 174, 25.0: 128, 27.0: 124, 24.0: 118, 29.0: 106, 26.0: 100, 28.0: 86, 30.0: 72, 31.0: 64, 33.0: 52, 32.0: 52, 34.0: 40, 37.0: 34, 36.0: 30, 40.0: 30, 38.0: 26, 35.0: 20, 42.0: 18, 39.0: 16, 43.0: 12, 41.0: 12, 44.0: 12, 46.0: 8, 47.0: 8, 53.0: 4, 45.0: 4, 57.0: 4, 54.0: 2, 55.0: 2, 51.0: 2, 48.0: 2, 60.0: 2})
6898452
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 6898449, 6898450, 6898451])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 4390804, 2.0: 1551804, 3.0: 569470, 4.0: 210310, 5.0: 86704, 6.0: 38344, 7.0: 19232, 8.0: 10600, 9.0: 6068, 10.0: 3916, 11.0: 2492, 12.0: 1706, 13.0: 1282, 14.0: 948, 15.0: 782, 16.0: 628, 17.0: 472, 18.0: 430, 19.0: 312, 20.0: 290, 21.0: 248, 22.0: 246, 23.0: 174, 25.0: 128, 27.0: 124, 24.0: 118, 29.0: 106, 26.0: 100, 28.0: 86, 30.0: 72, 31.0: 64, 33.0: 52, 32.0: 52, 34.0: 40, 37.0: 34, 36.0: 30, 40.0: 30, 38.0: 26, 35.0: 20, 42.0: 18, 39.0: 16, 43.0: 12, 41.0: 12, 44.0: 12, 46.0: 8, 47.0: 8, 53.0: 4, 45.0: 4, 57.0: 4, 54.0: 2, 55.0: 2, 51.0: 2, 48.0: 2, 60.0: 2})
Convert a graph into a bidirected graph: 0.272 seconds
Metis partitioning: 0.499 seconds
Split the graph: 0.453 seconds
Construct subgraphs: 0.052 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  1.2799630165100098
2864
2990
total k batches seeds list generation spend  4.139299631118774
after graph partition
graph partition algorithm spend time 4.160511255264282
2864
2990
time for parepare:  0.020444393157958984
local_output_nid generation:  0.00041961669921875
local_in_edges_tensor generation:  0.0010952949523925781
mini_batch_src_global generation:  0.0031080245971679688
r_  generation:  0.025821924209594727
local_output_nid generation:  0.0005614757537841797
local_in_edges_tensor generation:  0.0011224746704101562
mini_batch_src_global generation:  0.003715991973876953
r_  generation:  0.035517215728759766
----------------------check_connections_block total spend ----------------------------- 0.1088871955871582
generate_one_block  0.04196047782897949
generate_one_block  0.03927779197692871
global_2_local spend time (sec) 0.00833892822265625
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0015902519226074219
A = g.adjacency_matrix() spent  0.001432657241821289
auxiliary_graph
Graph(num_nodes=37765, num_edges=6904306,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.045720577239990234
remove nodes length
31911
auxiliary_graph.remove_nodes spent  0.29589176177978516
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5854, num_edges=6904306,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.2977471351623535

the counter of shared neighbor distribution
Counter({1.0: 4390804, 2.0: 1551804, 3.0: 569470, 4.0: 210310, 5.0: 86704, 6.0: 38344, 7.0: 19232, 8.0: 10600, 9.0: 6068, 10.0: 3916, 11.0: 2492, 12.0: 1706, 13.0: 1282, 14.0: 948, 15.0: 782, 16.0: 628, 17.0: 472, 18.0: 430, 19.0: 312, 20.0: 290, 21.0: 248, 22.0: 246, 23.0: 174, 25.0: 128, 27.0: 124, 24.0: 118, 29.0: 106, 26.0: 100, 28.0: 86, 30.0: 72, 31.0: 64, 33.0: 52, 32.0: 52, 34.0: 40, 37.0: 34, 36.0: 30, 40.0: 30, 38.0: 26, 35.0: 20, 42.0: 18, 39.0: 16, 43.0: 12, 41.0: 12, 44.0: 12, 46.0: 8, 47.0: 8, 53.0: 4, 45.0: 4, 57.0: 4, 54.0: 2, 55.0: 2, 51.0: 2, 48.0: 2, 60.0: 2})[04:12:36] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5854 nodes and 6898452 edges into 2 parts and get 1517205 edge cuts
[04:12:40] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 5854 nodes and 6898452 edges into 2 parts and get 1468078 edge cuts

6898452
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 6898449, 6898450, 6898451])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 4390804, 2.0: 1551804, 3.0: 569470, 4.0: 210310, 5.0: 86704, 6.0: 38344, 7.0: 19232, 8.0: 10600, 9.0: 6068, 10.0: 3916, 11.0: 2492, 12.0: 1706, 13.0: 1282, 14.0: 948, 15.0: 782, 16.0: 628, 17.0: 472, 18.0: 430, 19.0: 312, 20.0: 290, 21.0: 248, 22.0: 246, 23.0: 174, 25.0: 128, 27.0: 124, 24.0: 118, 29.0: 106, 26.0: 100, 28.0: 86, 30.0: 72, 31.0: 64, 33.0: 52, 32.0: 52, 34.0: 40, 37.0: 34, 36.0: 30, 40.0: 30, 38.0: 26, 35.0: 20, 42.0: 18, 39.0: 16, 43.0: 12, 41.0: 12, 44.0: 12, 46.0: 8, 47.0: 8, 53.0: 4, 45.0: 4, 57.0: 4, 54.0: 2, 55.0: 2, 51.0: 2, 48.0: 2, 60.0: 2})
Convert a graph into a bidirected graph: 0.298 seconds
Metis partitioning: 0.496 seconds
Split the graph: 0.494 seconds
Construct subgraphs: 0.019 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  1.3109068870544434
2865
2989
total k batches seeds list generation spend  4.325538396835327
after graph partition
graph partition algorithm spend time 4.340213298797607
2865
2989
time for parepare:  0.022364139556884766
local_output_nid generation:  0.0005128383636474609
local_in_edges_tensor generation:  0.006391286849975586
mini_batch_src_global generation:  0.006560325622558594
r_  generation:  0.024567842483520508
local_output_nid generation:  0.0006976127624511719
local_in_edges_tensor generation:  0.002452373504638672
mini_batch_src_global generation:  0.0046176910400390625
r_  generation:  0.02893805503845215
----------------------check_connections_block total spend ----------------------------- 0.11307048797607422
generate_one_block  0.052962541580200195
generate_one_block  0.04436087608337402
global_2_local spend time (sec) 0.007496356964111328
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0016322135925292969
A = g.adjacency_matrix() spent  0.0017437934875488281
auxiliary_graph
Graph(num_nodes=37765, num_edges=6904306,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.02680492401123047
remove nodes length
31911
auxiliary_graph.remove_nodes spent  0.2949066162109375
after remove non output nodes the auxiliary_graph
Graph(num_nodes=5854, num_edges=6904306,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.30338382720947266

the counter of shared neighbor distribution
Counter({1.0: 4390804, 2.0: 1551804, 3.0: 569470, 4.0: 210310, 5.0: 86704, 6.0: 38344, 7.0: 19232, 8.0: 10600, 9.0: 6068, 10.0: 3916, 11.0: 2492, 12.0: 1706, 13.0: 1282, 14.0: 948, 15.0: 782, 16.0: 628, 17.0: 472, 18.0: 430, 19.0: 312, 20.0: 290, 21.0: 248, 22.0: 246, 23.0: 174, 25.0: 128, 27.0: 124, 24.0: 118, 29.0: 106, 26.0: 100, 28.0: 86, 30.0: 72, 31.0: 64, 33.0: 52, 32.0: 52, 34.0: 40, 37.0: 34, 36.0: 30, 40.0: 30, 38.0: 26, 35.0: 20, 42.0: 18, 39.0: 16, 43.0: 12, 41.0: 12, 44.0: 12, 46.0: 8, 47.0: 8, 53.0: 4, 45.0: 4, 57.0: 4, 54.0: 2, 55.0: 2, 51.0: 2, 48.0: 2, 60.0: 2})
6898452
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 6898449, 6898450, 6898451])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 4390804, 2.0: 1551804, 3.0: 569470, 4.0: 210310, 5.0: 86704, 6.0: 38344, 7.0: 19232, 8.0: 10600, 9.0: 6068, 10.0: 3916, 11.0: 2492, 12.0: 1706, 13.0: 1282, 14.0: 948, 15.0: 782, 16.0: 628, 17.0: 472, 18.0: 430, 19.0: 312, 20.0: 290, 21.0: 248, 22.0: 246, 23.0: 174, 25.0: 128, 27.0: 124, 24.0: 118, 29.0: 106, 26.0: 100, 28.0: 86, 30.0: 72, 31.0: 64, 33.0: 52, 32.0: 52, 34.0: 40, 37.0: 34, 36.0: 30, 40.0: 30, 38.0: 26, 35.0: 20, 42.0: 18, 39.0: 16, 43.0: 12, 41.0: 12, 44.0: 12, 46.0: 8, 47.0: 8, 53.0: 4, 45.0: 4, 57.0: 4, 54.0: 2, 55.0: 2, 51.0: 2, 48.0: 2, 60.0: 2})
Convert a graph into a bidirected graph: 0.272 seconds
Metis partitioning: 0.508 seconds
Split the graph: 0.380 seconds
Construct subgraphs: 0.029 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  1.192551851272583
2954
2900
total k batches seeds list generation spend  4.034462928771973
after graph partition
graph partition algorithm spend time 4.0469701290130615
2954
2900
time for parepare:  0.018695831298828125
local_output_nid generation:  0.0003833770751953125
local_in_edges_tensor generation:  0.0010223388671875
mini_batch_src_global generation:  0.0029230117797851562
r_  generation:  0.024377107620239258
local_output_nid generation:  0.0004813671112060547
local_in_edges_tensor generation:  0.0011153221130371094
mini_batch_src_global generation:  0.0037899017333984375
r_  generation:  0.027441740036010742
----------------------check_connections_block total spend ----------------------------- 0.09496259689331055
generate_one_block  0.035497188568115234
generate_one_block  0.040734291076660156
----------===============-------------===============-------------the number of batches ***** 20

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 14724
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.0075511932373046875  GigaBytes
Max Memory Allocated: 0.0075511932373046875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.007593631744384766  GigaBytes
Max Memory Allocated: 0.007593631744384766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8408203125 GB
    Memory Allocated: 0.007593631744384766  GigaBytes
Max Memory Allocated: 0.007593631744384766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.007889270782470703  GigaBytes
Max Memory Allocated: 0.007889270782470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8896484375 GB
    Memory Allocated: 0.007889270782470703  GigaBytes
Max Memory Allocated: 0.007889270782470703  GigaBytes

input nodes number: 14724
output nodes number: 5658
edges number: 39669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.3059110641479492  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2802734375 GB
    Memory Allocated: 0.3059120178222656  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.00973367691040039  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

pseudo mini batch 1 input nodes size: 16840
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.008968353271484375  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.008968353271484375  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.016998291015625  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.017039775848388672  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.009976387023925781  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.010258674621582031  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.010258674621582031  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

input nodes number: 16840
output nodes number: 5517
edges number: 37800
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.2930417060852051  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.2930421829223633  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.010708332061767578  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

pseudo mini batch 2 input nodes size: 29657
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.009955406188964844  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.009955406188964844  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.024096965789794922  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.024138450622558594  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.016067028045654297  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.016736507415771484  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2822265625 GB
    Memory Allocated: 0.016736507415771484  GigaBytes
Max Memory Allocated: 0.32922983169555664  GigaBytes

input nodes number: 29657
output nodes number: 5517
edges number: 89795
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.6715006828308105  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.6715011596679688  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01768970489501953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 3 input nodes size: 24045
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016067028045654297  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016067028045654297  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.027532577514648438  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.02757406234741211  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01339101791381836  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.013727664947509766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.013727664947509766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 24045
output nodes number: 5517
edges number: 45081
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3486747741699219  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3486752510070801  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.014306068420410156  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 4 input nodes size: 12116
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01339101791381836  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01339101791381836  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.019168376922607422  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0192108154296875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0077037811279296875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008048057556152344  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008048057556152344  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 12116
output nodes number: 5669
edges number: 46196
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.35149192810058594  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.35149240493774414  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00856924057006836  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 5 input nodes size: 10726
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007726192474365234  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007726192474365234  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012840747833251953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012884140014648438  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007064342498779297  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007499217987060547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007499217987060547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 10726
output nodes number: 5801
edges number: 58247
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.4376497268676758  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.437650203704834  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008099079132080078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 6 input nodes size: 12304
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007083892822265625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007083892822265625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012950897216796875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012993335723876953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00783538818359375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008288383483886719  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008288383483886719  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 12304
output nodes number: 5688
edges number: 60776
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.45598745346069336  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.45598793029785156  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008880615234375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 7 input nodes size: 13553
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00781869888305664  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00781869888305664  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.014281272888183594  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.014324188232421875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008414745330810547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008806705474853516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008806705474853516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 13553
output nodes number: 5731
edges number: 52559
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.39768028259277344  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.39768075942993164  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00937032699584961  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 8 input nodes size: 12865
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008420944213867188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008420944213867188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01455545425415039  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.014599323272705078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008093833923339844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008435249328613281  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008435249328613281  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 12865
output nodes number: 5854
edges number: 45792
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3495168685913086  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3495173454284668  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008957386016845703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 9 input nodes size: 14919
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008112430572509766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008112430572509766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015226364135742188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015270233154296875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009091854095458984  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009539127349853516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009539127349853516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 14919
output nodes number: 5854
edges number: 60018
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.4521808624267578  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.452181339263916  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01016378402709961  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 10 input nodes size: 10900
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009091854095458984  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009091854095458984  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015226364135742188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015270233154296875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008112430572509766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008396625518798828  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008396625518798828  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 10900
output nodes number: 5844
edges number: 38051
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.29390621185302734  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.29390668869018555  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008826732635498047  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 11 input nodes size: 13455
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008111000061035156  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008111000061035156  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.014526844024658203  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01457071304321289  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008392333984375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008748054504394531  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008748054504394531  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 13455
output nodes number: 5854
edges number: 47631
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3625144958496094  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3625149726867676  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009271621704101562  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 12 input nodes size: 27576
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00839376449584961  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00839376449584961  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015414714813232422  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0154571533203125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008997440338134766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009293079376220703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009293079376220703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 14724
output nodes number: 5658
edges number: 39669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3064422607421875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3064427375793457  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00973367691040039  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 13 input nodes size: 19865
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008968353271484375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008968353271484375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016998291015625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017039775848388672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009976387023925781  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010258674621582031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010258674621582031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 16840
output nodes number: 5517
edges number: 37800
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2930417060852051  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2930421829223633  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010708332061767578  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 14 input nodes size: 29064
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009955406188964844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009955406188964844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016976356506347656  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017018795013427734  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008947372436523438  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009243011474609375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009243011474609375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 14724
output nodes number: 5658
edges number: 39669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3064422607421875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3064427375793457  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00973367691040039  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 15 input nodes size: 25017
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008968353271484375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008968353271484375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016998291015625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017039775848388672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009976387023925781  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010258674621582031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010258674621582031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 16840
output nodes number: 5517
edges number: 37800
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2930417060852051  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2930421829223633  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010708332061767578  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 16 input nodes size: 26957
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009955406188964844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009955406188964844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016976356506347656  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017018795013427734  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008947372436523438  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009243011474609375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009243011474609375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 14724
output nodes number: 5658
edges number: 39669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3064422607421875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3064427375793457  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00973367691040039  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 17 input nodes size: 26859
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008968353271484375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008968353271484375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016998291015625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017039775848388672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009976387023925781  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010258674621582031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010258674621582031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 16840
output nodes number: 5517
edges number: 37800
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2930417060852051  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2930421829223633  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010708332061767578  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 18 input nodes size: 23674
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009955406188964844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009955406188964844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016976356506347656  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017018795013427734  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008947372436523438  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009243011474609375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009243011474609375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 14724
output nodes number: 5658
edges number: 39669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3064422607421875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3064427375793457  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00973367691040039  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 19 input nodes size: 29706
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008968353271484375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008968353271484375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016998291015625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017039775848388672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009976387023925781  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010258674621582031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010258674621582031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 16840
output nodes number: 5517
edges number: 37800
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2930417060852051  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2930421829223633  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010708332061767578  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011768817901611328  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes
[04:13:33] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 42014260 edges into 20 parts and get 13325790 edge cuts

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011768817901611328  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010470759868621827 |0.01988058090209961 |0.4208111524581909 |0.0001420140266418457 |0.7151665210723877 |0.004568576812744141 |
----------------------------------------------------------pseudo_mini_loss sum 18.100658416748047
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  312360
Number of first layer input nodes during this epoch:  394822
Number of first layer output nodes during this epoch:  113204
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011768341064453125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031476497650146484
global_2_local spend time (sec) 0.04681229591369629
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.005457639694213867
A = g.adjacency_matrix() spent  0.007921218872070312
auxiliary_graph
Graph(num_nodes=160262, num_edges=42105201,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.18817877769470215
remove nodes length
69321
auxiliary_graph.remove_nodes spent  2.479146718978882
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=42105201,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.8171226978302002

the counter of shared neighbor distribution
Counter({1.0: 30959486, 2.0: 7106610, 3.0: 2258498, 4.0: 836916, 5.0: 363892, 6.0: 179954, 7.0: 99716, 8.0: 60074, 9.0: 38370, 10.0: 26266, 11.0: 18318, 12.0: 13256, 13.0: 9846, 14.0: 7862, 15.0: 6328, 16.0: 4928, 17.0: 3896, 18.0: 3112, 19.0: 2484, 20.0: 2204, 21.0: 1792, 22.0: 1560, 23.0: 1248, 24.0: 1086, 25.0: 936, 26.0: 724, 27.0: 622, 29.0: 540, 28.0: 522, 30.0: 450, 31.0: 378, 32.0: 348, 33.0: 306, 34.0: 280, 35.0: 196, 36.0: 166, 38.0: 156, 37.0: 146, 40.0: 110, 39.0: 98, 42.0: 80, 43.0: 66, 44.0: 66, 41.0: 64, 45.0: 54, 46.0: 42, 47.0: 34, 49.0: 26, 51.0: 22, 48.0: 20, 50.0: 20, 53.0: 14, 52.0: 12, 55.0: 12, 59.0: 8, 56.0: 6, 54.0: 6, 58.0: 4, 64.0: 4, 69.0: 4, 68.0: 2, 67.0: 2, 62.0: 2, 60.0: 2, 76.0: 2, 70.0: 2, 57.0: 2, 91.0: 2})
42014260
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 42014257, 42014258, 42014259])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 30959486, 2.0: 7106610, 3.0: 2258498, 4.0: 836916, 5.0: 363892, 6.0: 179954, 7.0: 99716, 8.0: 60074, 9.0: 38370, 10.0: 26266, 11.0: 18318, 12.0: 13256, 13.0: 9846, 14.0: 7862, 15.0: 6328, 16.0: 4928, 17.0: 3896, 18.0: 3112, 19.0: 2484, 20.0: 2204, 21.0: 1792, 22.0: 1560, 23.0: 1248, 24.0: 1086, 25.0: 936, 26.0: 724, 27.0: 622, 29.0: 540, 28.0: 522, 30.0: 450, 31.0: 378, 32.0: 348, 33.0: 306, 34.0: 280, 35.0: 196, 36.0: 166, 38.0: 156, 37.0: 146, 40.0: 110, 39.0: 98, 42.0: 80, 43.0: 66, 44.0: 66, 41.0: 64, 45.0: 54, 46.0: 42, 47.0: 34, 49.0: 26, 51.0: 22, 48.0: 20, 50.0: 20, 53.0: 14, 52.0: 12, 55.0: 12, 59.0: 8, 56.0: 6, 54.0: 6, 58.0: 4, 64.0: 4, 69.0: 4, 68.0: 2, 67.0: 2, 62.0: 2, 60.0: 2, 76.0: 2, 70.0: 2, 57.0: 2, 91.0: 2})
Convert a graph into a bidirected graph: 2.825 seconds
Metis partitioning: 8.350 seconds
Split the graph: 1.604 seconds
Construct subgraphs: 0.145 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  12.94769024848938
4660
4614
4675
4430
4414
4617
4572
4615
4662
4607
4465
4547
4416
4683
4414
4584
4667
4415
4414
4470
total k batches seeds list generation spend  30.68696355819702
after graph partition
graph partition algorithm spend time 30.8405282497406
4660
4614
4675
4430
4414
4617
4572
4615
4662
4607
4465
4547
4416
4683
4414
4584
4667
4415
4414
4470
partition_len_list
[8986, 8498, 9683, 10978, 10304, 9471, 10432, 9265, 11476, 11509, 28443, 33977, 35793, 31281, 35321, 13810, 13625, 18183, 30564, 18677]
shared_neighbor_graph_partition_s0 selection method  spend 30.96070909500122
time for parepare:  0.022241592407226562
local_output_nid generation:  0.0009417533874511719
local_in_edges_tensor generation:  0.0014781951904296875
mini_batch_src_global generation:  0.0017406940460205078
r_  generation:  0.017935991287231445
local_output_nid generation:  0.0013985633850097656
local_in_edges_tensor generation:  0.0013260841369628906
mini_batch_src_global generation:  0.001714944839477539
r_  generation:  0.012664794921875
local_output_nid generation:  0.0014190673828125
local_in_edges_tensor generation:  0.0013852119445800781
mini_batch_src_global generation:  0.0016319751739501953
r_  generation:  0.01594090461730957
local_output_nid generation:  0.0013451576232910156
local_in_edges_tensor generation:  0.0012485980987548828
mini_batch_src_global generation:  0.0017011165618896484
r_  generation:  0.016696453094482422
local_output_nid generation:  0.001363992691040039
local_in_edges_tensor generation:  0.0011043548583984375
mini_batch_src_global generation:  0.0014052391052246094
r_  generation:  0.012323379516601562
local_output_nid generation:  0.00138092041015625
local_in_edges_tensor generation:  0.0011973381042480469
mini_batch_src_global generation:  0.0018763542175292969
r_  generation:  0.018616199493408203
local_output_nid generation:  0.002609729766845703
local_in_edges_tensor generation:  0.0011909008026123047
mini_batch_src_global generation:  0.0015556812286376953
r_  generation:  0.015622377395629883
local_output_nid generation:  0.00133514404296875
local_in_edges_tensor generation:  0.001276254653930664
mini_batch_src_global generation:  0.0020453929901123047
r_  generation:  0.018758296966552734
local_output_nid generation:  0.0013573169708251953
local_in_edges_tensor generation:  0.0013515949249267578
mini_batch_src_global generation:  0.0018115043640136719
r_  generation:  0.019764423370361328
local_output_nid generation:  0.0013782978057861328
local_in_edges_tensor generation:  0.0013802051544189453
mini_batch_src_global generation:  0.0021245479583740234
r_  generation:  0.021665096282958984
local_output_nid generation:  0.0014433860778808594
local_in_edges_tensor generation:  0.001420736312866211
mini_batch_src_global generation:  0.0020728111267089844
r_  generation:  0.023130178451538086
local_output_nid generation:  0.0015716552734375
local_in_edges_tensor generation:  0.0015459060668945312
mini_batch_src_global generation:  0.003918886184692383
r_  generation:  0.0362393856048584
local_output_nid generation:  0.001622915267944336
local_in_edges_tensor generation:  0.0014781951904296875
mini_batch_src_global generation:  0.003080606460571289
r_  generation:  0.031239748001098633
local_output_nid generation:  0.0017616748809814453
local_in_edges_tensor generation:  0.0015845298767089844
mini_batch_src_global generation:  0.004150867462158203
r_  generation:  0.040848493576049805
local_output_nid generation:  0.0016434192657470703
local_in_edges_tensor generation:  0.0013833045959472656
mini_batch_src_global generation:  0.0033006668090820312
r_  generation:  0.033133506774902344
local_output_nid generation:  0.0016961097717285156
local_in_edges_tensor generation:  0.0013191699981689453
mini_batch_src_global generation:  0.002151012420654297
r_  generation:  0.01804065704345703
local_output_nid generation:  0.0016636848449707031
local_in_edges_tensor generation:  0.0011997222900390625
mini_batch_src_global generation:  0.0015072822570800781
r_  generation:  0.01582813262939453
local_output_nid generation:  0.0015149116516113281
local_in_edges_tensor generation:  0.0011413097381591797
mini_batch_src_global generation:  0.0014972686767578125[04:13:37] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 4416 nodes and 771852 edges into 2 parts and get 106738 edge cuts
[04:13:40] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 4683 nodes and 3909852 edges into 2 parts and get 836540 edge cuts

r_  generation:  0.012760639190673828
local_output_nid generation:  0.0015385150909423828
local_in_edges_tensor generation:  0.0013921260833740234
mini_batch_src_global generation:  0.0021479129791259766
r_  generation:  0.025538206100463867
local_output_nid generation:  0.001409769058227539
local_in_edges_tensor generation:  0.0011296272277832031
mini_batch_src_global generation:  0.0019800662994384766
r_  generation:  0.01802372932434082
----------------------check_connections_block total spend ----------------------------- 0.6524734497070312
generate_one_block  0.02749180793762207
generate_one_block  0.018872737884521484
generate_one_block  0.020890474319458008
generate_one_block  0.023476600646972656
generate_one_block  0.018244028091430664
generate_one_block  0.022561311721801758
generate_one_block  0.021517038345336914
generate_one_block  0.02498459815979004
generate_one_block  0.02635669708251953
generate_one_block  0.028594970703125
generate_one_block  0.03612780570983887
generate_one_block  0.10108780860900879
generate_one_block  0.0502622127532959
generate_one_block  0.06236410140991211
generate_one_block  0.05813884735107422
generate_one_block  0.029251813888549805
generate_one_block  0.02536773681640625
generate_one_block  0.025471210479736328
generate_one_block  0.039984703063964844
generate_one_block  0.02681875228881836
global_2_local spend time (sec) 0.00885915756225586
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0010166168212890625
A = g.adjacency_matrix() spent  0.0014908313751220703
auxiliary_graph
Graph(num_nodes=35793, num_edges=776268,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.02403569221496582
remove nodes length
31377
auxiliary_graph.remove_nodes spent  0.03310847282409668
after remove non output nodes the auxiliary_graph
Graph(num_nodes=4416, num_edges=776268,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.02460503578186035

the counter of shared neighbor distribution
Counter({1.0: 521804, 2.0: 157302, 3.0: 54850, 4.0: 19894, 5.0: 8086, 6.0: 3798, 7.0: 2142, 8.0: 1236, 9.0: 800, 10.0: 506, 11.0: 340, 12.0: 230, 13.0: 156, 14.0: 124, 15.0: 112, 16.0: 98, 17.0: 64, 18.0: 56, 19.0: 42, 20.0: 32, 23.0: 32, 21.0: 20, 24.0: 16, 22.0: 16, 28.0: 12, 27.0: 12, 25.0: 10, 34.0: 10, 30.0: 6, 29.0: 6, 35.0: 6, 31.0: 6, 32.0: 4, 39.0: 4, 46.0: 2, 36.0: 2, 41.0: 2, 33.0: 2, 42.0: 2, 44.0: 2, 50.0: 2, 37.0: 2, 45.0: 2, 26.0: 2})
771852
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 771849, 771850, 771851])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 521804, 2.0: 157302, 3.0: 54850, 4.0: 19894, 5.0: 8086, 6.0: 3798, 7.0: 2142, 8.0: 1236, 9.0: 800, 10.0: 506, 11.0: 340, 12.0: 230, 13.0: 156, 14.0: 124, 15.0: 112, 16.0: 98, 17.0: 64, 18.0: 56, 19.0: 42, 20.0: 32, 23.0: 32, 21.0: 20, 24.0: 16, 22.0: 16, 28.0: 12, 27.0: 12, 25.0: 10, 34.0: 10, 30.0: 6, 29.0: 6, 35.0: 6, 31.0: 6, 32.0: 4, 39.0: 4, 46.0: 2, 36.0: 2, 41.0: 2, 33.0: 2, 42.0: 2, 44.0: 2, 50.0: 2, 37.0: 2, 45.0: 2, 26.0: 2})
Convert a graph into a bidirected graph: 0.023 seconds
Metis partitioning: 0.073 seconds
Split the graph: 0.106 seconds
Construct subgraphs: 0.039 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.24091887474060059
2208
2208
total k batches seeds list generation spend  0.6134276390075684
after graph partition
graph partition algorithm spend time 0.6217427253723145
2208
2208
time for parepare:  0.017407894134521484
local_output_nid generation:  0.0003814697265625
local_in_edges_tensor generation:  0.000782012939453125
mini_batch_src_global generation:  0.0012524127960205078
r_  generation:  0.008374691009521484
local_output_nid generation:  0.0004029273986816406
local_in_edges_tensor generation:  0.0008101463317871094
mini_batch_src_global generation:  0.002374410629272461
r_  generation:  0.01895594596862793
----------------------check_connections_block total spend ----------------------------- 0.06107521057128906
generate_one_block  0.017717361450195312
generate_one_block  0.030794620513916016
global_2_local spend time (sec) 0.0074503421783447266
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0009946823120117188
A = g.adjacency_matrix() spent  0.0011653900146484375
auxiliary_graph
Graph(num_nodes=31281, num_edges=3914535,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.020476102828979492
remove nodes length
26598
auxiliary_graph.remove_nodes spent  0.11548686027526855
after remove non output nodes the auxiliary_graph
Graph(num_nodes=4683, num_edges=3914535,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.13546466827392578

the counter of shared neighbor distribution
Counter({1.0: 2483744, 2.0: 862094, 3.0: 324380, 4.0: 126134, 5.0: 54686, 6.0: 24908, 7.0: 12788, 8.0: 6950, 9.0: 4062, 10.0: 2550, 11.0: 1738, 12.0: 1134, 13.0: 938, 14.0: 646, 15.0: 526, 16.0: 380, 17.0: 340, 21.0: 204, 18.0: 204, 19.0: 194, 22.0: 158, 20.0: 154, 24.0: 110, 23.0: 106, 26.0: 90, 25.0: 72, 27.0: 64, 34.0: 56, 30.0: 56, 29.0: 54, 28.0: 50, 33.0: 38, 31.0: 38, 32.0: 36, 36.0: 30, 38.0: 22, 40.0: 20, 37.0: 20, 35.0: 12, 39.0: 12, 43.0: 12, 45.0: 8, 46.0: 6, 44.0: 6, 42.0: 6, 41.0: 4, 53.0: 4, 49.0: 2, 50.0: 2, 48.0: 2, 59.0: 2})
3909852
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 3909849, 3909850, 3909851])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 2483744, 2.0: 862094, 3.0: 324380, 4.0: 126134, 5.0: 54686, 6.0: 24908, 7.0: 12788, 8.0: 6950, 9.0: 4062, 10.0: 2550, 11.0: 1738, 12.0: 1134, 13.0: 938, 14.0: 646, 15.0: 526, 16.0: 380, 17.0: 340, 21.0: 204, 18.0: 204, 19.0: 194, 22.0: 158, 20.0: 154, 24.0: 110, 23.0: 106, 26.0: 90, 25.0: 72, 27.0: 64, 34.0: 56, 30.0: 56, 29.0: 54, 28.0: 50, 33.0: 38, 31.0: 38, 32.0: 36, 36.0: 30, 38.0: 22, 40.0: 20, 37.0: 20, 35.0: 12, 39.0: 12, 43.0: 12, 45.0: 8, 46.0: 6, 44.0: 6, 42.0: 6, 41.0: 4, 53.0: 4, 49.0: 2, 50.0: 2, 48.0: 2, 59.0: 2})
Convert a graph into a bidirected graph: 0.151 seconds
Metis partitioning: 0.326 seconds
Split the graph: 0.342 seconds
Construct subgraphs: 0.023 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.8465745449066162
2380
2303
total k batches seeds list generation spend  2.366682291030884
after graph partition
graph partition algorithm spend time 2.4091365337371826
2380
2303
time for parepare:  0.03946399688720703
local_output_nid generation:  0.0005524158477783203
local_in_edges_tensor generation:  0.006021261215209961
mini_batch_src_global generation:  0.0036139488220214844
r_  generation:  0.030042648315429688
local_output_nid generation:  0.0005810260772705078
local_in_edges_tensor generation:  0.0016922950744628906
mini_batch_src_global generation:  0.002220630645751953
r_  generation:  0.016918182373046875
----------------------check_connections_block total spend ----------------------------- 0.11912798881530762
generate_one_block  0.04693460464477539
generate_one_block  0.02895808219909668
global_2_local spend time (sec) 0.008280038833618164
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0011734962463378906
A = g.adjacency_matrix() spent  0.0015361309051513672
auxiliary_graph
Graph(num_nodes=33977, num_edges=2740699,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.02271747589111328[04:13:42] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 4547 nodes and 2736152 edges into 2 parts and get 394515 edge cuts
[04:13:43] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 4547 nodes and 2736152 edges into 2 parts and get 394515 edge cuts

remove nodes length
29430
auxiliary_graph.remove_nodes spent  0.09711790084838867
after remove non output nodes the auxiliary_graph
Graph(num_nodes=4547, num_edges=2740699,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.09711050987243652

the counter of shared neighbor distribution
Counter({1.0: 2193838, 2.0: 381518, 3.0: 100016, 4.0: 32144, 5.0: 12366, 6.0: 5936, 7.0: 3212, 8.0: 1932, 9.0: 1298, 10.0: 818, 11.0: 664, 12.0: 442, 13.0: 380, 14.0: 328, 15.0: 258, 16.0: 184, 18.0: 136, 17.0: 132, 20.0: 86, 19.0: 84, 21.0: 56, 22.0: 52, 23.0: 48, 25.0: 30, 24.0: 30, 26.0: 28, 28.0: 26, 29.0: 24, 30.0: 20, 27.0: 10, 31.0: 8, 32.0: 8, 38.0: 6, 35.0: 6, 33.0: 6, 36.0: 4, 40.0: 4, 39.0: 4, 49.0: 2, 44.0: 2, 34.0: 2, 46.0: 2, 41.0: 2})
2736152
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 2736149, 2736150, 2736151])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 2193838, 2.0: 381518, 3.0: 100016, 4.0: 32144, 5.0: 12366, 6.0: 5936, 7.0: 3212, 8.0: 1932, 9.0: 1298, 10.0: 818, 11.0: 664, 12.0: 442, 13.0: 380, 14.0: 328, 15.0: 258, 16.0: 184, 18.0: 136, 17.0: 132, 20.0: 86, 19.0: 84, 21.0: 56, 22.0: 52, 23.0: 48, 25.0: 30, 24.0: 30, 26.0: 28, 28.0: 26, 29.0: 24, 30.0: 20, 27.0: 10, 31.0: 8, 32.0: 8, 38.0: 6, 35.0: 6, 33.0: 6, 36.0: 4, 40.0: 4, 39.0: 4, 49.0: 2, 44.0: 2, 34.0: 2, 46.0: 2, 41.0: 2})
Convert a graph into a bidirected graph: 0.092 seconds
Metis partitioning: 0.223 seconds
Split the graph: 0.254 seconds
Construct subgraphs: 0.041 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.6147022247314453
2274
2273
total k batches seeds list generation spend  1.7213523387908936
after graph partition
graph partition algorithm spend time 1.7555241584777832
2274
2273
time for parepare:  0.026848554611206055
local_output_nid generation:  0.0003752708435058594
local_in_edges_tensor generation:  0.0011065006256103516
mini_batch_src_global generation:  0.006192445755004883
r_  generation:  0.015828847885131836
local_output_nid generation:  0.00041484832763671875
local_in_edges_tensor generation:  0.0009386539459228516
mini_batch_src_global generation:  0.002080678939819336
r_  generation:  0.016579389572143555
----------------------check_connections_block total spend ----------------------------- 0.08203482627868652
generate_one_block  0.02823781967163086
generate_one_block  0.02760028839111328
global_2_local spend time (sec) 0.00772547721862793
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0009021759033203125
A = g.adjacency_matrix() spent  0.0009624958038330078
auxiliary_graph
Graph(num_nodes=33977, num_edges=2740699,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.02173638343811035
remove nodes length
29430
auxiliary_graph.remove_nodes spent  0.09568500518798828
after remove non output nodes the auxiliary_graph
Graph(num_nodes=4547, num_edges=2740699,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0986490249633789

the counter of shared neighbor distribution
Counter({1.0: 2193838, 2.0: 381518, 3.0: 100016, 4.0: 32144, 5.0: 12366, 6.0: 5936, 7.0: 3212, 8.0: 1932, 9.0: 1298, 10.0: 818, 11.0: 664, 12.0: 442, 13.0: 380, 14.0: 328, 15.0: 258, 16.0: 184, 18.0: 136, 17.0: 132, 20.0: 86, 19.0: 84, 21.0: 56, 22.0: 52, 23.0: 48, 25.0: 30, 24.0: 30, 26.0: 28, 28.0: 26, 29.0: 24, 30.0: 20, 27.0: 10, 31.0: 8, 32.0: 8, 38.0: 6, 35.0: 6, 33.0: 6, 36.0: 4, 40.0: 4, 39.0: 4, 49.0: 2, 44.0: 2, 34.0: 2, 46.0: 2, 41.0: 2})
2736152
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 2736149, 2736150, 2736151])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 2193838, 2.0: 381518, 3.0: 100016, 4.0: 32144, 5.0: 12366, 6.0: 5936, 7.0: 3212, 8.0: 1932, 9.0: 1298, 10.0: 818, 11.0: 664, 12.0: 442, 13.0: 380, 14.0: 328, 15.0: 258, 16.0: 184, 18.0: 136, 17.0: 132, 20.0: 86, 19.0: 84, 21.0: 56, 22.0: 52, 23.0: 48, 25.0: 30, 24.0: 30, 26.0: 28, 28.0: 26, 29.0: 24, 30.0: 20, 27.0: 10, 31.0: 8, 32.0: 8, 38.0: 6, 35.0: 6, 33.0: 6, 36.0: 4, 40.0: 4, 39.0: 4, 49.0: 2, 44.0: 2, 34.0: 2, 46.0: 2, 41.0: 2})
Convert a graph into a bidirected graph: 0.092 seconds
Metis partitioning: 0.224 seconds
Split the graph: 0.261 seconds
Construct subgraphs: 0.038 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.6210846900939941
2274
2273
total k batches seeds list generation spend  1.750486135482788
after graph partition
graph partition algorithm spend time 1.7678098678588867
2274
2273
time for parepare:  0.030651569366455078
local_output_nid generation:  0.0005004405975341797
local_in_edges_tensor generation:  0.005658388137817383
mini_batch_src_global generation:  0.0017294883728027344
r_  generation:  0.016687870025634766
local_output_nid generation:  0.0005450248718261719
local_in_edges_tensor generation:  0.0019888877868652344
mini_batch_src_global generation:  0.002499103546142578
r_  generation:  0.016926288604736328
----------------------check_connections_block total spend ----------------------------- 0.09685206413269043
generate_one_block  0.02985239028930664
generate_one_block  0.03168606758117676
----------===============-------------===============-------------the number of batches ***** 24

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011768341064453125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 39.90149712562561
pseudo mini batch 0 input nodes size: 8986
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011014938354492188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011014938354492188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01549530029296875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015530109405517578  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007458686828613281  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007706642150878906  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007706642150878906  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8986
output nodes number: 4660
edges number: 33223
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.25623559951782227  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.25623655319213867  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007947444915771484  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 1 input nodes size: 8498
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00733184814453125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00733184814453125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011384010314941406  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011418819427490234  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006903648376464844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007114410400390625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007114410400390625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8498
output nodes number: 4614
edges number: 28281
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.21968698501586914  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.21968746185302734  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007433891296386719  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 2 input nodes size: 9683
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006896495819091797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006896495819091797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011513710021972656  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011548995971679688  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007462024688720703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007731914520263672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007731914520263672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 9683
output nodes number: 4675
edges number: 36155
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.277529239654541  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2775297164916992  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008136272430419922  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 3 input nodes size: 10978
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0074710845947265625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0074710845947265625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012705802917480469  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012739181518554688  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008086681365966797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008382320404052734  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008382320404052734  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 10978
output nodes number: 4430
edges number: 39653
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.30153751373291016  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.30153799057006836  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0087738037109375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 4 input nodes size: 10304
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00805044174194336  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00805044174194336  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.013677597045898438  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.013710498809814453  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008442401885986328  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00865316390991211  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00865316390991211  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 10304
output nodes number: 4414
edges number: 28241
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2206101417541504  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2206106185913086  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008987903594970703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 5 input nodes size: 9471
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008440017700195312  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008440017700195312  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01295614242553711  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012990951538085938  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007330894470214844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007641792297363281  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007641792297363281  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 9471
output nodes number: 4617
edges number: 41686
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3157963752746582  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3157968521118164  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008105754852294922  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 6 input nodes size: 10432
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007360935211181641  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007360935211181641  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01233530044555664  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012369632720947266  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00781869888305664  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00808858871459961  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00808858871459961  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 10432
output nodes number: 4572
edges number: 36120
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.27736949920654297  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.27736997604370117  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008481025695800781  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 7 input nodes size: 9265
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007812023162841797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007812023162841797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012328147888183594  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012362957000732422  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007354259490966797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007694721221923828  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007694721221923828  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 9265
output nodes number: 4615
edges number: 45597
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3438239097595215  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3438243865966797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0081634521484375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 8 input nodes size: 11476
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007360935211181641  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007360935211181641  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012833118438720703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012867927551269531  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008316993713378906  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008663177490234375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008663177490234375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 11476
output nodes number: 4662
edges number: 46404
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.35164594650268555  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.35164642333984375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009154319763183594  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 9 input nodes size: 11509
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00832366943359375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00832366943359375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.013811588287353516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01384592056274414  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00833892822265625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008732795715332031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008732795715332031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 11509
output nodes number: 4607
edges number: 52775
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3968505859375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3968510627746582  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00925588607788086  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 10 input nodes size: 28443
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008330821990966797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008330821990966797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.02189350128173828  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0219268798828125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01640462875366211  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016809940338134766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016809940338134766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 28443
output nodes number: 4465
edges number: 54280
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.4156327247619629  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.4156332015991211  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017456531524658203  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 11 input nodes size: 13810
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016383647918701172  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016383647918701172  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.022968769073486328  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.023003101348876953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00940704345703125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009718894958496094  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009718894958496094  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 13810
output nodes number: 4584
edges number: 41823
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3194451332092285  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3194456100463867  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010202884674072266  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 12 input nodes size: 13625
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009424686431884766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009424686431884766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015921592712402344  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015956401824951172  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00933694839477539  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009605884552001953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009605884552001953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 13625
output nodes number: 4667
edges number: 36071
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2797102928161621  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2797107696533203  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010041236877441406  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 13 input nodes size: 18183
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009349346160888672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009349346160888672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.018019676208496094  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01805257797241211  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011520862579345703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011752605438232422  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011752605438232422  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 18183
output nodes number: 4415
edges number: 30989
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.24334478378295898  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2433452606201172  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01213216781616211  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 14 input nodes size: 30564
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011483192443847656  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011483192443847656  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.02605724334716797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.026090145111083984  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017386913299560547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017870426177978516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017870426177978516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 30564
output nodes number: 4414
edges number: 64812
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.4918861389160156  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.49188661575317383  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.018631458282470703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 15 input nodes size: 18677
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017386913299560547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.017386913299560547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.026292800903320312  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.02632617950439453  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011719226837158203  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012038707733154297  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012038707733154297  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 18677
output nodes number: 4470
edges number: 42875
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.32852649688720703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.32852697372436523  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012555599212646484  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 16 input nodes size: 14901
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011727333068847656  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011727333068847656  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016012191772460938  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016047000885009766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007107734680175781  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007355690002441406  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007355690002441406  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8986
output nodes number: 4660
edges number: 33223
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.25623655319213867  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2562370300292969  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007751941680908203  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 17 input nodes size: 26330
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007136344909667969  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007136344909667969  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011188507080078125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011223316192626953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006903648376464844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007114410400390625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007114410400390625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8498
output nodes number: 4614
edges number: 28281
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.22079896926879883  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.22079944610595703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007433891296386719  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 18 input nodes size: 22989
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006896495819091797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006896495819091797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011181354522705078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011216163635253906  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007129192352294922  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007377147674560547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007377147674560547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8986
output nodes number: 4660
edges number: 33223
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.25623655319213867  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2562370300292969  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007751941680908203  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 19 input nodes size: 20218
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007136344909667969  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007136344909667969  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011188507080078125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011223316192626953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006903648376464844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007114410400390625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007114410400390625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8498
output nodes number: 4614
edges number: 28281
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.21968698501586914  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.21968746185302734  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007433891296386719  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 20 input nodes size: 18516
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006896495819091797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006896495819091797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011181354522705078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011216163635253906  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007129192352294922  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007377147674560547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007377147674560547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8986
output nodes number: 4660
edges number: 33223
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.25623655319213867  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2562370300292969  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007751941680908203  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 21 input nodes size: 23699
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007136344909667969  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007136344909667969  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011188507080078125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011223316192626953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006903648376464844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007114410400390625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007114410400390625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8498
output nodes number: 4614
edges number: 28281
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.21968698501586914  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.21968746185302734  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007433891296386719  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 22 input nodes size: 18516
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006896495819091797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006896495819091797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011181354522705078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011216163635253906  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007129192352294922  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007377147674560547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007377147674560547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8986
output nodes number: 4660
edges number: 33223
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.25623655319213867  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2562370300292969  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007751941680908203  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 23 input nodes size: 23699
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007136344909667969  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007136344909667969  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011188507080078125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011223316192626953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006903648376464844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007114410400390625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007114410400390625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes
[04:14:39] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 42067062 edges into 24 parts and get 13639157 edge cuts

input nodes number: 8498
output nodes number: 4614
edges number: 28281
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.21968698501586914  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.21968746185302734  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007433891296386719  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007433891296386719  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007433891296386719  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008180359999338785 |0.0010448495546976726 |0.4527046779791514 |0.00013965368270874023 |0.6314173936843872 |0.005242824554443359 |
----------------------------------------------------------pseudo_mini_loss sum 18.05838394165039
Total (block generation + training)time/epoch 66.37319684028625
Training time/epoch 26.471412420272827
Training time without block to device /epoch 26.446336030960083
Training time without total dataloading part /epoch 26.02752423286438
load block tensor time/epoch 0.19632863998413086
block to device time/epoch 0.02507638931274414
input features size transfer per epoch 3.2186508178710938e-06
blocks size to device per epoch 2.1457672119140625e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  293840
Number of first layer input nodes during this epoch:  392772
Number of first layer output nodes during this epoch:  109977
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007433414459228516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028496980667114258
global_2_local spend time (sec) 0.051732778549194336
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0054399967193603516
A = g.adjacency_matrix() spent  0.011610984802246094
auxiliary_graph
Graph(num_nodes=160172, num_edges=42158003,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10195779800415039
remove nodes length
69231
auxiliary_graph.remove_nodes spent  2.2910268306732178
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=42158003,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.8846969604492188

the counter of shared neighbor distribution
Counter({1.0: 31004810, 2.0: 7111794, 3.0: 2262212, 4.0: 837528, 5.0: 363508, 6.0: 179410, 7.0: 99040, 8.0: 59936, 9.0: 38312, 10.0: 26292, 11.0: 18112, 12.0: 13334, 13.0: 9882, 14.0: 7776, 15.0: 6148, 16.0: 4860, 17.0: 3892, 18.0: 3150, 19.0: 2518, 20.0: 2194, 21.0: 1810, 22.0: 1656, 23.0: 1252, 24.0: 1050, 25.0: 892, 26.0: 742, 27.0: 668, 28.0: 592, 29.0: 508, 31.0: 432, 30.0: 430, 32.0: 338, 33.0: 296, 34.0: 260, 35.0: 196, 36.0: 176, 38.0: 168, 37.0: 134, 40.0: 104, 39.0: 90, 43.0: 74, 41.0: 70, 42.0: 62, 45.0: 62, 44.0: 54, 46.0: 34, 47.0: 26, 50.0: 24, 49.0: 22, 48.0: 20, 51.0: 20, 52.0: 16, 55.0: 14, 54.0: 10, 53.0: 10, 56.0: 8, 57.0: 6, 59.0: 4, 67.0: 4, 64.0: 4, 58.0: 4, 89.0: 2, 68.0: 2, 79.0: 2, 66.0: 2, 71.0: 2, 62.0: 2})
42067062
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 42067059, 42067060, 42067061])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 31004810, 2.0: 7111794, 3.0: 2262212, 4.0: 837528, 5.0: 363508, 6.0: 179410, 7.0: 99040, 8.0: 59936, 9.0: 38312, 10.0: 26292, 11.0: 18112, 12.0: 13334, 13.0: 9882, 14.0: 7776, 15.0: 6148, 16.0: 4860, 17.0: 3892, 18.0: 3150, 19.0: 2518, 20.0: 2194, 21.0: 1810, 22.0: 1656, 23.0: 1252, 24.0: 1050, 25.0: 892, 26.0: 742, 27.0: 668, 28.0: 592, 29.0: 508, 31.0: 432, 30.0: 430, 32.0: 338, 33.0: 296, 34.0: 260, 35.0: 196, 36.0: 176, 38.0: 168, 37.0: 134, 40.0: 104, 39.0: 90, 43.0: 74, 41.0: 70, 42.0: 62, 45.0: 62, 44.0: 54, 46.0: 34, 47.0: 26, 50.0: 24, 49.0: 22, 48.0: 20, 51.0: 20, 52.0: 16, 55.0: 14, 54.0: 10, 53.0: 10, 56.0: 8, 57.0: 6, 59.0: 4, 67.0: 4, 64.0: 4, 58.0: 4, 89.0: 2, 68.0: 2, 79.0: 2, 66.0: 2, 71.0: 2, 62.0: 2})
Convert a graph into a bidirected graph: 2.842 seconds
Metis partitioning: 8.640 seconds
Split the graph: 1.453 seconds
Construct subgraphs: 0.148 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  13.102705001831055
3887
3893
3841
3896
3854
3903
3903
3903
3715
3756
3896
3819
3691
3680
3734
3682
3678
3903
3767
3694
3697
3715
3736
3698
total k batches seeds list generation spend  30.18633270263672
after graph partition
graph partition algorithm spend time 30.348841667175293
3887
3893
3841
3896
3854
3903
3903
3903
3715
3756
3896
3819
3691
3680
3734
3682
3678
3903
3767
3694
3697
3715
3736
3698
partition_len_list
[7355, 8486, 9445, 7698, 10766, 10627, 8379, 9994, 9410, 7725, 8557, 7804, 25451, 30557, 30488, 30231, 26099, 32567, 13249, 25411, 17578, 9876, 12889, 12272]
shared_neighbor_graph_partition_s0 selection method  spend 30.469106435775757
time for parepare:  0.02456498146057129
local_output_nid generation:  0.0009329319000244141
local_in_edges_tensor generation:  0.0012607574462890625
mini_batch_src_global generation:  0.0012903213500976562
r_  generation:  0.009762763977050781
local_output_nid generation:  0.0010044574737548828
local_in_edges_tensor generation:  0.0011017322540283203
mini_batch_src_global generation:  0.0016450881958007812
r_  generation:  0.01260232925415039
local_output_nid generation:  0.0010724067687988281
local_in_edges_tensor generation:  0.0013256072998046875
mini_batch_src_global generation:  0.0013663768768310547
r_  generation:  0.012481689453125
local_output_nid generation:  0.0011322498321533203
local_in_edges_tensor generation:  0.0010614395141601562
mini_batch_src_global generation:  0.0012269020080566406
r_  generation:  0.011453628540039062
local_output_nid generation:  0.0011889934539794922
local_in_edges_tensor generation:  0.0010974407196044922
mini_batch_src_global generation:  0.001378774642944336
r_  generation:  0.012779474258422852
local_output_nid generation:  0.0011432170867919922
local_in_edges_tensor generation:  0.0011436939239501953
mini_batch_src_global generation:  0.006383419036865234
r_  generation:  0.016705989837646484
local_output_nid generation:  0.0011749267578125
local_in_edges_tensor generation:  0.001100778579711914
mini_batch_src_global generation:  0.0013697147369384766
r_  generation:  0.012334346771240234
local_output_nid generation:  0.0011370182037353516
local_in_edges_tensor generation:  0.0011730194091796875
mini_batch_src_global generation:  0.002003908157348633
r_  generation:  0.017614126205444336
local_output_nid generation:  0.0011119842529296875
local_in_edges_tensor generation:  0.001056671142578125
mini_batch_src_global generation:  0.0016298294067382812
r_  generation:  0.015149354934692383
local_output_nid generation:  0.0010929107666015625
local_in_edges_tensor generation:  0.0010721683502197266
mini_batch_src_global generation:  0.0016205310821533203
r_  generation:  0.01441502571105957
local_output_nid generation:  0.0011413097381591797
local_in_edges_tensor generation:  0.0010614395141601562
mini_batch_src_global generation:  0.0014903545379638672
r_  generation:  0.015444278717041016[04:14:44] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 3903 nodes and 3269644 edges into 2 parts and get 728643 edge cuts

local_output_nid generation:  0.0011029243469238281
local_in_edges_tensor generation:  0.001424551010131836
mini_batch_src_global generation:  0.0016930103302001953
r_  generation:  0.015465974807739258
local_output_nid generation:  0.0010876655578613281
local_in_edges_tensor generation:  0.001094818115234375
mini_batch_src_global generation:  0.0016667842864990234
r_  generation:  0.01869988441467285
local_output_nid generation:  0.001140594482421875
local_in_edges_tensor generation:  0.0011949539184570312
mini_batch_src_global generation:  0.002649545669555664
r_  generation:  0.023648500442504883
local_output_nid generation:  0.0012640953063964844
local_in_edges_tensor generation:  0.0015330314636230469
mini_batch_src_global generation:  0.002722501754760742
r_  generation:  0.028051137924194336
local_output_nid generation:  0.0013256072998046875
local_in_edges_tensor generation:  0.0012211799621582031
mini_batch_src_global generation:  0.0022568702697753906
r_  generation:  0.0235593318939209
local_output_nid generation:  0.0013005733489990234
local_in_edges_tensor generation:  0.0012564659118652344
mini_batch_src_global generation:  0.002590656280517578
r_  generation:  0.02751779556274414
local_output_nid generation:  0.001367330551147461
local_in_edges_tensor generation:  0.0014188289642333984
mini_batch_src_global generation:  0.003887176513671875
r_  generation:  0.03712320327758789
local_output_nid generation:  0.0013887882232666016
local_in_edges_tensor generation:  0.0010824203491210938
mini_batch_src_global generation:  0.0018002986907958984
r_  generation:  0.012004613876342773
local_output_nid generation:  0.0013341903686523438
local_in_edges_tensor generation:  0.0011749267578125
mini_batch_src_global generation:  0.002128124237060547
r_  generation:  0.025275468826293945
local_output_nid generation:  0.0013222694396972656
local_in_edges_tensor generation:  0.0010952949523925781
mini_batch_src_global generation:  0.001859426498413086
r_  generation:  0.01598334312438965
local_output_nid generation:  0.0013134479522705078
local_in_edges_tensor generation:  0.00101470947265625
mini_batch_src_global generation:  0.0014448165893554688
r_  generation:  0.010213851928710938
local_output_nid generation:  0.001253366470336914
local_in_edges_tensor generation:  0.0011920928955078125
mini_batch_src_global generation:  0.001219034194946289
r_  generation:  0.012098073959350586
local_output_nid generation:  0.0012214183807373047
local_in_edges_tensor generation:  0.0009772777557373047
mini_batch_src_global generation:  0.0012431144714355469
r_  generation:  0.011446237564086914
----------------------check_connections_block total spend ----------------------------- 0.6431784629821777
generate_one_block  0.022058963775634766
generate_one_block  0.01890850067138672
generate_one_block  0.01804327964782715
generate_one_block  0.015846729278564453
generate_one_block  0.018520832061767578
generate_one_block  0.022091388702392578
generate_one_block  0.01769566535949707
generate_one_block  0.023572444915771484
generate_one_block  0.02034759521484375
generate_one_block  0.019800901412963867
generate_one_block  0.021076202392578125
generate_one_block  0.021347999572753906
generate_one_block  0.029691219329833984
generate_one_block  0.035784006118774414
generate_one_block  0.04004359245300293
generate_one_block  0.03440046310424805
generate_one_block  0.03897571563720703
generate_one_block  0.06581544876098633
generate_one_block  0.019173145294189453
generate_one_block  0.03836393356323242
generate_one_block  0.02348494529724121
generate_one_block  0.015743017196655273
generate_one_block  0.017930030822753906
generate_one_block  0.016983985900878906
global_2_local spend time (sec) 0.009701967239379883
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0013430118560791016
A = g.adjacency_matrix() spent  0.0018572807312011719
auxiliary_graph
Graph(num_nodes=32567, num_edges=3273547,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.022267580032348633
remove nodes length
28664
auxiliary_graph.remove_nodes spent  0.11645078659057617
after remove non output nodes the auxiliary_graph
Graph(num_nodes=3903, num_edges=3273547,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.12296819686889648

the counter of shared neighbor distribution
Counter({1.0: 2101800, 2.0: 729860, 3.0: 266916, 4.0: 94130, 5.0: 37614, 6.0: 16270, 7.0: 8396, 8.0: 4590, 9.0: 2820, 10.0: 1774, 11.0: 1250, 12.0: 860, 13.0: 602, 14.0: 456, 15.0: 422, 16.0: 330, 17.0: 220, 18.0: 200, 19.0: 178, 22.0: 118, 21.0: 106, 20.0: 98, 24.0: 74, 25.0: 70, 23.0: 68, 27.0: 58, 26.0: 54, 28.0: 48, 30.0: 44, 29.0: 38, 32.0: 24, 34.0: 24, 31.0: 22, 33.0: 20, 40.0: 16, 36.0: 12, 35.0: 10, 37.0: 8, 39.0: 8, 42.0: 6, 38.0: 6, 41.0: 6, 46.0: 4, 49.0: 4, 57.0: 2, 44.0: 2, 56.0: 2, 45.0: 2, 50.0: 2})
3269644
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([      0,       1,       2,  ..., 3269641, 3269642, 3269643])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 2101800, 2.0: 729860, 3.0: 266916, 4.0: 94130, 5.0: 37614, 6.0: 16270, 7.0: 8396, 8.0: 4590, 9.0: 2820, 10.0: 1774, 11.0: 1250, 12.0: 860, 13.0: 602, 14.0: 456, 15.0: 422, 16.0: 330, 17.0: 220, 18.0: 200, 19.0: 178, 22.0: 118, 21.0: 106, 20.0: 98, 24.0: 74, 25.0: 70, 23.0: 68, 27.0: 58, 26.0: 54, 28.0: 48, 30.0: 44, 29.0: 38, 32.0: 24, 34.0: 24, 31.0: 22, 33.0: 20, 40.0: 16, 36.0: 12, 35.0: 10, 37.0: 8, 39.0: 8, 42.0: 6, 38.0: 6, 41.0: 6, 46.0: 4, 49.0: 4, 57.0: 2, 44.0: 2, 56.0: 2, 45.0: 2, 50.0: 2})
Convert a graph into a bidirected graph: 0.120 seconds
Metis partitioning: 0.255 seconds
Split the graph: 0.243 seconds
Construct subgraphs: 0.048 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.669670820236206
1973
1930
total k batches seeds list generation spend  2.044888734817505
after graph partition
graph partition algorithm spend time 2.0596837997436523
1973
1930
time for parepare:  0.020273208618164062
local_output_nid generation:  0.00036334991455078125
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.002045154571533203
r_  generation:  0.019117116928100586
local_output_nid generation:  0.00037789344787597656
local_in_edges_tensor generation:  0.0008180141448974609
mini_batch_src_global generation:  0.002706289291381836
r_  generation:  0.01727914810180664
----------------------check_connections_block total spend ----------------------------- 0.07666850090026855
generate_one_block  0.032781362533569336
generate_one_block  0.02786397933959961
global_2_local spend time (sec) 0.0074574947357177734
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0008809566497802734
A = g.adjacency_matrix() spent  0.0010499954223632812
auxiliary_graph
Graph(num_nodes=30557, num_edges=422872,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0194549560546875
remove nodes length
26877
auxiliary_graph.remove_nodes spent  0.012763738632202148
after remove non output nodes the auxiliary_graph
Graph(num_nodes=3680, num_edges=422872,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.012912988662719727

the counter of shared neighbor distribution
Counter({1.0: 308064, 2.0: 72470, 3.0: 21766, 4.0: 8216, 5.0: 3684, 6.0: 1886, 7.0: 1016, 8.0: 602, 9.0: 396, 10.0: 294, 11.0: 182, 12.0: 134, 14.0: 86, 13.0: 74, 16.0: 50, 18.0: 42, 15.0: 40, 17.0: 30, 19.0: 24, 20.0: 20, 30.0: 14, 22.0: 14, 29.0: 12, 24.0: 10, 23.0: 8, 27.0: 8, 32.0: 6, 26.0: 6, 37.0: 6, 25.0: 6, 28.0: 4, 33.0: 4, 21.0: 4, 34.0: 4, 31.0: 4, 38.0: 2, 36.0: 2, 41.0: 2})
419192
--------------------------------------- new test ---------------------[04:14:45] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 3680 nodes and 419192 edges into 2 parts and get 64873 edge cuts
[04:14:46] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 3680 nodes and 419192 edges into 2 parts and get 64873 edge cuts
[04:14:46] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 3680 nodes and 419192 edges into 2 parts and get 64873 edge cuts

--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 419189, 419190, 419191])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 308064, 2.0: 72470, 3.0: 21766, 4.0: 8216, 5.0: 3684, 6.0: 1886, 7.0: 1016, 8.0: 602, 9.0: 396, 10.0: 294, 11.0: 182, 12.0: 134, 14.0: 86, 13.0: 74, 16.0: 50, 18.0: 42, 15.0: 40, 17.0: 30, 19.0: 24, 20.0: 20, 30.0: 14, 22.0: 14, 29.0: 12, 24.0: 10, 23.0: 8, 27.0: 8, 32.0: 6, 26.0: 6, 37.0: 6, 25.0: 6, 28.0: 4, 33.0: 4, 21.0: 4, 34.0: 4, 31.0: 4, 38.0: 2, 36.0: 2, 41.0: 2})
Convert a graph into a bidirected graph: 0.013 seconds
Metis partitioning: 0.041 seconds
Split the graph: 0.026 seconds
Construct subgraphs: 0.015 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.09487056732177734
1849
1831
total k batches seeds list generation spend  0.3117082118988037
after graph partition
graph partition algorithm spend time 0.3190886974334717
1849
1831
time for parepare:  0.01966404914855957
local_output_nid generation:  0.0003180503845214844
local_in_edges_tensor generation:  0.0007321834564208984
mini_batch_src_global generation:  0.0011172294616699219
r_  generation:  0.012848377227783203
local_output_nid generation:  0.0003612041473388672
local_in_edges_tensor generation:  0.0006551742553710938
mini_batch_src_global generation:  0.0010559558868408203
r_  generation:  0.00881505012512207
----------------------check_connections_block total spend ----------------------------- 0.05445408821105957
generate_one_block  0.023552894592285156
generate_one_block  0.016004323959350586
global_2_local spend time (sec) 0.006964206695556641
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007939338684082031
A = g.adjacency_matrix() spent  0.0009348392486572266
auxiliary_graph
Graph(num_nodes=30557, num_edges=422872,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.019907474517822266
remove nodes length
26877
auxiliary_graph.remove_nodes spent  0.012590885162353516
after remove non output nodes the auxiliary_graph
Graph(num_nodes=3680, num_edges=422872,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.009310245513916016

the counter of shared neighbor distribution
Counter({1.0: 308064, 2.0: 72470, 3.0: 21766, 4.0: 8216, 5.0: 3684, 6.0: 1886, 7.0: 1016, 8.0: 602, 9.0: 396, 10.0: 294, 11.0: 182, 12.0: 134, 14.0: 86, 13.0: 74, 16.0: 50, 18.0: 42, 15.0: 40, 17.0: 30, 19.0: 24, 20.0: 20, 30.0: 14, 22.0: 14, 29.0: 12, 24.0: 10, 23.0: 8, 27.0: 8, 32.0: 6, 26.0: 6, 37.0: 6, 25.0: 6, 28.0: 4, 33.0: 4, 21.0: 4, 34.0: 4, 31.0: 4, 38.0: 2, 36.0: 2, 41.0: 2})
419192
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 419189, 419190, 419191])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 308064, 2.0: 72470, 3.0: 21766, 4.0: 8216, 5.0: 3684, 6.0: 1886, 7.0: 1016, 8.0: 602, 9.0: 396, 10.0: 294, 11.0: 182, 12.0: 134, 14.0: 86, 13.0: 74, 16.0: 50, 18.0: 42, 15.0: 40, 17.0: 30, 19.0: 24, 20.0: 20, 30.0: 14, 22.0: 14, 29.0: 12, 24.0: 10, 23.0: 8, 27.0: 8, 32.0: 6, 26.0: 6, 37.0: 6, 25.0: 6, 28.0: 4, 33.0: 4, 21.0: 4, 34.0: 4, 31.0: 4, 38.0: 2, 36.0: 2, 41.0: 2})
Convert a graph into a bidirected graph: 0.010 seconds
Metis partitioning: 0.036 seconds
Split the graph: 0.023 seconds
Construct subgraphs: 0.039 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.1073904037475586
1849
1831
total k batches seeds list generation spend  0.3162872791290283
after graph partition
graph partition algorithm spend time 0.32772040367126465
1849
1831
time for parepare:  0.03637957572937012
local_output_nid generation:  0.00045037269592285156
local_in_edges_tensor generation:  0.0012438297271728516
mini_batch_src_global generation:  0.0015442371368408203
r_  generation:  0.02018904685974121
local_output_nid generation:  0.0004432201385498047
local_in_edges_tensor generation:  0.0009672641754150391
mini_batch_src_global generation:  0.0019388198852539062
r_  generation:  0.014266014099121094
----------------------check_connections_block total spend ----------------------------- 0.08815503120422363
generate_one_block  0.023164987564086914
generate_one_block  0.015770912170410156
global_2_local spend time (sec) 0.0070972442626953125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0008578300476074219
A = g.adjacency_matrix() spent  0.0010349750518798828
auxiliary_graph
Graph(num_nodes=30557, num_edges=422872,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.019360780715942383
remove nodes length
26877
auxiliary_graph.remove_nodes spent  0.012755632400512695
after remove non output nodes the auxiliary_graph
Graph(num_nodes=3680, num_edges=422872,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.009396076202392578

the counter of shared neighbor distribution
Counter({1.0: 308064, 2.0: 72470, 3.0: 21766, 4.0: 8216, 5.0: 3684, 6.0: 1886, 7.0: 1016, 8.0: 602, 9.0: 396, 10.0: 294, 11.0: 182, 12.0: 134, 14.0: 86, 13.0: 74, 16.0: 50, 18.0: 42, 15.0: 40, 17.0: 30, 19.0: 24, 20.0: 20, 30.0: 14, 22.0: 14, 29.0: 12, 24.0: 10, 23.0: 8, 27.0: 8, 32.0: 6, 26.0: 6, 37.0: 6, 25.0: 6, 28.0: 4, 33.0: 4, 21.0: 4, 34.0: 4, 31.0: 4, 38.0: 2, 36.0: 2, 41.0: 2})
419192
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([     0,      1,      2,  ..., 419189, 419190, 419191])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 308064, 2.0: 72470, 3.0: 21766, 4.0: 8216, 5.0: 3684, 6.0: 1886, 7.0: 1016, 8.0: 602, 9.0: 396, 10.0: 294, 11.0: 182, 12.0: 134, 14.0: 86, 13.0: 74, 16.0: 50, 18.0: 42, 15.0: 40, 17.0: 30, 19.0: 24, 20.0: 20, 30.0: 14, 22.0: 14, 29.0: 12, 24.0: 10, 23.0: 8, 27.0: 8, 32.0: 6, 26.0: 6, 37.0: 6, 25.0: 6, 28.0: 4, 33.0: 4, 21.0: 4, 34.0: 4, 31.0: 4, 38.0: 2, 36.0: 2, 41.0: 2})
Convert a graph into a bidirected graph: 0.009 seconds
Metis partitioning: 0.035 seconds
Split the graph: 0.023 seconds
Construct subgraphs: 0.026 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.09395527839660645
1849
1831
total k batches seeds list generation spend  0.30274534225463867
after graph partition
graph partition algorithm spend time 0.3083512783050537
1849
1831
time for parepare:  0.019864797592163086
local_output_nid generation:  0.00031113624572753906
local_in_edges_tensor generation:  0.0010077953338623047
mini_batch_src_global generation:  0.005303621292114258
r_  generation:  0.012032747268676758
local_output_nid generation:  0.0003249645233154297
local_in_edges_tensor generation:  0.0006821155548095703
mini_batch_src_global generation:  0.0013837814331054688
r_  generation:  0.009340047836303711
----------------------check_connections_block total spend ----------------------------- 0.06524205207824707
generate_one_block  0.023593902587890625
generate_one_block  0.016306161880493164
----------===============-------------===============-------------the number of batches ***** 28

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007433414459228516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 37.83731031417847
pseudo mini batch 0 input nodes size: 7355
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006895542144775391  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006895542144775391  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011180400848388672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011209487915039062  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007122516632080078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007290363311767578  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007290363311767578  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 7355
output nodes number: 3887
edges number: 22476
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.17667531967163086  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.17667627334594727  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007449626922607422  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 1 input nodes size: 8486
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007015228271484375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007015228271484375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011061668395996094  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011090755462646484  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0067768096923828125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0070056915283203125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0070056915283203125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8486
output nodes number: 3893
edges number: 30640
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23453187942504883  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23453235626220703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007342815399169922  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 2 input nodes size: 9445
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006777763366699219  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006777763366699219  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011281490325927734  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011310577392578125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007235050201416016  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007463932037353516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007463932037353516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 9445
output nodes number: 3841
edges number: 30628
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2354426383972168  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.235443115234375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007799625396728516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 3 input nodes size: 7698
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007227420806884766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007227420806884766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010898113250732422  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010927200317382812  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006394386291503906  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0065975189208984375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0065975189208984375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 7698
output nodes number: 3896
edges number: 27227
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.21096515655517578  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.21096563339233398  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0069103240966796875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 4 input nodes size: 10766
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006402492523193359  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006402492523193359  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011536121368408203  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011565208435058594  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007865428924560547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008098125457763672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008098125457763672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 10766
output nodes number: 3854
edges number: 31175
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23946332931518555  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23946380615234375  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008449077606201172  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 5 input nodes size: 10627
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007859230041503906  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007859230041503906  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012926578521728516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012955665588378906  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007792949676513672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00809335708618164  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00809335708618164  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 10627
output nodes number: 3903
edges number: 40241
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.30440568923950195  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.30440616607666016  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008524417877197266  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 6 input nodes size: 8379
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007800102233886719  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007800102233886719  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011795520782470703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011824607849121094  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006728172302246094  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006949424743652344  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006949424743652344  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8379
output nodes number: 3903
edges number: 29599
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.22705888748168945  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.22705936431884766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007277011871337891  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 7 input nodes size: 9994
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006728172302246094  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006728172302246094  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011493682861328125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011522769927978516  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007498264312744141  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007823467254638672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007823467254638672  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 9994
output nodes number: 3903
edges number: 43601
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3286466598510742  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.3286471366882324  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008267402648925781  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 8 input nodes size: 9410
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007498264312744141  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007498264312744141  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011985301971435547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012013435363769531  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007218837738037109  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007489681243896484  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007489681243896484  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 9410
output nodes number: 3715
edges number: 36238
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2747073173522949  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2747077941894531  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007845401763916016  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 9 input nodes size: 7725
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007190704345703125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007190704345703125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010874271392822266  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01090240478515625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006387233734130859  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006646633148193359  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006646633148193359  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 7725
output nodes number: 3756
edges number: 34805
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.265200138092041  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2652006149291992  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007012367248535156  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 10 input nodes size: 8557
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0063934326171875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0063934326171875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01047372817993164  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010502815246582031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006791114807128906  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007069587707519531  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007069587707519531  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8557
output nodes number: 3896
edges number: 37307
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.28235816955566406  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.28235864639282227  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007476806640625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 11 input nodes size: 7804
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006812095642089844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006812095642089844  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010533332824707031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010561943054199219  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0064525604248046875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006735801696777344  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006735801696777344  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 7804
output nodes number: 3819
edges number: 37899
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.28606557846069336  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.28606605529785156  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0071086883544921875  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 12 input nodes size: 25451
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0064411163330078125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0064411163330078125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.018577098846435547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.018604755401611328  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.014854907989501953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015179157257080078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015179157257080078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 25451
output nodes number: 3691
edges number: 43489
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.33439111709594727  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.33439159393310547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015715599060058594  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 13 input nodes size: 26099
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.014835834503173828  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.014835834503173828  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.027280807495117188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.02730846405029297  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015144824981689453  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015659809112548828  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015659809112548828  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 26099
output nodes number: 3678
edges number: 69033
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.5177626609802246  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.5177631378173828  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016408920288085938  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 14 input nodes size: 13249
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01514291763305664  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.01514291763305664  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.02222919464111328  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.022257328033447266  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009784698486328125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009988784790039062  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009988784790039062  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 13249
output nodes number: 3767
edges number: 27360
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2142782211303711  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2142786979675293  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010347843170166016  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 15 input nodes size: 25411
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009798049926757812  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009798049926757812  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.022243022918701172  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.022270679473876953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015156269073486328  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015648365020751953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015648365020751953  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 25411
output nodes number: 3694
edges number: 65998
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.4968595504760742  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.4968600273132324  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.016360759735107422  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 16 input nodes size: 17578
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015145301818847656  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015145301818847656  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.023527145385742188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.02355480194091797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011082172393798828  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011362552642822266  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011362552642822266  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 17578
output nodes number: 3697
edges number: 37569
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.28898191452026367  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.2889823913574219  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011816024780273438  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 17 input nodes size: 9876
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011082649230957031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.011082649230957031  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015791893005371094  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015820026397705078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007410526275634766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007593631744384766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007593631744384766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 9876
output nodes number: 3715
edges number: 24475
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.19105958938598633  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.19106006622314453  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007895469665527344  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 18 input nodes size: 12889
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007412910461425781  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007412910461425781  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.013853073120117188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.013881206512451172  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009143829345703125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009369850158691406  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009369850158691406  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 12889
output nodes number: 3736
edges number: 30227
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23435163497924805  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23435211181640625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009737968444824219  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 19 input nodes size: 12272
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009147167205810547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009147167205810547  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.014998912811279297  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.015026569366455078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.008558273315429688  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00876617431640625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00876617431640625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 12272
output nodes number: 3698
edges number: 27806
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.21561765670776367  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.21561813354492188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.009101390838623047  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 20 input nodes size: 22404
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00855255126953125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.00855255126953125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012059688568115234  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.012088775634765625  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006209373474121094  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006377220153808594  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006377220153808594  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 7355
output nodes number: 3887
edges number: 22476
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.17676591873168945  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.17676639556884766  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006671905517578125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 21 input nodes size: 21788
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006237506866455078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006237506866455078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010283946990966797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010313034057617188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0067768096923828125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0070056915283203125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0070056915283203125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8486
output nodes number: 3893
edges number: 30640
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23453187942504883  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23453235626220703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007342815399169922  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 22 input nodes size: 21127
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006777763366699219  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006777763366699219  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010284900665283203  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010313987731933594  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006238460540771484  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006406307220458984  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006406307220458984  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 7355
output nodes number: 3887
edges number: 22476
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.1755661964416504  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.1755666732788086  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006671905517578125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 23 input nodes size: 14469
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006237506866455078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006237506866455078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010283946990966797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010313034057617188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0067768096923828125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0070056915283203125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0070056915283203125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8486
output nodes number: 3893
edges number: 30640
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23453187942504883  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23453235626220703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007342815399169922  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 24 input nodes size: 21127
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006777763366699219  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006777763366699219  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010284900665283203  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010313987731933594  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006238460540771484  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006406307220458984  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006406307220458984  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 7355
output nodes number: 3887
edges number: 22476
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.1755661964416504  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.1755666732788086  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006671905517578125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 25 input nodes size: 14469
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006237506866455078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006237506866455078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010283946990966797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010313034057617188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0067768096923828125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0070056915283203125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0070056915283203125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8486
output nodes number: 3893
edges number: 30640
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23453187942504883  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23453235626220703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007342815399169922  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 26 input nodes size: 21127
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006777763366699219  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006777763366699219  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010284900665283203  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010313987731933594  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006238460540771484  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006406307220458984  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006406307220458984  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 7355
output nodes number: 3887
edges number: 22476
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.1755661964416504  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.1755666732788086  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006671905517578125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

pseudo mini batch 27 input nodes size: 14469
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006237506866455078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.006237506866455078  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010283946990966797  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.010313034057617188  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0067768096923828125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0070056915283203125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.0070056915283203125  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

input nodes number: 8486
output nodes number: 3893
edges number: 30640
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23453187942504883  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.23453235626220703  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007342815399169922  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007342815399169922  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.7099609375 GB
    Memory Allocated: 0.007342815399169922  GigaBytes
Max Memory Allocated: 0.7230496406555176  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009628023420061384 |0.0007844737597874232 |0.35596467767442974 |0.00011936255863734655 |0.6250737394605365 |0.003780364990234375 |
----------------------------------------------------------pseudo_mini_loss sum 16.068262100219727
Total (block generation + training)time/epoch 65.07977962493896
Training time/epoch 28.01295018196106
Training time without block to device /epoch 27.99098491668701
Training time without total dataloading part /epoch 27.476198196411133
load block tensor time/epoch 0.26958465576171875
block to device time/epoch 0.02196526527404785
input features size transfer per epoch 3.7550926208496094e-06
blocks size to device per epoch 2.5033950805664062e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  312435
Number of first layer input nodes during this epoch:  400051
Number of first layer output nodes during this epoch:  107062
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
