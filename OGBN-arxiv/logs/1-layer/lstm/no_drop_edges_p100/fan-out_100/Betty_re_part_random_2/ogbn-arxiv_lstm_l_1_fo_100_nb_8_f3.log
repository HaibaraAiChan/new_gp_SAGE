[01:38:15] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 42053666 edges into 8 parts and get 7913141 edge cuts
[01:38:22] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 11035 nodes and 4931924 edges into 2 parts and get 499869 edge cuts
main start at this time 1652146662.3654275
-----------------------------------------before load data 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2607421875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025989770889282227
global_2_local spend time (sec) 0.04094195365905762
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0051457881927490234
A = g.adjacency_matrix() spent  0.011844158172607422
auxiliary_graph
Graph(num_nodes=160237, num_edges=42144607,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.16377615928649902
remove nodes length
69296
auxiliary_graph.remove_nodes spent  2.257340431213379
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=42144607,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.7912988662719727

the counter of shared neighbor distribution
Counter({1.0: 30991370, 2.0: 7109668, 3.0: 2259214, 4.0: 837482, 5.0: 364674, 6.0: 181010, 7.0: 100010, 8.0: 60600, 9.0: 38780, 10.0: 26508, 11.0: 18062, 12.0: 13376, 13.0: 9864, 14.0: 7960, 15.0: 6130, 16.0: 4846, 17.0: 3908, 18.0: 3254, 19.0: 2488, 20.0: 2162, 21.0: 1788, 22.0: 1644, 23.0: 1146, 24.0: 1096, 25.0: 896, 26.0: 798, 27.0: 638, 28.0: 546, 29.0: 504, 30.0: 416, 31.0: 410, 32.0: 348, 33.0: 328, 34.0: 254, 35.0: 216, 38.0: 154, 37.0: 150, 36.0: 138, 39.0: 120, 40.0: 110, 42.0: 84, 41.0: 82, 44.0: 68, 43.0: 62, 45.0: 50, 46.0: 40, 47.0: 30, 51.0: 28, 50.0: 26, 48.0: 20, 49.0: 18, 52.0: 14, 55.0: 12, 56.0: 10, 53.0: 10, 59.0: 10, 57.0: 8, 54.0: 8, 64.0: 4, 67.0: 2, 76.0: 2, 70.0: 2, 89.0: 2, 66.0: 2, 58.0: 2, 81.0: 2, 68.0: 2})
42053666
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 42053663, 42053664, 42053665])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 30991370, 2.0: 7109668, 3.0: 2259214, 4.0: 837482, 5.0: 364674, 6.0: 181010, 7.0: 100010, 8.0: 60600, 9.0: 38780, 10.0: 26508, 11.0: 18062, 12.0: 13376, 13.0: 9864, 14.0: 7960, 15.0: 6130, 16.0: 4846, 17.0: 3908, 18.0: 3254, 19.0: 2488, 20.0: 2162, 21.0: 1788, 22.0: 1644, 23.0: 1146, 24.0: 1096, 25.0: 896, 26.0: 798, 27.0: 638, 28.0: 546, 29.0: 504, 30.0: 416, 31.0: 410, 32.0: 348, 33.0: 328, 34.0: 254, 35.0: 216, 38.0: 154, 37.0: 150, 36.0: 138, 39.0: 120, 40.0: 110, 42.0: 84, 41.0: 82, 44.0: 68, 43.0: 62, 45.0: 50, 46.0: 40, 47.0: 30, 51.0: 28, 50.0: 26, 48.0: 20, 49.0: 18, 52.0: 14, 55.0: 12, 56.0: 10, 53.0: 10, 59.0: 10, 57.0: 8, 54.0: 8, 64.0: 4, 67.0: 2, 76.0: 2, 70.0: 2, 89.0: 2, 66.0: 2, 58.0: 2, 81.0: 2, 68.0: 2})
Convert a graph into a bidirected graph: 2.897 seconds
Metis partitioning: 7.968 seconds
Split the graph: 3.146 seconds
Construct subgraphs: 0.120 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  14.151590824127197
11610
11665
11605
11708
11035
11179
11104
11035
total k batches seeds list generation spend  32.29243016242981
after graph partition
graph partition algorithm spend time 32.428343057632446
11610
11665
11605
11708
11035
11179
11104
11035
partition_len_list
[21084, 21623, 21173, 23760, 60800, 47818, 30114, 40634]
shared_neighbor_graph_partition_s0 selection method  spend 32.52165770530701
time for parepare:  0.019681930541992188
local_output_nid generation:  0.0017557144165039062
local_in_edges_tensor generation:  0.0023343563079833984
mini_batch_src_global generation:  0.005007743835449219
r_  generation:  0.04338264465332031
local_output_nid generation:  0.0021677017211914062
local_in_edges_tensor generation:  0.003941059112548828
mini_batch_src_global generation:  0.0060160160064697266
r_  generation:  0.04556775093078613
local_output_nid generation:  0.002346515655517578
local_in_edges_tensor generation:  0.002412557601928711
mini_batch_src_global generation:  0.004198551177978516
r_  generation:  0.03392648696899414
local_output_nid generation:  0.002165555953979492
local_in_edges_tensor generation:  0.0025141239166259766
mini_batch_src_global generation:  0.004948139190673828
r_  generation:  0.043251752853393555
local_output_nid generation:  0.002221345901489258
local_in_edges_tensor generation:  0.004941225051879883
mini_batch_src_global generation:  0.0077021121978759766
r_  generation:  0.07239818572998047
local_output_nid generation:  0.002524137496948242
local_in_edges_tensor generation:  0.005060672760009766
mini_batch_src_global generation:  0.009750843048095703
r_  generation:  0.09044027328491211
local_output_nid generation:  0.0027604103088378906
local_in_edges_tensor generation:  0.002218008041381836
mini_batch_src_global generation:  0.0049457550048828125
r_  generation:  0.03663969039916992
local_output_nid generation:  0.0023734569549560547
local_in_edges_tensor generation:  0.0023505687713623047
mini_batch_src_global generation:  0.005526065826416016
r_  generation:  0.05107927322387695
----------------------check_connections_block total spend ----------------------------- 0.6081585884094238
generate_one_block  0.06299185752868652
generate_one_block  0.057929277420043945
generate_one_block  0.042043209075927734
generate_one_block  0.05245494842529297
generate_one_block  0.10079240798950195
generate_one_block  0.11579751968383789
generate_one_block  0.045639753341674805
generate_one_block  0.07455825805664062
global_2_local spend time (sec) 0.013147592544555664
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0016200542449951172
A = g.adjacency_matrix() spent  0.002401113510131836
auxiliary_graph
Graph(num_nodes=60800, num_edges=4942959,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.03922009468078613
remove nodes length
49765
auxiliary_graph.remove_nodes spent  0.20697808265686035
after remove non output nodes the auxiliary_graph
Graph(num_nodes=11035, num_edges=4942959,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.22084403038024902

the counter of shared neighbor distribution
Counter({1.0: 4012718, 2.0: 646070, 3.0: 162096, 4.0: 54956, 5.0: 23494, 6.0: 12016, 7.0: 6644, 8.0: 3928, 9.0: 2734, 10.0: 1678, 11.0: 1130, 12.0: 962, 13.0: 622, 14.0: 540, 15.0: 380, 16.0: 364, 17.0: 242, 18.0: 220, 19.0: 196, 20.0: 138, 21.0: 102, 22.0: 100, 23.0: 80, 24.0: 72, 26.0: 64, 25.0: 60, 28.0: 44, 27.0: 44, 29.0: 34, 33.0: 28, 30.0: 28, 31.0: 24, 32.0: 24, 34.0: 22, 40.0: 12, 39.0: 8, 38.0: 8, 42.0: 6, 36.0: 6, 49.0: 4, 35.0: 4, 48.0: 4, 50.0: 4, 53.0: 2, 46.0: 2, 45.0: 2, 47.0: 2, 41.0: 2, 44.0: 2, 37.0: 2})
4931924
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.225 seconds
Metis partitioning: 0.480 seconds
Split the graph: 0.634 seconds
Construct subgraphs: 0.023 seconds
auxiliary_graph_no_diag dgl.metis_partition spent [01:38:29] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 11179 nodes and 12986944 edges into 2 parts and get 2740035 edge cuts
 1.363896131515503
5428
5607
total k batches seeds list generation spend  2.8339271545410156
after graph partition
graph partition algorithm spend time 2.859431505203247
5428
5607
time for parepare:  0.02188897132873535
local_output_nid generation:  0.0008838176727294922
local_in_edges_tensor generation:  0.008727550506591797
mini_batch_src_global generation:  0.002490997314453125
r_  generation:  0.024503231048583984
local_output_nid generation:  0.001321554183959961
local_in_edges_tensor generation:  0.002040386199951172
mini_batch_src_global generation:  0.004926204681396484
r_  generation:  0.04321622848510742
----------------------check_connections_block total spend ----------------------------- 0.12943553924560547
generate_one_block  0.0370783805847168
generate_one_block  0.07237434387207031
global_2_local spend time (sec) 0.010236263275146484
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0021924972534179688
A = g.adjacency_matrix() spent  0.001972675323486328
auxiliary_graph
Graph(num_nodes=47818, num_edges=12998123,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.031365156173706055
remove nodes length
36639
auxiliary_graph.remove_nodes spent  0.5595536231994629
after remove non output nodes the auxiliary_graph
Graph(num_nodes=11179, num_edges=12998123,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.5697224140167236

the counter of shared neighbor distribution
Counter({1.0: 8748432, 2.0: 2673654, 3.0: 928474, 4.0: 341768, 5.0: 141228, 6.0: 62960, 7.0: 32654, 8.0: 17864, 9.0: 10750, 10.0: 7228, 11.0: 4694, 12.0: 3380, 13.0: 2524, 14.0: 1896, 15.0: 1472, 16.0: 1202, 17.0: 994, 18.0: 842, 19.0: 636, 21.0: 524, 20.0: 524, 22.0: 456, 23.0: 328, 24.0: 322, 25.0: 256, 26.0: 248, 27.0: 188, 29.0: 176, 28.0: 172, 30.0: 156, 31.0: 130, 33.0: 116, 32.0: 114, 34.0: 86, 35.0: 80, 38.0: 58, 37.0: 56, 39.0: 54, 40.0: 40, 36.0: 36, 41.0: 32, 42.0: 28, 44.0: 26, 43.0: 24, 45.0: 16, 46.0: 12, 47.0: 6, 55.0: 4, 57.0: 4, 51.0: 4, 52.0: 4, 56.0: 2, 53.0: 2, 50.0: 2, 54.0: 2, 48.0: 2, 49.0: 2})
12986944
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------
Convert a graph into a bidirected graph: 0.703 seconds
Metis partitioning: 1.523 seconds
Split the graph: 1.249 seconds
Construct subgraphs: 0.031 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  3.5139687061309814
5665
5514
total k batches seeds list generation spend  7.195176601409912
after graph partition
graph partition algorithm spend time 7.229531288146973
5665
5514
time for parepare:  0.020494937896728516
local_output_nid generation:  0.0007760524749755859
local_in_edges_tensor generation:  0.005506277084350586
mini_batch_src_global generation:  0.005341529846191406
r_  generation:  0.05494570732116699
local_output_nid generation:  0.001886129379272461
local_in_edges_tensor generation:  0.0020673274993896484
mini_batch_src_global generation:  0.004280567169189453
r_  generation:  0.03264212608337402
----------------------check_connections_block total spend ----------------------------- 0.15025067329406738
generate_one_block  0.07932710647583008
generate_one_block  0.04856681823730469
----------===============-------------===============-------------the number of batches ***** 10

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 21084
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.8212890625 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.8330078125 GB
    Memory Allocated: 0.010583877563476562  GigaBytes
Max Memory Allocated: 0.010583877563476562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.8330078125 GB
    Memory Allocated: 0.010670661926269531  GigaBytes
Max Memory Allocated: 0.010670661926269531  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.8330078125 GB
    Memory Allocated: 0.010670661926269531  GigaBytes
Max Memory Allocated: 0.010670661926269531  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 0.8818359375 GB
    Memory Allocated: 0.011480331420898438  GigaBytes
Max Memory Allocated: 0.011480331420898438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.8818359375 GB
    Memory Allocated: 0.011480331420898438  GigaBytes
Max Memory Allocated: 0.011480331420898438  GigaBytes

input nodes number: 21084
output nodes number: 11610
edges number: 108634
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8134765625 GB
    Memory Allocated: 0.8190031051635742  GigaBytes
Max Memory Allocated: 0.8787236213684082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8134765625 GB
    Memory Allocated: 0.8190040588378906  GigaBytes
Max Memory Allocated: 0.8787236213684082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8134765625 GB
    Memory Allocated: 0.015638351440429688  GigaBytes
Max Memory Allocated: 0.8787236213684082  GigaBytes

pseudo mini batch 1 input nodes size: 21623
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8134765625 GB
    Memory Allocated: 0.01373147964477539  GigaBytes
Max Memory Allocated: 0.8787236213684082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8134765625 GB
    Memory Allocated: 0.01373147964477539  GigaBytes
Max Memory Allocated: 0.8787236213684082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8134765625 GB
    Memory Allocated: 0.024042129516601562  GigaBytes
Max Memory Allocated: 0.8787236213684082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8134765625 GB
    Memory Allocated: 0.024129390716552734  GigaBytes
Max Memory Allocated: 0.8787236213684082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8134765625 GB
    Memory Allocated: 0.013988971710205078  GigaBytes
Max Memory Allocated: 0.8787236213684082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8134765625 GB
    Memory Allocated: 0.01483774185180664  GigaBytes
Max Memory Allocated: 0.8787236213684082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8134765625 GB
    Memory Allocated: 0.01483774185180664  GigaBytes
Max Memory Allocated: 0.8787236213684082  GigaBytes

input nodes number: 21623
output nodes number: 11665
edges number: 113803
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.8564267158508301  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.8564271926879883  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.015187740325927734  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

pseudo mini batch 2 input nodes size: 21173
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.013197898864746094  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.013197898864746094  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.02329397201538086  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.023380756378173828  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.012982845306396484  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.01356649398803711  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.01356649398803711  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

input nodes number: 21173
output nodes number: 11605
edges number: 78323
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.6021890640258789  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.6021895408630371  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.015403270721435547  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

pseudo mini batch 3 input nodes size: 23760
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.01394796371459961  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.01394796371459961  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.02527761459350586  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.02536487579345703  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.015182018280029297  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.015932559967041016  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.015932559967041016  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

input nodes number: 23760
output nodes number: 11708
edges number: 100669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.7633824348449707  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.7633829116821289  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.016032695770263672  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

pseudo mini batch 4 input nodes size: 30114
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.014223098754882812  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.014223098754882812  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.02858257293701172  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.028665542602539062  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.01724863052368164  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.01784372329711914  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.01784372329711914  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

input nodes number: 30114
output nodes number: 11104
edges number: 79836
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.6164340972900391  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.6164345741271973  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.018697738647460938  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

pseudo mini batch 5 input nodes size: 40634
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.01715850830078125  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.01715850830078125  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.03668975830078125  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.03677225112915039  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.02232980728149414  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.023273944854736328  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9130859375 GB
    Memory Allocated: 0.023273944854736328  GigaBytes
Max Memory Allocated: 0.921168327331543  GigaBytes

input nodes number: 40634
output nodes number: 11035
edges number: 126652
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.9566817283630371  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.9566822052001953  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.024634838104248047  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

pseudo mini batch 6 input nodes size: 28877
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.022319793701171875  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.022319793701171875  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.036089420318603516  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.03612995147705078  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.01651620864868164  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.016975879669189453  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.016975879669189453  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

input nodes number: 28877
output nodes number: 5428
edges number: 61650
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.47040510177612305  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.47040557861328125  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.016876697540283203  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

pseudo mini batch 7 input nodes size: 45096
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.015680789947509766  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.015680789947509766  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.03718423843383789  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.037226200103759766  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.02341604232788086  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.024289608001708984  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0947265625 GB
    Memory Allocated: 0.024289608001708984  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

input nodes number: 45096
output nodes number: 5607
edges number: 117233
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.8756771087646484  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1572265625 GB
    Memory Allocated: 0.8756775856018066  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1591796875 GB
    Memory Allocated: 0.0255889892578125  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

pseudo mini batch 8 input nodes size: 36890
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1591796875 GB
    Memory Allocated: 0.023442745208740234  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1591796875 GB
    Memory Allocated: 0.023442745208740234  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1591796875 GB
    Memory Allocated: 0.041033267974853516  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1591796875 GB
    Memory Allocated: 0.041075706481933594  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1591796875 GB
    Memory Allocated: 0.019530296325683594  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1591796875 GB
    Memory Allocated: 0.02053546905517578  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1591796875 GB
    Memory Allocated: 0.02053546905517578  GigaBytes
Max Memory Allocated: 1.025804042816162  GigaBytes

input nodes number: 36890
output nodes number: 5665
edges number: 134837
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.9980096817016602  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.9980101585388184  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.021888256072998047  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 9 input nodes size: 32271
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.01953887939453125  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.01953887939453125  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0349268913269043  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03496837615966797  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.01733541488647461  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.017985820770263672  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.017985820770263672  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 32271
output nodes number: 5514
edges number: 87170
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.6537861824035645  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.6537866592407227  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.018917083740234375  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.019977569580078125  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.019977569580078125  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014090251922607423 |0.04188988208770752 |0.5865389347076416 |0.00016646385192871095 |1.0039294481277465 |0.004987239837646484 |
----------------------------------------------------------pseudo_mini_loss sum 3.8378281593322754
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  301522
Number of first layer input nodes during this epoch:  301522
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.019977092742919922  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031235218048095703
number of batches is  10
batch size is  9095
random selection method spend 0.007528543472290039
time for parepare:  0.027401447296142578
local_output_nid generation:  0.003960609436035156
local_in_edges_tensor generation:  0.013991355895996094
mini_batch_src_global generation:  0.004334449768066406
r_  generation:  0.04196047782897949
local_output_nid generation:  0.005458831787109375
local_in_edges_tensor generation:  0.004082441329956055
mini_batch_src_global generation:  0.004580020904541016
r_  generation:  0.04375147819519043
local_output_nid generation:  0.005379915237426758
local_in_edges_tensor generation:  0.002426624298095703
mini_batch_src_global generation:  0.003040313720703125
r_  generation:  0.04543757438659668
local_output_nid generation:  0.005091428756713867
local_in_edges_tensor generation:  0.0035657882690429688
mini_batch_src_global generation:  0.003193378448486328
r_  generation:  0.0435178279876709
local_output_nid generation:  0.004975557327270508
local_in_edges_tensor generation:  0.0028502941131591797
mini_batch_src_global generation:  0.003262042999267578
r_  generation:  0.04612374305725098
local_output_nid generation:  0.005141258239746094
local_in_edges_tensor generation:  0.0027992725372314453
mini_batch_src_global generation:  0.003474712371826172
r_  generation:  0.047629594802856445
local_output_nid generation:  0.005237102508544922
local_in_edges_tensor generation:  0.0024080276489257812
mini_batch_src_global generation:  0.012017011642456055
r_  generation:  0.08870840072631836
local_output_nid generation:  0.007010459899902344
local_in_edges_tensor generation:  0.0033516883850097656
mini_batch_src_global generation:  0.004528999328613281
r_  generation:  0.05739021301269531
local_output_nid generation:  0.005284547805786133
local_in_edges_tensor generation:  0.002788543701171875
mini_batch_src_global generation:  0.0034973621368408203
r_  generation:  0.04550933837890625
local_output_nid generation:  0.005046367645263672
local_in_edges_tensor generation:  0.0027098655700683594
mini_batch_src_global generation:  0.003545045852661133
r_  generation:  0.046428680419921875
----------------------check_connections_block total spend ----------------------------- 0.7833952903747559
generate_one_block  0.07664251327514648
generate_one_block  0.07008671760559082
generate_one_block  0.07149839401245117
generate_one_block  0.07191801071166992
generate_one_block  0.0737917423248291
generate_one_block  0.07216405868530273
generate_one_block  0.07022762298583984
generate_one_block  0.07255148887634277
generate_one_block  0.07119512557983398
generate_one_block  0.07178974151611328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.019977092742919922  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.8130686283111572
pseudo mini batch 0 input nodes size: 65171
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.018372535705566406  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.018372535705566406  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.049448490142822266  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.04951667785644531  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034087181091308594  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03484153747558594  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03484153747558594  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 65171
output nodes number: 9095
edges number: 101179
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7815256118774414  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7815265655517578  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03671884536743164  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 1 input nodes size: 64760
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0346217155456543  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0346217155456543  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06550168991088867  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06556987762451172  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03442573547363281  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035167694091796875  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035167694091796875  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 64760
output nodes number: 9095
edges number: 99530
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7692756652832031  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7692761421203613  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03649473190307617  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 2 input nodes size: 65953
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03442573547363281  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03442573547363281  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06587457656860352  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06594276428222656  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03499460220336914  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03575563430786133  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03575563430786133  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 65953
output nodes number: 9095
edges number: 102055
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7881431579589844  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7881436347961426  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03711080551147461  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 3 input nodes size: 64875
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03499460220336914  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03499460220336914  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06592941284179688  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06599760055541992  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03448057174682617  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035230159759521484  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035230159759521484  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 64875
output nodes number: 9095
edges number: 100509
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7754621505737305  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7754626274108887  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03656578063964844  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 4 input nodes size: 65551
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03448057174682617  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03448057174682617  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06573772430419922  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06580591201782227  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034802913665771484  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0355525016784668  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0355525016784668  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 65551
output nodes number: 9095
edges number: 100485
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.777958869934082  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7779593467712402  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.036893367767333984  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 5 input nodes size: 65454
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034802913665771484  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034802913665771484  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06601381301879883  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06608200073242188  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03475666046142578  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03552055358886719  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03552055358886719  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 65454
output nodes number: 9095
edges number: 102525
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7900419235229492  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7900424003601074  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03687477111816406  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 6 input nodes size: 64790
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03475666046142578  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03475666046142578  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06565093994140625  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0657191276550293  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034440040588378906  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03518104553222656  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03518104553222656  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 64790
output nodes number: 9095
edges number: 99409
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7687397003173828  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.768740177154541  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.036507606506347656  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 7 input nodes size: 65823
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034440040588378906  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034440040588378906  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0658268928527832  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06589508056640625  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034932613372802734  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03570222854614258  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03570222854614258  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 65823
output nodes number: 9095
edges number: 103226
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7950968742370605  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7950973510742188  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03706502914428711  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 8 input nodes size: 64636
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034932613372802734  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034932613372802734  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06575345993041992  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06582164764404297  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034366607666015625  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035111427307128906  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035111427307128906  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 64636
output nodes number: 9095
edges number: 99889
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7727823257446289  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7727828025817871  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.036440372467041016  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 9 input nodes size: 64950
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034366607666015625  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034366607666015625  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0653371810913086  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06540489196777344  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0345158576965332  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03526163101196289  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03526163101196289  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 64950
output nodes number: 9086
edges number: 100000
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.774080753326416  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7740812301635742  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.036591529846191406  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.036591529846191406  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.036591529846191406  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016151165962219237 |0.001569366455078125 |0.5594947576522827 |0.0001266002655029297 |1.040979552268982 |0.004738807678222656 |
----------------------------------------------------------pseudo_mini_loss sum 3.2670416831970215
Total (block generation + training)time/epoch 18.121350288391113
Training time/epoch 16.308025598526
Training time without block to device /epoch 16.29233193397522
Training time without total dataloading part /epoch 16.0107479095459
load block tensor time/epoch 0.16151165962219238
block to device time/epoch 0.01569366455078125
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  651963
Number of first layer input nodes during this epoch:  651963
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0365910530090332  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03413820266723633
number of batches is  10
batch size is  9095
random selection method spend 0.006730556488037109
time for parepare:  0.0256497859954834
local_output_nid generation:  0.00423121452331543
local_in_edges_tensor generation:  0.014081239700317383
mini_batch_src_global generation:  0.004446983337402344
r_  generation:  0.04498910903930664
local_output_nid generation:  0.005621671676635742
local_in_edges_tensor generation:  0.0041811466217041016
mini_batch_src_global generation:  0.00489044189453125
r_  generation:  0.045606136322021484
local_output_nid generation:  0.0058252811431884766
local_in_edges_tensor generation:  0.003180980682373047
mini_batch_src_global generation:  0.0032320022583007812
r_  generation:  0.047477006912231445
local_output_nid generation:  0.005525350570678711
local_in_edges_tensor generation:  0.0036470890045166016
mini_batch_src_global generation:  0.0033826828002929688
r_  generation:  0.046834468841552734
local_output_nid generation:  0.005532979965209961
local_in_edges_tensor generation:  0.0032160282135009766
mini_batch_src_global generation:  0.003456592559814453
r_  generation:  0.04861593246459961
local_output_nid generation:  0.005639791488647461
local_in_edges_tensor generation:  0.0033996105194091797
mini_batch_src_global generation:  0.0036382675170898438
r_  generation:  0.047235727310180664
local_output_nid generation:  0.0058748722076416016
local_in_edges_tensor generation:  0.003284454345703125
mini_batch_src_global generation:  0.003484010696411133
r_  generation:  0.045980215072631836
local_output_nid generation:  0.005527973175048828
local_in_edges_tensor generation:  0.0033457279205322266
mini_batch_src_global generation:  0.0036461353302001953
r_  generation:  0.047109127044677734
local_output_nid generation:  0.005515575408935547
local_in_edges_tensor generation:  0.0032806396484375
mini_batch_src_global generation:  0.003751516342163086
r_  generation:  0.04767894744873047
local_output_nid generation:  0.005745410919189453
local_in_edges_tensor generation:  0.0031080245971679688
mini_batch_src_global generation:  0.003533601760864258
r_  generation:  0.04707026481628418
----------------------check_connections_block total spend ----------------------------- 0.7293517589569092
generate_one_block  0.07827138900756836
generate_one_block  0.07176613807678223
generate_one_block  0.07278585433959961
generate_one_block  0.07289433479309082
generate_one_block  0.07252311706542969
generate_one_block  0.07093477249145508
generate_one_block  0.07061028480529785
generate_one_block  0.0725257396697998
generate_one_block  0.07491850852966309
generate_one_block  0.07156729698181152
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0365910530090332  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 1.8037259578704834
pseudo mini batch 0 input nodes size: 65639
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03451347351074219  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03451347351074219  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06581258773803711  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06588077545166016  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034842491149902344  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03559589385986328  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03559589385986328  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 65639
output nodes number: 9095
edges number: 101050
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7813119888305664  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7813129425048828  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03694343566894531  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 1 input nodes size: 65401
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03484487533569336  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03484487533569336  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06603050231933594  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06609869003295898  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034731388092041016  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03547334671020508  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03547334671020508  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 65401
output nodes number: 9095
edges number: 99501
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.769902229309082  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7699027061462402  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.036805152893066406  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 2 input nodes size: 64644
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034731388092041016  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034731388092041016  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06555604934692383  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06562423706054688  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03437042236328125  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03511810302734375  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03511810302734375  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 64644
output nodes number: 9095
edges number: 100337
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7768888473510742  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7768893241882324  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03645038604736328  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 3 input nodes size: 65972
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03437042236328125  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03437042236328125  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06582832336425781  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06589651107788086  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035003662109375  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035765647888183594  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035765647888183594  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 65972
output nodes number: 9095
edges number: 102250
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7894110679626465  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7894115447998047  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03712177276611328  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 4 input nodes size: 65856
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035003662109375  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035003662109375  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06640625  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06647443771362305  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03494834899902344  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03571319580078125  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03571319580078125  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 65856
output nodes number: 9095
edges number: 102656
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7928504943847656  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7928509712219238  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03758811950683594  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 5 input nodes size: 64553
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035465240478515625  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035465240478515625  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06624650955200195  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.066314697265625  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03484392166137695  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03558015823364258  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03558015823364258  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 64553
output nodes number: 9095
edges number: 98723
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7628898620605469  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7628903388977051  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03638315200805664  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 6 input nodes size: 64271
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034327030181884766  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034327030181884766  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06497383117675781  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06504201889038086  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034192562103271484  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0349278450012207  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0349278450012207  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 64271
output nodes number: 9095
edges number: 98605
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7614479064941406  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7614483833312988  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.036244869232177734  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 7 input nodes size: 65244
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034192562103271484  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034192562103271484  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06530332565307617  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06537151336669922  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034656524658203125  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035414695739746094  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035414695739746094  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 65244
output nodes number: 9095
edges number: 101701
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7862162590026855  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7862167358398438  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03676176071166992  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 8 input nodes size: 65990
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034656524658203125  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.034656524658203125  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06612300872802734  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes
Using backend: pytorch

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06619119644165039  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035012245178222656  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035788536071777344  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035788536071777344  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 65990
output nodes number: 9095
edges number: 104119
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.8035931587219238  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.803593635559082  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03715944290161133  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

pseudo mini batch 9 input nodes size: 64558
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035012245178222656  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.035012245178222656  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.0657958984375  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.06586360931396484  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03432893753051758  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03507375717163086  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03507375717163086  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

input nodes number: 64558
output nodes number: 9086
edges number: 99865
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7718510627746582  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.7718515396118164  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03639984130859375  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03639984130859375  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.3603515625 GB
    Memory Allocated: 0.03639984130859375  GigaBytes
Max Memory Allocated: 1.078683853149414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015733623504638673 |0.0016160249710083009 |0.5561744213104248 |0.00012536048889160155 |1.0375506639480592 |0.0037746429443359375 |
----------------------------------------------------------pseudo_mini_loss sum 3.1724460124969482
Total (block generation + training)time/epoch 18.07144296169281
Training time/epoch 16.226936101913452
Training time without block to device /epoch 16.21077585220337
Training time without total dataloading part /epoch 15.94227910041809
load block tensor time/epoch 0.15733623504638672
block to device time/epoch 0.016160249710083008
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  652128
Number of first layer input nodes during this epoch:  652128
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
