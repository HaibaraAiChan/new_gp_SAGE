[03:20:21] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14364480 edges into 8 parts and get 1753236 edge cuts
main start at this time 1652844008.704323
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031905412673950195
global_2_local spend time (sec) 0.03344273567199707
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0033884048461914062
A = g.adjacency_matrix() spent  0.006882190704345703
auxiliary_graph
Graph(num_nodes=145054, num_edges=14455421,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07214093208312988
remove nodes length
54113
auxiliary_graph.remove_nodes spent  0.6433219909667969
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14455421,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6034011840820312

the counter of shared neighbor distribution
Counter({1.0: 12983840, 2.0: 1168162, 3.0: 166454, 4.0: 33624, 5.0: 8820, 6.0: 2638, 7.0: 736, 8.0: 176, 9.0: 24, 10.0: 6})
14364480
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14364477, 14364478, 14364479])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12983840, 2.0: 1168162, 3.0: 166454, 4.0: 33624, 5.0: 8820, 6.0: 2638, 7.0: 736, 8.0: 176, 9.0: 24, 10.0: 6})
Convert a graph into a bidirected graph: 0.678 seconds
Metis partitioning: 2.620 seconds
Split the graph: 0.839 seconds
Construct subgraphs: 0.084 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.228702783584595
11423
11347
11568
11555
11332
11241
11411
11064
total k batches seeds list generation spend  9.299558639526367
after graph partition
graph partition algorithm spend time 9.36947226524353
11423
11347
11568
11555
11332
11241
11411
11064
partition_len_list
[18837, 19577, 22835, 18901, 22729, 27257, 32756, 37106]
shared_neighbor_graph_partition_s0 selection method  spend 9.45097303390503
time for parepare:  0.015791654586791992
local_output_nid generation:  0.0018658638000488281
local_in_edges_tensor generation:  0.002170085906982422
mini_batch_src_global generation:  0.0024003982543945312
r_  generation:  0.023346900939941406
local_output_nid generation:  0.0022389888763427734
local_in_edges_tensor generation:  0.0019555091857910156
mini_batch_src_global generation:  0.0024347305297851562
r_  generation:  0.02309250831604004
local_output_nid generation:  0.002241849899291992
local_in_edges_tensor generation:  0.0027959346771240234
mini_batch_src_global generation:  0.0023021697998046875
r_  generation:  0.025237560272216797
local_output_nid generation:  0.0023157596588134766
local_in_edges_tensor generation:  0.0022416114807128906
mini_batch_src_global generation:  0.0019915103912353516
r_  generation:  0.02163553237915039
local_output_nid generation:  0.00231170654296875
local_in_edges_tensor generation:  0.0018925666809082031
mini_batch_src_global generation:  0.0017125606536865234
r_  generation:  0.02085590362548828
local_output_nid generation:  0.0022525787353515625
local_in_edges_tensor generation:  0.0021970272064208984
mini_batch_src_global generation:  0.0034682750701904297
r_  generation:  0.024135112762451172
local_output_nid generation:  0.002299070358276367
local_in_edges_tensor generation:  0.0032629966735839844
mini_batch_src_global generation:  0.004716396331787109
r_  generation:  0.02879786491394043
local_output_nid generation:  0.002447843551635742
local_in_edges_tensor generation:  0.001972675323486328
mini_batch_src_global generation:  0.0024938583374023438
r_  generation:  0.026279687881469727
----------------------check_connections_block total spend ----------------------------- 0.31441569328308105
generate_one_block  0.03619027137756348
generate_one_block  0.030004024505615234
generate_one_block  0.029723644256591797
generate_one_block  0.026111125946044922
generate_one_block  0.025942325592041016
generate_one_block  0.027480363845825195
generate_one_block  0.03775668144226074
generate_one_block  0.03970503807067871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0.31441569328308105
block generation total time  0.2529134750366211
average batch blocks generation time:  0.03161418437957764
pseudo mini batch 0 input nodes size: 18837
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00951242446899414  GigaBytes
Max Memory Allocated: 0.00951242446899414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0095977783203125  GigaBytes
Max Memory Allocated: 0.0095977783203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0095977783203125  GigaBytes
Max Memory Allocated: 0.0095977783203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.010101318359375  GigaBytes
Max Memory Allocated: 0.010101318359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.010101318359375  GigaBytes
Max Memory Allocated: 0.010101318359375  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.010101318359375  GigaBytes
Max Memory Allocated: 0.010101318359375  GigaBytes

m.shape torch.Size([1360, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2381591796875 GB
    Memory Allocated: 0.043856143951416016  GigaBytes
Max Memory Allocated: 0.0441594123840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2381591796875 GB
    Memory Allocated: 0.043856143951416016  GigaBytes
Max Memory Allocated: 0.0441594123840332  GigaBytes

 h.shape torch.Size([1, 1360, 128]), torch.Size([1, 1360, 128])
----------------------------------------3
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.045153141021728516  GigaBytes
Max Memory Allocated: 0.045153141021728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.055529117584228516  GigaBytes
Max Memory Allocated: 0.056177616119384766  GigaBytes

rst.shape  torch.Size([1, 1360, 128])
m.shape torch.Size([1353, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.05617094039916992  GigaBytes
Max Memory Allocated: 0.056201934814453125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.05617094039916992  GigaBytes
Max Memory Allocated: 0.056201934814453125  GigaBytes

 h.shape torch.Size([1, 1353, 128]), torch.Size([1, 1353, 128])
----------------------------------------3
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.05746126174926758  GigaBytes
Max Memory Allocated: 0.05746126174926758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.07681608200073242  GigaBytes
Max Memory Allocated: 0.0782928466796875  GigaBytes

rst.shape  torch.Size([1, 1353, 128])
m.shape torch.Size([1119, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.07777166366577148  GigaBytes
Max Memory Allocated: 0.0782928466796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.07777166366577148  GigaBytes
Max Memory Allocated: 0.0782928466796875  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.07883882522583008  GigaBytes
Max Memory Allocated: 0.07883882522583008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.10262870788574219  GigaBytes
Max Memory Allocated: 0.10508537292480469  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([976, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.10455179214477539  GigaBytes
Max Memory Allocated: 0.10508537292480469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.10455179214477539  GigaBytes
Max Memory Allocated: 0.10508537292480469  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.10548257827758789  GigaBytes
Max Memory Allocated: 0.10548257827758789  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.1333909034729004  GigaBytes
Max Memory Allocated: 0.1352524757385254  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([802, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.13483762741088867  GigaBytes
Max Memory Allocated: 0.1352524757385254  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.13483762741088867  GigaBytes
Max Memory Allocated: 0.1352524757385254  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.13560247421264648  GigaBytes
Max Memory Allocated: 0.13560247421264648  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.16326570510864258  GigaBytes
Max Memory Allocated: 0.1651778221130371  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([707, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.16490602493286133  GigaBytes
Max Memory Allocated: 0.1651778221130371  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.16490602493286133  GigaBytes
Max Memory Allocated: 0.1651778221130371  GigaBytes

 h.shape torch.Size([1, 707, 128]), torch.Size([1, 707, 128])
----------------------------------------3
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.16558027267456055  GigaBytes
Max Memory Allocated: 0.16558027267456055  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.19494056701660156  GigaBytes
Max Memory Allocated: 0.19696331024169922  GigaBytes

rst.shape  torch.Size([1, 707, 128])
m.shape torch.Size([561, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.19647598266601562  GigaBytes
Max Memory Allocated: 0.19696331024169922  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.19647598266601562  GigaBytes
Max Memory Allocated: 0.19696331024169922  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.19701099395751953  GigaBytes
Max Memory Allocated: 0.19701099395751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.2247176170349121  GigaBytes
Max Memory Allocated: 0.22659015655517578  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([528, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.22646427154541016  GigaBytes
Max Memory Allocated: 0.22659015655517578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.22646427154541016  GigaBytes
Max Memory Allocated: 0.22659015655517578  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.22696781158447266  GigaBytes
Max Memory Allocated: 0.22696781158447266  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.2560310363769531  GigaBytes
Max Memory Allocated: 0.2580451965332031  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([438, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.2576589584350586  GigaBytes
Max Memory Allocated: 0.2580451965332031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.2576589584350586  GigaBytes
Max Memory Allocated: 0.2580451965332031  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.25807666778564453  GigaBytes
Max Memory Allocated: 0.25807666778564453  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.28481006622314453  GigaBytes
Max Memory Allocated: 0.28668975830078125  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([3579, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4979248046875 GB
    Memory Allocated: 0.30217933654785156  GigaBytes
Max Memory Allocated: 0.3025798797607422  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4979248046875 GB
    Memory Allocated: 0.30217933654785156  GigaBytes
Max Memory Allocated: 0.3025798797607422  GigaBytes

 h.shape torch.Size([1, 1789, 128]), torch.Size([1, 1789, 128])
----------------------------------------3
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.30388545989990234  GigaBytes
Max Memory Allocated: 0.30388545989990234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.4253854751586914  GigaBytes
Max Memory Allocated: 0.4339160919189453  GigaBytes

rst 0 shape torch.Size([1, 1789, 128])
----------------------------------------1
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.4253854751586914  GigaBytes
Max Memory Allocated: 0.4339160919189453  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.4253854751586914  GigaBytes
Max Memory Allocated: 0.4339160919189453  GigaBytes

 h.shape torch.Size([1, 1790, 128]), torch.Size([1, 1790, 128])
----------------------------------------3
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.4270925521850586  GigaBytes
Max Memory Allocated: 0.4339160919189453  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7791748046875 GB
    Memory Allocated: 0.5474419593811035  GigaBytes
Max Memory Allocated: 0.5568304061889648  GigaBytes

rst 1 shape torch.Size([1, 1790, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.519646167755127  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.5221066474914551  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.5245671272277832  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.5220212936401367  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

torch.Size([11423, 40])
input nodes number: 18837
output nodes number: 11423
edges number: 67462
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.5247077941894531  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.5247087478637695  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.013865470886230469  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

pseudo mini batch 1 input nodes size: 19577
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.012589454650878906  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.012589454650878906  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.021924495697021484  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.02200937271118164  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.012941837310791016  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.01342630386352539  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.01342630386352539  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.01342630386352539  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

m.shape torch.Size([1572, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.04608869552612305  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.04608869552612305  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1572, 128]), torch.Size([1, 1572, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.04758787155151367  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.05958127975463867  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1572, 128])
m.shape torch.Size([1400, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.061036109924316406  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.061036109924316406  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1400, 128]), torch.Size([1, 1400, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.062371253967285156  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.0834345817565918  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1400, 128])
m.shape torch.Size([1192, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.0844721794128418  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.0844721794128418  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1192, 128]), torch.Size([1, 1192, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.08560895919799805  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.11061811447143555  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1192, 128])
m.shape torch.Size([921, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.11228132247924805  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.11228132247924805  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.1131596565246582  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.13904523849487305  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([768, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.14043712615966797  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.14043712615966797  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.14116954803466797  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.1676645278930664  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([618, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.1690664291381836  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.1690664291381836  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.16965579986572266  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.19503402709960938  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([548, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.19656848907470703  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.19656848907470703  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.19709110260009766  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.22409343719482422  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([435, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.22549152374267578  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.22549152374267578  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.2259063720703125  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.24955272674560547  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([417, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25113487243652344  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25113487243652344  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.25153255462646484  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.27698421478271484  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 417, 128])
m.shape torch.Size([3476, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.29336023330688477  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.29336023330688477  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1738, 128]), torch.Size([1, 1738, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.29501771926879883  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.41343116760253906  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst 0 shape torch.Size([1, 1738, 128])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.41343116760253906  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.41343116760253906  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1738, 128]), torch.Size([1, 1738, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.4150886535644531  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5319414138793945  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst 1 shape torch.Size([1, 1738, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5053071975708008  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5069980621337891  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5086889266967773  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5069131851196289  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

torch.Size([11347, 40])
input nodes number: 19577
output nodes number: 11347
edges number: 65009
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5063743591308594  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5063748359680176  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.013414382934570312  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

pseudo mini batch 2 input nodes size: 22835
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.012172222137451172  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.012172222137451172  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.02306079864501953  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.023147106170654297  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.013727188110351562  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.014214515686035156  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.014214515686035156  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.014214515686035156  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

m.shape torch.Size([1715, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.047118186950683594  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.047118186950683594  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1715, 128]), torch.Size([1, 1715, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.04875373840332031  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.06183815002441406  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1715, 128])
m.shape torch.Size([1431, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.0630645751953125  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.0630645751953125  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1431, 128]), torch.Size([1, 1431, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.06442928314208984  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.08501815795898438  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1431, 128])
m.shape torch.Size([1151, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.08675098419189453  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.08675098419189453  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1151, 128]), torch.Size([1, 1151, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.08784866333007812  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.11289787292480469  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1151, 128])
m.shape torch.Size([982, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.11422204971313477  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.11422204971313477  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 982, 128]), torch.Size([1, 982, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.1151585578918457  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.1423172950744629  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 982, 128])
m.shape torch.Size([795, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.14374446868896484  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.14374446868896484  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.1445026397705078  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.17198753356933594  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([618, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.17337656021118164  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.17337656021118164  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.1739659309387207  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.19994735717773438  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([546, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.2014751434326172  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.2014751434326172  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.201995849609375  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.22803592681884766  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([515, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.22974014282226562  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.22974014282226562  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.23023128509521484  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.25885772705078125  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([388, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.26027727127075195  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.26027727127075195  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.2606472969055176  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.2843289375305176  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([3427, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.30048513412475586  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.30048513412475586  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1713, 128]), torch.Size([1, 1713, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.30211877822875977  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.41863393783569336  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst 0 shape torch.Size([1, 1713, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.41863393783569336  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.41863393783569336  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1714, 128]), torch.Size([1, 1714, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.42026853561401367  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5355081558227539  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst 1 shape torch.Size([1, 1714, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.508824348449707  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5105481147766113  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5122718811035156  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5104618072509766  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

torch.Size([11568, 40])
input nodes number: 22835
output nodes number: 11568
edges number: 65345
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5107512474060059  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5107517242431641  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.015034675598144531  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

pseudo mini batch 3 input nodes size: 18901
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.013760089874267578  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.013760089874267578  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.022772789001464844  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.02285909652709961  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.011884212493896484  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.012306690216064453  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.012306690216064453  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.012306690216064453  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

m.shape torch.Size([1956, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.041124820709228516  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.041124820709228516  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1956, 128]), torch.Size([1, 1956, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.04299020767211914  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.05791330337524414  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1956, 128])
m.shape torch.Size([1782, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.05942821502685547  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.05942821502685547  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1782, 128]), torch.Size([1, 1782, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.061127662658691406  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.08707475662231445  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1782, 128])
m.shape torch.Size([1402, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.08823060989379883  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.08823060989379883  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1402, 128]), torch.Size([1, 1402, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.08956766128540039  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.11973905563354492  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1402, 128])
m.shape torch.Size([1078, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.12112665176391602  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.12112665176391602  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.12215471267700195  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.15257883071899414  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([942, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.1543107032775879  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.1543107032775879  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.15520906448364258  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.18755006790161133  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([713, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.18914079666137695  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.18914079666137695  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.1898207664489746  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.2191610336303711  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([605, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.2208404541015625  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.2208404541015625  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.22141742706298828  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.251284122467041  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([483, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.252838134765625  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.252838134765625  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.2532987594604492  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.2795543670654297  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([390, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.28099775314331055  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.28099775314331055  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.281369686126709  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.305173397064209  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([2204, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.31638669967651367  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.31638669967651367  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.31743764877319336  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.39389753341674805  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst 0 shape torch.Size([1, 1102, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.39389753341674805  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.39389753341674805  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.39494848251342773  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.4708828926086426  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst 1 shape torch.Size([1, 1102, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.4486203193664551  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.45034217834472656  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.4524083137512207  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.45060014724731445  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

torch.Size([11555, 40])
input nodes number: 18901
output nodes number: 11555
edges number: 56675
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.45082569122314453  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.45082616806030273  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.012998104095458984  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

pseudo mini batch 4 input nodes size: 22729
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.011882305145263672  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.011882305145263672  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.0227203369140625  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.022805213928222656  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.013706207275390625  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.014115333557128906  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.014115333557128906  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.014115333557128906  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

m.shape torch.Size([2047, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.0420994758605957  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.0420994758605957  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 2047, 128]), torch.Size([1, 2047, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.0440516471862793  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.05966901779174805  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 2047, 128])
m.shape torch.Size([1757, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.06036853790283203  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.06036853790283203  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1757, 128]), torch.Size([1, 1757, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.06204414367675781  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.08767843246459961  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1757, 128])
m.shape torch.Size([1386, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.08882331848144531  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.08882331848144531  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1386, 128]), torch.Size([1, 1386, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.09014511108398438  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.11922454833984375  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1386, 128])
m.shape torch.Size([1054, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.1208181381225586  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.1208181381225586  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.12182331085205078  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.15125560760498047  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([908, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.15291786193847656  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.15291786193847656  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.15378379821777344  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.18500518798828125  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([654, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.18644332885742188  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.18644332885742188  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.18706703186035156  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.21434593200683594  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([506, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.21572303771972656  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.21572303771972656  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.21620559692382812  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.24033355712890625  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([443, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.24178218841552734  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.24178218841552734  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.2422046661376953  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.26628589630126953  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([373, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.26767539978027344  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.26767539978027344  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.26803112030029297  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.29079723358154297  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([2204, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.3011288642883301  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.3011288642883301  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.30217981338500977  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.37863969802856445  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst 0 shape torch.Size([1, 1102, 128])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.37863969802856445  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.37863969802856445  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.37969064712524414  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.4562392234802246  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst 1 shape torch.Size([1, 1102, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.43473052978515625  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.43680810928344727  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.43849706649780273  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.43633460998535156  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

torch.Size([11332, 40])
input nodes number: 22729
output nodes number: 11332
edges number: 54882
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.436556339263916  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.4365568161010742  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.014788627624511719  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

pseudo mini batch 5 input nodes size: 27257
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.01367330551147461  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.01367330551147461  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.026670455932617188  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.026754379272460938  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.015831470489501953  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.01624441146850586  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.01624441146850586  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.01624441146850586  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

m.shape torch.Size([2116, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.04451894760131836  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.04451894760131836  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 2116, 128]), torch.Size([1, 2116, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.046536922454833984  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.06404685974121094  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 2116, 128])
m.shape torch.Size([1774, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.06505584716796875  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.06505584716796875  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1774, 128]), torch.Size([1, 1774, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.06674766540527344  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.09212493896484375  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1774, 128])
m.shape torch.Size([1267, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.09309148788452148  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.09309148788452148  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1267, 128]), torch.Size([1, 1267, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.0942997932434082  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.12108087539672852  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1267, 128])
m.shape torch.Size([970, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.12232685089111328  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.12232685089111328  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.12325191497802734  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.15007877349853516  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([812, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.1515522003173828  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.1515522003173828  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.1523265838623047  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.1802825927734375  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([615, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.1816549301147461  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.1816549301147461  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.18224143981933594  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.20749187469482422  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([473, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.20877742767333984  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.20877742767333984  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.209228515625  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.2317829132080078  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([400, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.23308324813842773  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.23308324813842773  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.23346471786499023  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.25520849227905273  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 400, 128])
m.shape torch.Size([326, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.2573680877685547  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.2573680877685547  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.2576789855957031  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.2775764465332031  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([2488, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.28928470611572266  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.28928470611572266  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1244, 128]), torch.Size([1, 1244, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.29047107696533203  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.37690067291259766  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst 0 shape torch.Size([1, 1244, 128])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.37690067291259766  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.37690067291259766  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1244, 128]), torch.Size([1, 1244, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.37808704376220703  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.46392345428466797  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst 1 shape torch.Size([1, 1244, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.44156742095947266  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.44324254989624023  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.4449176788330078  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.4431586265563965  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

torch.Size([11241, 40])
input nodes number: 27257
output nodes number: 11241
edges number: 55420
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.4434318542480469  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.4434323310852051  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.01697254180908203  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

pseudo mini batch 6 input nodes size: 32756
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.015817642211914062  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.015817642211914062  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.031436920166015625  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.031522274017333984  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.018441200256347656  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.019021034240722656  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.019021034240722656  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.019021034240722656  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

m.shape torch.Size([1256, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.05774497985839844  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.05774497985839844  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1256, 128]), torch.Size([1, 1256, 128])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.05894279479980469  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.06852531433105469  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1256, 128])
m.shape torch.Size([1048, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.06965875625610352  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.06965875625610352  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 1048, 128]), torch.Size([1, 1048, 128])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.07065820693969727  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.08659124374389648  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 1048, 128])
m.shape torch.Size([847, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.08805036544799805  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.08805036544799805  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.08885812759399414  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.1066288948059082  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([646, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.10745716094970703  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.10745716094970703  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.10807323455810547  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.12593936920166016  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([577, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.12700700759887695  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.12700700759887695  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.12755727767944336  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.14736700057983398  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([470, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.1484365463256836  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.1484365463256836  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.14888477325439453  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.16815853118896484  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([395, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.16925287246704102  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.16925287246704102  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.16962957382202148  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.18846464157104492  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([316, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.18973684310913086  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.18973684310913086  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.19003820419311523  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2072157859802246  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([329, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.20847702026367188  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.20847702026367188  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.20879077911376953  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.22887134552001953  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([5527, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2550692558288574  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2550692558288574  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 2763, 128]), torch.Size([1, 2763, 128])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2577042579650879  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.4450502395629883  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

rst 0 shape torch.Size([1, 2763, 128])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.4450502395629883  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.4450502395629883  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

 h.shape torch.Size([1, 2764, 128]), torch.Size([1, 2764, 128])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.44768619537353516  GigaBytes
Max Memory Allocated: 0.5637502670288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9041748046875 GB
    Memory Allocated: 0.633521556854248  GigaBytes
Max Memory Allocated: 0.6480188369750977  GigaBytes

rst 1 shape torch.Size([1, 2764, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6003131866455078  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6029486656188965  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6049695014953613  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6022486686706543  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

torch.Size([11411, 40])
input nodes number: 32756
output nodes number: 11411
edges number: 77706
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6026034355163574  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6026039123535156  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.019998550415039062  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

pseudo mini batch 7 input nodes size: 37106
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.018466472625732422  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.018466472625732422  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.03615999221801758  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.03624248504638672  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.020537853240966797  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.021067142486572266  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.021067142486572266  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.021067142486572266  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

m.shape torch.Size([1406, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.056500911712646484  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.056500911712646484  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1406, 128]), torch.Size([1, 1406, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.05784177780151367  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06918144226074219  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1406, 128])
m.shape torch.Size([1161, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.07034873962402344  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.07034873962402344  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1161, 128]), torch.Size([1, 1161, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.0714559555053711  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08806419372558594  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1161, 128])
m.shape torch.Size([913, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08909940719604492  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08909940719604492  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 913, 128]), torch.Size([1, 913, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08997011184692383  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.11036443710327148  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 913, 128])
m.shape torch.Size([693, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1112508773803711  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1112508773803711  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.11191177368164062  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1316843032836914  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([618, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1328272819519043  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1328272819519043  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.13341665267944336  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.15501070022583008  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([473, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.15606927871704102  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.15606927871704102  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.15652036666870117  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1759171485900879  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([411, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1770634651184082  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1770634651184082  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.17745542526245117  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1970534324645996  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([352, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.19820022583007812  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.19820022583007812  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.19853591918945312  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.21767044067382812  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([315, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.21885442733764648  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.21885442733764648  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 315, 128]), torch.Size([1, 315, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.21915483474731445  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.23838090896606445  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 315, 128])
m.shape torch.Size([4722, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.26074695587158203  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.26074695587158203  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 2361, 128]), torch.Size([1, 2361, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2629985809326172  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.42676734924316406  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst 0 shape torch.Size([1, 2361, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.42676734924316406  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.42676734924316406  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 2361, 128]), torch.Size([1, 2361, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4290189743041992  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5908980369567871  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst 1 shape torch.Size([1, 2361, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5610203742980957  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5632719993591309  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5653271675109863  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.562993049621582  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

torch.Size([11064, 40])
input nodes number: 37106
output nodes number: 11064
edges number: 70915
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.563300609588623  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5633010864257812  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.021945476531982422  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.023005962371826172  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.023005962371826172  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |[03:20:33] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14292522 edges into 8 parts and get 1760644 edge cuts

      |0.014268040657043457 |0.044218868017196655 |0.09434914588928223 |9.363889694213867e-05 |0.01835772395133972 |0.0034322738647460938 |
----------------------------------------------------------pseudo_mini_loss sum 3.837982654571533
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  199998
Number of first layer input nodes during this epoch:  199998
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.02300548553466797  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.015867948532104492
global_2_local spend time (sec) 0.03619837760925293
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0033898353576660156
A = g.adjacency_matrix() spent  0.005838632583618164
auxiliary_graph
Graph(num_nodes=145011, num_edges=14383463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07401919364929199
remove nodes length
54070
auxiliary_graph.remove_nodes spent  0.6457445621490479
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14383463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.5964634418487549

the counter of shared neighbor distribution
Counter({1.0: 12899386, 2.0: 1178670, 3.0: 168286, 4.0: 33534, 5.0: 8856, 6.0: 2754, 7.0: 796, 8.0: 198, 9.0: 40, 10.0: 2})
14292522
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14292519, 14292520, 14292521])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12899386, 2.0: 1178670, 3.0: 168286, 4.0: 33534, 5.0: 8856, 6.0: 2754, 7.0: 796, 8.0: 198, 9.0: 40, 10.0: 2})
Convert a graph into a bidirected graph: 0.615 seconds
Metis partitioning: 2.582 seconds
Split the graph: 0.841 seconds
Construct subgraphs: 0.038 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.082385778427124
11623
11597
11606
11298
11321
11038
11219
11239
total k batches seeds list generation spend  9.088123559951782
after graph partition
graph partition algorithm spend time 9.166997194290161
11623
11597
11606
11298
11321
11038
11219
11239
partition_len_list
[20656, 23186, 19200, 19717, 33312, 36350, 22714, 28132]
shared_neighbor_graph_partition_s0 selection method  spend 9.253988265991211
time for parepare:  0.016078948974609375
local_output_nid generation:  0.0021352767944335938
local_in_edges_tensor generation:  0.0021224021911621094
mini_batch_src_global generation:  0.0023970603942871094
r_  generation:  0.023763179779052734
local_output_nid generation:  0.002214193344116211
local_in_edges_tensor generation:  0.0020530223846435547
mini_batch_src_global generation:  0.0031719207763671875
r_  generation:  0.02401566505432129
local_output_nid generation:  0.0024721622467041016
local_in_edges_tensor generation:  0.0021162033081054688
mini_batch_src_global generation:  0.0021080970764160156
r_  generation:  0.023825645446777344
local_output_nid generation:  0.0024085044860839844
local_in_edges_tensor generation:  0.002049684524536133
mini_batch_src_global generation:  0.002089977264404297
r_  generation:  0.02324962615966797
local_output_nid generation:  0.0025548934936523438
local_in_edges_tensor generation:  0.0022728443145751953
mini_batch_src_global generation:  0.002521038055419922
r_  generation:  0.02797389030456543
local_output_nid generation:  0.002596616744995117
local_in_edges_tensor generation:  0.002435445785522461
mini_batch_src_global generation:  0.0024216175079345703
r_  generation:  0.04091191291809082
local_output_nid generation:  0.005144834518432617
local_in_edges_tensor generation:  0.002846240997314453
mini_batch_src_global generation:  0.0019683837890625
r_  generation:  0.020967483520507812
local_output_nid generation:  0.0041768550872802734
local_in_edges_tensor generation:  0.0024170875549316406
mini_batch_src_global generation:  0.0019805431365966797
r_  generation:  0.023250818252563477
----------------------check_connections_block total spend ----------------------------- 0.335615873336792
generate_one_block  0.04391622543334961
generate_one_block  0.04161190986633301
generate_one_block  0.03342843055725098
generate_one_block  0.041077613830566406
generate_one_block  0.04707002639770508
generate_one_block  0.03739571571350098
generate_one_block  0.02620077133178711
generate_one_block  0.02958059310913086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.02300548553466797  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

connection checking time:  0.335615873336792
block generation total time  0.300281286239624
average batch blocks generation time:  0.037535160779953
block dataloader generation time/epoch 9.951281070709229
pseudo mini batch 0 input nodes size: 20656
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.021545886993408203  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.021545886993408203  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.03139543533325195  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.03148221969604492  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.013706207275390625  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.014147758483886719  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.014147758483886719  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.014147758483886719  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

m.shape torch.Size([1923, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.04419994354248047  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.04419994354248047  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1923, 128]), torch.Size([1, 1923, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.04603385925292969  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06070518493652344  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1923, 128])
m.shape torch.Size([1667, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.0618433952331543  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.0618433952331543  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1667, 128]), torch.Size([1, 1667, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06343317031860352  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.0872797966003418  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1667, 128])
m.shape torch.Size([1343, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08879470825195312  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08879470825195312  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1343, 128]), torch.Size([1, 1343, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.09007549285888672  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.11861705780029297  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1343, 128])
m.shape torch.Size([1079, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.12003469467163086  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.12003469467163086  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1210637092590332  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.15090513229370117  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([885, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.15250062942504883  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.15250062942504883  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 885, 128]), torch.Size([1, 885, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.15334463119506836  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.18426990509033203  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 885, 128])
m.shape torch.Size([713, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.18588781356811523  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.18588781356811523  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1865677833557129  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.21669816970825195  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([587, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.21831750869750977  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.21831750869750977  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.21887731552124023  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.24773406982421875  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([509, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.24939584732055664  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.24939584732055664  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.24988126754760742  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.27755022048950195  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([406, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2790498733520508  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2790498733520508  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2794370651245117  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3042173385620117  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([2511, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3159971237182617  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3159971237182617  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1255, 128]), torch.Size([1, 1255, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.31719398498535156  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.40367603302001953  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst 0 shape torch.Size([1, 1255, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.40367603302001953  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.40367603302001953  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1256, 128]), torch.Size([1, 1256, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4048738479614258  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.49079465866088867  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst 1 shape torch.Size([1, 1256, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.46726131439208984  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4689936637878418  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4711337089538574  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4693145751953125  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

torch.Size([11623, 40])
input nodes number: 20656
output nodes number: 11623
edges number: 59250
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4696388244628906  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.46963977813720703  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.014957904815673828  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

pseudo mini batch 1 input nodes size: 23186
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.013790607452392578  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.013790607452392578  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.024846553802490234  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.024933338165283203  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.014997005462646484  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.015492916107177734  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.015492916107177734  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.015492916107177734  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

m.shape torch.Size([1580, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.04886007308959961  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.04886007308959961  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1580, 128]), torch.Size([1, 1580, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.050366878509521484  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06328010559082031  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1580, 128])
m.shape torch.Size([1437, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06405210494995117  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06405210494995117  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1437, 128]), torch.Size([1, 1437, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06542253494262695  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08669614791870117  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1437, 128])
m.shape torch.Size([1164, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.0876760482788086  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.0876760482788086  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1164, 128]), torch.Size([1, 1164, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08878612518310547  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.11320781707763672  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1164, 128])
m.shape torch.Size([970, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1145029067993164  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1145029067993164  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.11542797088623047  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.14225482940673828  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([824, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.14375686645507812  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.14375686645507812  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.14454269409179688  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1732635498046875  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([625, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.17511367797851562  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.17511367797851562  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.17570972442626953  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.20207786560058594  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([599, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2037792205810547  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2037792205810547  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.20435047149658203  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.23325777053833008  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([511, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.23492145538330078  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.23492145538330078  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.23540878295898438  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2631864547729492  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([414, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.26471948623657227  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.26471948623657227  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.26511430740356445  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.29038286209106445  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([3473, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3067460060119629  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3067460060119629  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1736, 128]), torch.Size([1, 1736, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.30840158462524414  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4259476661682129  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst 0 shape torch.Size([1, 1736, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4259476661682129  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4259476661682129  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1737, 128]), torch.Size([1, 1737, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.42760419845581055  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5443902015686035  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst 1 shape torch.Size([1, 1737, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5171909332275391  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5189194679260254  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5206480026245117  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5188326835632324  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

torch.Size([11597, 40])
input nodes number: 23186
output nodes number: 11597
edges number: 66433
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5190887451171875  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5190892219543457  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.016288280487060547  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

pseudo mini batch 2 input nodes size: 19200
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.01499319076538086  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.01499319076538086  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.02414846420288086  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.024235248565673828  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.013092517852783203  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.01358652114868164  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.01358652114868164  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.01358652114868164  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

m.shape torch.Size([1496, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.04681110382080078  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.04681110382080078  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1496, 128]), torch.Size([1, 1496, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.04823780059814453  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.05965137481689453  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1496, 128])
m.shape torch.Size([1435, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06056356430053711  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06056356430053711  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1435, 128]), torch.Size([1, 1435, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06193208694458008  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08245992660522461  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1435, 128])
m.shape torch.Size([1197, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08348798751831055  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08348798751831055  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1197, 128]), torch.Size([1, 1197, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08462953567504883  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.10974359512329102  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1197, 128])
m.shape torch.Size([1018, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.111114501953125  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.111114501953125  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1018, 128]), torch.Size([1, 1018, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.11208534240722656  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.14023971557617188  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1018, 128])
m.shape torch.Size([848, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.14177608489990234  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.14177608489990234  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.14258480072021484  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.17258930206298828  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([726, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.17426204681396484  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.17426204681396484  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 726, 128]), torch.Size([1, 726, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.17495441436767578  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.20556354522705078  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 726, 128])
m.shape torch.Size([619, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.20728349685668945  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.20728349685668945  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.20787382125854492  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2385416030883789  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([487, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.24010419845581055  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.24010419845581055  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2405686378479004  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2670416831970215  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([431, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2686591148376465  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2686591148376465  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2690701484680176  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2953763008117676  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([3349, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3111400604248047  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.3111400604248047  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1674, 128]), torch.Size([1, 1674, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.31273651123046875  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4279489517211914  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst 0 shape torch.Size([1, 1674, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4279489517211914  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4279489517211914  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1675, 128]), torch.Size([1, 1675, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4295463562011719  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5439853668212891  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst 1 shape torch.Size([1, 1675, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5169205665588379  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5186500549316406  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5204777717590332  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5186614990234375  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

torch.Size([11606, 40])
input nodes number: 19200
output nodes number: 11606
edges number: 66223
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5188922882080078  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.518892765045166  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.014354705810546875  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

pseudo mini batch 3 input nodes size: 19717
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.01309347152709961  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.01309347152709961  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.02346944808959961  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.023553848266601562  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.014311790466308594  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.014800071716308594  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.014800071716308594  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.014800071716308594  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

m.shape torch.Size([1533, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.04766988754272461  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.04766988754272461  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1533, 128]), torch.Size([1, 1533, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.04913187026977539  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06121110916137695  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1533, 128])
m.shape torch.Size([1364, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06230783462524414  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06230783462524414  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1364, 128]), torch.Size([1, 1364, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.06360864639282227  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08348512649536133  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1364, 128])
m.shape torch.Size([1177, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08481550216674805  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.08481550216674805  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1177, 128]), torch.Size([1, 1177, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.0859379768371582  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.11063241958618164  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1177, 128])
m.shape torch.Size([886, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.11193466186523438  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.11193466186523438  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 886, 128]), torch.Size([1, 886, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.11277961730957031  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1372833251953125  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 886, 128])
m.shape torch.Size([762, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.13867759704589844  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.13867759704589844  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 762, 128]), torch.Size([1, 762, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.139404296875  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.16641521453857422  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 762, 128])
m.shape torch.Size([622, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1678314208984375  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1678314208984375  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1684246063232422  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.19439125061035156  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([539, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1958937644958496  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.1958937644958496  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.19640779495239258  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2225208282470703  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([461, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.22402238845825195  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.22402238845825195  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.22446203231811523  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.24952173233032227  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([401, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2510228157043457  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2510228157043457  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 401, 128]), torch.Size([1, 401, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2514052391052246  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2758803367614746  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 401, 128])
m.shape torch.Size([3553, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2926311492919922  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2926311492919922  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1776, 128]), torch.Size([1, 1776, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.2943248748779297  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4145793914794922  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst 0 shape torch.Size([1, 1776, 128])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4145793914794922  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4145793914794922  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1777, 128]), torch.Size([1, 1777, 128])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.4162740707397461  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5357494354248047  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst 1 shape torch.Size([1, 1777, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.50885009765625  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5113520622253418  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5139365196228027  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.511350154876709  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

torch.Size([11298, 40])
input nodes number: 19717
output nodes number: 11298
edges number: 65478
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.5123543739318848  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.512354850769043  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.016335010528564453  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

pseudo mini batch 4 input nodes size: 33312
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.015084266662597656  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.015084266662597656  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.030968666076660156  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.03105306625366211  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.020592689514160156  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.02118682861328125  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.02118682861328125  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.02118682861328125  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

m.shape torch.Size([1117, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.060713768005371094  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.060713768005371094  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.061779022216796875  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.07030105590820312  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([933, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.07065820693969727  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.07065820693969727  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 933, 128]), torch.Size([1, 933, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.0715479850769043  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.0854039192199707  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 933, 128])
m.shape torch.Size([811, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.08611917495727539  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.08611917495727539  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.08689260482788086  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.10390806198120117  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([628, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.10471916198730469  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.10471916198730469  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 628, 128]), torch.Size([1, 628, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.10531806945800781  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.12354230880737305  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 628, 128])
m.shape torch.Size([535, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.12451839447021484  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.12451839447021484  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1250286102294922  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14374780654907227  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([446, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14476871490478516  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14476871490478516  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14519405364990234  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1634836196899414  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([389, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.16456937789916992  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.16456937789916992  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 389, 128]), torch.Size([1, 389, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.16494035720825195  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.18348932266235352  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 389, 128])
m.shape torch.Size([330, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.18456268310546875  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.18456268310546875  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1848773956298828  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.20281600952148438  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 330, 128])
m.shape torch.Size([333, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2040877342224121  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2040877342224121  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 333, 128]), torch.Size([1, 333, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2044053077697754  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2247300148010254  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst.shape  torch.Size([1, 333, 128])
m.shape torch.Size([5799, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.25222301483154297  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.25222301483154297  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 2899, 128]), torch.Size([1, 2899, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2549877166748047  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.453122615814209  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

rst 0 shape torch.Size([1, 2899, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.453122615814209  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.453122615814209  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

 h.shape torch.Size([1, 2900, 128]), torch.Size([1, 2900, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.4558882713317871  GigaBytes
Max Memory Allocated: 0.6486086845397949  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.6525864601135254  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 1 shape torch.Size([1, 2900, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.6188087463378906  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.6204957962036133  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.6221828460693359  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.6204113960266113  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

torch.Size([11321, 40])
input nodes number: 33312
output nodes number: 11321
edges number: 79629
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.619929313659668  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.6199297904968262  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.021341323852539062  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

pseudo mini batch 5 input nodes size: 36350
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.019777774810791016  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.019777774810791016  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.037355899810791016  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.037438392639160156  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.021469593048095703  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.021953105926513672  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.021953105926513672  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.021953105926513672  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

m.shape torch.Size([1642, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.05454444885253906  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.05454444885253906  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1642, 128]), torch.Size([1, 1642, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.056110382080078125  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.06863784790039062  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1642, 128])
m.shape torch.Size([1405, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.07012176513671875  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.07012176513671875  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1405, 128]), torch.Size([1, 1405, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.07146167755126953  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.09238243103027344  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1405, 128])
m.shape torch.Size([1007, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.0940093994140625  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.0940093994140625  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1007, 128]), torch.Size([1, 1007, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.0949697494506836  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.11609745025634766  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1007, 128])
m.shape torch.Size([763, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.11707258224487305  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.11707258224487305  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.11780023574829102  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1389021873474121  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([725, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14026689529418945  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14026689529418945  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 725, 128]), torch.Size([1, 725, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14095830917358398  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1665506362915039  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 725, 128])
m.shape torch.Size([517, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.16768407821655273  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.16768407821655273  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.16817712783813477  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.19001054763793945  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([404, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.19111251831054688  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.19111251831054688  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 404, 128]), torch.Size([1, 404, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.191497802734375  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.21076202392578125  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 404, 128])
m.shape torch.Size([355, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.21192359924316406  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.21192359924316406  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.21226215362548828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.23155975341796875  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([305, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.23269939422607422  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.23269939422607422  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.23299026489257812  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2516059875488281  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([3915, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.27099180221557617  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.27099180221557617  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1957, 128]), torch.Size([1, 1957, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2728581428527832  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.41057538986206055  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 0 shape torch.Size([1, 1957, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.41057538986206055  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.41057538986206055  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1958, 128]), torch.Size([1, 1958, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.412442684173584  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.5492372512817383  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 1 shape torch.Size([1, 1958, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.5224485397338867  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.5240936279296875  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.5257387161254883  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.5240111351013184  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

torch.Size([11038, 40])
input nodes number: 36350
output nodes number: 11038
edges number: 64815
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.5247735977172852  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.5247740745544434  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.02324056625366211  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

pseudo mini batch 6 input nodes size: 22714
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.021878719329833984  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.021878719329833984  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.032709598541259766  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.032793521881103516  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.015132904052734375  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.015517234802246094  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.015517234802246094  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.015517234802246094  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

m.shape torch.Size([2243, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.041983604431152344  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.041983604431152344  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 2243, 128]), torch.Size([1, 2243, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.04412269592285156  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.06129646301269531  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 2243, 128])
m.shape torch.Size([1826, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.061968326568603516  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.061968326568603516  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1826, 128]), torch.Size([1, 1826, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.06370973587036133  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.08983087539672852  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1826, 128])
m.shape torch.Size([1429, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.09141397476196289  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.09141397476196289  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1429, 128]), torch.Size([1, 1429, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.09277677536010742  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.12335920333862305  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1429, 128])
m.shape torch.Size([1094, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.12476444244384766  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.12476444244384766  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1258077621459961  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1568155288696289  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([864, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1583538055419922  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1583538055419922  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 864, 128]), torch.Size([1, 864, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1591777801513672  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1897258758544922  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 864, 128])
m.shape torch.Size([622, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.19109344482421875  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.19109344482421875  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.19168663024902344  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.21789884567260742  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([421, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2190074920654297  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2190074920654297  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 421, 128]), torch.Size([1, 421, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.21940898895263672  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.23948383331298828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 421, 128])
m.shape torch.Size([416, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.24086999893188477  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.24086999893188477  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.24126672744750977  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.26388025283813477  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([365, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.26524829864501953  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.26524829864501953  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2655963897705078  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2878742218017578  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 365, 128])
m.shape torch.Size([1939, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.29694604873657227  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.29694604873657227  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 969, 128]), torch.Size([1, 969, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2978701591491699  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.3636641502380371  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 0 shape torch.Size([1, 969, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.3636641502380371  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.3636641502380371  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.36458921432495117  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.4298067092895508  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 1 shape torch.Size([1, 970, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.40989112854003906  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.4120302200317383  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.41370201110839844  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.41147899627685547  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

torch.Size([11219, 40])
input nodes number: 22714
output nodes number: 11219
edges number: 51560
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.41130781173706055  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.41130828857421875  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.015772342681884766  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

pseudo mini batch 7 input nodes size: 28132
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.014708518981933594  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.014708518981933594  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.028122901916503906  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.028206825256347656  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.017292022705078125  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.017739295959472656  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.017739295959472656  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.017739295959472656  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

m.shape torch.Size([1894, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.04813861846923828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.04813861846923828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1894, 128]), torch.Size([1, 1894, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.04994487762451172  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.06591415405273438  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1894, 128])
m.shape torch.Size([1639, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.0665740966796875  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.0665740966796875  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1639, 128]), torch.Size([1, 1639, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.06813716888427734  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.09176254272460938  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1639, 128])
m.shape torch.Size([1149, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.09262466430664062  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.09262466430664062  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.0937204360961914  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.11850500106811523  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([882, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.11963939666748047  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.11963939666748047  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 882, 128]), torch.Size([1, 882, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.12048053741455078  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14554500579833984  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 882, 128])
m.shape torch.Size([779, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14698171615600586  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14698171615600586  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 779, 128]), torch.Size([1, 779, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.14772462844848633  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1744694709777832  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 779, 128])
m.shape torch.Size([597, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.17580604553222656  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.17580604553222656  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.1763753890991211  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.20246458053588867  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([487, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.20380544662475586  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.20380544662475586  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2042698860168457  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2274918556213379  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([403, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.22879695892333984  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.22879695892333984  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 403, 128]), torch.Size([1, 403, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.22918128967285156  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.25108814239501953  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 403, 128])
m.shape torch.Size([321, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2522735595703125  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2522735595703125  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2525796890258789  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2721719741821289  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([3088, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2867436408996582  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2867436408996582  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1544, 128]), torch.Size([1, 1544, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.28821611404418945  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.3927617073059082  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 0 shape torch.Size([1, 1544, 128])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.3927617073059082  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.3927617073059082  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1544, 128]), torch.Size([1, 1544, 128])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.39423418045043945  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4980435371398926  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 1 shape torch.Size([1, 1544, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4743361473083496  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4761977195739746  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4780592918395996  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.47611379623413086  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

torch.Size([11239, 40])
input nodes number: 28132
output nodes number: 11239
edges number: 60026
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.47659730911254883  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.47659778594970703  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01871204376220703  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01871204376220703  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01871204376220703  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009271085262298584 |0.0010245740413665771 |0.040810346603393555 |9.870529174804688e-05 |0.01941359043121338 |0.0028390884399414062 |
----------------------------------------------------------pseudo_mini_loss sum 3.2689831256866455[03:20:43] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14284864 edges into 8 parts and get 1551752 edge cuts

Total (block generation + training)time/epoch 10.559488773345947
* Pure training time/epoch 0.5677855014801025
Training time/epoch 0.6079380512237549
Training time without block to device /epoch 0.5997414588928223
Training time without total dataloading part /epoch 0.48542022705078125
load block tensor time/epoch 0.07416868209838867
block to device time/epoch 0.008196592330932617
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  203267
Number of first layer input nodes during this epoch:  203267
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.018711566925048828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.016556501388549805
global_2_local spend time (sec) 0.04582810401916504
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003213644027709961
A = g.adjacency_matrix() spent  0.007283687591552734
auxiliary_graph
Graph(num_nodes=145027, num_edges=14375805,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0784609317779541
remove nodes length
54086
auxiliary_graph.remove_nodes spent  0.6476013660430908
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14375805,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6500613689422607

the counter of shared neighbor distribution
Counter({1.0: 12899956, 2.0: 1173186, 3.0: 165808, 4.0: 33362, 5.0: 8940, 6.0: 2608, 7.0: 762, 8.0: 204, 9.0: 36, 10.0: 2})
14284864
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14284861, 14284862, 14284863])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12899956, 2.0: 1173186, 3.0: 165808, 4.0: 33362, 5.0: 8940, 6.0: 2608, 7.0: 762, 8.0: 204, 9.0: 36, 10.0: 2})
Convert a graph into a bidirected graph: 0.585 seconds
Metis partitioning: 2.528 seconds
Split the graph: 0.920 seconds
Construct subgraphs: 0.051 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.0907509326934814
11298
11207
11039
11490
11387
11535
11368
11617
total k batches seeds list generation spend  9.27531623840332
after graph partition
graph partition algorithm spend time 9.364375114440918
11298
11207
11039
11490
11387
11535
11368
11617
partition_len_list
[22963, 27735, 35462, 33322, 22422, 20490, 19341, 18580]
shared_neighbor_graph_partition_s0 selection method  spend 9.46662163734436
time for parepare:  0.016681909561157227
local_output_nid generation:  0.002083301544189453
local_in_edges_tensor generation:  0.002088308334350586
mini_batch_src_global generation:  0.00203704833984375
r_  generation:  0.0214083194732666
local_output_nid generation:  0.0034456253051757812
local_in_edges_tensor generation:  0.0020444393157958984
mini_batch_src_global generation:  0.0021996498107910156
r_  generation:  0.021221160888671875
local_output_nid generation:  0.0024728775024414062
local_in_edges_tensor generation:  0.0019397735595703125
mini_batch_src_global generation:  0.002269744873046875
r_  generation:  0.024186134338378906
local_output_nid generation:  0.002677440643310547
local_in_edges_tensor generation:  0.0021181106567382812
mini_batch_src_global generation:  0.0026290416717529297
r_  generation:  0.02947998046875
local_output_nid generation:  0.0028951168060302734
local_in_edges_tensor generation:  0.0023431777954101562
mini_batch_src_global generation:  0.002097606658935547
r_  generation:  0.023607492446899414
local_output_nid generation:  0.0027947425842285156
local_in_edges_tensor generation:  0.0019903182983398438
mini_batch_src_global generation:  0.001924753189086914
r_  generation:  0.022546052932739258
local_output_nid generation:  0.0026154518127441406
local_in_edges_tensor generation:  0.0019617080688476562
mini_batch_src_global generation:  0.0019838809967041016
r_  generation:  0.023284196853637695
local_output_nid generation:  0.0025568008422851562
local_in_edges_tensor generation:  0.001951456069946289
mini_batch_src_global generation:  0.002213716506958008
r_  generation:  0.024817943572998047
----------------------check_connections_block total spend ----------------------------- 0.3134136199951172
generate_one_block  0.03680682182312012
generate_one_block  0.05941367149353027
generate_one_block  0.03514575958251953
generate_one_block  0.04100441932678223
generate_one_block  0.029640913009643555
generate_one_block  0.027933120727539062
generate_one_block  0.029459476470947266
generate_one_block  0.03133678436279297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.018711566925048828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

connection checking time:  0.3134136199951172
block generation total time  0.290740966796875
average batch blocks generation time:  0.036342620849609375
block dataloader generation time/epoch 10.040727853775024
pseudo mini batch 0 input nodes size: 22963
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.017480850219726562  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.017480850219726562  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.028430461883544922  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.028514862060546875  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.015016555786132812  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01541900634765625  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01541900634765625  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01541900634765625  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

m.shape torch.Size([2134, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.042994022369384766  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.042994022369384766  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 2134, 128]), torch.Size([1, 2134, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.0450291633605957  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.0613102912902832  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 2134, 128])
m.shape torch.Size([1721, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06193399429321289  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06193399429321289  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1721, 128]), torch.Size([1, 1721, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06357526779174805  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08819437026977539  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1721, 128])
m.shape torch.Size([1402, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08937931060791016  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08937931060791016  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1402, 128]), torch.Size([1, 1402, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.09071636199951172  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.12094402313232422  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1402, 128])
m.shape torch.Size([1064, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.12230491638183594  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.12230491638183594  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.12331962585449219  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1533679962158203  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([909, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1550278663635254  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1550278663635254  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.15589475631713867  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18784427642822266  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([631, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18921613693237305  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18921613693237305  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 631, 128]), torch.Size([1, 631, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1898179054260254  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.21771240234375  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 631, 128])
m.shape torch.Size([497, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2190704345703125  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2190704345703125  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2195444107055664  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.24324321746826172  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([454, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.24473810195922852  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.24473810195922852  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.24517107009887695  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2698502540588379  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([388, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.271298885345459  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.271298885345459  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2716689109802246  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2953505516052246  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([2098, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.30516958236694336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.30516958236694336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1049, 128]), torch.Size([1, 1049, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.3061699867248535  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.3776683807373047  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 0 shape torch.Size([1, 1049, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.3776683807373047  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.3776683807373047  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1049, 128]), torch.Size([1, 1049, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.37866878509521484  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.44919729232788086  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 1 shape torch.Size([1, 1049, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.42814064025878906  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.43017578125  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.43185949325561523  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.42973995208740234  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

torch.Size([11298, 40])
input nodes number: 22963
output nodes number: 11298
edges number: 53952
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.42981767654418945  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.42981863021850586  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01594257354736328  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

pseudo mini batch 1 input nodes size: 27735
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.014839649200439453  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.014839649200439453  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.02823019027709961  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.02831411361694336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.017280101776123047  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01769399642944336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01769399642944336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01769399642944336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

m.shape torch.Size([2119, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.04598426818847656  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.04598426818847656  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 2119, 128]), torch.Size([1, 2119, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.048005104064941406  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06458711624145508  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 2119, 128])
m.shape torch.Size([1729, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06528711318969727  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06528711318969727  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1729, 128]), torch.Size([1, 1729, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06693601608276367  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.09254789352416992  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1729, 128])
m.shape torch.Size([1263, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.09353017807006836  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.09353017807006836  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1263, 128]), torch.Size([1, 1263, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.09473466873168945  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.12149286270141602  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1263, 128])
m.shape torch.Size([944, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.12301492691040039  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.12301492691040039  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.12391519546508789  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1500229835510254  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([812, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.15150880813598633  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.15150880813598633  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1522831916809082  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18021631240844727  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([638, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1816544532775879  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1816544532775879  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18226289749145508  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.20873498916625977  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([473, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.21000957489013672  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.21000957489013672  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.21046066284179688  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2330150604248047  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([430, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.23442983627319336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.23442983627319336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.23483991622924805  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.25821447372436523  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([321, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2593870162963867  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2593870162963867  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2596931457519531  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2792854309082031  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([2478, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.29094839096069336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.29094839096069336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1239, 128]), torch.Size([1, 1239, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2921299934387207  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.3785262107849121  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 0 shape torch.Size([1, 1239, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.3785262107849121  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.3785262107849121  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1239, 128]), torch.Size([1, 1239, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.37970781326293945  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4655132293701172  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 1 shape torch.Size([1, 1239, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.44361019134521484  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4456310272216797  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.44730138778686523  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.44519662857055664  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

torch.Size([11207, 40])
input nodes number: 27735
output nodes number: 11207
edges number: 55450
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.44547414779663086  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.44547462463378906  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.018427371978759766  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

pseudo mini batch 2 input nodes size: 35462
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01726675033569336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01726675033569336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.03484487533569336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.0349273681640625  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.021452903747558594  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.021959304809570312  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.021959304809570312  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.021959304809570312  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

m.shape torch.Size([1479, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.056794166564941406  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.056794166564941406  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1479, 128]), torch.Size([1, 1479, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.05820465087890625  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.069488525390625  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1479, 128])
m.shape torch.Size([1303, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.07084846496582031  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.07084846496582031  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1303, 128]), torch.Size([1, 1303, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.07209110260009766  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.09073066711425781  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1303, 128])
m.shape torch.Size([962, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.09148550033569336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.09148550033569336  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 962, 128]), torch.Size([1, 962, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.09240293502807617  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11300230026245117  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 962, 128])
m.shape torch.Size([757, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11398744583129883  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11398744583129883  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 757, 128]), torch.Size([1, 757, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11470937728881836  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.13628625869750977  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 757, 128])
m.shape torch.Size([659, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1374964714050293  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1374964714050293  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.13812494277954102  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.16143512725830078  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([489, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1625199317932129  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1625199317932129  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.16298627853393555  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18303918838500977  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([414, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1841878890991211  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1841878890991211  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18458271026611328  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.20432376861572266  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([330, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2053852081298828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2053852081298828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.20569992065429688  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.22363853454589844  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 330, 128])
m.shape torch.Size([301, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.22477293014526367  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.22477293014526367  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 301, 128]), torch.Size([1, 301, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.22505998611450195  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.24343156814575195  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 301, 128])
m.shape torch.Size([4345, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2640066146850586  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2640066146850586  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 2172, 128]), torch.Size([1, 2172, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.26607799530029297  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4195570945739746  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 0 shape torch.Size([1, 2172, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4195570945739746  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4195570945739746  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 2173, 128]), torch.Size([1, 2173, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4225172996520996  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5747790336608887  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 1 shape torch.Size([1, 2173, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5455899238586426  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.547661304473877  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5497560501098633  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5476021766662598  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

torch.Size([11039, 40])
input nodes number: 35462
output nodes number: 11039
edges number: 67925
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5479240417480469  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5479245185852051  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.022829055786132812  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

pseudo mini batch 3 input nodes size: 33322
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.021427631378173828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.021427631378173828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.03731679916381836  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.03740262985229492  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01974201202392578  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.02034473419189453  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.02034473419189453  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.02034473419189453  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

m.shape torch.Size([1161, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.061000823974609375  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.061000823974609375  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 1161, 128]), torch.Size([1, 1161, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06210803985595703  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.07096576690673828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 1161, 128])
m.shape torch.Size([971, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.07133817672729492  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.07133817672729492  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.07226419448852539  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08639717102050781  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([803, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08736181259155273  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08736181259155273  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08812761306762695  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1055459976196289  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([599, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.10630559921264648  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.10630559921264648  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.10687685012817383  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.12419843673706055  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([538, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.12519550323486328  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.12519550323486328  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.12570858001708984  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.14496231079101562  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([468, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.14604473114013672  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.14604473114013672  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.14649105072021484  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.16568279266357422  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([374, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.16670799255371094  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.16670799255371094  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.16706466674804688  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18489837646484375  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([324, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18595600128173828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18595600128173828  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 324, 128]), torch.Size([1, 324, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1862649917602539  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.20387744903564453  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 324, 128])
m.shape torch.Size([331, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.20514345169067383  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.20514345169067383  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2054591178894043  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2256617546081543  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([5921, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2537374496459961  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2537374496459961  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 2960, 128]), torch.Size([1, 2960, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2565603256225586  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.45815229415893555  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

rst 0 shape torch.Size([1, 2960, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.45815229415893555  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.45815229415893555  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

 h.shape torch.Size([1, 2961, 128]), torch.Size([1, 2961, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.46097612380981445  GigaBytes
Max Memory Allocated: 0.6679754257202148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.6600565910339355  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst 1 shape torch.Size([1, 2961, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.6248383522033691  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.6274266242980957  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.6299443244934082  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.6272702217102051  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

torch.Size([11490, 40])
input nodes number: 33322
output nodes number: 11490
edges number: 80805
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.6276717185974121  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.6276721954345703  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.021391868591308594  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

pseudo mini batch 4 input nodes size: 22422
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.019809246063232422  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.019809246063232422  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.03050088882446289  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.030585765838623047  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.014610767364501953  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.015068531036376953  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.015068531036376953  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.015068531036376953  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

m.shape torch.Size([1747, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.04608297348022461  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.04608297348022461  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1747, 128]), torch.Size([1, 1747, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.04774904251098633  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06165504455566406  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1747, 128])
m.shape torch.Size([1601, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06260156631469727  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06260156631469727  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1601, 128]), torch.Size([1, 1601, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06412839889526367  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08703088760375977  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1601, 128])
m.shape torch.Size([1251, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08828306198120117  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08828306198120117  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1251, 128]), torch.Size([1, 1251, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08947610855102539  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1157231330871582  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1251, 128])
m.shape torch.Size([955, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1171579360961914  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1171579360961914  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 955, 128]), torch.Size([1, 955, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11806869506835938  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.14535999298095703  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 955, 128])
m.shape torch.Size([799, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.14680957794189453  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.14680957794189453  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 799, 128]), torch.Size([1, 799, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.14757156372070312  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1753067970275879  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 799, 128])
m.shape torch.Size([637, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.17674827575683594  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.17674827575683594  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.17735576629638672  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2044839859008789  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([539, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2059793472290039  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2059793472290039  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.20649337768554688  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.23310422897338867  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([439, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.23452186584472656  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.23452186584472656  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2349405288696289  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2588043212890625  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([381, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.26023006439208984  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.26023006439208984  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2605934143066406  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2838478088378906  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([3038, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.29815244674682617  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.29815244674682617  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1519, 128]), torch.Size([1, 1519, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.29960107803344727  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4027872085571289  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst 0 shape torch.Size([1, 1519, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4027872085571289  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4027872085571289  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1519, 128]), torch.Size([1, 1519, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.40423583984375  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5063643455505371  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst 1 shape torch.Size([1, 1519, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.48155832290649414  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.483705997467041  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4858536720275879  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.48362112045288086  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

torch.Size([11387, 40])
input nodes number: 22422
output nodes number: 11387
edges number: 61433
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.48430871963500977  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.48430919647216797  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.016256332397460938  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

pseudo mini batch 5 input nodes size: 20490
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.015046119689941406  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.015046119689941406  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.024816513061523438  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.024902820587158203  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.014126300811767578  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01457357406616211  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01457357406616211  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01457357406616211  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

m.shape torch.Size([1768, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.04491281509399414  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.04491281509399414  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1768, 128]), torch.Size([1, 1768, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.04659891128540039  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.060956478118896484  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1768, 128])
m.shape torch.Size([1637, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06167459487915039  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06167459487915039  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1637, 128]), torch.Size([1, 1637, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06323575973510742  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08705854415893555  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1637, 128])
m.shape torch.Size([1305, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08814477920532227  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08814477920532227  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1305, 128]), torch.Size([1, 1305, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08938932418823242  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11676931381225586  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1305, 128])
m.shape torch.Size([1087, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11824369430541992  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11824369430541992  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11928033828735352  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.14934301376342773  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([924, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.15176963806152344  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.15176963806152344  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1526508331298828  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18451881408691406  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([684, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18603515625  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18603515625  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.18668746948242188  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.21482467651367188  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([621, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.21657133102416992  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.21657133102416992  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2171635627746582  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.24834728240966797  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([530, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2500729560852051  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2500729560852051  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2505784034729004  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.27971315383911133  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([406, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2812027931213379  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2812027931213379  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.28158998489379883  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.30637025833129883  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([2573, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.31844568252563477  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.31844568252563477  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1286, 128]), torch.Size([1, 1286, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.3196721076965332  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.40764951705932617  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst 0 shape torch.Size([1, 1286, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.40764951705932617  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.40764951705932617  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1287, 128]), torch.Size([1, 1287, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.408876895904541  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4954075813293457  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst 1 shape torch.Size([1, 1287, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.47146129608154297  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4732184410095215  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.47556638717651367  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4737229347229004  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

torch.Size([11535, 40])
input nodes number: 20490
output nodes number: 11535
edges number: 60000
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.47357177734375  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4735722541809082  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.014913082122802734  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

pseudo mini batch 6 input nodes size: 19341
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.013735771179199219  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.013735771179199219  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.023496627807617188  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.023581504821777344  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.013724803924560547  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.014200687408447266  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.014200687408447266  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.014200687408447266  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

m.shape torch.Size([1699, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.04635429382324219  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.04635429382324219  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1699, 128]), torch.Size([1, 1699, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.047974586486816406  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.060985565185546875  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1699, 128])
m.shape torch.Size([1430, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.0615391731262207  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.0615391731262207  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1430, 128]), torch.Size([1, 1430, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06290292739868164  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.0833592414855957  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1430, 128])
m.shape torch.Size([1195, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08438682556152344  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08438682556152344  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1195, 128]), torch.Size([1, 1195, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.0855264663696289  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11070823669433594  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1195, 128])
m.shape torch.Size([927, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11190652847290039  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11190652847290039  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 927, 128]), torch.Size([1, 927, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11279058456420898  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.13925600051879883  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 927, 128])
m.shape torch.Size([778, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1406688690185547  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1406688690185547  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.14141082763671875  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.168121337890625  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([609, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1694927215576172  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1694927215576172  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1700735092163086  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.19622230529785156  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([526, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.19768762588500977  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.19768762588500977  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 526, 128]), torch.Size([1, 526, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.19818925857543945  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.22440862655639648  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 526, 128])
m.shape torch.Size([456, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.22589731216430664  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.22589731216430664  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2263321876525879  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.25112009048461914  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([378, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.25252485275268555  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.25252485275268555  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2528853416442871  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2759566307067871  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([3370, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2919459342956543  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2919459342956543  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1685, 128]), torch.Size([1, 1685, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.29355287551879883  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.40888547897338867  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst 0 shape torch.Size([1, 1685, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.40888547897338867  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.40888547897338867  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1685, 128]), torch.Size([1, 1685, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.4104924201965332  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5250215530395508  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst 1 shape torch.Size([1, 1685, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.49898338317871094  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5006775856018066  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5027098655700684  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5009307861328125  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

torch.Size([11368, 40])
input nodes number: 19341
output nodes number: 11368
edges number: 63828
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5010972023010254  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5010976791381836  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.014885425567626953  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

pseudo mini batch 7 input nodes size: 18580
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.013661861419677734  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.013661861419677734  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.023432254791259766  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.023519039154052734  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.01367330551147461  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.014195919036865234  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.014195919036865234  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.014195919036865234  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

m.shape torch.Size([1321, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.04917764663696289  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.04917764663696289  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1321, 128]), torch.Size([1, 1321, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.05043745040893555  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.0605158805847168  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1321, 128])
m.shape torch.Size([1314, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.0618743896484375  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.0618743896484375  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1314, 128]), torch.Size([1, 1314, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.06312751770019531  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.0819244384765625  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1314, 128])
m.shape torch.Size([1096, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08353996276855469  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08353996276855469  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.08458518981933594  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.10843467712402344  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([987, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.10979461669921875  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.10979461669921875  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.11073589324951172  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.13873863220214844  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([803, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1401824951171875  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1401824951171875  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.14094829559326172  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.1685171127319336  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([712, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.17017126083374023  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.17017126083374023  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 712, 128]), torch.Size([1, 712, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.17085027694702148  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.20056676864624023  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 712, 128])
m.shape torch.Size([601, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.20223331451416016  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.20223331451416016  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2028064727783203  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.23181438446044922  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([509, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.23346948623657227  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.23346948623657227  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.23395490646362305  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2616238594055176  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([470, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2633981704711914  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2633981704711914  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.26384639739990234  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.29253292083740234  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([3804, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.31044769287109375  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.31044769287109375  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1902, 128]), torch.Size([1, 1902, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.31226158142089844  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.44104766845703125  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst 0 shape torch.Size([1, 1902, 128])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.44104766845703125  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.44104766845703125  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

 h.shape torch.Size([1, 1902, 128]), torch.Size([1, 1902, 128])
----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.44286155700683594  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5707406997680664  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

rst 1 shape torch.Size([1, 1902, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5417609214782715  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5435748100280762  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5453062057495117  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5434055328369141  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

torch.Size([11617, 40])
input nodes number: 18580
output nodes number: 11617
edges number: 70021
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.543668270111084  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5436687469482422  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.015024662017822266  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.015024662017822266  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.015024662017822266  GigaBytes
Max Memory Allocated: 0.6755871772766113  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |Using backend: pytorch

      |0.00990206003189087 |0.0005963146686553955 |0.03591638803482056 |8.153915405273438e-05 |0.018309831619262695 |0.0027425289154052734 |
----------------------------------------------------------pseudo_mini_loss sum 3.169135808944702
Total (block generation + training)time/epoch 10.62267005443573
* Pure training time/epoch 0.5211915969848633
Training time/epoch 0.5554008483886719
Training time without block to device /epoch 0.5506303310394287
Training time without total dataloading part /epoch 0.43720459938049316
load block tensor time/epoch 0.07921648025512695
block to device time/epoch 0.004770517349243164
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  200315
Number of first layer input nodes during this epoch:  200315
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
