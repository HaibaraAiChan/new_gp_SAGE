[03:21:02] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14364480 edges into 16 parts and get 2868790 edge cuts
main start at this time 1652844050.0951202
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02513289451599121
global_2_local spend time (sec) 0.033562660217285156
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0034580230712890625
A = g.adjacency_matrix() spent  0.006979465484619141
auxiliary_graph
Graph(num_nodes=145054, num_edges=14455421,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07222938537597656
remove nodes length
54113
auxiliary_graph.remove_nodes spent  0.6395595073699951
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14455421,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6031720638275146

the counter of shared neighbor distribution
Counter({1.0: 12983840, 2.0: 1168162, 3.0: 166454, 4.0: 33624, 5.0: 8820, 6.0: 2638, 7.0: 736, 8.0: 176, 9.0: 24, 10.0: 6})
14364480
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14364477, 14364478, 14364479])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12983840, 2.0: 1168162, 3.0: 166454, 4.0: 33624, 5.0: 8820, 6.0: 2638, 7.0: 736, 8.0: 176, 9.0: 24, 10.0: 6})
Convert a graph into a bidirected graph: 0.602 seconds
Metis partitioning: 2.666 seconds
Split the graph: 0.421 seconds
Construct subgraphs: 0.056 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  3.7522854804992676
5818
5809
5853
5827
5846
5810
5804
5598
5570
5492
5563
5820
5470
5584
5571
5506
total k batches seeds list generation spend  8.76755976676941
after graph partition
graph partition algorithm spend time 8.82815957069397
5818
5809
5853
5827
5846
5810
5804
5598
5570
5492
5563
5820
5470
5584
5571
5506
partition_len_list
[10164, 12191, 13071, 10536, 10170, 11597, 11862, 11270, 14350, 15742, 12361, 12738, 18914, 19992, 22444, 20173]
shared_neighbor_graph_partition_s0 selection method  spend 8.91086721420288
time for parepare:  0.016347169876098633
local_output_nid generation:  0.001169443130493164
local_in_edges_tensor generation:  0.0013163089752197266
mini_batch_src_global generation:  0.001239776611328125
r_  generation:  0.00913548469543457
local_output_nid generation:  0.0012698173522949219
local_in_edges_tensor generation:  0.00121307373046875
mini_batch_src_global generation:  0.0013823509216308594
r_  generation:  0.009990692138671875
local_output_nid generation:  0.0013604164123535156
local_in_edges_tensor generation:  0.0011801719665527344
mini_batch_src_global generation:  0.0012333393096923828
r_  generation:  0.01225900650024414
local_output_nid generation:  0.0014574527740478516
local_in_edges_tensor generation:  0.001176595687866211
mini_batch_src_global generation:  0.001321554183959961
r_  generation:  0.010288715362548828
local_output_nid generation:  0.001493215560913086
local_in_edges_tensor generation:  0.0011370182037353516
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.012314558029174805
local_output_nid generation:  0.0014467239379882812
local_in_edges_tensor generation:  0.0011417865753173828
mini_batch_src_global generation:  0.0009281635284423828
r_  generation:  0.011729955673217773
local_output_nid generation:  0.0014209747314453125
local_in_edges_tensor generation:  0.0011327266693115234
mini_batch_src_global generation:  0.0012738704681396484
r_  generation:  0.01012873649597168
local_output_nid generation:  0.0014138221740722656
local_in_edges_tensor generation:  0.0010523796081542969
mini_batch_src_global generation:  0.0010671615600585938
r_  generation:  0.01164698600769043
local_output_nid generation:  0.0014004707336425781
local_in_edges_tensor generation:  0.0010845661163330078
mini_batch_src_global generation:  0.0012214183807373047
r_  generation:  0.009450912475585938
local_output_nid generation:  0.0013949871063232422
local_in_edges_tensor generation:  0.00103759765625
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.009398221969604492
local_output_nid generation:  0.0014483928680419922
local_in_edges_tensor generation:  0.0010385513305664062
mini_batch_src_global generation:  0.001056671142578125
r_  generation:  0.009311914443969727
local_output_nid generation:  0.0015125274658203125
local_in_edges_tensor generation:  0.0010743141174316406
mini_batch_src_global generation:  0.0010771751403808594
r_  generation:  0.009939193725585938
local_output_nid generation:  0.0015063285827636719
local_in_edges_tensor generation:  0.0010995864868164062
mini_batch_src_global generation:  0.0011267662048339844
r_  generation:  0.012060403823852539
local_output_nid generation:  0.0014967918395996094
local_in_edges_tensor generation:  0.0011370182037353516
mini_batch_src_global generation:  0.001165628433227539
r_  generation:  0.012885570526123047
local_output_nid generation:  0.0014891624450683594
local_in_edges_tensor generation:  0.0011000633239746094
mini_batch_src_global generation:  0.0012521743774414062
r_  generation:  0.01298832893371582
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.0010526180267333984
mini_batch_src_global generation:  0.0011010169982910156
r_  generation:  0.01220560073852539
----------------------check_connections_block total spend ----------------------------- 0.304699182510376
generate_one_block  0.01608729362487793
generate_one_block  0.01440882682800293
generate_one_block  0.015296697616577148
generate_one_block  0.014340877532958984
generate_one_block  0.020306825637817383
generate_one_block  0.0162961483001709
generate_one_block  0.015534400939941406
generate_one_block  0.014488697052001953
generate_one_block  0.014783143997192383
generate_one_block  0.014658927917480469
generate_one_block  0.012514352798461914
generate_one_block  0.012956619262695312
generate_one_block  0.01748204231262207
generate_one_block  0.02009749412536621
generate_one_block  0.020097732543945312
generate_one_block  0.01829242706298828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0.304699182510376
block generation total time  0.2576425075531006
average batch blocks generation time:  0.016102656722068787
pseudo mini batch 0 input nodes size: 10164
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0053768157958984375  GigaBytes
Max Memory Allocated: 0.0053768157958984375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.005420207977294922  GigaBytes
Max Memory Allocated: 0.005420207977294922  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.005420207977294922  GigaBytes
Max Memory Allocated: 0.005420207977294922  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005626201629638672  GigaBytes
Max Memory Allocated: 0.005626201629638672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005626201629638672  GigaBytes
Max Memory Allocated: 0.005626201629638672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005626201629638672  GigaBytes
Max Memory Allocated: 0.005626201629638672  GigaBytes

m.shape torch.Size([993, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.019692420959472656  GigaBytes
Max Memory Allocated: 0.01970386505126953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.019692420959472656  GigaBytes
Max Memory Allocated: 0.01970386505126953  GigaBytes

 h.shape torch.Size([1, 993, 128]), torch.Size([1, 993, 128])
----------------------------------------3
 Nvidia-smi: 1.2049560546875 GB
    Memory Allocated: 0.020639419555664062  GigaBytes
Max Memory Allocated: 0.020639419555664062  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.028215408325195312  GigaBytes
Max Memory Allocated: 0.028688907623291016  GigaBytes

rst.shape  torch.Size([1, 993, 128])
m.shape torch.Size([945, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.028643131256103516  GigaBytes
Max Memory Allocated: 0.028688907623291016  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.028643131256103516  GigaBytes
Max Memory Allocated: 0.028688907623291016  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.029544353485107422  GigaBytes
Max Memory Allocated: 0.029544353485107422  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.043062686920166016  GigaBytes
Max Memory Allocated: 0.04396390914916992  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([736, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.04413461685180664  GigaBytes
Max Memory Allocated: 0.044159889221191406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.04413461685180664  GigaBytes
Max Memory Allocated: 0.044159889221191406  GigaBytes

 h.shape torch.Size([1, 736, 128]), torch.Size([1, 736, 128])
----------------------------------------3
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.04483652114868164  GigaBytes
Max Memory Allocated: 0.04483652114868164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.06050539016723633  GigaBytes
Max Memory Allocated: 0.06155824661254883  GigaBytes

rst.shape  torch.Size([1, 736, 128])
m.shape torch.Size([555, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.061213016510009766  GigaBytes
Max Memory Allocated: 0.06155824661254883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.061213016510009766  GigaBytes
Max Memory Allocated: 0.06155824661254883  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.061742305755615234  GigaBytes
Max Memory Allocated: 0.061742305755615234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07726907730102539  GigaBytes
Max Memory Allocated: 0.07832765579223633  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([488, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07816791534423828  GigaBytes
Max Memory Allocated: 0.07832765579223633  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07816791534423828  GigaBytes
Max Memory Allocated: 0.07832765579223633  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07863330841064453  GigaBytes
Max Memory Allocated: 0.07863330841064453  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.09538745880126953  GigaBytes
Max Memory Allocated: 0.09655094146728516  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([385, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.09625625610351562  GigaBytes
Max Memory Allocated: 0.09655094146728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.09625625610351562  GigaBytes
Max Memory Allocated: 0.09655094146728516  GigaBytes

 h.shape torch.Size([1, 385, 128]), torch.Size([1, 385, 128])
----------------------------------------3
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.09662342071533203  GigaBytes
Max Memory Allocated: 0.09662342071533203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.1124114990234375  GigaBytes
Max Memory Allocated: 0.11351299285888672  GigaBytes

rst.shape  torch.Size([1, 385, 128])
m.shape torch.Size([325, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.1133127212524414  GigaBytes
Max Memory Allocated: 0.11351299285888672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.1133127212524414  GigaBytes
Max Memory Allocated: 0.11351299285888672  GigaBytes

 h.shape torch.Size([1, 325, 128]), torch.Size([1, 325, 128])
----------------------------------------3
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.11362266540527344  GigaBytes
Max Memory Allocated: 0.11362266540527344  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.129119873046875  GigaBytes
Max Memory Allocated: 0.1302046775817871  GigaBytes

rst.shape  torch.Size([1, 325, 128])
m.shape torch.Size([226, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12982702255249023  GigaBytes
Max Memory Allocated: 0.1302046775817871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12982702255249023  GigaBytes
Max Memory Allocated: 0.1302046775817871  GigaBytes

 h.shape torch.Size([1, 226, 128]), torch.Size([1, 226, 128])
----------------------------------------3
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.13004255294799805  GigaBytes
Max Memory Allocated: 0.1302046775817871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.14232778549194336  GigaBytes
Max Memory Allocated: 0.1431899070739746  GigaBytes

rst.shape  torch.Size([1, 226, 128])
m.shape torch.Size([191, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.14303970336914062  GigaBytes
Max Memory Allocated: 0.1431899070739746  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.14303970336914062  GigaBytes
Max Memory Allocated: 0.1431899070739746  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.14322185516357422  GigaBytes
Max Memory Allocated: 0.14322185516357422  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.15487957000732422  GigaBytes
Max Memory Allocated: 0.1556992530822754  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([974, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.15943288803100586  GigaBytes
Max Memory Allocated: 0.15954256057739258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.15943288803100586  GigaBytes
Max Memory Allocated: 0.15954256057739258  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.1598973274230957  GigaBytes
Max Memory Allocated: 0.1598973274230957  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1928725242614746  GigaBytes
Max Memory Allocated: 0.19519472122192383  GigaBytes

rst 0 shape torch.Size([1, 487, 128])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1928725242614746  GigaBytes
Max Memory Allocated: 0.19519472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1928725242614746  GigaBytes
Max Memory Allocated: 0.19519472122192383  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.19333696365356445  GigaBytes
Max Memory Allocated: 0.19519472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4217529296875 GB
    Memory Allocated: 0.22607994079589844  GigaBytes
Max Memory Allocated: 0.22863435745239258  GigaBytes

rst 1 shape torch.Size([1, 487, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.21534395217895508  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.21621131896972656  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.21707868576049805  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.21616792678833008  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

torch.Size([5818, 40])
input nodes number: 10164
output nodes number: 5818
edges number: 27603
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.21715450286865234  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.21715545654296875  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.0073719024658203125  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

pseudo mini batch 1 input nodes size: 12191
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.0068187713623046875  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.0068187713623046875  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.012631893157958984  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.012675285339355469  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.007785320281982422  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.008013248443603516  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.008013248443603516  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.008013248443603516  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

m.shape torch.Size([911, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.023441314697265625  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.023441314697265625  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.02431011199951172  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.03126049041748047  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([830, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.03161764144897461  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.03161764144897461  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.0324091911315918  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.04436683654785156  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([639, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.04488515853881836  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.04488515853881836  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.04549455642700195  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.05915546417236328  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([536, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.059873104095458984  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.059873104095458984  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.060384273529052734  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.07618093490600586  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([445, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.07698631286621094  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.07698631286621094  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.07741069793701172  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.09268856048583984  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([327, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.09341192245483398  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.09341192245483398  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.09372377395629883  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.10713338851928711  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([253, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.10782194137573242  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.10782194137573242  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.1080632209777832  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.12012720108032227  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

rst.shape  torch.Size([1, 253, 128])
m.shape torch.Size([294, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.12112808227539062  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.12112808227539062  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

 h.shape torch.Size([1, 294, 128]), torch.Size([1, 294, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.12140846252441406  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.13739013671875  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

rst.shape  torch.Size([1, 294, 128])
m.shape torch.Size([183, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.13803529739379883  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.13803529739379883  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

 h.shape torch.Size([1, 183, 128]), torch.Size([1, 183, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.13820981979370117  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.14937925338745117  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

rst.shape  torch.Size([1, 183, 128])
m.shape torch.Size([1391, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.15592479705810547  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.15592479705810547  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

 h.shape torch.Size([1, 695, 128]), torch.Size([1, 695, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.1565876007080078  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.2053370475769043  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

rst 0 shape torch.Size([1, 695, 128])
----------------------------------------1
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.2053370475769043  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.2053370475769043  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

 h.shape torch.Size([1, 696, 128]), torch.Size([1, 696, 128])
----------------------------------------3
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.20600080490112305  GigaBytes
Max Memory Allocated: 0.23419761657714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.25470733642578125  GigaBytes
Max Memory Allocated: 0.2586398124694824  GigaBytes

rst 1 shape torch.Size([1, 696, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.24331951141357422  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.2441854476928711  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.24505138397216797  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.2441420555114746  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

torch.Size([5809, 40])
input nodes number: 12191
output nodes number: 5809
edges number: 30499
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.24427509307861328  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.24427556991577148  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008396148681640625  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

pseudo mini batch 2 input nodes size: 13071
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.0077838897705078125  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.0077838897705078125  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.01401662826538086  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.014060497283935547  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008203983306884766  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008463382720947266  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008463382720947266  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.008463382720947266  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

m.shape torch.Size([777, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.025897502899169922  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.025897502899169922  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

 h.shape torch.Size([1, 777, 128]), torch.Size([1, 777, 128])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.026638507843017578  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.03256654739379883  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

rst.shape  torch.Size([1, 777, 128])
m.shape torch.Size([655, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.032820701599121094  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.032820701599121094  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.03344535827636719  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.04303789138793945  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([552, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.04351520538330078  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.04351520538330078  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.04404163360595703  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.05655241012573242  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([487, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.057218074798583984  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.057218074798583984  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.05768251419067383  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.0711512565612793  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([386, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.0718393325805664  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.0718393325805664  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

 h.shape torch.Size([1, 386, 128]), torch.Size([1, 386, 128])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.07220745086669922  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.08545970916748047  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

rst.shape  torch.Size([1, 386, 128])
m.shape torch.Size([309, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.08615970611572266  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.08615970611572266  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.08645439147949219  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.09912586212158203  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

rst.shape  torch.Size([1, 309, 128])
m.shape torch.Size([294, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.0999598503112793  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.0999598503112793  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

 h.shape torch.Size([1, 294, 128]), torch.Size([1, 294, 128])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.10024023056030273  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.11425924301147461  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

rst.shape  torch.Size([1, 294, 128])
m.shape torch.Size([247, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.11506128311157227  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.11506128311157227  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

 h.shape torch.Size([1, 247, 128]), torch.Size([1, 247, 128])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.11529684066772461  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.1287236213684082  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

rst.shape  torch.Size([1, 247, 128])
m.shape torch.Size([204, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.12948131561279297  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.12948131561279297  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

 h.shape torch.Size([1, 204, 128]), torch.Size([1, 204, 128])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.12967586517333984  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.14212703704833984  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

rst.shape  torch.Size([1, 204, 128])
m.shape torch.Size([1942, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.1512899398803711  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.1512899398803711  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.15221595764160156  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.21796321868896484  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

rst 0 shape torch.Size([1, 971, 128])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.21796321868896484  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.21796321868896484  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.2188892364501953  GigaBytes
Max Memory Allocated: 0.263547420501709  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.28417348861694336  GigaBytes
Max Memory Allocated: 0.28926658630371094  GigaBytes

rst 1 shape torch.Size([1, 971, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2698788642883301  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2707514762878418  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2716240882873535  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2707076072692871  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

torch.Size([5853, 40])
input nodes number: 13071
output nodes number: 5853
edges number: 34765
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2708559036254883  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2708563804626465  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.008893013000488281  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

pseudo mini batch 3 input nodes size: 10536
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.00821065902709961  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.00821065902709961  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.013234615325927734  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.013278484344482422  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0070018768310546875  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007222175598144531  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007222175598144531  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007222175598144531  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

m.shape torch.Size([986, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.022644996643066406  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.022644996643066406  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 986, 128]), torch.Size([1, 986, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.02358531951904297  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03110790252685547  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 986, 128])
m.shape torch.Size([860, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03145790100097656  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03145790100097656  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03227806091308594  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04458045959472656  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([678, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04514026641845703  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04514026641845703  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04578685760498047  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.060179710388183594  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([540, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.060886383056640625  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.060886383056640625  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0614013671875  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07677841186523438  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([431, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07754850387573242  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07754850387573242  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07795953750610352  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09275674819946289  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([323, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.093475341796875  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.093475341796875  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09378337860107422  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10702896118164062  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([314, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10792303085327148  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10792303085327148  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 314, 128]), torch.Size([1, 314, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10822248458862305  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12319517135620117  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 314, 128])
m.shape torch.Size([239, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12395715713500977  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12395715713500977  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 239, 128]), torch.Size([1, 239, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12418508529663086  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1371769905090332  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 239, 128])
m.shape torch.Size([218, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1379985809326172  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1379985809326172  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.13820648193359375  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.15151214599609375  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 218, 128])
m.shape torch.Size([1238, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.15731143951416016  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.15731143951416016  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.15790176391601562  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.20050287246704102  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst 0 shape torch.Size([1, 619, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.20050287246704102  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.20050287246704102  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.20109319686889648  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.24399280548095703  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst 1 shape torch.Size([1, 619, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.23185348510742188  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.23272180557250977  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.23359012603759766  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.23267793655395508  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

torch.Size([5827, 40])
input nodes number: 10536
output nodes number: 5827
edges number: 29445
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.23279619216918945  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.23279666900634766  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007582664489746094  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

pseudo mini batch 4 input nodes size: 10170
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.006997585296630859  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.006997585296630859  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.01184701919555664  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.011890888214111328  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.006823062896728516  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007090091705322266  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007090091705322266  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007090091705322266  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

m.shape torch.Size([636, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.024914264678955078  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.024914264678955078  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.025520801544189453  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.030448436737060547  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([608, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03072500228881836  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03072500228881836  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03130483627319336  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.040334224700927734  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([557, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.040841102600097656  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.040841102600097656  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04137229919433594  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.053925514221191406  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([483, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0545811653137207  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0545811653137207  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.05504179000854492  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06839990615844727  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([430, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06919479370117188  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06919479370117188  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06960487365722656  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08436775207519531  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([382, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08525562286376953  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08525562286376953  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 382, 128]), torch.Size([1, 382, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08561992645263672  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10128498077392578  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 382, 128])
m.shape torch.Size([305, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10212087631225586  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10212087631225586  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10241174697875977  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11695528030395508  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([269, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11783599853515625  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11783599853515625  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11809253692626953  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.13271522521972656  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([230, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1335740089416504  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1335740089416504  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.13379335403442383  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14783143997192383  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst.shape  torch.Size([1, 230, 128])
m.shape torch.Size([1946, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1578540802001953  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1578540802001953  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 973, 128]), torch.Size([1, 973, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1587820053100586  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2275829315185547  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

rst 0 shape torch.Size([1, 973, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2275829315185547  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2275829315185547  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

 h.shape torch.Size([1, 973, 128]), torch.Size([1, 973, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22851085662841797  GigaBytes
Max Memory Allocated: 0.2921895980834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2968478202819824  GigaBytes
Max Memory Allocated: 0.30195140838623047  GigaBytes

rst 1 shape torch.Size([1, 973, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2820272445678711  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2828984260559082  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2837696075439453  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2828545570373535  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

torch.Size([5846, 40])
input nodes number: 10170
output nodes number: 5846
edges number: 35714
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2829771041870117  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2829775810241699  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0075016021728515625  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

pseudo mini batch 5 input nodes size: 11597
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.006825923919677734  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.006825923919677734  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.012355804443359375  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.01239919662475586  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007505893707275391  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007753849029541016  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007753849029541016  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007753849029541016  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

m.shape torch.Size([755, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.024404048919677734  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.024404048919677734  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 755, 128]), torch.Size([1, 755, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.025124073028564453  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.031716346740722656  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 755, 128])
m.shape torch.Size([750, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.032071590423583984  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.032071590423583984  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 750, 128]), torch.Size([1, 750, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03278684616088867  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.043515682220458984  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 750, 128])
m.shape torch.Size([596, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04401063919067383  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04401063919067383  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04457902908325195  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.057651519775390625  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([510, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.05834007263183594  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.05834007263183594  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.058826446533203125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07293128967285156  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([401, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07364416122436523  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07364416122436523  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 401, 128]), torch.Size([1, 401, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07402658462524414  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08779382705688477  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 401, 128])
m.shape torch.Size([346, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.088592529296875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.088592529296875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08892250061035156  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10311126708984375  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([272, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10385417938232422  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10385417938232422  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 272, 128]), torch.Size([1, 272, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10411357879638672  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11708354949951172  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 272, 128])
m.shape torch.Size([234, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11784648895263672  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11784648895263672  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11806964874267578  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.13078975677490234  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 234, 128])
m.shape torch.Size([225, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.13164377212524414  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.13164377212524414  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 225, 128]), torch.Size([1, 225, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.13185834884643555  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14559125900268555  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 225, 128])
m.shape torch.Size([1721, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.15369033813476562  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.15369033813476562  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.154510498046875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21297550201416016  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 0 shape torch.Size([1, 860, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21297550201416016  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21297550201416016  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21379661560058594  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2716856002807617  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 1 shape torch.Size([1, 861, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.25811195373535156  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.25897789001464844  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2598438262939453  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.25893449783325195  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

torch.Size([5810, 40])
input nodes number: 11597
output nodes number: 5810
edges number: 33175
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.25905942916870117  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2590599060058594  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.008148670196533203  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

pseudo mini batch 6 input nodes size: 11862
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007500648498535156  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007500648498535156  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.013156890869140625  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.01320028305053711  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007627010345458984  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007860660552978516  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007860660552978516  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007860660552978516  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

m.shape torch.Size([932, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.023659229278564453  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.023659229278564453  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.024548053741455078  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03165864944458008  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([777, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03195524215698242  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03195524215698242  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 777, 128]), torch.Size([1, 777, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03269624710083008  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04381132125854492  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 777, 128])
m.shape torch.Size([664, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04439067840576172  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04439067840576172  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04502391815185547  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.059627532958984375  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([503, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06027030944824219  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06027030944824219  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06075000762939453  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0746612548828125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([389, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0753488540649414  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0753488540649414  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 389, 128]), torch.Size([1, 389, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07571983337402344  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08907508850097656  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 389, 128])
m.shape torch.Size([312, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0897822380065918  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0897822380065918  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 312, 128]), torch.Size([1, 312, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09007978439331055  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1028742790222168  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 312, 128])
m.shape torch.Size([243, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10353660583496094  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10353660583496094  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10376834869384766  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1153554916381836  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([210, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11604070663452148  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11604070663452148  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 210, 128]), torch.Size([1, 210, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1162409782409668  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1276564598083496  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 210, 128])
m.shape torch.Size([188, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12836313247680664  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12836313247680664  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 188, 128]), torch.Size([1, 188, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12854242324829102  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14001703262329102  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 188, 128])
m.shape torch.Size([1586, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1474900245666504  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1474900245666504  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14824628829956055  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.20201921463012695  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 0 shape torch.Size([1, 793, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.20201921463012695  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.20201921463012695  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2027754783630371  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2560920715332031  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 1 shape torch.Size([1, 793, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2434697151184082  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.24433469772338867  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.24519968032836914  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2442913055419922  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

torch.Size([5804, 40])
input nodes number: 11862
output nodes number: 5804
edges number: 31240
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.24442243576049805  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.24442291259765625  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.00824737548828125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

pseudo mini batch 7 input nodes size: 11270
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007626056671142578  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007626056671142578  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.013000011444091797  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.013041973114013672  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007342338562011719  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007590293884277344  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007590293884277344  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007590293884277344  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

m.shape torch.Size([736, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.024266719818115234  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.024266719818115234  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 736, 128]), torch.Size([1, 736, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.024968624114990234  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.031445980072021484  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 736, 128])
m.shape torch.Size([642, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0317072868347168  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0317072868347168  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03231954574584961  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04208230972290039  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([538, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04254579544067383  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04254579544067383  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04305887222290039  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0550694465637207  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([418, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.05561017990112305  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.05561017990112305  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.05600881576538086  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06756925582885742  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([376, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06826639175415039  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06826639175415039  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06862497329711914  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08153390884399414  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 376, 128])
m.shape torch.Size([311, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0822443962097168  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0822443962097168  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 311, 128]), torch.Size([1, 311, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08254098892211914  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09529447555541992  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 311, 128])
m.shape torch.Size([281, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0960841178894043  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0960841178894043  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 281, 128]), torch.Size([1, 281, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09635210037231445  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10975122451782227  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 281, 128])
m.shape torch.Size([252, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11057853698730469  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11057853698730469  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 252, 128]), torch.Size([1, 252, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11081886291503906  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12451744079589844  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 252, 128])
m.shape torch.Size([211, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12530279159545898  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12530279159545898  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1255040168762207  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1383824348449707  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 211, 128])
m.shape torch.Size([1833, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14702224731445312  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14702224731445312  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14789581298828125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21096324920654297  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 0 shape torch.Size([1, 916, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21096324920654297  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21096324920654297  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2118377685546875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.27437686920166016  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 1 shape torch.Size([1, 917, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2606363296508789  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2614707946777344  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.26230525970458984  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2614288330078125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

torch.Size([5598, 40])
input nodes number: 11270
output nodes number: 5598
edges number: 33264
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.26152467727661133  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.26152515411376953  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007955074310302734  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

pseudo mini batch 8 input nodes size: 14350
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007311820983886719  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007311820983886719  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.014154434204101562  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.014196395874023438  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.008780479431152344  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0089874267578125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0089874267578125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0089874267578125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

m.shape torch.Size([995, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.023093223571777344  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.023093223571777344  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 995, 128]), torch.Size([1, 995, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.024042129516601562  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03226137161254883  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 995, 128])
m.shape torch.Size([853, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03260040283203125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03260040283203125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 853, 128]), torch.Size([1, 853, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03341388702392578  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.045647621154785156  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 853, 128])
m.shape torch.Size([620, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0461277961730957  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0461277961730957  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04671907424926758  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0602574348449707  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([512, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.060938358306884766  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.060938358306884766  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.061426639556884766  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07558679580688477  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([448, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07641077041625977  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07641077041625977  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07683801651000977  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09221887588500977  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([297, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09285497665405273  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09285497665405273  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 297, 128]), torch.Size([1, 297, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09313821792602539  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10531759262084961  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 297, 128])
m.shape torch.Size([262, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10605049133300781  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10605049133300781  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10630035400390625  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11879348754882812  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 262, 128])
m.shape torch.Size([208, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1194620132446289  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1194620132446289  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 208, 128]), torch.Size([1, 208, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1196603775024414  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1309671401977539  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 208, 128])
m.shape torch.Size([176, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1316232681274414  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1316232681274414  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1317911148071289  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1425333023071289  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([1199, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14816665649414062  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14816665649414062  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14873790740966797  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1894054412841797  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 0 shape torch.Size([1, 599, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1894054412841797  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1894054412841797  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.18997764587402344  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.23049020767211914  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 1 shape torch.Size([1, 600, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21954059600830078  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22037076950073242  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22120094299316406  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22032880783081055  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

torch.Size([5570, 40])
input nodes number: 14350
output nodes number: 5570
edges number: 27703
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2204737663269043  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2204742431640625  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.009360313415527344  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

pseudo mini batch 9 input nodes size: 15742
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.008776187896728516  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.008776187896728516  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.01628255844116211  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.016323566436767578  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.00943899154663086  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.009654521942138672  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.009654521942138672  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.009654521942138672  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

m.shape torch.Size([973, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.02428436279296875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.02428436279296875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 973, 128]), torch.Size([1, 973, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.02521228790283203  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03286027908325195  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 973, 128])
m.shape torch.Size([807, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.033165931701660156  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.033165931701660156  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.033935546875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.045479774475097656  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([553, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04588603973388672  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04588603973388672  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.046413421630859375  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.05869579315185547  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([430, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.059252262115478516  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.059252262115478516  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0596623420715332  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07155466079711914  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([380, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07225561141967773  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07225561141967773  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07261800765991211  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08566427230834961  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([317, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08639001846313477  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08639001846313477  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08669233322143555  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09969186782836914  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([235, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10032510757446289  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10032510757446289  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10054922103881836  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1117548942565918  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 235, 128])
m.shape torch.Size([207, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11243247985839844  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11243247985839844  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 207, 128]), torch.Size([1, 207, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11262989044189453  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12388229370117188  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 207, 128])
m.shape torch.Size([156, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12445306777954102  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12445306777954102  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12460184097290039  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1341233253479004  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 156, 128])
m.shape torch.Size([1434, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14088678359985352  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14088678359985352  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1415705680847168  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1905045509338379  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 0 shape torch.Size([1, 717, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1905045509338379  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1905045509338379  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.19118833541870117  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.24055099487304688  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 1 shape torch.Size([1, 717, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22898006439208984  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2297987937927246  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.23061752319335938  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22975778579711914  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

torch.Size([5492, 40])
input nodes number: 15742
output nodes number: 5492
edges number: 28813
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2299046516418457  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2299051284790039  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.010037422180175781  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

pseudo mini batch 10 input nodes size: 12361
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.009427547454833984  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.009427547454833984  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.015321731567382812  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.015363216400146484  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.007815837860107422  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.00801992416381836  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.00801992416381836  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.00801992416381836  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

m.shape torch.Size([1002, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.021925926208496094  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.021925926208496094  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 1002, 128]), torch.Size([1, 1002, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.022881507873535156  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03092336654663086  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 1002, 128])
m.shape torch.Size([888, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03129243850708008  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03129243850708008  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 888, 128]), torch.Size([1, 888, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03213930130004883  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04484224319458008  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 888, 128])
m.shape torch.Size([679, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04539012908935547  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04539012908935547  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04603767395019531  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.060428619384765625  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 679, 128])
m.shape torch.Size([502, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06106233596801758  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06106233596801758  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.061541080474853516  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0754246711730957  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([387, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07610797882080078  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07610797882080078  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 387, 128]), torch.Size([1, 387, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07647705078125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08976364135742188  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 387, 128])
m.shape torch.Size([298, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09043169021606445  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09043169021606445  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 298, 128]), torch.Size([1, 298, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09071588516235352  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1029362678527832  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 298, 128])
m.shape torch.Size([248, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1036219596862793  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1036219596862793  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 248, 128]), torch.Size([1, 248, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10385847091674805  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11568403244018555  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 248, 128])
m.shape torch.Size([209, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1163630485534668  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1163630485534668  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 209, 128]), torch.Size([1, 209, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1165623664855957  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12792348861694336  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 209, 128])
m.shape torch.Size([170, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1285533905029297  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1285533905029297  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12871551513671875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.13909149169921875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 170, 128])
m.shape torch.Size([1180, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1446371078491211  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1446371078491211  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.14519977569580078  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.18589210510253906  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 0 shape torch.Size([1, 590, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.18589210510253906  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.18589210510253906  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.18645477294921875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22692394256591797  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 1 shape torch.Size([1, 590, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21617507934570312  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21700429916381836  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2178335189819336  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2169628143310547  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

torch.Size([5563, 40])
input nodes number: 12361
output nodes number: 5563
edges number: 27284
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21710729598999023  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21710777282714844  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.008389472961425781  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

pseudo mini batch 11 input nodes size: 12738
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.00782632827758789  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.00782632827758789  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.013957023620605469  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.014000415802001953  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.008064746856689453  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.00827646255493164  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.00827646255493164  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.00827646255493164  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

m.shape torch.Size([1058, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.02271556854248047  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.02271556854248047  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.02372455596923828  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03179645538330078  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([872, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.032123565673828125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.032123565673828125  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 872, 128]), torch.Size([1, 872, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.032955169677734375  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0457611083984375  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 872, 128])
m.shape torch.Size([725, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04638242721557617  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.04638242721557617  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 725, 128]), torch.Size([1, 725, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0470738410949707  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06293153762817383  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 725, 128])
m.shape torch.Size([504, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06354713439941406  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06354713439941406  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06402778625488281  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07796669006347656  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([498, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07891368865966797  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07891368865966797  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07938861846923828  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09648609161376953  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([342, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09722709655761719  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09722709655761719  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09755325317382812  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11157798767089844  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([246, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11223602294921875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11223602294921875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 246, 128]), torch.Size([1, 246, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.11247062683105469  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12420082092285156  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 246, 128])
m.shape torch.Size([244, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1250143051147461  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1250143051147461  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 244, 128]), torch.Size([1, 244, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12524700164794922  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.13851070404052734  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 244, 128])
m.shape torch.Size([207, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1392827033996582  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1392827033996582  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 207, 128]), torch.Size([1, 207, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1394801139831543  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1521143913269043  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 207, 128])
m.shape torch.Size([1124, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.15831851959228516  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.15831851959228516  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.15885448455810547  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1971445083618164  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 0 shape torch.Size([1, 562, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1971445083618164  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1971445083618164  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.19768047332763672  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.23593902587890625  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 1 shape torch.Size([1, 562, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22483205795288086  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22569942474365234  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22656679153442383  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22565603256225586  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

torch.Size([5820, 40])
input nodes number: 12738
output nodes number: 5820
edges number: 28312
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22583293914794922  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.22583341598510742  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.008687019348144531  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

pseudo mini batch 12 input nodes size: 18914
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.008102893829345703  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.008102893829345703  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.01712179183959961  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.017162799835205078  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.010988712310791016  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.01125192642211914  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.01125192642211914  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.01125192642211914  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

m.shape torch.Size([661, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.028879165649414062  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.028879165649414062  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 661, 128]), torch.Size([1, 661, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.029509544372558594  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.034725189208984375  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 661, 128])
m.shape torch.Size([561, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.034945011138916016  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.034945011138916016  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.03548002243041992  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.043505191802978516  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([445, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.043874263763427734  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.043874263763427734  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.044298648834228516  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0536351203918457  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([354, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.05409812927246094  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.05409812927246094  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 354, 128]), torch.Size([1, 354, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.05443572998046875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06422615051269531  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 354, 128])
m.shape torch.Size([319, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06481790542602539  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06481790542602539  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.06512212753295898  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07607412338256836  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([259, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07666301727294922  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07666301727294922  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.07691001892089844  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08753108978271484  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([209, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0881052017211914  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.0881052017211914  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 209, 128]), torch.Size([1, 209, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.08830451965332031  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09827041625976562  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 209, 128])
m.shape torch.Size([151, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09874677658081055  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09874677658081055  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.09889078140258789  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10709905624389648  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([154, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10768795013427734  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.10768795013427734  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 154, 128]), torch.Size([1, 154, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1078348159790039  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.1172342300415039  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 154, 128])
m.shape torch.Size([2357, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12839984893798828  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12839984893798828  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 1178, 128]), torch.Size([1, 1178, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.12952327728271484  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2098712921142578  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 0 shape torch.Size([1, 1178, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2098712921142578  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.2098712921142578  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 1179, 128]), torch.Size([1, 1179, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.21099567413330078  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.2902650833129883  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 1 shape torch.Size([1, 1179, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.27536487579345703  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.2761802673339844  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.2769956588745117  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.2761392593383789  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

torch.Size([5470, 40])
input nodes number: 18914
output nodes number: 5470
edges number: 35310
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.27626943588256836  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.27626991271972656  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.011665821075439453  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

pseudo mini batch 13 input nodes size: 19992
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.010936737060546875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.010936737060546875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.02046966552734375  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.020511627197265625  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.01145172119140625  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.011736869812011719  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.011736869812011719  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.011736869812011719  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

m.shape torch.Size([632, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.03077554702758789  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.03077554702758789  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.03137826919555664  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.036289215087890625  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([509, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.03647327423095703  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.03647327423095703  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.03695869445800781  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.04423999786376953  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([405, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.04457664489746094  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.04457664489746094  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 405, 128]), torch.Size([1, 405, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.04496288299560547  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.053460121154785156  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 405, 128])
m.shape torch.Size([321, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.0538792610168457  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.0538792610168457  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.05418539047241211  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.06306314468383789  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([251, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.06350851058959961  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.06350851058959961  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.06374788284301758  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.07236528396606445  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 251, 128])
m.shape torch.Size([204, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.0728292465209961  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.0728292465209961  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 204, 128]), torch.Size([1, 204, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.07302379608154297  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.0813894271850586  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 204, 128])
m.shape torch.Size([182, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.08189964294433594  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.08189964294433594  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.08207321166992188  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.09075164794921875  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 182, 128])
m.shape torch.Size([145, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.0912179946899414  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.0912179946899414  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 145, 128]), torch.Size([1, 145, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.09135627746582031  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.09923839569091797  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 145, 128])
m.shape torch.Size([167, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.09988594055175781  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.09988594055175781  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.10004520416259766  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.11023807525634766  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst.shape  torch.Size([1, 167, 128])
m.shape torch.Size([2768, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.12335729598999023  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.12335729598999023  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 1384, 128]), torch.Size([1, 1384, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.12467718124389648  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.21838903427124023  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

rst 0 shape torch.Size([1, 1384, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.21838903427124023  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.21838903427124023  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

 h.shape torch.Size([1, 1384, 128]), torch.Size([1, 1384, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.21970891952514648  GigaBytes
Max Memory Allocated: 0.3047819137573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.3127608299255371  GigaBytes
Max Memory Allocated: 0.3200201988220215  GigaBytes

rst 1 shape torch.Size([1, 1384, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2964162826538086  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29724836349487305  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2980804443359375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29720640182495117  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5584, 40])
input nodes number: 19992
output nodes number: 5584
edges number: 38245
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29741430282592773  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29741477966308594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012250900268554688  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 14 input nodes size: 22444
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01146841049194336  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01146841049194336  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.022170543670654297  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.022212505340576172  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012637615203857422  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012919902801513672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012919902801513672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012919902801513672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([617, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03172874450683594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03172874450683594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032317161560058594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.037362098693847656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([508, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0375523567199707  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0375523567199707  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03803682327270508  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0453038215637207  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([408, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04564523696899414  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04564523696899414  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04603433609008789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05459451675415039  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([327, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0550236701965332  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0550236701965332  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05533552169799805  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06437921524047852  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([282, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0648956298828125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0648956298828125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 282, 128]), torch.Size([1, 282, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06516456604003906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07484626770019531  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 282, 128])
m.shape torch.Size([247, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07541847229003906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07541847229003906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 247, 128]), torch.Size([1, 247, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0756540298461914  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08578300476074219  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 247, 128])
m.shape torch.Size([194, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08631277084350586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08631277084350586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 194, 128]), torch.Size([1, 194, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08649778366088867  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0957484245300293  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 194, 128])
m.shape torch.Size([171, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09630823135375977  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09630823135375977  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09647130966186523  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10576677322387695  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([169, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10641050338745117  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10641050338745117  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 169, 128]), torch.Size([1, 169, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10657167434692383  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11688661575317383  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 169, 128])
m.shape torch.Size([2648, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12943267822265625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12943267822265625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 1324, 128]), torch.Size([1, 1324, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13069534301757812  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22034454345703125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 1324, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22034454345703125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22034454345703125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 1324, 128]), torch.Size([1, 1324, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22160720825195312  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.3106250762939453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 1324, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.294522762298584  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2953529357910156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29618310928344727  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29531097412109375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5571, 40])
input nodes number: 22444
output nodes number: 5571
edges number: 37784
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2955183982849121  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2955188751220703  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013430595397949219  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 15 input nodes size: 20173
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01263570785522461  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01263570785522461  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02225494384765625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.022296428680419922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01155233383178711  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.011807918548583984  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.011807918548583984  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.011807918548583984  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([764, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.028975963592529297  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.028975963592529297  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.029704570770263672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.035814762115478516  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([641, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.036061763763427734  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.036061763763427734  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03667306900024414  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.045842647552490234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([482, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04622650146484375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04622650146484375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04668617248535156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05679893493652344  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([338, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.057213783264160156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.057213783264160156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05753612518310547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06688404083251953  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 338, 128])
m.shape torch.Size([311, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06746435165405273  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06746435165405273  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 311, 128]), torch.Size([1, 311, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06776094436645508  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07843828201293945  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 311, 128])
m.shape torch.Size([209, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.078887939453125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.078887939453125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 209, 128]), torch.Size([1, 209, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0790872573852539  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08765792846679688  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 209, 128])
m.shape torch.Size([182, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0881657600402832  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0881657600402832  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08833932876586914  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09701776504516602  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 182, 128])
m.shape torch.Size([166, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0975642204284668  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0975642204284668  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 166, 128]), torch.Size([1, 166, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09772253036499023  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10674619674682617  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes
[03:21:14] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14292522 edges into 16 parts and get 3013027 edge cuts

rst.shape  torch.Size([1, 166, 128])
m.shape torch.Size([127, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10721206665039062  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10721206665039062  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10733318328857422  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11508464813232422  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([2286, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12592458724975586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12592458724975586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 1143, 128]), torch.Size([1, 1143, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1270146369934082  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2044081687927246  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 1143, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2044081687927246  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2044081687927246  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 1143, 128]), torch.Size([1, 1143, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20549821853637695  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2823467254638672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 1143, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26798295974731445  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26880359649658203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2696242332458496  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26876211166381836  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5506, 40])
input nodes number: 20173
output nodes number: 5506
edges number: 34258
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26894474029541016  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26894521713256836  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012267112731933594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013327598571777344  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013327598571777344  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005232468247413635 |0.02105051279067993 |0.06606213748455048 |8.422136306762695e-05 |0.01665884256362915 |0.0033159255981445312 |
----------------------------------------------------------pseudo_mini_loss sum 3.8379828929901123
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  227575
Number of first layer input nodes during this epoch:  227575
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01332712173461914  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.013337135314941406
global_2_local spend time (sec) 0.03609132766723633
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003290891647338867
A = g.adjacency_matrix() spent  0.005571842193603516
auxiliary_graph
Graph(num_nodes=145011, num_edges=14383463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07357978820800781
remove nodes length
54070
auxiliary_graph.remove_nodes spent  0.6495351791381836
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14383463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6004550457000732

the counter of shared neighbor distribution
Counter({1.0: 12899386, 2.0: 1178670, 3.0: 168286, 4.0: 33534, 5.0: 8856, 6.0: 2754, 7.0: 796, 8.0: 198, 9.0: 40, 10.0: 2})
14292522
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14292519, 14292520, 14292521])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12899386, 2.0: 1178670, 3.0: 168286, 4.0: 33534, 5.0: 8856, 6.0: 2754, 7.0: 796, 8.0: 198, 9.0: 40, 10.0: 2})
Convert a graph into a bidirected graph: 0.648 seconds
Metis partitioning: 2.639 seconds
Split the graph: 0.470 seconds
Construct subgraphs: 0.085 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  3.8485305309295654
5741
5762
5621
5763
5761
5780
5846
5790
5740
5718
5567
5551
5605
5517
5564
5615
total k batches seeds list generation spend  8.973422050476074
after graph partition
graph partition algorithm spend time 9.043511867523193
5741
5762
5621
5763
5761
5780
5846
5790
5740
5718
5567
5551
5605
5517
5564
5615
partition_len_list
[10372, 10071, 12262, 11124, 12868, 12402, 10476, 10525, 12057, 12832, 15998, 17895, 20409, 21084, 19877, 22723]
shared_neighbor_graph_partition_s0 selection method  spend 9.129799842834473
time for parepare:  0.01741647720336914
local_output_nid generation:  0.0013098716735839844
local_in_edges_tensor generation:  0.0014045238494873047
mini_batch_src_global generation:  0.0013167858123779297
r_  generation:  0.011431694030761719
local_output_nid generation:  0.0013349056243896484
local_in_edges_tensor generation:  0.0012788772583007812
mini_batch_src_global generation:  0.0011970996856689453
r_  generation:  0.011359930038452148
local_output_nid generation:  0.0013308525085449219
local_in_edges_tensor generation:  0.0011844635009765625
mini_batch_src_global generation:  0.0011632442474365234
r_  generation:  0.009962797164916992
local_output_nid generation:  0.0014705657958984375
local_in_edges_tensor generation:  0.0012090206146240234
mini_batch_src_global generation:  0.0012454986572265625
r_  generation:  0.012016773223876953
local_output_nid generation:  0.0014445781707763672
local_in_edges_tensor generation:  0.0011730194091796875
mini_batch_src_global generation:  0.001268148422241211
r_  generation:  0.010311603546142578
local_output_nid generation:  0.0014369487762451172
local_in_edges_tensor generation:  0.0011835098266601562
mini_batch_src_global generation:  0.0011458396911621094
r_  generation:  0.012084722518920898
local_output_nid generation:  0.0015213489532470703
local_in_edges_tensor generation:  0.0011675357818603516
mini_batch_src_global generation:  0.0013065338134765625
r_  generation:  0.010820865631103516
local_output_nid generation:  0.001539468765258789
local_in_edges_tensor generation:  0.0011425018310546875
mini_batch_src_global generation:  0.0012156963348388672
r_  generation:  0.01000356674194336
local_output_nid generation:  0.0014896392822265625
local_in_edges_tensor generation:  0.0011093616485595703
mini_batch_src_global generation:  0.0010619163513183594
r_  generation:  0.00935816764831543
local_output_nid generation:  0.0015079975128173828
local_in_edges_tensor generation:  0.001125335693359375
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.009594440460205078
local_output_nid generation:  0.0014791488647460938
local_in_edges_tensor generation:  0.001194000244140625
mini_batch_src_global generation:  0.0012781620025634766
r_  generation:  0.009929418563842773
local_output_nid generation:  0.0015413761138916016
local_in_edges_tensor generation:  0.0011429786682128906
mini_batch_src_global generation:  0.00131988525390625
r_  generation:  0.00997161865234375
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0011508464813232422
mini_batch_src_global generation:  0.0012722015380859375
r_  generation:  0.012866973876953125
local_output_nid generation:  0.0015082359313964844
local_in_edges_tensor generation:  0.0011966228485107422
mini_batch_src_global generation:  0.0012257099151611328
r_  generation:  0.012824535369873047
local_output_nid generation:  0.0015423297882080078
local_in_edges_tensor generation:  0.0011157989501953125
mini_batch_src_global generation:  0.0014109611511230469
r_  generation:  0.010606765747070312
local_output_nid generation:  0.0016148090362548828
local_in_edges_tensor generation:  0.0012831687927246094
mini_batch_src_global generation:  0.0012784004211425781
r_  generation:  0.01235651969909668
----------------------check_connections_block total spend ----------------------------- 0.31499648094177246
generate_one_block  0.021487712860107422
generate_one_block  0.01663684844970703
generate_one_block  0.01519632339477539
generate_one_block  0.015385627746582031
generate_one_block  0.014849424362182617
generate_one_block  0.01541447639465332
generate_one_block  0.015109539031982422
generate_one_block  0.01313471794128418
generate_one_block  0.012432575225830078
generate_one_block  0.013067007064819336
generate_one_block  0.014746665954589844
generate_one_block  0.01505279541015625
generate_one_block  0.019103050231933594
generate_one_block  0.019902944564819336
generate_one_block  0.01704549789428711
generate_one_block  0.018525123596191406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01332712173461914  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

connection checking time:  0.31499648094177246
block generation total time  0.25709033012390137
average batch blocks generation time:  0.016068145632743835
block dataloader generation time/epoch 9.762037515640259
pseudo mini batch 0 input nodes size: 10372
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01260232925415039  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01260232925415039  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.017548084259033203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.017590999603271484  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007930278778076172  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008181095123291016  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008181095123291016  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008181095123291016  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([691, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025014877319335938  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025014877319335938  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025673866271972656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.031807899475097656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([677, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03212404251098633  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03212404251098633  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03276968002319336  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04245424270629883  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([599, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04298830032348633  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04298830032348633  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04355955123901367  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.056127071380615234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([485, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.056766510009765625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.056766510009765625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.057229042053222656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07064247131347656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([399, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07136249542236328  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07136249542236328  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07174301147460938  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08544158935546875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 399, 128])
m.shape torch.Size([361, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08631706237792969  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08631706237792969  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08666133880615234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10146522521972656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([301, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10231971740722656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10231971740722656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 301, 128]), torch.Size([1, 301, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10260677337646484  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1169595718383789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 301, 128])
m.shape torch.Size([250, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11776971817016602  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11776971817016602  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 250, 128]), torch.Size([1, 250, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11800813674926758  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13159799575805664  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 250, 128])
m.shape torch.Size([206, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13236284255981445  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13236284255981445  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 206, 128]), torch.Size([1, 206, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13255929946899414  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14513254165649414  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 206, 128])
m.shape torch.Size([1772, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15348386764526367  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15348386764526367  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 886, 128]), torch.Size([1, 886, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1543288230895996  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21705198287963867  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 886, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21705198287963867  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21705198287963867  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 886, 128]), torch.Size([1, 886, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2178969383239746  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.28029298782348633  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 886, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2664618492126465  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2673177719116211  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2681736946105957  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2672748565673828  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5741, 40])
input nodes number: 10372
output nodes number: 5741
edges number: 33624
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26743078231811523  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26743173599243164  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008610248565673828  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 1 input nodes size: 10071
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00796651840209961  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00796651840209961  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012932777404785156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01297616958618164  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007987499237060547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008234500885009766  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008234500885009766  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008234500885009766  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([749, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02483510971069336  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02483510971069336  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 749, 128]), torch.Size([1, 749, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02554941177368164  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032164573669433594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 749, 128])
m.shape torch.Size([710, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03248453140258789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03248453140258789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 710, 128]), torch.Size([1, 710, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03316164016723633  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04331827163696289  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 710, 128])
m.shape torch.Size([601, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.043839454650878906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.043839454650878906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04441261291503906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05744791030883789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([508, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05813026428222656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05813026428222656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05861473083496094  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07266426086425781  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([408, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.073394775390625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.073394775390625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07378387451171875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08779144287109375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([331, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08854389190673828  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08854389190673828  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08885955810546875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1024332046508789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([274, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10318994522094727  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10318994522094727  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10345125198364258  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1165165901184082  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 274, 128])
m.shape torch.Size([224, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11724042892456055  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11724042892456055  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 224, 128]), torch.Size([1, 224, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11745405197143555  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12963056564331055  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 224, 128])
m.shape torch.Size([231, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13051509857177734  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13051509857177734  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1307353973388672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1448345184326172  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([1726, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1529545783996582  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1529545783996582  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1537775993347168  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21221208572387695  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 863, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21221208572387695  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21221208572387695  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21303510665893555  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2710580825805664  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 863, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2575063705444336  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2583651542663574  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25922393798828125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25832176208496094  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5762, 40])
input nodes number: 10071
output nodes number: 5762
edges number: 33079
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25844335556030273  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25844383239746094  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008625030517578125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 2 input nodes size: 12262
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007990360260009766  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007990360260009766  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013837337493896484  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01387929916381836  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008869647979736328  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009091854095458984  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009091854095458984  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009091854095458984  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([909, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02417469024658203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02417469024658203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025041580200195312  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03209543228149414  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([762, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03238868713378906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03238868713378906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 762, 128]), torch.Size([1, 762, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.033115386962890625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04401588439941406  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 762, 128])
m.shape torch.Size([645, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04457521438598633  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04457521438598633  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 645, 128]), torch.Size([1, 645, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04519033432006836  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05876588821411133  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 645, 128])
m.shape torch.Size([500, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05941200256347656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05941200256347656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05988883972167969  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07371711730957031  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([407, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07444906234741211  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07444906234741211  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07483720779418945  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08881044387817383  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([307, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08949470520019531  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08949470520019531  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 307, 128]), torch.Size([1, 307, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08978748321533203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10237693786621094  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 307, 128])
m.shape torch.Size([251, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10306835174560547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10306835174560547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10330772399902344  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11527633666992188  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 251, 128])
m.shape torch.Size([217, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11598443984985352  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11598443984985352  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 217, 128]), torch.Size([1, 217, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11619138717651367  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12798738479614258  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 217, 128])
m.shape torch.Size([165, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12859201431274414  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12859201431274414  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12874937057495117  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13882017135620117  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 165, 128])
m.shape torch.Size([1458, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14569377899169922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14569377899169922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 729, 128]), torch.Size([1, 729, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14638900756835938  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19668102264404297  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 729, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19668102264404297  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19668102264404297  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 729, 128]), torch.Size([1, 729, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19737625122070312  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24658441543579102  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 729, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23459482192993164  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23543262481689453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23627042770385742  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23539066314697266  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5621, 40])
input nodes number: 12262
output nodes number: 5621
edges number: 29803
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2355031967163086  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2355036735534668  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009447574615478516  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 3 input nodes size: 11124
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00884866714477539  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00884866714477539  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014153003692626953  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014196395874023438  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008307456970214844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008565902709960938  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008565902709960938  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008565902709960938  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([687, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02590799331665039  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02590799331665039  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.026563167572021484  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03218269348144531  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([651, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032475948333740234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032475948333740234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0330967903137207  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04322099685668945  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([556, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04370594024658203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04370594024658203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.044236183166503906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05631446838378906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([454, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.056915283203125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.056915283203125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05734825134277344  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06990432739257812  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([405, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07065343856811523  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07065343856811523  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 405, 128]), torch.Size([1, 405, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07103967666625977  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08494424819946289  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 405, 128])
m.shape torch.Size([331, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08569812774658203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08569812774658203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0860137939453125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09958744049072266  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([293, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10040760040283203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10040760040283203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 293, 128]), torch.Size([1, 293, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10068702697753906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11465835571289062  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 293, 128])
m.shape torch.Size([248, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11546468734741211  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11546468734741211  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 248, 128]), torch.Size([1, 248, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11570119857788086  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1291823387145996  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 248, 128])
m.shape torch.Size([228, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13004255294799805  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13004255294799805  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 228, 128]), torch.Size([1, 228, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13025999069213867  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14417600631713867  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 228, 128])
m.shape torch.Size([1910, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15317487716674805  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15317487716674805  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 955, 128]), torch.Size([1, 955, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15408563613891602  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2187495231628418  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 955, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2187495231628418  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2187495231628418  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 955, 128]), torch.Size([1, 955, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21966028213500977  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.28386878967285156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 955, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26990365982055664  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.27076244354248047  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2716212272644043  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.270719051361084  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5763, 40])
input nodes number: 11124
output nodes number: 5763
edges number: 34671
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.27086639404296875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.27086687088012695  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00899362564086914  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 4 input nodes size: 12868
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008328437805175781  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008328437805175781  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014464378356933594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014507770538330078  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009160041809082031  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009383201599121094  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009383201599121094  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009383201599121094  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([961, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.024548053741455078  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.024548053741455078  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025464534759521484  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03320741653442383  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([822, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03353309631347656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03353309631347656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0343170166015625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04611349105834961  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([636, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0466313362121582  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0466313362121582  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04723787307739258  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.061467647552490234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([475, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.062070369720458984  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.062070369720458984  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06252336502075195  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07566022872924805  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([453, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07651376724243164  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07651376724243164  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 453, 128]), torch.Size([1, 453, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07694578170776367  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0924983024597168  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 453, 128])
m.shape torch.Size([348, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0932779312133789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0932779312133789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09360980987548828  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1078805923461914  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 348, 128])
m.shape torch.Size([266, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10860252380371094  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10860252380371094  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 266, 128]), torch.Size([1, 266, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.108856201171875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12154006958007812  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 266, 128])
m.shape torch.Size([267, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12243175506591797  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12243175506591797  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12268638610839844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13720035552978516  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 267, 128])
m.shape torch.Size([189, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13788414001464844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13788414001464844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 189, 128]), torch.Size([1, 189, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13806438446044922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14960002899169922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 189, 128])
m.shape torch.Size([1344, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15591859817504883  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15591859817504883  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 672, 128]), torch.Size([1, 672, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15655946731567383  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2026214599609375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 672, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2026214599609375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2026214599609375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 672, 128]), torch.Size([1, 672, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2032623291015625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.249053955078125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 672, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2371058464050293  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23796463012695312  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23882341384887695  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23792123794555664  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5761, 40])
input nodes number: 12868
output nodes number: 5761
edges number: 29905
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23806095123291016  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23806142807006836  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009768009185791016  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 5 input nodes size: 12402
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009160041809082031  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009160041809082031  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.015073776245117188  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.015117168426513672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008937835693359375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00919342041015625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00919342041015625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00919342041015625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([717, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0263214111328125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0263214111328125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02700519561767578  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03296613693237305  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([677, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03326988220214844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03326988220214844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03391551971435547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04360008239746094  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([572, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.044095516204833984  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.044095516204833984  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04464101791381836  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.056780338287353516  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([484, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05743074417114258  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05743074417114258  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0578923225402832  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07127809524536133  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([409, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0720224380493164  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0720224380493164  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07241249084472656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08645439147949219  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([295, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08710336685180664  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08710336685180664  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 295, 128]), torch.Size([1, 295, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08738470077514648  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09948205947875977  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 295, 128])
m.shape torch.Size([295, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1003260612487793  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1003260612487793  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 295, 128]), torch.Size([1, 295, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10060739517211914  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11467409133911133  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 295, 128])
m.shape torch.Size([258, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11551761627197266  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11551761627197266  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11576366424560547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12978839874267578  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 258, 128])
m.shape torch.Size([202, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13053226470947266  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13053226470947266  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 202, 128]), torch.Size([1, 202, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13072490692138672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14305400848388672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 202, 128])
m.shape torch.Size([1871, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15187931060791016  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15187931060791016  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 935, 128]), torch.Size([1, 935, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15277099609375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2160806655883789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 935, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2160806655883789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2160806655883789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 936, 128]), torch.Size([1, 936, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21697330474853516  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.279904842376709  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 936, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26650047302246094  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.267362117767334  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26822376251220703  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2673187255859375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5780, 40])
input nodes number: 12402
output nodes number: 5780
edges number: 34195
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2674574851989746  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2674579620361328  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009609699249267578  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 6 input nodes size: 10476
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008940696716308594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008940696716308594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013936042785644531  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013979911804199219  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008022785186767578  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00825643539428711  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00825643539428711  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00825643539428711  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([877, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02406454086303711  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02406454086303711  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02490091323852539  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03159189224243164  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([788, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.031925201416015625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.031925201416015625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03267669677734375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.043949127197265625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([640, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04448890686035156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04448890686035156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 640, 128]), torch.Size([1, 640, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04509925842285156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.058745384216308594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 640, 128])
m.shape torch.Size([539, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05946826934814453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05946826934814453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0599822998046875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0749521255493164  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([432, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07572507858276367  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07572507858276367  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 432, 128]), torch.Size([1, 432, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07613706588745117  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09096860885620117  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 432, 128])
m.shape torch.Size([340, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0917353630065918  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0917353630065918  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09205961227416992  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1060023307800293  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([322, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10691499710083008  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10691499710083008  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10722208023071289  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12257623672485352  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([261, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12341833114624023  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12341833114624023  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12366724014282227  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13785505294799805  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([231, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13872194290161133  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13872194290161133  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13894224166870117  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15304136276245117  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([1416, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1596832275390625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1596832275390625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 708, 128]), torch.Size([1, 708, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.16035842895507812  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20950841903686523  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 708, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20950841903686523  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20950841903686523  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 708, 128]), torch.Size([1, 708, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21018362045288086  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2590365409851074  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 708, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.246978759765625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2478499412536621  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24872112274169922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24780607223510742  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5846, 40])
input nodes number: 10476
output nodes number: 5846
edges number: 31310
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24793767929077148  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2479381561279297  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008643627166748047  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 7 input nodes size: 10525
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00803232192993164  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00803232192993164  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013946056365966797  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013989448547363281  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008950233459472656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009166717529296875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009166717529296875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009166717529296875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([961, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.023869991302490234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.023869991302490234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02478647232055664  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03234720230102539  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([870, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032718658447265625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032718658447265625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03354835510253906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.045993804931640625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([674, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.046543121337890625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.046543121337890625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04718589782714844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06132698059082031  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([529, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06209564208984375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06209564208984375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06260013580322266  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07767295837402344  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([479, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07856273651123047  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07856273651123047  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07901954650878906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09546470642089844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([371, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0962977409362793  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0962977409362793  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 371, 128]), torch.Size([1, 371, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09665155410766602  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11186552047729492  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 371, 128])
m.shape torch.Size([288, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11264991760253906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11264991760253906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11292457580566406  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12665748596191406  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([261, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1275157928466797  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1275157928466797  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12776470184326172  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1419525146484375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([186, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14262628555297852  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14262628555297852  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 186, 128]), torch.Size([1, 186, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14280366897583008  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15415620803833008  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 186, 128])
m.shape torch.Size([1171, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1596512794494629  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1596512794494629  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.16020917892456055  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20130252838134766  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 585, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20130252838134766  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20130252838134766  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20186138153076172  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24233293533325195  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 586, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2308945655822754  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23175764083862305  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2326207160949707  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23171424865722656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5790, 40])
input nodes number: 10525
output nodes number: 5790
edges number: 28948
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2318282127380371  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2318286895751953  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009519100189208984  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 8 input nodes size: 12057
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008942127227783203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008942127227783203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014691352844238281  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014734268188476562  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008777141571044922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008980274200439453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008980274200439453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008980274200439453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([1091, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02286529541015625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02286529541015625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02390575408935547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03222942352294922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([911, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0325779914855957  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0325779914855957  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0334467887878418  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0464930534362793  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([720, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04709291458129883  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04709291458129883  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 720, 128]), torch.Size([1, 720, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04777956008911133  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06288576126098633  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 720, 128])
m.shape torch.Size([560, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06382465362548828  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06382465362548828  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06435871124267578  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07984638214111328  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([443, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08063554763793945  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08063554763793945  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08105802536010742  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0962672233581543  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([299, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09691143035888672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09691143035888672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09719657897949219  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10945796966552734  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([239, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11011314392089844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11011314392089844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 239, 128]), torch.Size([1, 239, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11034107208251953  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12173748016357422  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 239, 128])
m.shape torch.Size([218, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12245512008666992  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12245512008666992  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12266302108764648  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13451337814331055  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 218, 128])
m.shape torch.Size([190, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1352248191833496  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1352248191833496  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1354060173034668  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1470026969909668  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 190, 128])
m.shape torch.Size([1069, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1520094871520996  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1520094871520996  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15251874923706055  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.18981266021728516  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 534, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.18981266021728516  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.18981266021728516  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1903228759765625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2264423370361328  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 535, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21586990356445312  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21672534942626953  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21758079528808594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21668243408203125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5740, 40])
input nodes number: 12057
output nodes number: 5740
edges number: 27139
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21680784225463867  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21680831909179688  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009330272674560547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 9 input nodes size: 12832
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008769512176513672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008769512176513672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014888286590576172  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014931201934814453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009139060974121094  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009346961975097656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009346961975097656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009346961975097656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([1067, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02356863021850586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02356863021850586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.024586200714111328  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032868385314941406  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([874, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.033193111419677734  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.033193111419677734  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0340266227722168  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.046611785888671875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([664, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04714488983154297  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04714488983154297  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04777812957763672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06250429153442383  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([536, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06321001052856445  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06321001052856445  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0637211799621582  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07898759841918945  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([433, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07976436614990234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07976436614990234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 433, 128]), torch.Size([1, 433, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08017730712890625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09504318237304688  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 433, 128])
m.shape torch.Size([342, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09581518173217773  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09581518173217773  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09614133834838867  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11016607284545898  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([233, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11078071594238281  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11078071594238281  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 233, 128]), torch.Size([1, 233, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11100292205810547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12211322784423828  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 233, 128])
m.shape torch.Size([222, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1228489875793457  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1228489875793457  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 222, 128]), torch.Size([1, 222, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12306070327758789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13512849807739258  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 222, 128])
m.shape torch.Size([186, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13582086563110352  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13582086563110352  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 186, 128]), torch.Size([1, 186, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13599824905395508  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14735078811645508  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 186, 128])
m.shape torch.Size([1161, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15279817581176758  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15279817581176758  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1533513069152832  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19341564178466797  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 580, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19341564178466797  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19341564178466797  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1939697265625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23442745208740234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 581, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2234792709350586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22433137893676758  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22518348693847656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2242884635925293  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5718, 40])
input nodes number: 12832
output nodes number: 5718
edges number: 27859
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22442388534545898  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2244243621826172  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009711742401123047  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 10 input nodes size: 15998
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009135723114013672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009135723114013672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.016764163970947266  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.016805648803710938  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.010643959045410156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.010866165161132812  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.010866165161132812  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.010866165161132812  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([938, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025970458984375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025970458984375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 938, 128]), torch.Size([1, 938, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.026865005493164062  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03402137756347656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 938, 128])
m.shape torch.Size([819, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03435516357421875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03435516357421875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03513622283935547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04702425003051758  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([562, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04743766784667969  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04743766784667969  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0479736328125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05992412567138672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([417, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.060451507568359375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.060451507568359375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06084918975830078  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07238197326660156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 417, 128])
m.shape torch.Size([379, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07308673858642578  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07308673858642578  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07344818115234375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08646011352539062  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([298, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08713197708129883  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08713197708129883  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 298, 128]), torch.Size([1, 298, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08741617202758789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09963655471801758  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 298, 128])
m.shape torch.Size([259, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10035896301269531  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10035896301269531  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10060596466064453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11295604705810547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([200, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11359548568725586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11359548568725586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 200, 128]), torch.Size([1, 200, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11378622055053711  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12465810775756836  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 200, 128])
m.shape torch.Size([157, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12523651123046875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12523651123046875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 157, 128]), torch.Size([1, 157, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12538623809814453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13496875762939453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 157, 128])
m.shape torch.Size([1538, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1422276496887207  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1422276496887207  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1429610252380371  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19625139236450195  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 769, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19625139236450195  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19625139236450195  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19698476791381836  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24961471557617188  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 769, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23757171630859375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2384014129638672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23923110961914062  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23835992813110352  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5567, 40])
input nodes number: 15998
output nodes number: 5567
edges number: 29819
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23849821090698242  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23849868774414062  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.011247634887695312  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 11 input nodes size: 17895
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01062154769897461  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01062154769897461  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01915454864501953  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.019196033477783203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.011526107788085938  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.011751174926757812  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.011751174926757812  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.011751174926757812  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([942, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.027031898498535156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.027031898498535156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.027930259704589844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.035117149353027344  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([788, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.035419464111328125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.035419464111328125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03617095947265625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04755735397338867  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([588, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04802274703979492  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04802274703979492  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 588, 128]), torch.Size([1, 588, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0485835075378418  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06141519546508789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 588, 128])
m.shape torch.Size([413, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.061922550201416016  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.061922550201416016  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0623164176940918  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07373857498168945  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([348, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.074371337890625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.074371337890625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07470321655273438  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08665084838867188  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 348, 128])
m.shape torch.Size([267, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0872488021850586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0872488021850586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08750343322753906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09845256805419922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 267, 128])
m.shape torch.Size([217, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09904956817626953  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09904956817626953  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 217, 128]), torch.Size([1, 217, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09925651550292969  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1096038818359375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 217, 128])
m.shape torch.Size([171, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1101527214050293  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1101527214050293  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11031579971313477  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11961126327514648  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([153, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12018632888793945  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12018632888793945  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 153, 128]), torch.Size([1, 153, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12033224105834961  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1296706199645996  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 153, 128])
m.shape torch.Size([1664, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13753223419189453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13753223419189453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13832569122314453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19563770294189453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 832, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19563770294189453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19563770294189453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19643115997314453  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25334644317626953  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 832, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24109411239624023  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24192142486572266  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24274873733520508  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24187994003295898  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5551, 40])
input nodes number: 17895
output nodes number: 5551
edges number: 30180
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24205255508422852  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24205303192138672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012169837951660156  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 12 input nodes size: 20409
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.011523723602294922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.011523723602294922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0212554931640625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.021297454833984375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012722969055175781  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013003349304199219  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013003349304199219  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013003349304199219  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([615, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03173542022705078  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03173542022705078  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032321929931640625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0374298095703125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([515, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0376276969909668  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0376276969909668  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.038118839263916016  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0454859733581543  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([427, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04585123062133789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04585123062133789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04625844955444336  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05521726608276367  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([337, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05565643310546875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05565643310546875  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.055977821350097656  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06529808044433594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([319, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06589794158935547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06589794158935547  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06620216369628906  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07715415954589844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([249, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07771444320678711  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07771444320678711  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 249, 128]), torch.Size([1, 249, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07795190811157227  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08816289901733398  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 249, 128])
m.shape torch.Size([211, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08874845504760742  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08874845504760742  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08894968032836914  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09901094436645508  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 211, 128])
m.shape torch.Size([175, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0995779037475586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0995779037475586  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 175, 128]), torch.Size([1, 175, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09974479675292969  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10925769805908203  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 175, 128])
m.shape torch.Size([182, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1099553108215332  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1099553108215332  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11012887954711914  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12123727798461914  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 182, 128])
m.shape torch.Size([2575, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13342905044555664  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13342905044555664  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 1287, 128]), torch.Size([1, 1287, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13465642929077148  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2218003273010254  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 1287, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2218003273010254  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2218003273010254  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 1288, 128]), torch.Size([1, 1288, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22302865982055664  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.30962657928466797  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 1 shape torch.Size([1, 1288, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29363155364990234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2944669723510742  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2953023910522461  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29442501068115234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

torch.Size([5605, 40])
input nodes number: 20409
output nodes number: 5605
edges number: 37628
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29462718963623047  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29462766647338867  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013506889343261719  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

pseudo mini batch 13 input nodes size: 21084
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012731075286865234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012731075286865234  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.022784709930419922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.022826194763183594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01305246353149414  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01333761215209961  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01333761215209961  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01333761215209961  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

m.shape torch.Size([607, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032367706298828125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032367706298828125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03294658660888672  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.037709712982177734  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([481, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.037878990173339844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.037878990173339844  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03833770751953125  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.045218467712402344  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([408, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.045572757720947266  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.045572757720947266  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.045961856842041016  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.054522037506103516  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([316, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05493021011352539  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05493021011352539  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.055231571197509766  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06397104263305664  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([227, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.064361572265625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.064361572265625  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 227, 128]), torch.Size([1, 227, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06457805633544922  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0723714828491211  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 227, 128])
m.shape torch.Size([209, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0728611946105957  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0728611946105957  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 209, 128]), torch.Size([1, 209, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07306051254272461  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08163118362426758  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 209, 128])
m.shape torch.Size([157, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08205556869506836  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08205556869506836  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 157, 128]), torch.Size([1, 157, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08220529556274414  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0896916389465332  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 157, 128])
m.shape torch.Size([142, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09015846252441406  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09015846252441406  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09029388427734375  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09801292419433594  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 142, 128])
m.shape torch.Size([126, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09848594665527344  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09848594665527344  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 126, 128]), torch.Size([1, 126, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09860610961914062  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10629653930664062  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst.shape  torch.Size([1, 126, 128])
m.shape torch.Size([2844, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1197977066040039  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1197977066040039  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 1422, 128]), torch.Size([1, 1422, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1211538314819336  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2196207046508789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

rst 0 shape torch.Size([1, 1422, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2196207046508789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2196207046508789  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

 h.shape torch.Size([1, 1422, 128]), torch.Size([1, 1422, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2209768295288086  GigaBytes
Max Memory Allocated: 0.32013750076293945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.31931114196777344  GigaBytes
Max Memory Allocated: 0.3267698287963867  GigaBytes

rst 1 shape torch.Size([1, 1422, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.30291223526000977  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.30373477935791016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.30455732345581055  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.3036932945251465  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5517, 40])
input nodes number: 21084
output nodes number: 5517
edges number: 38255
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.3038792610168457  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.3038797378540039  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013829708099365234  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 14 input nodes size: 19877
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013039588928222656  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013039588928222656  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.022517681121826172  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.022559165954589844  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012464046478271484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012699604034423828  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012699604034423828  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012699604034423828  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([878, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.028603076934814453  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.028603076934814453  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02944040298461914  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03613901138305664  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([751, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03643655776977539  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03643655776977539  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 751, 128]), torch.Size([1, 751, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.037152767181396484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04789590835571289  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 751, 128])
m.shape torch.Size([530, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04829597473144531  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04829597473144531  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.048801422119140625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06026411056518555  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([395, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06076478958129883  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06076478958129883  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0611414909362793  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07206583023071289  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([360, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07273578643798828  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07273578643798828  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07307910919189453  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08543872833251953  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([289, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08609390258789062  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08609390258789062  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08636951446533203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0982208251953125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([223, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09882736206054688  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09882736206054688  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 223, 128]), torch.Size([1, 223, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09904003143310547  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10967350006103516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 223, 128])
m.shape torch.Size([170, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11021566390991211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11021566390991211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11037778854370117  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11961889266967773  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 170, 128])
m.shape torch.Size([157, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12021160125732422  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12021160125732422  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 157, 128]), torch.Size([1, 157, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.120361328125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12994384765625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 157, 128])
m.shape torch.Size([1811, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1385045051574707  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1385045051574707  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13936758041381836  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2023940086364746  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 905, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2023940086364746  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2023940086364746  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 906, 128]), torch.Size([1, 906, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20325803756713867  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26575374603271484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 906, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25282955169677734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2536587715148926  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2544879913330078  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2536172866821289  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5564, 40])
input nodes number: 19877
output nodes number: 5564
edges number: 31528
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2538137435913086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2538142204284668  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013152599334716797  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 15 input nodes size: 22723
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012470722198486328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012470722198486328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.023305892944335938  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.023347854614257812  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013828277587890625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014093399047851562  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014093399047851562  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014093399047851562  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([738, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03183937072753906  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03183937072753906  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032543182373046875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.038173675537109375  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([610, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03840351104736328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03840351104736328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.038985252380371094  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.047821044921875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([455, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04818105697631836  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04818105697631836  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0486149787902832  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.058161258697509766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([372, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.058653831481933594  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.058653831481933594  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05900859832763672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06929683685302734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([321, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0698847770690918  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0698847770690918  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0701909065246582  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08121156692504883  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([231, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08171939849853516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08171939849853516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.081939697265625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09141254425048828  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([216, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09202337265014648  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09202337265014648  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 216, 128]), torch.Size([1, 216, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09222936630249023  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10252904891967773  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 216, 128])
m.shape torch.Size([188, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10314321517944336  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10314321517944336  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 188, 128]), torch.Size([1, 188, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10332250595092773  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11354207992553711  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 188, 128])
m.shape torch.Size([187, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11425495147705078  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11425495147705078  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 187, 128]), torch.Size([1, 187, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11443328857421875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12584686279296875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 187, 128])
m.shape torch.Size([2297, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13671064376831055  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13671064376831055  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 1148, 128]), torch.Size([1, 1148, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13780546188354492  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21553754806518555  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 1148, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21553754806518555  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21553754806518555  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21663331985473633  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2938857078552246  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 1149, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2789912223815918  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2798280715942383  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.28066492080688477  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2797861099243164  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes
[03:21:25] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14284864 edges into 16 parts and get 2874894 edge cuts

torch.Size([5615, 40])
input nodes number: 22723
output nodes number: 5615
edges number: 35471
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.28000545501708984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.28000593185424805  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014598846435546875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014598846435546875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014598846435546875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00867442786693573 |0.0005533099174499512 |0.03607781231403351 |8.33272933959961e-05 |0.017959490418434143 |0.002763509750366211 |
----------------------------------------------------------pseudo_mini_loss sum 3.2689833641052246
Total (block generation + training)time/epoch 10.854646444320679
* Pure training time/epoch 1.0163373947143555
Training time/epoch 1.0921356678009033
Training time without block to device /epoch 1.083282709121704
Training time without total dataloading part /epoch 0.8686935901641846
load block tensor time/epoch 0.13879084587097168
block to device time/epoch 0.008852958679199219
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  232975
Number of first layer input nodes during this epoch:  232975
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014598369598388672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0163724422454834
global_2_local spend time (sec) 0.046413421630859375
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003390073776245117
A = g.adjacency_matrix() spent  0.0065762996673583984
auxiliary_graph
Graph(num_nodes=145027, num_edges=14375805,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07561755180358887
remove nodes length
54086
auxiliary_graph.remove_nodes spent  0.6380727291107178
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14375805,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.5997369289398193

the counter of shared neighbor distribution
Counter({1.0: 12899956, 2.0: 1173186, 3.0: 165808, 4.0: 33362, 5.0: 8940, 6.0: 2608, 7.0: 762, 8.0: 204, 9.0: 36, 10.0: 2})
14284864
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14284861, 14284862, 14284863])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12899956, 2.0: 1173186, 3.0: 165808, 4.0: 33362, 5.0: 8940, 6.0: 2608, 7.0: 762, 8.0: 204, 9.0: 36, 10.0: 2})
Convert a graph into a bidirected graph: 0.661 seconds
Metis partitioning: 2.712 seconds
Split the graph: 0.543 seconds
Construct subgraphs: 0.169 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.092468023300171
5818
5804
5793
5807
5797
5644
5811
5527
5578
5534
5488
5758
5770
5668
5592
5552
total k batches seeds list generation spend  9.220336437225342
after graph partition
graph partition algorithm spend time 9.296560764312744
5818
5804
5793
5807
5797
5644
5811
5527
5578
5534
5488
5758
5770
5668
5592
5552
partition_len_list
[12814, 12738, 11504, 10069, 9892, 10087, 11684, 11785, 21881, 19088, 19846, 21242, 12193, 11714, 16726, 15607]
shared_neighbor_graph_partition_s0 selection method  spend 9.402108669281006
time for parepare:  0.018049955368041992
local_output_nid generation:  0.0013892650604248047
local_in_edges_tensor generation:  0.0015075206756591797
mini_batch_src_global generation:  0.0015330314636230469
r_  generation:  0.010768651962280273
local_output_nid generation:  0.0016040802001953125
local_in_edges_tensor generation:  0.001390218734741211
mini_batch_src_global generation:  0.001394510269165039
r_  generation:  0.012836933135986328
local_output_nid generation:  0.0017917156219482422
local_in_edges_tensor generation:  0.00136566162109375
mini_batch_src_global generation:  0.0013017654418945312
r_  generation:  0.011129379272460938
local_output_nid generation:  0.0018382072448730469
local_in_edges_tensor generation:  0.0012810230255126953
mini_batch_src_global generation:  0.0010788440704345703
r_  generation:  0.009345293045043945
local_output_nid generation:  0.0017843246459960938
local_in_edges_tensor generation:  0.001367330551147461
mini_batch_src_global generation:  0.0027108192443847656
r_  generation:  0.012923002243041992
local_output_nid generation:  0.0024194717407226562
local_in_edges_tensor generation:  0.0015130043029785156
mini_batch_src_global generation:  0.0012984275817871094
r_  generation:  0.009948968887329102
local_output_nid generation:  0.002017498016357422
local_in_edges_tensor generation:  0.0012810230255126953
mini_batch_src_global generation:  0.0010423660278320312
r_  generation:  0.011877059936523438
local_output_nid generation:  0.0018880367279052734
local_in_edges_tensor generation:  0.0012552738189697266
mini_batch_src_global generation:  0.001318216323852539
r_  generation:  0.010689020156860352
local_output_nid generation:  0.0018918514251708984
local_in_edges_tensor generation:  0.0012178421020507812
mini_batch_src_global generation:  0.0011391639709472656
r_  generation:  0.013350486755371094
local_output_nid generation:  0.0019996166229248047
local_in_edges_tensor generation:  0.0012764930725097656
mini_batch_src_global generation:  0.0014193058013916016
r_  generation:  0.011339664459228516
local_output_nid generation:  0.001997232437133789
local_in_edges_tensor generation:  0.001283884048461914
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.012214422225952148
local_output_nid generation:  0.0020368099212646484
local_in_edges_tensor generation:  0.0013682842254638672
mini_batch_src_global generation:  0.0012061595916748047
r_  generation:  0.014909982681274414
local_output_nid generation:  0.002136707305908203
local_in_edges_tensor generation:  0.0012853145599365234
mini_batch_src_global generation:  0.0012788772583007812
r_  generation:  0.010387659072875977
local_output_nid generation:  0.002081155776977539
local_in_edges_tensor generation:  0.001216888427734375
mini_batch_src_global generation:  0.0011167526245117188
r_  generation:  0.009253978729248047
local_output_nid generation:  0.001972198486328125
local_in_edges_tensor generation:  0.0012121200561523438
mini_batch_src_global generation:  0.0013079643249511719
r_  generation:  0.010409832000732422
local_output_nid generation:  0.001957416534423828
local_in_edges_tensor generation:  0.0011892318725585938
mini_batch_src_global generation:  0.0011663436889648438
r_  generation:  0.010219812393188477
----------------------check_connections_block total spend ----------------------------- 0.32987332344055176
generate_one_block  0.0300905704498291
generate_one_block  0.017079830169677734
generate_one_block  0.016533613204956055
generate_one_block  0.013182640075683594
generate_one_block  0.015775442123413086
generate_one_block  0.01462244987487793
generate_one_block  0.015313863754272461
generate_one_block  0.015961647033691406
generate_one_block  0.020314931869506836
generate_one_block  0.01650071144104004
generate_one_block  0.022221088409423828
generate_one_block  0.03220510482788086
generate_one_block  0.014590978622436523
generate_one_block  0.012525320053100586
generate_one_block  0.014906644821166992
generate_one_block  0.014255046844482422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014598369598388672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

connection checking time:  0.32987332344055176
block generation total time  0.28607988357543945
average batch blocks generation time:  0.017879992723464966
block dataloader generation time/epoch 9.926147937774658
pseudo mini batch 0 input nodes size: 12814
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013834953308105469  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013834953308105469  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.019945144653320312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.019988536834716797  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009111404418945312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009354591369628906  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009354591369628906  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009354591369628906  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([809, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025726795196533203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025726795196533203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02649831771850586  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03359699249267578  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([768, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03394365310668945  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03394365310668945  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03467607498168945  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04566240310668945  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([607, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.046164512634277344  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.046164512634277344  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04674339294433594  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06036710739135742  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([497, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06102561950683594  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06102561950683594  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.061499595642089844  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07524490356445312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([413, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0760507583618164  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0760507583618164  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07644462585449219  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09062385559082031  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([329, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09136819839477539  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09136819839477539  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09168195724487305  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10517358779907227  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([279, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10594797134399414  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10594797134399414  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 279, 128]), torch.Size([1, 279, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10621404647827148  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11951780319213867  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 279, 128])
m.shape torch.Size([278, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12044525146484375  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12044525146484375  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 278, 128]), torch.Size([1, 278, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12071037292480469  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13582229614257812  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 278, 128])
m.shape torch.Size([205, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13656949996948242  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13656949996948242  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1367650032043457  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1492772102355957  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 205, 128])
m.shape torch.Size([1633, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1569662094116211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1569662094116211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1577444076538086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2147054672241211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 816, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2147054672241211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2147054672241211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.215484619140625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2729215621948242  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 817, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.259671688079834  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26053905487060547  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26140642166137695  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.260495662689209  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5818, 40])
input nodes number: 12814
output nodes number: 5818
edges number: 32545
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2606654167175293  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2606663703918457  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009790420532226562  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 1 input nodes size: 12738
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009142875671386719  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009142875671386719  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.015216827392578125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01526021957397461  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009106636047363281  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009358406066894531  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009358406066894531  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009358406066894531  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([789, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.026323795318603516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.026323795318603516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.027076244354248047  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03350400924682617  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([692, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03378772735595703  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03378772735595703  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.034447669982910156  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04434680938720703  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 692, 128])
m.shape torch.Size([571, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04483366012573242  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04483366012573242  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04537820816040039  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05812406539916992  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([473, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05875396728515625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05875396728515625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.059205055236816406  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07228660583496094  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([397, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07300758361816406  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07300758361816406  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 397, 128]), torch.Size([1, 397, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07338619232177734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08701610565185547  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 397, 128])
m.shape torch.Size([317, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08773374557495117  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08773374557495117  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08803606033325195  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10103559494018555  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([282, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10182571411132812  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10182571411132812  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 282, 128]), torch.Size([1, 282, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10209465026855469  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11554145812988281  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 282, 128])
m.shape torch.Size([235, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1163034439086914  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1163034439086914  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11652755737304688  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1293020248413086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 235, 128])
m.shape torch.Size([207, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13007831573486328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13007831573486328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 207, 128]), torch.Size([1, 207, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13027572631835938  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14291000366210938  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 207, 128])
m.shape torch.Size([1841, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15158987045288086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15158987045288086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1524672508239746  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2159276008605957  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 920, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2159276008605957  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2159276008605957  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21680593490600586  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.27936410903930664  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 921, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26546382904052734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2663288116455078  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2671937942504883  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26628541946411133  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5804, 40])
input nodes number: 12738
output nodes number: 5804
edges number: 33792
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2664217948913574  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2664222717285156  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009768486022949219  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 2 input nodes size: 11504
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009104251861572266  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009104251861572266  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014589786529541016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0146331787109375  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00851583480834961  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008754253387451172  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008754253387451172  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008754253387451172  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([831, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.024827003479003906  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.024827003479003906  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0256195068359375  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03195953369140625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([767, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03229475021362305  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03229475021362305  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 767, 128]), torch.Size([1, 767, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03302621841430664  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0440983772277832  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 767, 128])
m.shape torch.Size([604, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04459667205810547  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04459667205810547  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.045172691345214844  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.057971954345703125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([511, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.058658599853515625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.058658599853515625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05914592742919922  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07327842712402344  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([426, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07418155670166016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07418155670166016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07458782196044922  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08921337127685547  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([322, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08993148803710938  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08993148803710938  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09023857116699219  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10344314575195312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([320, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10435771942138672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10435771942138672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10466289520263672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11992168426513672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([263, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1207723617553711  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1207723617553711  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 263, 128]), torch.Size([1, 263, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12102317810058594  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13531970977783203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 263, 128])
m.shape torch.Size([210, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13609552383422852  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13609552383422852  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 210, 128]), torch.Size([1, 210, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13629579544067383  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14911317825317383  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 210, 128])
m.shape torch.Size([1539, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15635156631469727  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15635156631469727  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15708494186401367  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2103571891784668  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 769, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2103571891784668  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2103571891784668  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 770, 128]), torch.Size([1, 770, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2110915184020996  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26374340057373047  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 770, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2508091926574707  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25167274475097656  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2525362968444824  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2516293525695801  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5793, 40])
input nodes number: 11504
output nodes number: 5793
edges number: 31907
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2517571449279785  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2517576217651367  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009142398834228516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 3 input nodes size: 10069
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008514404296875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008514404296875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013315677642822266  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01335906982421875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007830142974853516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008028507232666016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008028507232666016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008028507232666016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([1092, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.021665096282958984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.021665096282958984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02270650863647461  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03103780746459961  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([959, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03143167495727539  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03143167495727539  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032346248626708984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04627180099487305  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([750, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04688739776611328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04688739776611328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 750, 128]), torch.Size([1, 750, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04760265350341797  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06354141235351562  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 750, 128])
m.shape torch.Size([552, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06423664093017578  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06423664093017578  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06476306915283203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08007144927978516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([492, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08098125457763672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08098125457763672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0814504623413086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0983419418334961  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([343, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09908866882324219  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09908866882324219  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 343, 128]), torch.Size([1, 343, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09941577911376953  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11348152160644531  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 343, 128])
m.shape torch.Size([314, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11436605453491211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11436605453491211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 314, 128]), torch.Size([1, 314, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11466550827026367  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1296381950378418  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 314, 128])
m.shape torch.Size([220, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13032770156860352  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13032770156860352  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 220, 128]), torch.Size([1, 220, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1305375099182129  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14249658584594727  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 220, 128])
m.shape torch.Size([173, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14313411712646484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14313411712646484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14329910278320312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15385818481445312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 173, 128])
m.shape torch.Size([912, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15812444686889648  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15812444686889648  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15855932235717773  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.18943548202514648  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 456, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.18943548202514648  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.18943548202514648  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.18987035751342773  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22052907943725586  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 456, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21027183532714844  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2111372947692871  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21200275421142578  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21109390258789062  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5807, 40])
input nodes number: 10069
output nodes number: 5807
edges number: 26621
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21121454238891602  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21121501922607422  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00836944580078125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 4 input nodes size: 9892
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007832050323486328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007832050323486328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01254892349243164  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012592315673828125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007747650146484375  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008012771606445312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008012771606445312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008012771606445312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([590, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02573871612548828  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02573871612548828  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02630138397216797  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.031129837036132812  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 590, 128])
m.shape torch.Size([600, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03142070770263672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03142070770263672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03199291229248047  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04081869125366211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([574, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.041353702545166016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.041353702545166016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0419011116027832  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.053955078125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([474, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05458545684814453  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05458545684814453  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.055037498474121094  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0681467056274414  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([431, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06894826889038086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06894826889038086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06935930252075195  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08415651321411133  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([390, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0850667953491211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0850667953491211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08543872833251953  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10143184661865234  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([324, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10232734680175781  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10232734680175781  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 324, 128]), torch.Size([1, 324, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10263633728027344  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11808586120605469  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 324, 128])
m.shape torch.Size([270, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11896133422851562  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11896133422851562  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 270, 128]), torch.Size([1, 270, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11921882629394531  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1338958740234375  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 270, 128])
m.shape torch.Size([217, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13469839096069336  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13469839096069336  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 217, 128]), torch.Size([1, 217, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13490533828735352  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14814996719360352  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 217, 128])
m.shape torch.Size([1927, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15723514556884766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15723514556884766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15815353393554688  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22432565689086914  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 963, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22432565689086914  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22432565689086914  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 964, 128]), torch.Size([1, 964, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22524499893188477  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29005908966064453  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 964, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2755117416381836  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.27637577056884766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2772397994995117  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.27633237838745117  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5797, 40])
input nodes number: 9892
output nodes number: 5797
edges number: 35554
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.27644824981689453  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.27644872665405273  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008415699005126953  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 5 input nodes size: 10087
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007746219635009766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007746219635009766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012556076049804688  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012598514556884766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007838249206542969  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008056640625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008056640625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008056640625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([908, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.022882938385009766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.022882938385009766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02374887466430664  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03068399429321289  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([786, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.031000614166259766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.031000614166259766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 786, 128]), torch.Size([1, 786, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03175020217895508  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.042994022369384766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 786, 128])
m.shape torch.Size([666, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04357194900512695  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04357194900512695  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.044207096099853516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05818033218383789  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([542, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05894184112548828  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05894184112548828  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05945873260498047  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07516241073608398  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([401, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07586002349853516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07586002349853516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 401, 128]), torch.Size([1, 401, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07624244689941406  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09000968933105469  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 401, 128])
m.shape torch.Size([340, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09079122543334961  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09079122543334961  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09111547470092773  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10505819320678711  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([253, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10574054718017578  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10574054718017578  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10598182678222656  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11804580688476562  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 253, 128])
m.shape torch.Size([230, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11880254745483398  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11880254745483398  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11902189254760742  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13152456283569336  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 230, 128])
m.shape torch.Size([217, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13234615325927734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13234615325927734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 217, 128]), torch.Size([1, 217, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1325531005859375  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1457977294921875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 217, 128])
m.shape torch.Size([1301, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15189790725708008  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15189790725708008  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.15251779556274414  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1983942985534668  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 650, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1983942985534668  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1983942985534668  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19901514053344727  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24460649490356445  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 651, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23291873931884766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23375988006591797  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23460102081298828  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2337174415588379  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5644, 40])
input nodes number: 10087
output nodes number: 5644
edges number: 29265
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2338123321533203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23381280899047852  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008391380310058594  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 6 input nodes size: 11684
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007815361022949219  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.007815361022949219  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013386726379394531  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013430118560791016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008577823638916016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00882577896118164  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00882577896118164  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.00882577896118164  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([880, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025533199310302734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025533199310302734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 880, 128]), torch.Size([1, 880, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.026372432708740234  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.033444881439208984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 880, 128])
m.shape torch.Size([752, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.033742427825927734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.033742427825927734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 752, 128]), torch.Size([1, 752, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.034459590911865234  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.045217037200927734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 752, 128])
m.shape torch.Size([587, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04569816589355469  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04569816589355469  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.046257972717285156  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.058890342712402344  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([451, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05947065353393555  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05947065353393555  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.059900760650634766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07237386703491211  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([355, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07300519943237305  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07300519943237305  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07334375381469727  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08553171157836914  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([288, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08618640899658203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08618640899658203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08646106719970703  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09827136993408203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([225, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09888505935668945  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09888505935668945  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 225, 128]), torch.Size([1, 225, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09909963607788086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10982847213745117  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 225, 128])
m.shape torch.Size([205, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1105031967163086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1105031967163086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11069869995117188  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1218423843383789  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 205, 128])
m.shape torch.Size([179, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1225128173828125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1225128173828125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 179, 128]), torch.Size([1, 179, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12268352508544922  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13360881805419922  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 179, 128])
m.shape torch.Size([1889, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1425309181213379  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1425309181213379  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1434311866760254  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20755529403686523  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 944, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20755529403686523  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20755529403686523  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20845651626586914  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.27199316024780273  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 945, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25838232040405273  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2592482566833496  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2601141929626465  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2592048645019531  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5811, 40])
input nodes number: 11684
output nodes number: 5811
edges number: 33168
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25936031341552734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25936079025268555  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009251117706298828  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 7 input nodes size: 11785
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008602619171142578  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008602619171142578  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014222145080566406  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014263629913330078  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008648872375488281  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008889198303222656  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008889198303222656  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008889198303222656  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([743, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025058269500732422  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025058269500732422  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 743, 128]), torch.Size([1, 743, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.025766849517822266  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.031435489654541016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 743, 128])
m.shape torch.Size([652, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03170299530029297  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03170299530029297  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 652, 128]), torch.Size([1, 652, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032324790954589844  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04216814041137695  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 652, 128])
m.shape torch.Size([545, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.042636871337890625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.042636871337890625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04315662384033203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.055246829986572266  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([452, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05584907531738281  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05584907531738281  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05628013610839844  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06878089904785156  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([380, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06947135925292969  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06947135925292969  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06983375549316406  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08288002014160156  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([296, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08354568481445312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08354568481445312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 296, 128]), torch.Size([1, 296, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08382797241210938  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09596633911132812  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 296, 128])
m.shape torch.Size([281, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09676313400268555  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09676313400268555  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 281, 128]), torch.Size([1, 281, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0970311164855957  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11043024063110352  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 281, 128])
m.shape torch.Size([246, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11123466491699219  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11123466491699219  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 246, 128]), torch.Size([1, 246, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11146926879882812  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12484169006347656  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 246, 128])
m.shape torch.Size([208, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12561702728271484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12561702728271484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 208, 128]), torch.Size([1, 208, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12581539154052734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13851070404052734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 208, 128])
m.shape torch.Size([1724, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14663219451904297  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14663219451904297  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14745426177978516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20639705657958984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 862, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20639705657958984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20639705657958984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20721912384033203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26517486572265625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 862, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25192880630493164  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25275278091430664  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25357675552368164  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25271129608154297  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5527, 40])
input nodes number: 11785
output nodes number: 5527
edges number: 32213
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25279903411865234  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25279951095581055  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.009238243103027344  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 8 input nodes size: 21881
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008606910705566406  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.008606910705566406  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.019040584564208984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01908254623413086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01342153549194336  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013700008392333984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013700008392333984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013700008392333984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([616, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032268524169921875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032268524169921875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.032855987548828125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.038130760192871094  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([555, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03836631774902344  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03836631774902344  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.038895606994628906  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.047231197357177734  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([435, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04758882522583008  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04758882522583008  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0480036735534668  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05713033676147461  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([321, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05753517150878906  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05753517150878906  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05784130096435547  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06671905517578125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([304, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0672907829284668  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0672907829284668  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 304, 128]), torch.Size([1, 304, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0675806999206543  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0780177116394043  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 304, 128])
m.shape torch.Size([238, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07855367660522461  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07855367660522461  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 238, 128]), torch.Size([1, 238, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0787806510925293  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08854055404663086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 238, 128])
m.shape torch.Size([190, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08906126022338867  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08906126022338867  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08924245834350586  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09830236434936523  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 190, 128])
m.shape torch.Size([166, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09884500503540039  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09884500503540039  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 166, 128]), torch.Size([1, 166, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09900331497192383  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10802698135375977  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 166, 128])
m.shape torch.Size([161, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10863876342773438  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10863876342773438  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 161, 128]), torch.Size([1, 161, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10879230499267578  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11861896514892578  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 161, 128])
m.shape torch.Size([2592, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13090181350708008  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13090181350708008  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 1296, 128]), torch.Size([1, 1296, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13213777542114258  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21989107131958008  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 1296, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21989107131958008  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21989107131958008  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 1296, 128]), torch.Size([1, 1296, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.22112703323364258  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.30826234817504883  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 1296, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29241275787353516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2932443618774414  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29407596588134766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29320240020751953  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5578, 40])
input nodes number: 21881
output nodes number: 5578
edges number: 37290
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2934150695800781  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.29341554641723633  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01421213150024414  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 9 input nodes size: 19088
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01342916488647461  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.01342916488647461  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02253103256225586  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.02257251739501953  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012096881866455078  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012318134307861328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012318134307861328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012318134307861328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([956, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.027354717254638672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.027354717254638672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 956, 128]), torch.Size([1, 956, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.028266429901123047  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03556013107299805  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 956, 128])
m.shape torch.Size([747, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03581666946411133  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03581666946411133  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0365290641784668  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04752922058105469  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([566, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04798269271850586  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04798269271850586  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0485224723815918  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.06080007553100586  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([454, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.061396121978759766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.061396121978759766  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0618290901184082  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07438516616821289  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([397, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07511520385742188  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07511520385742188  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 397, 128]), torch.Size([1, 397, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07549381256103516  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08912372589111328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 397, 128])
m.shape torch.Size([278, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08972978591918945  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08972978591918945  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 278, 128]), torch.Size([1, 278, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08999490737915039  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1013951301574707  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 278, 128])
m.shape torch.Size([251, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10210037231445312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10210037231445312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1023397445678711  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11430835723876953  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 251, 128])
m.shape torch.Size([202, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1149592399597168  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1149592399597168  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 202, 128]), torch.Size([1, 202, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11515188217163086  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12613248825073242  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 202, 128])
m.shape torch.Size([155, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12670135498046875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12670135498046875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 155, 128]), torch.Size([1, 155, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12684917449951172  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13630962371826172  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 155, 128])
m.shape torch.Size([1528, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14352178573608398  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14352178573608398  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.14425039291381836  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19785070419311523  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 764, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19785070419311523  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.19785070419311523  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.1985793113708496  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.25112104415893555  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 764, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23914003372192383  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23996496200561523  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24078989028930664  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.23992347717285156  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5534, 40])
input nodes number: 19088
output nodes number: 5534
edges number: 29665
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24010086059570312  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.24010133743286133  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012737751007080078  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 10 input nodes size: 19846
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012090206146240234  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.012090206146240234  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.022519588470458984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.022560596466064453  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013417243957519531  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013669967651367188  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013669967651367188  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013669967651367188  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([745, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.030652999877929688  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.030652999877929688  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 745, 128]), torch.Size([1, 745, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.031363487243652344  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03757190704345703  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 745, 128])
m.shape torch.Size([601, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03778982162475586  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.03778982162475586  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.038362979888916016  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04776334762573242  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([490, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04817771911621094  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04817771911621094  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.04864501953125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.058925628662109375  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([379, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05941486358642578  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05941486358642578  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.05977630615234375  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07025814056396484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([331, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07086658477783203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.07086658477783203  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0711822509765625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08254623413085938  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([243, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0830836296081543  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.0830836296081543  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.08331537246704102  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09328031539916992  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([216, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09388542175292969  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09388542175292969  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 216, 128]), torch.Size([1, 216, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.09409141540527344  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10439109802246094  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 216, 128])
m.shape torch.Size([165, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10491752624511719  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10491752624511719  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.10507488250732422  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.114044189453125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 165, 128])
m.shape torch.Size([158, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11464357376098633  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11464357376098633  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 158, 128]), torch.Size([1, 158, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.11479425430297852  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.12443780899047852  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 158, 128])
m.shape torch.Size([2160, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13466215133666992  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13466215133666992  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.13569211959838867  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20881986618041992  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 1080, 128])
----------------------------------------1
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20881986618041992  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20881986618041992  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.20984983444213867  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.28246259689331055  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 1 shape torch.Size([1, 1080, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2682919502258301  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26910972595214844  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.2699275016784668  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26906871795654297  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

torch.Size([5488, 40])
input nodes number: 19846
output nodes number: 5488
edges number: 33900
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26925086975097656  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.26925134658813477  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.014125347137451172  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

pseudo mini batch 11 input nodes size: 21242
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013410091400146484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013410091400146484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.023539066314697266  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.023581981658935547  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013111591339111328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013431072235107422  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013431072235107422  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.013431072235107422  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

m.shape torch.Size([489, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03464460372924805  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03464460372924805  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0351109504699707  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03884172439575195  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([428, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0390167236328125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0390167236328125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.039424896240234375  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0455474853515625  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([330, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.045815467834472656  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.045815467834472656  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.04613018035888672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.053053855895996094  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 330, 128])
m.shape torch.Size([259, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0533905029296875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0533905029296875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.05363750457763672  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06080055236816406  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([241, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06125164031982422  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06125164031982422  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 241, 128]), torch.Size([1, 241, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.061481475830078125  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06975555419921875  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 241, 128])
m.shape torch.Size([214, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07025289535522461  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07025289535522461  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 214, 128]), torch.Size([1, 214, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07045698165893555  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07923269271850586  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 214, 128])
m.shape torch.Size([164, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07967805862426758  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07967805862426758  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 164, 128]), torch.Size([1, 164, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0798344612121582  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08765459060668945  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 164, 128])
m.shape torch.Size([159, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08818292617797852  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08818292617797852  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 159, 128]), torch.Size([1, 159, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08833456039428711  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.09697771072387695  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 159, 128])
m.shape torch.Size([156, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.09757137298583984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.09757137298583984  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.09772014617919922  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.10724163055419922  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst.shape  torch.Size([1, 156, 128])
m.shape torch.Size([3318, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12298870086669922  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12298870086669922  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 1659, 128]), torch.Size([1, 1659, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12457084655761719  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.23963069915771484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

rst 0 shape torch.Size([1, 1659, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.23963069915771484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.23963069915771484  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

 h.shape torch.Size([1, 1659, 128]), torch.Size([1, 1659, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.2412128448486328  GigaBytes
Max Memory Allocated: 0.3269472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3554816246032715  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst 1 shape torch.Size([1, 1659, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3368825912475586  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3377408981323242  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.33859920501708984  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.33769798278808594  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

torch.Size([5758, 40])
input nodes number: 21242
output nodes number: 5758
edges number: 42864
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3379397392272949  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.3379402160644531  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.01401376724243164  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

pseudo mini batch 12 input nodes size: 12193
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.013152122497558594  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.013152122497558594  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.018966197967529297  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.01900959014892578  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.008837699890136719  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.009053230285644531  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.009053230285644531  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.009053230285644531  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

m.shape torch.Size([980, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.023741722106933594  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.023741722106933594  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 980, 128]), torch.Size([1, 980, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.02467632293701172  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03215312957763672  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 980, 128])
m.shape torch.Size([871, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0325164794921875  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0325164794921875  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.033347129821777344  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.04621410369873047  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([668, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.04675436019897461  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.04675436019897461  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.047391414642333984  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.062342166900634766  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([517, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06300973892211914  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06300973892211914  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06350278854370117  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0785527229309082  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([478, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07944583892822266  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07944583892822266  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07990169525146484  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0963125228881836  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([336, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0970458984375  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0970458984375  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 336, 128]), torch.Size([1, 336, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0973663330078125  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11114501953125  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 336, 128])
m.shape torch.Size([273, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11189603805541992  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11189603805541992  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 273, 128]), torch.Size([1, 273, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11215639114379883  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12517404556274414  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 273, 128])
m.shape torch.Size([244, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1259746551513672  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1259746551513672  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 244, 128]), torch.Size([1, 244, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1262073516845703  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.13947105407714844  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 244, 128])
m.shape torch.Size([190, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.14017009735107422  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.14017009735107422  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1403512954711914  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1519479751586914  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 190, 128])
m.shape torch.Size([1213, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.15764141082763672  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.15764141082763672  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 606, 128]), torch.Size([1, 606, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1582193374633789  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.19965457916259766  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst 0 shape torch.Size([1, 606, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.19965457916259766  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.19965457916259766  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.20023345947265625  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.2410449981689453  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst 1 shape torch.Size([1, 607, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.22960996627807617  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.2304701805114746  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.23133039474487305  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.23042678833007812  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

torch.Size([5770, 40])
input nodes number: 12193
output nodes number: 5770
edges number: 28903
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.23056316375732422  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.23056364059448242  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.009427070617675781  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

pseudo mini batch 13 input nodes size: 11714
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.008839607238769531  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.008839607238769531  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.014425277709960938  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.014467716217041016  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.008610248565673828  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.008800983428955078  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.008800983428955078  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.008800983428955078  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

m.shape torch.Size([1099, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.02192401885986328  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.02192401885986328  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.02297210693359375  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0313568115234375  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([973, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03176069259643555  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03176069259643555  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 973, 128]), torch.Size([1, 973, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03268861770629883  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.04660749435424805  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 973, 128])
m.shape torch.Size([753, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.04789924621582031  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.04789924621582031  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 753, 128]), torch.Size([1, 753, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.04861736297607422  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06508731842041016  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 753, 128])
m.shape torch.Size([567, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06580972671508789  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06580972671508789  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06635046005249023  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08250284194946289  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([431, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08326005935668945  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08326005935668945  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08367109298706055  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.09846830368041992  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([339, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.09923267364501953  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.09923267364501953  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 339, 128]), torch.Size([1, 339, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.09955596923828125  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11345767974853516  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 339, 128])
m.shape torch.Size([225, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11404705047607422  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11404705047607422  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 225, 128]), torch.Size([1, 225, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11426162719726562  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12499046325683594  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 225, 128])
m.shape torch.Size([192, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12561559677124023  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12561559677124023  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 192, 128]), torch.Size([1, 192, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12579870223999023  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.13623571395874023  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 192, 128])
m.shape torch.Size([198, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1369938850402832  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1369938850402832  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 198, 128]), torch.Size([1, 198, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.13718271255493164  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.14926767349243164  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 198, 128])
m.shape torch.Size([891, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.15342187881469727  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.15342187881469727  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.15384626388549805  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.18397760391235352  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst 0 shape torch.Size([1, 445, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.18397760391235352  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.18397760391235352  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1844029426574707  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.21438980102539062  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst 1 shape torch.Size([1, 446, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.20457792282104492  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.20542287826538086  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.2062678337097168  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.20538043975830078  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

torch.Size([5668, 40])
input nodes number: 11714
output nodes number: 5668
edges number: 25564
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.20549535751342773  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.20549583435058594  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.009128093719482422  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

pseudo mini batch 14 input nodes size: 16726
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.008594989776611328  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.008594989776611328  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.016570568084716797  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.016612529754638672  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.010984420776367188  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0112152099609375  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0112152099609375  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0112152099609375  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

m.shape torch.Size([914, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.02686166763305664  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.02686166763305664  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.027733325958251953  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03470659255981445  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([754, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03498983383178711  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03498983383178711  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 754, 128]), torch.Size([1, 754, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03570890426635742  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.047678470611572266  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 754, 128])
m.shape torch.Size([549, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.048104286193847656  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.048104286193847656  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.04862785339355469  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0603790283203125  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([446, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06096792221069336  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06096792221069336  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06139326095581055  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07372808456420898  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([360, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07437372207641602  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07437372207641602  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07471704483032227  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08707666397094727  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([290, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08773469924926758  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08773469924926758  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 290, 128]), torch.Size([1, 290, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08801126480102539  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.09990358352661133  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 290, 128])
m.shape torch.Size([224, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.10051298141479492  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.10051298141479492  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 224, 128]), torch.Size([1, 224, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.10072660446166992  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11140775680541992  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 224, 128])
m.shape torch.Size([188, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11201810836791992  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11201810836791992  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 188, 128]), torch.Size([1, 188, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1121973991394043  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12241697311401367  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 188, 128])
m.shape torch.Size([171, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1230611801147461  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1230611801147461  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12322425842285156  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.13366127014160156  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([1696, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.14166688919067383  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.14166688919067383  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.14247560501098633  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.20013856887817383  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst 0 shape torch.Size([1, 848, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.20013856887817383  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.20013856887817383  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.20094728469848633  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.2582058906555176  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst 1 shape torch.Size([1, 848, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.24559307098388672  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.24642658233642578  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.24726009368896484  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.2463846206665039  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

torch.Size([5592, 40])
input nodes number: 16726
output nodes number: 5592
edges number: 30964
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.24654006958007812  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.24654054641723633  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.011622428894042969  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

pseudo mini batch 15 input nodes size: 15607
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.010972976684570312  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.010972976684570312  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.018414974212646484  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.018456459045410156  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.010438919067382812  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.010657310485839844  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.010657310485839844  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.010657310485839844  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

m.shape torch.Size([987, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.02548503875732422  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.02548503875732422  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.026426315307617188  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03395652770996094  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([801, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03424978256225586  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.03424978256225586  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.035013675689697266  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.046787261962890625  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([582, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.04723787307739258  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.04723787307739258  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.047792911529541016  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06035137176513672  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([425, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06088447570800781  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06088447570800781  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.06128978729248047  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0730438232421875  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([385, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07375907897949219  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.07375907897949219  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 385, 128]), torch.Size([1, 385, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0741262435913086  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08734416961669922  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 385, 128])
m.shape torch.Size([305, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08803319931030273  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08803319931030273  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.08832406997680664  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.10083150863647461  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([224, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.10143375396728516  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.10143375396728516  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 224, 128]), torch.Size([1, 224, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.10164737701416016  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11232852935791016  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 224, 128])
m.shape torch.Size([209, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11301898956298828  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes
Using backend: pytorch

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11301898956298828  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 209, 128]), torch.Size([1, 209, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.11321830749511719  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12457942962646484  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 209, 128])
m.shape torch.Size([171, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.125213623046875  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.125213623046875  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12537670135498047  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.13581371307373047  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([1463, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.14270830154418945  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.14270830154418945  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 731, 128]), torch.Size([1, 731, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.14340543746948242  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.19351530075073242  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst 0 shape torch.Size([1, 731, 128])
----------------------------------------1
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.19351530075073242  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.19351530075073242  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

 h.shape torch.Size([1, 732, 128]), torch.Size([1, 732, 128])
----------------------------------------3
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1942133903503418  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.243438720703125  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

rst 1 shape torch.Size([1, 732, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.23170232772827148  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.2325296401977539  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.23335695266723633  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.23248815536499023  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

torch.Size([5552, 40])
input nodes number: 15607
output nodes number: 5552
edges number: 29199
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.23263978958129883  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.23264026641845703  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.011048316955566406  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.011048316955566406  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.011048316955566406  GigaBytes
Max Memory Allocated: 0.3641834259033203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007368490099906921 |0.0004663616418838501 |0.036566078662872314 |7.586181163787842e-05 |0.0178433358669281 |0.002760171890258789 |
----------------------------------------------------------pseudo_mini_loss sum 3.1691360473632812
Total (block generation + training)time/epoch 11.012835025787354
* Pure training time/epoch 0.9998822212219238
Training time/epoch 1.0805282592773438
Training time without block to device /epoch 1.0730664730072021
Training time without total dataloading part /epoch 0.8745245933532715
load block tensor time/epoch 0.11789584159851074
block to device time/epoch 0.0074617862701416016
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  228870
Number of first layer input nodes during this epoch:  228870
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
