[03:22:30] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14364480 edges into 64 parts and get 4071928 edge cuts
main start at this time 1652844136.858424
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024242877960205078
global_2_local spend time (sec) 0.03445291519165039
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003238677978515625
A = g.adjacency_matrix() spent  0.007664918899536133
auxiliary_graph
Graph(num_nodes=145054, num_edges=14455421,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07374835014343262
remove nodes length
54113
auxiliary_graph.remove_nodes spent  0.6369552612304688
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14455421,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.5949611663818359

the counter of shared neighbor distribution
Counter({1.0: 12983840, 2.0: 1168162, 3.0: 166454, 4.0: 33624, 5.0: 8820, 6.0: 2638, 7.0: 736, 8.0: 176, 9.0: 24, 10.0: 6})
14364480
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14364477, 14364478, 14364479])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12983840, 2.0: 1168162, 3.0: 166454, 4.0: 33624, 5.0: 8820, 6.0: 2638, 7.0: 736, 8.0: 176, 9.0: 24, 10.0: 6})
Convert a graph into a bidirected graph: 0.622 seconds
Metis partitioning: 3.078 seconds
Split the graph: 0.383 seconds
Construct subgraphs: 0.066 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.156610488891602
1436
1422
1433
1438
1428
1441
1408
1418
1402
1407
1441
1436
1415
1459
1418
1393
1458
1442
1456
1442
1423
1430
1433
1404
1442
1459
1448
1442
1425
1445
1395
1453
1432
1426
1438
1426
1412
1418
1416
1420
1445
1379
1379
1405
1437
1417
1415
1410
1392
1418
1379
1380
1387
1405
1430
1463
1386
1379
1394
1426
1387
1406
1379
1463
total k batches seeds list generation spend  9.21666169166565
after graph partition
graph partition algorithm spend time 9.292831897735596
1436
1422
1433
1438
1428
1441
1408
1418
1402
1407
1441
1436
1415
1459
1418
1393
1458
1442
1456
1442
1423
1430
1433
1404
1442
1459
1448
1442
1425
1445
1395
1453
1432
1426
1438
1426
1412
1418
1416
1420
1445
1379
1379
1405
1437
1417
1415
1410
1392
1418
1379
1380
1387
1405
1430
1463
1386
1379
1394
1426
1387
1406
1379
1463
partition_len_list
[3608, 3721, 3309, 3299, 3562, 4288, 3424, 3174, 2738, 2986, 2797, 2378, 3123, 3440, 3259, 2840, 3139, 2773, 2677, 2513, 2942, 3024, 3075, 2584, 3105, 4080, 3109, 3963, 3343, 4480, 3530, 3573, 3534, 2659, 3411, 4411, 3401, 2888, 3685, 3737, 5903, 4934, 3942, 3795, 3929, 3791, 3788, 2778, 5997, 5245, 6228, 6607, 6293, 5705, 6082, 7235, 6961, 6267, 6580, 6262, 7211, 6560, 6173, 6923]
shared_neighbor_graph_partition_s0 selection method  spend 9.379379749298096
time for parepare:  0.017745018005371094
local_output_nid generation:  0.000362396240234375
local_in_edges_tensor generation:  0.0005810260772705078
mini_batch_src_global generation:  0.0004773139953613281
r_  generation:  0.002657175064086914
local_output_nid generation:  0.00035858154296875
local_in_edges_tensor generation:  0.0004482269287109375
mini_batch_src_global generation:  0.00039005279541015625
r_  generation:  0.002386808395385742
local_output_nid generation:  0.0003669261932373047
local_in_edges_tensor generation:  0.004198551177978516
mini_batch_src_global generation:  0.0003840923309326172
r_  generation:  0.002953767776489258
local_output_nid generation:  0.00042438507080078125
local_in_edges_tensor generation:  0.00044536590576171875
mini_batch_src_global generation:  0.000316619873046875
r_  generation:  0.0021436214447021484
local_output_nid generation:  0.00038814544677734375
local_in_edges_tensor generation:  0.0004165172576904297
mini_batch_src_global generation:  0.000339508056640625
r_  generation:  0.002715587615966797
local_output_nid generation:  0.00039386749267578125
local_in_edges_tensor generation:  0.0004210472106933594
mini_batch_src_global generation:  0.0003612041473388672
r_  generation:  0.0025932788848876953
local_output_nid generation:  0.00039458274841308594
local_in_edges_tensor generation:  0.0003879070281982422
mini_batch_src_global generation:  0.0003142356872558594
r_  generation:  0.002491474151611328
local_output_nid generation:  0.0003859996795654297
local_in_edges_tensor generation:  0.00038433074951171875
mini_batch_src_global generation:  0.0002713203430175781
r_  generation:  0.0021800994873046875
local_output_nid generation:  0.0003771781921386719
local_in_edges_tensor generation:  0.0003733634948730469
mini_batch_src_global generation:  0.000293731689453125
r_  generation:  0.002490997314453125
local_output_nid generation:  0.00037550926208496094
local_in_edges_tensor generation:  0.0003643035888671875
mini_batch_src_global generation:  0.0002713203430175781
r_  generation:  0.0021631717681884766
local_output_nid generation:  0.0003898143768310547
local_in_edges_tensor generation:  0.0003819465637207031
mini_batch_src_global generation:  0.00028252601623535156
r_  generation:  0.0023651123046875
local_output_nid generation:  0.000377655029296875
local_in_edges_tensor generation:  0.0003662109375
mini_batch_src_global generation:  0.000232696533203125
r_  generation:  0.0018620491027832031
local_output_nid generation:  0.00036406517028808594
local_in_edges_tensor generation:  0.0003719329833984375
mini_batch_src_global generation:  0.0002758502960205078
r_  generation:  0.0025599002838134766
local_output_nid generation:  0.0003845691680908203
local_in_edges_tensor generation:  0.0003848075866699219
mini_batch_src_global generation:  0.00031495094299316406
r_  generation:  0.002935171127319336
local_output_nid generation:  0.00038170814514160156
local_in_edges_tensor generation:  0.0004315376281738281
mini_batch_src_global generation:  0.0003204345703125
r_  generation:  0.0027840137481689453
local_output_nid generation:  0.00038433074951171875
local_in_edges_tensor generation:  0.00036144256591796875
mini_batch_src_global generation:  0.00031280517578125
r_  generation:  0.0025327205657958984
local_output_nid generation:  0.0003895759582519531
local_in_edges_tensor generation:  0.0003695487976074219
mini_batch_src_global generation:  0.0002739429473876953
r_  generation:  0.0022268295288085938
local_output_nid generation:  0.00039005279541015625
local_in_edges_tensor generation:  0.0003650188446044922
mini_batch_src_global generation:  0.0002562999725341797
r_  generation:  0.0021278858184814453
local_output_nid generation:  0.000385284423828125
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.00026488304138183594
r_  generation:  0.002382993698120117
local_output_nid generation:  0.00040149688720703125
local_in_edges_tensor generation:  0.0003719329833984375
mini_batch_src_global generation:  0.0002503395080566406
r_  generation:  0.0022296905517578125
local_output_nid generation:  0.0003876686096191406
local_in_edges_tensor generation:  0.0003714561462402344
mini_batch_src_global generation:  0.0002753734588623047
r_  generation:  0.002455472946166992
local_output_nid generation:  0.0003879070281982422
local_in_edges_tensor generation:  0.0003619194030761719
mini_batch_src_global generation:  0.00025844573974609375
r_  generation:  0.0022177696228027344
local_output_nid generation:  0.0003857612609863281
local_in_edges_tensor generation:  0.0003790855407714844
mini_batch_src_global generation:  0.00037598609924316406
r_  generation:  0.002519845962524414
local_output_nid generation:  0.0003864765167236328
local_in_edges_tensor generation:  0.0003695487976074219
mini_batch_src_global generation:  0.00027251243591308594
r_  generation:  0.0023436546325683594
local_output_nid generation:  0.0003879070281982422
local_in_edges_tensor generation:  0.00037384033203125
mini_batch_src_global generation:  0.0002715587615966797
r_  generation:  0.0024254322052001953
local_output_nid generation:  0.0004048347473144531
local_in_edges_tensor generation:  0.0003819465637207031
mini_batch_src_global generation:  0.00031948089599609375
r_  generation:  0.0028128623962402344
local_output_nid generation:  0.0003936290740966797
local_in_edges_tensor generation:  0.0003867149353027344
mini_batch_src_global generation:  0.0003046989440917969
r_  generation:  0.002653837203979492
local_output_nid generation:  0.0003941059112548828
local_in_edges_tensor generation:  0.0003647804260253906
mini_batch_src_global generation:  0.0002982616424560547
r_  generation:  0.0025033950805664062
local_output_nid generation:  0.00037550926208496094
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.00028228759765625
r_  generation:  0.002443075180053711
local_output_nid generation:  0.0003952980041503906
local_in_edges_tensor generation:  0.00037026405334472656
mini_batch_src_global generation:  0.00031685829162597656
r_  generation:  0.002801179885864258
local_output_nid generation:  0.0003955364227294922
local_in_edges_tensor generation:  0.0003714561462402344
mini_batch_src_global generation:  0.00032639503479003906
r_  generation:  0.002562999725341797
local_output_nid generation:  0.0004074573516845703
local_in_edges_tensor generation:  0.0003783702850341797
mini_batch_src_global generation:  0.0003333091735839844
r_  generation:  0.0026397705078125
local_output_nid generation:  0.00039887428283691406
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.0002830028533935547
r_  generation:  0.0023305416107177734
local_output_nid generation:  0.0004012584686279297
local_in_edges_tensor generation:  0.0003559589385986328
mini_batch_src_global generation:  0.00024580955505371094
r_  generation:  0.002128124237060547
local_output_nid generation:  0.0004012584686279297
local_in_edges_tensor generation:  0.00037407875061035156
mini_batch_src_global generation:  0.00025725364685058594
r_  generation:  0.002207040786743164
local_output_nid generation:  0.0004017353057861328
local_in_edges_tensor generation:  0.00037097930908203125
mini_batch_src_global generation:  0.0003204345703125
r_  generation:  0.0027208328247070312
local_output_nid generation:  0.0004057884216308594
local_in_edges_tensor generation:  0.0004107952117919922
mini_batch_src_global generation:  0.00027871131896972656
r_  generation:  0.0021948814392089844
local_output_nid generation:  0.000408172607421875
local_in_edges_tensor generation:  0.00037360191345214844
mini_batch_src_global generation:  0.0002906322479248047
r_  generation:  0.0026874542236328125
local_output_nid generation:  0.00040602684020996094
local_in_edges_tensor generation:  0.00036787986755371094
mini_batch_src_global generation:  0.0002849102020263672
r_  generation:  0.002430438995361328
local_output_nid generation:  0.0004398822784423828
local_in_edges_tensor generation:  0.0003924369812011719
mini_batch_src_global generation:  0.000293731689453125
r_  generation:  0.0023567676544189453
local_output_nid generation:  0.00040841102600097656
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.0003452301025390625
r_  generation:  0.0026617050170898438
local_output_nid generation:  0.0003914833068847656
local_in_edges_tensor generation:  0.0003528594970703125
mini_batch_src_global generation:  0.00032401084899902344
r_  generation:  0.0023245811462402344
local_output_nid generation:  0.00038123130798339844
local_in_edges_tensor generation:  0.0003485679626464844
mini_batch_src_global generation:  0.00025177001953125
r_  generation:  0.0021142959594726562
local_output_nid generation:  0.0003941059112548828
local_in_edges_tensor generation:  0.00034546852111816406
mini_batch_src_global generation:  0.0002307891845703125
r_  generation:  0.0019545555114746094
local_output_nid generation:  0.0004031658172607422
local_in_edges_tensor generation:  0.0003612041473388672
mini_batch_src_global generation:  0.0002655982971191406
r_  generation:  0.002519845962524414
local_output_nid generation:  0.0003986358642578125
local_in_edges_tensor generation:  0.00035071372985839844
mini_batch_src_global generation:  0.0002510547637939453
r_  generation:  0.0021686553955078125
local_output_nid generation:  0.0003933906555175781
local_in_edges_tensor generation:  0.00035452842712402344
mini_batch_src_global generation:  0.0002505779266357422
r_  generation:  0.0021746158599853516
local_output_nid generation:  0.00039696693420410156
local_in_edges_tensor generation:  0.0003707408905029297
mini_batch_src_global generation:  0.0002734661102294922
r_  generation:  0.0021321773529052734
local_output_nid generation:  0.00041222572326660156
local_in_edges_tensor generation:  0.0003972053527832031
mini_batch_src_global generation:  0.0002982616424560547
r_  generation:  0.002248048782348633
local_output_nid generation:  0.00040650367736816406
local_in_edges_tensor generation:  0.0003542900085449219
mini_batch_src_global generation:  0.0002815723419189453
r_  generation:  0.0022199153900146484
local_output_nid generation:  0.0003902912139892578
local_in_edges_tensor generation:  0.0003590583801269531
mini_batch_src_global generation:  0.0003123283386230469
r_  generation:  0.002531290054321289
local_output_nid generation:  0.0003986358642578125
local_in_edges_tensor generation:  0.0003695487976074219
mini_batch_src_global generation:  0.00042176246643066406
r_  generation:  0.0032701492309570312
local_output_nid generation:  0.0004162788391113281
local_in_edges_tensor generation:  0.001786947250366211
mini_batch_src_global generation:  0.0003905296325683594
r_  generation:  0.0030031204223632812
local_output_nid generation:  0.00042939186096191406
local_in_edges_tensor generation:  0.00036406517028808594
mini_batch_src_global generation:  0.0003197193145751953
r_  generation:  0.002516508102416992
local_output_nid generation:  0.00043582916259765625
local_in_edges_tensor generation:  0.00037550926208496094
mini_batch_src_global generation:  0.0003418922424316406
r_  generation:  0.002973318099975586
local_output_nid generation:  0.0004329681396484375
local_in_edges_tensor generation:  0.0003972053527832031
mini_batch_src_global generation:  0.0003752708435058594
r_  generation:  0.00310516357421875
local_output_nid generation:  0.0004127025604248047
local_in_edges_tensor generation:  0.00037169456481933594
mini_batch_src_global generation:  0.0003616809844970703
r_  generation:  0.002964019775390625
local_output_nid generation:  0.0004134178161621094
local_in_edges_tensor generation:  0.0003669261932373047
mini_batch_src_global generation:  0.0003504753112792969
r_  generation:  0.003117799758911133
local_output_nid generation:  0.00042176246643066406
local_in_edges_tensor generation:  0.00037169456481933594
mini_batch_src_global generation:  0.00036454200744628906
r_  generation:  0.003040313720703125
local_output_nid generation:  0.0004265308380126953
local_in_edges_tensor generation:  0.0003764629364013672
mini_batch_src_global generation:  0.00035309791564941406
r_  generation:  0.0029931068420410156
local_output_nid generation:  0.0004150867462158203
local_in_edges_tensor generation:  0.000362396240234375
mini_batch_src_global generation:  0.00039577484130859375
r_  generation:  0.0031280517578125
local_output_nid generation:  0.00042319297790527344
local_in_edges_tensor generation:  0.000396728515625
mini_batch_src_global generation:  0.00033783912658691406
r_  generation:  0.0032739639282226562
local_output_nid generation:  0.00045108795166015625
local_in_edges_tensor generation:  0.0003781318664550781
mini_batch_src_global generation:  0.00043845176696777344
r_  generation:  0.0029213428497314453
local_output_nid generation:  0.00045180320739746094
local_in_edges_tensor generation:  0.00038623809814453125
mini_batch_src_global generation:  0.0003790855407714844
r_  generation:  0.0034639835357666016
----------------------check_connections_block total spend ----------------------------- 0.31218552589416504
generate_one_block  0.009744644165039062
generate_one_block  0.00586700439453125
generate_one_block  0.005286693572998047
generate_one_block  0.004559516906738281
generate_one_block  0.00490117073059082
generate_one_block  0.004869937896728516
generate_one_block  0.004263401031494141
generate_one_block  0.003863811492919922
generate_one_block  0.012936830520629883
generate_one_block  0.004147052764892578
generate_one_block  0.004077911376953125
generate_one_block  0.0033986568450927734
generate_one_block  0.004483461380004883
generate_one_block  0.004667758941650391
generate_one_block  0.004841327667236328
generate_one_block  0.004377841949462891
generate_one_block  0.0038712024688720703
generate_one_block  0.003941535949707031
generate_one_block  0.003979682922363281
generate_one_block  0.0035190582275390625
generate_one_block  0.004140138626098633
generate_one_block  0.0037119388580322266
generate_one_block  0.004112720489501953
generate_one_block  0.00394129753112793
generate_one_block  0.004061222076416016
generate_one_block  0.0059452056884765625
generate_one_block  0.0045053958892822266
generate_one_block  0.004343509674072266
generate_one_block  0.004032611846923828
generate_one_block  0.004912376403808594
generate_one_block  0.0043027400970458984
generate_one_block  0.004389047622680664
generate_one_block  0.004097461700439453
generate_one_block  0.003779172897338867
generate_one_block  0.004010438919067383
generate_one_block  0.004645586013793945
generate_one_block  0.0035741329193115234
generate_one_block  0.004213571548461914
generate_one_block  0.004005908966064453
generate_one_block  0.004204511642456055
generate_one_block  0.006657838821411133
generate_one_block  0.0043735504150390625
generate_one_block  0.003753185272216797
generate_one_block  0.003648996353149414
generate_one_block  0.004254341125488281
generate_one_block  0.006982564926147461
generate_one_block  0.003914594650268555
generate_one_block  0.0035207271575927734
generate_one_block  0.004695415496826172
generate_one_block  0.004221677780151367
generate_one_block  0.004805088043212891
generate_one_block  0.0058901309967041016
generate_one_block  0.005265712738037109
generate_one_block  0.004387855529785156
generate_one_block  0.005033016204833984
generate_one_block  0.005590200424194336
generate_one_block  0.00503230094909668
generate_one_block  0.005116939544677734
generate_one_block  0.0051801204681396484
generate_one_block  0.0053446292877197266
generate_one_block  0.005581855773925781
generate_one_block  0.004979372024536133
generate_one_block  0.005084037780761719
generate_one_block  0.005710601806640625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0.31218552589416504
block generation total time  0.30555224418640137
average batch blocks generation time:  0.004774253815412521
pseudo mini batch 0 input nodes size: 3608
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00225067138671875  GigaBytes
Max Memory Allocated: 0.00225067138671875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.002261638641357422  GigaBytes
Max Memory Allocated: 0.002261638641357422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.002261638641357422  GigaBytes
Max Memory Allocated: 0.002261638641357422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.002327442169189453  GigaBytes
Max Memory Allocated: 0.002327442169189453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.002327442169189453  GigaBytes
Max Memory Allocated: 0.002327442169189453  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.002327442169189453  GigaBytes
Max Memory Allocated: 0.002327442169189453  GigaBytes

m.shape torch.Size([164, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.0067310333251953125  GigaBytes
Max Memory Allocated: 0.006772518157958984  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.0067310333251953125  GigaBytes
Max Memory Allocated: 0.006772518157958984  GigaBytes

 h.shape torch.Size([1, 164, 128]), torch.Size([1, 164, 128])
----------------------------------------3
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.0068874359130859375  GigaBytes
Max Memory Allocated: 0.0068874359130859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2049560546875 GB
    Memory Allocated: 0.008138656616210938  GigaBytes
Max Memory Allocated: 0.00821685791015625  GigaBytes

rst.shape  torch.Size([1, 164, 128])
m.shape torch.Size([144, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2049560546875 GB
    Memory Allocated: 0.008197784423828125  GigaBytes
Max Memory Allocated: 0.00821685791015625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2049560546875 GB
    Memory Allocated: 0.008197784423828125  GigaBytes
Max Memory Allocated: 0.00821685791015625  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2049560546875 GB
    Memory Allocated: 0.008335113525390625  GigaBytes
Max Memory Allocated: 0.008335113525390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.010395050048828125  GigaBytes
Max Memory Allocated: 0.010532379150390625  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([144, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.010532379150390625  GigaBytes
Max Memory Allocated: 0.01053762435913086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.010532379150390625  GigaBytes
Max Memory Allocated: 0.01053762435913086  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.010669708251953125  GigaBytes
Max Memory Allocated: 0.010669708251953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2108154296875 GB
    Memory Allocated: 0.013690948486328125  GigaBytes
Max Memory Allocated: 0.013896942138671875  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([115, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2108154296875 GB
    Memory Allocated: 0.013841629028320312  GigaBytes
Max Memory Allocated: 0.013896942138671875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2108154296875 GB
    Memory Allocated: 0.013841629028320312  GigaBytes
Max Memory Allocated: 0.013896942138671875  GigaBytes

 h.shape torch.Size([1, 115, 128]), torch.Size([1, 115, 128])
----------------------------------------3
 Nvidia-smi: 1.2108154296875 GB
    Memory Allocated: 0.013951301574707031  GigaBytes
Max Memory Allocated: 0.013951301574707031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2127685546875 GB
    Memory Allocated: 0.017131805419921875  GigaBytes
Max Memory Allocated: 0.017351150512695312  GigaBytes

rst.shape  torch.Size([1, 115, 128])
m.shape torch.Size([102, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2127685546875 GB
    Memory Allocated: 0.01732015609741211  GigaBytes
Max Memory Allocated: 0.017351150512695312  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2127685546875 GB
    Memory Allocated: 0.01732015609741211  GigaBytes
Max Memory Allocated: 0.017351150512695312  GigaBytes

 h.shape torch.Size([1, 102, 128]), torch.Size([1, 102, 128])
----------------------------------------3
 Nvidia-smi: 1.2127685546875 GB
    Memory Allocated: 0.017417430877685547  GigaBytes
Max Memory Allocated: 0.017417430877685547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2166748046875 GB
    Memory Allocated: 0.020919322967529297  GigaBytes
Max Memory Allocated: 0.02116250991821289  GigaBytes

rst.shape  torch.Size([1, 102, 128])
m.shape torch.Size([81, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2166748046875 GB
    Memory Allocated: 0.021102428436279297  GigaBytes
Max Memory Allocated: 0.02116250991821289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2166748046875 GB
    Memory Allocated: 0.021102428436279297  GigaBytes
Max Memory Allocated: 0.02116250991821289  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.2166748046875 GB
    Memory Allocated: 0.021179676055908203  GigaBytes
Max Memory Allocated: 0.021179676055908203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.024501323699951172  GigaBytes
Max Memory Allocated: 0.02473306655883789  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([70, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.02469635009765625  GigaBytes
Max Memory Allocated: 0.02473306655883789  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.02469635009765625  GigaBytes
Max Memory Allocated: 0.02473306655883789  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.024763107299804688  GigaBytes
Max Memory Allocated: 0.024763107299804688  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2244873046875 GB
    Memory Allocated: 0.028100967407226562  GigaBytes
Max Memory Allocated: 0.028334617614746094  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([63, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2244873046875 GB
    Memory Allocated: 0.02830791473388672  GigaBytes
Max Memory Allocated: 0.028334617614746094  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2244873046875 GB
    Memory Allocated: 0.02830791473388672  GigaBytes
Max Memory Allocated: 0.028334617614746094  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2244873046875 GB
    Memory Allocated: 0.028367996215820312  GigaBytes
Max Memory Allocated: 0.028367996215820312  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.031792640686035156  GigaBytes
Max Memory Allocated: 0.03203296661376953  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([60, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.03202009201049805  GigaBytes
Max Memory Allocated: 0.03203296661376953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.03202009201049805  GigaBytes
Max Memory Allocated: 0.03203296661376953  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.03207731246948242  GigaBytes
Max Memory Allocated: 0.03207731246948242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.03573942184448242  GigaBytes
Max Memory Allocated: 0.03599691390991211  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([493, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.03806161880493164  GigaBytes
Max Memory Allocated: 0.038117408752441406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.03806161880493164  GigaBytes
Max Memory Allocated: 0.038117408752441406  GigaBytes

 h.shape torch.Size([1, 246, 128]), torch.Size([1, 246, 128])
----------------------------------------3
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.03829622268676758  GigaBytes
Max Memory Allocated: 0.03829622268676758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.05495309829711914  GigaBytes
Max Memory Allocated: 0.05612611770629883  GigaBytes

rst 0 shape torch.Size([1, 246, 128])
----------------------------------------1
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.05495309829711914  GigaBytes
Max Memory Allocated: 0.05612611770629883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.05495309829711914  GigaBytes
Max Memory Allocated: 0.05612611770629883  GigaBytes

 h.shape torch.Size([1, 247, 128]), torch.Size([1, 247, 128])
----------------------------------------3
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.055188655853271484  GigaBytes
Max Memory Allocated: 0.05612611770629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.07179594039916992  GigaBytes
Max Memory Allocated: 0.07309103012084961  GigaBytes

rst 1 shape torch.Size([1, 247, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0681309700012207  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0683450698852539  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06855916976928711  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06833410263061523  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

torch.Size([1436, 40])
input nodes number: 3608
output nodes number: 1436
edges number: 8804
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06858634948730469  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0685873031616211  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0031824111938476562  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

pseudo mini batch 1 input nodes size: 3721
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0030069351196289062  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0030069351196289062  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004781246185302734  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004792213439941406  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0030608177185058594  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0031189918518066406  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0031189918518066406  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0031189918518066406  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

m.shape torch.Size([251, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007049560546875  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007049560546875  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007288932800292969  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009203910827636719  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 251, 128])
m.shape torch.Size([179, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009254932403564453  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009254932403564453  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 179, 128]), torch.Size([1, 179, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009425640106201172  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011986255645751953  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 179, 128])
m.shape torch.Size([143, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012105464935302734  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012105464935302734  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012241840362548828  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01524209976196289  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([115, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015393257141113281  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015393257141113281  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 115, 128]), torch.Size([1, 115, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0155029296875  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.018683433532714844  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 115, 128])
m.shape torch.Size([94, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.018852710723876953  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.018852710723876953  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 94, 128]), torch.Size([1, 94, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01894235610961914  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.02216958999633789  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 94, 128])
m.shape torch.Size([75, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.022339344024658203  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.022339344024658203  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.022410869598388672  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.025486469268798828  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([58, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.025644302368164062  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.025644302368164062  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 58, 128]), torch.Size([1, 58, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.025699615478515625  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.02846527099609375  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 58, 128])
m.shape torch.Size([50, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.02862834930419922  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.02862834930419922  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.02867603302001953  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.031394004821777344  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.03158903121948242  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.03158903121948242  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.03163766860961914  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.03475046157836914  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([406, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.03666210174560547  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.03666210174560547  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 203, 128]), torch.Size([1, 203, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.03685569763183594  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.05060100555419922  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst 0 shape torch.Size([1, 203, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.05060100555419922  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.05060100555419922  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 203, 128]), torch.Size([1, 203, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.05079460144042969  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06444311141967773  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst 1 shape torch.Size([1, 203, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06129932403564453  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06151151657104492  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06172370910644531  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06150054931640625  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

torch.Size([1422, 40])
input nodes number: 3721
output nodes number: 1422
edges number: 7743
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.061537742614746094  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0615382194519043  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.003220081329345703  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

pseudo mini batch 2 input nodes size: 3309
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.003058910369873047  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.003058910369873047  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004779338836669922  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004790306091308594  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0030050277709960938  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0030727386474609375  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0030727386474609375  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0030727386474609375  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

m.shape torch.Size([162, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007566928863525391  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007566928863525391  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 162, 128]), torch.Size([1, 162, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007721424102783203  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008957386016845703  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 162, 128])
m.shape torch.Size([148, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009021282196044922  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009021282196044922  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 148, 128]), torch.Size([1, 148, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009162425994873047  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011279582977294922  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 148, 128])
m.shape torch.Size([145, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011416435241699219  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011416435241699219  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 145, 128]), torch.Size([1, 145, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011554718017578125  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014596939086914062  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 145, 128])
m.shape torch.Size([99, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014716625213623047  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014716625213623047  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014811038970947266  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01754903793334961  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 99, 128])
m.shape torch.Size([94, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01772594451904297  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01772594451904297  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 94, 128]), torch.Size([1, 94, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.017815589904785156  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.021042823791503906  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 94, 128])
m.shape torch.Size([72, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.021203994750976562  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.021203994750976562  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.021272659301757812  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.024225234985351562  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([68, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.024417877197265625  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.024417877197265625  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.02448272705078125  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0277252197265625  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([44, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.027860641479492188  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.027860641479492188  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 44, 128]), torch.Size([1, 44, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.027902603149414062  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.030294418334960938  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 44, 128])
m.shape torch.Size([40, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.030445098876953125  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.030445098876953125  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 40, 128]), torch.Size([1, 40, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.030483245849609375  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.032924652099609375  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst.shape  torch.Size([1, 40, 128])
m.shape torch.Size([561, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.03558063507080078  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.03558063507080078  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 280, 128]), torch.Size([1, 280, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.03584766387939453  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.05480670928955078  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

rst 0 shape torch.Size([1, 280, 128])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.05480670928955078  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.05480670928955078  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

 h.shape torch.Size([1, 281, 128]), torch.Size([1, 281, 128])
----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.05507469177246094  GigaBytes
Max Memory Allocated: 0.07374000549316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.07396793365478516  GigaBytes
Max Memory Allocated: 0.07544136047363281  GigaBytes

rst 1 shape torch.Size([1, 281, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.07019567489624023  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.07040929794311523  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.07062292098999023  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.07039833068847656  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

torch.Size([1433, 40])
input nodes number: 3309
output nodes number: 1433
edges number: 8989
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0704355239868164  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.07043600082397461  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0031833648681640625  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

pseudo mini batch 3 input nodes size: 3299
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.003006458282470703  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.003006458282470703  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0045795440673828125  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.004590511322021484  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0028591156005859375  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0029077529907226562  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0029077529907226562  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0029077529907226562  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

m.shape torch.Size([275, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0062046051025390625  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0062046051025390625  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 275, 128]), torch.Size([1, 275, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.006466865539550781  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008564949035644531  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 275, 128])
m.shape torch.Size([265, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008686542510986328  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008686542510986328  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 265, 128]), torch.Size([1, 265, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008939266204833984  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012730121612548828  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 265, 128])
m.shape torch.Size([189, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012874126434326172  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012874126434326172  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 189, 128]), torch.Size([1, 189, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013054370880126953  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01701974868774414  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 189, 128])
m.shape torch.Size([147, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.017210006713867188  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.017210006713867188  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 147, 128]), torch.Size([1, 147, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.017350196838378906  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.02141571044921875  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 147, 128])
m.shape torch.Size([101, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.02158641815185547  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.02158641815185547  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0216827392578125  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.025150299072265625  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([91, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.025362491607666016  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.025362491607666016  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.025449275970458984  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.02918100357055664  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([52, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.029311180114746094  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.029311180114746094  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.02936077117919922  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.03184032440185547  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([52, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.032013893127441406  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.032013893127441406  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.03206348419189453  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.034890174865722656  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([44, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.03505420684814453  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.03505420684814453  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 44, 128]), torch.Size([1, 44, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.035096168518066406  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.037781715393066406  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 44, 128])
m.shape torch.Size([222, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.039481163024902344  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.039481163024902344  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.03958702087402344  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.047102928161621094  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst 0 shape torch.Size([1, 111, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.047102928161621094  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.047102928161621094  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.04720878601074219  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0546717643737793  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst 1 shape torch.Size([1, 111, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0522150993347168  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0524296760559082  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.05264425277709961  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.05241870880126953  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

torch.Size([1438, 40])
input nodes number: 3299
output nodes number: 1438
edges number: 6407
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.05245542526245117  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.052455902099609375  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.002998828887939453  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

pseudo mini batch 4 input nodes size: 3562
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0028600692749023438  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0028600692749023438  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.004580497741699219  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.004591464996337891  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0030074119567871094  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.003075122833251953  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.003075122833251953  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.003075122833251953  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

m.shape torch.Size([157, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007613658905029297  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007613658905029297  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 157, 128]), torch.Size([1, 157, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007763385772705078  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008961200714111328  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 157, 128])
m.shape torch.Size([145, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009024620056152344  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009024620056152344  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 145, 128]), torch.Size([1, 145, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00916290283203125  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011237144470214844  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 145, 128])
m.shape torch.Size([120, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011339664459228516  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011339664459228516  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011454105377197266  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013971805572509766  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([92, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01409006118774414  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01409006118774414  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014177799224853516  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01672220230102539  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([91, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016895294189453125  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016895294189453125  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016982078552246094  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.02010631561279297  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([82, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.020297527313232422  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.020297527313232422  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.020375728607177734  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.023738384246826172  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([83, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.02397632598876953  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.02397632598876953  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.02405548095703125  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.028013229370117188  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([70, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.028240680694580078  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.028240680694580078  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.028307437896728516  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.03211259841918945  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([55, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.03231525421142578  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.03231525421142578  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.032367706298828125  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.035724639892578125  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([533, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.03823995590209961  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.03823995590209961  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 266, 128]), torch.Size([1, 266, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.03849363327026367  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.05650472640991211  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

rst 0 shape torch.Size([1, 266, 128])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.05650472640991211  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.05650472640991211  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.05675935745239258  GigaBytes
Max Memory Allocated: 0.07589149475097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.07471132278442383  GigaBytes
Max Memory Allocated: 0.0761113166809082  GigaBytes

rst 1 shape torch.Size([1, 267, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07089662551879883  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07110977172851562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07132291793823242  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07109880447387695  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

torch.Size([1428, 40])
input nodes number: 3562
output nodes number: 1428
edges number: 9088
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07113504409790039  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0711355209350586  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003184795379638672  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

pseudo mini batch 5 input nodes size: 4288
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030059814453125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030059814453125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0050506591796875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.005061626434326172  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003330230712890625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0033969879150390625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0033969879150390625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0033969879150390625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

m.shape torch.Size([182, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007852554321289062  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007852554321289062  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008026123046875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0094146728515625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 182, 128])
m.shape torch.Size([139, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.00946044921875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.00946044921875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 139, 128]), torch.Size([1, 139, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.009593009948730469  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0115814208984375  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 139, 128])
m.shape torch.Size([140, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011715412139892578  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011715412139892578  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 140, 128]), torch.Size([1, 140, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011848926544189453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014786243438720703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 140, 128])
m.shape torch.Size([97, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014904499053955078  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014904499053955078  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014997005462646484  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017679691314697266  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([95, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017859935760498047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017859935760498047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01795053482055664  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.021212100982666016  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([76, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.021384239196777344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.021384239196777344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02145671844482422  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.024573326110839844  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([78, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.024797439575195312  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.024797439575195312  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.024871826171875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.028591156005859375  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([62, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02879047393798828  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02879047393798828  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02884960174560547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.032219886779785156  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([70, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03249073028564453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03249073028564453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03255748748779297  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03682994842529297  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([502, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03919029235839844  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03919029235839844  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.039429664611816406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05642509460449219  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 0 shape torch.Size([1, 251, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05642509460449219  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05642509460449219  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.056664466857910156  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07354021072387695  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 1 shape torch.Size([1, 251, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06983327865600586  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07004833221435547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07026338577270508  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0700373649597168  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

torch.Size([1441, 40])
input nodes number: 4288
output nodes number: 1441
edges number: 8891
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07008218765258789  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0700826644897461  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0035142898559570312  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

pseudo mini batch 6 input nodes size: 3424
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0033321380615234375  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0033321380615234375  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0050525665283203125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.005063056945800781  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030074119567871094  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003067493438720703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003067493438720703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003067493438720703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

m.shape torch.Size([179, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007081508636474609  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007081508636474609  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 179, 128]), torch.Size([1, 179, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007252216339111328  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008617877960205078  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 179, 128])
m.shape torch.Size([171, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008695602416992188  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008695602416992188  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008858680725097656  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011304855346679688  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([163, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011456489562988281  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011456489562988281  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 163, 128]), torch.Size([1, 163, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0116119384765625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015031814575195312  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 163, 128])
m.shape torch.Size([128, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015198230743408203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015198230743408203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015320301055908203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018860340118408203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([96, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.019028186798095703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.019028186798095703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.019119739532470703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.022415637969970703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([80, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.022598743438720703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.022598743438720703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.022675037384033203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.025955677032470703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([78, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02617788314819336  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02617788314819336  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.026252269744873047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.029971599578857422  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([63, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030174732208251953  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030174732208251953  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030234813690185547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03365945816040039  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([43, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0338139533996582  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0338139533996582  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 43, 128]), torch.Size([1, 43, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03385496139526367  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03647947311401367  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 43, 128])
m.shape torch.Size([407, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.038399696350097656  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.038399696350097656  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 203, 128]), torch.Size([1, 203, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.038593292236328125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.052338600158691406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 0 shape torch.Size([1, 203, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.052338600158691406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.052338600158691406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 204, 128]), torch.Size([1, 204, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05253314971923828  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06624937057495117  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 1 shape torch.Size([1, 204, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06298160552978516  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06319141387939453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0634012222290039  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06318092346191406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

torch.Size([1408, 40])
input nodes number: 3424
output nodes number: 1408
edges number: 7989
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06321191787719727  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06321239471435547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0031642913818359375  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

pseudo mini batch 7 input nodes size: 3174
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003002166748046875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003002166748046875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004515647888183594  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004526615142822266  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.002795696258544922  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.002846240997314453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.002846240997314453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.002846240997314453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

m.shape torch.Size([278, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006281375885009766  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006281375885009766  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 278, 128]), torch.Size([1, 278, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006546497344970703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008667469024658203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 278, 128])
m.shape torch.Size([216, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008740901947021484  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008740901947021484  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 216, 128]), torch.Size([1, 216, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008946895599365234  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012036800384521484  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 216, 128])
m.shape torch.Size([172, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012179851531982422  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012179851531982422  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012343883514404297  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015952587127685547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 172, 128])
m.shape torch.Size([135, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016128063201904297  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016128063201904297  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01625680923461914  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01999044418334961  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([116, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02020263671875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02020263671875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.020313262939453125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.024295806884765625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([88, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.024492263793945312  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.024492263793945312  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 88, 128]), torch.Size([1, 88, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.024576187133789062  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.028184890747070312  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 88, 128])
m.shape torch.Size([50, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02830982208251953  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02830982208251953  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.028357505798339844  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03074169158935547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([62, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030954360961914062  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030954360961914062  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03101348876953125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03438377380371094  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([40, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03452587127685547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03452587127685547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 40, 128]), torch.Size([1, 40, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03456401824951172  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03700542449951172  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 40, 128])
m.shape torch.Size([261, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03870677947998047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03870677947998047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 130, 128]), torch.Size([1, 130, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03883075714111328  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04763317108154297  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 0 shape torch.Size([1, 130, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04763317108154297  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04763317108154297  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 131, 128]), torch.Size([1, 131, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04775810241699219  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05656623840332031  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 1 shape torch.Size([1, 131, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0539555549621582  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05416727066040039  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05437898635864258  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05415630340576172  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

torch.Size([1418, 40])
input nodes number: 3174
output nodes number: 1418
edges number: 6690
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05419301986694336  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05419349670410156  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0029392242431640625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

pseudo mini batch 8 input nodes size: 2738
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0027976036071777344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0027976036071777344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004518032073974609  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004528522491455078  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030040740966796875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030651092529296875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030651092529296875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030651092529296875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

m.shape torch.Size([147, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007124423980712891  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007124423980712891  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 147, 128]), torch.Size([1, 147, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007264614105224609  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.00838613510131836  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 147, 128])
m.shape torch.Size([170, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008478164672851562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008478164672851562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008640289306640625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011072158813476562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 170, 128])
m.shape torch.Size([151, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011207103729248047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011207103729248047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01135110855102539  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014519214630126953  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([143, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014719963073730469  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014719963073730469  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014856338500976562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01881122589111328  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([97, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01897430419921875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01897430419921875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.019066810607910156  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02239704132080078  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([92, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.022614002227783203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.022614002227783203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.022701740264892578  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.026474475860595703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([81, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.026700973510742188  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.026700973510742188  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.026778221130371094  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030640602111816406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([74, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030884265899658203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030884265899658203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030954837799072266  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03497743606567383  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([67, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03522968292236328  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03522968292236328  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 67, 128]), torch.Size([1, 67, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0352935791015625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0393829345703125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 67, 128])
m.shape torch.Size([380, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.041162967681884766  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.041162967681884766  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04134416580200195  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.054209232330322266  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 0 shape torch.Size([1, 190, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.054209232330322266  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.054209232330322266  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05439043045043945  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06716489791870117  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 1 shape torch.Size([1, 190, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06384086608886719  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06405019760131836  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06425952911376953  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06403970718383789  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

torch.Size([1402, 40])
input nodes number: 2738
output nodes number: 1402
edges number: 8111
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06406831741333008  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06406879425048828  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0031599998474121094  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

pseudo mini batch 9 input nodes size: 2986
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003001689910888672  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003001689910888672  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004425525665283203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004436016082763672  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.002705097198486328  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0027556419372558594  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0027556419372558594  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0027556419372558594  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

m.shape torch.Size([247, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006187915802001953  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006187915802001953  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 247, 128]), torch.Size([1, 247, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006423473358154297  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008307933807373047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 247, 128])
m.shape torch.Size([251, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008429527282714844  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008429527282714844  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008668899536132812  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012259483337402344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 251, 128])
m.shape torch.Size([165, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012375831604003906  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012375831604003906  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012533187866210938  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015995025634765625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 165, 128])
m.shape torch.Size([153, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016208171844482422  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016208171844482422  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 153, 128]), torch.Size([1, 153, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016354084014892578  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02058553695678711  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 153, 128])
m.shape torch.Size([101, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02075338363647461  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02075338363647461  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02084970474243164  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.024317264556884766  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([65, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02445507049560547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02445507049560547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.024517059326171875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.027182579040527344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([46, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.027305126190185547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.027305126190185547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 46, 128]), torch.Size([1, 46, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.027348995208740234  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02954244613647461  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 46, 128])
m.shape torch.Size([49, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02970743179321289  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02970743179321289  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.029754161834716797  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03241777420043945  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([43, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03257894515991211  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03257894515991211  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 43, 128]), torch.Size([1, 43, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03261995315551758  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03524446487426758  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 43, 128])
m.shape torch.Size([287, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03694438934326172  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03694438934326172  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03708076477050781  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04676342010498047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 0 shape torch.Size([1, 143, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04676342010498047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04676342010498047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04690074920654297  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05658292770385742  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 1 shape torch.Size([1, 144, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05394744873046875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.054157257080078125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0543670654296875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.054146766662597656  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

torch.Size([1407, 40])
input nodes number: 2986
output nodes number: 1407
edges number: 6722
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.054180145263671875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05418062210083008  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0028448104858398438  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

pseudo mini batch 10 input nodes size: 2797
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0027055740356445312  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0027055740356445312  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004426002502441406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004436969757080078  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003002643585205078  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003059864044189453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003059864044189453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003059864044189453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

m.shape torch.Size([222, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006916999816894531  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.006916999816894531  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 222, 128]), torch.Size([1, 222, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007128715515136719  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008822441101074219  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 222, 128])
m.shape torch.Size([210, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008916854858398438  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008916854858398438  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 210, 128]), torch.Size([1, 210, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.00911712646484375  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012121200561523438  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 210, 128])
m.shape torch.Size([165, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012257099151611328  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012257099151611328  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01241445541381836  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015876293182373047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 165, 128])
m.shape torch.Size([121, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016028404235839844  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016028404235839844  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016143798828125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01949024200439453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([105, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.019682884216308594  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.019682884216308594  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01978302001953125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.023387908935546875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([89, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.023592472076416016  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.023592472076416016  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.023677349090576172  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02732706069946289  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([64, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.027498245239257812  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.027498245239257812  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.027559280395507812  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030611038208007812  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([54, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030786514282226562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030786514282226562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0308380126953125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03377342224121094  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([49, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03395795822143555  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03395795822143555  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03400468826293945  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03699541091918945  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([362, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03869819641113281  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03869819641113281  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.038870811462402344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05112648010253906  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 0 shape torch.Size([1, 181, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05112648010253906  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05112648010253906  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.051299095153808594  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06346845626831055  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 1 shape torch.Size([1, 181, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.060402870178222656  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.060617923736572266  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.060832977294921875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.060606956481933594  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

torch.Size([1441, 40])
input nodes number: 2797
output nodes number: 1441
edges number: 7621
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06064414978027344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06064462661743164  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0031599998474121094  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

pseudo mini batch 11 input nodes size: 2378
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030078887939453125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030078887939453125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004141807556152344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004152774810791016  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0024213790893554688  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0024633407592773438  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0024633407592773438  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0024633407592773438  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

m.shape torch.Size([382, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.005398273468017578  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.005398273468017578  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 382, 128]), torch.Size([1, 382, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.005762577056884766  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008677005767822266  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 382, 128])
m.shape torch.Size([269, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008751392364501953  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008751392364501953  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.009007930755615234  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012856006622314453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([189, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012998104095458984  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012998104095458984  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 189, 128]), torch.Size([1, 189, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013178348541259766  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017143726348876953  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 189, 128])
m.shape torch.Size([142, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017324447631835938  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017324447631835938  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017459869384765625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.021387100219726562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 142, 128])
m.shape torch.Size([95, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.021545886993408203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.021545886993408203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.021636486053466797  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.024898052215576172  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([71, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.025055885314941406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.025055885314941406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02512359619140625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02803516387939453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([52, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.028174877166748047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.028174877166748047  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.028224468231201172  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030704021453857422  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([47, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030858516693115234  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030858516693115234  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030903339385986328  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03345823287963867  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([31, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0335688591003418  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0335688591003418  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 31, 128]), torch.Size([1, 31, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03359842300415039  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03549051284790039  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 31, 128])
m.shape torch.Size([158, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03622913360595703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03622913360595703  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.036304473876953125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04165363311767578  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 0 shape torch.Size([1, 79, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04165363311767578  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04165363311767578  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.041728973388671875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.047040462493896484  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 1 shape torch.Size([1, 79, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04500436782836914  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.045218467712402344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04543256759643555  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04520750045776367  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

torch.Size([1436, 40])
input nodes number: 2378
output nodes number: 1436
edges number: 5555
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.045235633850097656  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04523611068725586  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0025391578674316406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

pseudo mini batch 12 input nodes size: 3123
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0024204254150390625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0024204254150390625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0041408538818359375  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004151821136474609  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030069351196289062  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030698776245117188  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030698776245117188  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030698776245117188  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

m.shape torch.Size([144, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0072803497314453125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0072803497314453125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0074176788330078125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008516311645507812  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([160, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008600234985351562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008600234985351562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 160, 128]), torch.Size([1, 160, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008752822875976562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011041641235351562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 160, 128])
m.shape torch.Size([138, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011162757873535156  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011162757873535156  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011294364929199219  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014189720153808594  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([135, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01438140869140625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01438140869140625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014510154724121094  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018243789672851562  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([104, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018427371978759766  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018427371978759766  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018526554107666016  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.022097110748291016  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 104, 128])
m.shape torch.Size([101, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.022336483001708984  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.022336483001708984  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.022432804107666016  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.02657461166381836  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([91, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.026830196380615234  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.026830196380615234  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.026916980743408203  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03125619888305664  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([63, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03145313262939453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03145313262939453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.031513214111328125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03493785858154297  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.035126686096191406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.035126686096191406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.035175323486328125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.038288116455078125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([428, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04030466079711914  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04030466079711914  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 214, 128]), torch.Size([1, 214, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04050874710083008  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05499887466430664  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 0 shape torch.Size([1, 214, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05499887466430664  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05499887466430664  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 214, 128]), torch.Size([1, 214, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05520296096801758  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06959104537963867  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 1 shape torch.Size([1, 214, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06611251831054688  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06632375717163086  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06653499603271484  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.06631278991699219  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

torch.Size([1415, 40])
input nodes number: 3123
output nodes number: 1415
edges number: 8424
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0663442611694336  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0663447380065918  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.003170013427734375  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

pseudo mini batch 13 input nodes size: 3440
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030040740966796875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0030040740966796875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0046443939208984375  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.004655361175537109  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0029239654541015625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.002994537353515625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.002994537353515625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.002994537353515625  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

m.shape torch.Size([123, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007651805877685547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007651805877685547  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.007769107818603516  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008707523345947266  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([138, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008780479431152344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008780479431152344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.008912086486816406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.010886192321777344  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([134, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011012077331542969  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011012077331542969  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 134, 128]), torch.Size([1, 134, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.011139869689941406  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013951301574707031  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 134, 128])
m.shape torch.Size([109, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014095306396484375  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014095306396484375  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014199256896972656  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017213821411132812  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 109, 128])
m.shape torch.Size([112, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017428874969482422  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017428874969482422  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017535686492919922  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.021380901336669922  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([104, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.021625041961669922  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.021625041961669922  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.021724224090576172  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.025989055633544922  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 104, 128])
m.shape torch.Size([86, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.026226520538330078  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.026226520538330078  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 86, 128]), torch.Size([1, 86, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.026308536529541016  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03040933609008789  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 86, 128])
m.shape torch.Size([63, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030608654022216797  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.030608654022216797  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.03066873550415039  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.034093379974365234  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([60, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.034320831298828125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.034320831298828125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0343780517578125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0380401611328125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([530, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.040538787841796875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.040538787841796875  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 265, 128]), torch.Size([1, 265, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.04079151153564453  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.058734893798828125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

rst 0 shape torch.Size([1, 265, 128])
----------------------------------------1
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.058734893798828125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.058734893798828125  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

 h.shape torch.Size([1, 265, 128]), torch.Size([1, 265, 128])
----------------------------------------3
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.05898761749267578  GigaBytes
Max Memory Allocated: 0.07663440704345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.07680463790893555  GigaBytes
Max Memory Allocated: 0.07865142822265625  GigaBytes

rst 1 shape torch.Size([1, 265, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07287359237670898  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07309103012084961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07330846786499023  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07308006286621094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1459, 40])
input nodes number: 3440
output nodes number: 1459
edges number: 9367
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07312297821044922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07312345504760742  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031137466430664062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 14 input nodes size: 3259
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002930164337158203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002930164337158203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004650592803955078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00466156005859375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003010272979736328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003077983856201172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003077983856201172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003077983856201172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([145, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007605075836181641  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007605075836181641  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 145, 128]), torch.Size([1, 145, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007743358612060547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008849620819091797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 145, 128])
m.shape torch.Size([143, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008916854858398438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008916854858398438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009053230285644531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011098861694335938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([123, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011206626892089844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011206626892089844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011323928833007812  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013904571533203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([109, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014053821563720703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014053821563720703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014157772064208984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01717233657836914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 109, 128])
m.shape torch.Size([98, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01735401153564453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01735401153564453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017447471618652344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020812034606933594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([73, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020974159240722656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020974159240722656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021043777465820312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02403736114501953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([57, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02419281005859375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02419281005859375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024247169494628906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02696514129638672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([65, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027185916900634766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027185916900634766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027247905731201172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030781269073486328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([55, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030986309051513672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030986309051513672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031038761138916016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034395694732666016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([550, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03699207305908203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03699207305908203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 275, 128]), torch.Size([1, 275, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03725433349609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05587482452392578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 275, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05587482452392578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05587482452392578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 275, 128]), torch.Size([1, 275, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0561370849609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07462644577026367  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 275, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07080888748168945  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07102060317993164  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07123231887817383  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07100963592529297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1418, 40])
input nodes number: 3259
output nodes number: 1418
edges number: 9078
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07103919982910156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07103967666625977  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003180980682373047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 15 input nodes size: 2840
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030045509338378906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030045509338378906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004358768463134766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004369258880615234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026378631591796875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0027008056640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0027008056640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0027008056640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([176, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006932258605957031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006932258605957031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007100105285644531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008442878723144531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([144, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008496284484863281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008496284484863281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008633613586425781  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010693550109863281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([127, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010806560516357422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010806560516357422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010927677154541016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013592243194580078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([109, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013739585876464844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013739585876464844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013843536376953125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01685810089111328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 109, 128])
m.shape torch.Size([95, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017032623291015625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017032623291015625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01712322235107422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020384788513183594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([88, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020591259002685547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020591259002685547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 88, 128]), torch.Size([1, 88, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020675182342529297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024283885955810547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 88, 128])
m.shape torch.Size([65, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024458885192871094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024458885192871094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0245208740234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027620315551757812  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([64, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02783346176147461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02783346176147461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02789449691772461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03137350082397461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([57, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03158760070800781  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03158760070800781  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03164196014404297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03512096405029297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([468, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.037325382232666016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.037325382232666016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03754854202270508  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.053392887115478516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 234, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.053392887115478516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.053392887115478516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05361604690551758  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06934881210327148  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 234, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06584310531616211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06605100631713867  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06625890731811523  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0660405158996582  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1393, 40])
input nodes number: 2840
output nodes number: 1393
edges number: 8444
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06606864929199219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06606912612915039  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0027971267700195312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 16 input nodes size: 3139
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026340484619140625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026340484619140625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0043544769287109375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004365444183349609  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030007362365722656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003052234649658203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003052234649658203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003052234649658203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([269, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006556987762451172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006556987762451172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006813526153564453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008865833282470703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([233, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008959770202636719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008959770202636719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 233, 128]), torch.Size([1, 233, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009181976318359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012515068054199219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 233, 128])
m.shape torch.Size([188, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012672901153564453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012672901153564453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 188, 128]), torch.Size([1, 188, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012852191925048828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016796588897705078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 188, 128])
m.shape torch.Size([146, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016985416412353516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016985416412353516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017124652862548828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02116250991821289  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([115, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02136707305908203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02136707305908203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 115, 128]), torch.Size([1, 115, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02147674560546875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025424957275390625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 115, 128])
m.shape torch.Size([83, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025607585906982422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025607585906982422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02568674087524414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029090404510498047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([65, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02926778793334961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02926778793334961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029329776763916016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03242921829223633  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([60, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.032627105712890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.032627105712890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.032684326171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035945892333984375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([40, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03608894348144531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03608894348144531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 40, 128]), torch.Size([1, 40, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03612709045410156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03856849670410156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 40, 128])
m.shape torch.Size([259, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03978443145751953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03978443145751953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03990745544433594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04864215850830078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 129, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04864215850830078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04864215850830078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 130, 128]), torch.Size([1, 130, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.048766136169433594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05750703811645508  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 130, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05484294891357422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.055060386657714844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05527782440185547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05504941940307617  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1458, 40])
input nodes number: 3139
output nodes number: 1458
edges number: 6841
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05509376525878906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.055094242095947266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031538009643554688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 17 input nodes size: 2773
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003010272979736328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003010272979736328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004332542419433594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004343509674072266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026121139526367188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026617050170898438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026617050170898438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026617050170898438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([258, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006030082702636719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006030082702636719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006276130676269531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008244514465332031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 258, 128])
m.shape torch.Size([244, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00835418701171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00835418701171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 244, 128]), torch.Size([1, 244, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008586883544921875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01207733154296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 244, 128])
m.shape torch.Size([188, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01222991943359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01222991943359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 188, 128]), torch.Size([1, 188, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012409210205078125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016353607177734375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 188, 128])
m.shape torch.Size([153, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0165557861328125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0165557861328125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 153, 128]), torch.Size([1, 153, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016701698303222656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020933151245117188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 153, 128])
m.shape torch.Size([126, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021160602569580078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021160602569580078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 126, 128]), torch.Size([1, 126, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021280765533447266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025606632232666016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 126, 128])
m.shape torch.Size([91, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025806903839111328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025806903839111328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025893688201904297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029625415802001953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([64, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02979564666748047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02979564666748047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02985668182373047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03290843963623047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([50, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03306865692138672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03306865692138672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03311634063720703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035834312438964844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03602933883666992  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03602933883666992  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03607797622680664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03919076919555664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([217, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.040886878967285156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.040886878967285156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04098987579345703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.048302650451660156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 108, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.048302650451660156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.048302650451660156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04840660095214844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05573558807373047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 109, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05320310592651367  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05341815948486328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05363321304321289  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05340719223022461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1442, 40])
input nodes number: 2773
output nodes number: 1442
edges number: 6575
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0534367561340332  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.053437232971191406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00274658203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 18 input nodes size: 2677
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002609729766845703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002609729766845703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004330158233642578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00434112548828125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030078887939453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003063201904296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003063201904296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003063201904296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([222, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006781578063964844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006781578063964844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 222, 128]), torch.Size([1, 222, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006993293762207031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008687019348144531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 222, 128])
m.shape torch.Size([194, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00876617431640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00876617431640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 194, 128]), torch.Size([1, 194, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008951187133789062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01172637939453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 194, 128])
m.shape torch.Size([185, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011898517608642578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011898517608642578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012074947357177734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015956401824951172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([139, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01613330841064453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01613330841064453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 139, 128]), torch.Size([1, 139, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016265869140625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020110130310058594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 139, 128])
m.shape torch.Size([136, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020368099212646484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020368099212646484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020497798919677734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025166988372802734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([98, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025382518768310547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025382518768310547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02547597885131836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029494762420654297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([89, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029745101928710938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029745101928710938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029829978942871094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034073829650878906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([75, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0343174934387207  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0343174934387207  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03438901901245117  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03846597671508789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([63, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03870058059692383  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03870058059692383  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03876066207885742  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04260587692260742  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([255, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.043791770935058594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.043791770935058594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04391288757324219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.052512168884277344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 127, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.052512168884277344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.052512168884277344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.052634239196777344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06124067306518555  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 128, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.058344364166259766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05856132507324219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05877828598022461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.058550357818603516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1456, 40])
input nodes number: 2677
output nodes number: 1456
edges number: 7329
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05858325958251953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.058583736419677734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031571388244628906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 19 input nodes size: 2513
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003009796142578125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003009796142578125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004208087921142578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00421905517578125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002487659454345703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002536296844482422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002536296844482422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002536296844482422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([280, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0058345794677734375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0058345794677734375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 280, 128]), torch.Size([1, 280, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0061016082763671875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008237838745117188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 280, 128])
m.shape torch.Size([269, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008360862731933594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008360862731933594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008617401123046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012465476989746094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([181, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01259613037109375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01259613037109375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012768745422363281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01656627655029297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 181, 128])
m.shape torch.Size([131, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01672983169555664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01672983169555664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 131, 128]), torch.Size([1, 131, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01685476303100586  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020477771759033203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 131, 128])
m.shape torch.Size([113, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02068471908569336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02068471908569336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020792484283447266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02467203140258789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([93, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02488422393798828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02488422393798828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 93, 128]), torch.Size([1, 93, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024972915649414062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028786659240722656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 93, 128])
m.shape torch.Size([69, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028972625732421875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028972625732421875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029038429260253906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03232860565185547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([55, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03250551223754883  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03250551223754883  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03255796432495117  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035547733306884766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([38, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03568458557128906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03568458557128906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 38, 128]), torch.Size([1, 38, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0357208251953125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0380401611328125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 38, 128])
m.shape torch.Size([213, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.039742469787597656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.039742469787597656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03984355926513672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.047020912170410156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 106, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.047020912170410156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.047020912170410156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 107, 128]), torch.Size([1, 107, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.047122955322265625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.054317474365234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 107, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.051865577697753906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.052080631256103516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.052295684814453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.052069664001464844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1442, 40])
input nodes number: 2513
output nodes number: 1442
edges number: 6403
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05209779739379883  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05209827423095703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026187896728515625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 20 input nodes size: 2942
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0024857521057128906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0024857521057128906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004206180572509766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0042171478271484375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030078887939453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030670166015625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030670166015625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030670166015625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([198, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00702667236328125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00702667236328125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 198, 128]), torch.Size([1, 198, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0072154998779296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008726119995117188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 198, 128])
m.shape torch.Size([190, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008812904357910156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008812904357910156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008994102478027344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011712074279785156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 190, 128])
m.shape torch.Size([140, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011821746826171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011821746826171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 140, 128]), torch.Size([1, 140, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01195526123046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014892578125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 140, 128])
m.shape torch.Size([139, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0150909423828125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0150909423828125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 139, 128]), torch.Size([1, 139, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015223503112792969  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019067764282226562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 139, 128])
m.shape torch.Size([91, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01921844482421875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01921844482421875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01930522918701172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022429466247558594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([78, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022609233856201172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022609233856201172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02268362045288086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025882244110107422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([95, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026162147521972656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026162147521972656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02625274658203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030782699584960938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([75, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031023502349853516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031023502349853516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031095027923583984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0351719856262207  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([61, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035398006439208984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035398006439208984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035456180572509766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.039179325103759766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([356, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0408477783203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0408477783203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04101753234863281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.053070068359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 178, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.053070068359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.053070068359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05323982238769531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06520748138427734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 178, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06202268600463867  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06223487854003906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06244707107543945  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06222391128540039  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1423, 40])
input nodes number: 2942
output nodes number: 1423
edges number: 7851
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06225395202636719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06225442886352539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003161907196044922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 21 input nodes size: 3024
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030050277709960938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030050277709960938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004446983337402344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004457950592041016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0027265548706054688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002777099609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002777099609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002777099609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([244, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006208896636962891  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006208896636962891  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 244, 128]), torch.Size([1, 244, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006441593170166016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008303165435791016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 244, 128])
m.shape torch.Size([214, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00839090347290039  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00839090347290039  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 214, 128]), torch.Size([1, 214, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008594989776611328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01165628433227539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 214, 128])
m.shape torch.Size([210, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01185464859008789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01185464859008789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 210, 128]), torch.Size([1, 210, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012054920196533203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016460895538330078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 210, 128])
m.shape torch.Size([144, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016635417938232422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016635417938232422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016772747039794922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020755290985107422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([106, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020939350128173828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020939350128173828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02104043960571289  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02467966079711914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 106, 128])
m.shape torch.Size([104, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02492666244506836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02492666244506836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02502584457397461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02929067611694336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 104, 128])
m.shape torch.Size([79, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029504776000976562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029504776000976562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029580116271972656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033347129821777344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([52, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0335078239440918  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0335078239440918  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03355741500854492  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03638410568237305  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([52, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03658246994018555  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03658246994018555  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03663206100463867  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03980588912963867  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([225, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.041501522064208984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.041501522064208984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.041608333587646484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.049191951751708984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 112, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.049191951751708984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.049191951751708984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04929971694946289  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.056897640228271484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 113, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.054288387298583984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05450153350830078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05471467971801758  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05449056625366211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1430, 40])
input nodes number: 3024
output nodes number: 1430
edges number: 6719
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05452537536621094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05452585220336914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002868175506591797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 22 input nodes size: 3075
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002727508544921875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002727508544921875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00444793701171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004458904266357422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030059814453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030660629272460938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030660629272460938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030660629272460938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([203, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0070705413818359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0070705413818359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 203, 128]), torch.Size([1, 203, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007264137268066406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008812904357910156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 203, 128])
m.shape torch.Size([190, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00889730453491211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00889730453491211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009078502655029297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01179647445678711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 190, 128])
m.shape torch.Size([138, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01190328598022461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01190328598022461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012034893035888672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014930248260498047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([121, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015095233917236328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015095233917236328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015210628509521484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018557071685791016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([121, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018787860870361328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018787860870361328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018903255462646484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02305746078491211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([85, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023242950439453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023242950439453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023324012756347656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0268096923828125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 85, 128])
m.shape torch.Size([72, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02700948715209961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02700948715209961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02707815170288086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03051137924194336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([66, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030728816986083984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030728816986083984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030791759490966797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03437948226928711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([57, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034592628479003906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034592628479003906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03464698791503906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03812599182128906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([380, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03991079330444336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03991079330444336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04009199142456055  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05295705795288086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 190, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05295705795288086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05295705795288086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05313825607299805  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06591272354125977  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 190, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06268548965454102  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06289911270141602  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06311273574829102  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06288814544677734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1433, 40])
input nodes number: 3075
output nodes number: 1433
edges number: 7941
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06292295455932617  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06292343139648438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003166675567626953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 23 input nodes size: 2584
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003006458282470703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003006458282470703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004238605499267578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004249095916748047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0025177001953125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002574920654296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002574920654296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002574920654296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([196, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006404876708984375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006404876708984375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 196, 128]), torch.Size([1, 196, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006591796875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008087158203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 196, 128])
m.shape torch.Size([205, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008189201354980469  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008189201354980469  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00838470458984375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011317253112792969  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 205, 128])
m.shape torch.Size([147, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011429786682128906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011429786682128906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 147, 128]), torch.Size([1, 147, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011569976806640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014654159545898438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 147, 128])
m.shape torch.Size([123, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014818668365478516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014818668365478516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014935970306396484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018337726593017578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([112, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018546104431152344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018546104431152344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018652915954589844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022498130798339844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([78, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022667884826660156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022667884826660156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022742271423339844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025940895080566406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([83, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026180744171142578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026180744171142578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026259899139404297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030217647552490234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([51, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03037261962890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03037261962890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03042125701904297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03319358825683594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([54, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0334010124206543  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0334010124206543  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033452510833740234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.036748409271240234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([355, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03844308853149414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03844308853149414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 177, 128]), torch.Size([1, 177, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03861188888549805  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05059671401977539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 177, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05059671401977539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05059671401977539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0507664680480957  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06273460388183594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 178, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05966615676879883  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05987548828125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06008481979370117  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05986499786376953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1404, 40])
input nodes number: 2584
output nodes number: 1404
edges number: 7592
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0598907470703125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0598912239074707  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002663135528564453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 24 input nodes size: 3105
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002513408660888672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002513408660888672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004233837127685547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004244804382324219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003002166748046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030603408813476562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030603408813476562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030603408813476562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([211, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006965160369873047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006965160369873047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007166385650634766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008776187896728516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 211, 128])
m.shape torch.Size([187, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008853912353515625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008853912353515625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 187, 128]), torch.Size([1, 187, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009032249450683594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011707305908203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 187, 128])
m.shape torch.Size([165, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011854171752929688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011854171752929688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012011528015136719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015473365783691406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 165, 128])
m.shape torch.Size([132, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01564645767211914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01564645767211914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 132, 128]), torch.Size([1, 132, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015772342681884766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01942300796508789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 132, 128])
m.shape torch.Size([108, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019617557525634766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019617557525634766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01972055435180664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02342844009399414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([101, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023665904998779297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023665904998779297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023762226104736328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027904033660888672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([76, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02810955047607422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02810955047607422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028182029724121094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031805992126464844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([63, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03201007843017578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03201007843017578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.032070159912109375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03549480438232422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([53, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03569221496582031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03569221496582031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035742759704589844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.038977622985839844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([346, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04060220718383789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04060220718383789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04076719284057617  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05248117446899414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 173, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05248117446899414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05248117446899414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05264616012573242  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06427764892578125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 173, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06116437911987305  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.061379432678222656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.061594486236572266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.061368465423583984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1442, 40])
input nodes number: 3105
output nodes number: 1442
edges number: 7727
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06140851974487305  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06140899658203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031642913818359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 25 input nodes size: 4080
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030078887939453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030078887939453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0049533843994140625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004964351654052734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0032329559326171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0033025741577148438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0033025741577148438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0033025741577148438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([185, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007917404174804688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007917404174804688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008093833923339844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009505271911621094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([142, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009552478790283203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009552478790283203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00968790054321289  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011719226837158203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 142, 128])
m.shape torch.Size([119, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011821746826171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011821746826171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011935234069824219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014431953430175781  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([92, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01455068588256836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01455068588256836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014638423919677734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01718282699584961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([101, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0173797607421875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0173797607421875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01747608184814453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020943641662597656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([77, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021115779876708984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021115779876708984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021189212799072266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02434682846069336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([67, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024533748626708984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024533748626708984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 67, 128]), torch.Size([1, 67, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024597644805908203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02779245376586914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 67, 128])
m.shape torch.Size([61, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027993202209472656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027993202209472656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028051376342773438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03136730194091797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([50, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031552791595458984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031552791595458984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0316004753112793  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0346522331237793  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([565, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0373225212097168  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0373225212097168  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 282, 128]), torch.Size([1, 282, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03759145736694336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0566859245300293  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 282, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0566859245300293  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0566859245300293  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.056955814361572266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07598352432250977  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 283, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07211494445800781  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07233238220214844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07254981994628906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07232141494750977  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1459, 40])
input nodes number: 4080
output nodes number: 1459
edges number: 9218
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07236528396606445  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07236576080322266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003421783447265625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 26 input nodes size: 3109
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003235340118408203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003235340118408203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004955768585205078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00496673583984375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003010272979736328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003074169158935547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003074169158935547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003074169158935547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([189, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007344245910644531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007344245910644531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 189, 128]), torch.Size([1, 189, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0075244903564453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008966445922851562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 189, 128])
m.shape torch.Size([158, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00902700424194336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00902700424194336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 158, 128]), torch.Size([1, 158, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009177684783935547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01143789291381836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 158, 128])
m.shape torch.Size([141, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011564254760742188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011564254760742188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011698722839355469  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014657020568847656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([128, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014833927154541016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014833927154541016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014955997467041016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018496036529541016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([111, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01869964599609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01869964599609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018805503845214844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02261638641357422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 111, 128])
m.shape torch.Size([75, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022778034210205078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022778034210205078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022849559783935547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025925159454345703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([64, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02610301971435547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02610301971435547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02616405487060547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02921581268310547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([74, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02946758270263672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02946758270263672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02953815460205078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033560752868652344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([60, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033782958984375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033782958984375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033840179443359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.037502288818359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([448, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03960990905761719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03960990905761719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 224, 128]), torch.Size([1, 224, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03982353210449219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05499076843261719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 224, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05499076843261719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05499076843261719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 224, 128]), torch.Size([1, 224, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05520439147949219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07026481628417969  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 224, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06676006317138672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06697607040405273  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06719207763671875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06696510314941406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1448, 40])
input nodes number: 3109
output nodes number: 1448
edges number: 8505
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06699800491333008  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06699848175048828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031766891479492188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 27 input nodes size: 3963
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030088424682617188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030088424682617188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004898548126220703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004909515380859375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003178119659423828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003239154815673828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003239154815673828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003239154815673828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([219, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0073528289794921875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0073528289794921875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 219, 128]), torch.Size([1, 219, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007561683654785156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009232521057128906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 219, 128])
m.shape torch.Size([192, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009311199188232422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009311199188232422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 192, 128]), torch.Size([1, 192, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009494304656982422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012240886688232422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 192, 128])
m.shape torch.Size([143, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012353897094726562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012353897094726562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012490272521972656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015490531921386719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([112, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015635967254638672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015635967254638672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015742778778076172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018840312957763672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([79, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018975257873535156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018975257873535156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01905059814453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021762847900390625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([76, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021942615509033203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021942615509033203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022015094757080078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025131702423095703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([71, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02533245086669922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02533245086669922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025400161743164062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02878570556640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([66, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029003620147705078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029003620147705078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02906656265258789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0326542854309082  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03282451629638672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03282451629638672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03286933898925781  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03573799133300781  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([437, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03779935836791992  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03779935836791992  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.038007259368896484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05276823043823242  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 218, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05276823043823242  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05276823043823242  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 219, 128]), torch.Size([1, 219, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05297708511352539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06770181655883789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 219, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06436443328857422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06457948684692383  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06479454040527344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06456851959228516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1442, 40])
input nodes number: 3963
output nodes number: 1442
edges number: 8149
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06460809707641602  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06460857391357422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003345489501953125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 28 input nodes size: 3343
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003177165985107422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003177165985107422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004897594451904297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004908561706542969  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030078887939453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030651092529296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030651092529296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030651092529296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([215, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006914615631103516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006914615631103516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 215, 128]), torch.Size([1, 215, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007119655609130859  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00875997543334961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 215, 128])
m.shape torch.Size([205, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008852958679199219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008852958679199219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0090484619140625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011981010437011719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 205, 128])
m.shape torch.Size([137, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012079238891601562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012079238891601562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 137, 128]), torch.Size([1, 137, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012209892272949219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015084266662597656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 137, 128])
m.shape torch.Size([141, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01528787612915039  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01528787612915039  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015422344207763672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019321918487548828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([105, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019505023956298828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019505023956298828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019605159759521484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02321004867553711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([86, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023406028747558594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023406028747558594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 86, 128]), torch.Size([1, 86, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02348804473876953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027014732360839844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 86, 128])
m.shape torch.Size([63, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027184009552001953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027184009552001953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027244091033935547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030248165130615234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([75, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030504226684570312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030504226684570312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03057575225830078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0346527099609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([55, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03485298156738281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03485298156738281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034905433654785156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.038262367248535156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([343, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0398716926574707  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0398716926574707  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04003477096557617  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05161333084106445  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 171, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05161333084106445  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05161333084106445  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05177736282348633  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06334209442138672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 172, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.060277462005615234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06049013137817383  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06070280075073242  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.060479164123535156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1425, 40])
input nodes number: 3343
output nodes number: 1425
edges number: 7607
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06051301956176758  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06051349639892578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003161907196044922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 29 input nodes size: 4480
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003005504608154297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003005504608154297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005141735076904297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005152702331542969  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003421306610107422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0034880638122558594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0034880638122558594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0034880638122558594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([173, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007946014404296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007946014404296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008111000061035156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009430885314941406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 173, 128])
m.shape torch.Size([167, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00950765609741211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00950765609741211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009666919708251953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01205587387084961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 167, 128])
m.shape torch.Size([118, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012145042419433594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012145042419433594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 118, 128]), torch.Size([1, 118, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012257575988769531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014733314514160156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 118, 128])
m.shape torch.Size([103, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014873504638671875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014873504638671875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014971733093261719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017820358276367188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([90, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017985820770263672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017985820770263672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018071651458740234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021161556243896484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([89, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021373271942138672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021373271942138672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021458148956298828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025107860565185547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([72, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025305747985839844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025305747985839844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025374412536621094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028807640075683594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([66, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02902507781982422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02902507781982422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02908802032470703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.032675743103027344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([54, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.032876014709472656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.032876014709472656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.032927513122558594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.036223411560058594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([513, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.038643836975097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.038643836975097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.038887977600097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.056221961975097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 256, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.056221961975097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.056221961975097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 257, 128]), torch.Size([1, 257, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05646705627441406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0737466812133789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 257, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07003211975097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07024765014648438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07046318054199219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0702366828918457  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1445, 40])
input nodes number: 4480
output nodes number: 1445
edges number: 8905
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07028388977050781  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07028436660766602  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0036077499389648438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 30 input nodes size: 3530
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0034241676330566406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0034241676330566406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005144596099853516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005155086517333984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030078887939453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030698776245117188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030698776245117188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030698776245117188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([217, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007206916809082031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007206916809082031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 217, 128]), torch.Size([1, 217, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0074138641357421875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009069442749023438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 217, 128])
m.shape torch.Size([163, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009121417999267578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009121417999267578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 163, 128]), torch.Size([1, 163, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009276866912841797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011608600616455078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 163, 128])
m.shape torch.Size([113, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011692523956298828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011692523956298828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011800289154052734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014171123504638672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([103, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014313697814941406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014313697814941406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01441192626953125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01726055145263672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([95, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01743793487548828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01743793487548828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017528533935546875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02079010009765625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([62, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020922183990478516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020922183990478516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020981311798095703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023523807525634766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([65, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023711204528808594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023711204528808594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023773193359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026872634887695312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([56, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02705526351928711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02705526351928711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 56, 128]), torch.Size([1, 56, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02710866928100586  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03015279769897461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 56, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030327796936035156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030327796936035156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03037261962890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03324127197265625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([474, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035479068756103516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035479068756103516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 237, 128]), torch.Size([1, 237, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0357050895690918  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.051752567291259766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 237, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.051752567291259766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.051752567291259766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 237, 128]), torch.Size([1, 237, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05197858810424805  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06791305541992188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 237, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06451988220214844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.064727783203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06493568420410156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06471729278564453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1395, 40])
input nodes number: 3530
output nodes number: 1395
edges number: 8207
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06474685668945312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06474733352661133  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003166675567626953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 31 input nodes size: 3573
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030002593994140625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030002593994140625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004703998565673828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0047149658203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0029840469360351562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003047943115234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003047943115234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003047943115234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([169, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007342815399169922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007342815399169922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 169, 128]), torch.Size([1, 169, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007503986358642578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008793354034423828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 169, 128])
m.shape torch.Size([165, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008870124816894531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008870124816894531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009027481079101562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011387825012207031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 165, 128])
m.shape torch.Size([156, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011532306671142578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011532306671142578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011681079864501953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014954090118408203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 156, 128])
m.shape torch.Size([131, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015129566192626953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015129566192626953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 131, 128]), torch.Size([1, 131, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015254497528076172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018877506256103516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 131, 128])
m.shape torch.Size([105, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019065380096435547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019065380096435547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019165515899658203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022770404815673828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([79, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02294635772705078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02294635772705078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023021697998046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026261329650878906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([76, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026477336883544922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026477336883544922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026549816131591797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030173778533935547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([58, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03035879135131836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03035879135131836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 58, 128]), torch.Size([1, 58, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030414104461669922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033566951751708984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 58, 128])
m.shape torch.Size([54, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03377103805541992  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03377103805541992  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03382253646850586  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03711843490600586  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([460, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.039286136627197266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.039286136627197266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0395054817199707  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.055078983306884766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 230, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.055078983306884766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.055078983306884766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0552983283996582  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07076215744018555  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 230, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06722259521484375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06743955612182617  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0676565170288086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0674285888671875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1453, 40])
input nodes number: 3573
output nodes number: 1453
edges number: 8572
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0674753189086914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06747579574584961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031642913818359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 32 input nodes size: 3534
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0029931068420410156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0029931068420410156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004713535308837891  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0047245025634765625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003009796142578125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030651092529296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030651092529296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030651092529296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([229, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006791591644287109  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006791591644287109  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 229, 128]), torch.Size([1, 229, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007009983062744141  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00875711441040039  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 229, 128])
m.shape torch.Size([197, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008835792541503906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008835792541503906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009023666381835938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011841773986816406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([185, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012012481689453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012012481689453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012188911437988281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01607036590576172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([131, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016232013702392578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016232013702392578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 131, 128]), torch.Size([1, 131, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016356945037841797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01997995376586914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 131, 128])
m.shape torch.Size([100, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020155906677246094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020155906677246094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02025127410888672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02368450164794922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([104, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023934364318847656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023934364318847656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024033546447753906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028298377990722656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 104, 128])
m.shape torch.Size([59, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028445720672607422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028445720672607422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02850198745727539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03131532669067383  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([56, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031500816345214844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031500816345214844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 56, 128]), torch.Size([1, 56, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031554222106933594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034598350524902344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 56, 128])
m.shape torch.Size([54, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03480339050292969  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03480339050292969  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034854888916015625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.038150787353515625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([317, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03963661193847656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03963661193847656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 158, 128]), torch.Size([1, 158, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03978729248046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05048561096191406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 158, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05048561096191406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05048561096191406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 159, 128]), torch.Size([1, 159, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.050637245178222656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06132793426513672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 159, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.058400630950927734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.058614253997802734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.058827877044677734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05860328674316406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1432, 40])
input nodes number: 3534
output nodes number: 1432
edges number: 7343
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05863761901855469  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05863809585571289  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031604766845703125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 33 input nodes size: 2659
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003006458282470703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003006458282470703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0042743682861328125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004285335540771484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0025539398193359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026025772094726562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026025772094726562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026025772094726562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([261, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005933284759521484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005933284759521484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006182193756103516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008173465728759766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([241, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008278846740722656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008278846740722656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 241, 128]), torch.Size([1, 241, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008508682250976562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011956214904785156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 241, 128])
m.shape torch.Size([182, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01210165023803711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01210165023803711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012275218963623047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016093730926513672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 182, 128])
m.shape torch.Size([148, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016289234161376953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016289234161376953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 148, 128]), torch.Size([1, 148, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016430377960205078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020523548126220703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 148, 128])
m.shape torch.Size([135, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02077484130859375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02077484130859375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020903587341308594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02553844451904297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([73, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025682926177978516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025682926177978516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025752544403076172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02874612808227539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([63, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02892160415649414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02892160415649414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028981685638427734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03198575973510742  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([62, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.032192230224609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.032192230224609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03225135803222656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03562164306640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([49, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035802364349365234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035802364349365234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03584909439086914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03883981704711914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([212, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04053688049316406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04053688049316406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.040637969970703125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04781532287597656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 106, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04781532287597656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04781532287597656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.047916412353515625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05504322052001953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 106, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.052542686462402344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05275535583496094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05296802520751953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.052744388580322266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1426, 40])
input nodes number: 2659
output nodes number: 1426
edges number: 6492
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05277442932128906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.052774906158447266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026869773864746094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 34 input nodes size: 3411
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0025529861450195312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0025529861450195312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004273414611816406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004284381866455078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003005504608154297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030579566955566406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030579566955566406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030579566955566406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([247, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006619930267333984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006619930267333984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 247, 128]), torch.Size([1, 247, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006855487823486328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008739948272705078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 247, 128])
m.shape torch.Size([231, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00884246826171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00884246826171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009062767028808594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01236724853515625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([178, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012511730194091797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012511730194091797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01268148422241211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016416072845458984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 178, 128])
m.shape torch.Size([137, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01659250259399414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01659250259399414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 137, 128]), torch.Size([1, 137, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016723155975341797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020512104034423828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 137, 128])
m.shape torch.Size([116, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020723342895507812  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020723342895507812  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020833969116210938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024816513061523438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([79, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024987220764160156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024987220764160156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02506256103515625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02830219268798828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([69, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028494834899902344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028494834899902344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028560638427734375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03185081481933594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([57, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03203535079956055  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03203535079956055  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0320897102355957  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03518819808959961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([40, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035332679748535156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035332679748535156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 40, 128]), torch.Size([1, 40, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035370826721191406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.037812232971191406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 40, 128])
m.shape torch.Size([284, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.039147377014160156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.039147377014160156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.039282798767089844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.048897743225097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 142, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.048897743225097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.048897743225097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.049033164978027344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05858039855957031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 142, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.055834293365478516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05604887008666992  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05626344680786133  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05603790283203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1438, 40])
input nodes number: 3411
output nodes number: 1438
edges number: 6984
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0560765266418457  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.056077003479003906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003154754638671875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 35 input nodes size: 4411
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030074119567871094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030074119567871094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005110740661621094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005121707916259766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0033903121948242188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0034542083740234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0034542083740234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0034542083740234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([172, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007701396942138672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007701396942138672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007865428924560547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009177684783935547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 172, 128])
m.shape torch.Size([156, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009244441986083984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009244441986083984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00939321517944336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011624813079833984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 156, 128])
m.shape torch.Size([153, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011769294738769531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011769294738769531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 153, 128]), torch.Size([1, 153, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011915206909179688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015125274658203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 153, 128])
m.shape torch.Size([117, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01527547836303711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01527547836303711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01538705825805664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018622875213623047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([106, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018819808959960938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018819808959960938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0189208984375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02256011962890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 106, 128])
m.shape torch.Size([77, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022729873657226562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022729873657226562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022803306579589844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025960922241210938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([67, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026147842407226562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026147842407226562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 67, 128]), torch.Size([1, 67, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02621173858642578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02940654754638672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 67, 128])
m.shape torch.Size([65, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029622554779052734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029622554779052734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02968454360961914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0332179069519043  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([52, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033410072326660156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033410072326660156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03345966339111328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03663349151611328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([461, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.038806915283203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.038806915283203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03902626037597656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.054599761962890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 230, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.054599761962890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.054599761962890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05482006072998047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07035160064697266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 231, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0668478012084961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06706047058105469  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06727313995361328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06704950332641602  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1426, 40])
input nodes number: 4411
output nodes number: 1426
edges number: 8470
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06709146499633789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0670919418334961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0035657882690429688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 36 input nodes size: 3401
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0033884048461914062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0033884048461914062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005108833312988281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005119800567626953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003005504608154297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003052234649658203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003052234649658203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003052234649658203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([316, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006281375885009766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006281375885009766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006582736968994141  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00899362564086914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([214, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00904703140258789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00904703140258789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 214, 128]), torch.Size([1, 214, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009251117706298828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01231241226196289  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 214, 128])
m.shape torch.Size([179, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0124664306640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0124664306640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 179, 128]), torch.Size([1, 179, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012637138366699219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01639270782470703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 179, 128])
m.shape torch.Size([144, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016582012176513672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016582012176513672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016719341278076172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020701885223388672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([102, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020876407623291016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020876407623291016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 102, 128]), torch.Size([1, 102, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020973682403564453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024475574493408203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 102, 128])
m.shape torch.Size([91, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02468729019165039  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02468729019165039  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02477407455444336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028505802154541016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([63, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02867269515991211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02867269515991211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028732776641845703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03173685073852539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([53, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03190898895263672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03190898895263672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03195953369140625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03484058380126953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03501701354980469  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03501701354980469  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03506183624267578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03793048858642578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([203, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03887605667114258  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03887605667114258  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03897237777709961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04581117630004883  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 101, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04581117630004883  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04581117630004883  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 102, 128]), torch.Size([1, 102, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.045908451080322266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05276679992675781  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 102, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05038738250732422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05059814453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05080890655517578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05058717727661133  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1412, 40])
input nodes number: 3401
output nodes number: 1412
edges number: 6231
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.050621986389160156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05062246322631836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003139495849609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 37 input nodes size: 2888
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030035972595214844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030035972595214844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004380702972412109  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004391670227050781  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026602745056152344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002723217010498047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002723217010498047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002723217010498047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([199, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006957530975341797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006957530975341797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 199, 128]), torch.Size([1, 199, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007147312164306641  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00866556167602539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 199, 128])
m.shape torch.Size([185, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008747100830078125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008747100830078125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008923530578613281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011569976806640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([136, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011676311492919922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011676311492919922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011806011199951172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014659404754638672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([101, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01478719711303711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01478719711303711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01488351821899414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017676830291748047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([74, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017805099487304688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017805099487304688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01787567138671875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020416259765625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([57, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020544052124023438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020544052124023438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020598411560058594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022935867309570312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([64, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023122310638427734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023122310638427734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023183345794677734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026235103607177734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([44, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026372432708740234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026372432708740234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 44, 128]), torch.Size([1, 44, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02641439437866211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028806209564208984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 44, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02900409698486328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02900409698486328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029052734375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03216552734375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([507, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034558773040771484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034558773040771484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034800052642822266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.051930904388427734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 253, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.051930904388427734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.051930904388427734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 254, 128]), torch.Size([1, 254, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05217313766479492  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06925106048583984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 254, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06575727462768555  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06596899032592773  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06618070602416992  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06595802307128906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1418, 40])
input nodes number: 2888
output nodes number: 1418
edges number: 8422
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06599187850952148  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06599235534667969  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0028257369995117188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 38 input nodes size: 3685
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026612281799316406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026612281799316406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004418373107910156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004429340362548828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030412673950195312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030965805053710938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030965805053710938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030965805053710938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([225, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006811618804931641  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006811618804931641  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 225, 128]), torch.Size([1, 225, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007026195526123047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008742809295654297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 225, 128])
m.shape torch.Size([198, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008824348449707031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008824348449707031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 198, 128]), torch.Size([1, 198, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009013175964355469  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011845588684082031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 198, 128])
m.shape torch.Size([163, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01198434829711914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01198434829711914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 163, 128]), torch.Size([1, 163, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01213979721069336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015559673309326172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 163, 128])
m.shape torch.Size([129, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015727996826171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015727996826171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01585102081298828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019418716430664062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 129, 128])
m.shape torch.Size([117, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019636154174804688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019636154174804688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01974773406982422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023764610290527344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([84, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023949146270751953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023949146270751953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 84, 128]), torch.Size([1, 84, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024029254913330078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027473926544189453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 84, 128])
m.shape torch.Size([71, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027670860290527344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027670860290527344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027738571166992188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031124114990234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([63, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03133058547973633  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03133058547973633  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03139066696166992  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034815311431884766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([55, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035021305084228516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035021305084228516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03507375717163086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03843069076538086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([311, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.039887428283691406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.039887428283691406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 155, 128]), torch.Size([1, 155, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.040035247802734375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.050530433654785156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 155, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.050530433654785156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.050530433654785156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05067920684814453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06116819381713867  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 156, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05824422836303711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.058455467224121094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05866670608520508  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05844449996948242  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1416, 40])
input nodes number: 3685
output nodes number: 1416
edges number: 7321
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05848264694213867  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.058483123779296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031957626342773438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 39 input nodes size: 3737
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003040790557861328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003040790557861328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004822731018066406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004833698272705078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030655860900878906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031228065490722656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031228065490722656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031228065490722656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([217, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006960391998291016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006960391998291016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 217, 128]), torch.Size([1, 217, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007167339324951172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008822917938232422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 217, 128])
m.shape torch.Size([192, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008902549743652344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008902549743652344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 192, 128]), torch.Size([1, 192, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009085655212402344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011832237243652344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 192, 128])
m.shape torch.Size([162, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011972427368164062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.011972427368164062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 162, 128]), torch.Size([1, 162, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012126922607421875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01552581787109375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 162, 128])
m.shape torch.Size([129, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015694618225097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015694618225097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015817642211914062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019385337829589844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 129, 128])
m.shape torch.Size([107, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019578933715820312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019578933715820312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 107, 128]), torch.Size([1, 107, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01968097686767578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023354530334472656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 107, 128])
m.shape torch.Size([89, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02355813980102539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02355813980102539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023643016815185547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027292728424072266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([59, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027447223663330078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027447223663330078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027503490447998047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030316829681396484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([51, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030483245849609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030483245849609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030531883239746094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03330421447753906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([49, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03349018096923828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03349018096923828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03353691101074219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03652763366699219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([365, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03824472427368164  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03824472427368164  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03841829299926758  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05074167251586914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 182, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05074167251586914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05074167251586914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 183, 128]), torch.Size([1, 183, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.050916194915771484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06322050094604492  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 183, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06016111373901367  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06037282943725586  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06058454513549805  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06036186218261719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1420, 40])
input nodes number: 3737
output nodes number: 1420
edges number: 7584
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06040143966674805  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06040191650390625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0032253265380859375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 40 input nodes size: 5903
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030660629272460938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030660629272460938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005880832672119141  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0058917999267578125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0040988922119140625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0041675567626953125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0041675567626953125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0041675567626953125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([180, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008769512176513672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008769512176513672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 180, 128]), torch.Size([1, 180, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008941173553466797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010314464569091797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 180, 128])
m.shape torch.Size([153, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01037454605102539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01037454605102539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 153, 128]), torch.Size([1, 153, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010520458221435547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01270914077758789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 153, 128])
m.shape torch.Size([106, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012787818908691406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012787818908691406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012888908386230469  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015112876892089844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 106, 128])
m.shape torch.Size([81, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015216827392578125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015216827392578125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015294075012207031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017534255981445312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([88, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017705440521240234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017705440521240234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 88, 128]), torch.Size([1, 88, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017789363861083984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020810604095458984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 88, 128])
m.shape torch.Size([93, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021034717559814453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021034717559814453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 93, 128]), torch.Size([1, 93, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021123409271240234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024937152862548828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 93, 128])
m.shape torch.Size([68, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025119781494140625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025119781494140625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02518463134765625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0284271240234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([55, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028604507446289062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028604507446289062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028656959533691406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031646728515625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([54, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03185224533081055  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03185224533081055  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031903743743896484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035199642181396484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([567, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.037877559661865234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.037877559661865234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0381474494934082  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.057309627532958984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 283, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.057309627532958984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.057309627532958984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05758047103881836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0766754150390625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 284, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07280921936035156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07302474975585938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07324028015136719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0730137825012207  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1445, 40])
input nodes number: 5903
output nodes number: 1445
edges number: 9198
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07307291030883789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0730733871459961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0043010711669921875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 41 input nodes size: 4934
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0041027069091796875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0041027069091796875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006455421447753906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006465911865234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0036401748657226562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0036973953247070312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0036973953247070312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0036973953247070312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([219, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008514404296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008514404296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 219, 128]), torch.Size([1, 219, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008723258972167969  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010394096374511719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 219, 128])
m.shape torch.Size([192, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010472774505615234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010472774505615234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 192, 128]), torch.Size([1, 192, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010655879974365234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013402462005615234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 192, 128])
m.shape torch.Size([130, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013496875762939453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013496875762939453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 130, 128]), torch.Size([1, 130, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013620853424072266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01634836196899414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 130, 128])
m.shape torch.Size([104, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016484737396240234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016484737396240234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016583919525146484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019460201263427734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 104, 128])
m.shape torch.Size([81, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019603729248046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019603729248046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01968097686767578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022461891174316406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([86, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022669315338134766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022669315338134766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 86, 128]), torch.Size([1, 86, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022751331329345703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026278018951416016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 86, 128])
m.shape torch.Size([59, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026433944702148438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026433944702148438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026490211486816406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029303550720214844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([60, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02950429916381836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02950429916381836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029561519622802734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03282308578491211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([38, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03295755386352539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03295755386352539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 38, 128]), torch.Size([1, 38, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03299379348754883  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03531312942504883  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 38, 128])
m.shape torch.Size([410, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03725004196166992  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03725004196166992  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0374455451965332  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05132627487182617  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 205, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05132627487182617  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05132627487182617  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05152177810668945  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06530475616455078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 205, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06123542785644531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06144094467163086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.061646461486816406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06143045425415039  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1379, 40])
input nodes number: 4934
output nodes number: 1379
edges number: 7665
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06146812438964844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06146860122680664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0037975311279296875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 42 input nodes size: 3942
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0036301612854003906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0036301612854003906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005509853363037109  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005520343780517578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031571388244628906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003204822540283203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003204822540283203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003204822540283203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([275, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006455421447753906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006455421447753906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 275, 128]), torch.Size([1, 275, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006717681884765625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008815765380859375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 275, 128])
m.shape torch.Size([227, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008901119232177734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008901119232177734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 227, 128]), torch.Size([1, 227, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009117603302001953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012364864349365234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 227, 128])
m.shape torch.Size([181, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012515544891357422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012515544891357422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012688159942626953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01648569107055664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 181, 128])
m.shape torch.Size([125, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016637802124023438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016637802124023438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01675701141357422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020214080810546875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([114, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020426273345947266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020426273345947266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020534992218017578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024448871612548828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 114, 128])
m.shape torch.Size([65, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02458047866821289  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02458047866821289  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024642467498779297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027307987213134766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([65, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027493953704833984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027493953704833984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02755594253540039  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030655384063720703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([53, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030826568603515625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030826568603515625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030877113342285156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03375816345214844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([31, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033865928649902344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033865928649902344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 31, 128]), torch.Size([1, 31, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03389549255371094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03578758239746094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 31, 128])
m.shape torch.Size([243, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.036931514739990234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.036931514739990234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03704690933227539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.045239925384521484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 121, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.045239925384521484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.045239925384521484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 122, 128]), torch.Size([1, 122, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04535627365112305  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.053559303283691406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 122, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.051113128662109375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05131864547729492  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05152416229248047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05130815505981445  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1379, 40])
input nodes number: 3942
output nodes number: 1379
edges number: 6320
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.051348209381103516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05134868621826172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0032978057861328125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 43 input nodes size: 3795
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031571388244628906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031571388244628906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00496673583984375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004977226257324219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030870437622070312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031328201293945312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031328201293945312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031328201293945312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([314, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006258487701416016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006258487701416016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 314, 128]), torch.Size([1, 314, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006557941436767578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008953571319580078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 314, 128])
m.shape torch.Size([258, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00904989242553711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00904989242553711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009295940399169922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01298666000366211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 258, 128])
m.shape torch.Size([170, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013106822967529297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013106822967529297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01326894760131836  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016835689544677734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 170, 128])
m.shape torch.Size([135, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01701211929321289  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01701211929321289  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017140865325927734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020874500274658203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([103, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02105569839477539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02105569839477539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021153926849365234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02469015121459961  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([76, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024858474731445312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024858474731445312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024930953979492188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028047561645507812  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([59, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028208255767822266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028208255767822266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028264522552490234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031077861785888672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([55, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03125953674316406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03125953674316406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031311988830566406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0343017578125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([35, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03442573547363281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03442573547363281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 35, 128]), torch.Size([1, 35, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03445911407470703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03659534454345703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 35, 128])
m.shape torch.Size([200, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03753232955932617  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03753232955932617  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0376276969909668  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04439878463745117  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 100, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04439878463745117  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04439878463745117  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0444941520690918  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05121755599975586  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 100, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.048935890197753906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04914569854736328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.049355506896972656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04913520812988281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1405, 40])
input nodes number: 3795
output nodes number: 1405
edges number: 6019
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0491786003112793  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0491790771484375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00322723388671875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 44 input nodes size: 3929
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030913352966308594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030913352966308594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004971027374267578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00498199462890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003161907196044922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003219127655029297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003219127655029297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003219127655029297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([234, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007083415985107422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007083415985107422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007306575775146484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009091854095458984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 234, 128])
m.shape torch.Size([194, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009165287017822266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009165287017822266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 194, 128]), torch.Size([1, 194, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009350299835205078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012125492095947266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 194, 128])
m.shape torch.Size([159, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01226043701171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01226043701171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 159, 128]), torch.Size([1, 159, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012412071228027344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015748023986816406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 159, 128])
m.shape torch.Size([109, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015880107879638672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015880107879638672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015984058380126953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01899862289428711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 109, 128])
m.shape torch.Size([125, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019244670867919922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019244670867919922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019363880157470703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023655414581298828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([86, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02384185791015625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02384185791015625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 86, 128]), torch.Size([1, 86, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023923873901367188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0274505615234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 86, 128])
m.shape torch.Size([73, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027653217315673828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027653217315673828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027722835540771484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031203746795654297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([48, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03135204315185547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03135204315185547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03139781951904297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03400707244873047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([39, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034151554107666016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.034151554107666016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 39, 128]), torch.Size([1, 39, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03418874740600586  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03656911849975586  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 39, 128])
m.shape torch.Size([370, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0383148193359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0383148193359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.038491249084472656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05101776123046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 185, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05101776123046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05101776123046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.051194190979003906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06363248825073242  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 185, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0605616569519043  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0607762336730957  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06099081039428711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06076526641845703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1437, 40])
input nodes number: 3929
output nodes number: 1437
edges number: 7622
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06081056594848633  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06081104278564453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0033273696899414062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 45 input nodes size: 3791
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003166675567626953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003166675567626953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004974365234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004985332489013672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030946731567382812  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031423568725585938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031423568725585938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031423568725585938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([300, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006384849548339844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006384849548339844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 300, 128]), torch.Size([1, 300, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006670951843261719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008959770202636719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 300, 128])
m.shape torch.Size([236, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009041786193847656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009041786193847656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009266853332519531  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012642860412597656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([188, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012799263000488281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012799263000488281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 188, 128]), torch.Size([1, 188, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012978553771972656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016922950744628906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 188, 128])
m.shape torch.Size([140, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01710033416748047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01710033416748047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 140, 128]), torch.Size([1, 140, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017233848571777344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02110576629638672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 140, 128])
m.shape torch.Size([114, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021310806274414062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021310806274414062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021419525146484375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025333404541015625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 114, 128])
m.shape torch.Size([63, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02545928955078125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02545928955078125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025519371032714844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028102874755859375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([55, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02825641632080078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02825641632080078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028308868408203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030931472778320312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([65, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031153202056884766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031153202056884766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.031215190887451172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03474855422973633  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([36, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03487205505371094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03487205505371094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03490638732910156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03710365295410156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([220, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03896617889404297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03896617889404297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.039071083068847656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04651927947998047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 110, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04651927947998047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04651927947998047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.046624183654785156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.054019927978515625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 110, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05161905288696289  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.051830291748046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05204153060913086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0518193244934082  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1417, 40])
input nodes number: 3791
output nodes number: 1417
edges number: 6273
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05185556411743164  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.051856040954589844  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0032320022583007812  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 46 input nodes size: 3788
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030913352966308594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0030913352966308594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004971027374267578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00498199462890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031633377075195312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0032129287719726562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0032129287719726562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0032129287719726562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([271, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006603717803955078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006603717803955078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 271, 128]), torch.Size([1, 271, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.006862163543701172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008929729461669922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 271, 128])
m.shape torch.Size([223, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009013175964355469  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009013175964355469  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 223, 128]), torch.Size([1, 223, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009225845336914062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012415885925292969  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 223, 128])
m.shape torch.Size([166, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012547016143798828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012547016143798828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 166, 128]), torch.Size([1, 166, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012705326080322266  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01618814468383789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 166, 128])
m.shape torch.Size([150, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016395092010498047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016395092010498047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016538143157958984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020686626434326172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 150, 128])
m.shape torch.Size([114, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020886898040771484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020886898040771484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020995616912841797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024909496307373047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 114, 128])
m.shape torch.Size([86, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025101184844970703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025101184844970703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 86, 128]), torch.Size([1, 86, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02518320083618164  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028709888458251953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 86, 128])
m.shape torch.Size([58, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028862476348876953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028862476348876953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 58, 128]), torch.Size([1, 58, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028917789459228516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03168344497680664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 58, 128])
m.shape torch.Size([64, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03189992904663086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03189992904663086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03196096420288086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03543996810913086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([40, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035581111907958984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035581111907958984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 40, 128]), torch.Size([1, 40, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.035619258880615234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.038060665130615234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 40, 128])
m.shape torch.Size([243, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0392003059387207  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0392003059387207  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03931570053100586  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04750871658325195  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 121, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04750871658325195  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04750871658325195  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 122, 128]), torch.Size([1, 122, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.047625064849853516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.055828094482421875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 122, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05326032638549805  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05347156524658203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.053682804107666016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05346059799194336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1415, 40])
input nodes number: 3788
output nodes number: 1415
edges number: 6609
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05350017547607422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05350065231323242  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.003307819366455078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 47 input nodes size: 2778
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031633377075195312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0031633377075195312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0044879913330078125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004498958587646484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026082992553710938  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002651214599609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002651214599609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002651214599609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([321, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005641460418701172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005641460418701172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005947589874267578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008396625518798828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([276, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00850677490234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00850677490234375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 276, 128]), torch.Size([1, 276, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008769989013671875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01271820068359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 276, 128])
m.shape torch.Size([194, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012864112854003906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012864112854003906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 194, 128]), torch.Size([1, 194, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013049125671386719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017119407653808594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 194, 128])
m.shape torch.Size([137, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0172882080078125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0172882080078125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 137, 128]), torch.Size([1, 137, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017418861389160156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021207809448242188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 137, 128])
m.shape torch.Size([111, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021407127380371094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021407127380371094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021512985229492188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025323867797851562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 111, 128])
m.shape torch.Size([60, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02544260025024414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02544260025024414  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.025499820709228516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02796030044555664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([55, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028115272521972656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028115272521972656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028167724609375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030790328979492188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([47, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03094339370727539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03094339370727539  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030988216400146484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03354310989379883  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([39, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03368806838989258  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03368806838989258  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 39, 128]), torch.Size([1, 39, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03372526168823242  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03610563278198242  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 39, 128])
m.shape torch.Size([170, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03689765930175781  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03689765930175781  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.036978721618652344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04273414611816406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 85, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04273414611816406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04273414611816406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.042815208435058594  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04853010177612305  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 85, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.046395301818847656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.046605587005615234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04681587219238281  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04659461975097656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1410, 40])
input nodes number: 2778
output nodes number: 1410
edges number: 5730
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.046625614166259766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04662609100341797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.002730846405029297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 48 input nodes size: 5997
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026073455810546875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0026073455810546875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005466938018798828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.005477428436279297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004141807556152344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004199981689453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004199981689453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004199981689453125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([215, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008091926574707031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008091926574707031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 215, 128]), torch.Size([1, 215, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008296966552734375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009937286376953125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 215, 128])
m.shape torch.Size([184, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010010242462158203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010010242462158203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 184, 128]), torch.Size([1, 184, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010185718536376953  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012817859649658203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 184, 128])
m.shape torch.Size([146, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012938976287841797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012938976287841797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01307821273803711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016141414642333984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([120, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016300678253173828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016300678253173828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016415119171142578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019733905792236328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([96, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019905567169189453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019905567169189453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019997119903564453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023293018341064453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([71, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023450374603271484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023450374603271484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.023518085479736328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02642965316772461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([60, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0265960693359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0265960693359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026653289794921875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029514312744140625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([46, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029661178588867188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029661178588867188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 46, 128]), torch.Size([1, 46, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029705047607421875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03220558166503906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 46, 128])
m.shape torch.Size([33, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03232526779174805  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03232526779174805  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 33, 128]), torch.Size([1, 33, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03235673904418945  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03437089920043945  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 33, 128])
m.shape torch.Size([421, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.036362648010253906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.036362648010253906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 210, 128]), torch.Size([1, 210, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03656291961669922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.050782203674316406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 210, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.050782203674316406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.050782203674316406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.050983428955078125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0651702880859375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 211, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06202840805053711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06223583221435547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06244325637817383  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.062225341796875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1392, 40])
input nodes number: 5997
output nodes number: 1392
edges number: 7702
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.062277793884277344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06227827072143555  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004315853118896484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 49 input nodes size: 5245
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004138946533203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004138946533203125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007343292236328125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007354259490966797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0044841766357421875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004538536071777344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004538536071777344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004538536071777344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([262, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008213043212890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008213043212890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008462905883789062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010461807250976562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 262, 128])
m.shape torch.Size([231, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010557174682617188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010557174682617188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010777473449707031  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014081954956054688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([144, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014177799224853516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014177799224853516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014315128326416016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017336368560791016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([101, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017460346221923828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017460346221923828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01755666732788086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020349979400634766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([117, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020580768585205078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020580768585205078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02069234848022461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024709224700927734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([66, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024842262268066406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024842262268066406  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02490520477294922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027611732482910156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([59, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02777719497680664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02777719497680664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02783346176147461  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030646800994873047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([47, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030797958374023438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.030797958374023438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03084278106689453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033397674560546875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([39, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033542633056640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.033542633056640625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 39, 128]), torch.Size([1, 39, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03357982635498047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03596019744873047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 39, 128])
m.shape torch.Size([352, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03762006759643555  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03762006759643555  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03778791427612305  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04970502853393555  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 176, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04970502853393555  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04970502853393555  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.04987287521362305  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0617060661315918  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 176, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05883073806762695  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05904245376586914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05925416946411133  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05903148651123047  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1418, 40])
input nodes number: 5245
output nodes number: 1418
edges number: 7201
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.059085845947265625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05908632278442383  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004652976989746094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 50 input nodes size: 6228
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004488468170166016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004488468170166016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007458209991455078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007468700408935547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004253387451171875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0043182373046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0043182373046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0043182373046875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([208, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008676528930664062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008676528930664062  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 208, 128]), torch.Size([1, 208, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.008874893188476562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010461807250976562  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 208, 128])
m.shape torch.Size([154, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010509490966796875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010509490966796875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 154, 128]), torch.Size([1, 154, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010656356811523438  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012859344482421875  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 154, 128])
m.shape torch.Size([117, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01295328140258789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01295328140258789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013064861297607422  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01551961898803711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([73, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015603065490722656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015603065490722656  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015672683715820312  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017691612243652344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([61, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01780223846435547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01780223846435547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01786041259765625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019954681396484375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([48, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020062923431396484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020062923431396484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.020108699798583984  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022077083587646484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([42, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022194385528564453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022194385528564453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 42, 128]), torch.Size([1, 42, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022234439849853516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02423715591430664  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 42, 128])
m.shape torch.Size([46, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02439260482788086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02439260482788086  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 46, 128]), torch.Size([1, 46, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024436473846435547  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.026937007904052734  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 46, 128])
m.shape torch.Size([41, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027091026306152344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027091026306152344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.027130126953125  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.029632568359375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([589, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03281736373901367  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03281736373901367  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 294, 128]), torch.Size([1, 294, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.03309774398803711  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05300474166870117  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 294, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05300474166870117  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05300474166870117  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 295, 128]), torch.Size([1, 295, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.053286075592041016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0731205940246582  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 1 shape torch.Size([1, 295, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06946945190429688  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06967496871948242  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06988048553466797  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06966447830200195  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

torch.Size([1379, 40])
input nodes number: 6228
output nodes number: 1379
edges number: 8673
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06971549987792969  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.06971597671508789  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004439353942871094  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

pseudo mini batch 51 input nodes size: 6607
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004247188568115234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004247188568115234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007451534271240234  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.007462024688720703  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004481792449951172  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004561901092529297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004561901092529297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.004561901092529297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

m.shape torch.Size([95, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009851932525634766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.009851932525634766  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.00994253158569336  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01066732406616211  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([97, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010714530944824219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010714530944824219  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.010807037353515625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012194633483886719  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([68, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012245655059814453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012245655059814453  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.012310504913330078  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013737201690673828  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([57, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013813495635986328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013813495635986328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013867855072021484  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015444278717041016  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([58, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015555381774902344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015555381774902344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 58, 128]), torch.Size([1, 58, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015610694885253906  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017601966857910156  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 58, 128])
m.shape torch.Size([41, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017691612243652344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017691612243652344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017730712890625  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01941204071044922  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([39, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019522666931152344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019522666931152344  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 39, 128]), torch.Size([1, 39, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019559860229492188  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021419525146484375  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 39, 128])
m.shape torch.Size([22, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021484851837158203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.021484851837158203  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 22, 128]), torch.Size([1, 22, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02150583267211914  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022701740264892578  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 22, 128])
m.shape torch.Size([28, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022811412811279297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022811412811279297  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 28, 128]), torch.Size([1, 28, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.022838115692138672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.024547100067138672  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst.shape  torch.Size([1, 28, 128])
m.shape torch.Size([875, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028706073760986328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.028706073760986328  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 437, 128]), torch.Size([1, 437, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.02912282943725586  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05871248245239258  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

rst 0 shape torch.Size([1, 437, 128])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05871248245239258  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.05871248245239258  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.059130191802978516  GigaBytes
Max Memory Allocated: 0.07877349853515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08857917785644531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 438, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08388996124267578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08409595489501953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08430194854736328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08408546447753906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1380, 40])
input nodes number: 6607
output nodes number: 1380
edges number: 10708
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08414602279663086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08414649963378906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004707813262939453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 52 input nodes size: 6293
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004482269287109375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004482269287109375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007483005523681641  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007493495941162109  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004278659820556641  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004348278045654297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004348278045654297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004348278045654297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([185, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008978843688964844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008978843688964844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0091552734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01056671142578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([136, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010608196258544922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010608196258544922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010737895965576172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012683391571044922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([98, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012758731842041016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012758731842041016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012852191925048828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014908313751220703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([77, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01500844955444336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01500844955444336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01508188247680664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017211437225341797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([65, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017329692840576172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017329692840576172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017391681671142578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.019623279571533203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([47, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01972675323486328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01972675323486328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.019771575927734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021698951721191406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([39, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021806716918945312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021806716918945312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 39, 128]), torch.Size([1, 39, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021843910217285156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023703575134277344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 39, 128])
m.shape torch.Size([27, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023787975311279297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023787975311279297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 27, 128]), torch.Size([1, 27, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023813724517822266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025281429290771484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 27, 128])
m.shape torch.Size([31, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025401592254638672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025401592254638672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 31, 128]), torch.Size([1, 31, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025431156158447266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.027323246002197266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 31, 128])
m.shape torch.Size([682, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03056049346923828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03056049346923828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.030885696411132812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05397510528564453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 341, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05397510528564453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05397510528564453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05430030822753906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07722711563110352  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 341, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07327938079833984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.073486328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07369327545166016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07347583770751953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1387, 40])
input nodes number: 6293
output nodes number: 1387
edges number: 9254
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07353448867797852  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07353496551513672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004481792449951172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 53 input nodes size: 5705
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004279613494873047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004279613494873047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007483959197998047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007494449615478516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004483222961425781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004540443420410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004540443420410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004540443420410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([237, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008425235748291016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008425235748291016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 237, 128]), torch.Size([1, 237, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008651256561279297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010459423065185547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 237, 128])
m.shape torch.Size([212, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010548591613769531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010548591613769531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 212, 128]), torch.Size([1, 212, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010750770568847656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013783454895019531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 212, 128])
m.shape torch.Size([138, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013879776000976562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013879776000976562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014011383056640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01690673828125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([101, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01703357696533203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01703357696533203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017129898071289062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01992321014404297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([83, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02007293701171875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02007293701171875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02015209197998047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023001670837402344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([65, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023148059844970703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023148059844970703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02321004867553711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025875568389892578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([58, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.026038169860839844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.026038169860839844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 58, 128]), torch.Size([1, 58, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.026093482971191406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02885913848876953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 58, 128])
m.shape torch.Size([47, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.029010772705078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.029010772705078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02905559539794922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03161048889160156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([41, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03176403045654297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03176403045654297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.031803131103515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.034305572509765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([423, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.036303043365478516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.036303043365478516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.036504268646240234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.050791263580322266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 211, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.050791263580322266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.050791263580322266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 212, 128]), torch.Size([1, 212, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05099344253540039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0652475357055664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 212, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.06212806701660156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.06233787536621094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.06254768371582031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.06232738494873047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1405, 40])
input nodes number: 5705
output nodes number: 1405
edges number: 7665
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.06238365173339844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.06238412857055664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004659175872802734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 54 input nodes size: 6082
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004486083984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004486083984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007386207580566406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007397174835205078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004182338714599609  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004252910614013672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004252910614013672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004252910614013672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([158, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008918285369873047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008918285369873047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 158, 128]), torch.Size([1, 158, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009068965911865234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010274410247802734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 158, 128])
m.shape torch.Size([143, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010335445404052734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010335445404052734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010471820831298828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012517452239990234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([126, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012629508972167969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012629508972167969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 126, 128]), torch.Size([1, 126, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012749671936035156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015393257141113281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 126, 128])
m.shape torch.Size([90, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015504837036132812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015504837036132812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015590667724609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018079757690429688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([83, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018234729766845703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018234729766845703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018313884735107422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021163463592529297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([74, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021335601806640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021335601806640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021406173706054688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024440765380859375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([43, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024549007415771484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024549007415771484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 43, 128]), torch.Size([1, 43, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024590015411376953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02664041519165039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 43, 128])
m.shape torch.Size([46, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.026795387268066406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.026795387268066406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 46, 128]), torch.Size([1, 46, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.026839256286621094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02933979034423828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 46, 128])
m.shape torch.Size([31, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02945089340209961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02945089340209961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 31, 128]), torch.Size([1, 31, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.029480457305908203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0313725471496582  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 31, 128])
m.shape torch.Size([636, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.034562110900878906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.034562110900878906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 318, 128]), torch.Size([1, 318, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.034865379333496094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.056397438049316406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 318, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.056397438049316406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.056397438049316406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 318, 128]), torch.Size([1, 318, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.056700706481933594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07808113098144531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 318, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07411956787109375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07433271408081055  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07454586029052734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07432174682617188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1430, 40])
input nodes number: 6082
output nodes number: 1430
edges number: 9349
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07438182830810547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07438230514526367  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004389286041259766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 55 input nodes size: 7235
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004185676574707031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004185676574707031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007635593414306641  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0076465606689453125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004735469818115234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004809856414794922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004809856414794922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004809856414794922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([167, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00975942611694336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00975942611694336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009918689727783203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.011192798614501953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 167, 128])
m.shape torch.Size([126, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.011233329772949219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.011233329772949219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 126, 128]), torch.Size([1, 126, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.011353492736816406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013155937194824219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 126, 128])
m.shape torch.Size([90, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013224601745605469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013224601745605469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013310432434082031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015198707580566406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([93, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015333175659179688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015333175659179688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 93, 128]), torch.Size([1, 93, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015421867370605469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017993927001953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 93, 128])
m.shape torch.Size([87, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018157005310058594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018157005310058594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018239974975585938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021226882934570312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([59, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021354198455810547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021354198455810547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021410465240478516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023829936981201172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([57, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023992061614990234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023992061614990234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02404642105102539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.026764392852783203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([51, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0269317626953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0269317626953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02698040008544922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.029752731323242188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([57, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02997303009033203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02997303009033203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.030027389526367188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03350639343261719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([676, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.036702632904052734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.036702632904052734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03702497482299805  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.059911251068115234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 338, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.059911251068115234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.059911251068115234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.06023359298706055  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08295869827270508  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 338, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07872724533081055  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07894563674926758  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07916402816772461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0789346694946289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1463, 40])
input nodes number: 7235
output nodes number: 1463
edges number: 9930
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07900524139404297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07900571823120117  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004960536956787109  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 56 input nodes size: 6961
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004740715026855469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004740715026855469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008059978485107422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00807046890258789  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004609584808349609  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004679203033447266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004679203033447266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004679203033447266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([159, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00927734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00927734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 159, 128]), torch.Size([1, 159, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009428977966308594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010642051696777344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 159, 128])
m.shape torch.Size([127, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01068735122680664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01068735122680664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010808467864990234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01262521743774414  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([127, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012746334075927734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012746334075927734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012867450714111328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01553201675415039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([88, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015639305114746094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015639305114746094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 88, 128]), torch.Size([1, 88, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015723228454589844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018157005310058594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 88, 128])
m.shape torch.Size([57, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01825094223022461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01825094223022461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018305301666259766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02026224136352539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([61, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020409584045410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020409584045410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020467758178710938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02296924591064453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([50, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023107051849365234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023107051849365234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023154735565185547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025538921356201172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([37, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02565622329711914  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02565622329711914  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 37, 128]), torch.Size([1, 37, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025691509246826172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.027702808380126953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 37, 128])
m.shape torch.Size([26, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02779674530029297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02779674530029297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 26, 128]), torch.Size([1, 26, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02782154083251953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02940845489501953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 26, 128])
m.shape torch.Size([654, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03251457214355469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03251457214355469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03282642364501953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05496788024902344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 327, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05496788024902344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05496788024902344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05527973175048828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07726526260375977  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 327, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07334375381469727  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07355070114135742  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07375764846801758  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07354021072387695  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1386, 40])
input nodes number: 6961
output nodes number: 1386
edges number: 9217
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07359123229980469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07359170913696289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004805088043212891  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 57 input nodes size: 6267
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004598140716552734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004598140716552734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007586479187011719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0075969696044921875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004267215728759766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004336833953857422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004336833953857422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004336833953857422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([134, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00896596908569336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00896596908569336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 134, 128]), torch.Size([1, 134, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009093761444091797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010116100311279297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 134, 128])
m.shape torch.Size([139, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010184764862060547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010184764862060547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 139, 128]), torch.Size([1, 139, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010317325592041016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012305736541748047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 139, 128])
m.shape torch.Size([120, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012411117553710938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012411117553710938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012525558471679688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015043258666992188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([89, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015155792236328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015155792236328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015240669250488281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017702102661132812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([64, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017812252044677734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017812252044677734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017873287200927734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020070552825927734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([59, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02020883560180664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02020883560180664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02026510238647461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.022684574127197266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([44, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.022803306579589844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.022803306579589844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 44, 128]), torch.Size([1, 44, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02284526824951172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02494335174560547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 44, 128])
m.shape torch.Size([36, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02505970001220703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02505970001220703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025094032287597656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02705097198486328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([34, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.027179718017578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.027179718017578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 34, 128]), torch.Size([1, 34, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.027212142944335938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.029287338256835938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 34, 128])
m.shape torch.Size([660, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.032590389251708984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.032590389251708984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03290510177612305  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.055249691009521484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 330, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.055249691009521484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.055249691009521484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05556440353393555  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07775163650512695  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 330, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07378244400024414  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07398796081542969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07419347763061523  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07397747039794922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1379, 40])
input nodes number: 6267
output nodes number: 1379
edges number: 9304
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07403326034545898  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07403373718261719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004467487335205078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 58 input nodes size: 6580
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004265785217285156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004265785217285156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007585048675537109  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007595539093017578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004596710205078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004666328430175781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004666328430175781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004666328430175781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([161, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009319782257080078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009319782257080078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 161, 128]), torch.Size([1, 161, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009473323822021484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010701656341552734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 161, 128])
m.shape torch.Size([157, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010774612426757812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010774612426757812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 157, 128]), torch.Size([1, 157, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010924339294433594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013170242309570312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 157, 128])
m.shape torch.Size([93, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013228416442871094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013228416442871094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 93, 128]), torch.Size([1, 93, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013317108154296875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015268325805664062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 93, 128])
m.shape torch.Size([65, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015347957611083984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015347957611083984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01540994644165039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017207622528076172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([81, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017369747161865234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017369747161865234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01744699478149414  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020227909088134766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([51, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02033519744873047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02033519744873047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020383834838867188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.022475242614746094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([48, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.022611141204833984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.022611141204833984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.022656917572021484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024945735931396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([42, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025083065032958984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025083065032958984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 42, 128]), torch.Size([1, 42, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025123119354248047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02740621566772461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 42, 128])
m.shape torch.Size([31, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02751922607421875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02751922607421875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 31, 128]), torch.Size([1, 31, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.027548789978027344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.029440879821777344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 31, 128])
m.shape torch.Size([665, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03259706497192383  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03259706497192383  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 332, 128]), torch.Size([1, 332, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0329136848449707  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05539369583129883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 332, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05539369583129883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05539369583129883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 333, 128]), torch.Size([1, 333, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05571126937866211  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07810068130493164  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 333, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07412576675415039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07433366775512695  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07454156875610352  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07432317733764648  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1394, 40])
input nodes number: 6580
output nodes number: 1394
edges number: 9326
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07438516616821289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0743856430053711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004803180694580078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 59 input nodes size: 6262
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004599094390869141  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004599094390869141  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007585048675537109  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007596015930175781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004266262054443359  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004337787628173828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004337787628173828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004337787628173828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([171, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00908660888671875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00908660888671875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009249687194824219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010554313659667969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([132, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01059865951538086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01059865951538086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 132, 128]), torch.Size([1, 132, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010724544525146484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01261281967163086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 132, 128])
m.shape torch.Size([96, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012687206268310547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012687206268310547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012778759002685547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014792919158935547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([76, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014892101287841797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014892101287841797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014964580535888672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017066478729248047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([92, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017249584197998047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017249584197998047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017337322235107422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020495891571044922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([68, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02064657211303711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02064657211303711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020711421966552734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02349996566772461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([57, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023657798767089844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023657798767089844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023712158203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.026430130004882812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([37, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02654409408569336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02654409408569336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 37, 128]), torch.Size([1, 37, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02657938003540039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.028590679168701172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 37, 128])
m.shape torch.Size([54, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.028804779052734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.028804779052734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.028856277465820312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03215217590332031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([643, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0354456901550293  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0354456901550293  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0357518196105957  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05748701095581055  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 321, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05748701095581055  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05748701095581055  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05779409408569336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07944393157958984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 322, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07540225982666016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07561492919921875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07582759857177734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07560396194458008  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1426, 40])
input nodes number: 6262
output nodes number: 1426
edges number: 9506
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07566642761230469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07566690444946289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004477500915527344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 60 input nodes size: 7211
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004271030426025391  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004271030426025391  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007709503173828125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007719993591308594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004723072052001953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004798412322998047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004798412322998047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004798412322998047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([138, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009897232055664062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010950088500976562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([116, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010994911193847656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010994911193847656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.011105537414550781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012764930725097656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([92, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012841224670410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012841224670410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012928962707519531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014859199523925781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([62, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014933586120605469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014933586120605469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014992713928222656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016707420349121094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([56, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016811370849609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016811370849609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 56, 128]), torch.Size([1, 56, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016864776611328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018787384033203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 56, 128])
m.shape torch.Size([44, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018886566162109375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018886566162109375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 44, 128]), torch.Size([1, 44, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01892852783203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020732879638671875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 44, 128])
m.shape torch.Size([41, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020848751068115234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020848751068115234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02088785171508789  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.022842884063720703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([34, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.022953033447265625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.022953033447265625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 34, 128]), torch.Size([1, 34, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.022985458374023438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02483367919921875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 34, 128])
m.shape torch.Size([37, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024976253509521484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024976253509521484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 37, 128]), torch.Size([1, 37, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025011539459228516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.027269840240478516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 37, 128])
m.shape torch.Size([767, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03090953826904297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03090953826904297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 383, 128]), torch.Size([1, 383, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03127479553222656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05720806121826172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 383, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05720806121826172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05720806121826172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 384, 128]), torch.Size([1, 384, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05757427215576172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08339262008666992  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 384, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.079071044921875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07927799224853516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07948493957519531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07926750183105469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1387, 40])
input nodes number: 7211
output nodes number: 1387
edges number: 10000
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07932615280151367  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07932662963867188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004937648773193359  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 61 input nodes size: 6560
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004717350006103516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004717350006103516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007845401763916016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007855892181396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004406929016113281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004474639892578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004474639892578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004474639892578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([183, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008968830108642578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008968830108642578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 183, 128]), torch.Size([1, 183, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009143352508544922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010539531707763672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 183, 128])
m.shape torch.Size([148, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010593414306640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010593414306640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 148, 128]), torch.Size([1, 148, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01073455810546875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012851715087890625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 148, 128])
m.shape torch.Size([128, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012964248657226562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012964248657226562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013086318969726562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015771865844726562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([83, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015869140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.015869140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01594829559326172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018243789672851562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([80, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018394947052001953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018394947052001953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018471240997314453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021217823028564453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([47, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021314144134521484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021314144134521484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021358966827392578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02328634262084961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([54, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023444175720214844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023444175720214844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02349567413330078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.026070594787597656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([30, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.026159286499023438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.026159286499023438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 30, 128]), torch.Size([1, 30, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.026187896728515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.027818679809570312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 30, 128])
m.shape torch.Size([48, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02801036834716797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02801036834716797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02805614471435547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03098583221435547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([605, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.033847808837890625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.033847808837890625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 302, 128]), torch.Size([1, 302, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03413581848144531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.054584503173828125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 302, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.054584503173828125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.054584503173828125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 303, 128]), torch.Size([1, 303, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05487346649169922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07524585723876953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 303, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07145881652832031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07166862487792969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07187843322753906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07165813446044922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1406, 40])
input nodes number: 6560
output nodes number: 1406
edges number: 8977
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07172060012817383  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07172107696533203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0046100616455078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 62 input nodes size: 6173
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0044097900390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0044097900390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007353305816650391  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007363796234130859  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004225254058837891  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004296779632568359  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004296779632568359  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004296779632568359  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([152, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009068012237548828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009068012237548828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 152, 128]), torch.Size([1, 152, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009212970733642578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010372638702392578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 152, 128])
m.shape torch.Size([113, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01040792465209961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01040792465209961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010515689849853516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01213216781616211  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([102, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012224197387695312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012224197387695312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 102, 128]), torch.Size([1, 102, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01232147216796875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014461517333984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 102, 128])
m.shape torch.Size([82, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014569282531738281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014569282531738281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014647483825683594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016915321350097656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([62, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01702404022216797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01702404022216797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017083168029785156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.019211769104003906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([54, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.019336700439453125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.019336700439453125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.019388198852539062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021602630615234375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([41, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021713733673095703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021713733673095703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02175283432006836  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023707866668701172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([25, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02378368377685547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02378368377685547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 25, 128]), torch.Size([1, 25, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023807525634765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02516651153564453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 25, 128])
m.shape torch.Size([32, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025291919708251953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025291919708251953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 32, 128]), torch.Size([1, 32, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025322437286376953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.027275562286376953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 32, 128])
m.shape torch.Size([716, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.030674457550048828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.030674457550048828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.031015872955322266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05525636672973633  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 358, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05525636672973633  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.05525636672973633  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.055597782135009766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07966756820678711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 358, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07555341720581055  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0757589340209961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07596445083618164  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07574844360351562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1379, 40])
input nodes number: 6173
output nodes number: 1379
edges number: 9581
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07580089569091797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.07580137252807617  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004426002502441406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 63 input nodes size: 6923
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0042209625244140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0042209625244140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007522106170654297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007533073425292969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004579067230224609  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004659175872802734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004659175872802734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.004659175872802734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([141, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009957313537597656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009957313537597656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010091781616210938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.011167526245117188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([108, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.011203289031982422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.011203289031982422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.011306285858154297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012851238250732422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([83, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012918472290039062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012918472290039062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012997627258300781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014739036560058594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([59, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014811992645263672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014811992645263672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01486825942993164  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016499996185302734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([63, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016622066497802734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016622066497802734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016682147979736328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018845081329345703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([61, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01898956298828125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01898956298828125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01904773712158203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021549224853515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([57, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02171039581298828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02171039581298828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021764755249023438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02448272705078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([53, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024657726287841797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024657726287841797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024708271026611328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02758932113647461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([52, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.027787208557128906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.027787208557128906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02783679962158203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03101062774658203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([786, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03473377227783203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03473377227783203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 393, 128]), torch.Size([1, 393, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.03510856628417969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.06171894073486328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 393, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.06171894073486328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.06171894073486328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 393, 128]), torch.Size([1, 393, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.06209373474121094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0885167121887207  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 393, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08390378952026367  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0841221809387207  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08434057235717773  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08411121368408203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes
[03:22:45] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14292522 edges into 64 parts and get 4140943 edge cuts

torch.Size([1463, 40])
input nodes number: 6923
output nodes number: 1463
edges number: 10674
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08418703079223633  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08418750762939453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004820823669433594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005881309509277344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005881309509277344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0039993636310100555 |0.005860131233930588 |0.044731173664331436 |8.502975106239319e-05 |0.019384711980819702 |0.002713441848754883 |
----------------------------------------------------------pseudo_mini_loss sum 3.8379831314086914
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  266771
Number of first layer input nodes during this epoch:  266771
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005880832672119141  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01858997344970703
global_2_local spend time (sec) 0.037811994552612305
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0035364627838134766
A = g.adjacency_matrix() spent  0.005360126495361328
auxiliary_graph
Graph(num_nodes=145011, num_edges=14383463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07886838912963867
remove nodes length
54070
auxiliary_graph.remove_nodes spent  0.6472151279449463
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14383463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6009259223937988

the counter of shared neighbor distribution
Counter({1.0: 12899386, 2.0: 1178670, 3.0: 168286, 4.0: 33534, 5.0: 8856, 6.0: 2754, 7.0: 796, 8.0: 198, 9.0: 40, 10.0: 2})
14292522
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14292519, 14292520, 14292521])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12899386, 2.0: 1178670, 3.0: 168286, 4.0: 33534, 5.0: 8856, 6.0: 2754, 7.0: 796, 8.0: 198, 9.0: 40, 10.0: 2})
Convert a graph into a bidirected graph: 0.585 seconds
Metis partitioning: 2.995 seconds
Split the graph: 0.299 seconds
Construct subgraphs: 0.062 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  3.948975086212158
1379
1450
1400
1442
1450
1429
1420
1447
1435
1430
1450
1425
1433
1422
1444
1437
1379
1463
1393
1462
1462
1435
1451
1425
1444
1451
1462
1415
1441
1404
1429
1414
1463
1381
1379
1381
1379
1384
1379
1380
1463
1379
1388
1422
1379
1410
1422
1395
1407
1436
1422
1379
1457
1420
1408
1421
1431
1430
1460
1390
1406
1414
1425
1428
total k batches seeds list generation spend  8.931506156921387
after graph partition
graph partition algorithm spend time 9.008888959884644
1379
1450
1400
1442
1450
1429
1420
1447
1435
1430
1450
1425
1433
1422
1444
1437
1379
1463
1393
1462
1462
1435
1451
1425
1444
1451
1462
1415
1441
1404
1429
1414
1463
1381
1379
1381
1379
1384
1379
1380
1463
1379
1388
1422
1379
1410
1422
1395
1407
1436
1422
1379
1457
1420
1408
1421
1431
1430
1460
1390
1406
1414
1425
1428
partition_len_list
[3897, 3408, 4251, 3859, 3075, 3735, 3798, 2882, 2606, 2641, 2681, 2523, 2917, 3464, 2813, 3187, 4073, 3756, 3469, 4354, 3404, 3084, 3562, 3236, 2773, 2713, 3336, 2666, 3508, 3163, 3342, 3129, 7004, 6505, 6400, 6921, 6521, 6504, 6356, 7028, 7265, 6513, 6182, 6135, 5986, 6784, 5251, 6185, 3870, 3884, 5709, 4735, 3696, 3905, 4560, 4000, 3436, 3171, 3423, 2703, 2925, 4561, 2339, 2739]
shared_neighbor_graph_partition_s0 selection method  spend 9.099409341812134
time for parepare:  0.017334938049316406
local_output_nid generation:  0.0003857612609863281
local_in_edges_tensor generation:  0.0005815029144287109
mini_batch_src_global generation:  0.0004565715789794922
r_  generation:  0.002298116683959961
local_output_nid generation:  0.0004031658172607422
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.000476837158203125
r_  generation:  0.002729177474975586
local_output_nid generation:  0.00038123130798339844
local_in_edges_tensor generation:  0.00042319297790527344
mini_batch_src_global generation:  0.00035834312438964844
r_  generation:  0.002542734146118164
local_output_nid generation:  0.0004019737243652344
local_in_edges_tensor generation:  0.0004119873046875
mini_batch_src_global generation:  0.0003554821014404297
r_  generation:  0.002672433853149414
local_output_nid generation:  0.0003948211669921875
local_in_edges_tensor generation:  0.0004222393035888672
mini_batch_src_global generation:  0.0003554821014404297
r_  generation:  0.0028150081634521484
local_output_nid generation:  0.00039839744567871094
local_in_edges_tensor generation:  0.0003998279571533203
mini_batch_src_global generation:  0.00033926963806152344
r_  generation:  0.0024802684783935547
local_output_nid generation:  0.0003943443298339844
local_in_edges_tensor generation:  0.00039196014404296875
mini_batch_src_global generation:  0.00033211708068847656
r_  generation:  0.0024836063385009766
local_output_nid generation:  0.0003993511199951172
local_in_edges_tensor generation:  0.0003921985626220703
mini_batch_src_global generation:  0.0002739429473876953
r_  generation:  0.002104520797729492
local_output_nid generation:  0.00039505958557128906
local_in_edges_tensor generation:  0.00038909912109375
mini_batch_src_global generation:  0.0002677440643310547
r_  generation:  0.0021224021911621094
local_output_nid generation:  0.0003848075866699219
local_in_edges_tensor generation:  0.0003867149353027344
mini_batch_src_global generation:  0.0002598762512207031
r_  generation:  0.002142190933227539
local_output_nid generation:  0.0004000663757324219
local_in_edges_tensor generation:  0.0004029273986816406
mini_batch_src_global generation:  0.0002951622009277344
r_  generation:  0.002533435821533203
local_output_nid generation:  0.00042128562927246094
local_in_edges_tensor generation:  0.00038504600524902344
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.002178668975830078
local_output_nid generation:  0.00042819976806640625
local_in_edges_tensor generation:  0.0003886222839355469
mini_batch_src_global generation:  0.0003027915954589844
r_  generation:  0.0025734901428222656
local_output_nid generation:  0.0004112720489501953
local_in_edges_tensor generation:  0.0003705024719238281
mini_batch_src_global generation:  0.0002803802490234375
r_  generation:  0.0022079944610595703
local_output_nid generation:  0.00040984153747558594
local_in_edges_tensor generation:  0.00038909912109375
mini_batch_src_global generation:  0.00028824806213378906
r_  generation:  0.002462148666381836
local_output_nid generation:  0.0004215240478515625
local_in_edges_tensor generation:  0.00037789344787597656
mini_batch_src_global generation:  0.0002872943878173828
r_  generation:  0.0025453567504882812
local_output_nid generation:  0.00038242340087890625
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.00031638145446777344
r_  generation:  0.002341747283935547
local_output_nid generation:  0.0004131793975830078
local_in_edges_tensor generation:  0.00038623809814453125
mini_batch_src_global generation:  0.0003485679626464844
r_  generation:  0.0029039382934570312
local_output_nid generation:  0.0003955364227294922
local_in_edges_tensor generation:  0.0004029273986816406
mini_batch_src_global generation:  0.00031185150146484375
r_  generation:  0.0023767948150634766
local_output_nid generation:  0.0004265308380126953
local_in_edges_tensor generation:  0.0003821849822998047
mini_batch_src_global generation:  0.00031948089599609375
r_  generation:  0.002693653106689453
local_output_nid generation:  0.0004124641418457031
local_in_edges_tensor generation:  0.0003781318664550781
mini_batch_src_global generation:  0.0003173351287841797
r_  generation:  0.002711772918701172
local_output_nid generation:  0.0003924369812011719
local_in_edges_tensor generation:  0.0003714561462402344
mini_batch_src_global generation:  0.0002722740173339844
r_  generation:  0.002491474151611328
local_output_nid generation:  0.0004210472106933594
local_in_edges_tensor generation:  0.00036978721618652344
mini_batch_src_global generation:  0.0002944469451904297
r_  generation:  0.0026619434356689453
local_output_nid generation:  0.0004024505615234375
local_in_edges_tensor generation:  0.00036525726318359375
mini_batch_src_global generation:  0.0002701282501220703
r_  generation:  0.002167940139770508
local_output_nid generation:  0.0004074573516845703
local_in_edges_tensor generation:  0.0003795623779296875
mini_batch_src_global generation:  0.0003273487091064453
r_  generation:  0.002827882766723633
local_output_nid generation:  0.0004055500030517578
local_in_edges_tensor generation:  0.00037860870361328125
mini_batch_src_global generation:  0.0002796649932861328
r_  generation:  0.002389669418334961
local_output_nid generation:  0.00041174888610839844
local_in_edges_tensor generation:  0.00038909912109375
mini_batch_src_global generation:  0.0003306865692138672
r_  generation:  0.003121614456176758
local_output_nid generation:  0.0004432201385498047
local_in_edges_tensor generation:  0.0003886222839355469
mini_batch_src_global generation:  0.0003383159637451172
r_  generation:  0.002588033676147461
local_output_nid generation:  0.0004200935363769531
local_in_edges_tensor generation:  0.0003724098205566406
mini_batch_src_global generation:  0.0002994537353515625
r_  generation:  0.002767324447631836
local_output_nid generation:  0.0004150867462158203
local_in_edges_tensor generation:  0.00036978721618652344
mini_batch_src_global generation:  0.00030350685119628906
r_  generation:  0.002696514129638672
local_output_nid generation:  0.00041222572326660156
local_in_edges_tensor generation:  0.0003757476806640625
mini_batch_src_global generation:  0.00031638145446777344
r_  generation:  0.002837657928466797
local_output_nid generation:  0.0004189014434814453
local_in_edges_tensor generation:  0.0003917217254638672
mini_batch_src_global generation:  0.00031638145446777344
r_  generation:  0.002883434295654297
local_output_nid generation:  0.0004363059997558594
local_in_edges_tensor generation:  0.00040149688720703125
mini_batch_src_global generation:  0.00044918060302734375
r_  generation:  0.003195524215698242
local_output_nid generation:  0.00041413307189941406
local_in_edges_tensor generation:  0.0004646778106689453
mini_batch_src_global generation:  0.0004048347473144531
r_  generation:  0.0029153823852539062
local_output_nid generation:  0.0004305839538574219
local_in_edges_tensor generation:  0.0003895759582519531
mini_batch_src_global generation:  0.0003757476806640625
r_  generation:  0.003138303756713867
local_output_nid generation:  0.00041937828063964844
local_in_edges_tensor generation:  0.0004417896270751953
mini_batch_src_global generation:  0.0003867149353027344
r_  generation:  0.0030112266540527344
local_output_nid generation:  0.0004317760467529297
local_in_edges_tensor generation:  0.00039839744567871094
mini_batch_src_global generation:  0.0003666877746582031
r_  generation:  0.003034830093383789
local_output_nid generation:  0.0004127025604248047
local_in_edges_tensor generation:  0.0003714561462402344
mini_batch_src_global generation:  0.00038743019104003906
r_  generation:  0.0027992725372314453
local_output_nid generation:  0.00042510032653808594
local_in_edges_tensor generation:  0.0003724098205566406
mini_batch_src_global generation:  0.0003323554992675781
r_  generation:  0.0026624202728271484
local_output_nid generation:  0.0004189014434814453
local_in_edges_tensor generation:  0.0003993511199951172
mini_batch_src_global generation:  0.00034689903259277344
r_  generation:  0.0027589797973632812
local_output_nid generation:  0.00043845176696777344
local_in_edges_tensor generation:  0.0003905296325683594
mini_batch_src_global generation:  0.00037169456481933594
r_  generation:  0.0033063888549804688
local_output_nid generation:  0.0004336833953857422
local_in_edges_tensor generation:  0.0003719329833984375
mini_batch_src_global generation:  0.0003631114959716797
r_  generation:  0.002643585205078125
local_output_nid generation:  0.00044345855712890625
local_in_edges_tensor generation:  0.00037407875061035156
mini_batch_src_global generation:  0.0003218650817871094
r_  generation:  0.002669095993041992
local_output_nid generation:  0.0004444122314453125
local_in_edges_tensor generation:  0.00037860870361328125
mini_batch_src_global generation:  0.00034427642822265625
r_  generation:  0.002826690673828125
local_output_nid generation:  0.0004279613494873047
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.0003235340118408203
r_  generation:  0.002409696578979492
local_output_nid generation:  0.00042891502380371094
local_in_edges_tensor generation:  0.0004456043243408203
mini_batch_src_global generation:  0.00036787986755371094
r_  generation:  0.003350973129272461
local_output_nid generation:  0.0004394054412841797
local_in_edges_tensor generation:  0.0003986358642578125
mini_batch_src_global generation:  0.0003228187561035156
r_  generation:  0.0024499893188476562
local_output_nid generation:  0.00043582916259765625
local_in_edges_tensor generation:  0.0004303455352783203
mini_batch_src_global generation:  0.00032806396484375
r_  generation:  0.002732992172241211
local_output_nid generation:  0.0004467964172363281
local_in_edges_tensor generation:  0.00039076805114746094
mini_batch_src_global generation:  0.0002720355987548828
r_  generation:  0.0020170211791992188
local_output_nid generation:  0.0004432201385498047
local_in_edges_tensor generation:  0.00036525726318359375
mini_batch_src_global generation:  0.00029015541076660156
r_  generation:  0.0021915435791015625
local_output_nid generation:  0.00043010711669921875
local_in_edges_tensor generation:  0.0003693103790283203
mini_batch_src_global generation:  0.0003390312194824219
r_  generation:  0.0026280879974365234
local_output_nid generation:  0.0004405975341796875
local_in_edges_tensor generation:  0.000377655029296875
mini_batch_src_global generation:  0.0003082752227783203
r_  generation:  0.002333402633666992
local_output_nid generation:  0.00043892860412597656
local_in_edges_tensor generation:  0.00036907196044921875
mini_batch_src_global generation:  0.00028395652770996094
r_  generation:  0.002377748489379883
local_output_nid generation:  0.00042557716369628906
local_in_edges_tensor generation:  0.000385284423828125
mini_batch_src_global generation:  0.00027680397033691406
r_  generation:  0.002385377883911133
local_output_nid generation:  0.00041484832763671875
local_in_edges_tensor generation:  0.00036334991455078125
mini_batch_src_global generation:  0.0002856254577636719
r_  generation:  0.0022749900817871094
local_output_nid generation:  0.0004146099090576172
local_in_edges_tensor generation:  0.0003724098205566406
mini_batch_src_global generation:  0.00027823448181152344
r_  generation:  0.0025451183319091797
local_output_nid generation:  0.00046825408935546875
local_in_edges_tensor generation:  0.00040078163146972656
mini_batch_src_global generation:  0.00029921531677246094
r_  generation:  0.0023293495178222656
local_output_nid generation:  0.00045371055603027344
local_in_edges_tensor generation:  0.0003705024719238281
mini_batch_src_global generation:  0.0002608299255371094
r_  generation:  0.0022928714752197266
local_output_nid generation:  0.00048160552978515625
local_in_edges_tensor generation:  0.00037550926208496094
mini_batch_src_global generation:  0.00028967857360839844
r_  generation:  0.0026345252990722656
local_output_nid generation:  0.0004451274871826172
local_in_edges_tensor generation:  0.0003712177276611328
mini_batch_src_global generation:  0.00024819374084472656
r_  generation:  0.002115011215209961
local_output_nid generation:  0.0004544258117675781
local_in_edges_tensor generation:  0.00038433074951171875
mini_batch_src_global generation:  0.00025010108947753906
r_  generation:  0.002163410186767578
local_output_nid generation:  0.0004532337188720703
local_in_edges_tensor generation:  0.0003731250762939453
mini_batch_src_global generation:  0.0003180503845214844
r_  generation:  0.0027289390563964844
local_output_nid generation:  0.00046372413635253906
local_in_edges_tensor generation:  0.0003838539123535156
mini_batch_src_global generation:  0.00030303001403808594
r_  generation:  0.002429962158203125
local_output_nid generation:  0.0004494190216064453
local_in_edges_tensor generation:  0.0003807544708251953
mini_batch_src_global generation:  0.00026679039001464844
r_  generation:  0.0020503997802734375
----------------------check_connections_block total spend ----------------------------- 0.31198620796203613
generate_one_block  0.010710477828979492
generate_one_block  0.0063555240631103516
generate_one_block  0.006182193756103516
generate_one_block  0.0052111148834228516
generate_one_block  0.004944324493408203
generate_one_block  0.004716634750366211
generate_one_block  0.004767417907714844
generate_one_block  0.003772735595703125
generate_one_block  0.0035233497619628906
generate_one_block  0.0035839080810546875
generate_one_block  0.0038547515869140625
generate_one_block  0.008220911026000977
generate_one_block  0.004292726516723633
generate_one_block  0.0038623809814453125
generate_one_block  0.004040718078613281
generate_one_block  0.0043184757232666016
generate_one_block  0.004286050796508789
generate_one_block  0.0050127506256103516
generate_one_block  0.004251003265380859
generate_one_block  0.004910945892333984
generate_one_block  0.004534482955932617
generate_one_block  0.004087209701538086
generate_one_block  0.004494667053222656
generate_one_block  0.0036497116088867188
generate_one_block  0.004546642303466797
generate_one_block  0.004027843475341797
generate_one_block  0.004866838455200195
generate_one_block  0.004182100296020508
generate_one_block  0.004336833953857422
generate_one_block  0.004378557205200195
generate_one_block  0.004621267318725586
generate_one_block  0.00433802604675293
generate_one_block  0.006490945816040039
generate_one_block  0.005206108093261719
generate_one_block  0.005559444427490234
generate_one_block  0.005580425262451172
generate_one_block  0.005303859710693359
generate_one_block  0.0050203800201416016
generate_one_block  0.005199909210205078
generate_one_block  0.0051801204681396484
generate_one_block  0.0056400299072265625
generate_one_block  0.00479435920715332
generate_one_block  0.004979848861694336
generate_one_block  0.005079984664916992
generate_one_block  0.004602193832397461
generate_one_block  0.0060062408447265625
generate_one_block  0.00430750846862793
generate_one_block  0.005105733871459961
generate_one_block  0.003874540328979492
generate_one_block  0.00394129753112793
generate_one_block  0.0050923824310302734
generate_one_block  0.004682779312133789
generate_one_block  0.0042972564697265625
generate_one_block  0.0042684078216552734
generate_one_block  0.004195690155029297
generate_one_block  0.004248857498168945
generate_one_block  0.003840208053588867
generate_one_block  0.0036733150482177734
generate_one_block  0.004211902618408203
generate_one_block  0.0035042762756347656
generate_one_block  0.003679037094116211
generate_one_block  0.004769086837768555
generate_one_block  0.003914594650268555
generate_one_block  0.0034637451171875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005880832672119141  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

connection checking time:  0.31198620796203613
block generation total time  0.3025970458984375
average batch blocks generation time:  0.004728078842163086
block dataloader generation time/epoch 9.803345918655396
pseudo mini batch 0 input nodes size: 3897
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0056514739990234375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0056514739990234375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007509708404541016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007520198822021484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004208087921142578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004260540008544922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004260540008544922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004260540008544922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([243, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007838726043701172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007838726043701172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00807046890258789  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00992441177368164  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([197, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009996414184570312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009996414184570312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010184288024902344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013002395629882812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([173, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013155937194824219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013155937194824219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0133209228515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016950607299804688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 173, 128])
m.shape torch.Size([104, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017066478729248047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017066478729248047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017165660858154297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020041942596435547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 104, 128])
m.shape torch.Size([108, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02024984359741211  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02024984359741211  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020352840423583984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024060726165771484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([72, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024215221405029297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024215221405029297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024283885955810547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027236461639404297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([65, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027419090270996094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027419090270996094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0274810791015625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030580520629882812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([51, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030744075775146484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030744075775146484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030792713165283203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03356504440307617  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([40, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03371238708496094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03371238708496094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 40, 128]), torch.Size([1, 40, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03375053405761719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03619194030761719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 40, 128])
m.shape torch.Size([326, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03772735595703125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03772735595703125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 163, 128]), torch.Size([1, 163, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03788280487060547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.048919677734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 163, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.048919677734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.048919677734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 163, 128]), torch.Size([1, 163, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04907512664794922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06003427505493164  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 163, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.057230472564697266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05743598937988281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05764150619506836  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.057425498962402344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1379, 40])
input nodes number: 3897
output nodes number: 1379
edges number: 7027
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05745220184326172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.057453155517578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004345893859863281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 1 input nodes size: 3408
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0041961669921875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0041961669921875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00582122802734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005832195281982422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003963470458984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004027366638183594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004027366638183594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004027366638183594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([156, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008297920227050781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008297920227050781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008446693420410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009636878967285156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 156, 128])
m.shape torch.Size([168, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009722709655761719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009722709655761719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 168, 128]), torch.Size([1, 168, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009882926940917969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012286186218261719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 168, 128])
m.shape torch.Size([162, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012437820434570312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012437820434570312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 162, 128]), torch.Size([1, 162, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012592315673828125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0159912109375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 162, 128])
m.shape torch.Size([149, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016198158264160156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016198158264160156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 149, 128]), torch.Size([1, 149, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016340255737304688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020461082458496094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 149, 128])
m.shape torch.Size([97, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020621299743652344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020621299743652344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02071380615234375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024044036865234375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([74, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02420949935913086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02420949935913086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024280071258544922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02731466293334961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([76, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02753305435180664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02753305435180664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027605533599853516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031229496002197266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([66, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03144502639770508  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03144502639770508  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03150796890258789  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0350956916809082  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03528308868408203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03528308868408203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03533172607421875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03844451904296875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([451, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.040570735931396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.040570735931396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 225, 128]), torch.Size([1, 225, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04078531265258789  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056020259857177734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 225, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056020259857177734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056020259857177734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 226, 128]), torch.Size([1, 226, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05623579025268555  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07143115997314453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 226, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06791019439697266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06812667846679688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0683431625366211  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0681157112121582  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1450, 40])
input nodes number: 3408
output nodes number: 1450
edges number: 8532
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06816339492797852  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06816387176513672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0041446685791015625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 2 input nodes size: 4251
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003974437713623047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003974437713623047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006001472473144531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006011962890625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004375934600830078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004438877105712891  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004438877105712891  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004438877105712891  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([167, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008623123168945312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008623123168945312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008782386779785156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010056495666503906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 167, 128])
m.shape torch.Size([168, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010137081146240234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010137081146240234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 168, 128]), torch.Size([1, 168, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010297298431396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012700557708740234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 168, 128])
m.shape torch.Size([140, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012820720672607422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012820720672607422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 140, 128]), torch.Size([1, 140, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012954235076904297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015891551971435547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 140, 128])
m.shape torch.Size([106, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016026973724365234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016026973724365234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016128063201904297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01905965805053711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 106, 128])
m.shape torch.Size([99, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019245147705078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019245147705078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019339561462402344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02273845672607422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 99, 128])
m.shape torch.Size([74, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022902965545654297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022902965545654297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02297353744506836  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026008129119873047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([73, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026216506958007812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026216506958007812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02628612518310547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02976703643798828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([65, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029980182647705078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029980182647705078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030042171478271484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03357553482055664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([48, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03375053405761719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03375053405761719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03379631042480469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03672599792480469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([460, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03889656066894531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03889656066894531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03911590576171875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05468940734863281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 230, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05468940734863281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05468940734863281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05490875244140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0703725814819336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 230, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06691503524780273  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0671238899230957  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06733274459838867  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06711339950561523  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1400, 40])
input nodes number: 4251
output nodes number: 1400
edges number: 8349
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06714820861816406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06714868545532227  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004541873931884766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 3 input nodes size: 3859
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004368305206298828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004368305206298828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0062084197998046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006219387054443359  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004181861877441406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004246711730957031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004246711730957031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004246711730957031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([197, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008558273315429688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008558273315429688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008746147155761719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010249137878417969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([163, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010310649871826172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010310649871826172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 163, 128]), torch.Size([1, 163, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01046609878540039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012797832489013672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 163, 128])
m.shape torch.Size([127, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012901782989501953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012901782989501953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013022899627685547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01568746566772461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([113, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015842437744140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015842437744140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01595020294189453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019075393676757812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([97, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019252777099609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019252777099609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01934528350830078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022675514221191406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([80, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022858142852783203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022858142852783203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022934436798095703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026215076446533203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([70, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026410579681396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026410579681396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026477336883544922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029815196990966797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([59, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030006885528564453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030006885528564453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030063152313232422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03327035903930664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([62, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03350830078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03350830078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03356742858886719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03735160827636719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([474, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.039582252502441406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.039582252502441406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 237, 128]), torch.Size([1, 237, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03980827331542969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.055855751037597656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 237, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.055855751037597656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.055855751037597656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 237, 128]), torch.Size([1, 237, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05608177185058594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07201623916625977  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 237, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0684657096862793  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0686807632446289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06889581680297852  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06866979598999023  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1442, 40])
input nodes number: 3859
output nodes number: 1442
edges number: 8581
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06871604919433594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06871652603149414  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004363536834716797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 4 input nodes size: 3075
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004188060760498047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004188060760498047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005654335021972656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005665302276611328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003814220428466797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038819313049316406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038819313049316406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038819313049316406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([169, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008388996124267578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008388996124267578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 169, 128]), torch.Size([1, 169, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008550167083740234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009839534759521484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 169, 128])
m.shape torch.Size([156, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009907722473144531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009907722473144531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010056495666503906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012288093566894531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 156, 128])
m.shape torch.Size([127, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012395381927490234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012395381927490234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012516498565673828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01518106460571289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([110, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015330314636230469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015330314636230469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015435218811035156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018477439880371094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([96, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01865386962890625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01865386962890625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01874542236328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02204132080078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([75, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022210121154785156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022210121154785156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022281646728515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02535724639892578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([63, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025531768798828125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025531768798828125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02559185028076172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028595924377441406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([75, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028851985931396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028851985931396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028923511505126953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03300046920776367  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03318357467651367  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03318357467651367  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03323221206665039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03634500503540039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([528, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03883838653564453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03883838653564453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03909015655517578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05696582794189453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 264, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05696582794189453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05696582794189453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05721759796142578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0749673843383789  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 264, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07120180130004883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07141828536987305  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07163476943969727  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07140731811523438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1450, 40])
input nodes number: 3075
output nodes number: 1450
edges number: 9012
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07144308090209961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07144355773925781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003991127014160156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 5 input nodes size: 3735
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038156509399414062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038156509399414062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005655765533447266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0056667327880859375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004189491271972656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004248619079589844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004248619079589844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004248619079589844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([243, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00821828842163086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00821828842163086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008450031280517578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010303974151611328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([187, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010366439819335938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010366439819335938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 187, 128]), torch.Size([1, 187, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010544776916503906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013219833374023438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 187, 128])
m.shape torch.Size([127, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013312339782714844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013312339782714844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013433456420898438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0160980224609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([119, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01626443862915039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01626443862915039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016377925872802734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019669055938720703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([85, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01981496810913086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01981496810913086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01989603042602539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022814273834228516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 85, 128])
m.shape torch.Size([97, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02305126190185547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02305126190185547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023143768310546875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027121543884277344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([66, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027295589447021484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027295589447021484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027358531951904297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030505657196044922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([55, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03068399429321289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03068399429321289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030736446380615234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03372621536254883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03391885757446289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03391885757446289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03396749496459961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03708028793334961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([399, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03895854949951172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03895854949951172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 199, 128]), torch.Size([1, 199, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03914833068847656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05262279510498047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 199, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05262279510498047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05262279510498047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 200, 128]), torch.Size([1, 200, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05281352996826172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06626081466674805  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 200, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.063079833984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0632929801940918  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0635061264038086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06328201293945312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1429, 40])
input nodes number: 3735
output nodes number: 1429
edges number: 7832
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06331777572631836  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06331825256347656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004349231719970703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 6 input nodes size: 3798
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004186153411865234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004186153411865234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005997180938720703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006008148193359375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004157066345214844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004215240478515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004215240478515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004215240478515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([223, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008161067962646484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008161067962646484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 223, 128]), torch.Size([1, 223, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008373737335205078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010075092315673828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 223, 128])
m.shape torch.Size([171, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0101318359375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0101318359375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010294914245605469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0127410888671875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([135, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012852668762207031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012852668762207031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012981414794921875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015813827514648438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([133, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016003131866455078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016003131866455078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 133, 128]), torch.Size([1, 133, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01612997055053711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019808292388916016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 133, 128])
m.shape torch.Size([125, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020042896270751953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020042896270751953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020162105560302734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02445363998413086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([72, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02460002899169922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02460002899169922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02466869354248047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02762126922607422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([63, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027797222137451172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027797222137451172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027857303619384766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030861377716064453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([69, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03109455108642578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03109455108642578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031160354614257812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034911155700683594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([44, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035067081451416016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035067081451416016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 44, 128]), torch.Size([1, 44, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03510904312133789  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03779458999633789  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 44, 128])
m.shape torch.Size([385, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03961372375488281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03961372375488281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 192, 128]), torch.Size([1, 192, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03979682922363281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05279731750488281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 192, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05279731750488281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05279731750488281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 193, 128]), torch.Size([1, 193, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05298137664794922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06595802307128906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 193, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0627894401550293  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06300115585327148  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06321287155151367  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06299018859863281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1420, 40])
input nodes number: 3798
output nodes number: 1420
edges number: 7798
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06302833557128906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06302881240844727  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004317283630371094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 7 input nodes size: 2882
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004155635833740234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004155635833740234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005995750427246094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006006717681884766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004184722900390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004231452941894531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004231452941894531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004231452941894531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([336, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007433891296386719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007433891296386719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 336, 128]), torch.Size([1, 336, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007754325866699219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010317802429199219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 336, 128])
m.shape torch.Size([258, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010403633117675781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010403633117675781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010649681091308594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014340400695800781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 258, 128])
m.shape torch.Size([189, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014487743377685547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014487743377685547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 189, 128]), torch.Size([1, 189, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014667987823486328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018633365631103516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 189, 128])
m.shape torch.Size([132, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018795013427734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018795013427734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 132, 128]), torch.Size([1, 132, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0189208984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022571563720703125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 132, 128])
m.shape torch.Size([108, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02276611328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02276611328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022869110107421875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026576995849609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([69, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02672290802001953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02672290802001953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026788711547851562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029618263244628906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([55, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029768943786621094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029768943786621094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029821395874023438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.032444000244140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([51, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03261232376098633  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03261232376098633  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03266096115112305  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035433292388916016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([34, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03555488586425781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03555488586425781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 34, 128]), torch.Size([1, 34, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035587310791015625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.037662506103515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 34, 128])
m.shape torch.Size([215, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03867149353027344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03867149353027344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 107, 128]), torch.Size([1, 107, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.038773536682128906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04601860046386719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 107, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04601860046386719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04601860046386719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04612159729003906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05338335037231445  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 108, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05105400085449219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0512700080871582  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05148601531982422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05125904083251953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1447, 40])
input nodes number: 2882
output nodes number: 1447
edges number: 6150
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.051296234130859375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05129671096801758  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004321098327636719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 8 input nodes size: 2606
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004189014434814453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004189014434814453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005431652069091797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005442619323730469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0035915374755859375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0036382675170898438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0036382675170898438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0036382675170898438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([275, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006861209869384766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006861209869384766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 275, 128]), torch.Size([1, 275, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007123470306396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009221553802490234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 275, 128])
m.shape torch.Size([253, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009331703186035156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009331703186035156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009572982788085938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013192176818847656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 253, 128])
m.shape torch.Size([193, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013347625732421875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013347625732421875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 193, 128]), torch.Size([1, 193, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013531684875488281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01758098602294922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 193, 128])
m.shape torch.Size([149, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017773151397705078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017773151397705078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 149, 128]), torch.Size([1, 149, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01791524887084961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022036075592041016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 149, 128])
m.shape torch.Size([120, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022251129150390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022251129150390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022365570068359375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026485443115234375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([89, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02668285369873047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02668285369873047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026767730712890625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030417442321777344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([78, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030635356903076172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030635356903076172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03070974349975586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034429073333740234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([59, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034616947174072266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034616947174072266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034673213958740234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03788042068481445  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([41, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03802824020385742  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03802824020385742  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03806734085083008  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04056978225708008  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([178, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04139900207519531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04139900207519531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04148387908935547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04751014709472656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 89, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04751014709472656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04751014709472656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04759502410888672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.053578853607177734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 89, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.051203250885009766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05141735076904297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05163145065307617  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0514063835144043  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1435, 40])
input nodes number: 2606
output nodes number: 1435
edges number: 6257
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.051434993743896484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05143547058105469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003719329833984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 9 input nodes size: 2641
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003589630126953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003589630126953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005429744720458984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005440711975097656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004187107086181641  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004235744476318359  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004235744476318359  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004235744476318359  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([276, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007563114166259766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007563114166259766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 276, 128]), torch.Size([1, 276, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00782632827758789  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00993204116821289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 276, 128])
m.shape torch.Size([246, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010035037994384766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010035037994384766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 246, 128]), torch.Size([1, 246, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010269641876220703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013788700103759766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 246, 128])
m.shape torch.Size([191, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013944625854492188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013944625854492188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014126777648925781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018134117126464844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([144, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018317699432373047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018317699432373047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018455028533935547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022437572479248047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([99, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022604942321777344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022604942321777344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022699356079101562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026098251342773438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 99, 128])
m.shape torch.Size([89, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026305675506591797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026305675506591797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026390552520751953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030040264129638672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([65, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030214786529541016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030214786529541016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030276775360107422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.033376216888427734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([49, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.033532142639160156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.033532142639160156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03357887268066406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03624248504638672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([32, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.036356449127197266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.036356449127197266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 32, 128]), torch.Size([1, 32, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.036386966705322266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.038340091705322266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 32, 128])
m.shape torch.Size([239, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.039464473724365234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.039464473724365234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03957796096801758  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.047635555267333984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 119, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.047635555267333984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.047635555267333984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.047749996185302734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05581855773925781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 120, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05332374572753906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05353689193725586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.053750038146972656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05352592468261719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1430, 40])
input nodes number: 2641
output nodes number: 1430
edges number: 6471
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.053555965423583984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05355644226074219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0043201446533203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 10 input nodes size: 2681
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004186153411865234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004186153411865234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0054645538330078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005475521087646484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003624439239501953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003677845001220703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003677845001220703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003677845001220703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([228, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0072612762451171875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0072612762451171875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 228, 128]), torch.Size([1, 228, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0074787139892578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009218215942382812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 228, 128])
m.shape torch.Size([241, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009339332580566406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009339332580566406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 241, 128]), torch.Size([1, 241, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009569168090820312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013016700744628906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 241, 128])
m.shape torch.Size([174, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013150691986083984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013150691986083984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 174, 128]), torch.Size([1, 174, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013316631317138672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016967296600341797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 174, 128])
m.shape torch.Size([123, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01711893081665039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01711893081665039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01723623275756836  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020637989044189453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([145, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020925045013427734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020925045013427734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 145, 128]), torch.Size([1, 145, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02106332778930664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026041507720947266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 145, 128])
m.shape torch.Size([94, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026241302490234375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026241302490234375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 94, 128]), torch.Size([1, 94, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026330947875976562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030185699462890625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 94, 128])
m.shape torch.Size([87, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030431270599365234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030431270599365234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030514240264892578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034662723541259766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([51, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03481578826904297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03481578826904297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03486442565917969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.037636756896972656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03783130645751953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03783130645751953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03787994384765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04099273681640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([256, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04280853271484375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04280853271484375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04293060302734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05159759521484375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 128, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05159759521484375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05159759521484375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05171966552734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06032562255859375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 128, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05756235122680664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05777883529663086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05799531936645508  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05776786804199219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1450, 40])
input nodes number: 2681
output nodes number: 1450
edges number: 7049
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05780220031738281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.057802677154541016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0037713050842285156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 11 input nodes size: 2523
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003627777099609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003627777099609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005467891693115234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005478858947753906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004189491271972656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004237174987792969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004237174987792969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004237174987792969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([289, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007519721984863281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007519721984863281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0077953338623046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010000228881835938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([238, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010089397430419922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010089397430419922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 238, 128]), torch.Size([1, 238, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01031637191772461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013720989227294922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 238, 128])
m.shape torch.Size([180, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013864994049072266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013864994049072266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 180, 128]), torch.Size([1, 180, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01403665542602539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01781320571899414  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 180, 128])
m.shape torch.Size([143, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018000125885009766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018000125885009766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01813650131225586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022091388702392578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([107, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022278308868408203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022278308868408203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 107, 128]), torch.Size([1, 107, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022380352020263672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026053905487060547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 107, 128])
m.shape torch.Size([83, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02624034881591797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02624034881591797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026319503784179688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029723167419433594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([66, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029903888702392578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029903888702392578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02996683120727539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.033113956451416016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([80, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03338766098022461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03338766098022461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03346395492553711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03781270980834961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([38, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03793764114379883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03793764114379883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 38, 128]), torch.Size([1, 38, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.037973880767822266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.040293216705322266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 38, 128])
m.shape torch.Size([201, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04123353958129883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04123353958129883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04132890701293945  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04809999465942383  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 100, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04809999465942383  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04809999465942383  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04819631576538086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.054987430572509766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 101, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05254936218261719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05276203155517578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.052974700927734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05275106430053711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1425, 40])
input nodes number: 2523
output nodes number: 1425
edges number: 6364
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05277729034423828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.052777767181396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004316806793212891  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 12 input nodes size: 2917
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004185676574707031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004185676574707031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005576610565185547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005587577819824219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0037364959716796875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003795623779296875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003795623779296875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003795623779296875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([186, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007779598236083984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007779598236083984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 186, 128]), torch.Size([1, 186, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007956981658935547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009376049041748047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 186, 128])
m.shape torch.Size([179, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009458065032958984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009458065032958984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 179, 128]), torch.Size([1, 179, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009628772735595703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012189388275146484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 179, 128])
m.shape torch.Size([154, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012324333190917969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012324333190917969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 154, 128]), torch.Size([1, 154, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012471199035644531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015702247619628906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 154, 128])
m.shape torch.Size([142, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015899658203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015899658203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016035079956054688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019962310791015625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 142, 128])
m.shape torch.Size([101, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02013540267944336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02013540267944336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02023172378540039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023699283599853516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([96, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02392578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02392578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024017333984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0279541015625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([94, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028222084045410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028222084045410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 94, 128]), torch.Size([1, 94, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028311729431152344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03279399871826172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 94, 128])
m.shape torch.Size([73, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03302764892578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03302764892578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.033097267150878906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03706550598144531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([61, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03729248046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03729248046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03735065460205078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04107379913330078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([347, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04288482666015625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04288482666015625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04304981231689453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0547637939453125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 173, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0547637939453125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0547637939453125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 174, 128]), torch.Size([1, 174, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05492973327636719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06662893295288086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 174, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06342077255249023  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06363439559936523  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06384801864624023  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06362342834472656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1433, 40])
input nodes number: 2917
output nodes number: 1433
edges number: 7916
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06365728378295898  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06365776062011719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003894329071044922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 13 input nodes size: 3464
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0037374496459960938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0037374496459960938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005577564239501953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005588531494140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0041866302490234375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004237174987792969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004237174987792969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004237174987792969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([274, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007714271545410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007714271545410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007975578308105469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010066032409667969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 274, 128])
m.shape torch.Size([210, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010135650634765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010135650634765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 210, 128]), torch.Size([1, 210, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010335922241210938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013339996337890625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 210, 128])
m.shape torch.Size([170, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013483047485351562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013483047485351562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013645172119140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0172119140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 170, 128])
m.shape torch.Size([141, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01739978790283203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01739978790283203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017534255981445312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02143383026123047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([110, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021628856658935547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021628856658935547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021733760833740234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025510311126708984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([83, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025695323944091797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025695323944091797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025774478912353516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029178142547607422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([68, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02936553955078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02936553955078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029430389404296875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.032672882080078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([63, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03288078308105469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03288078308105469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03294086456298828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.036365509033203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([46, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03653287887573242  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03653287887573242  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 46, 128]), torch.Size([1, 46, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03657674789428711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03938436508178711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 46, 128])
m.shape torch.Size([257, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0405879020690918  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0405879020690918  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0407099723815918  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0493769645690918  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 128, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0493769645690918  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0493769645690918  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0494999885559082  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05817365646362305  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 129, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05552196502685547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05573415756225586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05594635009765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05572319030761719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1422, 40])
input nodes number: 3464
output nodes number: 1422
edges number: 6780
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05575895309448242  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.055759429931640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004329204559326172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 14 input nodes size: 2813
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004185199737548828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004185199737548828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005526542663574219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005537509918212891  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0036864280700683594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0037436485290527344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0037436485290527344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0037436485290527344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([203, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007602691650390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007602691650390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 203, 128]), torch.Size([1, 203, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007796287536621094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009345054626464844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 203, 128])
m.shape torch.Size([211, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009449481964111328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009449481964111328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009650707244873047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012669086456298828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 211, 128])
m.shape torch.Size([162, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012800216674804688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012800216674804688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 162, 128]), torch.Size([1, 162, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0129547119140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016353607177734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 162, 128])
m.shape torch.Size([131, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016526222229003906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016526222229003906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 131, 128]), torch.Size([1, 131, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016651153564453125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02027416229248047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 131, 128])
m.shape torch.Size([119, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02049541473388672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02049541473388672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020608901977539062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024694442749023438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([99, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024920940399169922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024920940399169922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02501535415649414  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029075145721435547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 99, 128])
m.shape torch.Size([66, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02924823760986328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02924823760986328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029311180114746094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03245830535888672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([55, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03263664245605469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03263664245605469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03268909454345703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035678863525390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([69, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035948753356933594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035948753356933594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.036014556884765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.040225982666015625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([329, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04203319549560547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04203319549560547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 164, 128]), torch.Size([1, 164, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.042189598083496094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05329418182373047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 164, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05329418182373047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05329418182373047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0534515380859375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0645456314086914  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 165, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0614781379699707  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.061693668365478516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06190919876098633  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.061682701110839844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1444, 40])
input nodes number: 2813
output nodes number: 1444
edges number: 7637
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.061717987060546875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06171846389770508  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003841876983642578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 15 input nodes size: 3187
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0036897659301757812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0036897659301757812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005529880523681641  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0055408477783203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00418853759765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0042476654052734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0042476654052734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0042476654052734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([219, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008201122283935547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008201122283935547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 219, 128]), torch.Size([1, 219, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008409976959228516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010080814361572266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 219, 128])
m.shape torch.Size([196, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010163307189941406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010163307189941406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 196, 128]), torch.Size([1, 196, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010350227355957031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013154029846191406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 196, 128])
m.shape torch.Size([176, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013312339782714844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013312339782714844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013480186462402344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017172813415527344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([112, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017302513122558594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017302513122558594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017409324645996094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020506858825683594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([83, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02065134048461914  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02065134048461914  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02073049545288086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023580074310302734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([77, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02376079559326172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02376079559326172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023834228515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026991844177246094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([78, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02721548080444336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02721548080444336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027289867401123047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031009197235107422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([52, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031170368194580078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031170368194580078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031219959259033203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03404664993286133  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([49, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034232139587402344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034232139587402344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03427886962890625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03726959228515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([395, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03912973403930664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03912973403930664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03931760787963867  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05265665054321289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 197, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05265665054321289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05265665054321289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 198, 128]), torch.Size([1, 198, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05284547805786133  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06615829467773438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 198, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06298685073852539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0632014274597168  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0634160041809082  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06319046020507812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1437, 40])
input nodes number: 3187
output nodes number: 1437
edges number: 7817
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06322431564331055  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06322479248046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004346370697021484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 16 input nodes size: 4073
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004187583923339844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004187583923339844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006129741668701172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006140232086181641  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004289150238037109  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004345417022705078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004345417022705078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004345417022705078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([203, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00814676284790039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00814676284790039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 203, 128]), torch.Size([1, 203, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00834035873413086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00988912582397461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 203, 128])
m.shape torch.Size([186, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009969711303710938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009969711303710938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 186, 128]), torch.Size([1, 186, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0101470947265625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012807846069335938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 186, 128])
m.shape torch.Size([166, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012956619262695312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012956619262695312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 166, 128]), torch.Size([1, 166, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01311492919921875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016597747802734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 166, 128])
m.shape torch.Size([127, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016760826110839844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016760826110839844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016881942749023438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020394325256347656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([82, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02052927017211914  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02052927017211914  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020607471466064453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023422718048095703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([70, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02358388900756836  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02358388900756836  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023650646209716797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02652120590209961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([63, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02669811248779297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02669811248779297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026758193969726562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02976226806640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([50, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029922962188720703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029922962188720703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029970645904541016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03268861770629883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([44, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03285360336303711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03285360336303711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 44, 128]), torch.Size([1, 44, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.032895565032958984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035581111907958984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 44, 128])
m.shape torch.Size([388, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03741025924682617  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03741025924682617  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 194, 128]), torch.Size([1, 194, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.037595272064208984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05073118209838867  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 194, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05073118209838867  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05073118209838867  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 194, 128]), torch.Size([1, 194, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.050916194915771484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06395959854125977  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 194, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06090259552001953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06110811233520508  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.061313629150390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06109762191772461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1379, 40])
input nodes number: 4073
output nodes number: 1379
edges number: 7528
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06112957000732422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06113004684448242  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004438877105712891  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 17 input nodes size: 3756
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00428009033203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00428009033203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006120204925537109  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006131172180175781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004178524017333984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004249095916748047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004249095916748047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004249095916748047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([156, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008962154388427734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008962154388427734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00911092758178711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01030111312866211  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 156, 128])
m.shape torch.Size([143, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010363101959228516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010363101959228516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01049947738647461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012545108795166016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([112, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012637138366699219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012637138366699219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012743949890136719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015093803405761719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([100, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015231132507324219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015231132507324219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015326499938964844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01809215545654297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([95, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01827096939086914  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01827096939086914  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018361568450927734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02162313461303711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([84, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021818161010742188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021818161010742188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 84, 128]), torch.Size([1, 84, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021898269653320312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025342941284179688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 84, 128])
m.shape torch.Size([78, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02556324005126953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02556324005126953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02563762664794922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029356956481933594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([77, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029613494873046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029613494873046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029686927795410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03387260437011719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([50, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03405046463012695  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03405046463012695  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034098148345947266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.037149906158447266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([568, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03983449935913086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03983449935913086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.040105342864990234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05933523178100586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 284, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05933523178100586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05933523178100586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.059606075286865234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07870054244995117  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 284, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0747222900390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07494068145751953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07515907287597656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07492971420288086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1463, 40])
input nodes number: 3756
output nodes number: 1463
edges number: 9449
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.074981689453125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0749821662902832  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0043773651123046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 18 input nodes size: 3469
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004191398620605469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004191398620605469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005845546722412109  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005856037139892578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004004955291748047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004061222076416016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004061222076416016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004061222076416016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([221, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00787210464477539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00787210464477539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 221, 128]), torch.Size([1, 221, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008082866668701172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009768962860107422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 221, 128])
m.shape torch.Size([193, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009847640991210938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009847640991210938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 193, 128]), torch.Size([1, 193, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010031700134277344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012792587280273438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 193, 128])
m.shape torch.Size([141, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012902259826660156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012902259826660156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013036727905273438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015995025634765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([119, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016154766082763672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016154766082763672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016268253326416016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019559383392333984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([103, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019748210906982422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019748210906982422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019846439361572266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02338266372680664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([74, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023545265197753906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023545265197753906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02361583709716797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026650428771972656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([64, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026828765869140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026828765869140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026889801025390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029941558837890625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([55, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030120849609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030120849609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030173301696777344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03316307067871094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([52, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03336000442504883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03336000442504883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03340959548950195  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03658342361450195  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([371, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03839874267578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03839874267578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.038575172424316406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0511016845703125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 185, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0511016845703125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0511016845703125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 186, 128]), torch.Size([1, 186, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05127906799316406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06378507614135742  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 186, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06073760986328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06094551086425781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.061153411865234375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.060935020446777344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1393, 40])
input nodes number: 3469
output nodes number: 1393
edges number: 7531
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.060961246490478516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06096172332763672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004148960113525391  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 19 input nodes size: 4354
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003994464874267578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003994464874267578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006070613861083984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006081581115722656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004416942596435547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004482746124267578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004482746124267578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004482746124267578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([192, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008860588073730469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008860588073730469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 192, 128]), torch.Size([1, 192, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009043693542480469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010508537292480469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 192, 128])
m.shape torch.Size([150, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010560035705566406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010560035705566406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010703086853027344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012848854064941406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 150, 128])
m.shape torch.Size([144, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012983322143554688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012983322143554688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013120651245117188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016141891479492188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([110, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016283035278320312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016283035278320312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016387939453125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019430160522460938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([116, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019654273986816406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019654273986816406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01976490020751953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02374744415283203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([77, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023912429809570312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023912429809570312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023985862731933594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027143478393554688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([72, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027347087860107422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027347087860107422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027415752410888672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030848979949951172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([67, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031070232391357422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031070232391357422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 67, 128]), torch.Size([1, 67, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03113412857055664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03477621078491211  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 67, 128])
m.shape torch.Size([68, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03503608703613281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03503608703613281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03510093688964844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03925132751464844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([466, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04144096374511719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04144096374511719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 233, 128]), torch.Size([1, 233, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.041663169860839844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05743980407714844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 233, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05743980407714844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05743980407714844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 233, 128]), torch.Size([1, 233, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.057662010192871094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07332754135131836  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 233, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06972074508666992  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06993865966796875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07015657424926758  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06992769241333008  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1462, 40])
input nodes number: 4354
output nodes number: 1462
edges number: 8718
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06998157501220703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06998205184936523  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004608154296875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 20 input nodes size: 3404
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0044269561767578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0044269561767578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00605010986328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.006061077117919922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003973960876464844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004038810729980469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004038810729980469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004038810729980469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([184, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008352279663085938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008352279663085938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 184, 128]), torch.Size([1, 184, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008527755737304688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009931564331054688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 184, 128])
m.shape torch.Size([197, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010031700134277344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010031700134277344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010219573974609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013037681579589844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([142, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01314687728881836  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01314687728881836  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013282299041748047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016261577606201172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 142, 128])
m.shape torch.Size([119, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016420841217041016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016420841217041016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01653432846069336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019825458526611328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([93, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01999044418334961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01999044418334961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 93, 128]), torch.Size([1, 93, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02007913589477539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023272037506103516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 93, 128])
m.shape torch.Size([64, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023410797119140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023410797119140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023471832275390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026096343994140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([70, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026299476623535156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026299476623535156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026366233825683594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02970409393310547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([52, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02986907958984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02986907958984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029918670654296875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.032745361328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([48, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03292655944824219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03292655944824219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03297233581542969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03590202331542969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([493, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.038229942321777344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.038229942321777344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 246, 128]), torch.Size([1, 246, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03846454620361328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.055121421813964844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 246, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.055121421813964844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.055121421813964844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 247, 128]), torch.Size([1, 247, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05535697937011719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07196426391601562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 247, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06841039657592773  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06862831115722656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06884622573852539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06861734390258789  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1462, 40])
input nodes number: 3404
output nodes number: 1462
edges number: 8597
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06865406036376953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06865453720092773  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004146099090576172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 21 input nodes size: 3084
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003973960876464844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003973960876464844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005444526672363281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005455493927001953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038213729858398438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038728713989257812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038728713989257812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038728713989257812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([250, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0073947906494140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0073947906494140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 250, 128]), torch.Size([1, 250, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007633209228515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009540557861328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 250, 128])
m.shape torch.Size([238, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009648323059082031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009648323059082031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 238, 128]), torch.Size([1, 238, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009875297546386719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013279914855957031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 238, 128])
m.shape torch.Size([188, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01343536376953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01343536376953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 188, 128]), torch.Size([1, 188, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013614654541015625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017559051513671875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 188, 128])
m.shape torch.Size([140, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017736434936523438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017736434936523438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 140, 128]), torch.Size([1, 140, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017869949340820312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021741867065429688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 140, 128])
m.shape torch.Size([102, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021918296813964844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021918296813964844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 102, 128]), torch.Size([1, 102, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02201557159423828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02551746368408203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 102, 128])
m.shape torch.Size([82, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02570343017578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02570343017578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025781631469726562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029144287109375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([50, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029272079467773438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029272079467773438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02931976318359375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031703948974609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([52, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03187847137451172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03187847137451172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031928062438964844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03475475311279297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03493165969848633  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03493165969848633  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03497648239135742  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03784513473510742  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([286, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03944587707519531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03944587707519531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.039582252502441406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04926490783691406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 143, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04926490783691406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04926490783691406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.049401283264160156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.059015750885009766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 143, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05630826950073242  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056522369384765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05673646926879883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05651140213012695  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1435, 40])
input nodes number: 3084
output nodes number: 1435
edges number: 6901
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05654191970825195  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056542396545410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003960609436035156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 22 input nodes size: 3562
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038175582885742188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038175582885742188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00551605224609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005527019500732422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0040454864501953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0041103363037109375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0041103363037109375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0041103363037109375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([184, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008432388305664062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008432388305664062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 184, 128]), torch.Size([1, 184, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008607864379882812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010011672973632812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 184, 128])
m.shape torch.Size([161, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010077476501464844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010077476501464844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 161, 128]), torch.Size([1, 161, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01023101806640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012534141540527344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 161, 128])
m.shape torch.Size([141, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012659072875976562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012659072875976562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012793540954589844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01575183868408203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([119, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015911579132080078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015911579132080078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016025066375732422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01931619644165039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([110, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019521713256835938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019521713256835938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019626617431640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023403167724609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([77, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023571014404296875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023571014404296875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023644447326660156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02680206298828125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([71, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027002334594726562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027002334594726562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027070045471191406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030455589294433594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([61, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030654430389404297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030654430389404297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030712604522705078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03402853012084961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([57, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03424406051635742  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03424406051635742  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03429841995239258  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03777742385864258  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([470, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.040843963623046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.040843963623046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.041068077087402344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056980133056640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 235, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056980133056640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056980133056640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.057204246520996094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07300424575805664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 235, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0694422721862793  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06965875625610352  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06987524032592773  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06964778900146484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1451, 40])
input nodes number: 3562
output nodes number: 1451
edges number: 8615
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0696878433227539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06968832015991211  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0042209625244140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 23 input nodes size: 3236
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004047870635986328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004047870635986328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005590915679931641  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0056018829345703125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038924217224121094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003940105438232422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003940105438232422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003940105438232422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([293, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007228851318359375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007228851318359375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 293, 128]), torch.Size([1, 293, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007508277893066406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009743690490722656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 293, 128])
m.shape torch.Size([231, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009824275970458984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009824275970458984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010044574737548828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013349056243896484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([194, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013516426086425781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013516426086425781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 194, 128]), torch.Size([1, 194, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013701438903808594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01777172088623047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 194, 128])
m.shape torch.Size([136, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017938613891601562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017938613891601562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018068313598632812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021829605102539062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([103, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022010326385498047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022010326385498047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02210855484008789  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025644779205322266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([98, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02587604522705078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02587604522705078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025969505310058594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02998828887939453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([57, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030131816864013672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030131816864013672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030186176300048828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03290414810180664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([48, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03306007385253906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03306007385253906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03310585021972656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03571510314941406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([42, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035872459411621094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035872459411621094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 42, 128]), torch.Size([1, 42, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035912513732910156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.038475990295410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 42, 128])
m.shape torch.Size([223, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.039519309997558594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.039519309997558594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03962516784667969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.047141075134277344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 111, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.047141075134277344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.047141075134277344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.047247886657714844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0547785758972168  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 112, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.052330970764160156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05254364013671875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.052756309509277344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05253267288208008  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1425, 40])
input nodes number: 3236
output nodes number: 1425
edges number: 6375
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.052564144134521484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05256462097167969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004024982452392578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 24 input nodes size: 2773
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038886070251464844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038886070251464844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00521087646484375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005221843719482422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0036678314208984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0037364959716796875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0037364959716796875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0037364959716796875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([143, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008282184600830078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008282184600830078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008418560028076172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009509563446044922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([148, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00958251953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00958251953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 148, 128]), torch.Size([1, 148, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009723663330078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0118408203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 148, 128])
m.shape torch.Size([112, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011930465698242188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011930465698242188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012037277221679688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014387130737304688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([127, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014575958251953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014575958251953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014697074890136719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018209457397460938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([97, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018380165100097656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018380165100097656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018472671508789062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021802902221679688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([93, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022022724151611328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022022724151611328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 93, 128]), torch.Size([1, 93, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02211141586303711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025925159454345703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 93, 128])
m.shape torch.Size([71, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026117801666259766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026117801666259766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02618551254272461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029571056365966797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([86, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029865264892578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029865264892578125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 86, 128]), torch.Size([1, 86, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029947280883789062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0346221923828125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 86, 128])
m.shape torch.Size([65, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03486013412475586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03486013412475586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034922122955322266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.038889408111572266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([502, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04125213623046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04125213623046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04149150848388672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0584869384765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 251, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0584869384765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0584869384765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05872631072998047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07560205459594727  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 251, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07178974151611328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0720052719116211  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0722208023071289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07199430465698242  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1444, 40])
input nodes number: 2773
output nodes number: 1444
edges number: 9116
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07202911376953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07202959060668945  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003845691680908203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 25 input nodes size: 2713
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0036706924438476562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0036706924438476562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005213737487792969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005224704742431641  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003891468048095703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003947734832763672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003947734832763672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003947734832763672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([235, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007773876190185547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007773876190185547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007997989654541016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009790897369384766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 235, 128])
m.shape torch.Size([199, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009868621826171875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009868621826171875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 199, 128]), torch.Size([1, 199, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010058403015136719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012905120849609375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 199, 128])
m.shape torch.Size([163, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013043403625488281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013043403625488281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 163, 128]), torch.Size([1, 163, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0131988525390625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016618728637695312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 163, 128])
m.shape torch.Size([143, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01681375503540039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01681375503540039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016950130462646484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020905017852783203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([112, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021103858947753906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021103858947753906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021210670471191406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025055885314941406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([78, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02522563934326172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02522563934326172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025300025939941406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02849864959716797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([76, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028715133666992188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028715133666992188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028787612915039062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03241157531738281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([50, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.032566070556640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.032566070556640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03261375427246094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03533172607421875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([64, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035582542419433594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035582542419433594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035643577575683594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.039549827575683594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([331, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04109764099121094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04109764099121094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04125499725341797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05242729187011719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 165, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05242729187011719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05242729187011719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 166, 128]), torch.Size([1, 166, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.052585601806640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06374692916870117  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 166, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0607295036315918  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.060945987701416016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.061162471771240234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.060935020446777344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1451, 40])
input nodes number: 2713
output nodes number: 1451
edges number: 7540
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.060967445373535156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06096792221069336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004042148590087891  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 26 input nodes size: 3336
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038924217224121094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038924217224121094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005483150482177734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005494117736816406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003940105438232422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004014492034912109  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004014492034912109  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004014492034912109  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([133, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008969306945800781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008969306945800781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 133, 128]), torch.Size([1, 133, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009096145629882812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010110855102539062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 133, 128])
m.shape torch.Size([110, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010152339935302734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010152339935302734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010257244110107422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011830806732177734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([128, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01196146011352539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01196146011352539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01208353042602539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01476907730102539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([92, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01488351821899414  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01488351821899414  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014971256256103516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01751565933227539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([95, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017698287963867188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017698287963867188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01778888702392578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021050453186035156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([74, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021216869354248047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021216869354248047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02128744125366211  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024322032928466797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([59, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024483680725097656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024483680725097656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024539947509765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027353286743164062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([60, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027554035186767578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027554035186767578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027611255645751953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030872821807861328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([54, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03107595443725586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03107595443725586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031127452850341797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0344233512878418  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([657, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03753042221069336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03753042221069336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03784322738647461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06005239486694336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 328, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06005239486694336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06005239486694336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.060366153717041016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08248662948608398  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 329, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07823753356933594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07845544815063477  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0786733627319336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0784444808959961  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1462, 40])
input nodes number: 3336
output nodes number: 1462
edges number: 9973
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07848215103149414  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07848262786865234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004132270812988281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 27 input nodes size: 2666
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003941535949707031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003941535949707031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005484580993652344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005495548248291016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038938522338867188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003956794738769531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003956794738769531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003956794738769531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([187, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008174419403076172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008174419403076172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 187, 128]), torch.Size([1, 187, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00835275650024414  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00977945327758789  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 187, 128])
m.shape torch.Size([178, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009860038757324219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009860038757324219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010029792785644531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012576103210449219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 178, 128])
m.shape torch.Size([156, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012714385986328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012714385986328125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0128631591796875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01613616943359375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 156, 128])
m.shape torch.Size([100, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016252517700195312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016252517700195312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016347885131835938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019113540649414062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([79, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019254207611083984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019254207611083984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019329547882080078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022041797637939453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([66, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022192955017089844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022192955017089844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022255897521972656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024962425231933594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([52, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025104522705078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025104522705078125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02515411376953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0276336669921875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([45, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027780532836914062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027780532836914062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 45, 128]), torch.Size([1, 45, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027823448181152344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030269622802734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 45, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030449867248535156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030449867248535156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03049468994140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03336334228515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([505, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035748958587646484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035748958587646484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 252, 128]), torch.Size([1, 252, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03598928451538086  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.053052425384521484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 252, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.053052425384521484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.053052425384521484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.053293704986572266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07030439376831055  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 253, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06682062149047852  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0670318603515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06724309921264648  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06702089309692383  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1415, 40])
input nodes number: 2666
output nodes number: 1415
edges number: 8399
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06704521179199219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06704568862915039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004049777984619141  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 28 input nodes size: 3508
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003887176513671875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003887176513671875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0055599212646484375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005570888519287109  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004016876220703125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004080772399902344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004080772399902344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004080772399902344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([169, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008319377899169922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008319377899169922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 169, 128]), torch.Size([1, 169, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008480548858642578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009769916534423828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 169, 128])
m.shape torch.Size([165, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009846687316894531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009846687316894531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010004043579101562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012364387512207031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 165, 128])
m.shape torch.Size([146, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012494564056396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012494564056396484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012633800506591797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015697002410888672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([127, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015869617462158203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015869617462158203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015990734100341797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019503116607666016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([108, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019700050354003906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019700050354003906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01980304718017578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02351093292236328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([91, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02371978759765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02371978759765625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02380657196044922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027538299560546875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([77, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027751922607421875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027751922607421875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027825355529785156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03149700164794922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([66, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03171205520629883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03171205520629883  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03177499771118164  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03536272048950195  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([61, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03559303283691406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03559303283691406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035651206970214844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.039374351501464844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([431, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04140043258666992  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04140043258666992  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 215, 128]), torch.Size([1, 215, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.041605472564697266  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05616331100463867  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 215, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05616331100463867  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05616331100463867  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 216, 128]), torch.Size([1, 216, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05636930465698242  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.070892333984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 216, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06740999221801758  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06762504577636719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0678400993347168  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06761407852172852  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1441, 40])
input nodes number: 3508
output nodes number: 1441
edges number: 8457
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06765508651733398  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06765556335449219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004191398620605469  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 29 input nodes size: 3163
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00402069091796875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00402069091796875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0055637359619140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005574226379394531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003890514373779297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003954410552978516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003954410552978516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003954410552978516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([150, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008214950561523438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008214950561523438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008358001708984375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009502410888671875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 150, 128])
m.shape torch.Size([159, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00958251953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00958251953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 159, 128]), torch.Size([1, 159, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009734153747558594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0120086669921875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 159, 128])
m.shape torch.Size([137, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012128829956054688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012128829956054688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 137, 128]), torch.Size([1, 137, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012259483337402344  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015133857727050781  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 137, 128])
m.shape torch.Size([126, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015308856964111328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015308856964111328  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 126, 128]), torch.Size([1, 126, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015429019927978516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018913745880126953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 126, 128])
m.shape torch.Size([84, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019053936004638672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019053936004638672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 84, 128]), torch.Size([1, 84, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019134044647216797  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022017955780029297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 84, 128])
m.shape torch.Size([84, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02221822738647461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02221822738647461  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 84, 128]), torch.Size([1, 84, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022298336029052734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02574300765991211  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 84, 128])
m.shape torch.Size([78, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025963306427001953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025963306427001953  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02603769302368164  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029757022857666016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([70, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029986858367919922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029986858367919922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03005361557006836  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0338587760925293  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([49, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034035682678222656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034035682678222656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03408241271972656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03707313537597656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([467, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0392765998840332  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0392765998840332  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 233, 128]), torch.Size([1, 233, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03949880599975586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05527544021606445  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 233, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05527544021606445  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05527544021606445  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.055498600006103516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07123184204101562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 234, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06769084930419922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06790018081665039  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06810951232910156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06788969039916992  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1404, 40])
input nodes number: 3163
output nodes number: 1404
edges number: 8524
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06791830062866211  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06791877746582031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004052162170410156  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 30 input nodes size: 3342
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038847923278808594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038847923278808594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005478382110595703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005489349365234375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003935813903808594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004004478454589844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004004478454589844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004004478454589844  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([139, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008590221405029297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008590221405029297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 139, 128]), torch.Size([1, 139, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008722782135009766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009783267974853516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 139, 128])
m.shape torch.Size([145, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009855270385742188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009855270385742188  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 145, 128]), torch.Size([1, 145, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009993553161621094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012067794799804688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 145, 128])
m.shape torch.Size([119, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01216888427734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01216888427734375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012282371520996094  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014779090881347656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([94, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01490163803100586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01490163803100586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 94, 128]), torch.Size([1, 94, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014991283416748047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017590999603271484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 94, 128])
m.shape torch.Size([106, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017798900604248047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017798900604248047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01789999008178711  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02153921127319336  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 106, 128])
m.shape torch.Size([87, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02173757553100586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02173757553100586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021820545196533203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025388240814208984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([72, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025587081909179688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025587081909179688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025655746459960938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029088973999023438  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([72, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029329299926757812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029329299926757812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029397964477539062  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03331184387207031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([41, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03345346450805664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03345346450805664  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0334925651550293  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0359950065612793  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([554, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03861713409423828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03861713409423828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 277, 128]), torch.Size([1, 277, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03888130187988281  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05763721466064453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 277, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05763721466064453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05763721466064453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 277, 128]), torch.Size([1, 277, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05790138244628906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07652521133422852  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 277, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07265138626098633  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07286453247070312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07307767868041992  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07285356521606445  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1429, 40])
input nodes number: 3342
output nodes number: 1429
edges number: 9203
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07289361953735352  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07289409637451172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004118919372558594  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 31 input nodes size: 3129
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003939628601074219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003939628601074219  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005482673645019531  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005493640899658203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0038890838623046875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0039520263671875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0039520263671875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0039520263671875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([149, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008166313171386719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008166313171386719  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 149, 128]), torch.Size([1, 149, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00830841064453125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0094451904296875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 149, 128])
m.shape torch.Size([146, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009513378143310547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009513378143310547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00965261459350586  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011741161346435547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([136, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011866092681884766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011866092681884766  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011995792388916016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014849185943603516  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([125, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015022754669189453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015022754669189453  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015141963958740234  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01859903335571289  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([110, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01880168914794922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01880168914794922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018906593322753906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022683143615722656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([121, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02297687530517578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02297687530517578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023092269897460938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028054237365722656  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([97, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0283203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0283203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028412818908691406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03303813934326172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([61, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03322458267211914  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03322458267211914  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03328275680541992  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03659868240356445  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([52, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.036792755126953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.036792755126953125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03684234619140625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04001617431640625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([417, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04197978973388672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04197978973388672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 208, 128]), torch.Size([1, 208, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.04217815399169922  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05626201629638672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 208, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05626201629638672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05626201629638672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 209, 128]), torch.Size([1, 209, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056461334228515625  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07051372528076172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 1 shape torch.Size([1, 209, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06703567504882812  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0672464370727539  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06745719909667969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06723546981811523  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

torch.Size([1414, 40])
input nodes number: 3129
output nodes number: 1414
edges number: 8430
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06726741790771484  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06726789474487305  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.004052639007568359  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

pseudo mini batch 32 input nodes size: 7004
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003886699676513672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.003886699676513672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007226467132568359  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.007237434387207031  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005683422088623047  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005764484405517578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005764484405517578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005764484405517578  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

m.shape torch.Size([127, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011112689971923828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011112689971923828  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011233806610107422  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012202739715576172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([96, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012233734130859375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012233734130859375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012325286865234375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013698577880859375  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([92, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013784408569335938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013784408569335938  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013872146606445312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015802383422851562  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([84, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015918731689453125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015918731689453125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 84, 128]), torch.Size([1, 84, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01599884033203125  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018321990966796875  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 84, 128])
m.shape torch.Size([53, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01840829849243164  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01840829849243164  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018458843231201172  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020278453826904297  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([51, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020399093627929688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020399093627929688  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020447731018066406  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022539138793945312  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([54, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022695064544677734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022695064544677734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022746562957763672  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025321483612060547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([45, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025467395782470703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025467395782470703  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 45, 128]), torch.Size([1, 45, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025510311126708984  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027956485748291016  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 45, 128])
m.shape torch.Size([58, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028183937072753906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028183937072753906  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 58, 128]), torch.Size([1, 58, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02823925018310547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03177928924560547  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst.shape  torch.Size([1, 58, 128])
m.shape torch.Size([803, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03558063507080078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03558063507080078  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 401, 128]), torch.Size([1, 401, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03596305847167969  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06311511993408203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

rst 0 shape torch.Size([1, 401, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06311511993408203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06311511993408203  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

 h.shape torch.Size([1, 402, 128]), torch.Size([1, 402, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06349849700927734  GigaBytes
Max Memory Allocated: 0.09087610244750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.09052705764770508  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 402, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08585405349731445  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08607244491577148  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08629083633422852  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08606147766113281  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1463, 40])
input nodes number: 7004
output nodes number: 1463
edges number: 10792
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08613252639770508  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08613300323486328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0059223175048828125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 33 input nodes size: 6505
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005691051483154297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005691051483154297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008792877197265625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008803367614746094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005452632904052734  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005520343780517578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005520343780517578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005520343780517578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([176, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010614871978759766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010614871978759766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010782718658447266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012125492095947266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([137, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012172222137451172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012172222137451172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 137, 128]), torch.Size([1, 137, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012302875518798828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014262676239013672  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 137, 128])
m.shape torch.Size([111, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014356136322021484  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014356136322021484  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014461994171142578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01679086685180664  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 111, 128])
m.shape torch.Size([83, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01689624786376953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01689624786376953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01697540283203125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019270896911621094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([73, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019405364990234375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019405364990234375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01947498321533203  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021981239318847656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([48, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022083759307861328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022083759307861328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022129535675048828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024097919464111328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([48, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024235248565673828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024235248565673828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024281024932861328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026569843292236328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([28, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026653766632080078  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026653766632080078  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 28, 128]), torch.Size([1, 28, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026680469512939453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028202533721923828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 28, 128])
m.shape torch.Size([36, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028343677520751953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028343677520751953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028378009796142578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030575275421142578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([641, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0336146354675293  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0336146354675293  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0339198112487793  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0555872917175293  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 320, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0555872917175293  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0555872917175293  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0558934211730957  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07747602462768555  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 321, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07306480407714844  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07327079772949219  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07347679138183594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07326030731201172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1381, 40])
input nodes number: 6505
output nodes number: 1381
edges number: 9062
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07330703735351562  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07330751419067383  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0056400299072265625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 34 input nodes size: 6400
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005440235137939453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005440235137939453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008491992950439453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008502483367919922  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005390167236328125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005463600158691406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005463600158691406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005463600158691406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([127, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010334014892578125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010334014892578125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010455131530761719  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011424064636230469  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([114, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011472225189208984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011472225189208984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011580944061279297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013211727142333984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 114, 128])
m.shape torch.Size([95, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013293266296386719  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013293266296386719  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013383865356445312  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015377044677734375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([85, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01549386978149414  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01549386978149414  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015574932098388672  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017925739288330078  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 85, 128])
m.shape torch.Size([64, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018037796020507812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018037796020507812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018098831176757812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020296096801757812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([47, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020400047302246094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020400047302246094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020444869995117188  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02237224578857422  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([45, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022500038146972656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022500038146972656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 45, 128]), torch.Size([1, 45, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022542953491210938  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024688720703125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 45, 128])
m.shape torch.Size([36, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02480459213256836  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02480459213256836  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024838924407958984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02679586410522461  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([32, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026916027069091797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026916027069091797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 32, 128]), torch.Size([1, 32, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026946544647216797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028899669647216797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 32, 128])
m.shape torch.Size([734, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.032384395599365234  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.032384395599365234  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03273439407348633  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.057584285736083984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 367, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.057584285736083984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.057584285736083984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05793428421020508  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08260917663574219  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 367, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07838153839111328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07858705520629883  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07879257202148438  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07857656478881836  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1379, 40])
input nodes number: 6400
output nodes number: 1379
edges number: 9813
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07863426208496094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07863473892211914  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0055999755859375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 35 input nodes size: 6921
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005389690399169922  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005389690399169922  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00868988037109375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008700370788574219  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00563812255859375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005710601806640625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005710601806640625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005710601806640625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([147, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010550498962402344  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010550498962402344  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 147, 128]), torch.Size([1, 147, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010690689086914062  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011812210083007812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 147, 128])
m.shape torch.Size([128, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011864185333251953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011864185333251953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011986255645751953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013817310333251953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([87, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013880729675292969  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013880729675292969  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013963699340820312  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015789031982421875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([74, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015888690948486328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015888690948486328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01595926284790039  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018005847930908203  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([52, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018094539642333984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018094539642333984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01814413070678711  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01992940902709961  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([42, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020024776458740234  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020024776458740234  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 42, 128]), torch.Size([1, 42, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020064830780029297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021787166595458984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 42, 128])
m.shape torch.Size([48, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021927356719970703  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021927356719970703  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021973133087158203  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024261951446533203  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([37, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024380207061767578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024380207061767578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 37, 128]), torch.Size([1, 37, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02441549301147461  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02642679214477539  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 37, 128])
m.shape torch.Size([36, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026563644409179688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026563644409179688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026597976684570312  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028795242309570312  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([730, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03225898742675781  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03225898742675781  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.032607078552246094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05732154846191406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 365, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05732154846191406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05732154846191406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.057669639587402344  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08221006393432617  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 365, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07802343368530273  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07822942733764648  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07843542098999023  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07821893692016602  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1381, 40])
input nodes number: 6921
output nodes number: 1381
edges number: 9728
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07828187942504883  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07828235626220703  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005851268768310547  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 36 input nodes size: 6521
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005638599395751953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005638599395751953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008748054504394531  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008758544921875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005447864532470703  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005519390106201172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005519390106201172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005519390106201172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([151, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010267257690429688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010267257690429688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010411262512207031  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011563301086425781  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([137, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011621952056884766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011621952056884766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 137, 128]), torch.Size([1, 137, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011752605438232422  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013712406158447266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 137, 128])
m.shape torch.Size([99, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013788700103759766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013788700103759766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013883113861083984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015960216522216797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 99, 128])
m.shape torch.Size([58, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016023635864257812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016023635864257812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 58, 128]), torch.Size([1, 58, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016078948974609375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017683029174804688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 58, 128])
m.shape torch.Size([70, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017822265625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017822265625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017889022827148438  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020292282104492188  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([45, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020387649536132812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020387649536132812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 45, 128]), torch.Size([1, 45, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020430564880371094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022275924682617188  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 45, 128])
m.shape torch.Size([46, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022408008575439453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022408008575439453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 46, 128]), torch.Size([1, 46, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02245187759399414  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024645328521728516  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 46, 128])
m.shape torch.Size([30, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024737834930419922  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024737834930419922  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 30, 128]), torch.Size([1, 30, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02476644515991211  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026397228240966797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 30, 128])
m.shape torch.Size([36, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026537418365478516  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026537418365478516  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02657175064086914  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02876901626586914  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([707, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03212308883666992  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03212308883666992  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 353, 128]), torch.Size([1, 353, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03245973587036133  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05636167526245117  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 353, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05636167526245117  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05636167526245117  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 354, 128]), torch.Size([1, 354, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056699275970458984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08050060272216797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 354, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07641124725341797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07661676406860352  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07682228088378906  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07660627365112305  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1379, 40])
input nodes number: 6521
output nodes number: 1379
edges number: 9530
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07666492462158203  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07666540145874023  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005654811859130859  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 37 input nodes size: 6504
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0054473876953125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0054473876953125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008548736572265625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008559226989746094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005439281463623047  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005506038665771484  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005506038665771484  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005506038665771484  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([173, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009965896606445312  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009965896606445312  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010130882263183594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011450767517089844  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 173, 128])
m.shape torch.Size([155, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011516094207763672  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011516094207763672  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 155, 128]), torch.Size([1, 155, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01166391372680664  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013881206512451172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 155, 128])
m.shape torch.Size([110, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013964653015136719  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013964653015136719  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014069557189941406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01637744903564453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([89, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0164947509765625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0164947509765625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016579627990722656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019041061401367188  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([73, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01917266845703125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01917266845703125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019242286682128906  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02174854278564453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([53, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021865367889404297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021865367889404297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021915912628173828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024089336395263672  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([41, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024200916290283203  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024200916290283203  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02424001693725586  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026195049285888672  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([42, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026335716247558594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026335716247558594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 42, 128]), torch.Size([1, 42, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.026375770568847656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02865886688232422  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 42, 128])
m.shape torch.Size([38, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028801918029785156  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028801918029785156  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 38, 128]), torch.Size([1, 38, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028838157653808594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031157493591308594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 38, 128])
m.shape torch.Size([610, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03404808044433594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03404808044433594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.034338951110839844  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05499076843261719  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 305, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05499076843261719  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05499076843261719  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.055281639099121094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07578802108764648  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 305, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07201814651489258  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07222461700439453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07243108749389648  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07221412658691406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1384, 40])
input nodes number: 6504
output nodes number: 1384
edges number: 8917
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07227420806884766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07227468490600586  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00563812255859375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 38 input nodes size: 6356
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005440235137939453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005440235137939453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008471012115478516  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008481502532958984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005369663238525391  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005436420440673828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005436420440673828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005436420440673828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([178, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00986337661743164  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00986337661743164  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010033130645751953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011391162872314453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 178, 128])
m.shape torch.Size([138, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01143789291381836  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01143789291381836  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011569499969482422  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01354360580444336  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([107, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013630867004394531  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013630867004394531  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 107, 128]), torch.Size([1, 107, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01373291015625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015977859497070312  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 107, 128])
m.shape torch.Size([86, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016090869903564453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016090869903564453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 86, 128]), torch.Size([1, 86, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01617288589477539  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018551349639892578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 86, 128])
m.shape torch.Size([80, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01870107650756836  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01870107650756836  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01877737045288086  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02152395248413086  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([69, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021683216094970703  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021683216094970703  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021749019622802734  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024578571319580078  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([55, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024729251861572266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024729251861572266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02478170394897461  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027404308319091797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([41, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02753448486328125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02753448486328125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027573585510253906  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029802322387695312  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([53, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030010223388671875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030010223388671875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.030060768127441406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.033295631408691406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([572, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.036371707916259766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.036371707916259766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 286, 128]), torch.Size([1, 286, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03664445877075195  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056009769439697266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 286, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056009769439697266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.056009769439697266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 286, 128]), torch.Size([1, 286, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05628252029418945  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07551145553588867  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 286, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07178354263305664  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07198905944824219  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07219457626342773  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07197856903076172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1379, 40])
input nodes number: 6356
output nodes number: 1379
edges number: 8843
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0720357894897461  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0720362663269043  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005565643310546875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 39 input nodes size: 7028
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005368709564208984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005368709564208984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008719921112060547  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.008730411529541016  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005689144134521484  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005757808685302734  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005757808685302734  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005757808685302734  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([170, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01033163070678711  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01033163070678711  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010493755340576172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011790752410888672  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 170, 128])
m.shape torch.Size([135, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011838436126708984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011838436126708984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011967182159423828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013898372650146484  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([114, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013997077941894531  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013997077941894531  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014105796813964844  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01649761199951172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 114, 128])
m.shape torch.Size([70, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016576766967773438  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016576766967773438  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016643524169921875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018579483032226562  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([71, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018715381622314453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018715381622314453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018783092498779297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021220684051513672  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([62, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021364212036132812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021364212036132812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02142333984375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023965835571289062  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([36, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024056434631347656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024056434631347656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02409076690673828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02580738067626953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([41, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025946617126464844  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025946617126464844  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0259857177734375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028214454650878906  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([27, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028310775756835938  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028310775756835938  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 27, 128]), torch.Size([1, 27, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028336524963378906  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029984474182128906  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 27, 128])
m.shape torch.Size([654, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03309011459350586  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03309011459350586  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0334019660949707  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05554342269897461  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 327, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05554342269897461  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05554342269897461  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.05585527420043945  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07784080505371094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 327, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0739450454711914  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07415103912353516  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0743570327758789  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.07414054870605469  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1380, 40])
input nodes number: 7028
output nodes number: 1380
edges number: 9152
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0742039680480957  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0742044448852539  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005895137786865234  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 40 input nodes size: 7265
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0056896209716796875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0056896209716796875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00915384292602539  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009164810180664062  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.005803108215332031  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0058803558349609375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0058803558349609375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0058803558349609375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([134, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010967254638671875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010967254638671875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 134, 128]), torch.Size([1, 134, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011095046997070312  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012117385864257812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 134, 128])
m.shape torch.Size([98, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012146949768066406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012146949768066406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012240409851074219  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013642311096191406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([105, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013745784759521484  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013745784759521484  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01384592056274414  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016048908233642578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([98, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016185760498046875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016185760498046875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016279220581054688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01898956298828125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([94, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019166946411132812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019166946411132812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 94, 128]), torch.Size([1, 94, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019256591796875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02248382568359375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 94, 128])
m.shape torch.Size([62, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02261638641357422  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02261638641357422  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022675514221191406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02521800994873047  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([65, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025405406951904297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025405406951904297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.025467395782470703  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028566837310791016  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([53, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028738021850585938  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028738021850585938  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02878856658935547  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03166961669921875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([55, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03188037872314453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03188037872314453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031932830810546875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.035289764404296875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([699, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03859663009643555  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03859663009643555  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 349, 128]), torch.Size([1, 349, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.03892946243286133  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0625605583190918  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 349, 128])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0625605583190918  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0625605583190918  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.06289434432983398  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0864267349243164  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 350, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.08203935623168945  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.08225774765014648  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.08247613906860352  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.08224678039550781  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1463, 40])
input nodes number: 7265
output nodes number: 1463
edges number: 10243
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.08232450485229492  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.08232498168945312  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.006041049957275391  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 41 input nodes size: 6513
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0058155059814453125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0058155059814453125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008921146392822266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008931636810302734  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005456447601318359  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005518436431884766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005518436431884766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005518436431884766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([226, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.009656429290771484  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.009656429290771484  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 226, 128]), torch.Size([1, 226, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.009871959686279297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011596202850341797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 226, 128])
m.shape torch.Size([149, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011630535125732422  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011630535125732422  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 149, 128]), torch.Size([1, 149, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011772632598876953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013904094696044922  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 149, 128])
m.shape torch.Size([139, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01403188705444336  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01403188705444336  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 139, 128]), torch.Size([1, 139, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014164447784423828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01708078384399414  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 139, 128])
m.shape torch.Size([83, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017172813415527344  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017172813415527344  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017251968383789062  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019547462463378906  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([87, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019715309143066406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019715309143066406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01979827880859375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022785186767578125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([54, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022898197174072266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022898197174072266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022949695587158203  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.025164127349853516  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([43, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.025281906127929688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.025281906127929688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 43, 128]), torch.Size([1, 43, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.025322914123535156  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.027373313903808594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 43, 128])
m.shape torch.Size([35, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.027486324310302734  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.027486324310302734  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 35, 128]), torch.Size([1, 35, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.027519702911376953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.029422283172607422  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 35, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.029607295989990234  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.029607295989990234  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.029652118682861328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03252077102661133  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([516, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.034958839416503906  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.034958839416503906  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03520488739013672  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.052674293518066406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 258, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.052674293518066406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.052674293518066406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.05292034149169922  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0702667236328125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 258, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06685924530029297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06706476211547852  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06727027893066406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06705427169799805  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1379, 40])
input nodes number: 6513
output nodes number: 1379
edges number: 8196
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06710052490234375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06710100173950195  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005631923675537109  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 42 input nodes size: 6182
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005443572998046875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005443572998046875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008907794952392578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008918285369873047  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005802154541015625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0058689117431640625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0058689117431640625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0058689117431640625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([187, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.010341644287109375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.010341644287109375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 187, 128]), torch.Size([1, 187, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.010519981384277344  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011946678161621094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 187, 128])
m.shape torch.Size([151, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.012001514434814453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.012001514434814453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.012145519256591797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014305591583251953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([115, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01439809799194336  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01439809799194336  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 115, 128]), torch.Size([1, 115, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014507770538330078  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01692056655883789  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 115, 128])
m.shape torch.Size([74, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017006874084472656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017006874084472656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01707744598388672  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01912403106689453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([70, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019255638122558594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019255638122558594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01932239532470703  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02172565460205078  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([59, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02186107635498047  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02186107635498047  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021917343139648438  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024336814880371094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([36, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024428844451904297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024428844451904297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024463176727294922  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.026179790496826172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([38, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02630758285522461  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02630758285522461  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 38, 128]), torch.Size([1, 38, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.026343822479248047  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.028409481048583984  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 38, 128])
m.shape torch.Size([40, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02856302261352539  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02856302261352539  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 40, 128]), torch.Size([1, 40, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02860116958618164  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03104257583618164  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 40, 128])
m.shape torch.Size([618, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03397035598754883  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03397035598754883  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03426504135131836  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.05518770217895508  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 309, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.05518770217895508  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.05518770217895508  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.05548238754272461  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.07625770568847656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 309, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.07248163223266602  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.07268857955932617  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.07289552688598633  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0726780891418457  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1388, 40])
input nodes number: 6182
output nodes number: 1388
edges number: 8930
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.07273626327514648  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.07273674011230469  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005999088287353516  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 43 input nodes size: 6135
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005803585052490234  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005803585052490234  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008728981018066406  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008739948272705078  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005265235900878906  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0053348541259765625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0053348541259765625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0053348541259765625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([167, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.009962081909179688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.009962081909179688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.010121345520019531  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011395454406738281  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 167, 128])
m.shape torch.Size([155, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011463642120361328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011463642120361328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 155, 128]), torch.Size([1, 155, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011611461639404297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013828754425048828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 155, 128])
m.shape torch.Size([118, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01392364501953125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01392364501953125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 118, 128]), torch.Size([1, 118, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014036178588867188  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.016511917114257812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 118, 128])
m.shape torch.Size([92, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.016631126403808594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.016631126403808594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01671886444091797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019263267517089844  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([71, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019388675689697266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019388675689697266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01945638656616211  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021893978118896484  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([60, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022031784057617188  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022031784057617188  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022089004516601562  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024549484252929688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([47, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024677753448486328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024677753448486328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024722576141357422  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02696371078491211  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([37, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.027082443237304688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.027082443237304688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 37, 128]), torch.Size([1, 37, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02711772918701172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0291290283203125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 37, 128])
m.shape torch.Size([28, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.029231548309326172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.029231548309326172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 28, 128]), torch.Size([1, 28, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.029258251190185547  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.030967235565185547  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 28, 128])
m.shape torch.Size([647, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03441810607910156  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03441810607910156  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03472614288330078  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.05659675598144531  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 323, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.05659675598144531  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.05659675598144531  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 324, 128]), torch.Size([1, 324, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.05690574645996094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0786900520324707  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 324, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.07476329803466797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.07497549057006836  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.07518768310546875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.07496452331542969  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1422, 40])
input nodes number: 6135
output nodes number: 1422
edges number: 9261
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0750265121459961  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0750269889831543  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0054721832275390625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 44 input nodes size: 5986
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005270481109619141  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005270481109619141  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008734703063964844  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.008745193481445312  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005808830261230469  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005867958068847656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005867958068847656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005867958068847656  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([213, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.009869575500488281  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.009869575500488281  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 213, 128]), torch.Size([1, 213, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.010072708129882812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011697769165039062  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 213, 128])
m.shape torch.Size([198, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011785030364990234  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011785030364990234  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 198, 128]), torch.Size([1, 198, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011973857879638672  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014806270599365234  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 198, 128])
m.shape torch.Size([135, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014904975891113281  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014904975891113281  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015033721923828125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017866134643554688  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([100, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017992496490478516  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017992496490478516  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01808786392211914  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020853519439697266  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([65, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02096080780029297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02096080780029297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021022796630859375  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02325439453125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([63, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.023403644561767578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.023403644561767578  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.023463726043701172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.026047229766845703  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([47, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.026174068450927734  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.026174068450927734  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.026218891143798828  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.028460025787353516  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([36, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02857494354248047  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02857494354248047  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.028609275817871094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03056621551513672  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([24, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03065204620361328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03065204620361328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 24, 128]), torch.Size([1, 24, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03067493438720703  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03213977813720703  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 24, 128])
m.shape torch.Size([498, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03450298309326172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03450298309326172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 249, 128]), torch.Size([1, 249, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.034740447998046875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.05160045623779297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 249, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.05160045623779297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.05160045623779297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 249, 128]), torch.Size([1, 249, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.051837921142578125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06857919692993164  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 1 shape torch.Size([1, 249, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06530332565307617  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06550884246826172  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06571435928344727  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06549835205078125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

torch.Size([1379, 40])
input nodes number: 5986
output nodes number: 1379
edges number: 7930
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06554698944091797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06554746627807617  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005980968475341797  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

pseudo mini batch 45 input nodes size: 6784
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005802154541015625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005802154541015625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.009037017822265625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.009047985076904297  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005573272705078125  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005658149719238281  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005658149719238281  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.005658149719238281  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

m.shape torch.Size([88, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011232376098632812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011232376098632812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 88, 128]), torch.Size([1, 88, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011316299438476562  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.011987686157226562  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 88, 128])
m.shape torch.Size([81, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.012022972106933594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.012022972106933594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0121002197265625  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013258934020996094  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([52, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013294696807861328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013294696807861328  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013344287872314453  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014435291290283203  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([52, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01450967788696289  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01450967788696289  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014559268951416016  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01599740982055664  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([54, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.016101360321044922  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.016101360321044922  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01615285873413086  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01800680160522461  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([48, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01811838150024414  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01811838150024414  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01816415786743164  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02013254165649414  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([37, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020233154296875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020233154296875  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 37, 128]), torch.Size([1, 37, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02026844024658203  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022032737731933594  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 37, 128])
m.shape torch.Size([32, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022137165069580078  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022137165069580078  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 32, 128]), torch.Size([1, 32, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022167682647705078  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.023907184600830078  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 32, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024110794067382812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024110794067382812  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02415943145751953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02727222442626953  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([915, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.031610965728759766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.031610965728759766  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03204679489135742  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06299066543579102  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

rst 0 shape torch.Size([1, 457, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06299066543579102  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06299066543579102  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.06342744827270508  GigaBytes
Max Memory Allocated: 0.0926351547241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09422111511230469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 458, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08925533294677734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08946561813354492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0896759033203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08945465087890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1410, 40])
input nodes number: 6784
output nodes number: 1410
edges number: 11296
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08952093124389648  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08952140808105469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005815029144287109  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 46 input nodes size: 5251
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005578041076660156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005578041076660156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00904226303100586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009053230285644531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005807399749755859  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005862712860107422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005862712860107422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005862712860107422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([243, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009576797485351562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009576797485351562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009808540344238281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011662483215332031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([237, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011772632598876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011772632598876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 237, 128]), torch.Size([1, 237, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011998653411865234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015388965606689453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 237, 128])
m.shape torch.Size([150, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015490531921386719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015490531921386719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015633583068847656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01878070831298828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 150, 128])
m.shape torch.Size([98, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018896102905273438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018896102905273438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01898956298828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021699905395507812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([113, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021922588348388672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021922588348388672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022030353546142578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025909900665283203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([70, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026056289672851562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026056289672851562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026123046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028993606567382812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([62, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02916717529296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02916717529296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029226303100585938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03218269348144531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([65, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032401084899902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032401084899902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03246307373046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035996437072753906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([36, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036119937896728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036119937896728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03615427017211914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03835153579711914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([348, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0399937629699707  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0399937629699707  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 174, 128]), torch.Size([1, 174, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04015970230102539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0519413948059082  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 174, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0519413948059082  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0519413948059082  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 174, 128]), torch.Size([1, 174, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05210733413696289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06380605697631836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 174, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06088590621948242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06109809875488281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0613102912902832  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06108713150024414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1422, 40])
input nodes number: 5251
output nodes number: 1422
edges number: 7302
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.061139583587646484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06114006042480469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005976200103759766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 47 input nodes size: 6185
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005809307098388672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005809307098388672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008758544921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008769035339355469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005293846130371094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0053577423095703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0053577423095703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0053577423095703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([196, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009608745574951172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009608745574951172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 196, 128]), torch.Size([1, 196, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009795665740966797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011291027069091797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 196, 128])
m.shape torch.Size([154, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011344432830810547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011344432830810547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 154, 128]), torch.Size([1, 154, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01149129867553711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013694286346435547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 154, 128])
m.shape torch.Size([135, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013813972473144531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013813972473144531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013942718505859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016775131225585938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([100, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016901493072509766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016901493072509766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01699686050415039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019762516021728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([71, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019884109497070312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019884109497070312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019951820373535156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02238941192626953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([76, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022572994232177734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022572994232177734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02264547348022461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025762081146240234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([48, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025886058807373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025886058807373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025931835174560547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028220653533935547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([54, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028403759002685547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028403759002685547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028455257415771484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03139066696166992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([41, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031540870666503906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031540870666503906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03157997131347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03408241271972656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([520, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036542415618896484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036542415618896484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03679037094116211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.054395198822021484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 260, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.054395198822021484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.054395198822021484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05464315414428711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07212400436401367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 260, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06859779357910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06880569458007812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06901359558105469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06879520416259766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1395, 40])
input nodes number: 6185
output nodes number: 1395
edges number: 8457
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06884765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0688481330871582  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005479335784912109  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 48 input nodes size: 3870
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005289554595947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005289554595947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007134914398193359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007145404815673828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004185676574707031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004231452941894531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004231452941894531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004231452941894531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([327, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007364749908447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007364749908447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007676601409912109  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01017141342163086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([249, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010252952575683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010252952575683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 249, 128]), torch.Size([1, 249, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01049041748046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014052391052246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 249, 128])
m.shape torch.Size([191, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014206886291503906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014206886291503906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0143890380859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018396377563476562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([126, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01854562759399414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01854562759399414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 126, 128]), torch.Size([1, 126, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018665790557861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022150516510009766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 126, 128])
m.shape torch.Size([96, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022319316864013672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022319316864013672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022410869598388672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025706768035888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([57, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02582406997680664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02582406997680664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025878429412841797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028215885162353516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([57, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028378963470458984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028378963470458984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02843332290649414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031151294708251953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([48, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031307220458984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031307220458984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031352996826171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033962249755859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([39, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03410673141479492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03410673141479492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 39, 128]), torch.Size([1, 39, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034143924713134766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036524295806884766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 39, 128])
m.shape torch.Size([217, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037540435791015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037540435791015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0376434326171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.044956207275390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 108, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.044956207275390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.044956207275390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.045060157775878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05238914489746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 109, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05010271072387695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05031251907348633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0505223274230957  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05030202865600586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1407, 40])
input nodes number: 3870
output nodes number: 1407
edges number: 6028
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05034351348876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050343990325927734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0043239593505859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 49 input nodes size: 3884
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004187583923339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004187583923339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006039619445800781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006050586700439453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004194736480712891  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004245281219482422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004245281219482422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004245281219482422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([299, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007695674896240234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007695674896240234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007980823516845703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010262012481689453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([231, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010339736938476562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010339736938476562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010560035705566406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013864517211914062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([183, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014016151428222656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014016151428222656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 183, 128]), torch.Size([1, 183, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014190673828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018030166625976562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 183, 128])
m.shape torch.Size([114, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018160343170166016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018160343170166016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018269062042236328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02142190933227539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 114, 128])
m.shape torch.Size([102, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021610736846923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021610736846923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 102, 128]), torch.Size([1, 102, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021708011627197266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025209903717041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 102, 128])
m.shape torch.Size([84, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025401592254638672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025401592254638672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 84, 128]), torch.Size([1, 84, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025481700897216797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028926372528076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 84, 128])
m.shape torch.Size([68, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029113292694091797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029113292694091797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029178142547607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03242063522338867  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([35, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032521724700927734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032521724700927734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 35, 128]), torch.Size([1, 35, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03255510330200195  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03445768356323242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 35, 128])
m.shape torch.Size([34, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03458690643310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03458690643310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 34, 128]), torch.Size([1, 34, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03461933135986328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03669452667236328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 34, 128])
m.shape torch.Size([286, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03852367401123047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03852367401123047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03866004943847656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04834270477294922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 143, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04834270477294922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04834270477294922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04847908020019531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05809354782104492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 143, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0554804801940918  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055694580078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0559086799621582  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05568361282348633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1436, 40])
input nodes number: 3884
output nodes number: 1436
edges number: 6702
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05572795867919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05572843551635742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004345893859863281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 50 input nodes size: 5709
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004199028015136719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004199028015136719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006921291351318359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006932258605957031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005069255828857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005136966705322266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005136966705322266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005136966705322266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([172, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009664058685302734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009664058685302734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00982809066772461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01114034652709961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 172, 128])
m.shape torch.Size([146, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011197566986083984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011197566986083984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011336803436279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013425350189208984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([102, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013501644134521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013501644134521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 102, 128]), torch.Size([1, 102, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013598918914794922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015738964080810547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 102, 128])
m.shape torch.Size([83, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015848636627197266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015848636627197266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015927791595458984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018223285675048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([90, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018398284912109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018398284912109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018484115600585938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021574020385742188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([98, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021811485290527344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021811485290527344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021904945373535156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025923728942871094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([73, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026120662689208984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026120662689208984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02619028091430664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029671192169189453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([64, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029880523681640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029880523681640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029941558837890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033420562744140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([52, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03361320495605469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03361320495605469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03366279602050781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03683662414550781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([542, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03939628601074219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03939628601074219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 271, 128]), torch.Size([1, 271, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03965473175048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05800437927246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 271, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05800437927246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05800437927246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 271, 128]), torch.Size([1, 271, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05826282501220703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07648324966430664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 271, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07268238067626953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07289457321166992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07310676574707031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07288360595703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1422, 40])
input nodes number: 5709
output nodes number: 1422
edges number: 9051
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07293558120727539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0729360580444336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0052623748779296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 51 input nodes size: 4735
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005067348480224609  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005067348480224609  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007325172424316406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007335662841796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046024322509765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046596527099609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046596527099609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046596527099609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([209, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008498668670654297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008498668670654297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 209, 128]), torch.Size([1, 209, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008697986602783203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010292530059814453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 209, 128])
m.shape torch.Size([207, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010390281677246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010390281677246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 207, 128]), torch.Size([1, 207, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010587692260742188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013548851013183594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 207, 128])
m.shape torch.Size([137, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013646125793457031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013646125793457031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 137, 128]), torch.Size([1, 137, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013776779174804688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016651153564453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 137, 128])
m.shape torch.Size([92, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016761302947998047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016761302947998047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016849040985107422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019393444061279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([101, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019590377807617188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019590377807617188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01968669891357422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023154258728027344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([79, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02333211898803711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02333211898803711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023407459259033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026647090911865234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([60, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0268096923828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0268096923828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026866912841796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029727935791015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([52, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029897689819335938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029897689819335938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029947280883789062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03277397155761719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([40, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03292083740234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03292083740234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 40, 128]), torch.Size([1, 40, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032958984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035400390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 40, 128])
m.shape torch.Size([402, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03729820251464844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03729820251464844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 201, 128]), torch.Size([1, 201, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037489891052246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05109977722167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 201, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05109977722167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05109977722167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 201, 128]), torch.Size([1, 201, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051291465759277344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06480550765991211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 201, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06171131134033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06191682815551758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.062122344970703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06190633773803711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1379, 40])
input nodes number: 4735
output nodes number: 1379
edges number: 7597
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.061945438385009766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06194591522216797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004761219024658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 52 input nodes size: 3696
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004595756530761719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004595756530761719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006358146667480469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006369113922119141  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004100799560546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004155158996582031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004155158996582031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004155158996582031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([257, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007846355438232422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007846355438232422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 257, 128]), torch.Size([1, 257, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008091449737548828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010052204132080078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 257, 128])
m.shape torch.Size([212, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0101318359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0101318359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 212, 128]), torch.Size([1, 212, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010334014892578125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01336669921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 212, 128])
m.shape torch.Size([182, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013525962829589844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013525962829589844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013699531555175781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017518043518066406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 182, 128])
m.shape torch.Size([121, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01766204833984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01766204833984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017777442932128906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021123886108398438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([117, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021345138549804688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021345138549804688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02145671844482422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025473594665527344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([85, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025660991668701172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025660991668701172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025742053985595703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029227733612060547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 85, 128])
m.shape torch.Size([75, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029437541961669922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029437541961669922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02950906753540039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03308534622192383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([61, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03328227996826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03328227996826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0333404541015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03665637969970703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([48, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03683328628540039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03683328628540039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03687906265258789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03980875015258789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([299, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04204368591308594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04204368591308594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 149, 128]), torch.Size([1, 149, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04218578338623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05227470397949219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 149, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05227470397949219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05227470397949219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.052417755126953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06250333786010742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 150, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059639930725097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05985736846923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060074806213378906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05984640121459961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1457, 40])
input nodes number: 3696
output nodes number: 1457
edges number: 7241
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05989694595336914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059897422790527344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004265785217285156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 53 input nodes size: 3905
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004112720489501953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004112720489501953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00637054443359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006381511688232422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004608154296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004665374755859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004665374755859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004665374755859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([229, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0084991455078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0084991455078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 229, 128]), torch.Size([1, 229, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008717536926269531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010464668273925781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 229, 128])
m.shape torch.Size([171, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010518550872802734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010518550872802734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010681629180908203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013127803802490234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([144, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01325225830078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01325225830078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01338958740234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01641082763671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([127, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016584396362304688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016584396362304688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01670551300048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0202178955078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([138, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02048635482788086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02048635482788086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020617961883544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025355815887451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([92, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025553226470947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025553226470947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02564096450805664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029413700103759766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([72, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029610157012939453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029610157012939453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029678821563720703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0331120491027832  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([59, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03330278396606445  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03330278396606445  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03335905075073242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03656625747680664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03673982620239258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03673982620239258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03678464889526367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03965330123901367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([341, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04125690460205078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04125690460205078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.041419029235839844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05292987823486328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 170, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05292987823486328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05292987823486328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05309295654296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0645904541015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 171, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06154632568359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06175804138183594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.061969757080078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.061747074127197266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1420, 40])
input nodes number: 3905
output nodes number: 1420
edges number: 7562
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.061781883239746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0617823600769043  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004763126373291016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 54 input nodes size: 4560
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046024322509765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046024322509765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0067768096923828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006787300109863281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0045185089111328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004572868347167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004572868347167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004572868347167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([237, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008244514465332031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008244514465332031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 237, 128]), torch.Size([1, 237, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008470535278320312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010278701782226562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 237, 128])
m.shape torch.Size([223, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010378360748291016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010378360748291016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 223, 128]), torch.Size([1, 223, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01059103012084961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013781070709228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 223, 128])
m.shape torch.Size([144, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013880729675292969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013880729675292969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014018058776855469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01703929901123047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([118, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017195701599121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017195701599121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 118, 128]), torch.Size([1, 118, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01730823516845703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02057170867919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 118, 128])
m.shape torch.Size([108, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020772933959960938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020772933959960938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020875930786132812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024583816528320312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([87, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024781227111816406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024781227111816406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02486419677734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02843189239501953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([62, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028597354888916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028597354888916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028656482696533203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03161287307739258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([54, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031789302825927734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031789302825927734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03184080123901367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03477621078491211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([39, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03491783142089844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03491783142089844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 39, 128]), torch.Size([1, 39, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03495502471923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03733539581298828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 39, 128])
m.shape torch.Size([336, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039574623107910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039574623107910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 168, 128]), torch.Size([1, 168, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039734840393066406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051110267639160156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 168, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051110267639160156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051110267639160156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 168, 128]), torch.Size([1, 168, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051270484924316406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06256580352783203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 168, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059679508209228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05988931655883789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060099124908447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05987882614135742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1408, 40])
input nodes number: 4560
output nodes number: 1408
edges number: 7226
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0599217414855957  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059922218322753906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004675865173339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 55 input nodes size: 4000
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0045166015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0045166015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006774425506591797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006785392761230469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00460052490234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046558380126953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046558380126953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046558380126953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([236, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008374691009521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008374691009521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00859975814819336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01040029525756836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([198, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01047658920288086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01047658920288086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 198, 128]), torch.Size([1, 198, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010665416717529297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01349782943725586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 198, 128])
m.shape torch.Size([159, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013630867004394531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013630867004394531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 159, 128]), torch.Size([1, 159, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013782501220703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017118453979492188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 159, 128])
m.shape torch.Size([120, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01727151870727539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01727151870727539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01738595962524414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02070474624633789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([118, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02092885971069336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02092885971069336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 118, 128]), torch.Size([1, 118, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021041393280029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025092601776123047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 118, 128])
m.shape torch.Size([97, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025313854217529297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025313854217529297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025406360626220703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029384136199951172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([63, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029548168182373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029548168182373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02960824966430664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03261232376098633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([63, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032822608947753906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032822608947753906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0328826904296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036307334899902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([53, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03650474548339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03650474548339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03655529022216797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03979015350341797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([314, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.041262149810791016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.041262149810791016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 157, 128]), torch.Size([1, 157, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0414118766784668  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.052042484283447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 157, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.052042484283447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.052042484283447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 157, 128]), torch.Size([1, 157, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05219221115112305  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06274795532226562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 157, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059827327728271484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060039520263671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060251712799072266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0600285530090332  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1421, 40])
input nodes number: 4000
output nodes number: 1421
edges number: 7323
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06007194519042969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06007242202758789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004760265350341797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 56 input nodes size: 3436
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004602909088134766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004602909088134766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006241321563720703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006252288818359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003983497619628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0040340423583984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0040340423583984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0040340423583984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([271, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007471561431884766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007471561431884766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 271, 128]), torch.Size([1, 271, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007730007171630859  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00979757308959961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 271, 128])
m.shape torch.Size([230, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0098876953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0098876953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010107040405273438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013397216796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 230, 128])
m.shape torch.Size([172, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013533592224121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013533592224121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013697624206542969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01730632781982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 172, 128])
m.shape torch.Size([146, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017502784729003906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017502784729003906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01764202117919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02167987823486328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([110, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021872520446777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021872520446777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02197742462158203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02575397491455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([80, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025930404663085938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025930404663085938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026006698608398438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029287338256835938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([68, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029476165771484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029476165771484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029541015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03278350830078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([61, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03298377990722656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03298377990722656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033041954040527344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036357879638671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([52, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03655195236206055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03655195236206055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03660154342651367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03977537155151367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([241, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04089975357055664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04089975357055664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04101419448852539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04913949966430664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 120, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04913949966430664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04913949966430664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0492548942565918  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057390689849853516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 121, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05478525161743164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05499887466430664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05521249771118164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05498790740966797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1431, 40])
input nodes number: 3436
output nodes number: 1431
edges number: 6703
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05502605438232422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05502653121948242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004128456115722656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 57 input nodes size: 3171
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003984928131103516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003984928131103516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0062427520751953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006253719329833984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004604339599609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046520233154296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046520233154296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046520233154296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([281, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0079193115234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0079193115234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 281, 128]), torch.Size([1, 281, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008187294006347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010331153869628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 281, 128])
m.shape torch.Size([252, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010437488555908203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010437488555908203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 252, 128]), torch.Size([1, 252, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010677814483642578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014282703399658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 252, 128])
m.shape torch.Size([189, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014432907104492188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014432907104492188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 189, 128]), torch.Size([1, 189, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014613151550292969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018578529357910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 189, 128])
m.shape torch.Size([150, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01877450942993164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01877450942993164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018917560577392578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023066043853759766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 150, 128])
m.shape torch.Size([105, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023244857788085938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023244857788085938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023344993591308594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02694988250732422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([78, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027122974395751953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027122974395751953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02719736099243164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030395984649658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([74, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030605792999267578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030605792999267578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03067636489868164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034204959869384766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([44, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034337520599365234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034337520599365234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 44, 128]), torch.Size([1, 44, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03437948226928711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036771297454833984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 44, 128])
m.shape torch.Size([43, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036934852600097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036934852600097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 43, 128]), torch.Size([1, 43, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036975860595703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039600372314453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 43, 128])
m.shape torch.Size([214, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04060029983520508  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04060029983520508  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 107, 128]), torch.Size([1, 107, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04070234298706055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04794740676879883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 107, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04794740676879883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04794740676879883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 107, 128]), torch.Size([1, 107, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0480494499206543  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055243492126464844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 107, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05281639099121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.053029537200927734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05324268341064453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05301856994628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1430, 40])
input nodes number: 3171
output nodes number: 1430
edges number: 6342
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05305290222167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05305337905883789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0047397613525390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 58 input nodes size: 3423
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004603862762451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004603862762451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006236076354980469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006247043609619141  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003978252410888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004035472869873047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004035472869873047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004035472869873047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([229, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00787496566772461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00787496566772461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 229, 128]), torch.Size([1, 229, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00809335708618164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00984048843383789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 229, 128])
m.shape torch.Size([217, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009938240051269531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009938240051269531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 217, 128]), torch.Size([1, 217, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010145187377929688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013249397277832031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 217, 128])
m.shape torch.Size([155, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013367652893066406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013367652893066406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 155, 128]), torch.Size([1, 155, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013515472412109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016767501831054688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 155, 128])
m.shape torch.Size([134, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016949176788330078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016949176788330078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 134, 128]), torch.Size([1, 134, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017076969146728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020782947540283203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 134, 128])
m.shape torch.Size([121, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021007537841796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021007537841796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02112293243408203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025277137756347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([100, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025505542755126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025505542755126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025600910186767578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029701709747314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([53, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0298309326171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0298309326171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02988147735595703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032408714294433594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([59, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0326085090637207  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0326085090637207  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03266477584838867  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03587198257446289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([58, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03609275817871094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03609275817871094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 58, 128]), torch.Size([1, 58, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0361480712890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0396881103515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 58, 128])
m.shape torch.Size([334, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.041918277740478516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.041918277740478516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04207754135131836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.053385257720947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 167, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.053385257720947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.053385257720947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05354452133178711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0647726058959961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 167, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.061743736267089844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06196165084838867  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0621795654296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06195068359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1460, 40])
input nodes number: 3423
output nodes number: 1460
edges number: 7574
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06199216842651367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.061992645263671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004139900207519531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 59 input nodes size: 2703
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003983020782470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003983020782470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0062408447265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006251335144042969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004608154296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004652976989746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004652976989746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004652976989746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([303, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0077362060546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0077362060546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 303, 128]), torch.Size([1, 303, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008025169372558594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010336875915527344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 303, 128])
m.shape torch.Size([234, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01041555404663086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01041555404663086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010638713836669922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01398611068725586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 234, 128])
m.shape torch.Size([181, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014133453369140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014133453369140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014306068420410156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018103599548339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 181, 128])
m.shape torch.Size([136, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018276691436767578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018276691436767578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018406391143798828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022167682647705078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([117, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02238178253173828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02238178253173828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022493362426757812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026510238647460938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([86, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026700496673583984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026700496673583984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 86, 128]), torch.Size([1, 86, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026782512664794922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030309200286865234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 86, 128])
m.shape torch.Size([60, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030468463897705078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030468463897705078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030525684356689453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0333867073059082  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([58, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033579349517822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033579349517822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 58, 128]), torch.Size([1, 58, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03363466262817383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03678750991821289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 58, 128])
m.shape torch.Size([45, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036952972412109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036952972412109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 45, 128]), torch.Size([1, 45, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036995887756347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039742469787597656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 45, 128])
m.shape torch.Size([170, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04053163528442383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04053163528442383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04061269760131836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04636812210083008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 85, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04636812210083008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04636812210083008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04644918441772461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05216407775878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 85, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04991865158081055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050126075744628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050333499908447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05011558532714844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1390, 40])
input nodes number: 2703
output nodes number: 1390
edges number: 5948
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05013608932495117  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050136566162109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004723548889160156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 60 input nodes size: 2925
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004597663879394531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004597663879394531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005992412567138672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006002902984619141  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003734588623046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003780364990234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003780364990234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003780364990234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([296, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006927013397216797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006927013397216797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 296, 128]), torch.Size([1, 296, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007209300994873047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009467601776123047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 296, 128])
m.shape torch.Size([255, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009569644927978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009569644927978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00981283187866211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013460636138916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 255, 128])
m.shape torch.Size([171, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013583660125732422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013583660125732422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01374673843383789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017334461212158203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([162, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017561912536621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017561912536621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 162, 128]), torch.Size([1, 162, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017716407775878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02219676971435547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 162, 128])
m.shape torch.Size([95, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022346019744873047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022346019744873047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02243661880493164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025698184967041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([73, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025861740112304688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025861740112304688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025931358337402344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028924942016601562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([69, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029120445251464844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029120445251464844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029186248779296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03247642517089844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([43, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0326075553894043  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0326075553894043  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 43, 128]), torch.Size([1, 43, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032648563385009766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034986019134521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 43, 128])
m.shape torch.Size([45, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035158634185791016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035158634185791016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 45, 128]), torch.Size([1, 45, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0352015495300293  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0379481315612793  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 45, 128])
m.shape torch.Size([197, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03886604309082031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03886604309082031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038959503173828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04559516906738281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 98, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04559516906738281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04559516906738281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04568958282470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.052346229553222656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 99, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050035953521728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05024576187133789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050455570220947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05023527145385742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1406, 40])
input nodes number: 2925
output nodes number: 1406
edges number: 6082
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05027008056640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05027055740356445  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038661956787109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 61 input nodes size: 4561
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0037369728088378906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0037369728088378906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0059947967529296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006005764007568359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00460052490234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004665374755859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004665374755859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004665374755859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([156, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00895833969116211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00895833969116211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009107112884521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010297298431396484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 156, 128])
m.shape torch.Size([151, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01036691665649414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01036691665649414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010510921478271484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01267099380493164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([149, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012812137603759766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012812137603759766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 149, 128]), torch.Size([1, 149, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012954235076904297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016080379486083984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 149, 128])
m.shape torch.Size([116, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01623058319091797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01623058319091797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016341209411621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01954936981201172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([109, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01975393295288086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01975393295288086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01985788345336914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023600101470947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 109, 128])
m.shape torch.Size([73, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023756980895996094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023756980895996094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02382659912109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02682018280029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([64, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02699899673461914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02699899673461914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02706003189086914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03011178970336914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([63, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030321598052978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030321598052978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03038167953491211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03380632400512695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([50, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03399085998535156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03399085998535156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034038543701171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037090301513671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([483, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03936958312988281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03936958312988281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 241, 128]), torch.Size([1, 241, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03959941864013672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05591773986816406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 241, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05591773986816406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05591773986816406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 242, 128]), torch.Size([1, 242, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.056148529052734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07241964340209961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 242, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06885242462158203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06906318664550781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0692739486694336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06905221939086914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1414, 40])
input nodes number: 4561
output nodes number: 1414
edges number: 8584
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06909847259521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06909894943237305  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004782199859619141  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 62 input nodes size: 2339
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004601478576660156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004601478576660156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005716800689697266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0057277679443359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0034589767456054688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0035152435302734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0035152435302734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0035152435302734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([225, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007289409637451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007289409637451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 225, 128]), torch.Size([1, 225, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007503986358642578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009220600128173828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 225, 128])
m.shape torch.Size([224, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009326934814453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009326934814453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 224, 128]), torch.Size([1, 224, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009540557861328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012744903564453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 224, 128])
m.shape torch.Size([144, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012844085693359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012981414794921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016002655029296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([127, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016176223754882812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016176223754882812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016297340393066406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019809722900390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([103, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019994735717773438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019994735717773438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02009296417236328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023629188537597656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([75, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02379465103149414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02379465103149414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02386617660522461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026941776275634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([79, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02716970443725586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02716970443725586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027245044708251953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03101205825805664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([58, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031195640563964844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031195640563964844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 58, 128]), torch.Size([1, 58, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031250953674316406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03440380096435547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 58, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03459501266479492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03459501266479492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03464365005493164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03775644302368164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([339, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03998994827270508  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03998994827270508  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 169, 128]), torch.Size([1, 169, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040151119232177734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05159425735473633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 169, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05159425735473633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05159425735473633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05175638198852539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0631866455078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 170, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06020212173461914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060414791107177734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06062746047973633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06040382385253906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1425, 40])
input nodes number: 2339
output nodes number: 1425
edges number: 7444
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06043434143066406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060434818267822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0036077499389648438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 63 input nodes size: 2739
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0034608840942382812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0034608840942382812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005718708038330078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00572967529296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004603385925292969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004645347595214844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004645347595214844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004645347595214844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([326, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007588863372802734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007588863372802734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007899761199951172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010386943817138672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([252, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010471820831298828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010471820831298828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 252, 128]), torch.Size([1, 252, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010712146759033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014317035675048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 252, 128])
m.shape torch.Size([205, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014490127563476562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014490127563476562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014685630798339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01898670196533203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 205, 128])
m.shape torch.Size([167, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019207477569580078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019207477569580078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019366741180419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02398538589477539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 167, 128])
m.shape torch.Size([137, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02423238754272461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02423238754272461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 137, 128]), torch.Size([1, 137, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024363040924072266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02906656265258789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 137, 128])
m.shape torch.Size([72, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029207229614257812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029207229614257812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029275894165039062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03222846984863281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([50, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03236103057861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03236103057861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032408714294433594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03479290008544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([55, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03497886657714844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03497886657714844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03503131866455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038021087646484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([33, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03813648223876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03813648223876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 33, 128]), torch.Size([1, 33, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03816795349121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04018211364746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 33, 128])
m.shape torch.Size([131, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04079103469848633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04079103469848633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040853023529052734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04525423049926758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 65, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04525423049926758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04525423049926758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04531717300415039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.049755096435546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes
[03:22:59] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14284864 edges into 64 parts and get 4136559 edge cuts

rst 1 shape torch.Size([1, 66, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.047686100006103516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04789924621582031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04811239242553711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04788827896118164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1428, 40])
input nodes number: 2739
output nodes number: 1428
edges number: 5627
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04792022705078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04792070388793945  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004724979400634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004724979400634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004724979400634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00344206765294075 |0.000369146466255188 |0.0380605049431324 |8.83340835571289e-05 |0.018948465585708618 |0.0017316341400146484 |
----------------------------------------------------------pseudo_mini_loss sum 3.2689828872680664
Total (block generation + training)time/epoch 13.980085611343384
* Pure training time/epoch 3.899876832962036
Training time/epoch 4.176467657089233
Training time without block to device /epoch 4.152842283248901
Training time without total dataloading part /epoch 3.655959129333496
load block tensor time/epoch 0.220292329788208
block to device time/epoch 0.02362537384033203
input features size transfer per epoch 8.58306884765625e-06
blocks size to device per epoch 5.7220458984375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  268501
Number of first layer input nodes during this epoch:  268501
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0047245025634765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019332170486450195
global_2_local spend time (sec) 0.04042935371398926
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003309011459350586
A = g.adjacency_matrix() spent  0.007008075714111328
auxiliary_graph
Graph(num_nodes=145027, num_edges=14375805,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08020949363708496
remove nodes length
54086
auxiliary_graph.remove_nodes spent  0.6708109378814697
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14375805,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.694659948348999

the counter of shared neighbor distribution
Counter({1.0: 12899956, 2.0: 1173186, 3.0: 165808, 4.0: 33362, 5.0: 8940, 6.0: 2608, 7.0: 762, 8.0: 204, 9.0: 36, 10.0: 2})
14284864
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14284861, 14284862, 14284863])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12899956, 2.0: 1173186, 3.0: 165808, 4.0: 33362, 5.0: 8940, 6.0: 2608, 7.0: 762, 8.0: 204, 9.0: 36, 10.0: 2})
Convert a graph into a bidirected graph: 0.604 seconds
Metis partitioning: 2.981 seconds
Split the graph: 0.310 seconds
Construct subgraphs: 0.094 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  3.99538254737854
1451
1446
1412
1454
1437
1452
1443
1459
1379
1392
1411
1427
1394
1404
1408
1433
1445
1444
1460
1458
1463
1423
1444
1446
1436
1445
1449
1449
1416
1431
1379
1459
1379
1379
1395
1401
1426
1398
1382
1463
1379
1392
1379
1401
1463
1392
1391
1379
1407
1449
1404
1379
1439
1379
1386
1405
1413
1423
1450
1444
1416
1418
1440
1441
total k batches seeds list generation spend  9.156216621398926
after graph partition
graph partition algorithm spend time 9.239028215408325
1451
1446
1412
1454
1437
1452
1443
1459
1379
1392
1411
1427
1394
1404
1408
1433
1445
1444
1460
1458
1463
1423
1444
1446
1436
1445
1449
1449
1416
1431
1379
1459
1379
1379
1395
1401
1426
1398
1382
1463
1379
1392
1379
1401
1463
1392
1391
1379
1407
1449
1404
1379
1439
1379
1386
1405
1413
1423
1450
1444
1416
1418
1440
1441
partition_len_list
[3204, 3182, 3101, 3357, 2712, 2787, 2906, 2935, 3840, 3371, 4234, 3441, 3570, 3835, 3109, 2689, 2849, 2926, 2697, 2759, 4037, 2941, 3550, 2913, 3886, 3311, 3778, 3498, 4277, 4303, 3535, 3379, 6771, 6315, 6024, 5199, 5750, 6084, 6084, 7476, 6399, 6419, 6970, 6672, 7185, 6070, 7206, 6441, 3300, 3839, 3340, 4235, 5847, 4787, 3446, 4102, 2322, 2850, 3152, 3775, 2882, 4275, 3344, 3201]
shared_neighbor_graph_partition_s0 selection method  spend 9.335363388061523
time for parepare:  0.01701951026916504
local_output_nid generation:  0.00041604042053222656
local_in_edges_tensor generation:  0.0006320476531982422
mini_batch_src_global generation:  0.0005080699920654297
r_  generation:  0.0029947757720947266
local_output_nid generation:  0.0004024505615234375
local_in_edges_tensor generation:  0.00048828125
mini_batch_src_global generation:  0.00041675567626953125
r_  generation:  0.0027074813842773438
local_output_nid generation:  0.0004279613494873047
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.00033354759216308594
r_  generation:  0.0026547908782958984
local_output_nid generation:  0.00042629241943359375
local_in_edges_tensor generation:  0.00045800209045410156
mini_batch_src_global generation:  0.0003540515899658203
r_  generation:  0.0030241012573242188
local_output_nid generation:  0.00043129920959472656
local_in_edges_tensor generation:  0.0004379749298095703
mini_batch_src_global generation:  0.0002875328063964844
r_  generation:  0.002119302749633789
local_output_nid generation:  0.0004355907440185547
local_in_edges_tensor generation:  0.00044083595275878906
mini_batch_src_global generation:  0.00032782554626464844
r_  generation:  0.002953767776489258
local_output_nid generation:  0.00044345855712890625
local_in_edges_tensor generation:  0.0004260540008544922
mini_batch_src_global generation:  0.0003452301025390625
r_  generation:  0.0029153823852539062
local_output_nid generation:  0.0004494190216064453
local_in_edges_tensor generation:  0.0004298686981201172
mini_batch_src_global generation:  0.000347137451171875
r_  generation:  0.0028066635131835938
local_output_nid generation:  0.00042819976806640625
local_in_edges_tensor generation:  0.00040149688720703125
mini_batch_src_global generation:  0.0003330707550048828
r_  generation:  0.0026547908782958984
local_output_nid generation:  0.0004410743713378906
local_in_edges_tensor generation:  0.00044918060302734375
mini_batch_src_global generation:  0.009227514266967773
r_  generation:  0.0028862953186035156
local_output_nid generation:  0.0005316734313964844
local_in_edges_tensor generation:  0.00044274330139160156
mini_batch_src_global generation:  0.0003848075866699219
r_  generation:  0.002977609634399414
local_output_nid generation:  0.0005362033843994141
local_in_edges_tensor generation:  0.0004329681396484375
mini_batch_src_global generation:  0.0003554821014404297
r_  generation:  0.0029261112213134766
local_output_nid generation:  0.0005121231079101562
local_in_edges_tensor generation:  0.00042366981506347656
mini_batch_src_global generation:  0.0003387928009033203
r_  generation:  0.002803325653076172
local_output_nid generation:  0.0005679130554199219
local_in_edges_tensor generation:  0.0004546642303466797
mini_batch_src_global generation:  0.00036525726318359375
r_  generation:  0.0027527809143066406
local_output_nid generation:  0.0005602836608886719
local_in_edges_tensor generation:  0.00041604042053222656
mini_batch_src_global generation:  0.000293731689453125
r_  generation:  0.0020318031311035156
local_output_nid generation:  0.0006215572357177734
local_in_edges_tensor generation:  0.00044846534729003906
mini_batch_src_global generation:  0.00029850006103515625
r_  generation:  0.0023953914642333984
local_output_nid generation:  0.0005793571472167969
local_in_edges_tensor generation:  0.00041985511779785156
mini_batch_src_global generation:  0.0003230571746826172
r_  generation:  0.0025932788848876953
local_output_nid generation:  0.0005731582641601562
local_in_edges_tensor generation:  0.00041794776916503906
mini_batch_src_global generation:  0.00033545494079589844
r_  generation:  0.0027573108673095703
local_output_nid generation:  0.0005831718444824219
local_in_edges_tensor generation:  0.0004482269287109375
mini_batch_src_global generation:  0.0003075599670410156
r_  generation:  0.002270221710205078
local_output_nid generation:  0.0005729198455810547
local_in_edges_tensor generation:  0.0004277229309082031
mini_batch_src_global generation:  0.0002892017364501953
r_  generation:  0.002327442169189453
local_output_nid generation:  0.0005490779876708984
local_in_edges_tensor generation:  0.0004189014434814453
mini_batch_src_global generation:  0.0003867149353027344
r_  generation:  0.0024526119232177734
local_output_nid generation:  0.0005466938018798828
local_in_edges_tensor generation:  0.000408172607421875
mini_batch_src_global generation:  0.0002865791320800781
r_  generation:  0.002319812774658203
local_output_nid generation:  0.0005359649658203125
local_in_edges_tensor generation:  0.00041174888610839844
mini_batch_src_global generation:  0.0003235340118408203
r_  generation:  0.0027332305908203125
local_output_nid generation:  0.0005333423614501953
local_in_edges_tensor generation:  0.0004115104675292969
mini_batch_src_global generation:  0.00028443336486816406
r_  generation:  0.0023190975189208984
local_output_nid generation:  0.0005171298980712891
local_in_edges_tensor generation:  0.0004029273986816406
mini_batch_src_global generation:  0.0003120899200439453
r_  generation:  0.0025353431701660156
local_output_nid generation:  0.0005261898040771484
local_in_edges_tensor generation:  0.00040149688720703125
mini_batch_src_global generation:  0.0003733634948730469
r_  generation:  0.0028047561645507812
local_output_nid generation:  0.0005266666412353516
local_in_edges_tensor generation:  0.0004105567932128906
mini_batch_src_global generation:  0.0003256797790527344
r_  generation:  0.0025861263275146484
local_output_nid generation:  0.0005273818969726562
local_in_edges_tensor generation:  0.00040602684020996094
mini_batch_src_global generation:  0.0002930164337158203
r_  generation:  0.0025119781494140625
local_output_nid generation:  0.0004951953887939453
local_in_edges_tensor generation:  0.000400543212890625
mini_batch_src_global generation:  0.0003218650817871094
r_  generation:  0.002652406692504883
local_output_nid generation:  0.0005066394805908203
local_in_edges_tensor generation:  0.00043463706970214844
mini_batch_src_global generation:  0.0003578662872314453
r_  generation:  0.00286102294921875
local_output_nid generation:  0.0005135536193847656
local_in_edges_tensor generation:  0.0004036426544189453
mini_batch_src_global generation:  0.00033664703369140625
r_  generation:  0.00249481201171875
local_output_nid generation:  0.0005426406860351562
local_in_edges_tensor generation:  0.0004570484161376953
mini_batch_src_global generation:  0.00034165382385253906
r_  generation:  0.0028731822967529297
local_output_nid generation:  0.0005185604095458984
local_in_edges_tensor generation:  0.000415802001953125
mini_batch_src_global generation:  0.00038814544677734375
r_  generation:  0.0028896331787109375
local_output_nid generation:  0.0005214214324951172
local_in_edges_tensor generation:  0.00042176246643066406
mini_batch_src_global generation:  0.00047326087951660156
r_  generation:  0.0035343170166015625
local_output_nid generation:  0.0005767345428466797
local_in_edges_tensor generation:  0.00046253204345703125
mini_batch_src_global generation:  0.0003802776336669922
r_  generation:  0.00240325927734375
local_output_nid generation:  0.0005860328674316406
local_in_edges_tensor generation:  0.00043392181396484375
mini_batch_src_global generation:  0.0003380775451660156
r_  generation:  0.002489805221557617
local_output_nid generation:  0.0005822181701660156
local_in_edges_tensor generation:  0.0004317760467529297
mini_batch_src_global generation:  0.0003635883331298828
r_  generation:  0.0028629302978515625
local_output_nid generation:  0.0005707740783691406
local_in_edges_tensor generation:  0.00042629241943359375
mini_batch_src_global generation:  0.0004107952117919922
r_  generation:  0.0027878284454345703
local_output_nid generation:  0.000591278076171875
local_in_edges_tensor generation:  0.00042891502380371094
mini_batch_src_global generation:  0.00036787986755371094
r_  generation:  0.0024797916412353516
local_output_nid generation:  0.0005717277526855469
local_in_edges_tensor generation:  0.00044608116149902344
mini_batch_src_global generation:  0.00038886070251464844
r_  generation:  0.003107786178588867
local_output_nid generation:  0.0005450248718261719
local_in_edges_tensor generation:  0.0004487037658691406
mini_batch_src_global generation:  0.0003809928894042969
r_  generation:  0.0029976367950439453
local_output_nid generation:  0.0005412101745605469
local_in_edges_tensor generation:  0.0004582405090332031
mini_batch_src_global generation:  0.00037741661071777344
r_  generation:  0.002801656723022461
local_output_nid generation:  0.0005340576171875
local_in_edges_tensor generation:  0.00041604042053222656
mini_batch_src_global generation:  0.0003724098205566406
r_  generation:  0.002964019775390625
local_output_nid generation:  0.0005345344543457031
local_in_edges_tensor generation:  0.0004208087921142578
mini_batch_src_global generation:  0.00036072731018066406
r_  generation:  0.003011941909790039
local_output_nid generation:  0.0005483627319335938
local_in_edges_tensor generation:  0.00046253204345703125
mini_batch_src_global generation:  0.00042819976806640625
r_  generation:  0.0034868717193603516
local_output_nid generation:  0.0005340576171875
local_in_edges_tensor generation:  0.00039839744567871094
mini_batch_src_global generation:  0.000354766845703125
r_  generation:  0.002714872360229492
local_output_nid generation:  0.0005373954772949219
local_in_edges_tensor generation:  0.00044846534729003906
mini_batch_src_global generation:  0.0003933906555175781
r_  generation:  0.0031785964965820312
local_output_nid generation:  0.0005548000335693359
local_in_edges_tensor generation:  0.0004372596740722656
mini_batch_src_global generation:  0.0004107952117919922
r_  generation:  0.0034825801849365234
local_output_nid generation:  0.0006086826324462891
local_in_edges_tensor generation:  0.0004627704620361328
mini_batch_src_global generation:  0.00031495094299316406
r_  generation:  0.0022530555725097656
local_output_nid generation:  0.0006306171417236328
local_in_edges_tensor generation:  0.0005142688751220703
mini_batch_src_global generation:  0.0003478527069091797
r_  generation:  0.0026862621307373047
local_output_nid generation:  0.0005886554718017578
local_in_edges_tensor generation:  0.00043845176696777344
mini_batch_src_global generation:  0.0003056526184082031
r_  generation:  0.0022029876708984375
local_output_nid generation:  0.0006017684936523438
local_in_edges_tensor generation:  0.0004379749298095703
mini_batch_src_global generation:  0.0003027915954589844
r_  generation:  0.0022721290588378906
local_output_nid generation:  0.0005939006805419922
local_in_edges_tensor generation:  0.00045490264892578125
mini_batch_src_global generation:  0.0003955364227294922
r_  generation:  0.002855062484741211
local_output_nid generation:  0.0005617141723632812
local_in_edges_tensor generation:  0.0003955364227294922
mini_batch_src_global generation:  0.0003390312194824219
r_  generation:  0.002380847930908203
local_output_nid generation:  0.0005342960357666016
local_in_edges_tensor generation:  0.0004000663757324219
mini_batch_src_global generation:  0.0002570152282714844
r_  generation:  0.002159595489501953
local_output_nid generation:  0.0005340576171875
local_in_edges_tensor generation:  0.0004792213439941406
mini_batch_src_global generation:  0.0003123283386230469
r_  generation:  0.0024476051330566406
local_output_nid generation:  0.0005421638488769531
local_in_edges_tensor generation:  0.00038814544677734375
mini_batch_src_global generation:  0.0002846717834472656
r_  generation:  0.002376556396484375
local_output_nid generation:  0.0005233287811279297
local_in_edges_tensor generation:  0.0003979206085205078
mini_batch_src_global generation:  0.000244140625
r_  generation:  0.0020554065704345703
local_output_nid generation:  0.0005204677581787109
local_in_edges_tensor generation:  0.00039005279541015625
mini_batch_src_global generation:  0.00025916099548339844
r_  generation:  0.0022318363189697266
local_output_nid generation:  0.0005161762237548828
local_in_edges_tensor generation:  0.0003986358642578125
mini_batch_src_global generation:  0.00027298927307128906
r_  generation:  0.0022788047790527344
local_output_nid generation:  0.0004899501800537109
local_in_edges_tensor generation:  0.00037789344787597656
mini_batch_src_global generation:  0.0002617835998535156
r_  generation:  0.002268075942993164
local_output_nid generation:  0.0005016326904296875
local_in_edges_tensor generation:  0.0004189014434814453
mini_batch_src_global generation:  0.00033402442932128906
r_  generation:  0.002386331558227539
local_output_nid generation:  0.00048160552978515625
local_in_edges_tensor generation:  0.00039768218994140625
mini_batch_src_global generation:  0.0002818107604980469
r_  generation:  0.002386331558227539
local_output_nid generation:  0.0004830360412597656
local_in_edges_tensor generation:  0.0003998279571533203
mini_batch_src_global generation:  0.0002474784851074219
r_  generation:  0.0020296573638916016
----------------------check_connections_block total spend ----------------------------- 0.33731698989868164
generate_one_block  0.00911402702331543
generate_one_block  0.005588531494140625
generate_one_block  0.00498652458190918
generate_one_block  0.005300760269165039
generate_one_block  0.00390934944152832
generate_one_block  0.004837751388549805
generate_one_block  0.004701137542724609
generate_one_block  0.0045011043548583984
generate_one_block  0.004619121551513672
generate_one_block  0.004573822021484375
generate_one_block  0.004916191101074219
generate_one_block  0.009258270263671875
generate_one_block  0.004741668701171875
generate_one_block  0.004387378692626953
generate_one_block  0.003393888473510742
generate_one_block  0.003657817840576172
generate_one_block  0.004164934158325195
generate_one_block  0.00392603874206543
generate_one_block  0.0037050247192382812
generate_one_block  0.0037679672241210938
generate_one_block  0.004236936569213867
generate_one_block  0.003717184066772461
generate_one_block  0.004373311996459961
generate_one_block  0.003721952438354492
generate_one_block  0.0043849945068359375
generate_one_block  0.004540681838989258
generate_one_block  0.004325389862060547
generate_one_block  0.007196903228759766
generate_one_block  0.004639387130737305
generate_one_block  0.0047185420989990234
generate_one_block  0.004149198532104492
generate_one_block  0.0046503543853759766
generate_one_block  0.00549626350402832
generate_one_block  0.005658149719238281
generate_one_block  0.004681110382080078
generate_one_block  0.004476308822631836
generate_one_block  0.004941463470458984
generate_one_block  0.00536346435546875
generate_one_block  0.005077838897705078
generate_one_block  0.005857229232788086
generate_one_block  0.005235433578491211
generate_one_block  0.004930019378662109
generate_one_block  0.005265712738037109
generate_one_block  0.005163908004760742
generate_one_block  0.005997896194458008
generate_one_block  0.004744529724121094
generate_one_block  0.005500078201293945
generate_one_block  0.005301952362060547
generate_one_block  0.003385305404663086
generate_one_block  0.004275798797607422
generate_one_block  0.003567218780517578
generate_one_block  0.004094123840332031
generate_one_block  0.005507469177246094
generate_one_block  0.00440669059753418
generate_one_block  0.003695249557495117
generate_one_block  0.004114627838134766
generate_one_block  0.003947734832763672
generate_one_block  0.003620624542236328
generate_one_block  0.0040683746337890625
generate_one_block  0.004334211349487305
generate_one_block  0.003969907760620117
generate_one_block  0.004441499710083008
generate_one_block  0.004188060760498047
generate_one_block  0.003743886947631836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0047245025634765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

connection checking time:  0.33731698989868164
block generation total time  0.3017582893371582
average batch blocks generation time:  0.004714973270893097
block dataloader generation time/epoch 9.933511972427368
pseudo mini batch 0 input nodes size: 3204
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004602909088134766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004602909088134766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006130695343017578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00614166259765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038728713989257812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003945350646972656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003945350646972656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003945350646972656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([115, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008728504180908203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008728504180908203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 115, 128]), torch.Size([1, 115, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008838176727294922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009715557098388672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 115, 128])
m.shape torch.Size([126, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0097808837890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0097808837890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 126, 128]), torch.Size([1, 126, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009901046752929688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0117034912109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 126, 128])
m.shape torch.Size([114, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011806488037109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011806488037109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011915206909179688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014307022094726562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 114, 128])
m.shape torch.Size([100, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014443397521972656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014443397521972656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014538764953613281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017304420471191406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([108, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01751422882080078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01751422882080078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017617225646972656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021325111389160156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([109, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021585464477539062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021585464477539062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021689414978027344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026159286499023438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 109, 128])
m.shape torch.Size([93, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02641773223876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02641773223876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 93, 128]), torch.Size([1, 93, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026506423950195312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030941009521484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 93, 128])
m.shape torch.Size([60, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031125545501708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031125545501708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03118276596069336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034444332122802734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([53, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03464317321777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03464317321777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03469371795654297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03792858123779297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([573, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04063558578491211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04063558578491211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 286, 128]), torch.Size([1, 286, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0409083366394043  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06027364730834961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 286, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06027364730834961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06027364730834961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 287, 128]), torch.Size([1, 287, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0605473518371582  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07984399795532227  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 287, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07577085494995117  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07598733901977539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07620382308959961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07597637176513672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1451, 40])
input nodes number: 3204
output nodes number: 1451
edges number: 9641
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07601499557495117  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07601594924926758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004063129425048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 1 input nodes size: 3182
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038771629333496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038771629333496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006134986877441406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006145954132080078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004607200622558594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004669189453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004669189453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004669189453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([175, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008786678314208984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008786678314208984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 175, 128]), torch.Size([1, 175, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008953571319580078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010288715362548828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 175, 128])
m.shape torch.Size([175, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010372161865234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010372161865234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 175, 128]), torch.Size([1, 175, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010539054870605469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013042449951171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 175, 128])
m.shape torch.Size([155, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013180732727050781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013180732727050781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 155, 128]), torch.Size([1, 155, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01332855224609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016580581665039062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 155, 128])
m.shape torch.Size([132, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016758441925048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016758441925048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 132, 128]), torch.Size([1, 132, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016884326934814453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020534992218017578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 132, 128])
m.shape torch.Size([109, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02073192596435547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02073192596435547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02083587646484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024578094482421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 109, 128])
m.shape torch.Size([106, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024829387664794922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024829387664794922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024930477142333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029277324676513672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 106, 128])
m.shape torch.Size([81, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029497146606445312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029497146606445312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02957439422607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03343677520751953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([75, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03368425369262695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03368425369262695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03375577926635742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03783273696899414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([48, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038002967834472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038002967834472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038048744201660156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040978431701660156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([390, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042815208435058594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042815208435058594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 195, 128]), torch.Size([1, 195, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04300117492675781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.056204795837402344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 195, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.056204795837402344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.056204795837402344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 195, 128]), torch.Size([1, 195, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05639076232910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06950139999389648  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 195, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06615352630615234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06636905670166016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06658458709716797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06635808944702148  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1446, 40])
input nodes number: 3182
output nodes number: 1446
edges number: 8198
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0663919448852539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06639242172241211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004770755767822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 2 input nodes size: 3101
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046062469482421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046062469482421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006084918975830078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00609588623046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038270950317382812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038862228393554688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038862228393554688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038862228393554688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([173, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007847785949707031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007847785949707031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008012771606445312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009332656860351562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 173, 128])
m.shape torch.Size([177, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009418964385986328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009418964385986328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 177, 128]), torch.Size([1, 177, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009587764739990234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012119770050048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 177, 128])
m.shape torch.Size([170, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012278556823730469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012278556823730469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012440681457519531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016007423400878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 170, 128])
m.shape torch.Size([119, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016153335571289062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016153335571289062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016266822814941406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019557952880859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([123, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019794464111328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019794464111328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019911766052246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02413463592529297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([91, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02433633804321289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02433633804321289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02442312240600586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028154850006103516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([71, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028348445892333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028348445892333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028416156768798828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031801700592041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([56, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031981468200683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031981468200683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 56, 128]), torch.Size([1, 56, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032034873962402344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035079002380371094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 56, 128])
m.shape torch.Size([52, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03527545928955078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03527545928955078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035325050354003906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038498878479003906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([380, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04073190689086914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04073190689086914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04091310501098633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05377817153930664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 190, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05377817153930664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05377817153930664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05395936965942383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06673383712768555  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 190, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06352424621582031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0637350082397461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06394577026367188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06372404098510742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1412, 40])
input nodes number: 3101
output nodes number: 1412
edges number: 7887
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06375360488891602  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06375408172607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0039806365966796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 3 input nodes size: 3357
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00382232666015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00382232666015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006080150604248047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006091117858886719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004601478576660156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004672050476074219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004672050476074219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004672050476074219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([138, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009380817413330078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009380817413330078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00951242446899414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01056528091430664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([125, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01061868667602539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01061868667602539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010737895965576172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01252603530883789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([142, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012669563293457031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012669563293457031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012804985046386719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015784263610839844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 142, 128])
m.shape torch.Size([109, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015924453735351562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015924453735351562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016028404235839844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01904296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 109, 128])
m.shape torch.Size([95, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019217491149902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019217491149902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019308090209960938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022569656372070312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([80, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022753238677978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022753238677978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022829532623291016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026110172271728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([71, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02630901336669922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02630901336669922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026376724243164062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02976226806640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([64, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029972553253173828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029972553253173828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030033588409423828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03351259231567383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([54, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03371381759643555  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03371381759643555  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033765316009521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037061214447021484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([576, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039782047271728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039782047271728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040056705474853516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059557437896728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 288, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059557437896728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059557437896728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059832096099853516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07919549942016602  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 288, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07520675659179688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0754237174987793  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07564067840576172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07541275024414062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1454, 40])
input nodes number: 3357
output nodes number: 1454
edges number: 9460
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0754551887512207  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0754556655883789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004790782928466797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 4 input nodes size: 2712
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004607677459716797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004607677459716797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005900859832763672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005911827087402344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003643035888671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0036869049072265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0036869049072265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0036869049072265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([321, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006739616394042969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006739616394042969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007045745849609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009494781494140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([269, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009598255157470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009598255157470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009854793548583984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013702869415283203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([197, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01385641098022461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01385641098022461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01404428482055664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018177509307861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([148, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018365859985351562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018365859985351562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 148, 128]), torch.Size([1, 148, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018507003784179688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022600173950195312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 148, 128])
m.shape torch.Size([119, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02281332015991211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02281332015991211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022926807403564453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027012348175048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([69, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02715301513671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02715301513671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02721881866455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030048370361328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([63, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030225753784179688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030225753784179688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03028583526611328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03328990936279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([52, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03345823287963867  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03345823287963867  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0335078239440918  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03633451461791992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([41, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03648567199707031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03648567199707031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03652477264404297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03902721405029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([158, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03976106643676758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03976106643676758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03983640670776367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04518556594848633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 79, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04518556594848633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04518556594848633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04526090621948242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05057239532470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 79, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04839181900024414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04860639572143555  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04882097244262695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.048595428466796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1437, 40])
input nodes number: 2712
output nodes number: 1437
edges number: 5857
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.048624515533447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04862499237060547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003765583038330078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 5 input nodes size: 2787
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0036406517028808594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0036406517028808594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005898475646972656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005909442901611328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004605293273925781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004675865173339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004675865173339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004675865173339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([144, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009340763092041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009340763092041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009478092193603516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010576725006103516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([147, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010648250579833984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010648250579833984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 147, 128]), torch.Size([1, 147, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010788440704345703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012891292572021484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 147, 128])
m.shape torch.Size([118, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012989997863769531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012989997863769531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 118, 128]), torch.Size([1, 118, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013102531433105469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015578269958496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 118, 128])
m.shape torch.Size([121, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015752792358398438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015752792358398438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015868186950683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019214630126953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([87, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019364356994628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019364356994628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01944732666015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022434234619140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([80, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022621631622314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022621631622314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022697925567626953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025978565216064453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([65, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026157379150390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026157379150390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02621936798095703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029318809509277344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([60, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02951669692993164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02951669692993164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029573917388916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03283548355102539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([64, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0330815315246582  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0330815315246582  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0331425666809082  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0370488166809082  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([566, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03971719741821289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03971719741821289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03998708724975586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05914926528930664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 283, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05914926528930664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05914926528930664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05941915512084961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0784463882446289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 283, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07450580596923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0747222900390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07493877410888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07471132278442383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1452, 40])
input nodes number: 2787
output nodes number: 1452
edges number: 9362
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07474517822265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07474565505981445  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004786014556884766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 6 input nodes size: 2906
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004607200622558594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004607200622558594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005992889404296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006003856658935547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003735065460205078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003802776336669922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003802776336669922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003802776336669922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([146, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008306503295898438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008306503295898438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00844573974609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00955963134765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([154, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009636878967285156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009636878967285156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 154, 128]), torch.Size([1, 154, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009783744812011719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011986732482910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 154, 128])
m.shape torch.Size([123, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012089252471923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012089252471923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012206554412841797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01478719711303711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([123, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014963150024414062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014963150024414062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015080451965332031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018482208251953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([99, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018659591674804688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018659591674804688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018754005432128906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02215290069580078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 99, 128])
m.shape torch.Size([82, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02234029769897461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02234029769897461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022418498992919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02578115463256836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([77, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025999069213867188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025999069213867188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02607250213623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02974414825439453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([69, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029970645904541016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029970645904541016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030036449432373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03378725051879883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([64, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03402900695800781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03402900695800781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03409004211425781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03799629211425781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([506, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040378570556640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040378570556640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040619850158691406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057750701904296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 253, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057750701904296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057750701904296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057991981506347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07500219345092773  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 253, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07123088836669922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07144594192504883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07166099548339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07143497467041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1443, 40])
input nodes number: 2906
output nodes number: 1443
edges number: 9029
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07146644592285156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07146692276000977  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003907680511474609  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 7 input nodes size: 2935
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0037336349487304688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0037336349487304688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005991458892822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0060024261474609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004605770111083984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004670619964599609  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004670619964599609  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004670619964599609  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([174, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00897359848022461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00897359848022461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 174, 128]), torch.Size([1, 174, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009139537811279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010467052459716797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 174, 128])
m.shape torch.Size([179, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010554790496826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010554790496826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 179, 128]), torch.Size([1, 179, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01072549819946289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013286113739013672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 179, 128])
m.shape torch.Size([145, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013408184051513672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013408184051513672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 145, 128]), torch.Size([1, 145, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013546466827392578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016588687896728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 145, 128])
m.shape torch.Size([120, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016748428344726562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016748428344726562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016862869262695312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020181655883789062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([103, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020370006561279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020370006561279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02046823501586914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024004459381103516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([93, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024221420288085938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024221420288085938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 93, 128]), torch.Size([1, 93, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02431011199951172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028123855590820312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 93, 128])
m.shape torch.Size([64, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028293132781982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028293132781982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028354167938232422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03140592575073242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([71, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0316462516784668  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0316462516784668  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03171396255493164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035573482513427734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03575849533081055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03575849533081055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035807132720947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038919925689697266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([459, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04108428955078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04108428955078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 229, 128]), torch.Size([1, 229, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04130268096923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0568084716796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 229, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0568084716796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0568084716796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05702781677246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07249212265014648  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 230, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06895065307617188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0691680908203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06938552856445312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06915712356567383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1459, 40])
input nodes number: 2935
output nodes number: 1459
edges number: 8585
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06919240951538086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06919288635253906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004776477813720703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 8 input nodes size: 3840
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004608154296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004608154296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006439208984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006449699401855469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004180908203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004241943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004241943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004241943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([169, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00834798812866211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00834798812866211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 169, 128]), torch.Size([1, 169, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008509159088134766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009798526763916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 169, 128])
m.shape torch.Size([146, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009857177734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009857177734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009996414184570312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0120849609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([150, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01222991943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01222991943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012372970581054688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015520095825195312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 150, 128])
m.shape torch.Size([114, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01566600799560547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01566600799560547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01577472686767578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018927574157714844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 114, 128])
m.shape torch.Size([94, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019097328186035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019097328186035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 94, 128]), torch.Size([1, 94, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019186973571777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022414207458496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 94, 128])
m.shape torch.Size([72, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02257537841796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02257537841796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02264404296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02559661865234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([77, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02581930160522461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02581930160522461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02589273452758789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029564380645751953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([68, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029787063598632812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029787063598632812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029851913452148438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03354835510253906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([53, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03374338150024414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03374338150024414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03379392623901367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03702878952026367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([436, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0392613410949707  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0392613410949707  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039469242095947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0542302131652832  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 218, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0542302131652832  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0542302131652832  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.054438114166259766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06909513473510742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 218, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06571054458618164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06591606140136719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06612157821655273  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06590557098388672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1379, 40])
input nodes number: 3840
output nodes number: 1379
edges number: 8189
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0659327507019043  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0659332275390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0043354034423828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 9 input nodes size: 3371
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004168987274169922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004168987274169922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006426811218261719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0064373016357421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004595756530761719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00466156005859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00466156005859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00466156005859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([177, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009070396423339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009070396423339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 177, 128]), torch.Size([1, 177, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00923919677734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010589599609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 177, 128])
m.shape torch.Size([120, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010619640350341797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010619640350341797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010734081268310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012450695037841797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([128, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012576580047607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012576580047607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012698650360107422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015384197235107422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([96, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015506267547607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015506267547607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015597820281982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018252849578857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([96, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018435955047607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018435955047607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018527507781982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021823406219482422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([70, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021977901458740234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021977901458740234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022044658660888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024915218353271484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([61, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02508544921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02508544921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02514362335205078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028052330017089844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([53, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028225421905517578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028225421905517578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02827596664428711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03115701675415039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([35, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03128194808959961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03128194808959961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 35, 128]), torch.Size([1, 35, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03131532669067383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03345155715942383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 35, 128])
m.shape torch.Size([556, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036086082458496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036086082458496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 278, 128]), torch.Size([1, 278, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03635120391845703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055174827575683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 278, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055174827575683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055174827575683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 278, 128]), torch.Size([1, 278, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05543994903564453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07413101196289062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 278, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07042980194091797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07063722610473633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07084465026855469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07062673568725586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1392, 40])
input nodes number: 3371
output nodes number: 1392
edges number: 8811
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0706644058227539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07066488265991211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0047702789306640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 10 input nodes size: 4234
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004597663879394531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004597663879394531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0066165924072265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006627559661865234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004359245300292969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004427909851074219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004427909851074219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004427909851074219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([135, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00896310806274414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00896310806274414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009091854095458984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010121822357177734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([146, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010196685791015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010196685791015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010335922241210938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012424468994140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([116, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012520790100097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012520790100097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012631416320800781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015065193176269531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([105, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015210151672363281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015210151672363281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015310287475585938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01821422576904297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([89, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01837635040283203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01837635040283203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018461227416992188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021516799926757812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([80, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021703243255615234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021703243255615234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021779537200927734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025060176849365234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([73, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02526569366455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02526569366455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025335311889648438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02881622314453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([68, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029040813446044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029040813446044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029105663299560547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03280210494995117  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([66, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033052921295166016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033052921295166016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03311586380004883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03714418411254883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([533, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03965425491333008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03965425491333008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 266, 128]), torch.Size([1, 266, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03990793228149414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05791902542114258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 266, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05791902542114258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05791902542114258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05817365646362305  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0761256217956543  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 267, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0722966194152832  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07250690460205078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07271718978881836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07249593734741211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1411, 40])
input nodes number: 4234
output nodes number: 1411
edges number: 9099
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07254171371459961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07254219055175781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004548072814941406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 11 input nodes size: 3441
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0043621063232421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0043621063232421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006619930267333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006630897521972656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004601001739501953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004668712615966797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004668712615966797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004668712615966797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([166, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009190082550048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009190082550048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 166, 128]), torch.Size([1, 166, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009348392486572266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010614871978759766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 166, 128])
m.shape torch.Size([150, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010678768157958984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010678768157958984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010821819305419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012967586517333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 150, 128])
m.shape torch.Size([124, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013073444366455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013073444366455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 124, 128]), torch.Size([1, 124, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013191699981689453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015793323516845703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 124, 128])
m.shape torch.Size([92, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015909671783447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015909671783447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01599740982055664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018541812896728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([79, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018686294555664062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018686294555664062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018761634826660156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02147388458251953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([77, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021656513214111328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021656513214111328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02172994613647461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024887561798095703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([72, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025091171264648438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025091171264648438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025159835815429688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028593063354492188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([71, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028829574584960938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028829574584960938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02889728546142578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032756805419921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([52, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032946109771728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032946109771728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03299570083618164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03616952896118164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([544, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03873872756958008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03873872756958008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 272, 128]), torch.Size([1, 272, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03899812698364258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05741548538208008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 272, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05741548538208008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05741548538208008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 272, 128]), torch.Size([1, 272, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05767488479614258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07596254348754883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 272, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07216644287109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07237911224365234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07259178161621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07236814498901367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1427, 40])
input nodes number: 3441
output nodes number: 1427
edges number: 9043
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07240724563598633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07240772247314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004781246185302734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 12 input nodes size: 3570
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004603385925292969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004603385925292969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006305694580078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006316184997558594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004047393798828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00411224365234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00411224365234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00411224365234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([154, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008412837982177734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008412837982177734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 154, 128]), torch.Size([1, 154, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008559703826904297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009734630584716797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 154, 128])
m.shape torch.Size([141, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009795665740966797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009795665740966797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009930133819580078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011947154998779297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([136, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012074470520019531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012074470520019531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012204170227050781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015057563781738281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([113, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015208244323730469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015208244323730469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015316009521484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018441200256347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([99, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01862335205078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01862335205078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01871776580810547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022116661071777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 99, 128])
m.shape torch.Size([82, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022304058074951172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022304058074951172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022382259368896484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025744915008544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([65, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025922775268554688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025922775268554688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025984764099121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029084205627441406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([60, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029282093048095703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029282093048095703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029339313507080078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03260087966918945  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([54, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032804012298583984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032804012298583984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03285551071166992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03615140914916992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([490, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038462162017822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038462162017822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 245, 128]), torch.Size([1, 245, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0386958122253418  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055284976959228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 245, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055284976959228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055284976959228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 245, 128]), torch.Size([1, 245, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05551862716674805  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.071990966796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 245, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06840276718139648  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06861066818237305  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06881856918334961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06860017776489258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1394, 40])
input nodes number: 3570
output nodes number: 1394
edges number: 8604
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06863260269165039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0686330795288086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004214763641357422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 13 input nodes size: 3835
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004042625427246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004042625427246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006300449371337891  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006310939788818359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004598140716552734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004657268524169922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004657268524169922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004657268524169922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([233, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008640289306640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008640289306640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 233, 128]), torch.Size([1, 233, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008862495422363281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010640144348144531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 233, 128])
m.shape torch.Size([174, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01069498062133789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01069498062133789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 174, 128]), torch.Size([1, 174, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010860919952392578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01335000991821289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 174, 128])
m.shape torch.Size([132, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013455867767333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013455867767333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 132, 128]), torch.Size([1, 132, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01358175277709961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01635122299194336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 132, 128])
m.shape torch.Size([113, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01650381088256836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01650381088256836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016611576080322266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019736766815185547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([102, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019926071166992188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019926071166992188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 102, 128]), torch.Size([1, 102, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020023345947265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023525238037109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 102, 128])
m.shape torch.Size([68, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02367115020751953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02367115020751953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023736000061035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02652454376220703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([51, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026662349700927734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026662349700927734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026710987091064453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02914285659790039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([47, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029297828674316406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029297828674316406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0293426513671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031897544860839844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03207683563232422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03207683563232422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03212165832519531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03499031066894531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([437, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03705167770385742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03705167770385742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037259578704833984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05202054977416992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 218, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05202054977416992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05202054977416992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 219, 128]), torch.Size([1, 219, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05222940444946289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06695413589477539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 219, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06373262405395508  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06394195556640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06415128707885742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06393146514892578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1404, 40])
input nodes number: 3835
output nodes number: 1404
edges number: 7873
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06397199630737305  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06397247314453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004762172698974609  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 14 input nodes size: 3109
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004599571228027344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004599571228027344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006082057952880859  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006092548370361328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038242340087890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038661956787109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038661956787109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038661956787109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([333, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006775379180908203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006775379180908203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 333, 128]), torch.Size([1, 333, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007092952728271484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009633541107177734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 333, 128])
m.shape torch.Size([279, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009740829467773438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009740829467773438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 279, 128]), torch.Size([1, 279, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010006904602050781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013998031616210938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 279, 128])
m.shape torch.Size([203, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014155387878417969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014155387878417969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 203, 128]), torch.Size([1, 203, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014348983764648438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01860809326171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 203, 128])
m.shape torch.Size([144, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018785953521728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018785953521728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018923282623291016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022905826568603516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([96, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023066043853759766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023066043853759766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023157596588134766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026453495025634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([73, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026616573333740234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026616573333740234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02668619155883789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02967977523803711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([48, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02980518341064453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02980518341064453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02985095977783203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03213977813720703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([35, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032250404357910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032250404357910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 35, 128]), torch.Size([1, 35, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032283782958984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034186363220214844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 35, 128])
m.shape torch.Size([29, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03429412841796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03429412841796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 29, 128]), torch.Size([1, 29, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03432178497314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03609180450439453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 29, 128])
m.shape torch.Size([168, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03687906265258789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03687906265258789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 84, 128]), torch.Size([1, 84, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036959171295166016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04264688491821289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 84, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04264688491821289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04264688491821289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 84, 128]), torch.Size([1, 84, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042726993560791016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04837465286254883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 84, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04632425308227539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.046534061431884766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04674386978149414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0465235710144043  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1408, 40])
input nodes number: 3109
output nodes number: 1408
edges number: 5551
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04655790328979492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.046558380126953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003948211669921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 15 input nodes size: 2689
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038247108459472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038247108459472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0060825347900390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006093502044677734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00460052490234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004650115966796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004650115966796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004650115966796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([259, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008037567138671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008037567138671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008284568786621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010260581970214844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([250, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010375499725341797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010375499725341797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 250, 128]), torch.Size([1, 250, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01061391830444336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014190196990966797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 250, 128])
m.shape torch.Size([188, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014339923858642578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014339923858642578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 188, 128]), torch.Size([1, 188, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014519214630126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018463611602783203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 188, 128])
m.shape torch.Size([152, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018663883209228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018663883209228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 152, 128]), torch.Size([1, 152, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018808841705322266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023012638092041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 152, 128])
m.shape torch.Size([97, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023171424865722656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023171424865722656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023263931274414062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026594161987304688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([92, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02681112289428711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02681112289428711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026898860931396484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03067159652709961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([54, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030807971954345703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030807971954345703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03085947036743164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033434391021728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([47, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03358793258666992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03358793258666992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033632755279541016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03618764877319336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([48, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03637123107910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03637123107910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03641700744628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03934669494628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([246, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040496826171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040496826171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04061412811279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04894256591796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 123, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04894256591796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04894256591796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04905986785888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057329654693603516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 123, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.054767608642578125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.054981231689453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055194854736328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05497026443481445  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1433, 40])
input nodes number: 2689
output nodes number: 1433
edges number: 6614
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055005550384521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05500602722167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004740715026855469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 16 input nodes size: 2849
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004604339599609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004604339599609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005962848663330078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00597381591796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0037050247192382812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003765106201171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003765106201171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003765106201171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([199, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007783412933349609  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007783412933349609  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 199, 128]), torch.Size([1, 199, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007973194122314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009491443634033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 199, 128])
m.shape torch.Size([188, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009575843811035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009575843811035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 188, 128]), torch.Size([1, 188, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009755134582519531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012444496154785156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 188, 128])
m.shape torch.Size([164, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012589454650878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012589454650878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 164, 128]), torch.Size([1, 164, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012745857238769531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01618671417236328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 164, 128])
m.shape torch.Size([117, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01633167266845703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01633167266845703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016443252563476562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01967906951904297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([100, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019861698150634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019861698150634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01995706558227539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02339029312133789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([92, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023605823516845703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023605823516845703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023693561553955078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027466297149658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([89, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027719497680664062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027719497680664062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02780437469482422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03204822540283203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([65, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03225374221801758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03225374221801758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032315731048583984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03584909439086914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([68, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03610992431640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03610992431640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036174774169921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040325164794921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([363, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04255056381225586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04255056381225586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04272317886352539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05497884750366211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 181, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05497884750366211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05497884750366211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05515241622924805  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06738948822021484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 182, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06415605545043945  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06437158584594727  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06458711624145508  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0643606185913086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1445, 40])
input nodes number: 2849
output nodes number: 1445
edges number: 7972
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06439495086669922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06439542770385742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038652420043945312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 17 input nodes size: 2926
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0037069320678710938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0037069320678710938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005964756011962891  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0059757232666015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046062469482421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00466156005859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00466156005859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00466156005859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([226, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008385181427001953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008385181427001953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 226, 128]), torch.Size([1, 226, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008600711822509766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010324954986572266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 226, 128])
m.shape torch.Size([211, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010418415069580078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010418415069580078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010619640350341797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013638019561767578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 211, 128])
m.shape torch.Size([167, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013776302337646484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013776302337646484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013935565948486328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01743936538696289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 167, 128])
m.shape torch.Size([144, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01763439178466797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01763439178466797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01777172088623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02175426483154297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([111, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021950244903564453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021950244903564453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022056102752685547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025866985321044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 111, 128])
m.shape torch.Size([92, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0260772705078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0260772705078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026165008544921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029937744140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([75, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030144214630126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030144214630126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030215740203857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03379201889038086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([77, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03404998779296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03404998779296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03412342071533203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03830909729003906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038474082946777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038474082946777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03851890563964844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04138755798339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([294, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04276704788208008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04276704788208008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 147, 128]), torch.Size([1, 147, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0429072380065918  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05286073684692383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 147, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05286073684692383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05286073684692383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 147, 128]), torch.Size([1, 147, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05300092697143555  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06288433074951172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 147, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05996990203857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06018543243408203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060400962829589844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06017446517944336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1444, 40])
input nodes number: 2926
output nodes number: 1444
edges number: 7336
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060207366943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06020784378051758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004755496978759766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 18 input nodes size: 2697
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046062469482421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046062469482421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005892276763916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0059032440185546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0036344528198242188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00368499755859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00368499755859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00368499755859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([259, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007149696350097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007149696350097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007396697998046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009372711181640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([232, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009470462799072266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009470462799072266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 232, 128]), torch.Size([1, 232, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009691715240478516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013010501861572266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 232, 128])
m.shape torch.Size([185, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013164520263671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013164520263671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013340950012207031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01722240447998047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([152, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01742410659790039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01742410659790039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 152, 128]), torch.Size([1, 152, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01756906509399414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02177286148071289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 152, 128])
m.shape torch.Size([128, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022005558013916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022005558013916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022127628326416016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026522159576416016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([93, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02672719955444336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02672719955444336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 93, 128]), torch.Size([1, 93, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02681589126586914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030629634857177734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 93, 128])
m.shape torch.Size([83, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03086233139038086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03086233139038086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030941486358642578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034899234771728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([62, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035096168518066406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035096168518066406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035155296325683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03852558135986328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([49, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038706302642822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038706302642822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03875303268432617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04174375534057617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([217, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042755126953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042755126953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042858123779296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0501708984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 108, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0501708984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0501708984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05027484893798828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05760383605957031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 109, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05498504638671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05520296096801758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055420875549316406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055191993713378906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1460, 40])
input nodes number: 2697
output nodes number: 1460
edges number: 6772
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05522584915161133  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05522632598876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0037751197814941406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 19 input nodes size: 2759
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0036368370056152344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0036368370056152344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005894660949707031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005905628204345703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004608631134033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004661083221435547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004661083221435547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004661083221435547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([250, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008237838745117188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008237838745117188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 250, 128]), torch.Size([1, 250, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00847625732421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01038360595703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 250, 128])
m.shape torch.Size([238, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010491371154785156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010491371154785156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 238, 128]), torch.Size([1, 238, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010718345642089844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014122962951660156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 238, 128])
m.shape torch.Size([172, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014255523681640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014255523681640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0144195556640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01802825927734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 172, 128])
m.shape torch.Size([116, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018167495727539062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018167495727539062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018278121948242188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021486282348632812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([142, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02176952362060547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02176952362060547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021904945373535156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026780128479003906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 142, 128])
m.shape torch.Size([102, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027004241943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027004241943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 102, 128]), torch.Size([1, 102, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027101516723632812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031284332275390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 102, 128])
m.shape torch.Size([87, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03152608871459961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03152608871459961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03160905838012695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03575754165649414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([41, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035872459411621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035872459411621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03591156005859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038140296936035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([53, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03834819793701172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03834819793701172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03839874267578125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04163360595703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([257, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042833805084228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042833805084228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042955875396728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051622867584228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 128, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051622867584228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051622867584228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05174589157104492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060419559478759766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 129, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057675838470458984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05789327621459961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.058110713958740234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05788230895996094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1458, 40])
input nodes number: 2759
output nodes number: 1458
edges number: 7012
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057913780212402344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05791425704956055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004750728607177734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 20 input nodes size: 4037
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004608154296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004608154296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006533145904541016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0065441131591796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004275321960449219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004332542419433594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004332542419433594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004332542419433594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([245, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008172988891601562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008172988891601562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 245, 128]), torch.Size([1, 245, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008406639099121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010275840759277344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 245, 128])
m.shape torch.Size([192, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010342121124267578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010342121124267578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 192, 128]), torch.Size([1, 192, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010525226593017578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013271808624267578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 192, 128])
m.shape torch.Size([172, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01342630386352539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01342630386352539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013590335845947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017199039459228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 172, 128])
m.shape torch.Size([123, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017351627349853516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017351627349853516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017468929290771484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020870685577392578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([120, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02109813690185547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02109813690185547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02121257781982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02533245086669922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([91, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02553558349609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02553558349609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02562236785888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029354095458984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([83, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029587745666503906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029587745666503906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029666900634765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03362464904785156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([57, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03380250930786133  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03380250930786133  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033856868743896484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03695535659790039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([57, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037172794342041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037172794342041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03722715377807617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04070615768432617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([323, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04293680191040039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04293680191040039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 161, 128]), torch.Size([1, 161, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0430903434753418  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05399179458618164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 161, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05399179458618164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05399179458618164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 162, 128]), torch.Size([1, 162, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05414628982543945  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06503868103027344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 162, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.062020301818847656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06223869323730469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06245708465576172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.062227725982666016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1463, 40])
input nodes number: 4037
output nodes number: 1463
edges number: 7563
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.062270164489746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0622706413269043  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004437923431396484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 21 input nodes size: 2941
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004276275634765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004276275634765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006534099578857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006545066833496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004609107971191406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046596527099609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046596527099609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046596527099609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([234, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008101940155029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008101940155029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00832509994506836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01011037826538086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 234, 128])
m.shape torch.Size([227, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010215282440185547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010215282440185547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 227, 128]), torch.Size([1, 227, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010431766510009766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013679027557373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 227, 128])
m.shape torch.Size([183, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013832569122314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013832569122314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 183, 128]), torch.Size([1, 183, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014007091522216797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01784658432006836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 183, 128])
m.shape torch.Size([142, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018030166625976562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018030166625976562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01816558837890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022092819213867188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 142, 128])
m.shape torch.Size([127, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022327899932861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022327899932861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022449016571044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026809215545654297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([94, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027017593383789062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027017593383789062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 94, 128]), torch.Size([1, 94, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02710723876953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030961990356445312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 94, 128])
m.shape torch.Size([83, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031194210052490234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031194210052490234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03127336502075195  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03523111343383789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([57, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035408973693847656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035408973693847656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03546333312988281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03856182098388672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([48, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03874063491821289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03874063491821289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03878641128540039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04171609878540039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([228, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042780399322509766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042780399322509766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04288911819458008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050608158111572266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 114, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050608158111572266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050608158111572266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05071687698364258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05838155746459961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 114, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055753231048583984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055965423583984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.056177616119384766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0559544563293457  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1423, 40])
input nodes number: 2941
output nodes number: 1423
edges number: 6753
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05598115921020508  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05598163604736328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004742622375488281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 22 input nodes size: 3550
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004602909088134766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004602909088134766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006295680999755859  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006306648254394531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0040378570556640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004100799560546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004100799560546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004100799560546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([182, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008301258087158203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008301258087158203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00847482681274414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00986337661743164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 182, 128])
m.shape torch.Size([175, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009943485260009766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009943485260009766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 175, 128]), torch.Size([1, 175, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01011037826538086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012613773345947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 175, 128])
m.shape torch.Size([132, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012719154357910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012719154357910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 132, 128]), torch.Size([1, 132, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012845039367675781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015614509582519531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 132, 128])
m.shape torch.Size([136, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01581096649169922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01581096649169922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01594066619873047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01970195770263672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([111, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019901752471923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019901752471923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020007610321044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023818492889404297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 111, 128])
m.shape torch.Size([84, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024005889892578125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024005889892578125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 84, 128]), torch.Size([1, 84, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02408599853515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027530670166015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 84, 128])
m.shape torch.Size([72, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027730941772460938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027730941772460938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027799606323242188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031232833862304688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([69, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03146171569824219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03146171569824219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03152751922607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0352783203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([54, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0354771614074707  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0354771614074707  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03552865982055664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03882455825805664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([429, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04105663299560547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04105663299560547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 214, 128]), torch.Size([1, 214, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.041260719299316406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05575084686279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 214, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05575084686279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05575084686279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 215, 128]), torch.Size([1, 215, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05595588684082031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07041168212890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 215, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06697463989257812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06719017028808594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06740570068359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06717920303344727  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1444, 40])
input nodes number: 3550
output nodes number: 1444
edges number: 8363
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06722021102905273  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06722068786621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004210472106933594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 23 input nodes size: 2913
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004041194915771484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004041194915771484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006299018859863281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006309986114501953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046062469482421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004657745361328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004657745361328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004657745361328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([289, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008150577545166016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008150577545166016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008426189422607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010631084442138672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([212, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010695457458496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010695457458496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 212, 128]), torch.Size([1, 212, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010897636413574219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013930320739746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 212, 128])
m.shape torch.Size([192, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014103889465332031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014103889465332031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 192, 128]), torch.Size([1, 192, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014286994934082031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01831531524658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 192, 128])
m.shape torch.Size([141, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018492698669433594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018492698669433594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018627166748046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02252674102783203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([97, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022690773010253906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022690773010253906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022783279418945312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026113510131835938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([77, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026287555694580078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026287555694580078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02636098861694336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029518604278564453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([72, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029722213745117188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029722213745117188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029790878295898438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03322410583496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([59, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03341484069824219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03341484069824219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033471107482910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036678314208984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([50, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0368647575378418  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0368647575378418  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03691244125366211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03996419906616211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([257, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.041165828704833984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.041165828704833984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.041287899017333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.049954891204833984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 128, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.049954891204833984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.049954891204833984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05007791519165039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.058751583099365234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 129, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05610370635986328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.056319236755371094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.056534767150878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05630826950073242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1446, 40])
input nodes number: 2913
output nodes number: 1446
edges number: 6796
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05634117126464844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05634164810180664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004747867584228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 24 input nodes size: 3886
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046062469482421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046062469482421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006459236145019531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006470203399658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004201412200927734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004260540008544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004260540008544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004260540008544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([194, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008238792419433594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008238792419433594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 194, 128]), torch.Size([1, 194, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008423805236816406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009903907775878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 194, 128])
m.shape torch.Size([190, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009992599487304688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009992599487304688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010173797607421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012891769409179688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 190, 128])
m.shape torch.Size([147, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013011455535888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013011455535888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 147, 128]), torch.Size([1, 147, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01315164566040039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016235828399658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 147, 128])
m.shape torch.Size([143, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01643848419189453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01643848419189453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016574859619140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020529747009277344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([116, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02073812484741211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02073812484741211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020848751068115234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024831295013427734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([78, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024999141693115234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024999141693115234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025073528289794922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028272151947021484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([73, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028478622436523438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028478622436523438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028548240661621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032029151916503906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([76, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03228425979614258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03228425979614258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03235673904418945  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03648805618286133  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([50, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0366663932800293  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0366663932800293  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03671407699584961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03976583480834961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([369, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04199981689453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04199981689453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 184, 128]), torch.Size([1, 184, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04217529296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05463409423828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 184, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05463409423828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05463409423828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.054810523986816406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06724929809570312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 185, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06404685974121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06426095962524414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06447505950927734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06424999237060547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1436, 40])
input nodes number: 3886
output nodes number: 1436
edges number: 7894
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06428861618041992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06428909301757812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004364013671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 25 input nodes size: 3311
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004199981689453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004199981689453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006457805633544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006468772888183594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004604816436767578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004671573638916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004671573638916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004671573638916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([174, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009149551391601562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009149551391601562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 174, 128]), torch.Size([1, 174, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00931549072265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01064300537109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 174, 128])
m.shape torch.Size([151, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01070404052734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01070404052734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010848045349121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01300811767578125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([125, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01311492919921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01311492919921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013234138488769531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01585674285888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([114, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016014575958251953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016014575958251953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016123294830322266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019276142120361328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 114, 128])
m.shape torch.Size([99, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01945781707763672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01945781707763672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019552230834960938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022951126098632812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 99, 128])
m.shape torch.Size([68, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023098468780517578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023098468780517578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023163318634033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025951862335205078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([60, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026119709014892578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026119709014892578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026176929473876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029037952423095703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([85, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02933359146118164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02933359146118164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029414653778076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03403520584106445  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 85, 128])
m.shape torch.Size([52, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03421783447265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03421783447265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034267425537109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037441253662109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([517, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03988170623779297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03988170623779297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04012775421142578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05759716033935547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 258, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05759716033935547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05759716033935547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05784416198730469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07525825500488281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 259, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07152318954467773  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07173871994018555  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07195425033569336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07172775268554688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1445, 40])
input nodes number: 3311
output nodes number: 1445
edges number: 8948
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07176494598388672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07176542282104492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004781246185302734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 26 input nodes size: 3778
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046062469482421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0046062469482421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006407737731933594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006418704986572266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004149913787841797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004209995269775391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004209995269775391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004209995269775391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([217, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008236885070800781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008236885070800781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 217, 128]), torch.Size([1, 217, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008443832397460938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010099411010742188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 217, 128])
m.shape torch.Size([200, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01018667221069336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01018667221069336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 200, 128]), torch.Size([1, 200, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01037740707397461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01323843002319336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 200, 128])
m.shape torch.Size([150, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01335763931274414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01335763931274414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013500690460205078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016647815704345703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 150, 128])
m.shape torch.Size([119, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016803264617919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016803264617919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016916751861572266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020207881927490234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([95, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020377635955810547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020377635955810547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02046823501586914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023729801177978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([91, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023944854736328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023944854736328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024031639099121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02776336669921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([68, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027946949005126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027946949005126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028011798858642578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03125429153442383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([60, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031450748443603516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031450748443603516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03150796890258789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034769535064697266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([39, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034908294677734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034908294677734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 39, 128]), torch.Size([1, 39, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03494548797607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03732585906982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 39, 128])
m.shape torch.Size([410, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039565086364746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039565086364746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039760589599609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.053641319274902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 205, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.053641319274902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.053641319274902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.053836822509765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06761980056762695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 205, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0643773078918457  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06459331512451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06480932235717773  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06458234786987305  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1449, 40])
input nodes number: 3778
output nodes number: 1449
edges number: 7971
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06462240219116211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06462287902832031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004315853118896484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 27 input nodes size: 3498
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004150390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004150390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006408214569091797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006419181823730469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004606723785400391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004662036895751953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004662036895751953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004662036895751953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([229, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00841522216796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00841522216796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 229, 128]), torch.Size([1, 229, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008633613586425781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010380744934082031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 229, 128])
m.shape torch.Size([195, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010457515716552734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010457515716552734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 195, 128]), torch.Size([1, 195, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010643482208251953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013432979583740234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 195, 128])
m.shape torch.Size([186, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013606071472167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013606071472167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 186, 128]), torch.Size([1, 186, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013783454895019531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017685890197753906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 186, 128])
m.shape torch.Size([136, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017856597900390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017856597900390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017986297607421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021747589111328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([128, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0219879150390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0219879150390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0221099853515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0265045166015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([78, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026666641235351562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026666641235351562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02674102783203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029939651489257812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([65, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03011941909790039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03011941909790039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030181407928466797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03328084945678711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([83, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03356647491455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03356647491455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0336456298828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03815746307373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([43, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03830242156982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03830242156982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 43, 128]), torch.Size([1, 43, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03834342956542969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04096794128417969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 43, 128])
m.shape torch.Size([306, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042406558990478516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.042406558990478516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 153, 128]), torch.Size([1, 153, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04255247116088867  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.052912235260009766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 153, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.052912235260009766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.052912235260009766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 153, 128]), torch.Size([1, 153, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05305814743041992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06334495544433594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 153, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06040191650390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060617923736572266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06083393096923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060606956481933594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1449, 40])
input nodes number: 3498
output nodes number: 1449
edges number: 7395
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06064414978027344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06064462661743164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004760265350341797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 28 input nodes size: 4277
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004606723785400391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004606723785400391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006646156311035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006657123565673828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004388332366943359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004451274871826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004451274871826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004451274871826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([180, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008670806884765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008670806884765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 180, 128]), torch.Size([1, 180, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00884246826171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01021575927734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 180, 128])
m.shape torch.Size([175, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010296821594238281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010296821594238281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 175, 128]), torch.Size([1, 175, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010463714599609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012967109680175781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 175, 128])
m.shape torch.Size([137, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013079643249511719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013079643249511719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 137, 128]), torch.Size([1, 137, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013210296630859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016084671020507812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 137, 128])
m.shape torch.Size([103, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016215801239013672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016215801239013672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016314029693603516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019162654876708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([94, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01933765411376953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01933765411376953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 94, 128]), torch.Size([1, 94, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01942729949951172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02265453338623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 94, 128])
m.shape torch.Size([77, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02283000946044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02283000946044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0229034423828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026061058044433594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([67, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02624797821044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02624797821044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 67, 128]), torch.Size([1, 67, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026311874389648438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029506683349609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 67, 128])
m.shape torch.Size([65, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02972269058227539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02972269058227539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029784679412841797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03331804275512695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([48, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0334930419921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0334930419921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033538818359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036468505859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([470, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03870344161987305  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03870344161987305  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038927555084228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0548396110534668  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 235, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0548396110534668  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0548396110534668  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055063724517822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07086372375488281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 235, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0673837661743164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06759500503540039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06780624389648438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06758403778076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1416, 40])
input nodes number: 4277
output nodes number: 1416
edges number: 8406
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06762218475341797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06762266159057617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004558086395263672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 29 input nodes size: 4303
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004383563995361328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004383563995361328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006641387939453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006652355194091797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004601955413818359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004667758941650391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004667758941650391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004667758941650391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([165, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009038925170898438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009038925170898438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009196281433105469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010455131530761719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 165, 128])
m.shape torch.Size([171, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010539531707763672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010539531707763672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01070261001586914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013148784637451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([127, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013248920440673828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013248920440673828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013370037078857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016034603118896484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([115, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016193389892578125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016193389892578125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 115, 128]), torch.Size([1, 115, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016303062438964844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019483566284179688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 115, 128])
m.shape torch.Size([91, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01964569091796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01964569091796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01973247528076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022856712341308594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([79, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02303934097290039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02303934097290039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023114681243896484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026354312896728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([66, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026536941528320312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026536941528320312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026599884033203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02974700927734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([55, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02992534637451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02992534637451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029977798461914062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032967567443847656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([61, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03326129913330078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03698444366455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([501, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03934431076049805  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03934431076049805  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 250, 128]), torch.Size([1, 250, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03958272933959961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05651044845581055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 250, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05651044845581055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05651044845581055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.056749820709228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07362604141235352  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 251, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06998968124389648  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07020330429077148  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07041692733764648  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07019233703613281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1431, 40])
input nodes number: 4303
output nodes number: 1431
edges number: 8738
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07023811340332031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07023859024047852  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004785060882568359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 30 input nodes size: 3535
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004604339599609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004604339599609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006289958953857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006300449371337891  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004031658172607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004087924957275391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004087924957275391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004087924957275391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([220, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007853984832763672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007853984832763672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 220, 128]), torch.Size([1, 220, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008063793182373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009742259979248047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 220, 128])
m.shape torch.Size([189, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00981760025024414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00981760025024414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 189, 128]), torch.Size([1, 189, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009997844696044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01270151138305664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 189, 128])
m.shape torch.Size([151, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012827396392822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012827396392822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01297140121459961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016139507293701172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([114, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016284942626953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016284942626953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016393661499023438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0195465087890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 114, 128])
m.shape torch.Size([90, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01970672607421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01970672607421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019792556762695312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022882461547851562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([84, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023079872131347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023079872131347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 84, 128]), torch.Size([1, 84, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02315998077392578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026604652404785156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 84, 128])
m.shape torch.Size([62, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02677154541015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02677154541015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026830673217773438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029787063598632812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([53, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029959678649902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029959678649902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030010223388671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032891273498535156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([39, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03303337097167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03303337097167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 39, 128]), torch.Size([1, 39, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03307056427001953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03545093536376953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 39, 128])
m.shape torch.Size([377, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037690162658691406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037690162658691406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 188, 128]), torch.Size([1, 188, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03786945343017578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050599098205566406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 188, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050599098205566406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050599098205566406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 189, 128]), torch.Size([1, 189, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05077934265136719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06348705291748047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 189, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060475826263427734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06068134307861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06088685989379883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06067085266113281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1379, 40])
input nodes number: 3535
output nodes number: 1379
edges number: 7440
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0606999397277832  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060700416564941406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004178524017333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 31 input nodes size: 3379
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004023551940917969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004023551940917969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006281375885009766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0062923431396484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004596233367919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004662990570068359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004662990570068359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004662990570068359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([163, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009101390838623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009101390838623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 163, 128]), torch.Size([1, 163, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009256839752197266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010500431060791016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 163, 128])
m.shape torch.Size([160, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010575294494628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010575294494628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 160, 128]), torch.Size([1, 160, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010727882385253906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013016700744628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 160, 128])
m.shape torch.Size([151, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013156414031982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013156414031982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013300418853759766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016468524932861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([120, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016625404357910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016625404357910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016739845275878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020058631896972656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([112, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02026844024658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02026844024658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02037525177001953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02422046661376953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([56, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02432727813720703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02432727813720703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 56, 128]), torch.Size([1, 56, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02438068389892578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02667713165283203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 56, 128])
m.shape torch.Size([76, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02690410614013672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02690410614013672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026976585388183594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030600547790527344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([60, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030793190002441406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030793190002441406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03085041046142578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034111976623535156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([56, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034323692321777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034323692321777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 56, 128]), torch.Size([1, 56, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034377098083496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037795066833496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 56, 128])
m.shape torch.Size([505, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0401763916015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0401763916015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 252, 128]), torch.Size([1, 252, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040416717529296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0574798583984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 252, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0574798583984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0574798583984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05772113800048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07473182678222656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 253, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07104063034057617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0712580680847168  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07147550582885742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07124710083007812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1459, 40])
input nodes number: 3379
output nodes number: 1459
edges number: 8878
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07129526138305664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07129573822021484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00478363037109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 32 input nodes size: 6771
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004608154296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004608154296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00783681869506836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007847309112548828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005578517913818359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005648136138916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005648136138916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005648136138916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([155, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01030111312866211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01030111312866211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 155, 128]), torch.Size([1, 155, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010448932647705078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011631488800048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 155, 128])
m.shape torch.Size([149, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011699676513671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011699676513671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 149, 128]), torch.Size([1, 149, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011841773986816406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013973236083984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 149, 128])
m.shape torch.Size([92, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014033794403076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014033794403076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014121532440185547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016051769256591797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([72, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01614522933959961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01614522933959961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01621389389038086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01820516586303711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([75, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018349647521972656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018349647521972656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018421173095703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02099609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([47, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021094799041748047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021094799041748047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02113962173461914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023066997528076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([42, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023184776306152344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023184776306152344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 42, 128]), torch.Size([1, 42, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023224830627441406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02522754669189453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 42, 128])
m.shape torch.Size([36, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0253448486328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0253448486328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025379180908203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02733612060546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([35, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027469158172607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027469158172607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 35, 128]), torch.Size([1, 35, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02750253677368164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02963876724243164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 35, 128])
m.shape torch.Size([676, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032845497131347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032845497131347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03316783905029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.056054115295410156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 338, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.056054115295410156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.056054115295410156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05637645721435547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0791015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 338, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07511472702026367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07532024383544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07552576065063477  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07530975341796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1379, 40])
input nodes number: 6771
output nodes number: 1379
edges number: 9331
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07535886764526367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07535934448242188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005772113800048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 33 input nodes size: 6315
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005566596984863281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005566596984863281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008577823638916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008588314056396484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005349159240722656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005428314208984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005428314208984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005428314208984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([112, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011106014251708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011106014251708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011212825775146484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012067317962646484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([97, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01210641860961914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01210641860961914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012198925018310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01358652114868164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([73, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013644695281982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013644695281982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013714313507080078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015245914459228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([54, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015314102172851562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015314102172851562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0153656005859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016859054565429688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([49, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016950130462646484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016950130462646484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01699686050415039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018679141998291016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([38, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018764495849609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018764495849609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 38, 128]), torch.Size([1, 38, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018800735473632812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020359039306640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 38, 128])
m.shape torch.Size([40, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02047443389892578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02047443389892578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 40, 128]), torch.Size([1, 40, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02051258087158203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02241992950439453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 40, 128])
m.shape torch.Size([31, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02251911163330078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02251911163330078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 31, 128]), torch.Size([1, 31, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022548675537109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02423381805419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 31, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024437904357910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024437904357910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024486541748046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027599334716796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([834, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03155183792114258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03155183792114258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031949520111083984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06018495559692383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 417, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06018495559692383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06018495559692383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060582637786865234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08861923217773438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 417, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08355903625488281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08376455307006836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0839700698852539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08375406265258789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1379, 40])
input nodes number: 6315
output nodes number: 1379
edges number: 10541
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08381175994873047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08381223678588867  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005570411682128906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 34 input nodes size: 6024
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005349159240722656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005349159240722656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008221626281738281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00823211669921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005210399627685547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005268573760986328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005268573760986328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005268573760986328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([232, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009178638458251953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009178638458251953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 232, 128]), torch.Size([1, 232, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009399890899658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011169910430908203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 232, 128])
m.shape torch.Size([180, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011230945587158203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011230945587158203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 180, 128]), torch.Size([1, 180, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011402606964111328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013977527618408203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 180, 128])
m.shape torch.Size([155, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014113426208496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014113426208496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 155, 128]), torch.Size([1, 155, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014261245727539062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017513275146484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 155, 128])
m.shape torch.Size([115, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017658710479736328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017658710479736328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 115, 128]), torch.Size([1, 115, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017768383026123047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02094888687133789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 115, 128])
m.shape torch.Size([79, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021082401275634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021082401275634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02115774154663086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023869991302490234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([67, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024024009704589844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024024009704589844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 67, 128]), torch.Size([1, 67, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024087905883789062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02683544158935547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 67, 128])
m.shape torch.Size([49, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02696704864501953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02696704864501953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027013778686523438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02935028076171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([41, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029483318328857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029483318328857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029522418975830078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031751155853271484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([32, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031868934631347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031868934631347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 32, 128]), torch.Size([1, 32, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031899452209472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033852577209472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 32, 128])
m.shape torch.Size([445, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03595924377441406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03595924377441406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 222, 128]), torch.Size([1, 222, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03617095947265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05120277404785156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 222, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05120277404785156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05120277404785156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 223, 128]), torch.Size([1, 223, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051415443420410156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06640911102294922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 223, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06325292587280273  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0634608268737793  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06366872787475586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06345033645629883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1395, 40])
input nodes number: 6024
output nodes number: 1395
edges number: 7723
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06350851058959961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06350898742675781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005390167236328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 35 input nodes size: 5199
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0052127838134765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0052127838134765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007691860198974609  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007702350616455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004819393157958984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004876613616943359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004876613616943359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004876613616943359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([238, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00872945785522461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00872945785522461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 238, 128]), torch.Size([1, 238, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008956432342529297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010772228240966797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 238, 128])
m.shape torch.Size([212, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010860919952392578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010860919952392578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 212, 128]), torch.Size([1, 212, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011063098907470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014095783233642578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 212, 128])
m.shape torch.Size([128, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014177799224853516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014177799224853516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014299869537353516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016985416412353516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([89, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017094135284423828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017094135284423828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017179012298583984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019640445709228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([101, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019838809967041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019838809967041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019935131072998047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023402690887451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([71, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023557662963867188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023557662963867188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02362537384033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026536941528320312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([69, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0267333984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0267333984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02679920196533203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030089378356933594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([57, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030273914337158203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030273914337158203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03032827377319336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033426761627197266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([34, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033545494079589844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033545494079589844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 34, 128]), torch.Size([1, 34, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033577919006347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035653114318847656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 34, 128])
m.shape torch.Size([402, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038509368896484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038509368896484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 201, 128]), torch.Size([1, 201, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03870105743408203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.052310943603515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 201, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.052310943603515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.052310943603515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 201, 128]), torch.Size([1, 201, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05250263214111328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06601667404174805  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 201, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06293296813964844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0631418228149414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06335067749023438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06313133239746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1401, 40])
input nodes number: 5199
output nodes number: 1401
edges number: 7598
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06318187713623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06318235397338867  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0049896240234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 36 input nodes size: 5750
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004820346832275391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004820346832275391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007692813873291016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0077037811279296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005214214324951172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005280017852783203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005280017852783203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005280017852783203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([191, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009688377380371094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009688377380371094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009870529174804688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011327743530273438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([156, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011385440826416016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011385440826416016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01153421401977539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013765811920166016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 156, 128])
m.shape torch.Size([144, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013897418975830078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013897418975830078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014034748077392578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017055988311767578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([94, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017166614532470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017166614532470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 94, 128]), torch.Size([1, 94, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01725625991821289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019855976104736328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 94, 128])
m.shape torch.Size([77, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019994735717773438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019994735717773438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02006816864013672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022711753845214844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([64, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022858142852783203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022858142852783203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022919178009033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025543689727783203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([59, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025710105895996094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025710105895996094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025766372680664062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0285797119140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([42, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028711795806884766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028711795806884766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 42, 128]), torch.Size([1, 42, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028751850128173828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03103494644165039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 42, 128])
m.shape torch.Size([31, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03114795684814453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03114795684814453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 31, 128]), torch.Size([1, 31, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031177520751953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033069610595703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 31, 128])
m.shape torch.Size([568, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03576326370239258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03576326370239258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03603410720825195  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05526399612426758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 284, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05526399612426758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05526399612426758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05553483963012695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07462930679321289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 284, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07095003128051758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07116270065307617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07137537002563477  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0711517333984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1426, 40])
input nodes number: 5750
output nodes number: 1426
edges number: 8788
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07120943069458008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07120990753173828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00540924072265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 37 input nodes size: 6084
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005218029022216797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005218029022216797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00811910629272461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008129596710205078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005246162414550781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005314826965332031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005314826965332031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005314826965332031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([191, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009875774383544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009875774383544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010057926177978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011515140533447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([144, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011561393737792969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011561393737792969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011698722839355469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013758659362792969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([100, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013833045959472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013833045959472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013928413391113281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01602649688720703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([81, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01613330841064453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01613330841064453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016210556030273438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01845073699951172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([68, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018574237823486328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018574237823486328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018639087677001953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020973682403564453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([57, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02110433578491211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02110433578491211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021158695220947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023496150970458984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([46, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023622512817382812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023622512817382812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 46, 128]), torch.Size([1, 46, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0236663818359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025859832763671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 46, 128])
m.shape torch.Size([39, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025986671447753906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025986671447753906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 39, 128]), torch.Size([1, 39, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02602386474609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028143882751464844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 39, 128])
m.shape torch.Size([32, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028262615203857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028262615203857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 32, 128]), torch.Size([1, 32, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028293132781982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030246257781982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 32, 128])
m.shape torch.Size([640, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03328275680541992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03328275680541992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03358793258666992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05525541305541992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 320, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05525541305541992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05525541305541992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05556058883666992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07707548141479492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 320, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07321453094482422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07342290878295898  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07363128662109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07341241836547852  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1398, 40])
input nodes number: 6084
output nodes number: 1398
edges number: 9107
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07346439361572266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07346487045288086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005440711975097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 38 input nodes size: 6084
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005241870880126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005241870880126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008142948150634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008153438568115234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005241870880126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005300998687744141  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005300998687744141  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005300998687744141  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([218, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009287357330322266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009287357330322266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009495258331298828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011158466339111328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 218, 128])
m.shape torch.Size([176, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011222362518310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011222362518310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011390209197998047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013907909393310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([144, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014029979705810547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014029979705810547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014167308807373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017188549041748047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([95, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017301082611083984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017301082611083984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017391681671142578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020019054412841797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([90, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020188331604003906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020188331604003906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02027416229248047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02336406707763672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([65, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023507118225097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023507118225097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023569107055664062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02623462677001953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([53, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026380538940429688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026380538940429688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02643108367919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02895832061767578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([37, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02907419204711914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02907419204711914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 37, 128]), torch.Size([1, 37, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029109477996826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031120777130126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 37, 128])
m.shape torch.Size([36, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03125762939453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03125762939453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031291961669921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033489227294921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([468, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03570365905761719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03570365905761719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03592681884765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05177116394042969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 234, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05177116394042969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05177116394042969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05199432373046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06772708892822266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 234, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06447744369506836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06468343734741211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06488943099975586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06467294692993164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1382, 40])
input nodes number: 6084
output nodes number: 1382
edges number: 7893
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0647268295288086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0647273063659668  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005419254302978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 39 input nodes size: 7476
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0052394866943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0052394866943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0088043212890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008815288543701172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005903720855712891  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005980014801025391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005980014801025391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005980014801025391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([142, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01100778579711914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01100778579711914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011143207550048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012226581573486328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 142, 128])
m.shape torch.Size([128, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012280941009521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012280941009521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012403011322021484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014234066009521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([91, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014303207397460938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014303207397460938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014389991760253906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01629924774169922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([88, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016423702239990234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016423702239990234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 88, 128]), torch.Size([1, 88, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016507625579833984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018941402435302734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 88, 128])
m.shape torch.Size([83, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019097328186035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019097328186035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019176483154296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02202606201171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([75, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022201061248779297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022201061248779297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022272586822509766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025348186492919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([60, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0255126953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0255126953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025569915771484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028430938720703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([54, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028608322143554688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028608322143554688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028659820556640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03159523010253906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031771183013916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031771183013916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03181600570678711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03468465805053711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([695, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03797626495361328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03797626495361328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03830718994140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06180286407470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 347, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06180286407470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06180286407470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.062134742736816406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08553266525268555  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 348, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0812082290649414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08142662048339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08164501190185547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08141565322875977  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1463, 40])
input nodes number: 7476
output nodes number: 1463
edges number: 10113
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08149480819702148  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08149528503417969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006141185760498047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 40 input nodes size: 6399
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005916118621826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005916118621826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008967399597167969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008977890014648438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005402088165283203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005472660064697266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005472660064697266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005472660064697266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([142, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010142803192138672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010142803192138672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01027822494506836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01136159896850586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 142, 128])
m.shape torch.Size([129, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011416912078857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011416912078857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011539936065673828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013385295867919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 129, 128])
m.shape torch.Size([112, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013484001159667969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013484001159667969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013590812683105469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01594066619873047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([87, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016053199768066406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016053199768066406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01613616943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01854228973388672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([74, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018677234649658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018677234649658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018747806549072266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021288394927978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([55, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021410465240478516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021410465240478516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02146291732788086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02371835708618164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([32, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02379894256591797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02379894256591797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 32, 128]), torch.Size([1, 32, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02382946014404297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02535533905029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 32, 128])
m.shape torch.Size([34, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02546977996826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02546977996826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 34, 128]), torch.Size([1, 34, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02550220489501953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027350425720214844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 34, 128])
m.shape torch.Size([42, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02751445770263672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02751445770263672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 42, 128]), torch.Size([1, 42, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02755451202392578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03011798858642578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 42, 128])
m.shape torch.Size([672, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03366279602050781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03366279602050781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 336, 128]), torch.Size([1, 336, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03398323059082031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05673408508300781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 336, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05673408508300781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05673408508300781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 336, 128]), torch.Size([1, 336, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05705451965332031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07964515686035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 336, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0756368637084961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07584238052368164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07604789733886719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07583189010620117  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1379, 40])
input nodes number: 6399
output nodes number: 1379
edges number: 9378
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07587718963623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07587766647338867  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005593776702880859  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 41 input nodes size: 6419
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005389213562011719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005389213562011719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008954048156738281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00896453857421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005902767181396484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005969524383544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005969524383544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005969524383544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([172, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010437965393066406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010437965393066406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010601997375488281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011914253234863281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 172, 128])
m.shape torch.Size([147, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011972427368164062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011972427368164062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 147, 128]), torch.Size([1, 147, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012112617492675781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014215469360351562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 147, 128])
m.shape torch.Size([107, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014298439025878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014298439025878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 107, 128]), torch.Size([1, 107, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014400482177734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016645431518554688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 107, 128])
m.shape torch.Size([82, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016750812530517578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016750812530517578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01682901382446289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019096851348876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([88, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019267559051513672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019267559051513672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 88, 128]), torch.Size([1, 88, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019351482391357422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022372722625732422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 88, 128])
m.shape torch.Size([69, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02252817153930664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02252817153930664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022593975067138672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025423526763916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([64, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025604248046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025604248046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025665283203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028717041015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([33, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028812408447265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028812408447265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 33, 128]), torch.Size([1, 33, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02884387969970703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030637741088867188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 33, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030823707580566406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030823707580566406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0308685302734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0337371826171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([583, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03649473190307617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03649473190307617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 291, 128]), torch.Size([1, 291, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03677225112915039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05647611618041992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 291, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05647611618041992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05647611618041992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 292, 128]), torch.Size([1, 292, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05675458908081055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07638740539550781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 292, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07261848449707031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07282590866088867  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07303333282470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0728154182434082  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1392, 40])
input nodes number: 6419
output nodes number: 1392
edges number: 8934
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0728759765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0728764533996582  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006102085113525391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 42 input nodes size: 6970
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005904674530029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005904674530029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009228229522705078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009238719940185547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005663394927978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005734920501708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005734920501708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005734920501708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([161, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010507583618164062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010507583618164062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 161, 128]), torch.Size([1, 161, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010661125183105469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011889457702636719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 161, 128])
m.shape torch.Size([115, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011922359466552734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011922359466552734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 115, 128]), torch.Size([1, 115, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012032032012939453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013677120208740234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 115, 128])
m.shape torch.Size([83, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013741016387939453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013741016387939453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013820171356201172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015561580657958984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([68, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015651702880859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015651702880859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015716552734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017597198486328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([83, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01776266098022461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01776266098022461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017841815948486328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020691394805908203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([50, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02079486846923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02079486846923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020842552185058594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02289295196533203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([40, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02300262451171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02300262451171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 40, 128]), torch.Size([1, 40, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023040771484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0249481201171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 40, 128])
m.shape torch.Size([45, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0251007080078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0251007080078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 45, 128]), torch.Size([1, 45, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02514362335205078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027589797973632812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 45, 128])
m.shape torch.Size([32, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027705669403076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027705669403076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 32, 128]), torch.Size([1, 32, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027736186981201172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029689311981201172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 32, 128])
m.shape torch.Size([702, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033238887786865234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033238887786865234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03357362747192383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057340145111083984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 351, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057340145111083984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057340145111083984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05767488479614258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08127403259277344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 351, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07716608047485352  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07737159729003906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07757711410522461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0773611068725586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1379, 40])
input nodes number: 6970
output nodes number: 1379
edges number: 9575
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07742166519165039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0774221420288086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005872249603271484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 43 input nodes size: 6672
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005661487579345703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005661487579345703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009226322174072266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009236812591552734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005902767181396484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005973339080810547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005973339080810547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005973339080810547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([155, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010689735412597656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010689735412597656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 155, 128]), torch.Size([1, 155, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010837554931640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012020111083984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 155, 128])
m.shape torch.Size([141, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012080669403076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012080669403076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012215137481689453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014232158660888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([103, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014312267303466797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014312267303466797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01441049575805664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016571521759033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([75, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01666545867919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01666545867919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016736984252929688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01881122589111328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([78, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018961429595947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018961429595947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019035816192626953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021713733673095703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([48, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02181386947631836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02181386947631836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02185964584350586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02382802963256836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([57, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023995399475097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023995399475097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024049758911132812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026767730712890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([32, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026862621307373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026862621307373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 32, 128]), torch.Size([1, 32, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026893138885498047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028632640838623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 32, 128])
m.shape torch.Size([37, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028776168823242188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028776168823242188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 37, 128]), torch.Size([1, 37, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02881145477294922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03106975555419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 37, 128])
m.shape torch.Size([675, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0342707633972168  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0342707633972168  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0345921516418457  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05741071701049805  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 337, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05741071701049805  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05741071701049805  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05773305892944336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0804586410522461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 338, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07641983032226562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0766286849975586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07683753967285156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07661819458007812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1401, 40])
input nodes number: 6672
output nodes number: 1401
edges number: 9462
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07668209075927734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07668256759643555  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0061130523681640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 44 input nodes size: 7185
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005906105041503906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005906105041503906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00933218002319336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009343147277832031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005767822265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0058498382568359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0058498382568359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0058498382568359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([130, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011302471160888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011302471160888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 130, 128]), torch.Size([1, 130, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011426448822021484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012418270111083984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 130, 128])
m.shape torch.Size([82, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01243448257446289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01243448257446289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012512683868408203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01368570327758789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([95, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013782501220703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013782501220703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013873100280761719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01586627960205078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([61, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015937328338623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015937328338623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015995502471923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017682552337646484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([48, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017767906188964844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017767906188964844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017813682556152344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019461631774902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([56, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019598960876464844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019598960876464844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 56, 128]), torch.Size([1, 56, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019652366638183594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021948814392089844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 56, 128])
m.shape torch.Size([51, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022092342376708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022092342376708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022140979766845703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02457284927368164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([50, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02473926544189453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02473926544189453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024786949157714844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027504920959472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([53, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02770853042602539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02770853042602539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 53, 128]), torch.Size([1, 53, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027759075164794922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030993938446044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 53, 128])
m.shape torch.Size([837, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03495979309082031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03495979309082031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035358428955078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06366157531738281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 418, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06366157531738281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06366157531738281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 419, 128]), torch.Size([1, 419, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06406116485595703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.09223270416259766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 419, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08744955062866211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08766794204711914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08788633346557617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08765697479248047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1463, 40])
input nodes number: 7185
output nodes number: 1463
edges number: 11003
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08773136138916016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08773183822631836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006011962890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 45 input nodes size: 6070
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0057773590087890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0057773590087890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009342193603515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009352684020996094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005915641784667969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005978584289550781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005978584289550781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005978584289550781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([200, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01021575927734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01021575927734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 200, 128]), torch.Size([1, 200, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010406494140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011932373046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 200, 128])
m.shape torch.Size([166, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011995315551757812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011995315551757812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 166, 128]), torch.Size([1, 166, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01215362548828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014528274536132812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 166, 128])
m.shape torch.Size([119, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01461935043334961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01461935043334961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014732837677001953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017229557037353516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([108, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017378807067871094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017378807067871094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01748180389404297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020468711853027344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([73, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020591259002685547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020591259002685547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020660877227783203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023167133331298828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([58, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023298263549804688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023298263549804688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 58, 128]), torch.Size([1, 58, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02335357666015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025732040405273438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 58, 128])
m.shape torch.Size([50, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02587127685546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02587127685546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025918960571289062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028303146362304688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([49, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028466224670410156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028466224670410156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028512954711914062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03117656707763672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([35, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03130340576171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03130340576171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 35, 128]), torch.Size([1, 35, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03133678436279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03347301483154297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 35, 128])
m.shape torch.Size([534, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03600263595581055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03600263595581055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036257266998291016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0543360710144043  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 267, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0543360710144043  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0543360710144043  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.054590702056884766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07254219055175781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 267, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06902599334716797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06923341751098633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06944084167480469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06922292709350586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1392, 40])
input nodes number: 6070
output nodes number: 1392
edges number: 8431
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06926774978637695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06926822662353516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006091594696044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 46 input nodes size: 7206
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005904674530029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005904674530029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009340763092041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009351253509521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005775928497314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005851268768310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005851268768310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005851268768310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([139, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010818958282470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010818958282470703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 139, 128]), torch.Size([1, 139, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010951519012451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012012004852294922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 139, 128])
m.shape torch.Size([111, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012051582336425781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012051582336425781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012157440185546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013745307922363281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 111, 128])
m.shape torch.Size([77, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013802528381347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013802528381347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013875961303710938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015491485595703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([78, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01560354232788086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01560354232788086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015677928924560547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017835140228271484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([68, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017960071563720703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017960071563720703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018024921417236328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020359516143798828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([45, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02045583724975586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02045583724975586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 45, 128]), torch.Size([1, 45, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02049875259399414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022344112396240234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 45, 128])
m.shape torch.Size([42, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022462844848632812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022462844848632812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 42, 128]), torch.Size([1, 42, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022502899169921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024505615234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 42, 128])
m.shape torch.Size([43, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024649620056152344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024649620056152344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 43, 128]), torch.Size([1, 43, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024690628051757812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02702808380126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 43, 128])
m.shape torch.Size([36, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02716207504272461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02716207504272461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027196407318115234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029393672943115234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([752, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03296232223510742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03296232223510742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03332090377807617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05878019332885742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 376, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05878019332885742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05878019332885742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05913877487182617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08441877365112305  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 376, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08010292053222656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08031034469604492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08051776885986328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08029985427856445  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1391, 40])
input nodes number: 7206
output nodes number: 1391
edges number: 9996
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08036422729492188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08036470413208008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005996227264404297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 47 input nodes size: 6441
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005775928497314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005775928497314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009340763092041016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009351253509521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005904674530029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005979061126708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005979061126708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005979061126708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([124, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010923385620117188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010923385620117188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 124, 128]), torch.Size([1, 124, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011041641235351562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011987686157226562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 124, 128])
m.shape torch.Size([110, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012033462524414062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012033462524414062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01213836669921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013711929321289062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([82, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013776779174804688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013776779174804688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01385498046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015575408935546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([80, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01568889617919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01568889617919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01576519012451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01797771453857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([66, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018096923828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018096923828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018159866333007812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020425796508789062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([57, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020557403564453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020557403564453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02061176300048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02294921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([39, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023052215576171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023052215576171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 39, 128]), torch.Size([1, 39, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02308940887451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024949073791503906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 39, 128])
m.shape torch.Size([25, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02502584457397461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02502584457397461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 25, 128]), torch.Size([1, 25, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025049686431884766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026408672332763672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 25, 128])
m.shape torch.Size([48, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026602745056152344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026602745056152344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026648521423339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029578208923339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([748, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03312206268310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03312206268310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033478736877441406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05880260467529297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 374, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05880260467529297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05880260467529297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059159278869628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0843048095703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 374, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07999944686889648  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08020496368408203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08041048049926758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08019447326660156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1379, 40])
input nodes number: 6441
output nodes number: 1379
edges number: 9967
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08025121688842773  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.08025169372558594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006115436553955078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 48 input nodes size: 3300
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005902767181396484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005902767181396484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007476329803466797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007486820220947266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003911495208740234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003953456878662109  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003953456878662109  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003953456878662109  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([328, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007775783538818359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007775783538818359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00808858871459961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01059103012084961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([291, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010712146759033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010712146759033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 291, 128]), torch.Size([1, 291, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010989665985107422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015152454376220703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 291, 128])
m.shape torch.Size([190, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015285491943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015285491943359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015466690063476562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019453048706054688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 190, 128])
m.shape torch.Size([144, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019637107849121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019637107849121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019774436950683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023756980895996094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([107, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023943424224853516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023943424224853516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 107, 128]), torch.Size([1, 107, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024045467376708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02771902084350586  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 107, 128])
m.shape torch.Size([63, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027848243713378906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027848243713378906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0279083251953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03049182891845703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([50, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030628681182861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030628681182861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03067636489868164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033060550689697266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([51, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033231258392333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033231258392333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0332798957824707  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03605222702026367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([35, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0361781120300293  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0361781120300293  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 35, 128]), torch.Size([1, 35, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036211490631103516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038347721099853516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 35, 128])
m.shape torch.Size([148, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03903675079345703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03903675079345703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039107322692871094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04411792755126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 74, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04411792755126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04411792755126953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.044188499450683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.049163818359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 74, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04620170593261719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04641151428222656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04662132263183594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.046401023864746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1407, 40])
input nodes number: 3300
output nodes number: 1407
edges number: 5522
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04644060134887695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.046441078186035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004040241241455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 49 input nodes size: 3839
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0039157867431640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0039157867431640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005746364593505859  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005757331848144531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00417327880859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004231452941894531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004231452941894531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004231452941894531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([238, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008153438568115234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008153438568115234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 238, 128]), torch.Size([1, 238, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008380413055419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010196208953857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 238, 128])
m.shape torch.Size([182, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010256290435791016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010256290435791016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010429859161376953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013033390045166016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 182, 128])
m.shape torch.Size([153, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013165473937988281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013165473937988281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 153, 128]), torch.Size([1, 153, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013311386108398438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016521453857421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 153, 128])
m.shape torch.Size([113, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01666402816772461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01666402816772461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016771793365478516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019896984100341797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([128, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020148277282714844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020148277282714844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020270347595214844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024664878845214844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([92, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02486705780029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02486705780029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024954795837402344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02872753143310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([71, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028920650482177734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028920650482177734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028988361358642578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032373905181884766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([69, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03260326385498047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03260326385498047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0326690673828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03641986846923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03658866882324219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03658866882324219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03663349151611328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03950214385986328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([356, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04117727279663086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04117727279663086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04134702682495117  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05339956283569336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 178, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05339956283569336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05339956283569336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05356931686401367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0655369758605957  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 178, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06242036819458008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0626363754272461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06285238265991211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06262540817260742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1449, 40])
input nodes number: 3839
output nodes number: 1449
edges number: 7737
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06267118453979492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06267166137695312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00434112548828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 50 input nodes size: 3340
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004179477691650391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004179477691650391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005772113800048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005782604217529297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003941059112548828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003986835479736328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003986835479736328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003986835479736328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([285, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007148265838623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007148265838623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 285, 128]), torch.Size([1, 285, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007420063018798828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009594440460205078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 285, 128])
m.shape torch.Size([250, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00969696044921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00969696044921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 250, 128]), torch.Size([1, 250, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009935379028320312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01351165771484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 250, 128])
m.shape torch.Size([197, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013674259185791016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013674259185791016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013862133026123047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017995357513427734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([133, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01815509796142578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01815509796142578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 133, 128]), torch.Size([1, 133, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018281936645507812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02196025848388672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 133, 128])
m.shape torch.Size([98, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022130489349365234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022130489349365234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022223949432373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025588512420654297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([98, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025822162628173828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025822162628173828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02591562271118164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029934406280517578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([57, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03007793426513672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03007793426513672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030132293701171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03285026550292969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([44, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03299093246459961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03299093246459961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 44, 128]), torch.Size([1, 44, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033032894134521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03542470932006836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 44, 128])
m.shape torch.Size([33, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03554534912109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03554534912109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 33, 128]), torch.Size([1, 33, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035576820373535156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037590980529785156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 33, 128])
m.shape torch.Size([209, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03940582275390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03940582275390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0395050048828125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04654693603515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 104, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04654693603515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04654693603515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.046647071838378906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.053707122802734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 105, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05137300491333008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05158233642578125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05179166793823242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05157184600830078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1404, 40])
input nodes number: 3340
output nodes number: 1404
edges number: 6124
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05160093307495117  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051601409912109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004066944122314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 51 input nodes size: 4235
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003934383392333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003934383392333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005953788757324219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0059642791748046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004361152648925781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0044097900390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0044097900390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0044097900390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([305, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00808572769165039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00808572769165039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008376598358154297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010703563690185547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([237, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010784149169921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010784149169921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 237, 128]), torch.Size([1, 237, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011010169982910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014400482177734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 237, 128])
m.shape torch.Size([144, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014493465423583984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014493465423583984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014630794525146484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017652034759521484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([109, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017791271209716797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017791271209716797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017895221710205078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020909786224365234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 109, 128])
m.shape torch.Size([91, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021074771881103516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021074771881103516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021161556243896484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02428579330444336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([70, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024442672729492188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024442672729492188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024509429931640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027379989624023438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([46, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027500152587890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027500152587890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 46, 128]), torch.Size([1, 46, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027544021606445312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029737472534179688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 46, 128])
m.shape torch.Size([48, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029898643493652344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029898643493652344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029944419860839844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032553672790527344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([42, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032711029052734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032711029052734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 42, 128]), torch.Size([1, 42, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03275108337402344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03531455993652344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 42, 128])
m.shape torch.Size([287, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036663055419921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036663055419921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03679943084716797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.046482086181640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 143, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.046482086181640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.046482086181640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.046619415283203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05630159378051758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 144, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05343484878540039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05364036560058594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.053845882415771484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05362987518310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1379, 40])
input nodes number: 4235
output nodes number: 1379
edges number: 6476
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05366849899291992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.053668975830078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004502296447753906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 52 input nodes size: 5847
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004357337951660156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004357337951660156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007780551910400391  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0077915191650390625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005761623382568359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005829334259033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005829334259033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005829334259033203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([182, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010343551635742188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010343551635742188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010517120361328125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011905670166015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 182, 128])
m.shape torch.Size([157, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011968612670898438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.011968612670898438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 157, 128]), torch.Size([1, 157, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012118339538574219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014364242553710938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 157, 128])
m.shape torch.Size([113, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014451026916503906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014451026916503906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014558792114257812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01692962646484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([82, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017032146453857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017032146453857422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017110347747802734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019378185272216797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([91, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019556045532226562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019556045532226562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01964282989501953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022767066955566406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([100, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023009777069091797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023009777069091797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023105144500732422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027205944061279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([55, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027341842651367188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027341842651367188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02739429473876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03001689910888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([66, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030242443084716797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030242443084716797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 66, 128]), torch.Size([1, 66, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03030538558959961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03389310836791992  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 66, 128])
m.shape torch.Size([47, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03406333923339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03406333923339844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03410816192626953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03697681427001953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([546, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03955793380737305  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03955793380737305  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 273, 128]), torch.Size([1, 273, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03981828689575195  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0583033561706543  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 273, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0583033561706543  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0583033561706543  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 273, 128]), torch.Size([1, 273, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0585637092590332  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0769186019897461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 273, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07314252853393555  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07335710525512695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07357168197631836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.07334613800048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1439, 40])
input nodes number: 5847
output nodes number: 1439
edges number: 9014
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0734100341796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0734105110168457  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005966663360595703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 53 input nodes size: 4787
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005770683288574219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005770683288574219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008053302764892578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008063793182373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004629611968994141  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004683971405029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004683971405029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004683971405029297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([244, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008348941802978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008348941802978516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 244, 128]), torch.Size([1, 244, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00858163833618164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01044321060180664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 244, 128])
m.shape torch.Size([193, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010510921478271484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010510921478271484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 193, 128]), torch.Size([1, 193, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01069498062133789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013455867767333984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 193, 128])
m.shape torch.Size([155, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013585567474365234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013585567474365234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 155, 128]), torch.Size([1, 155, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013733386993408203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016985416412353516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 155, 128])
m.shape torch.Size([112, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01712512969970703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01712512969970703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01723194122314453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02032947540283203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([91, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020493030548095703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020493030548095703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020579814910888672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023704051971435547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([81, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02389240264892578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02389240264892578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023969650268554688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027291297912597656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([55, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027436256408691406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027436256408691406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02748870849609375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030111312866210938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([51, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03027963638305664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03027963638305664  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03032827377319336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03310060501098633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([41, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03325223922729492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03325223922729492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 41, 128]), torch.Size([1, 41, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03329133987426758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03579378128051758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 41, 128])
m.shape torch.Size([356, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037471771240234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037471771240234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03764152526855469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.049694061279296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 178, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.049694061279296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.049694061279296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04986381530761719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06183147430419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 178, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.058936119079589844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05914163589477539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05934715270996094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05913114547729492  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1379, 40])
input nodes number: 4787
output nodes number: 1379
edges number: 7206
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059168338775634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05916881561279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004780769348144531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 54 input nodes size: 3446
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004620552062988281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004620552062988281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00626373291015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006274223327636719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003981113433837891  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004025936126708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004025936126708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004025936126708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([311, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0070953369140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0070953369140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 311, 128]), torch.Size([1, 311, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007391929626464844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009764671325683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 311, 128])
m.shape torch.Size([240, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009845256805419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009845256805419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 240, 128]), torch.Size([1, 240, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010074138641357422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013507366180419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 240, 128])
m.shape torch.Size([184, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013656139373779297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013656139373779297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 184, 128]), torch.Size([1, 184, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013831615447998047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017692089080810547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 184, 128])
m.shape torch.Size([131, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01785421371459961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01785421371459961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 131, 128]), torch.Size([1, 131, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017979145050048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021602153778076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 131, 128])
m.shape torch.Size([115, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02181386947631836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02181386947631836  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 115, 128]), torch.Size([1, 115, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021923542022705078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025871753692626953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 115, 128])
m.shape torch.Size([76, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02603435516357422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02603435516357422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026106834411621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02922344207763672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([48, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02934741973876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02934741973876953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02939319610595703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03168201446533203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([49, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031846046447753906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031846046447753906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03189277648925781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03455638885498047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([37, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034691810607910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034691810607910156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 37, 128]), torch.Size([1, 37, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03472709655761719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03698539733886719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 37, 128])
m.shape torch.Size([195, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037897586822509766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037897586822509766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03799009323120117  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.044558048248291016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 97, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.044558048248291016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.044558048248291016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04465150833129883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05124092102050781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 98, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04900503158569336  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.049211978912353516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04941892623901367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04920148849487305  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1386, 40])
input nodes number: 3446
output nodes number: 1386
edges number: 5909
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.049239158630371094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0492396354675293  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004113674163818359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 55 input nodes size: 4102
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0039825439453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0039825439453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005938529968261719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0059490203857421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00429534912109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004347801208496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004347801208496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004347801208496094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([237, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007921695709228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007921695709228516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 237, 128]), torch.Size([1, 237, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008147716522216797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009955883026123047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 237, 128])
m.shape torch.Size([222, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010054588317871094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010054588317871094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 222, 128]), torch.Size([1, 222, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010266304016113281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013442039489746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 222, 128])
m.shape torch.Size([146, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013545036315917969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013545036315917969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013684272766113281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016747474670410156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([136, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016937255859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016937255859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01706695556640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0208282470703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([116, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021039962768554688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021039962768554688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021150588989257812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025133132934570312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([81, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02530956268310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02530956268310547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025386810302734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028708457946777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([71, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028906822204589844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028906822204589844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028974533081054688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032360076904296875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([54, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0325322151184082  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0325322151184082  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03258371353149414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03551912307739258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([55, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035729408264160156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035729408264160156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0357818603515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0391387939453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([287, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0407557487487793  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0407557487487793  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04089212417602539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05057477951049805  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 143, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05057477951049805  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05057477951049805  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05071210861206055  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060394287109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 144, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057613372802734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05782318115234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.058032989501953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05781269073486328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1405, 40])
input nodes number: 4102
output nodes number: 1405
edges number: 7023
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05785703659057617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057857513427734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0044498443603515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 56 input nodes size: 2322
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004298210144042969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004298210144042969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0059413909912109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005952358245849609  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003985881805419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004041194915771484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004041194915771484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004041194915771484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([218, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0077762603759765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0077762603759765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007984161376953125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009647369384765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 218, 128])
m.shape torch.Size([214, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009747505187988281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009747505187988281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 214, 128]), torch.Size([1, 214, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009951591491699219  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013012886047363281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 214, 128])
m.shape torch.Size([152, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013128280639648438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013128280639648438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 152, 128]), torch.Size([1, 152, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013273239135742188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016462326049804688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 152, 128])
m.shape torch.Size([137, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016651153564453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016651153564453125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 137, 128]), torch.Size([1, 137, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01678180694580078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020570755004882812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 137, 128])
m.shape torch.Size([101, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020746231079101562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020746231079101562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020842552185058594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02431011199951172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([73, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024470806121826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024470806121826172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024540424346923828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027534008026123047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([87, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027789592742919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027789592742919922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027872562408447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03202104568481445  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([46, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03215503692626953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03215503692626953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 46, 128]), torch.Size([1, 46, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03219890594482422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034699440002441406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 46, 128])
m.shape torch.Size([52, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034900665283203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.034900665283203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03495025634765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03812408447265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([333, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039687156677246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.039687156677246094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 166, 128]), torch.Size([1, 166, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03984546661376953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051085472106933594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 166, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051085472106933594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051085472106933594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05124473571777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.062473297119140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 167, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059519290924072266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05973005294799805  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05994081497192383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059719085693359375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1413, 40])
input nodes number: 2322
output nodes number: 1413
edges number: 7368
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05974864959716797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05974912643432617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004131793975830078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 57 input nodes size: 2850
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003986835479736328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003986835479736328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005345821380615234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005356788635253906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0037026405334472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0037474632263183594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0037474632263183594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0037474632263183594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([346, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006832599639892578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006832599639892578  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007162570953369141  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.00980234146118164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([260, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009885311126708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009885311126708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01013326644897461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013852596282958984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([176, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013980388641357422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013980388641357422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014148235321044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017840862274169922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([150, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018043041229248047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018043041229248047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018186092376708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022334575653076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 150, 128])
m.shape torch.Size([85, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02246570587158203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02246570587158203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022546768188476562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025465011596679688  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 85, 128])
m.shape torch.Size([64, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025607585906982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025607585906982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025668621063232422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028293132781982422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([61, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028466224670410156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028466224670410156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028524398803710938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03143310546875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([49, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031590938568115234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031590938568115234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03163766860961914  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0343012809753418  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([40, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03444957733154297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03444957733154297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 40, 128]), torch.Size([1, 40, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03448772430419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03692913055419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 40, 128])
m.shape torch.Size([192, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037825584411621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037825584411621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.037917137145996094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.044417381286621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 96, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.044417381286621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.044417381286621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.044508934020996094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.050963401794433594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 96, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04874849319458008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04896068572998047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04917287826538086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0489497184753418  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1423, 40])
input nodes number: 2850
output nodes number: 1423
edges number: 5902
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04898357391357422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04898405075073242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038318634033203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 58 input nodes size: 3152
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003704071044921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003704071044921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005347251892089844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005358219146728516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0039882659912109375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004038810729980469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004038810729980469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004038810729980469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([275, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007497310638427734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007497310638427734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 275, 128]), torch.Size([1, 275, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007759571075439453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009857654571533203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 275, 128])
m.shape torch.Size([224, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009940147399902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009940147399902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 224, 128]), torch.Size([1, 224, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010153770446777344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013358116149902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 224, 128])
m.shape torch.Size([201, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013538837432861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013538837432861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 201, 128]), torch.Size([1, 201, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013730525970458984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017947673797607422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 201, 128])
m.shape torch.Size([136, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018111228942871094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018111228942871094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018240928649902344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022002220153808594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([104, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022185325622558594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022185325622558594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022284507751464844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025855064392089844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 104, 128])
m.shape torch.Size([91, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026065826416015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026065826416015625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026152610778808594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02988433837890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([79, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030104637145996094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030104637145996094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030179977416992188  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033946990966796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([44, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03407716751098633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03407716751098633  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 44, 128]), torch.Size([1, 44, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0341191291809082  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03651094436645508  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 44, 128])
m.shape torch.Size([60, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03674745559692383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03674745559692383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0368046760559082  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0404667854309082  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([236, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04156351089477539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04156351089477539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 118, 128]), torch.Size([1, 118, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04167604446411133  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04966592788696289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 118, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04966592788696289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04966592788696289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 118, 128]), torch.Size([1, 118, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04977846145629883  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05771207809448242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 118, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05509805679321289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05531454086303711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05553102493286133  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05530357360839844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1450, 40])
input nodes number: 3152
output nodes number: 1450
edges number: 6741
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.055342674255371094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0553431510925293  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004134178161621094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 59 input nodes size: 3775
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003992557525634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003992557525634766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0057926177978515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005803585052490234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004149436950683594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0042018890380859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0042018890380859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0042018890380859375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([264, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007773399353027344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007773399353027344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008025169372558594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010039329528808594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([222, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010125160217285156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010125160217285156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 222, 128]), torch.Size([1, 222, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010336875915527344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013512611389160156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 222, 128])
m.shape torch.Size([178, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013661384582519531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013661384582519531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013831138610839844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01756572723388672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 178, 128])
m.shape torch.Size([139, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0177459716796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0177459716796875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 139, 128]), torch.Size([1, 139, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01787853240966797  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021722793579101562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 139, 128])
m.shape torch.Size([118, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021937847137451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021937847137451172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 118, 128]), torch.Size([1, 118, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02205038070678711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02610158920288086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 118, 128])
m.shape torch.Size([76, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026262760162353516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026262760162353516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02633523941040039  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029451847076416016  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([55, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02959918975830078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02959918975830078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029651641845703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03227424621582031  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([56, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03246164321899414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03246164321899414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 56, 128]), torch.Size([1, 56, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03251504898071289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03555917739868164  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 56, 128])
m.shape torch.Size([51, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0357513427734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0357513427734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03579998016357422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03891277313232422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([285, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04053163528442383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04053163528442383  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040667057037353516  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05028200149536133  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 142, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05028200149536133  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05028200149536133  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05041837692260742  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060033321380615234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 143, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057288169860839844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057503700256347656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05771923065185547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057492733001708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1444, 40])
input nodes number: 3775
output nodes number: 1444
edges number: 6986
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.057530879974365234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05753135681152344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004298210144042969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 60 input nodes size: 2882
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0041484832763671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0041484832763671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005791664123535156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005802631378173828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003991603851318359  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004041194915771484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004041194915771484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004041194915771484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([259, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007427692413330078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007427692413330078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007674694061279297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009650707244873047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([231, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009747505187988281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009747505187988281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009967803955078125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013272285461425781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([176, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01341390609741211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01341390609741211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01358175277709961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01727437973022461  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([138, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017453670501708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017453670501708984  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017585277557373047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02140188217163086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([129, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021643638610839844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021643638610839844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02176666259765625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026195526123046875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 129, 128])
m.shape torch.Size([79, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026360034942626953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026360034942626953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026435375213623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029675006866455078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([60, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029837608337402344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029837608337402344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 60, 128]), torch.Size([1, 60, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02989482879638672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03275585174560547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 60, 128])
m.shape torch.Size([61, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032959938049316406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032959938049316406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03301811218261719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03633403778076172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([49, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036515235900878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.036515235900878906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03656196594238281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03955268859863281  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([234, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04064512252807617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04064512252807617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0407567024230957  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04867887496948242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 117, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04867887496948242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04867887496948242  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04879045486450195  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.056656837463378906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 117, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05409049987792969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05430173873901367  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.054512977600097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.054290771484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1416, 40])
input nodes number: 2882
output nodes number: 1416
edges number: 6609
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05431938171386719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05431985855102539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004125118255615234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 61 input nodes size: 4275
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003987312316894531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003987312316894531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006025791168212891  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0060367584228515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004382610321044922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004437923431396484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004437923431396484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004437923431396484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([222, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008189201354980469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008189201354980469  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 222, 128]), torch.Size([1, 222, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.008400917053222656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010094642639160156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 222, 128])
m.shape torch.Size([207, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010186195373535156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010186195373535156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 207, 128]), torch.Size([1, 207, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01038360595703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013344764709472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 207, 128])
m.shape torch.Size([172, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013492107391357422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013492107391357422  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013656139373779297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017264842987060547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 172, 128])
m.shape torch.Size([128, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01742696762084961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01742696762084961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01754903793334961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02108907699584961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([85, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021230697631835938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021230697631835938  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02131175994873047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024230003356933594  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 85, 128])
m.shape torch.Size([83, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024426937103271484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024426937103271484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024506092071533203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02790975570678711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([78, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028130531311035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028130531311035156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028204917907714844  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03192424774169922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([57, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0321044921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0321044921875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 57, 128]), torch.Size([1, 57, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032158851623535156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03525733947753906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 57, 128])
m.shape torch.Size([48, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035436153411865234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035436153411865234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035481929779052734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038411617279052734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([338, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04003190994262695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04003190994262695  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 169, 128]), torch.Size([1, 169, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04019308090209961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0516362190246582  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 169, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0516362190246582  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0516362190246582  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 169, 128]), torch.Size([1, 169, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05179738998413086  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06315994262695312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 169, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06019306182861328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06040477752685547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060616493225097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0603938102722168  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1418, 40])
input nodes number: 4275
output nodes number: 1418
edges number: 7401
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.06043720245361328  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.060437679290771484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004542350769042969  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 62 input nodes size: 3344
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004383087158203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004383087158203125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006026268005371094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.006037235260009766  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003987789154052734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004043102264404297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004043102264404297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004043102264404297  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([231, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007756710052490234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007756710052490234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007977008819580078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009739398956298828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([211, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009830474853515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.009830474853515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010031700134277344  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013050079345703125  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 211, 128])
m.shape torch.Size([172, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013195514678955078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013195514678955078  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013359546661376953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016968250274658203  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 172, 128])
m.shape torch.Size([141, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017155170440673828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017155170440673828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01728963851928711  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021189212799072266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([116, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021398544311523438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021398544311523438  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021509170532226562  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025491714477539062  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([88, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02568817138671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02568817138671875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 88, 128]), torch.Size([1, 88, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0257720947265625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02938079833984375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 88, 128])
m.shape torch.Size([63, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029549121856689453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029549121856689453  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029609203338623047  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032613277435302734  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([50, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03277397155761719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03277397155761719  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 50, 128]), torch.Size([1, 50, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0328216552734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03553962707519531  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 50, 128])
m.shape torch.Size([48, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035721778869628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035721778869628906  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 48, 128]), torch.Size([1, 48, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.035767555236816406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.038697242736816406  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 48, 128])
m.shape torch.Size([320, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040200233459472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040200233459472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 160, 128]), torch.Size([1, 160, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.040352821350097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051186561584472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 160, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051186561584472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051186561584472656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 160, 128]), torch.Size([1, 160, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051339149475097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.062096595764160156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 160, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059186458587646484  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05940103530883789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0596156120300293  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05939006805419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1440, 40])
input nodes number: 3344
output nodes number: 1440
edges number: 7314
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.059429168701171875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05942964553833008  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004143238067626953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

pseudo mini batch 63 input nodes size: 3201
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003990650177001953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003990650177001953  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005517005920410156  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.005527973175048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0038738250732421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003920555114746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003920555114746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.003920555114746094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

m.shape torch.Size([343, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007149696350097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007149696350097656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 343, 128]), torch.Size([1, 343, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.007476806640625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01009368896484375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 343, 128])
m.shape torch.Size([258, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01017618179321289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01017618179321289  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.010422229766845703  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01411294937133789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 258, 128])
m.shape torch.Size([181, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014248847961425781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014248847961425781  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014421463012695312  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018218994140625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 181, 128])
m.shape torch.Size([128, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018376827239990234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018376827239990234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018498897552490234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022038936614990234  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([91, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022194862365722656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022194862365722656  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022281646728515625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0254058837890625  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([71, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025565624237060547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025565624237060547  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02563333511352539  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028544902801513672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([49, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028674602508544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028674602508544922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028721332550048828  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03105783462524414  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([49, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031221389770507812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031221389770507812  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03126811981201172  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033931732177734375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([38, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03407144546508789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03407144546508789  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 38, 128]), torch.Size([1, 38, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03410768508911133  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03642702102661133  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst.shape  torch.Size([1, 38, 128])
m.shape torch.Size([233, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03805208206176758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03805208206176758  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0381627082824707  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04601716995239258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 0 shape torch.Size([1, 116, 128])
----------------------------------------1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04601716995239258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04601716995239258  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04612874984741211  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes
Using backend: pytorch

----------------------------------------4
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.053995609283447266  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

rst 1 shape torch.Size([1, 117, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0516357421875  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05185079574584961  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05206584930419922  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05183982849121094  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

torch.Size([1441, 40])
input nodes number: 3201
output nodes number: 1441
edges number: 6202
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.05187559127807617  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.051876068115234375  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004008769989013672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004008769989013672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.004008769989013672  GigaBytes
Max Memory Allocated: 0.09752178192138672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0046005286276340485 |0.00044419988989830017 |0.03818690776824951 |8.885562419891357e-05 |0.01905396208167076 |0.0017664432525634766 |
----------------------------------------------------------pseudo_mini_loss sum 3.169135570526123
Total (block generation + training)time/epoch 14.15268850326538
* Pure training time/epoch 3.9937314987182617
Training time/epoch 4.261388301849365
Training time without block to device /epoch 4.232959508895874
Training time without total dataloading part /epoch 3.6708688735961914
load block tensor time/epoch 0.2944338321685791
block to device time/epoch 0.02842879295349121
input features size transfer per epoch 8.58306884765625e-06
blocks size to device per epoch 5.7220458984375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  268674
Number of first layer input nodes during this epoch:  268674
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
