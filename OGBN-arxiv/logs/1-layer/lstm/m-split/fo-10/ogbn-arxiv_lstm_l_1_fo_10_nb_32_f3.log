[03:21:45] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14364480 edges into 32 parts and get 3565445 edge cuts
main start at this time 1652844092.1395888
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028665781021118164
global_2_local spend time (sec) 0.03646683692932129
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003302335739135742
A = g.adjacency_matrix() spent  0.0075070858001708984
auxiliary_graph
Graph(num_nodes=145054, num_edges=14455421,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07349991798400879
remove nodes length
54113
auxiliary_graph.remove_nodes spent  0.6528735160827637
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14455421,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.5929512977600098

the counter of shared neighbor distribution
Counter({1.0: 12983840, 2.0: 1168162, 3.0: 166454, 4.0: 33624, 5.0: 8820, 6.0: 2638, 7.0: 736, 8.0: 176, 9.0: 24, 10.0: 6})
14364480
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14364477, 14364478, 14364479])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12983840, 2.0: 1168162, 3.0: 166454, 4.0: 33624, 5.0: 8820, 6.0: 2638, 7.0: 736, 8.0: 176, 9.0: 24, 10.0: 6})
Convert a graph into a bidirected graph: 0.604 seconds
Metis partitioning: 2.817 seconds
Split the graph: 0.305 seconds
Construct subgraphs: 0.060 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  3.793087959289551
2873
2794
2905
2897
2927
2813
2884
2801
2854
2904
2887
2848
2896
2888
2888
2882
2870
2795
2808
2767
2876
2812
2863
2812
2772
2925
2759
2773
2786
2758
2758
2866
total k batches seeds list generation spend  8.922454833984375
after graph partition
graph partition algorithm spend time 8.98921251296997
2873
2794
2905
2897
2927
2813
2884
2801
2854
2904
2887
2848
2896
2888
2888
2882
2870
2795
2808
2767
2876
2812
2863
2812
2772
2925
2759
2773
2786
2758
2758
2866
partition_len_list
[5656, 5463, 5610, 5995, 6896, 6664, 5868, 6259, 6143, 8065, 5942, 6257, 5355, 6006, 5055, 5173, 6816, 8624, 10023, 8149, 6942, 7235, 5572, 5688, 12713, 12137, 10962, 11002, 11040, 10659, 12209, 12586]
shared_neighbor_graph_partition_s0 selection method  spend 9.078554391860962
time for parepare:  0.01634073257446289
local_output_nid generation:  0.0006494522094726562
local_in_edges_tensor generation:  0.0008633136749267578
mini_batch_src_global generation:  0.0008080005645751953
r_  generation:  0.005435466766357422
local_output_nid generation:  0.0006842613220214844
local_in_edges_tensor generation:  0.0007073879241943359
mini_batch_src_global generation:  0.0006477832794189453
r_  generation:  0.004537820816040039
local_output_nid generation:  0.0007021427154541016
local_in_edges_tensor generation:  0.0006818771362304688
mini_batch_src_global generation:  0.0006935596466064453
r_  generation:  0.00559687614440918
local_output_nid generation:  0.0007293224334716797
local_in_edges_tensor generation:  0.0006844997406005859
mini_batch_src_global generation:  0.0006113052368164062
r_  generation:  0.005662441253662109
local_output_nid generation:  0.0007278919219970703
local_in_edges_tensor generation:  0.0006561279296875
mini_batch_src_global generation:  0.0006892681121826172
r_  generation:  0.0057048797607421875
local_output_nid generation:  0.0007147789001464844
local_in_edges_tensor generation:  0.0006241798400878906
mini_batch_src_global generation:  0.0005812644958496094
r_  generation:  0.005379438400268555
local_output_nid generation:  0.0007505416870117188
local_in_edges_tensor generation:  0.0006220340728759766
mini_batch_src_global generation:  0.0005578994750976562
r_  generation:  0.005003690719604492
local_output_nid generation:  0.00072479248046875
local_in_edges_tensor generation:  0.0006158351898193359
mini_batch_src_global generation:  0.0005476474761962891
r_  generation:  0.005068063735961914
local_output_nid generation:  0.0007259845733642578
local_in_edges_tensor generation:  0.0006184577941894531
mini_batch_src_global generation:  0.0006341934204101562
r_  generation:  0.005331516265869141
local_output_nid generation:  0.000743865966796875
local_in_edges_tensor generation:  0.0006253719329833984
mini_batch_src_global generation:  0.0006215572357177734
r_  generation:  0.00552678108215332
local_output_nid generation:  0.0007305145263671875
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.0005900859832763672
r_  generation:  0.005270957946777344
local_output_nid generation:  0.0007328987121582031
local_in_edges_tensor generation:  0.0005774497985839844
mini_batch_src_global generation:  0.000492095947265625
r_  generation:  0.004464149475097656
local_output_nid generation:  0.0007243156433105469
local_in_edges_tensor generation:  0.0006096363067626953
mini_batch_src_global generation:  0.0005223751068115234
r_  generation:  0.00494837760925293
local_output_nid generation:  0.0007131099700927734
local_in_edges_tensor generation:  0.0006005764007568359
mini_batch_src_global generation:  0.00052642822265625
r_  generation:  0.005233049392700195
local_output_nid generation:  0.000732421875
local_in_edges_tensor generation:  0.0006170272827148438
mini_batch_src_global generation:  0.0005404949188232422
r_  generation:  0.004731655120849609
local_output_nid generation:  0.0007534027099609375
local_in_edges_tensor generation:  0.0005812644958496094
mini_batch_src_global generation:  0.0004563331604003906
r_  generation:  0.00444340705871582
local_output_nid generation:  0.0007359981536865234
local_in_edges_tensor generation:  0.0005950927734375
mini_batch_src_global generation:  0.0005106925964355469
r_  generation:  0.004689931869506836
local_output_nid generation:  0.0007414817810058594
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.0005414485931396484
r_  generation:  0.004534006118774414
local_output_nid generation:  0.0007159709930419922
local_in_edges_tensor generation:  0.0005915164947509766
mini_batch_src_global generation:  0.0005903244018554688
r_  generation:  0.005116462707519531
local_output_nid generation:  0.000713348388671875
local_in_edges_tensor generation:  0.0005681514739990234
mini_batch_src_global generation:  0.0005152225494384766
r_  generation:  0.004664182662963867
local_output_nid generation:  0.0007588863372802734
local_in_edges_tensor generation:  0.0005967617034912109
mini_batch_src_global generation:  0.0005071163177490234
r_  generation:  0.0046749114990234375
local_output_nid generation:  0.000751495361328125
local_in_edges_tensor generation:  0.0005943775177001953
mini_batch_src_global generation:  0.0005381107330322266
r_  generation:  0.0048828125
local_output_nid generation:  0.0007472038269042969
local_in_edges_tensor generation:  0.0005810260772705078
mini_batch_src_global generation:  0.0005307197570800781
r_  generation:  0.0045697689056396484
local_output_nid generation:  0.00075531005859375
local_in_edges_tensor generation:  0.0005865097045898438
mini_batch_src_global generation:  0.0004763603210449219
r_  generation:  0.004788875579833984
local_output_nid generation:  0.0007569789886474609
local_in_edges_tensor generation:  0.0006222724914550781
mini_batch_src_global generation:  0.0007386207580566406
r_  generation:  0.0059163570404052734
local_output_nid generation:  0.0008382797241210938
local_in_edges_tensor generation:  0.005669832229614258
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.006447792053222656
local_output_nid generation:  0.0007374286651611328
local_in_edges_tensor generation:  0.0006518363952636719
mini_batch_src_global generation:  0.0006868839263916016
r_  generation:  0.00512385368347168
local_output_nid generation:  0.0007314682006835938
local_in_edges_tensor generation:  0.0006363391876220703
mini_batch_src_global generation:  0.0007047653198242188
r_  generation:  0.005614519119262695
local_output_nid generation:  0.0007872581481933594
local_in_edges_tensor generation:  0.0006251335144042969
mini_batch_src_global generation:  0.0006551742553710938
r_  generation:  0.0050771236419677734
local_output_nid generation:  0.0007736682891845703
local_in_edges_tensor generation:  0.000614166259765625
mini_batch_src_global generation:  0.0006737709045410156
r_  generation:  0.0058460235595703125
local_output_nid generation:  0.0007679462432861328
local_in_edges_tensor generation:  0.0005893707275390625
mini_batch_src_global generation:  0.0006656646728515625
r_  generation:  0.005407094955444336
local_output_nid generation:  0.0007655620574951172
local_in_edges_tensor generation:  0.0007081031799316406
mini_batch_src_global generation:  0.0008032321929931641
r_  generation:  0.006296873092651367
----------------------check_connections_block total spend ----------------------------- 0.30208516120910645
generate_one_block  0.014657974243164062
generate_one_block  0.00847935676574707
generate_one_block  0.008626937866210938
generate_one_block  0.008323431015014648
generate_one_block  0.009065389633178711
generate_one_block  0.007672786712646484
generate_one_block  0.007306098937988281
generate_one_block  0.007318258285522461
generate_one_block  0.0076465606689453125
generate_one_block  0.008964300155639648
generate_one_block  0.00746917724609375
generate_one_block  0.006414175033569336
generate_one_block  0.00699615478515625
generate_one_block  0.007444620132446289
generate_one_block  0.0064563751220703125
generate_one_block  0.006250619888305664
generate_one_block  0.00726628303527832
generate_one_block  0.007496356964111328
generate_one_block  0.00836038589477539
generate_one_block  0.006920576095581055
generate_one_block  0.006871938705444336
generate_one_block  0.00754094123840332
generate_one_block  0.006400346755981445
generate_one_block  0.006423234939575195
generate_one_block  0.01063990592956543
generate_one_block  0.010868072509765625
generate_one_block  0.008297443389892578
generate_one_block  0.008694887161254883
generate_one_block  0.00809168815612793
generate_one_block  0.009598016738891602
generate_one_block  0.009107351303100586
generate_one_block  0.009841442108154297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0.30208516120910645
block generation total time  0.26151108741760254
average batch blocks generation time:  0.00817222148180008
pseudo mini batch 0 input nodes size: 5656
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00322723388671875  GigaBytes
Max Memory Allocated: 0.00322723388671875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032486915588378906  GigaBytes
Max Memory Allocated: 0.0032486915588378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032486915588378906  GigaBytes
Max Memory Allocated: 0.0032486915588378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0033783912658691406  GigaBytes
Max Memory Allocated: 0.0033783912658691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0033783912658691406  GigaBytes
Max Memory Allocated: 0.0033783912658691406  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0033783912658691406  GigaBytes
Max Memory Allocated: 0.0033783912658691406  GigaBytes

m.shape torch.Size([304, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.012062549591064453  GigaBytes
Max Memory Allocated: 0.012160301208496094  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.012062549591064453  GigaBytes
Max Memory Allocated: 0.012160301208496094  GigaBytes

 h.shape torch.Size([1, 304, 128]), torch.Size([1, 304, 128])
----------------------------------------3
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.012352466583251953  GigaBytes
Max Memory Allocated: 0.012352466583251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2049560546875 GB
    Memory Allocated: 0.014671802520751953  GigaBytes
Max Memory Allocated: 0.014816761016845703  GigaBytes

rst.shape  torch.Size([1, 304, 128])
m.shape torch.Size([348, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.014858722686767578  GigaBytes
Max Memory Allocated: 0.014866828918457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.014858722686767578  GigaBytes
Max Memory Allocated: 0.014866828918457031  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.015190601348876953  GigaBytes
Max Memory Allocated: 0.015190601348876953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2127685546875 GB
    Memory Allocated: 0.020168781280517578  GigaBytes
Max Memory Allocated: 0.020500659942626953  GigaBytes

rst.shape  torch.Size([1, 348, 128])
m.shape torch.Size([288, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2127685546875 GB
    Memory Allocated: 0.02041482925415039  GigaBytes
Max Memory Allocated: 0.020500659942626953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2127685546875 GB
    Memory Allocated: 0.02041482925415039  GigaBytes
Max Memory Allocated: 0.020500659942626953  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 1.2127685546875 GB
    Memory Allocated: 0.02068948745727539  GigaBytes
Max Memory Allocated: 0.02068948745727539  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2186279296875 GB
    Memory Allocated: 0.02673196792602539  GigaBytes
Max Memory Allocated: 0.02714395523071289  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([253, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2186279296875 GB
    Memory Allocated: 0.027077198028564453  GigaBytes
Max Memory Allocated: 0.02714395523071289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2186279296875 GB
    Memory Allocated: 0.027077198028564453  GigaBytes
Max Memory Allocated: 0.02714395523071289  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 1.2186279296875 GB
    Memory Allocated: 0.027318477630615234  GigaBytes
Max Memory Allocated: 0.027318477630615234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.03431558609008789  GigaBytes
Max Memory Allocated: 0.03479814529418945  GigaBytes

rst.shape  torch.Size([1, 253, 128])
m.shape torch.Size([178, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.03461933135986328  GigaBytes
Max Memory Allocated: 0.03479814529418945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.03461933135986328  GigaBytes
Max Memory Allocated: 0.03479814529418945  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.2264404296875 GB
    Memory Allocated: 0.034789085388183594  GigaBytes
Max Memory Allocated: 0.03479814529418945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.040900230407714844  GigaBytes
Max Memory Allocated: 0.041324615478515625  GigaBytes

rst.shape  torch.Size([1, 178, 128])
m.shape torch.Size([155, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.041258811950683594  GigaBytes
Max Memory Allocated: 0.041324615478515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.041258811950683594  GigaBytes
Max Memory Allocated: 0.041324615478515625  GigaBytes

 h.shape torch.Size([1, 155, 128]), torch.Size([1, 155, 128])
----------------------------------------3
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.04140663146972656  GigaBytes
Max Memory Allocated: 0.04140663146972656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.04776287078857422  GigaBytes
Max Memory Allocated: 0.048206329345703125  GigaBytes

rst.shape  torch.Size([1, 155, 128])
m.shape torch.Size([141, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.04815959930419922  GigaBytes
Max Memory Allocated: 0.048206329345703125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.04815959930419922  GigaBytes
Max Memory Allocated: 0.048206329345703125  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.0482940673828125  GigaBytes
Max Memory Allocated: 0.0482940673828125  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.05501747131347656  GigaBytes
Max Memory Allocated: 0.05548810958862305  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([115, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.0553889274597168  GigaBytes
Max Memory Allocated: 0.05548810958862305  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.0553889274597168  GigaBytes
Max Memory Allocated: 0.05548810958862305  GigaBytes

 h.shape torch.Size([1, 115, 128]), torch.Size([1, 115, 128])
----------------------------------------3
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.055498600006103516  GigaBytes
Max Memory Allocated: 0.055498600006103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.061749935150146484  GigaBytes
Max Memory Allocated: 0.06218862533569336  GigaBytes

rst.shape  torch.Size([1, 115, 128])
m.shape torch.Size([116, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.06219291687011719  GigaBytes
Max Memory Allocated: 0.06220531463623047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.06219291687011719  GigaBytes
Max Memory Allocated: 0.06220531463623047  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.06230354309082031  GigaBytes
Max Memory Allocated: 0.06230354309082031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.06938362121582031  GigaBytes
Max Memory Allocated: 0.06988143920898438  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([975, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07397747039794922  GigaBytes
Max Memory Allocated: 0.07408714294433594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07397747039794922  GigaBytes
Max Memory Allocated: 0.07408714294433594  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07444190979003906  GigaBytes
Max Memory Allocated: 0.07444190979003906  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.10741710662841797  GigaBytes
Max Memory Allocated: 0.10973930358886719  GigaBytes

rst 0 shape torch.Size([1, 487, 128])
----------------------------------------1
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.10741710662841797  GigaBytes
Max Memory Allocated: 0.10973930358886719  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.10741710662841797  GigaBytes
Max Memory Allocated: 0.10973930358886719  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.10788249969482422  GigaBytes
Max Memory Allocated: 0.10973930358886719  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.14069318771362305  GigaBytes
Max Memory Allocated: 0.14325237274169922  GigaBytes

rst 1 shape torch.Size([1, 488, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.13347482681274414  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.13390302658081055  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.13433122634887695  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.1338815689086914  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

torch.Size([2873, 40])
input nodes number: 5656
output nodes number: 2873
edges number: 17397
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.13437366485595703  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.13437461853027344  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.004542350769042969  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

pseudo mini batch 1 input nodes size: 5463
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.004208087921142578  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.004208087921142578  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.00681304931640625  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.0068340301513671875  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.004115581512451172  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.004218578338623047  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.004218578338623047  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.004218578338623047  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

m.shape torch.Size([487, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.011252403259277344  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.011252403259277344  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.011716842651367188  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.015432357788085938  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([448, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.015627384185791016  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.015627384185791016  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.016054630279541016  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.022463321685791016  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([301, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.022680282592773438  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.022680282592773438  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 301, 128]), torch.Size([1, 301, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.02296733856201172  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.029282569885253906  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 301, 128])
m.shape torch.Size([281, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.029675006866455078  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.029675006866455078  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 281, 128]), torch.Size([1, 281, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.029942989349365234  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.037714481353759766  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 281, 128])
m.shape torch.Size([192, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03803825378417969  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03803825378417969  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 192, 128]), torch.Size([1, 192, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03822135925292969  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.04481315612792969  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 192, 128])
m.shape torch.Size([180, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.04523658752441406  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.04523658752441406  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 180, 128]), torch.Size([1, 180, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.04540824890136719  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.05278968811035156  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 180, 128])
m.shape torch.Size([110, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.053071022033691406  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.053071022033691406  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.053175926208496094  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.05842113494873047  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([126, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.058849334716796875  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.058849334716796875  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 126, 128]), torch.Size([1, 126, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.05896949768066406  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.06581878662109375  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 126, 128])
m.shape torch.Size([98, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.06617927551269531  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.06617927551269531  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.06627273559570312  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.07225418090820312  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([571, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.07493019104003906  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.07493019104003906  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 285, 128]), torch.Size([1, 285, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.07520198822021484  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.09449958801269531  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst 0 shape torch.Size([1, 285, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.09449958801269531  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.09449958801269531  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 286, 128]), torch.Size([1, 286, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.0947723388671875  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.11400175094604492  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst 1 shape torch.Size([1, 286, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.1085515022277832  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.10896825790405273  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.10938501358032227  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.1089472770690918  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

torch.Size([2794, 40])
input nodes number: 5463
output nodes number: 2794
edges number: 13820
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.10899782180786133  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.10899829864501953  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.004382610321044922  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

pseudo mini batch 2 input nodes size: 5610
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.004104137420654297  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.004104137420654297  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.006801128387451172  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.006823062896728516  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.004197120666503906  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.00433349609375  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.00433349609375  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.00433349609375  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

m.shape torch.Size([270, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.013397693634033203  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.013397693634033203  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 270, 128]), torch.Size([1, 270, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.01365518569946289  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.01571512222290039  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 270, 128])
m.shape torch.Size([296, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.015868663787841797  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.015868663787841797  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 296, 128]), torch.Size([1, 296, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.016150951385498047  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.020385265350341797  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 296, 128])
m.shape torch.Size([264, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.020621776580810547  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.020621776580810547  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.020873546600341797  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.026412487030029297  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([220, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.026706218719482422  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.026706218719482422  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 220, 128]), torch.Size([1, 220, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.026916027069091797  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.03300046920776367  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 220, 128])
m.shape torch.Size([219, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.033417701721191406  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.033417701721191406  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 219, 128]), torch.Size([1, 219, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.033626556396484375  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.04114532470703125  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 219, 128])
m.shape torch.Size([221, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.04167318344116211  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.04167318344116211  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 221, 128]), torch.Size([1, 221, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.04188394546508789  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.050946712493896484  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 221, 128])
m.shape torch.Size([170, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.05140876770019531  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.05140876770019531  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.051570892333984375  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.0596771240234375  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 170, 128])
m.shape torch.Size([138, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.06012248992919922  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.06012248992919922  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.06025409698486328  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.06775569915771484  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([111, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.06816625595092773  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.06816625595092773  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.06827211380004883  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.07504701614379883  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst.shape  torch.Size([1, 111, 128])
m.shape torch.Size([996, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.0797433853149414  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.0797433853149414  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.08021831512451172  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.1139383316040039  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

rst 0 shape torch.Size([1, 498, 128])
----------------------------------------1
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.1139383316040039  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.1139383316040039  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.11441326141357422  GigaBytes
Max Memory Allocated: 0.14458703994750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.14789581298828125  GigaBytes
Max Memory Allocated: 0.15050792694091797  GigaBytes

rst 1 shape torch.Size([1, 498, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.14029932022094727  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.1407322883605957  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.14116525650024414  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.14071035385131836  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

torch.Size([2905, 40])
input nodes number: 5610
output nodes number: 2905
edges number: 18208
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.14079046249389648  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.1407909393310547  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.004560947418212891  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

pseudo mini batch 3 input nodes size: 5995
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.0042133331298828125  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.0042133331298828125  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.007071971893310547  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.007093906402587891  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.004374980926513672  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.004507541656494141  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.004507541656494141  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.004507541656494141  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

m.shape torch.Size([336, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.01337575912475586  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.01337575912475586  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 336, 128]), torch.Size([1, 336, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.01369619369506836  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.01625967025756836  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 336, 128])
m.shape torch.Size([301, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.01638650894165039  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.01638650894165039  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 301, 128]), torch.Size([1, 301, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.016673564910888672  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.02097940444946289  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 301, 128])
m.shape torch.Size([288, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.02124786376953125  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.02124786376953125  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.02152252197265625  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.02756500244140625  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([235, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.027875900268554688  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.027875900268554688  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.028100013732910156  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.03459930419921875  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 235, 128])
m.shape torch.Size([197, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.034956932067871094  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.034956932067871094  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.035144805908203125  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.04190826416015625  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([153, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.0422520637512207  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.0422520637512207  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 153, 128]), torch.Size([1, 153, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.04239797592163086  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.04867219924926758  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 153, 128])
m.shape torch.Size([132, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.04903984069824219  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.04903984069824219  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 132, 128]), torch.Size([1, 132, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.04916572570800781  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.05545997619628906  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 132, 128])
m.shape torch.Size([135, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.055912017822265625  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.055912017822265625  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.05604076385498047  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.06337928771972656  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([110, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.06378698348999023  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.06378698348999023  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.06389188766479492  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.07060575485229492  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([1010, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.07607030868530273  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.07607030868530273  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.07655191421508789  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.11074590682983398  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst 0 shape torch.Size([1, 505, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.11074590682983398  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.11074590682983398  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.11122751235961914  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.14518070220947266  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst 1 shape torch.Size([1, 505, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.1378006935119629  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.13823270797729492  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.13866472244262695  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.13821077346801758  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

torch.Size([2897, 40])
input nodes number: 5995
output nodes number: 2897
edges number: 17739
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.1382765769958496  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.1382770538330078  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.0047168731689453125  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

pseudo mini batch 4 input nodes size: 6896
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.004374027252197266  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.004374027252197266  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.007662296295166016  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.007684230804443359  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.004803657531738281  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.004940986633300781  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.004940986633300781  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.004940986633300781  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

m.shape torch.Size([313, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.014118194580078125  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.014118194580078125  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 313, 128]), torch.Size([1, 313, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.014416694641113281  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.01680469512939453  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 313, 128])
m.shape torch.Size([297, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.01693868637084961  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.01693868637084961  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 297, 128]), torch.Size([1, 297, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.017221927642822266  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.02147054672241211  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 297, 128])
m.shape torch.Size([283, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.021733760833740234  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.021733760833740234  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.022003650665283203  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.027941226959228516  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 283, 128])
m.shape torch.Size([211, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.02820873260498047  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.02820873260498047  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.028409957885742188  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.03424549102783203  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 211, 128])
m.shape torch.Size([181, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.034576416015625  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.034576416015625  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.03474903106689453  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.040963172912597656  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 181, 128])
m.shape torch.Size([158, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.04132890701293945  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.04132890701293945  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 158, 128]), torch.Size([1, 158, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.04147958755493164  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.0479588508605957  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 158, 128])
m.shape torch.Size([163, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.048427581787109375  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.048427581787109375  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 163, 128]), torch.Size([1, 163, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.048583030700683594  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.05635547637939453  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 163, 128])
m.shape torch.Size([143, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.0568232536315918  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.0568232536315918  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.05695962905883789  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.06473302841186523  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([117, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.06516695022583008  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.06516695022583008  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.06527853012084961  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.07241964340209961  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([1061, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.07791948318481445  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.07791948318481445  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.07842493057250977  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.11553812026977539  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

rst 0 shape torch.Size([1, 530, 128])
----------------------------------------1
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.11553812026977539  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.11553812026977539  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.11604452133178711  GigaBytes
Max Memory Allocated: 0.15246248245239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.15234136581420898  GigaBytes
Max Memory Allocated: 0.15512609481811523  GigaBytes

rst 1 shape torch.Size([1, 531, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14464807510375977  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14508438110351562  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14552068710327148  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14506244659423828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2927, 40])
input nodes number: 6896
output nodes number: 2927
edges number: 18401
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1451401710510254  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1451406478881836  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0051670074462890625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 5 input nodes size: 6664
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004807949066162109  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004807949066162109  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007985591888427734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.008006572723388672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004696369171142578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004813671112060547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004813671112060547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004813671112060547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([430, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012718677520751953  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012718677520751953  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01312875747680664  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01640939712524414  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([340, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016528606414794922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016528606414794922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016852855682373047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.021716594696044922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([285, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02196216583251953  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02196216583251953  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 285, 128]), torch.Size([1, 285, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022233963012695312  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0282135009765625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 285, 128])
m.shape torch.Size([241, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028537273406982422  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028537273406982422  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 241, 128]), torch.Size([1, 241, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028767108917236328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03543233871459961  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 241, 128])
m.shape torch.Size([222, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.035846710205078125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.035846710205078125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 222, 128]), torch.Size([1, 222, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03605842590332031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04368019104003906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 222, 128])
m.shape torch.Size([163, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.044040679931640625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.044040679931640625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 163, 128]), torch.Size([1, 163, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.044196128845214844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05088043212890625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 163, 128])
m.shape torch.Size([121, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05120658874511719  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05120658874511719  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051321983337402344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.057091712951660156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([100, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05741548538208008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05741548538208008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0575108528137207  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06294679641723633  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([104, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06334543228149414  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06334543228149414  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06344461441040039  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06979227066040039  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 104, 128])
m.shape torch.Size([807, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07359075546264648  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07359075546264648  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 403, 128]), torch.Size([1, 403, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0739750862121582  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10126256942749023  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 403, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10126256942749023  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10126256942749023  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 404, 128]), torch.Size([1, 404, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10164785385131836  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12881088256835938  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 404, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12242937088012695  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1228489875793457  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12326860427856445  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12282800674438477  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2813, 40])
input nodes number: 6664
output nodes number: 2813
edges number: 15670
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12288236618041992  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12288284301757812  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004995822906494141  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 6 input nodes size: 5868
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004679679870605469  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004679679870605469  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007477760314941406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00749969482421875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0043010711669921875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00441741943359375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00441741943359375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00441741943359375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([433, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012265205383300781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012265205383300781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 433, 128]), torch.Size([1, 433, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012678146362304688  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.015981674194335938  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 433, 128])
m.shape torch.Size([432, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016187191009521484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016187191009521484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 432, 128]), torch.Size([1, 432, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016599178314208984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022778987884521484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 432, 128])
m.shape torch.Size([317, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023026466369628906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023026466369628906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023328781127929688  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.029979705810546875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([253, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.030311107635498047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.030311107635498047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.030552387237548828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.037549495697021484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 253, 128])
m.shape torch.Size([187, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.037874698638916016  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.037874698638916016  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 187, 128]), torch.Size([1, 187, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.038053035736083984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04447317123413086  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 187, 128])
m.shape torch.Size([149, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04481029510498047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04481029510498047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 149, 128]), torch.Size([1, 149, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.044952392578125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051062583923339844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 149, 128])
m.shape torch.Size([126, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051412105560302734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051412105560302734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 126, 128]), torch.Size([1, 126, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05153226852416992  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0575404167175293  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 126, 128])
m.shape torch.Size([94, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05783891677856445  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05783891677856445  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 94, 128]), torch.Size([1, 94, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05792856216430664  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06303834915161133  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 94, 128])
m.shape torch.Size([110, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06346559524536133  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06346559524536133  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06357049942016602  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07028436660766602  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([783, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07396554946899414  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07396554946899414  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 391, 128]), torch.Size([1, 391, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07433843612670898  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10081338882446289  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 391, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10081338882446289  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10081338882446289  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 392, 128]), torch.Size([1, 392, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10118722915649414  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12754344940185547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 392, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1216888427734375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12211894989013672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12254905700683594  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12209701538085938  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2884, 40])
input nodes number: 5868
output nodes number: 2884
edges number: 15543
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12217330932617188  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12217378616333008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004621028900146484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 7 input nodes size: 6259
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004311561584472656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004311561584472656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007489204406738281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007510185241699219  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0046901702880859375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0048084259033203125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0048084259033203125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0048084259033203125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([400, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012747764587402344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012747764587402344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.013129234313964844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016180992126464844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 400, 128])
m.shape torch.Size([345, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01631927490234375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01631927490234375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016648292541503906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02158355712890625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([320, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.021876811981201172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.021876811981201172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022181987762451172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028895854949951172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([234, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.029189586639404297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.029189586639404297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02941274642944336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03588438034057617  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 234, 128])
m.shape torch.Size([191, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.036228179931640625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.036228179931640625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03641033172607422  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.042967796325683594  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([150, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04330587387084961  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04330587387084961  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04344892501831055  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04960012435913086  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 150, 128])
m.shape torch.Size([131, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.049965858459472656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.049965858459472656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 131, 128]), torch.Size([1, 131, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.050090789794921875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05633735656738281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 131, 128])
m.shape torch.Size([101, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05666017532348633  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05666017532348633  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05675649642944336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06224679946899414  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([89, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06258058547973633  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06258058547973633  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06266546249389648  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06809759140014648  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([840, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07206058502197266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07206058502197266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07246112823486328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10089969635009766  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 420, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10089969635009766  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10089969635009766  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10130023956298828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12953853607177734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 420, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12391901016235352  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12433671951293945  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12475442886352539  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12431573867797852  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2801, 40])
input nodes number: 6259
output nodes number: 2801
edges number: 15767
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12437105178833008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12437152862548828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004992485046386719  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 8 input nodes size: 6143
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004677772521972656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004677772521972656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007606983184814453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007628440856933594  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004429817199707031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004555702209472656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004555702209472656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004555702209472656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([374, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012995243072509766  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012995243072509766  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.013351917266845703  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016205310821533203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([340, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01635122299194336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01635122299194336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016675472259521484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02153921127319336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([284, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02178335189819336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02178335189819336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022054195404052734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028012752532958984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 284, 128])
m.shape torch.Size([229, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02831411361694336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02831411361694336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 229, 128]), torch.Size([1, 229, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02853250503540039  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0348658561706543  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 229, 128])
m.shape torch.Size([194, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03521919250488281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03521919250488281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 194, 128]), torch.Size([1, 194, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.035404205322265625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.042064666748046875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 194, 128])
m.shape torch.Size([133, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04235267639160156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04235267639160156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 133, 128]), torch.Size([1, 133, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.042479515075683594  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04793357849121094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 133, 128])
m.shape torch.Size([141, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.048340797424316406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.048340797424316406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04847526550292969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05519866943359375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([123, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.055600643157958984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.055600643157958984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05571794509887695  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06240415573120117  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([101, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06277894973754883  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06277894973754883  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06287527084350586  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06903982162475586  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([935, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07439565658569336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07439565658569336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 467, 128]), torch.Size([1, 467, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07484102249145508  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10646200180053711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 467, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10646200180053711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10646200180053711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10690832138061523  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13837432861328125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 468, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13143062591552734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13185596466064453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13228130340576172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1318345069885254  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2854, 40])
input nodes number: 6143
output nodes number: 2854
edges number: 16820
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13190937042236328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13190984725952148  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004767417907714844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 9 input nodes size: 8065
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004437446594238281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004437446594238281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.008283138275146484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.008305072784423828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005354404449462891  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005486965179443359  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005486965179443359  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005486965179443359  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([397, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.014373779296875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.014373779296875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 397, 128]), torch.Size([1, 397, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.014752388000488281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01778125762939453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 397, 128])
m.shape torch.Size([326, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017902851104736328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017902851104736328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.018213748931884766  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022877216339111328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([236, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023059368133544922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023059368133544922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023284435272216797  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028235912322998047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([206, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028516292572021484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028516292572021484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 206, 128]), torch.Size([1, 206, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028712749481201172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03440999984741211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 206, 128])
m.shape torch.Size([175, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03472900390625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03472900390625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 175, 128]), torch.Size([1, 175, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.034895896911621094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04090404510498047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 175, 128])
m.shape torch.Size([152, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04125547409057617  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04125547409057617  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 152, 128]), torch.Size([1, 152, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04140043258666992  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04763364791870117  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 152, 128])
m.shape torch.Size([143, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.048038482666015625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.048038482666015625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04817485809326172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.054993629455566406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([121, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.055387020111083984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.055387020111083984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05550241470336914  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06207990646362305  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([100, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06245136260986328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06245136260986328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0625467300415039  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0686502456665039  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([1048, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07359981536865234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07359981536865234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07409954071044922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11036300659179688  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 524, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11036300659179688  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11036300659179688  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11086273193359375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14717674255371094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 524, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1398015022277832  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14023447036743164  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14066743850708008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1402125358581543  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2904, 40])
input nodes number: 8065
output nodes number: 2904
edges number: 17717
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1403026580810547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1403031349182129  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005720615386962891  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 10 input nodes size: 5942
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005362033843994141  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005362033843994141  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00819540023803711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.008217334747314453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004349708557128906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004471778869628906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004471778869628906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004471778869628906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([411, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012686729431152344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012686729431152344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.013078689575195312  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016214370727539062  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([342, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016344547271728516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016344547271728516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016670703887939453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.021563053131103516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([284, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02180624008178711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02180624008178711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022077083587646484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028035640716552734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 284, 128])
m.shape torch.Size([252, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028380870819091797  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028380870819091797  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 252, 128]), torch.Size([1, 252, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028621196746826172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03559064865112305  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 252, 128])
m.shape torch.Size([213, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03597831726074219  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03597831726074219  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 213, 128]), torch.Size([1, 213, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03618144989013672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.043494224548339844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 213, 128])
m.shape torch.Size([179, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.043904781341552734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.043904781341552734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 179, 128]), torch.Size([1, 179, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04407548904418945  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05141592025756836  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 179, 128])
m.shape torch.Size([136, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051784515380859375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051784515380859375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051914215087890625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.058399200439453125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([160, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0589447021484375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0589447021484375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 160, 128]), torch.Size([1, 160, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0590972900390625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0677947998046875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 160, 128])
m.shape torch.Size([108, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06818199157714844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06818199157714844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06828498840332031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07487678527832031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([802, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07864952087402344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07864952087402344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 401, 128]), torch.Size([1, 401, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07903194427490234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10618400573730469  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 401, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10618400573730469  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10618400573730469  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 401, 128]), torch.Size([1, 401, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1065664291381836  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13352727890014648  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 401, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12783336639404297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1282639503479004  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1286945343017578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12824201583862305  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2887, 40])
input nodes number: 5942
output nodes number: 2887
edges number: 16318
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12830591201782227  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12830638885498047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004668712615966797  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 11 input nodes size: 6257
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004347324371337891  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004347324371337891  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007330894470214844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007352352142333984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004497051239013672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004595279693603516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004595279693603516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004595279693603516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([593, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.011336326599121094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.011336326599121094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01190185546875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016997337341308594  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([460, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017153263092041016  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017153263092041016  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01759195327758789  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024172306060791016  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([355, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024460792541503906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024460792541503906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024799346923828125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03224754333496094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([260, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03257417678833008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03257417678833008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0328221321105957  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04001283645629883  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([218, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04040861129760742  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04040861129760742  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.040616512298583984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.048100948333740234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 218, 128])
m.shape torch.Size([134, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.048380374908447266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.048380374908447266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 134, 128]), torch.Size([1, 134, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0485081672668457  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.054003238677978516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 134, 128])
m.shape torch.Size([131, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05437660217285156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05437660217285156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 131, 128]), torch.Size([1, 131, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05450153350830078  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06074810028076172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 131, 128])
m.shape torch.Size([116, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06112813949584961  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06112813949584961  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.061238765716552734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06754446029663086  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([72, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06779813766479492  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06779813766479492  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 72, 128]), torch.Size([1, 72, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06786680221557617  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07226133346557617  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 72, 128])
m.shape torch.Size([509, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07465410232543945  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07465410232543945  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 254, 128]), torch.Size([1, 254, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07489633560180664  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09209489822387695  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 254, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09209489822387695  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09209489822387695  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09233808517456055  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10948324203491211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 255, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10441350936889648  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10483789443969727  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10526227951049805  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10481643676757812  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2848, 40])
input nodes number: 6257
output nodes number: 2848
edges number: 13095
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10487842559814453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10487890243530273  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0047664642333984375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 12 input nodes size: 5355
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004490852355957031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004490852355957031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00732421875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007346153259277344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00434112548828125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004454612731933594  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004454612731933594  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004454612731933594  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([448, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012112140655517578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012112140655517578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012539386749267578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.015957355499267578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([385, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016110897064208984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016110897064208984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 385, 128]), torch.Size([1, 385, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01647806167602539  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.021985530853271484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 385, 128])
m.shape torch.Size([328, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022271156311035156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022271156311035156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022583961486816406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.029465675354003906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([283, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02984905242919922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02984905242919922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.030118942260742188  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03794574737548828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 283, 128])
m.shape torch.Size([212, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03831624984741211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03831624984741211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 212, 128]), torch.Size([1, 212, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.038518428802490234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.045796871185302734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 212, 128])
m.shape torch.Size([192, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04624509811401367  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04624509811401367  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 192, 128]), torch.Size([1, 192, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04642820358276367  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05430173873901367  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 192, 128])
m.shape torch.Size([174, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05479097366333008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05479097366333008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 174, 128]), torch.Size([1, 174, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.054956912994384766  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06325387954711914  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 174, 128])
m.shape torch.Size([125, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06364774703979492  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06364774703979492  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0637669563293457  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07056188583374023  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([121, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07102155685424805  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07102155685424805  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0711369514465332  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0785222053527832  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([628, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.08145904541015625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.08145904541015625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 314, 128]), torch.Size([1, 314, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.08175849914550781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10301971435546875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 314, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10301971435546875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10301971435546875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 314, 128]), torch.Size([1, 314, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10331916809082031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12443065643310547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 314, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11838626861572266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11881780624389648  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11924934387207031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11879587173461914  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2896, 40])
input nodes number: 5355
output nodes number: 2896
edges number: 15133
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1188650131225586  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1188654899597168  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0046482086181640625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 13 input nodes size: 6006
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004348278045654297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004348278045654297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007212162017822266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007234096527099609  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004378795623779297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004497051239013672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004497051239013672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004497051239013672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([427, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012495994567871094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012495994567871094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012903213500976562  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016160964965820312  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([377, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016316890716552734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016316890716552734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 377, 128]), torch.Size([1, 377, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01667642593383789  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022069454193115234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 377, 128])
m.shape torch.Size([332, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02236461639404297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02236461639404297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 332, 128]), torch.Size([1, 332, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022681236267089844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.029646873474121094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 332, 128])
m.shape torch.Size([241, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02994823455810547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02994823455810547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 241, 128]), torch.Size([1, 241, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.030178070068359375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.036843299865722656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 241, 128])
m.shape torch.Size([197, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03719806671142578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03719806671142578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03738594055175781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04414939880371094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([157, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.044504642486572266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.044504642486572266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 157, 128]), torch.Size([1, 157, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04465436935424805  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05109262466430664  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 157, 128])
m.shape torch.Size([147, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051508426666259766  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051508426666259766  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 147, 128]), torch.Size([1, 147, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051648616790771484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05865812301635742  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 147, 128])
m.shape torch.Size([117, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05903434753417969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05903434753417969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05914592742919922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0655059814453125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([105, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06590080261230469  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06590080261230469  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06600093841552734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07240962982177734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([788, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07611703872680664  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07611703872680664  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0764927864074707  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10317087173461914  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 394, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10317087173461914  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10317087173461914  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1035466194152832  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1300368309020996  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 394, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12368297576904297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12411355972290039  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12454414367675781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12409162521362305  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2888, 40])
input nodes number: 6006
output nodes number: 2888
edges number: 15858
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12415742874145508  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12415790557861328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00469207763671875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 14 input nodes size: 5055
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004377841949462891  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004377841949462891  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007211208343505859  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007233142852783203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004347324371337891  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004446506500244141  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004446506500244141  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004446506500244141  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([512, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.011225700378417969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.011225700378417969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.011713981628417969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.015620231628417969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([508, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.015860557556152344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.015860557556152344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01634502410888672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023612022399902344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([371, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023900508880615234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023900508880615234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 371, 128]), torch.Size([1, 371, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024254322052001953  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.032038211822509766  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 371, 128])
m.shape torch.Size([262, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03236103057861328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03236103057861328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03261089324951172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.039856910705566406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 262, 128])
m.shape torch.Size([255, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04033994674682617  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04033994674682617  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.040583133697509766  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04933786392211914  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 255, 128])
m.shape torch.Size([176, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.049719810485839844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.049719810485839844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.049887657165527344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.057105064392089844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([164, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05756855010986328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05756855010986328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 164, 128]), torch.Size([1, 164, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.057724952697753906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06554508209228516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 164, 128])
m.shape torch.Size([106, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0658712387084961  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0658712387084961  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06597232818603516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07173442840576172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 106, 128])
m.shape torch.Size([96, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07209587097167969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07209587097167969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07218742370605469  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07804679870605469  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([438, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.08008956909179688  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.08008956909179688  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 219, 128]), torch.Size([1, 219, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.08029842376708984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09512710571289062  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 219, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09512710571289062  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09512710571289062  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 219, 128]), torch.Size([1, 219, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0953359603881836  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11006021499633789  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 219, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10495185852050781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10538244247436523  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10581302642822266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10536050796508789  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2888, 40])
input nodes number: 5055
output nodes number: 2888
edges number: 13260
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10542011260986328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10542058944702148  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004616260528564453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 15 input nodes size: 5173
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004347324371337891  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004347324371337891  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.006814002990722656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0068359375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0039806365966796875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004076957702636719  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004076957702636719  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004076957702636719  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([553, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.010700225830078125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.010700225830078125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.011227607727050781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016170501708984375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([490, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01637411117553711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01637411117553711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016841411590576172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02385091781616211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([376, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024155139923095703  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024155139923095703  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024513721466064453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03240251541137695  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 376, 128])
m.shape torch.Size([290, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0327763557434082  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0327763557434082  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 290, 128]), torch.Size([1, 290, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.033052921295166016  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04107332229614258  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 290, 128])
m.shape torch.Size([247, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04152393341064453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04152393341064453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 247, 128]), torch.Size([1, 247, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.041759490966796875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05023956298828125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 247, 128])
m.shape torch.Size([172, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0506138801574707  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0506138801574707  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05077791213989258  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0578312873840332  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 172, 128])
m.shape torch.Size([129, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05817985534667969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05817985534667969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.058302879333496094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0644540786743164  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 129, 128])
m.shape torch.Size([134, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06490373611450195  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06490373611450195  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 134, 128]), torch.Size([1, 134, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06503152847290039  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07231569290161133  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 134, 128])
m.shape torch.Size([81, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07259941101074219  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07259941101074219  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0726766586303711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0776205062866211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([410, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07953691482543945  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07953691482543945  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07973241806030273  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0936131477355957  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 205, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0936131477355957  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0936131477355957  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09380865097045898  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10759162902832031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 205, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10361099243164062  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10404062271118164  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10447025299072266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1040186882019043  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2882, 40])
input nodes number: 5173
output nodes number: 2882
edges number: 12892
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10407829284667969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10407876968383789  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0042438507080078125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 16 input nodes size: 6816
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.003979682922363281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.003979682922363281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007229804992675781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007251262664794922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0047626495361328125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0048694610595703125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0048694610595703125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0048694610595703125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([502, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012111663818359375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012111663818359375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012590408325195312  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016420364379882812  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([461, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016620635986328125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016620635986328125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017060279846191406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023654937744140625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([324, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023898601531982422  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023898601531982422  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 324, 128]), torch.Size([1, 324, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024207592010498047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.031005382537841797  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 324, 128])
m.shape torch.Size([250, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03132772445678711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03132772445678711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 250, 128]), torch.Size([1, 250, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03156614303588867  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.038480281829833984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 250, 128])
m.shape torch.Size([243, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0389404296875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0389404296875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03917217254638672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.047514915466308594  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([152, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.047833919525146484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.047833919525146484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 152, 128]), torch.Size([1, 152, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.047978878021240234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.054212093353271484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 152, 128])
m.shape torch.Size([129, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05457019805908203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05457019805908203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05469322204589844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06084442138671875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 129, 128])
m.shape torch.Size([97, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06115293502807617  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06115293502807617  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06124544143676758  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06651830673217773  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([100, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06690120697021484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06690120697021484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06699657440185547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07310009002685547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([612, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07597064971923828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07597064971923828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 306, 128]), torch.Size([1, 306, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0762624740600586  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09698200225830078  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 306, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09698200225830078  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09698200225830078  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 306, 128]), torch.Size([1, 306, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0972738265991211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11784744262695312  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 306, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1122279167175293  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1126556396484375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1130833625793457  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11263418197631836  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2870, 40])
input nodes number: 6816
output nodes number: 2870
edges number: 14222
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11270475387573242  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11270523071289062  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005057811737060547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 17 input nodes size: 8624
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0047607421875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0047607421875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00887298583984375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.008893966674804688  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005622386932373047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005727291107177734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005727291107177734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005727291107177734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([535, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012885093688964844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012885093688964844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.013395309448242188  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017477035522460938  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([406, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017609119415283203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017609119415283203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01799631118774414  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023804187774658203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([309, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02405261993408203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02405261993408203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024347305297851562  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03083038330078125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 309, 128])
m.shape torch.Size([220, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.031102657318115234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.031102657318115234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 220, 128]), torch.Size([1, 220, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03131246566772461  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.037396907806396484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 220, 128])
m.shape torch.Size([225, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03782844543457031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03782844543457031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 225, 128]), torch.Size([1, 225, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03804302215576172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.045767784118652344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 225, 128])
m.shape torch.Size([146, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04607820510864258  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04607820510864258  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04621744155883789  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05220460891723633  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([135, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.052585601806640625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.052585601806640625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05271434783935547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.059151649475097656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([96, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.059453487396240234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.059453487396240234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.059545040130615234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06476354598999023  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([80, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06506109237670898  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06506109237670898  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06513738632202148  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07002019882202148  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([643, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07304811477661133  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07304811477661133  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07335424423217773  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09508943557739258  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 321, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09508943557739258  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09508943557739258  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09539651870727539  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11704635620117188  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 322, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1114802360534668  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11189699172973633  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11231374740600586  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11187601089477539  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2795, 40])
input nodes number: 8624
output nodes number: 2795
edges number: 14018
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11195039749145508  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11195087432861328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005917072296142578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 18 input nodes size: 10023
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005611419677734375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005611419677734375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.010390758514404297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.010411739349365234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.006278514862060547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.006400585174560547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.006400585174560547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.006400585174560547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([441, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.014595508575439453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.014595508575439453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01501607894897461  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01838064193725586  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([342, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01849651336669922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01849651336669922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.018822669982910156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02371501922607422  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([255, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02391672134399414  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02391672134399414  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024159908294677734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.029510021209716797  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 255, 128])
m.shape torch.Size([173, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.029718399047851562  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.029718399047851562  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.029883384704589844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03466796875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 173, 128])
m.shape torch.Size([185, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03502655029296875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03502655029296875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.035202980041503906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04155445098876953  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([167, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.041944026947021484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.041944026947021484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04210329055786133  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04895162582397461  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 167, 128])
m.shape torch.Size([125, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04928922653198242  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04928922653198242  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0494084358215332  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.055368900299072266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([123, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05577850341796875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05577850341796875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05589580535888672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06258201599121094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([79, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06286239624023438  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06286239624023438  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06293773651123047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06775951385498047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([918, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07209920883178711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07209920883178711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07253694534301758  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10361623764038086  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 459, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10361623764038086  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10361623764038086  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10405397415161133  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13491439819335938  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 459, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12822437286376953  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12864303588867188  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12906169891357422  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12862205505371094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2808, 40])
input nodes number: 10023
output nodes number: 2808
edges number: 16259
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12871980667114258  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12872028350830078  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.006630897521972656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 19 input nodes size: 8149
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.006280422210693359  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.006280422210693359  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01039266586303711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.010413646697998047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0056133270263671875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005710601806640625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005710601806640625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005710601806640625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([531, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012395858764648438  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012395858764648438  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012902259826660156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016953468322753906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([482, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01715993881225586  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01715993881225586  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017619609832763672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02451467514038086  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([321, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024744033813476562  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024744033813476562  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02505016326904297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.031785011291503906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([264, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0321354866027832  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0321354866027832  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03238725662231445  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0396885871887207  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([185, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04000377655029297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04000377655029297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.040180206298828125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04653167724609375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([159, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04689836502075195  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04689836502075195  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 159, 128]), torch.Size([1, 159, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04704999923706055  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05357027053833008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 159, 128])
m.shape torch.Size([103, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.053838253021240234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.053838253021240234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05393648147583008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.058847904205322266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([105, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05919933319091797  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05919933319091797  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.059299468994140625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06500720977783203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([74, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06527471542358398  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06527471542358398  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06534528732299805  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06986188888549805  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([543, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07241582870483398  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07241582870483398  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 271, 128]), torch.Size([1, 271, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07267427444458008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09102392196655273  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 271, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09102392196655273  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09102392196655273  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 272, 128]), torch.Size([1, 272, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09128332138061523  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10957145690917969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 272, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10447883605957031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10489130020141602  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10530376434326172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10487031936645508  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2767, 40])
input nodes number: 8149
output nodes number: 2767
edges number: 13050
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10494613647460938  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10494661331176758  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005894184112548828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 20 input nodes size: 6942
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005607128143310547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005607128143310547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00891733169555664  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.008938789367675781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004805564880371094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004910469055175781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004910469055175781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004910469055175781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([537, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012049674987792969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012049674987792969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.012561798095703125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016658782958984375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([412, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016795635223388672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016795635223388672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017188549041748047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023082256317138672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([348, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023383617401123047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023383617401123047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023715496063232422  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.031016826629638672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 348, 128])
m.shape torch.Size([268, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.031362056732177734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.031362056732177734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 268, 128]), torch.Size([1, 268, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03161764144897461  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.039029598236083984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 268, 128])
m.shape torch.Size([228, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03944540023803711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03944540023803711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 228, 128]), torch.Size([1, 228, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.039662837982177734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.047490596771240234  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 228, 128])
m.shape torch.Size([180, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0478968620300293  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0478968620300293  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 180, 128]), torch.Size([1, 180, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04806852340698242  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0554499626159668  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 180, 128])
m.shape torch.Size([130, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05579805374145508  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05579805374145508  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 130, 128]), torch.Size([1, 130, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05592203140258789  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.062120914459228516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 130, 128])
m.shape torch.Size([128, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06254720687866211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06254720687866211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06266927719116211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06962728500366211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([108, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07002973556518555  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07002973556518555  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07013273239135742  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07672452926635742  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([537, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07923364639282227  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07923364639282227  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 268, 128]), torch.Size([1, 268, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07948923110961914  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09763574600219727  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 268, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09763574600219727  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09763574600219727  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09789228439331055  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11597871780395508  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 269, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11049747467041016  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11092615127563477  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11135482788085938  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11090469360351562  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2876, 40])
input nodes number: 6942
output nodes number: 2876
edges number: 13973
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11099433898925781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11099481582641602  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005115985870361328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 21 input nodes size: 7235
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00482177734375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00482177734375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.00893402099609375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.008955001831054688  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005623340606689453  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005733966827392578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005733966827392578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005733966827392578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([488, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.013211250305175781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.013211250305175781  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.013676643371582031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.01739978790283203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([392, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017540931701660156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017540931701660156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 392, 128]), torch.Size([1, 392, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017914772033691406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023522377014160156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 392, 128])
m.shape torch.Size([310, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023778915405273438  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023778915405273438  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 310, 128]), torch.Size([1, 310, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.024074554443359375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03057861328125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 310, 128])
m.shape torch.Size([245, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.030898094177246094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.030898094177246094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 245, 128]), torch.Size([1, 245, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.031131744384765625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03790760040283203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 245, 128])
m.shape torch.Size([194, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0382533073425293  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0382533073425293  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 194, 128]), torch.Size([1, 194, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03843832015991211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04509878158569336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 194, 128])
m.shape torch.Size([137, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04539823532104492  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04539823532104492  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 137, 128]), torch.Size([1, 137, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04552888870239258  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0511469841003418  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 137, 128])
m.shape torch.Size([118, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05147552490234375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05147552490234375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 118, 128]), torch.Size([1, 118, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05158805847167969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05721473693847656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 118, 128])
m.shape torch.Size([125, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05763530731201172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05763530731201172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0577545166015625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06454944610595703  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([101, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06492328643798828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06492328643798828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06501960754394531  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07118415832519531  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([702, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07448339462280273  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07448339462280273  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07481813430786133  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09858465194702148  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 351, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09858465194702148  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09858465194702148  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09891939163208008  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12251853942871094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 351, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11661052703857422  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11702966690063477  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11744880676269531  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11700868606567383  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2812, 40])
input nodes number: 7235
output nodes number: 2812
edges number: 14729
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11707448959350586  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11707496643066406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005920886993408203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 22 input nodes size: 5572
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005613803863525391  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.005613803863525391  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.008270740509033203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.008292198181152344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004158973693847656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0042591094970703125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0042591094970703125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0042591094970703125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([516, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.011070728302001953  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.011070728302001953  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.011562824249267578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.015499591827392578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([465, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.015697002410888672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.015697002410888672  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016140460968017578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022792339324951172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([359, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023084163665771484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023084163665771484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023426532745361328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03095865249633789  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([305, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03136920928955078  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03136920928955078  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03166007995605469  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04009532928466797  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([239, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04051971435546875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04051971435546875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 239, 128]), torch.Size([1, 239, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.040747642517089844  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04895305633544922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 239, 128])
m.shape torch.Size([186, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04937124252319336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04937124252319336  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 186, 128]), torch.Size([1, 186, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04954862594604492  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05717611312866211  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 186, 128])
m.shape torch.Size([130, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05752134323120117  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05752134323120117  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 130, 128]), torch.Size([1, 130, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.057645320892333984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06384420394897461  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 130, 128])
m.shape torch.Size([93, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06413698196411133  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06413698196411133  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 93, 128]), torch.Size([1, 93, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06422567367553711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06928110122680664  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 93, 128])
m.shape torch.Size([90, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06962299346923828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06962299346923828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06970882415771484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07520198822021484  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([480, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07744789123535156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07744789123535156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 240, 128]), torch.Size([1, 240, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07767677307128906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09392738342285156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 240, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09392738342285156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09392738342285156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 240, 128]), torch.Size([1, 240, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09415626525878906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11029243469238281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 240, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10515880584716797  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10558557510375977  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10601234436035156  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10556411743164062  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2863, 40])
input nodes number: 5572
output nodes number: 2863
edges number: 13318
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10563516616821289  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1056356430053711  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004441261291503906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 23 input nodes size: 5688
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004166603088378906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004166603088378906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.006878852844238281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.006899833679199219  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004221439361572266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004320621490478516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004320621490478516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004320621490478516  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([507, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.011078357696533203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.011078357696533203  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.011561870574951172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.015429973602294922  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([459, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.015625953674316406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.015625953674316406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.016063690185546875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.022629737854003906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([371, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02294158935546875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02294158935546875  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 371, 128]), torch.Size([1, 371, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02329540252685547  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03107929229736328  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 371, 128])
m.shape torch.Size([258, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03139448165893555  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03139448165893555  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03164052963256836  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03877592086791992  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 258, 128])
m.shape torch.Size([231, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.039203643798828125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.039203643798828125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03942394256591797  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.047354698181152344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([169, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04772806167602539  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04772806167602539  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 169, 128]), torch.Size([1, 169, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04788923263549805  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.054819583892822266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 169, 128])
m.shape torch.Size([120, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05513954162597656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05513954162597656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05525398254394531  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06097602844238281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([117, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06136512756347656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06136512756347656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.061476707458496094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06783676147460938  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([89, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06816291809082031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06816291809082031  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06824779510498047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07367992401123047  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([491, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07597875595092773  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07597875595092773  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 245, 128]), torch.Size([1, 245, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.07621240615844727  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09280157089233398  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 245, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09280157089233398  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09280157089233398  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 246, 128]), torch.Size([1, 246, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.09303617477416992  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10957622528076172  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 1 shape torch.Size([1, 246, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10443544387817383  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10485458374023438  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10527372360229492  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.10483360290527344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

torch.Size([2812, 40])
input nodes number: 5688
output nodes number: 2812
edges number: 13226
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1048893928527832  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1048898696899414  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004486083984375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

pseudo mini batch 24 input nodes size: 12713
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004213809967041016  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.004213809967041016  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.010275840759277344  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.010296821594238281  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.007563591003417969  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0077056884765625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0077056884765625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0077056884765625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

m.shape torch.Size([323, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017182350158691406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017182350158691406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.017490386962890625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.019954681396484375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([228, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02001810073852539  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02001810073852539  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 228, 128]), torch.Size([1, 228, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.020235538482666016  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.02349710464477539  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 228, 128])
m.shape torch.Size([195, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023667335510253906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023667335510253906  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 195, 128]), torch.Size([1, 195, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.023853302001953125  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.027944564819335938  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 195, 128])
m.shape torch.Size([171, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028177738189697266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028177738189697266  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.028340816497802734  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03307008743286133  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([126, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03328895568847656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03328895568847656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 126, 128]), torch.Size([1, 126, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03340911865234375  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0377349853515625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 126, 128])
m.shape torch.Size([116, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03800678253173828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03800678253173828  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.038117408752441406  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04287433624267578  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([95, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0431361198425293  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.0431361198425293  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04322671890258789  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04775667190551758  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([63, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.047951698303222656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.047951698303222656  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.04801177978515625  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051436424255371094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([71, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051711082458496094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.051711082458496094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05177879333496094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05611228942871094  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([1384, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06267786026000977  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06267786026000977  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06333780288696289  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11063289642333984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

rst 0 shape torch.Size([1, 692, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11063289642333984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11063289642333984  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.11129283905029297  GigaBytes
Max Memory Allocated: 0.15629243850708008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.15781879425048828  GigaBytes
Max Memory Allocated: 0.16144847869873047  GigaBytes

rst 1 shape torch.Size([1, 692, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.14968252182006836  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.15009593963623047  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.15050935745239258  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.15007495880126953  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

torch.Size([2772, 40])
input nodes number: 12713
output nodes number: 2772
edges number: 19022
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.15018510818481445  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.15018558502197266  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.007968425750732422  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

pseudo mini batch 25 input nodes size: 12137
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.007557868957519531  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.007557868957519531  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.01334524154663086  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.013367176055908203  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.0072841644287109375  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.007447242736816406  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.007447242736816406  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.007447242736816406  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

m.shape torch.Size([250, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.018260955810546875  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.018260955810546875  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

 h.shape torch.Size([1, 250, 128]), torch.Size([1, 250, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.018499374389648438  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.020406723022460938  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

rst.shape  torch.Size([1, 250, 128])
m.shape torch.Size([219, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.020496368408203125  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.020496368408203125  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

 h.shape torch.Size([1, 219, 128]), torch.Size([1, 219, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.020705223083496094  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.023838043212890625  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

rst.shape  torch.Size([1, 219, 128])
m.shape torch.Size([154, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.023953914642333984  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.023953914642333984  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

 h.shape torch.Size([1, 154, 128]), torch.Size([1, 154, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.024100780487060547  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.027331829071044922  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

rst.shape  torch.Size([1, 154, 128])
m.shape torch.Size([125, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.027496814727783203  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.027496814727783203  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.027616024017333984  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.03107309341430664  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([122, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.031304359436035156  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.031304359436035156  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

 h.shape torch.Size([1, 122, 128]), torch.Size([1, 122, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.03142070770263672  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.03560924530029297  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

rst.shape  torch.Size([1, 122, 128])
m.shape torch.Size([108, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.03586006164550781  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.03586006164550781  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.03596305847167969  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04039192199707031  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([89, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04063749313354492  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04063749313354492  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04072237014770508  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04496622085571289  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([87, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04525566101074219  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04525566101074219  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.04533863067626953  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.050067901611328125  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([92, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.05042123794555664  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.05042123794555664  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.050508975982666016  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.056124210357666016  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([1679, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.06485462188720703  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.06485462188720703  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.06565475463867188  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12296104431152344  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

rst 0 shape torch.Size([1, 839, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12296104431152344  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12296104431152344  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12376213073730469  GigaBytes
Max Memory Allocated: 0.16147327423095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.18117380142211914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 840, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1716914176940918  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17212772369384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17256402969360352  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1721057891845703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2925, 40])
input nodes number: 12137
output nodes number: 2925
edges number: 21845
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1722412109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1722416877746582  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007756710052490234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 26 input nodes size: 10962
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0073070526123046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0073070526123046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012534141540527344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012555122375488281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006745815277099609  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006867885589599609  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006867885589599609  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006867885589599609  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([402, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015079498291015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015079498291015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 402, 128]), torch.Size([1, 402, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015462875366210938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018529891967773438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 402, 128])
m.shape torch.Size([355, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0186767578125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0186767578125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01901531219482422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0240936279296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([267, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024306297302246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024306297302246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024560928344726562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030162811279296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 267, 128])
m.shape torch.Size([184, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03038644790649414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03038644790649414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 184, 128]), torch.Size([1, 184, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03056192398071289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03565073013305664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 184, 128])
m.shape torch.Size([174, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035977840423583984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035977840423583984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 174, 128]), torch.Size([1, 174, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03614377975463867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04211759567260742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 174, 128])
m.shape torch.Size([102, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04232645034790039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04232645034790039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 102, 128]), torch.Size([1, 102, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04242372512817383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04660654067993164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 102, 128])
m.shape torch.Size([108, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046918392181396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046918392181396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04702138900756836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05217123031616211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([79, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05242109298706055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05242109298706055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05249643325805664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056790828704833984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([68, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05704498291015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05704498291015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057109832763671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061260223388671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([1020, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06609153747558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06609153747558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06657791137695312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10111045837402344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 510, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10111045837402344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10111045837402344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10159683227539062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13588619232177734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 510, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12945079803466797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12986230850219727  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13027381896972656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12984132766723633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2759, 40])
input nodes number: 10962
output nodes number: 2759
edges number: 16331
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12991952896118164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12992000579833984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007078647613525391  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 27 input nodes size: 11002
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006721019744873047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006721019744873047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011967182159423828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011988162994384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006740093231201172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006873607635498047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006873607635498047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006873607635498047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([328, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016333580017089844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016333580017089844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016646385192871094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019148826599121094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([290, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01926898956298828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01926898956298828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 290, 128]), torch.Size([1, 290, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019545555114746094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02369403839111328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 290, 128])
m.shape torch.Size([217, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02386617660522461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02386617660522461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 217, 128]), torch.Size([1, 217, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024073123931884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028625965118408203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 217, 128])
m.shape torch.Size([185, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028875350952148438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028875350952148438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029051780700683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.034168243408203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([160, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03446149826049805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03446149826049805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 160, 128]), torch.Size([1, 160, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03461408615112305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04010725021362305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 160, 128])
m.shape torch.Size([149, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04045724868774414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04045724868774414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 149, 128]), torch.Size([1, 149, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04059934616088867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046709537506103516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 149, 128])
m.shape torch.Size([116, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04702568054199219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04702568054199219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04713630676269531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05266761779785156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([76, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0529022216796875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0529022216796875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052974700927734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05710601806640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([90, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057456016540527344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057456016540527344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057541847229003906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0630350112915039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([1162, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06853294372558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06853294372558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06908702850341797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10991382598876953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 581, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10991382598876953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10991382598876953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11046791076660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15091562271118164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 581, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14284324645996094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14325666427612305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14367008209228516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1432356834411621  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2773, 40])
input nodes number: 11002
output nodes number: 2773
edges number: 17843
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1433405876159668  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.143341064453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007122516632080078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 28 input nodes size: 11040
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006742000579833984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006742000579833984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012006282806396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012027263641357422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006760120391845703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006880283355712891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006880283355712891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006880283355712891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([396, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014982223510742188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014982223510742188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 396, 128]), torch.Size([1, 396, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015359878540039062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018381118774414062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 396, 128])
m.shape torch.Size([357, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018532752990722656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018532752990722656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018873214721679688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023980140686035156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([279, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024209022521972656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024209022521972656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 279, 128]), torch.Size([1, 279, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02447509765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030328750610351562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 279, 128])
m.shape torch.Size([216, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03060770034790039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03060770034790039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 216, 128]), torch.Size([1, 216, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03081369400024414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03678750991821289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 216, 128])
m.shape torch.Size([176, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037104129791259766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037104129791259766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037271976470947266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043314456939697266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([150, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04365968704223633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04365968704223633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043802738189697266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04995393753051758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 150, 128])
m.shape torch.Size([120, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050282955169677734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050282955169677734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050397396087646484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056119441986083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([91, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056409358978271484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056409358978271484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05649614334106445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06144285202026367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([59, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06165266036987305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06165266036987305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061708927154541016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06531000137329102  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([942, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06977367401123047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06977367401123047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07022285461425781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10211467742919922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 471, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10211467742919922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10211467742919922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10256385803222656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1342310905456543  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 471, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1275944709777832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12800979614257812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12842512130737305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1279888153076172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2786, 40])
input nodes number: 11040
output nodes number: 2786
edges number: 16110
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12809419631958008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12809467315673828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0071163177490234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 29 input nodes size: 10659
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006762027740478516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006762027740478516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011844635009765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011865615844726562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006580352783203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006720542907714844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006720542907714844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006720542907714844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([319, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01605844497680664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01605844497680664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016362667083740234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018796443939208984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([255, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01888751983642578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01888751983642578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019130706787109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02277851104736328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 255, 128])
m.shape torch.Size([208, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022954463958740234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022954463958740234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 208, 128]), torch.Size([1, 208, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023152828216552734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.027516841888427734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 208, 128])
m.shape torch.Size([149, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.027701854705810547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.027701854705810547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 149, 128]), torch.Size([1, 149, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.027843952178955078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.031964778900146484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 149, 128])
m.shape torch.Size([152, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032256126403808594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032256126403808594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 152, 128]), torch.Size([1, 152, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032401084899902344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037619590759277344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 152, 128])
m.shape torch.Size([93, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03781318664550781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03781318664550781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 93, 128]), torch.Size([1, 93, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037901878356933594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04171562194824219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 93, 128])
m.shape torch.Size([79, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041934967041015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041934967041015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04201030731201172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045777320861816406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([69, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046002864837646484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046002864837646484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046068668365478516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0498194694519043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([76, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05011272430419922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05011272430419922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050185203552246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.054823875427246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([1358, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061263084411621094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061263084411621094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06191062927246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10843038558959961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 679, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10843038558959961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10843038558959961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10907793045043945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1549396514892578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 679, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14693784713745117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14734888076782227  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14775991439819336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14732789993286133  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2758, 40])
input nodes number: 10659
output nodes number: 2758
edges number: 18736
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14742422103881836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14742469787597656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0069675445556640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 30 input nodes size: 12209
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006576061248779297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006576061248779297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01239776611328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012418746948242188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007315158843994141  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007446765899658203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007446765899658203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007446765899658203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([360, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016487598419189453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016487598419189453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016830921173095703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019577503204345703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([294, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019686222076416016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019686222076416016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 294, 128]), torch.Size([1, 294, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019966602325439453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024172306060791016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 294, 128])
m.shape torch.Size([235, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0243682861328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0243682861328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02459239959716797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02952289581298828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 235, 128])
m.shape torch.Size([175, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029744625091552734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029744625091552734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 175, 128]), torch.Size([1, 175, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029911518096923828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03475141525268555  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 175, 128])
m.shape torch.Size([152, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035030364990234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035030364990234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 152, 128]), torch.Size([1, 152, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035175323486328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040393829345703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 152, 128])
m.shape torch.Size([109, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040633201599121094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040633201599121094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040737152099609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04520702362060547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 109, 128])
m.shape torch.Size([86, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04544210433959961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04544210433959961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 86, 128]), torch.Size([1, 86, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04552412033081055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04962491989135742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 86, 128])
m.shape torch.Size([70, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0498509407043457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0498509407043457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04991769790649414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05372285842895508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([71, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.053994178771972656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.053994178771972656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0540618896484375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0583953857421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([1206, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06411218643188477  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06411218643188477  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06468725204467773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10599899291992188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 603, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10599899291992188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10599899291992188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10657405853271484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14711618423461914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 603, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1400928497314453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1405038833618164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1409149169921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14048290252685547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2758, 40])
input nodes number: 12209
output nodes number: 2758
edges number: 17628
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1405949592590332  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1405954360961914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007700920104980469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 31 input nodes size: 12586
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007315158843994141  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007315158843994141  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013316631317138672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013338088989257812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007495403289794922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007641315460205078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007641315460205078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007641315460205078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([305, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017328262329101562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017328262329101562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01761913299560547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01994609832763672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([254, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020042896270751953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020042896270751953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 254, 128]), torch.Size([1, 254, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02028512954711914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023918628692626953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 254, 128])
m.shape torch.Size([213, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024102210998535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024102210998535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 213, 128]), torch.Size([1, 213, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024305343627929688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028774261474609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 213, 128])
m.shape torch.Size([181, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029017925262451172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029017925262451172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029190540313720703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03419637680053711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 181, 128])
m.shape torch.Size([152, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03447246551513672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03447246551513672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 152, 128]), torch.Size([1, 152, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03461742401123047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03983592987060547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 152, 128])
m.shape torch.Size([121, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04010963439941406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04010963439941406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04022502899169922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04518699645996094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([103, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04547309875488281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04547309875488281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045571327209472656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050482749938964844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([99, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0508112907409668  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0508112907409668  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050905704498291016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056287288665771484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 99, 128])
m.shape torch.Size([89, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05662202835083008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05662202835083008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056706905364990234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.062139034271240234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([1349, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06852912902832031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06852912902832031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06917190551757812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1156911849975586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 674, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1156911849975586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1156911849975586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 675, 128]), torch.Size([1, 675, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11633491516113281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16216087341308594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 675, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15386390686035156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15429115295410156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15471839904785156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15426969528198242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2866, 40])
input nodes number: 12586
output nodes number: 2866
edges number: 19466
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15440130233764648  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1544017791748047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007929801940917969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008990287780761719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008990287780761719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004523530602455139 |0.011304490268230438 |0.052439019083976746 |8.128583431243896e-05 |0.015934526920318604 |0.0033867359161376953 |
----------------------------------------------------------pseudo_mini_loss sum 3.837982654571533
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  248764
Number of first layer input nodes during this epoch:  248764
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008989810943603516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.015406370162963867
global_2_local spend time (sec) 0.036307573318481445
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0033740997314453125
A = g.adjacency_matrix() spent  0.005371809005737305
auxiliary_graph
Graph(num_nodes=145011, num_edges=14383463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07546806335449219
remove nodes length
54070
auxiliary_graph.remove_nodes spent  0.6389784812927246
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14383463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.5880212783813477

the counter of shared neighbor distribution
Counter({1.0: 12899386, 2.0: 1178670, 3.0: 168286, 4.0: 33534, 5.0: 8856, 6.0: 2754, 7.0: 796, 8.0: 198, 9.0: 40, 10.0: 2})
14292522
--------------------------------------- new test ---------------------[03:21:57] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14292522 edges into 32 parts and get 3586778 edge cuts

--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14292519, 14292520, 14292521])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12899386, 2.0: 1178670, 3.0: 168286, 4.0: 33534, 5.0: 8856, 6.0: 2754, 7.0: 796, 8.0: 198, 9.0: 40, 10.0: 2})
Convert a graph into a bidirected graph: 0.617 seconds
Metis partitioning: 2.831 seconds
Split the graph: 0.316 seconds
Construct subgraphs: 0.058 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  3.829749584197998
2926
2819
2914
2875
2925
2884
2927
2880
2804
2909
2889
2893
2758
2927
2869
2817
2773
2762
2814
2818
2869
2886
2883
2812
2797
2782
2758
2800
2758
2896
2758
2759
total k batches seeds list generation spend  8.87782335281372
after graph partition
graph partition algorithm spend time 8.947925329208374
2926
2819
2914
2875
2925
2884
2927
2880
2804
2909
2889
2893
2758
2927
2869
2817
2773
2762
2814
2818
2869
2886
2883
2812
2797
2782
2758
2800
2758
2896
2758
2759
partition_len_list
[7515, 6157, 5986, 6789, 5420, 5163, 5991, 5938, 5653, 5323, 5574, 6068, 7067, 6749, 6627, 5575, 9662, 8770, 11055, 6617, 5526, 6692, 5859, 7532, 11247, 9846, 11732, 12169, 11471, 12085, 12212, 11583]
shared_neighbor_graph_partition_s0 selection method  spend 9.038731813430786
time for parepare:  0.01793646812438965
local_output_nid generation:  0.000732421875
local_in_edges_tensor generation:  0.0008785724639892578
mini_batch_src_global generation:  0.0009319782257080078
r_  generation:  0.005557060241699219
local_output_nid generation:  0.0007495880126953125
local_in_edges_tensor generation:  0.0007293224334716797
mini_batch_src_global generation:  0.0007810592651367188
r_  generation:  0.005137443542480469
local_output_nid generation:  0.0007576942443847656
local_in_edges_tensor generation:  0.0006866455078125
mini_batch_src_global generation:  0.000644683837890625
r_  generation:  0.005156755447387695
local_output_nid generation:  0.0007460117340087891
local_in_edges_tensor generation:  0.0006566047668457031
mini_batch_src_global generation:  0.0006270408630371094
r_  generation:  0.005062580108642578
local_output_nid generation:  0.0007808208465576172
local_in_edges_tensor generation:  0.0006699562072753906
mini_batch_src_global generation:  0.0005929470062255859
r_  generation:  0.005173206329345703
local_output_nid generation:  0.0007908344268798828
local_in_edges_tensor generation:  0.0006680488586425781
mini_batch_src_global generation:  0.0005626678466796875
r_  generation:  0.0047075748443603516
local_output_nid generation:  0.0008215904235839844
local_in_edges_tensor generation:  0.0006597042083740234
mini_batch_src_global generation:  0.0005958080291748047
r_  generation:  0.005351066589355469
local_output_nid generation:  0.0007541179656982422
local_in_edges_tensor generation:  0.0006098747253417969
mini_batch_src_global generation:  0.000576019287109375
r_  generation:  0.00490570068359375
local_output_nid generation:  0.0007498264312744141
local_in_edges_tensor generation:  0.0006008148193359375
mini_batch_src_global generation:  0.0005505084991455078
r_  generation:  0.0046994686126708984
local_output_nid generation:  0.0007529258728027344
local_in_edges_tensor generation:  0.0006318092346191406
mini_batch_src_global generation:  0.0005950927734375
r_  generation:  0.00551915168762207
local_output_nid generation:  0.0007574558258056641
local_in_edges_tensor generation:  0.0006127357482910156
mini_batch_src_global generation:  0.0006327629089355469
r_  generation:  0.005678653717041016
local_output_nid generation:  0.0007693767547607422
local_in_edges_tensor generation:  0.0006806850433349609
mini_batch_src_global generation:  0.0006239414215087891
r_  generation:  0.0056629180908203125
local_output_nid generation:  0.0007593631744384766
local_in_edges_tensor generation:  0.0006301403045654297
mini_batch_src_global generation:  0.0005345344543457031
r_  generation:  0.00452113151550293
local_output_nid generation:  0.0008332729339599609
local_in_edges_tensor generation:  0.0006291866302490234
mini_batch_src_global generation:  0.0006177425384521484
r_  generation:  0.005767822265625
local_output_nid generation:  0.000804901123046875
local_in_edges_tensor generation:  0.0006108283996582031
mini_batch_src_global generation:  0.0006160736083984375
r_  generation:  0.005562782287597656
local_output_nid generation:  0.0007805824279785156
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.0005657672882080078
r_  generation:  0.004873991012573242
local_output_nid generation:  0.0007519721984863281
local_in_edges_tensor generation:  0.0005984306335449219
mini_batch_src_global generation:  0.00061798095703125
r_  generation:  0.005025625228881836
local_output_nid generation:  0.0007503032684326172
local_in_edges_tensor generation:  0.0006110668182373047
mini_batch_src_global generation:  0.0005800724029541016
r_  generation:  0.0044803619384765625
local_output_nid generation:  0.0007607936859130859
local_in_edges_tensor generation:  0.0006122589111328125
mini_batch_src_global generation:  0.0006520748138427734
r_  generation:  0.005896568298339844
local_output_nid generation:  0.0007829666137695312
local_in_edges_tensor generation:  0.0006012916564941406
mini_batch_src_global generation:  0.0005815029144287109
r_  generation:  0.005791425704956055
local_output_nid generation:  0.0008947849273681641
local_in_edges_tensor generation:  0.0006322860717773438
mini_batch_src_global generation:  0.0005283355712890625
r_  generation:  0.004831552505493164
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0006432533264160156
mini_batch_src_global generation:  0.0005459785461425781
r_  generation:  0.004953861236572266
local_output_nid generation:  0.0008521080017089844
local_in_edges_tensor generation:  0.0006384849548339844
mini_batch_src_global generation:  0.0005872249603271484
r_  generation:  0.0046100616455078125
local_output_nid generation:  0.0008196830749511719
local_in_edges_tensor generation:  0.0005867481231689453
mini_batch_src_global generation:  0.0006041526794433594
r_  generation:  0.004744291305541992
local_output_nid generation:  0.0007836818695068359
local_in_edges_tensor generation:  0.0005979537963867188
mini_batch_src_global generation:  0.0006678104400634766
r_  generation:  0.005251884460449219
local_output_nid generation:  0.0008449554443359375
local_in_edges_tensor generation:  0.0006244182586669922
mini_batch_src_global generation:  0.0006432533264160156
r_  generation:  0.0049512386322021484
local_output_nid generation:  0.0009171962738037109
local_in_edges_tensor generation:  0.0006458759307861328
mini_batch_src_global generation:  0.0007045269012451172
r_  generation:  0.005478620529174805
local_output_nid generation:  0.0009748935699462891
local_in_edges_tensor generation:  0.0006656646728515625
mini_batch_src_global generation:  0.0008130073547363281
r_  generation:  0.005742073059082031
local_output_nid generation:  0.0009925365447998047
local_in_edges_tensor generation:  0.0006654262542724609
mini_batch_src_global generation:  0.0008156299591064453
r_  generation:  0.005903005599975586
local_output_nid generation:  0.0010149478912353516
local_in_edges_tensor generation:  0.0007016658782958984
mini_batch_src_global generation:  0.0008881092071533203
r_  generation:  0.00646209716796875
local_output_nid generation:  0.0009784698486328125
local_in_edges_tensor generation:  0.0006489753723144531
mini_batch_src_global generation:  0.0008203983306884766
r_  generation:  0.0059125423431396484
local_output_nid generation:  0.0009458065032958984
local_in_edges_tensor generation:  0.0006520748138427734
mini_batch_src_global generation:  0.0007569789886474609
r_  generation:  0.006161212921142578
----------------------check_connections_block total spend ----------------------------- 0.3086719512939453
generate_one_block  0.02268362045288086
generate_one_block  0.00982046127319336
generate_one_block  0.009247779846191406
generate_one_block  0.008127212524414062
generate_one_block  0.007591724395751953
generate_one_block  0.00667262077331543
generate_one_block  0.007967710494995117
generate_one_block  0.007288932800292969
generate_one_block  0.0070073604583740234
generate_one_block  0.007738351821899414
generate_one_block  0.008298873901367188
generate_one_block  0.00819706916809082
generate_one_block  0.007081270217895508
generate_one_block  0.008569717407226562
generate_one_block  0.008188486099243164
generate_one_block  0.006880998611450195
generate_one_block  0.013974666595458984
generate_one_block  0.00808095932006836
generate_one_block  0.00988149642944336
generate_one_block  0.006592750549316406
generate_one_block  0.00666046142578125
generate_one_block  0.006779193878173828
generate_one_block  0.006536722183227539
generate_one_block  0.00713348388671875
generate_one_block  0.008619308471679688
generate_one_block  0.007682085037231445
generate_one_block  0.008362770080566406
generate_one_block  0.00921630859375
generate_one_block  0.008858680725097656
generate_one_block  0.009933948516845703
generate_one_block  0.00950002670288086
generate_one_block  0.009213685989379883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008989810943603516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

connection checking time:  0.3086719512939453
block generation total time  0.27838873863220215
average batch blocks generation time:  0.008699648082256317
block dataloader generation time/epoch 9.696400880813599
pseudo mini batch 0 input nodes size: 7515
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008571147918701172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008571147918701172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012154579162597656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012176513671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006153583526611328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006288051605224609  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006288051605224609  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006288051605224609  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([344, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015291690826416016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015291690826416016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 344, 128]), torch.Size([1, 344, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015619754791259766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018244266510009766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 344, 128])
m.shape torch.Size([304, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01837015151977539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01837015151977539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 304, 128]), torch.Size([1, 304, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01866006851196289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02300882339477539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 304, 128])
m.shape torch.Size([266, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023244380950927734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023244380950927734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 266, 128]), torch.Size([1, 266, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023498058319091797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029078960418701172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 266, 128])
m.shape torch.Size([237, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029404163360595703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029404163360595703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 237, 128]), torch.Size([1, 237, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029630184173583984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03618478775024414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 237, 128])
m.shape torch.Size([203, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03655576705932617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03655576705932617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 203, 128]), torch.Size([1, 203, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03674936294555664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043718814849853516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 203, 128])
m.shape torch.Size([152, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04405689239501953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04405689239501953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 152, 128]), torch.Size([1, 152, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04420185089111328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05043506622314453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 152, 128])
m.shape torch.Size([146, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05084991455078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05084991455078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05098915100097656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05795097351074219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([130, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05837726593017578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05837726593017578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 130, 128]), torch.Size([1, 130, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058501243591308594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0655679702758789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 130, 128])
m.shape torch.Size([119, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06601667404174805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06601667404174805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06613016128540039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07339334487915039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([1025, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07822418212890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07822418212890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07871246337890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11338043212890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 512, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11338043212890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11338043212890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11386966705322266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14981794357299805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 513, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1423182487487793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14275455474853516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14319086074829102  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1427326202392578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2926, 40])
input nodes number: 7515
output nodes number: 2926
edges number: 18008
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14281988143920898  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1428208351135254  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006521701812744141  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 1 input nodes size: 6157
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006163597106933594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006163597106933594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009099483489990234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009120941162109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005515575408935547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005636692047119141  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005636692047119141  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005636692047119141  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([368, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013750553131103516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013750553131103516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 368, 128]), torch.Size([1, 368, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014101505279541016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016909122467041016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 368, 128])
m.shape torch.Size([355, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017072200775146484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017072200775146484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017410755157470703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022489070892333984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([296, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02274322509765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02274322509765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 296, 128]), torch.Size([1, 296, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0230255126953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02923583984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 296, 128])
m.shape torch.Size([247, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029565811157226562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029565811157226562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 247, 128]), torch.Size([1, 247, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029801368713378906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036632537841796875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 247, 128])
m.shape torch.Size([203, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036998748779296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036998748779296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 203, 128]), torch.Size([1, 203, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037192344665527344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04416179656982422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 203, 128])
m.shape torch.Size([141, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04446840286254883  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04446840286254883  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04460287094116211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0503849983215332  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([137, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05077505111694336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05077505111694336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 137, 128]), torch.Size([1, 137, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050905704498291016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05743837356567383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 137, 128])
m.shape torch.Size([122, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05783843994140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05783843994140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 122, 128]), torch.Size([1, 122, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05795478820800781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06458663940429688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 122, 128])
m.shape torch.Size([94, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06493186950683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06493186950683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 94, 128]), torch.Size([1, 94, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06502151489257812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07075881958007812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 94, 128])
m.shape torch.Size([856, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07479572296142578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07479572296142578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07520389556884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10418415069580078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 428, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10418415069580078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10418415069580078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10459232330322266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13336849212646484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 428, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12674522399902344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1271653175354004  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12758541107177734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12714385986328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2819, 40])
input nodes number: 6157
output nodes number: 2819
edges number: 16156
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1271953582763672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1271958351135254  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005820274353027344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 2 input nodes size: 5986
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005499362945556641  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005499362945556641  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009082794189453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009104728698730469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0061473846435546875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0062694549560546875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0062694549560546875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0062694549560546875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([396, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014464378356933594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014464378356933594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 396, 128]), torch.Size([1, 396, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014842033386230469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01786327362060547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 396, 128])
m.shape torch.Size([372, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018029212951660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018029212951660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01838397979736328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023705482482910156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([301, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023958683013916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023958683013916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 301, 128]), torch.Size([1, 301, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024245738983154297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030560970306396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 301, 128])
m.shape torch.Size([278, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03094768524169922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03094768524169922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 278, 128]), torch.Size([1, 278, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.031212806701660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.038901329040527344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 278, 128])
m.shape torch.Size([207, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03926229476928711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03926229476928711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 207, 128]), torch.Size([1, 207, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0394597053527832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04656648635864258  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 207, 128])
m.shape torch.Size([166, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046942710876464844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046942710876464844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 166, 128]), torch.Size([1, 166, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04710102081298828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.053908348083496094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 166, 128])
m.shape torch.Size([148, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05432319641113281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05432319641113281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 148, 128]), torch.Size([1, 148, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05446434020996094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06152153015136719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 148, 128])
m.shape torch.Size([147, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06201171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06201171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 147, 128]), torch.Size([1, 147, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06215190887451172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07014274597167969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 147, 128])
m.shape torch.Size([100, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07050180435180664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07050180435180664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07059717178344727  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07670068740844727  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([799, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08046293258666992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08046293258666992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08084344863891602  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10786008834838867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 399, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10786008834838867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10786008834838867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10824155807495117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13513565063476562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 400, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1287078857421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12914228439331055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1295766830444336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1291203498840332  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2914, 40])
input nodes number: 5986
output nodes number: 2914
edges number: 16288
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12920141220092773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12920188903808594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006483554840087891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 3 input nodes size: 6789
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006161689758300781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006161689758300781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009398937225341797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009420394897460938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005815029144287109  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005933284759521484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005933284759521484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005933284759521484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([466, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013914108276367188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013914108276367188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0143585205078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017913818359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([372, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01804637908935547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01804637908935547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018401145935058594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02372264862060547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([295, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023967266082763672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023967266082763672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 295, 128]), torch.Size([1, 295, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024248600006103516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030437946319580078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 295, 128])
m.shape torch.Size([207, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030692100524902344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030692100524902344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 207, 128]), torch.Size([1, 207, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030889511108398438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036614418029785156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 207, 128])
m.shape torch.Size([197, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03698539733886719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03698539733886719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03717327117919922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043936729431152344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([183, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04436635971069336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04436635971069336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 183, 128]), torch.Size([1, 183, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0445408821105957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052045345306396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 183, 128])
m.shape torch.Size([142, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05243206024169922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05243206024169922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052567481994628906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05933856964111328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 142, 128])
m.shape torch.Size([130, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05976676940917969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05976676940917969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 130, 128]), torch.Size([1, 130, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0598907470703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06695747375488281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 130, 128])
m.shape torch.Size([91, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06728601455688477  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06728601455688477  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06737279891967773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07292699813842773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([792, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07666015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07666015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 396, 128]), torch.Size([1, 396, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07703781127929688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.103851318359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 396, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.103851318359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.103851318359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 396, 128]), torch.Size([1, 396, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10422897338867188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13085365295410156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 396, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12532997131347656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12575864791870117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12618732452392578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12573719024658203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2875, 40])
input nodes number: 6789
output nodes number: 2875
edges number: 15779
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12580394744873047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12580442428588867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006129264831542969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 4 input nodes size: 5420
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005809307098388672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005809307098388672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00839376449584961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008415699005126953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005156993865966797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005271434783935547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005271434783935547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005271434783935547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([427, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013005256652832031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013005256652832031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0134124755859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01667022705078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([400, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016848087310791016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016848087310791016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017229557037353516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022951602935791016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 400, 128])
m.shape torch.Size([349, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023260116577148438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023260116577148438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 349, 128]), torch.Size([1, 349, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02359294891357422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030915260314941406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 349, 128])
m.shape torch.Size([288, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.031298160552978516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.031298160552978516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.031572818756103516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.039537906646728516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([226, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03993940353393555  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03993940353393555  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 226, 128]), torch.Size([1, 226, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04015493392944336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04791402816772461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 226, 128])
m.shape torch.Size([172, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04829835891723633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04829835891723633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0484623908996582  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05551576614379883  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 172, 128])
m.shape torch.Size([172, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05600786209106445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05600786209106445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 172, 128]), torch.Size([1, 172, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05617189407348633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06437349319458008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 172, 128])
m.shape torch.Size([138, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06481790542602539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06481790542602539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06494951248168945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07245111465454102  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([117, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07288742065429688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07288742065429688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0729990005493164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0801401138305664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([636, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08311700820922852  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08311700820922852  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 318, 128]), torch.Size([1, 318, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0834202766418457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10495233535766602  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 318, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10495233535766602  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10495233535766602  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 318, 128]), torch.Size([1, 318, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1052556037902832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12663602828979492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 318, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12051820755004883  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12095451354980469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12139081954956055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12093257904052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2925, 40])
input nodes number: 5420
output nodes number: 2925
edges number: 15309
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1210026741027832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1210031509399414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005466938018798828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 5 input nodes size: 5163
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005164623260498047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005164623260498047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007626533508300781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007648468017578125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005042076110839844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0051441192626953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0051441192626953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0051441192626953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([506, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012127876281738281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012127876281738281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012610435485839844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016470909118652344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([452, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016660690307617188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016660690307617188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017091751098632812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023557662963867188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([361, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02385854721069336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02385854721069336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024202823638916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03177690505981445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([274, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03212738037109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03212738037109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03238868713378906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.039966583251953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 274, 128])
m.shape torch.Size([253, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04043912887573242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04043912887573242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0406804084777832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04936647415161133  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 253, 128])
m.shape torch.Size([192, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04979515075683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04979515075683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 192, 128]), torch.Size([1, 192, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04997825622558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05785179138183594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 192, 128])
m.shape torch.Size([151, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05826425552368164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05826425552368164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058408260345458984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06560850143432617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([122, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06600189208984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06600189208984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 122, 128]), torch.Size([1, 122, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06611824035644531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07275009155273438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 122, 128])
m.shape torch.Size([82, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0730438232421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0730438232421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07312202453613281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07812690734863281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([491, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0806722640991211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0806722640991211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 245, 128]), torch.Size([1, 245, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08090591430664062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09749507904052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 245, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09749507904052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09749507904052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 246, 128]), torch.Size([1, 246, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09772968292236328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11426973342895508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 246, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10894203186035156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10937213897705078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10980224609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10935020446777344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2884, 40])
input nodes number: 5163
output nodes number: 2884
edges number: 13687
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1094045639038086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1094050407409668  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005311489105224609  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 6 input nodes size: 5991
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005035877227783203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005035877227783203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007892608642578125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007914543151855469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005430698394775391  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005553722381591797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005553722381591797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005553722381591797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([401, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013832569122314453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013832569122314453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 401, 128]), torch.Size([1, 401, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01421499252319336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01727437973022461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 401, 128])
m.shape torch.Size([379, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017444610595703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017444610595703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017806053161621094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023227691650390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([309, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023488998413085938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023488998413085938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02378368377685547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030266761779785156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 309, 128])
m.shape torch.Size([235, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030567646026611328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030567646026611328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030791759490966797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03729104995727539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 235, 128])
m.shape torch.Size([214, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037689208984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037689208984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 214, 128]), torch.Size([1, 214, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03789329528808594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04524040222167969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 214, 128])
m.shape torch.Size([170, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045624732971191406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045624732971191406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04578685760498047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052758216857910156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 170, 128])
m.shape torch.Size([160, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.053211212158203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.053211212158203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 160, 128]), torch.Size([1, 160, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.053363800048828125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.060993194580078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 160, 128])
m.shape torch.Size([119, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061370849609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061370849609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061484336853027344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06795310974121094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([125, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06843280792236328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06843280792236328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06855201721191406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07618141174316406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([815, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08000802993774414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08000802993774414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08039617538452148  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10795450210571289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 407, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10795450210571289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10795450210571289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10834360122680664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13577556610107422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 408, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12906694412231445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1295032501220703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12993955612182617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12948131561279297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2927, 40])
input nodes number: 5991
output nodes number: 2927
edges number: 16463
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12955427169799805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12955474853515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005760669708251953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 7 input nodes size: 5938
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005436897277832031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005436897277832031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008268356323242188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008289813995361328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0054111480712890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005522727966308594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005522727966308594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005522727966308594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([472, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013064861297607422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013064861297607422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013514995574951172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017116069793701172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([429, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017300128936767578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017300128936767578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01770925521850586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023846149444580078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([314, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02409076690673828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02409076690673828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 314, 128]), torch.Size([1, 314, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024390220642089844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03097820281982422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 314, 128])
m.shape torch.Size([252, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03130912780761719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03130912780761719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 252, 128]), torch.Size([1, 252, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03154945373535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03851890563964844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 252, 128])
m.shape torch.Size([222, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03892803192138672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03892803192138672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 222, 128]), torch.Size([1, 222, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.039139747619628906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046761512756347656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 222, 128])
m.shape torch.Size([156, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04710197448730469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04710197448730469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 156, 128]), torch.Size([1, 156, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04725074768066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05364799499511719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 156, 128])
m.shape torch.Size([148, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05406761169433594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05406761169433594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 148, 128]), torch.Size([1, 148, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05420875549316406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06126594543457031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 148, 128])
m.shape torch.Size([128, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06168365478515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06168365478515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06180572509765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06876373291015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([104, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06914901733398438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06914901733398438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06924819946289062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07559585571289062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 104, 128])
m.shape torch.Size([655, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07866954803466797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07866954803466797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07898139953613281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10112285614013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 327, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10112285614013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10112285614013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10143566131591797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1234889030456543  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 328, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1175541877746582  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11798334121704102  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11841249465942383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11796188354492188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2880, 40])
input nodes number: 5938
output nodes number: 2880
edges number: 14872
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11802053451538086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11802101135253906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005703926086425781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 8 input nodes size: 5653
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005403995513916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005403995513916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008099555969238281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008120536804199219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005267620086669922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005376338958740234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005376338958740234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005376338958740234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([533, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012753963470458984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012753963470458984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013262271881103516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018126964569091797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([381, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018236160278320312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018236160278320312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018599510192871094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024049758911132812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([309, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02431011199951172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02431011199951172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02460479736328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.031087875366210938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 309, 128])
m.shape torch.Size([232, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03138303756713867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03138303756713867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 232, 128]), torch.Size([1, 232, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03160429000854492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03802061080932617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 232, 128])
m.shape torch.Size([201, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03838920593261719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03838920593261719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 201, 128]), torch.Size([1, 201, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.038580894470214844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04548168182373047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 201, 128])
m.shape torch.Size([143, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04579496383666992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04579496383666992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045931339263916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05179548263549805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([109, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052091121673583984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052091121673583984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052195072174072266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05739259719848633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 109, 128])
m.shape torch.Size([97, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05771064758300781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05771064758300781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05780315399169922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06307601928710938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([65, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0633087158203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0633087158203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0633707046508789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0673379898071289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([734, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07080698013305664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07080698013305664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07115697860717773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09600687026977539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 367, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09600687026977539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09600687026977539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09635686874389648  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1210317611694336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 367, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11523151397705078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11564970016479492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11606788635253906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11562871932983398  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2804, 40])
input nodes number: 5653
output nodes number: 2804
edges number: 14477
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11568117141723633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11568164825439453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005548000335693359  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 9 input nodes size: 5323
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00525665283203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00525665283203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008088111877441406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00811004638671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005393505096435547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005518436431884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005518436431884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005518436431884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([382, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013906478881835938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013906478881835938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 382, 128]), torch.Size([1, 382, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014270782470703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017185211181640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 382, 128])
m.shape torch.Size([362, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017348289489746094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017348289489746094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017693519592285156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022871971130371094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 362, 128])
m.shape torch.Size([323, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02316141128540039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02316141128540039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02346944808959961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030246257781982422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([258, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030584335327148438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030584335327148438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 258, 128]), torch.Size([1, 258, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03083038330078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03796577453613281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 258, 128])
m.shape torch.Size([175, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03825998306274414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03825998306274414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 175, 128]), torch.Size([1, 175, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.038426876068115234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04443502426147461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 175, 128])
m.shape torch.Size([164, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04482078552246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04482078552246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 164, 128]), torch.Size([1, 164, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04497718811035156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05170249938964844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 164, 128])
m.shape torch.Size([112, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051998138427734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051998138427734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052104949951171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057445526123046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([129, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05788421630859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05788421630859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058007240295410156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06501960754394531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 129, 128])
m.shape torch.Size([117, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.065460205078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.065460205078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06557178497314453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07271289825439453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([887, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07688665390014648  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07688665390014648  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07730913162231445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10730504989624023  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 443, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10730504989624023  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10730504989624023  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 444, 128]), torch.Size([1, 444, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10772848129272461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13758087158203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 444, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1310734748840332  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13150739669799805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1319413185119629  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1314854621887207  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2909, 40])
input nodes number: 5323
output nodes number: 2909
edges number: 16705
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1315631866455078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13156366348266602  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005732059478759766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 10 input nodes size: 5574
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00540924072265625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00540924072265625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008067131042480469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008089065551757812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0052356719970703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005368232727050781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005368232727050781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005368232727050781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([289, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014180183410644531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014180183410644531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014455795288085938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016660690307617188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([306, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016814708709716797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016814708709716797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 306, 128]), torch.Size([1, 306, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01710653305053711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021483898162841797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 306, 128])
m.shape torch.Size([266, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021718502044677734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021718502044677734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 266, 128]), torch.Size([1, 266, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021972179412841797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.027553081512451172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 266, 128])
m.shape torch.Size([248, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02789926528930664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02789926528930664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 248, 128]), torch.Size([1, 248, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02813577651977539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03499460220336914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 248, 128])
m.shape torch.Size([224, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035410404205322266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035410404205322266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 224, 128]), torch.Size([1, 224, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035624027252197266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043314456939697266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 224, 128])
m.shape torch.Size([201, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043782711029052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043782711029052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 201, 128]), torch.Size([1, 201, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04397439956665039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05221700668334961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 201, 128])
m.shape torch.Size([176, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05270862579345703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05270862579345703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05287647247314453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06126880645751953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([135, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061699867248535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061699867248535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06182861328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0691671371459961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([99, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06952762603759766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06952762603759766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06962203979492188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07566452026367188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 99, 128])
m.shape torch.Size([945, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0801234245300293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0801234245300293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08057355880737305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1125330924987793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 472, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1125330924987793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1125330924987793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11298418045043945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14478635787963867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 473, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1374516487121582  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13788223266601562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13831281661987305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13786029815673828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2889, 40])
input nodes number: 5574
output nodes number: 2889
edges number: 17670
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13792085647583008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13792133331298828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005572319030761719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 11 input nodes size: 6068
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005232334136962891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005232334136962891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008125782012939453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008147716522216797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005467891693115234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005598545074462891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005598545074462891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005598545074462891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([315, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014331340789794922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014331340789794922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 315, 128]), torch.Size([1, 315, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01463174819946289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01703500747680664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 315, 128])
m.shape torch.Size([317, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017187118530273438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017187118530273438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01748943328857422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022024154663085938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([304, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022307872772216797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022307872772216797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 304, 128]), torch.Size([1, 304, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022597789764404297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028975963592529297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 304, 128])
m.shape torch.Size([236, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029281139373779297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029281139373779297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029506206512451172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03603315353393555  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([191, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036375999450683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036375999450683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03655815124511719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04311561584472656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([186, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04355669021606445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04355669021606445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 186, 128]), torch.Size([1, 186, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043734073638916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0513615608215332  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 186, 128])
m.shape torch.Size([151, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051776885986328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051776885986328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05192089080810547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.059121131896972656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([132, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.059552669525146484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.059552669525146484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 132, 128]), torch.Size([1, 132, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05967855453491211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06685400009155273  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 132, 128])
m.shape torch.Size([113, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0672760009765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0672760009765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0673837661743164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0742807388305664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([948, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07971620559692383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07971620559692383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08016824722290039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11226320266723633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 474, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11226320266723633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11226320266723633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11271524429321289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14458417892456055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 474, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13734054565429688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1377720832824707  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13820362091064453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13775014877319336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2893, 40])
input nodes number: 6068
output nodes number: 2893
edges number: 17486
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1378183364868164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1378188133239746  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005808353424072266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 12 input nodes size: 7067
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005468845367431641  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005468845367431641  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008838653564453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008859634399414062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005944252014160156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00604248046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00604248046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00604248046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([522, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012749671936035156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012749671936035156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013247489929199219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01723003387451172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([443, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017403602600097656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017403602600097656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017826080322265625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024163246154785156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([321, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02441120147705078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02441120147705078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024717330932617188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.031452178955078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([288, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03184843063354492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03184843063354492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03212308883666992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04008817672729492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([205, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040439605712890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040439605712890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040635108947753906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04767322540283203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 205, 128])
m.shape torch.Size([151, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04800748825073242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04800748825073242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048151493072509766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05434370040893555  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([113, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05464887619018555  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05464887619018555  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05475664138793945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.060144901275634766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([101, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06047630310058594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06047630310058594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06057262420654297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06606292724609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([90, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06640100479125977  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06640100479125977  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06648683547973633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07197999954223633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([524, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07443571090698242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07443571090698242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07468557357788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09242582321166992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 262, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09242582321166992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09242582321166992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09267568588256836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1102910041809082  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 262, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10565614700317383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10606718063354492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10647821426391602  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10604619979858398  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2758, 40])
input nodes number: 7067
output nodes number: 2758
edges number: 13103
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10609960556030273  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10610008239746094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0062046051025390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 13 input nodes size: 6749
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005923748016357422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005923748016357422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009141921997070312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009163856506347656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005773067474365234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005909442901611328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005909442901611328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005909442901611328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([328, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015039920806884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015039920806884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015352725982666016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017855167388916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([308, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017992496490478516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017992496490478516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 308, 128]), torch.Size([1, 308, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01828622817993164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022692203521728516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 308, 128])
m.shape torch.Size([282, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022948741912841797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022948741912841797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 282, 128]), torch.Size([1, 282, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02321767807006836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029134273529052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 282, 128])
m.shape torch.Size([196, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029373645782470703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029373645782470703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 196, 128]), torch.Size([1, 196, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029560565948486328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03498125076293945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 196, 128])
m.shape torch.Size([181, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03531932830810547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03531932830810547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035491943359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041706085205078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 181, 128])
m.shape torch.Size([157, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0420689582824707  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0420689582824707  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 157, 128]), torch.Size([1, 157, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.042218685150146484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04865694046020508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 157, 128])
m.shape torch.Size([162, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04912281036376953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04912281036376953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 162, 128]), torch.Size([1, 162, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.049277305603027344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05700206756591797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 162, 128])
m.shape torch.Size([145, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05747795104980469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05747795104980469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 145, 128]), torch.Size([1, 145, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057616233825683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06549835205078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 145, 128])
m.shape torch.Size([107, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0658884048461914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0658884048461914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 107, 128]), torch.Size([1, 107, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06599044799804688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07252120971679688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 107, 128])
m.shape torch.Size([1061, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0775294303894043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0775294303894043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07803487777709961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11475753784179688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 530, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11475753784179688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11475753784179688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1152639389038086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15155887603759766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 531, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14391851425170898  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14435482025146484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1447911262512207  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1443328857421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2927, 40])
input nodes number: 6749
output nodes number: 2927
edges number: 18288
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14443063735961914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14443111419677734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006154537200927734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 14 input nodes size: 6627
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00579833984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00579833984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009168148040771484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009189605712890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005949497222900391  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006078243255615234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006078243255615234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006078243255615234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([367, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014727115631103516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014727115631103516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01507711410522461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01787710189819336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 367, 128])
m.shape torch.Size([318, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01800537109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01800537109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 318, 128]), torch.Size([1, 318, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018308639526367188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022857666015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 318, 128])
m.shape torch.Size([265, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02308511734008789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02308511734008789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 265, 128]), torch.Size([1, 265, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023337841033935547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028897762298583984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 265, 128])
m.shape torch.Size([224, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029198646545410156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029198646545410156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 224, 128]), torch.Size([1, 224, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029412269592285156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035607337951660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 224, 128])
m.shape torch.Size([202, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03598213195800781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03598213195800781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 202, 128]), torch.Size([1, 202, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036174774169921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043109893798828125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 202, 128])
m.shape torch.Size([163, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04347991943359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04347991943359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 163, 128]), torch.Size([1, 163, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04363536834716797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050319671630859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 163, 128])
m.shape torch.Size([129, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05067253112792969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05067253112792969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050795555114746094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056946754455566406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 129, 128])
m.shape torch.Size([112, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0573124885559082  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0573124885559082  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0574193000793457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0635075569152832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([111, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06393051147460938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06393051147460938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06403636932373047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07081127166748047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 111, 128])
m.shape torch.Size([978, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07542181015014648  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07542181015014648  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07588815689086914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10899877548217773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 489, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10899877548217773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10899877548217773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10946512222290039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14234256744384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 489, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13518619537353516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13561391830444336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13604164123535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13559246063232422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2869, 40])
input nodes number: 6627
output nodes number: 2869
edges number: 17260
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13565492630004883  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13565540313720703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006280422210693359  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 15 input nodes size: 5575
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005940914154052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005940914154052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008599281311035156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008620738983154297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005229473114013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005339145660400391  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005339145660400391  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005339145660400391  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([457, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012787342071533203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012787342071533203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01322317123413086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01670980453491211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([420, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016892433166503906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016892433166503906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01729297637939453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023301124572753906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([306, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023538589477539062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023538589477539062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 306, 128]), torch.Size([1, 306, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023830413818359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03025054931640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 306, 128])
m.shape torch.Size([243, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03056812286376953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03056812286376953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03079986572265625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037520408630371094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([205, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03789329528808594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03789329528808594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03808879852294922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045126914978027344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 205, 128])
m.shape torch.Size([169, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04551267623901367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04551267623901367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 169, 128]), torch.Size([1, 169, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04567384719848633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05260419845581055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 169, 128])
m.shape torch.Size([129, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05295419692993164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05295419692993164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05307722091674805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05922842025756836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 129, 128])
m.shape torch.Size([106, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.059571266174316406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.059571266174316406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05967235565185547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06543445587158203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 106, 128])
m.shape torch.Size([103, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0658259391784668  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0658259391784668  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06592416763305664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07221078872680664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([679, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0755314826965332  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0755314826965332  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 339, 128]), torch.Size([1, 339, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07585477828979492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09880876541137695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 339, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09880876541137695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09880876541137695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09913301467895508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1219930648803711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 340, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11610746383666992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11652755737304688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11694765090942383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11650609970092773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2817, 40])
input nodes number: 5575
output nodes number: 2817
edges number: 14694
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1165618896484375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1165623664855957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005515575408935547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 16 input nodes size: 9662
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005221843719482422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005221843719482422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009829044342041016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009850025177001953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007170200347900391  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007291316986083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007291316986083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007291316986083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([407, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015439510345458984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015439510345458984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015827655792236328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018932819366455078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([346, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01906871795654297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01906871795654297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01939868927001953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02434825897216797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([249, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024539470672607422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024539470672607422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 249, 128]), torch.Size([1, 249, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024776935577392578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030001163482666016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 249, 128])
m.shape torch.Size([182, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030229568481445312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030229568481445312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03040313720703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03543663024902344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 182, 128])
m.shape torch.Size([182, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03578376770019531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03578376770019531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03595733642578125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.042205810546875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 182, 128])
m.shape torch.Size([170, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04260540008544922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04260540008544922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04276752471923828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04973888397216797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 170, 128])
m.shape torch.Size([127, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050081729888916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050081729888916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05020284652709961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0562586784362793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([103, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056591033935546875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056591033935546875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05668926239013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06228828430175781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([90, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06262540817260742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06262540817260742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06271123886108398  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06820440292358398  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([917, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07253408432006836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07253408432006836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07297086715698242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10398244857788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 458, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10398244857788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10398244857788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10442018508911133  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13528108596801758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 459, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1289372444152832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1293506622314453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12976408004760742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12932968139648438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2773, 40])
input nodes number: 9662
output nodes number: 2773
edges number: 16197
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12941598892211914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12941646575927734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0075092315673828125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 17 input nodes size: 8770
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007163524627685547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007163524627685547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011345386505126953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01136636734008789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006738185882568359  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006838321685791016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006838321685791016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006838321685791016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([524, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013704299926757812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013704299926757812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014204025268554688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018201828002929688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([462, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018392562866210938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018392562866210938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018833160400390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025442123413085938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([330, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025693893432617188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025693893432617188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02600860595703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032932281494140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 330, 128])
m.shape torch.Size([226, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03320598602294922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03320598602294922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 226, 128]), torch.Size([1, 226, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03342151641845703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.039671897888183594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 226, 128])
m.shape torch.Size([186, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040007591247558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040007591247558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 186, 128]), torch.Size([1, 186, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040184974670410156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046570777893066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 186, 128])
m.shape torch.Size([129, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046851158142089844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046851158142089844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04697418212890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05226421356201172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 129, 128])
m.shape torch.Size([133, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052646636962890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052646636962890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 133, 128]), torch.Size([1, 133, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052773475646972656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05911540985107422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 133, 128])
m.shape torch.Size([98, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05942583084106445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05942583084106445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.059519290924072266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06484651565551758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([73, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06511306762695312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06511306762695312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06518268585205078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06963825225830078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([601, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07246923446655273  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07246923446655273  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 300, 128]), torch.Size([1, 300, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07275533676147461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09306859970092773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 300, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09306859970092773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09306859970092773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 301, 128]), torch.Size([1, 301, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09335565567016602  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11359357833862305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 301, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10830354690551758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10871553421020508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10912752151489258  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10869455337524414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2762, 40])
input nodes number: 8770
output nodes number: 2762
edges number: 13428
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1087799072265625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1087803840637207  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0070343017578125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 18 input nodes size: 11055
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00673675537109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00673675537109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012008190155029297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012029170989990234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00782632827758789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007964611053466797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007964611053466797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007964611053466797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([324, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017201900482177734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017201900482177734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 324, 128]), torch.Size([1, 324, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01751089096069336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01998281478881836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 324, 128])
m.shape torch.Size([286, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020101070404052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020101070404052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 286, 128]), torch.Size([1, 286, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020373821258544922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024465084075927734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 286, 128])
m.shape torch.Size([225, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02465057373046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02465057373046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 225, 128]), torch.Size([1, 225, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024865150451660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029585838317871094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 225, 128])
m.shape torch.Size([181, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029823780059814453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029823780059814453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029996395111083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03500223159790039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 181, 128])
m.shape torch.Size([153, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035280704498291016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035280704498291016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 153, 128]), torch.Size([1, 153, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03542661666870117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0406794548034668  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 153, 128])
m.shape torch.Size([111, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040924072265625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040924072265625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041029930114746094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045581817626953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 111, 128])
m.shape torch.Size([102, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04586935043334961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04586935043334961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 102, 128]), torch.Size([1, 102, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04596662521362305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05083036422729492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 102, 128])
m.shape torch.Size([81, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05109071731567383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05109071731567383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051167964935302734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05557107925415039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([74, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05585002899169922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05585002899169922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05592060089111328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06043720245361328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([1277, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06649112701416016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06649112701416016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06709957122802734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11091470718383789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 638, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11091470718383789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11091470718383789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11152410507202148  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15457677841186523  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 639, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14672183990478516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1471414566040039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14756107330322266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14712047576904297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2814, 40])
input nodes number: 11055
output nodes number: 2814
edges number: 18524
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1472315788269043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1472320556640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0082244873046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 19 input nodes size: 6617
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00783395767211914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00783395767211914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.010989189147949219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01101064682006836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005718231201171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005816459655761719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005816459655761719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005816459655761719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([556, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012574195861816406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012574195861816406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013104438781738281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01734638214111328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([455, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017515182495117188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017515182495117188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01794910430908203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024457931518554688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([355, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024748802185058594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024748802185058594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025087356567382812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032535552978515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([261, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03286409378051758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03286409378051758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03311300277709961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040331363677978516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([212, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04071235656738281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04071235656738281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 212, 128]), torch.Size([1, 212, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04091453552246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04819297790527344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 212, 128])
m.shape torch.Size([152, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048526763916015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048526763916015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 152, 128]), torch.Size([1, 152, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048671722412109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.054904937744140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 152, 128])
m.shape torch.Size([127, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05525636672973633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05525636672973633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05537748336791992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06143331527709961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([101, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06175804138183594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06175804138183594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 101, 128]), torch.Size([1, 101, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06185436248779297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06734466552734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 101, 128])
m.shape torch.Size([65, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06757545471191406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06757545471191406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06763744354248047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07160472869873047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([534, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07412004470825195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07412004470825195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07437467575073242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0924534797668457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 267, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0924534797668457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0924534797668457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09270811080932617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11065959930419922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 267, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10587310791015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1062932014465332  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10671329498291016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10627174377441406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2818, 40])
input nodes number: 6617
output nodes number: 2818
edges number: 13169
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10634326934814453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10634374618530273  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005997180938720703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 20 input nodes size: 5526
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005718708038330078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005718708038330078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008353710174560547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008375167846679688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005198478698730469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005298614501953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005298614501953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005298614501953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([534, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012143611907958984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012143611907958984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012652873992919922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016826629638671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([463, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0170135498046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0170135498046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017455101013183594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024078369140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([371, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02438831329345703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02438831329345703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 371, 128]), torch.Size([1, 371, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02474212646484375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03252601623535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 371, 128])
m.shape torch.Size([287, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03289651870727539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03289651870727539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 287, 128]), torch.Size([1, 287, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.033170223236083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0411076545715332  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 287, 128])
m.shape torch.Size([230, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0415191650390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0415191650390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04173851013183594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04963493347167969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 230, 128])
m.shape torch.Size([171, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050014495849609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050014495849609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050177574157714844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05718994140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([113, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05748558044433594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05748558044433594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057593345642089844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06298160552978516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([110, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06334733963012695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06334733963012695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06345224380493164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06943178176879883  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([95, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06978702545166016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06978702545166016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06987762451171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07567596435546875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([495, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07799100875854492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07799100875854492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 247, 128]), torch.Size([1, 247, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07822656631469727  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09495115280151367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 247, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09495115280151367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09495115280151367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 248, 128]), torch.Size([1, 248, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09518766403198242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1118621826171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 248, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1075754165649414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10800313949584961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10843086242675781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10798168182373047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2869, 40])
input nodes number: 5526
output nodes number: 2869
edges number: 13373
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10805225372314453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10805273056030273  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005480289459228516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 21 input nodes size: 6692
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005206108093261719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005206108093261719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008397102355957031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008419036865234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005762577056884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005864620208740234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005864620208740234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005864620208740234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([533, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012860774993896484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012860774993896484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013369083404541016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01841115951538086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([465, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0186004638671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0186004638671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019043922424316406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02569580078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([377, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02601337432861328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02601337432861328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 377, 128]), torch.Size([1, 377, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.026372909545898438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.034282684326171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 377, 128])
m.shape torch.Size([266, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03461027145385742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03461027145385742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 266, 128]), torch.Size([1, 266, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.034863948822021484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0422205924987793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 266, 128])
m.shape torch.Size([211, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04259681701660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04259681701660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04279804229736328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050042152404785156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 211, 128])
m.shape torch.Size([176, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0504450798034668  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0504450798034668  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0506129264831543  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0578303337097168  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([108, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05810689926147461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05810689926147461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058209896087646484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06335973739624023  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([123, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06377744674682617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06377744674682617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06389474868774414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07058095932006836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([96, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07093429565429688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07093429565429688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07102584838867188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07688522338867188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([531, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07937145233154297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07937145233154297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 265, 128]), torch.Size([1, 265, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07962417602539062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09756755828857422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 265, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09756755828857422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09756755828857422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 266, 128]), torch.Size([1, 266, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09782123565673828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11570596694946289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 266, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11037015914916992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11080026626586914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11123037338256836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1107783317565918  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2886, 40])
input nodes number: 6692
output nodes number: 2886
edges number: 13683
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11085271835327148  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11085319519042969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0060520172119140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 22 input nodes size: 5859
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005764961242675781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005764961242675781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00855875015258789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008580684661865234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005367755889892578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005469799041748047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005469799041748047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005469799041748047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([537, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012419700622558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012419700622558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01293182373046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01702880859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([470, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01722097396850586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01722097396850586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017669200897216797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02439260482788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([339, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02465343475341797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02465343475341797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 339, 128]), torch.Size([1, 339, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024976730346679688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0320892333984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 339, 128])
m.shape torch.Size([290, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032480716705322266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032480716705322266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 290, 128]), torch.Size([1, 290, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03275728225708008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04077768325805664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 290, 128])
m.shape torch.Size([240, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041211605072021484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041211605072021484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 240, 128]), torch.Size([1, 240, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041440486907958984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.049680233001708984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 240, 128])
m.shape torch.Size([159, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050020694732666016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050020694732666016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 159, 128]), torch.Size([1, 159, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05017232894897461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05669260025024414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 159, 128])
m.shape torch.Size([141, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05708742141723633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05708742141723633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05722188949584961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06394529342651367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([92, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06422901153564453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06422901153564453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0643167495727539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06931781768798828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([102, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06971168518066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06971168518066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 102, 128]), torch.Size([1, 102, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0698089599609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0760345458984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 102, 128])
m.shape torch.Size([513, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07843208312988281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07843208312988281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07867622375488281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09601020812988281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 256, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09601020812988281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09601020812988281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 257, 128]), torch.Size([1, 257, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09625530242919922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11353492736816406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 257, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10886955261230469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1092991828918457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10972881317138672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10927724838256836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2883, 40])
input nodes number: 5859
output nodes number: 2883
edges number: 13579
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10934257507324219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10934305191040039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005648136138916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 23 input nodes size: 7532
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005367279052734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005367279052734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008958816528320312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00897979736328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006164073944091797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006269931793212891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006269931793212891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006269931793212891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([474, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013481616973876953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013481616973876953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013933658599853516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017549991607666016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([417, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01772165298461914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01772165298461914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018119335174560547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02408456802368164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 417, 128])
m.shape torch.Size([330, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02435779571533203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02435779571533203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024672508239746094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03159618377685547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 330, 128])
m.shape torch.Size([242, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03190040588378906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03190040588378906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 242, 128]), torch.Size([1, 242, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032131195068359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03882408142089844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 242, 128])
m.shape torch.Size([240, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03928089141845703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03928089141845703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 240, 128]), torch.Size([1, 240, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03950977325439453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04774951934814453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 240, 128])
m.shape torch.Size([173, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048130035400390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048130035400390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048295021057128906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.055389404296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 173, 128])
m.shape torch.Size([112, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05568075180053711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05568075180053711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05578756332397461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06112813949584961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([117, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061521053314208984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061521053314208984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061632633209228516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0679926872253418  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([97, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06835317611694336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06835317611694336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06844568252563477  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07436609268188477  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([610, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07722854614257812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07722854614257812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07751941680908203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09817123413085938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 305, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09817123413085938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09817123413085938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09846210479736328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11896848678588867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 305, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11333656311035156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11375570297241211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11417484283447266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11373472213745117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2812, 40])
input nodes number: 7532
output nodes number: 2812
edges number: 14197
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11380147933959961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11380195617675781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006453037261962891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 24 input nodes size: 11247
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006153583526611328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006153583526611328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011516571044921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011537551879882812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007925033569335938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00804901123046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00804901123046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00804901123046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([415, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016402721405029297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016402721405029297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 415, 128]), torch.Size([1, 415, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01679849624633789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01996469497680664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 415, 128])
m.shape torch.Size([355, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020105361938476562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020105361938476562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02044391632080078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025522232055664062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([264, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025730609893798828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025730609893798828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025982379913330078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03152132034301758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([185, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.031748294830322266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.031748294830322266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03192472457885742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03704118728637695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([171, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03736066818237305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03736066818237305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 171, 128]), torch.Size([1, 171, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037523746490478516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04339456558227539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 171, 128])
m.shape torch.Size([118, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04365062713623047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04365062713623047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 118, 128]), torch.Size([1, 118, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043763160705566406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04860210418701172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 118, 128])
m.shape torch.Size([92, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04885292053222656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04885292053222656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04894065856933594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05332756042480469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([80, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0535888671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0535888671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0536651611328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058013916015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([63, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05824613571166992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05824613571166992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058306217193603516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.062151432037353516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([1054, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06714725494384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06714725494384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06764984130859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10498809814453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 527, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10498809814453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10498809814453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10549068450927734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14178895950317383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 527, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13489198684692383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13530921936035156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1357264518737793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13528823852539062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2797, 40])
input nodes number: 11247
output nodes number: 2797
edges number: 16611
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1353912353515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1353917121887207  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008286476135253906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 25 input nodes size: 9846
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007923126220703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007923126220703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012618064880371094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012639045715332031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007255077362060547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007361888885498047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007361888885498047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007361888885498047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([532, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014664173126220703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014664173126220703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015171527862548828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019230365753173828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([399, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01935720443725586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01935720443725586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019737720489501953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02544546127319336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 399, 128])
m.shape torch.Size([312, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025701522827148438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025701522827148438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 312, 128]), torch.Size([1, 312, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025999069213867188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03254508972167969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 312, 128])
m.shape torch.Size([216, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03280830383300781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03280830383300781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 216, 128]), torch.Size([1, 216, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03301429748535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03898811340332031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 216, 128])
m.shape torch.Size([176, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03930473327636719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03930473327636719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03947257995605469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04551506042480469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([138, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045825958251953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045825958251953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04595756530761719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051616668701171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([116, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05193805694580078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05193805694580078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052048683166503906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057579994201660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([87, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05785655975341797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05785655975341797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05793952941894531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0626688003540039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([83, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06298351287841797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06298351287841797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06306266784667969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06812858581542969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([723, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07153654098510742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07153654098510742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07188081741333008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09632444381713867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 361, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09632444381713867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09632444381713867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09666967391967773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12100887298583984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 362, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11546182632446289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11587667465209961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11629152297973633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11585569381713867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2782, 40])
input nodes number: 9846
output nodes number: 2782
edges number: 14323
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11594772338867188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11594820022583008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007571220397949219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 26 input nodes size: 11732
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007252693176269531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007252693176269531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012846946716308594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012867927551269531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008152008056640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008275032043457031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008275032043457031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008275032043457031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([423, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01654052734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01654052734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016943931579589844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020171165466308594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([343, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020296573638916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020296573638916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 343, 128]), torch.Size([1, 343, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02062368392944336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025530338287353516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 343, 128])
m.shape torch.Size([225, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025688648223876953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025688648223876953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 225, 128]), torch.Size([1, 225, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02590322494506836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030623912811279297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 225, 128])
m.shape torch.Size([191, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03088092803955078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03088092803955078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.031063079833984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036345481872558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([170, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03665971755981445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03665971755981445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 170, 128]), torch.Size([1, 170, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036821842193603516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.042658329010009766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 170, 128])
m.shape torch.Size([124, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04293203353881836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04293203353881836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 124, 128]), torch.Size([1, 124, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043050289154052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04813528060913086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 124, 128])
m.shape torch.Size([92, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048383235931396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048383235931396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04847097396850586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05285787582397461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([85, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05313825607299805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05313825607299805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05321931838989258  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05783987045288086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 85, 128])
m.shape torch.Size([92, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05819416046142578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05819416046142578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058281898498535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06389713287353516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([1013, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06868362426757812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06868362426757812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06916618347167969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10342788696289062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 506, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10342788696289062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10342788696289062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1039113998413086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1379995346069336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 507, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13127994537353516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13169097900390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13210201263427734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1316699981689453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2758, 40])
input nodes number: 11732
output nodes number: 2758
edges number: 16424
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13177490234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1317753791809082  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008513450622558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 27 input nodes size: 12169
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008148193359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008148193359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013950824737548828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013971805572509766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008356571197509766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008489131927490234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008489131927490234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008489131927490234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([350, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017328262329101562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017328262329101562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01766204833984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02033233642578125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([297, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020448684692382812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020448684692382812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 297, 128]), torch.Size([1, 297, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02073192596435547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024980545043945312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 297, 128])
m.shape torch.Size([218, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025150775909423828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025150775909423828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02535867691040039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029932498931884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 218, 128])
m.shape torch.Size([212, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030232906341552734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030232906341552734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 212, 128]), torch.Size([1, 212, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03043508529663086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036298274993896484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 212, 128])
m.shape torch.Size([181, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03662872314453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03662872314453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03680133819580078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043015480041503906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 181, 128])
m.shape torch.Size([124, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043283939361572266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043283939361572266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 124, 128]), torch.Size([1, 124, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04340219497680664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048487186431884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 124, 128])
m.shape torch.Size([103, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04877185821533203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04877185821533203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048870086669921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05378150939941406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([96, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05409860610961914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05409860610961914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05419015884399414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05940866470336914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([96, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05977487564086914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05977487564086914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05986642837524414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06572580337524414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([1123, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07103490829467773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07103490829467773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07156991958618164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1108407974243164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 561, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1108407974243164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1108407974243164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11137676239013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14966058731079102  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 562, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1422405242919922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14265775680541992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14307498931884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14263677597045898  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2800, 40])
input nodes number: 12169
output nodes number: 2800
edges number: 17678
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14275503158569336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14275550842285156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008750438690185547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 28 input nodes size: 11471
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008362770080566406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008362770080566406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013832569122314453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01385354995727539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008029937744140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008164405822753906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008164405822753906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008164405822753906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([335, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017134666442871094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017134666442871094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017454147338867188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020009994506835938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([291, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02012777328491211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02012777328491211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 291, 128]), torch.Size([1, 291, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020405292510986328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02456808090209961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 291, 128])
m.shape torch.Size([212, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024732589721679688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024732589721679688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 212, 128]), torch.Size([1, 212, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024934768676757812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029382705688476562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 212, 128])
m.shape torch.Size([153, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029573440551757812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029573440551757812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 153, 128]), torch.Size([1, 153, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02971935272216797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0339508056640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 153, 128])
m.shape torch.Size([155, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.034247398376464844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.034247398376464844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 155, 128]), torch.Size([1, 155, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03439521789550781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03971672058105469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 155, 128])
m.shape torch.Size([141, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04004621505737305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04004621505737305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 141, 128]), torch.Size([1, 141, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04018068313598633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04596281051635742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 141, 128])
m.shape torch.Size([97, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0462193489074707  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0462193489074707  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04631185531616211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05093717575073242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([81, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051199913024902344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051199913024902344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05127716064453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.055680274963378906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([83, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05599784851074219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05599784851074219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 83, 128]), torch.Size([1, 83, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056077003479003906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061142921447753906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 83, 128])
m.shape torch.Size([1210, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06687307357788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06687307357788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06745004653930664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10929679870605469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 605, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10929679870605469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10929679870605469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10987377166748047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15055036544799805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 605, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1435379981994629  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14394903182983398  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14436006546020508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14392805099487305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2758, 40])
input nodes number: 11471
output nodes number: 2758
edges number: 17960
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1440286636352539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1440291404724121  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008409976959228516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 29 input nodes size: 12085
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008023738861083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008023738861083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01378631591796875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013808250427246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00831747055053711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008468151092529297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008468151092529297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008468151092529297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([292, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018508434295654297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018508434295654297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 292, 128]), torch.Size([1, 292, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018786907196044922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021014690399169922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 292, 128])
m.shape torch.Size([236, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021100521087646484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021100521087646484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02132558822631836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024701595306396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([204, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02488088607788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02488088607788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 204, 128]), torch.Size([1, 204, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025075435638427734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029355525970458984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 204, 128])
m.shape torch.Size([173, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02958822250366211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02958822250366211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02975320816040039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03453779220581055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 173, 128])
m.shape torch.Size([140, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.034789085388183594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.034789085388183594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 140, 128]), torch.Size([1, 140, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03492259979248047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03972911834716797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 140, 128])
m.shape torch.Size([119, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04000282287597656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04000282287597656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040116310119628906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04499626159667969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([108, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04530000686645508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04530000686645508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04540300369262695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0505528450012207  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([87, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05083322525024414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05083322525024414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050916194915771484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05564546585083008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([98, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05602455139160156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05602455139160156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056118011474609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.062099456787109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([1439, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06891441345214844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06891441345214844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 719, 128]), torch.Size([1, 719, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06960010528564453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11897850036621094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 719, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11897850036621094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11897850036621094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 720, 128]), torch.Size([1, 720, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11966514587402344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16869401931762695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 720, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1600360870361328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16046762466430664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16089916229248047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1604456901550293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2896, 40])
input nodes number: 12085
output nodes number: 2896
edges number: 20206
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16057825088500977  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16057872772216797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008762359619140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 30 input nodes size: 12212
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008337974548339844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008337974548339844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014161109924316406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014182090759277344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008397579193115234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008540630340576172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008540630340576172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008540630340576172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([294, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018074512481689453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018074512481689453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 294, 128]), torch.Size([1, 294, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01835489273071289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02059793472290039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 294, 128])
m.shape torch.Size([259, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02070474624633789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02070474624633789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02095174789428711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02465677261352539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([187, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024800777435302734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024800777435302734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 187, 128]), torch.Size([1, 187, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024979114532470703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028902530670166016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 187, 128])
m.shape torch.Size([148, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02909564971923828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02909564971923828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 148, 128]), torch.Size([1, 148, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029236793518066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03332996368408203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 148, 128])
m.shape torch.Size([121, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03354787826538086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03354787826538086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.033663272857666016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03781747817993164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([105, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03806018829345703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03806018829345703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03816032409667969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.042466163635253906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([90, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04271650314331055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04271650314331055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04280233383178711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.047093868255615234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([70, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0473179817199707  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0473179817199707  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04738473892211914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05118989944458008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([65, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05143547058105469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05143547058105469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 65, 128]), torch.Size([1, 65, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051497459411621094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.055464744567871094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 65, 128])
m.shape torch.Size([1419, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.062200069427490234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.062200069427490234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06287622451782227  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11281776428222656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 709, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11281776428222656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11281776428222656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 710, 128]), torch.Size([1, 710, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.113494873046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1623854637145996  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 710, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15416383743286133  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15457487106323242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15498590469360352  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15455389022827148  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2758, 40])
input nodes number: 12212
output nodes number: 2758
edges number: 19165
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15464544296264648  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1546459197998047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008785724639892578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 31 input nodes size: 11583
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0083770751953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0083770751953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013900279998779297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013921260833740234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008077144622802734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008216381072998047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008216381072998047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008216381072998047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([325, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017516136169433594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017516136169433594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 325, 128]), torch.Size([1, 325, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017826080322265625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020305633544921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 325, 128])
m.shape torch.Size([244, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020383358001708984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020383358001708984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 244, 128]), torch.Size([1, 244, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02061605453491211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024106502532958984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 244, 128])
m.shape torch.Size([212, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02429342269897461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02429342269897461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 212, 128]), torch.Size([1, 212, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024495601654052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028943538665771484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 212, 128])
m.shape torch.Size([164, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029155254364013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029155254364013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 164, 128]), torch.Size([1, 164, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029311656951904297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03384733200073242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 164, 128])
m.shape torch.Size([145, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.034114837646484375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.034114837646484375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 145, 128]), torch.Size([1, 145, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03425312042236328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.039231300354003906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 145, 128])
m.shape torch.Size([92, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03942537307739258  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03942537307739258  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 92, 128]), torch.Size([1, 92, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03951311111450195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04328584671020508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 92, 128])
m.shape torch.Size([99, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043572425842285156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043572425842285156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.043666839599609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04838752746582031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 99, 128])
m.shape torch.Size([68, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0485997200012207  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0485997200012207  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04866456985473633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05236101150512695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([67, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052616119384765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052616119384765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 67, 128]), torch.Size([1, 67, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052680015563964844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056769371032714844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 67, 128])
m.shape torch.Size([1343, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0631413459777832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0631413459777832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 671, 128]), torch.Size([1, 671, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0637812614440918  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1098780632019043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 671, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1098780632019043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1098780632019043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 672, 128]), torch.Size([1, 672, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1105189323425293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15631484985351562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes
[03:22:09] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 14284864 edges into 32 parts and get 3566302 edge cuts

rst 1 shape torch.Size([1, 672, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14835691452026367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14876842498779297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14917993545532227  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14874744415283203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2759, 40])
input nodes number: 11583
output nodes number: 2759
edges number: 18652
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14885520935058594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14885568618774414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008473873138427734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008473873138427734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008473873138427734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004025988280773163 |0.00039699673652648926 |0.03731168806552887 |7.633864879608154e-05 |0.0163906067609787 |0.002847433090209961 |
----------------------------------------------------------pseudo_mini_loss sum 3.2689833641052246
Total (block generation + training)time/epoch 11.71524977684021
* Pure training time/epoch 1.8652992248535156
Training time/epoch 2.0185904502868652
Training time without block to device /epoch 2.0058865547180176
Training time without total dataloading part /epoch 1.7237637042999268
load block tensor time/epoch 0.1288316249847412
block to device time/epoch 0.012703895568847656
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  251653
Number of first layer input nodes during this epoch:  251653
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008473396301269531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.014430046081542969
global_2_local spend time (sec) 0.04221773147583008
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003470182418823242
A = g.adjacency_matrix() spent  0.00564265251159668
auxiliary_graph
Graph(num_nodes=145027, num_edges=14375805,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07310748100280762
remove nodes length
54086
auxiliary_graph.remove_nodes spent  0.6387064456939697
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=14375805,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.5832779407501221

the counter of shared neighbor distribution
Counter({1.0: 12899956, 2.0: 1173186, 3.0: 165808, 4.0: 33362, 5.0: 8940, 6.0: 2608, 7.0: 762, 8.0: 204, 9.0: 36, 10.0: 2})
14284864
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 14284861, 14284862, 14284863])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 12899956, 2.0: 1173186, 3.0: 165808, 4.0: 33362, 5.0: 8940, 6.0: 2608, 7.0: 762, 8.0: 204, 9.0: 36, 10.0: 2})
Convert a graph into a bidirected graph: 0.569 seconds
Metis partitioning: 2.832 seconds
Split the graph: 0.472 seconds
Construct subgraphs: 0.020 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  3.8992743492126465
2795
2807
2864
2810
2870
2903
2927
2877
2904
2871
2891
2894
2922
2882
2887
2890
2785
2864
2903
2818
2777
2867
2760
2828
2804
2791
2781
2760
2758
2817
2758
2876
total k batches seeds list generation spend  8.844213008880615
after graph partition
graph partition algorithm spend time 8.918160915374756
2795
2807
2864
2810
2870
2903
2927
2877
2904
2871
2891
2894
2922
2882
2887
2890
2785
2864
2903
2818
2777
2867
2760
2828
2804
2791
2781
2760
2758
2817
2758
2876
partition_len_list
[6079, 7689, 6260, 6414, 5482, 6319, 5678, 5700, 5143, 5199, 5278, 5582, 7180, 5868, 5894, 5795, 6976, 8029, 7207, 6588, 8513, 6870, 8743, 9031, 12395, 11431, 10596, 11443, 12976, 11725, 11500, 12258]
shared_neighbor_graph_partition_s0 selection method  spend 9.017836570739746
time for parepare:  0.017978429794311523
local_output_nid generation:  0.0007202625274658203
local_in_edges_tensor generation:  0.0008809566497802734
mini_batch_src_global generation:  0.0008285045623779297
r_  generation:  0.005467653274536133
local_output_nid generation:  0.0007374286651611328
local_in_edges_tensor generation:  0.0007495880126953125
mini_batch_src_global generation:  0.0007748603820800781
r_  generation:  0.0052490234375
local_output_nid generation:  0.0007722377777099609
local_in_edges_tensor generation:  0.0007188320159912109
mini_batch_src_global generation:  0.0006253719329833984
r_  generation:  0.00562286376953125
local_output_nid generation:  0.0007836818695068359
local_in_edges_tensor generation:  0.0006794929504394531
mini_batch_src_global generation:  0.0005502700805664062
r_  generation:  0.00497889518737793
local_output_nid generation:  0.0008275508880615234
local_in_edges_tensor generation:  0.0006756782531738281
mini_batch_src_global generation:  0.0006098747253417969
r_  generation:  0.0056972503662109375
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0006628036499023438
mini_batch_src_global generation:  0.0006234645843505859
r_  generation:  0.005609273910522461
local_output_nid generation:  0.0008409023284912109
local_in_edges_tensor generation:  0.0006670951843261719
mini_batch_src_global generation:  0.0006806850433349609
r_  generation:  0.006177186965942383
local_output_nid generation:  0.0008327960968017578
local_in_edges_tensor generation:  0.000637054443359375
mini_batch_src_global generation:  0.0006115436553955078
r_  generation:  0.00562739372253418
local_output_nid generation:  0.0008347034454345703
local_in_edges_tensor generation:  0.0006330013275146484
mini_batch_src_global generation:  0.0005269050598144531
r_  generation:  0.0047817230224609375
local_output_nid generation:  0.0008237361907958984
local_in_edges_tensor generation:  0.0006175041198730469
mini_batch_src_global generation:  0.0004992485046386719
r_  generation:  0.004677772521972656
local_output_nid generation:  0.000823974609375
local_in_edges_tensor generation:  0.0006232261657714844
mini_batch_src_global generation:  0.0004642009735107422
r_  generation:  0.004407405853271484
local_output_nid generation:  0.0008139610290527344
local_in_edges_tensor generation:  0.0006422996520996094
mini_batch_src_global generation:  0.0006003379821777344
r_  generation:  0.005551338195800781
local_output_nid generation:  0.0008432865142822266
local_in_edges_tensor generation:  0.0006511211395263672
mini_batch_src_global generation:  0.0006303787231445312
r_  generation:  0.005809783935546875
local_output_nid generation:  0.0008511543273925781
local_in_edges_tensor generation:  0.0006158351898193359
mini_batch_src_global generation:  0.00054931640625
r_  generation:  0.004884481430053711
local_output_nid generation:  0.0008339881896972656
local_in_edges_tensor generation:  0.0006456375122070312
mini_batch_src_global generation:  0.0006258487701416016
r_  generation:  0.0056879520416259766
local_output_nid generation:  0.00086212158203125
local_in_edges_tensor generation:  0.0006220340728759766
mini_batch_src_global generation:  0.0005588531494140625
r_  generation:  0.005290031433105469
local_output_nid generation:  0.0008130073547363281
local_in_edges_tensor generation:  0.0005948543548583984
mini_batch_src_global generation:  0.0005028247833251953
r_  generation:  0.004521608352661133
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0006334781646728516
mini_batch_src_global generation:  0.0006270408630371094
r_  generation:  0.005524873733520508
local_output_nid generation:  0.0009129047393798828
local_in_edges_tensor generation:  0.0006604194641113281
mini_batch_src_global generation:  0.0006062984466552734
r_  generation:  0.005219459533691406
local_output_nid generation:  0.0008947849273681641
local_in_edges_tensor generation:  0.0006277561187744141
mini_batch_src_global generation:  0.0005412101745605469
r_  generation:  0.004724025726318359
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0006296634674072266
mini_batch_src_global generation:  0.0005471706390380859
r_  generation:  0.004649162292480469
local_output_nid generation:  0.0010342597961425781
local_in_edges_tensor generation:  0.0006663799285888672
mini_batch_src_global generation:  0.0005698204040527344
r_  generation:  0.005071401596069336
local_output_nid generation:  0.0011491775512695312
local_in_edges_tensor generation:  0.0006811618804931641
mini_batch_src_global generation:  0.0006349086761474609
r_  generation:  0.004716634750366211
local_output_nid generation:  0.0010979175567626953
local_in_edges_tensor generation:  0.0006706714630126953
mini_batch_src_global generation:  0.0006463527679443359
r_  generation:  0.005257129669189453
local_output_nid generation:  0.00104522705078125
local_in_edges_tensor generation:  0.0006661415100097656
mini_batch_src_global generation:  0.0007722377777099609
r_  generation:  0.005891561508178711
local_output_nid generation:  0.0010578632354736328
local_in_edges_tensor generation:  0.0006375312805175781
mini_batch_src_global generation:  0.0006837844848632812
r_  generation:  0.005867481231689453
local_output_nid generation:  0.0010004043579101562
local_in_edges_tensor generation:  0.0006341934204101562
mini_batch_src_global generation:  0.0006654262542724609
r_  generation:  0.005071163177490234
local_output_nid generation:  0.000978708267211914
local_in_edges_tensor generation:  0.0006444454193115234
mini_batch_src_global generation:  0.0006711483001708984
r_  generation:  0.006098747253417969
local_output_nid generation:  0.0009560585021972656
local_in_edges_tensor generation:  0.0006921291351318359
mini_batch_src_global generation:  0.0007352828979492188
r_  generation:  0.00634312629699707
local_output_nid generation:  0.0010044574737548828
local_in_edges_tensor generation:  0.0006258487701416016
mini_batch_src_global generation:  0.0006492137908935547
r_  generation:  0.005306720733642578
local_output_nid generation:  0.0009288787841796875
local_in_edges_tensor generation:  0.0006749629974365234
mini_batch_src_global generation:  0.0007054805755615234
r_  generation:  0.005991935729980469
local_output_nid generation:  0.0009601116180419922
local_in_edges_tensor generation:  0.0006306171417236328
mini_batch_src_global generation:  0.000804901123046875
r_  generation:  0.006566524505615234
----------------------check_connections_block total spend ----------------------------- 0.31549978256225586
generate_one_block  0.012145042419433594
generate_one_block  0.009303808212280273
generate_one_block  0.008169174194335938
generate_one_block  0.0072100162506103516
generate_one_block  0.007896900177001953
generate_one_block  0.00781559944152832
generate_one_block  0.008580923080444336
generate_one_block  0.007924318313598633
generate_one_block  0.00656890869140625
generate_one_block  0.0064945220947265625
generate_one_block  0.0060961246490478516
generate_one_block  0.00816488265991211
generate_one_block  0.008949756622314453
generate_one_block  0.007101535797119141
generate_one_block  0.00801539421081543
generate_one_block  0.007318019866943359
generate_one_block  0.012262821197509766
generate_one_block  0.008338212966918945
generate_one_block  0.007452487945556641
generate_one_block  0.006592273712158203
generate_one_block  0.00701141357421875
generate_one_block  0.0067901611328125
generate_one_block  0.007053852081298828
generate_one_block  0.007925748825073242
generate_one_block  0.009446144104003906
generate_one_block  0.009494781494140625
generate_one_block  0.008196830749511719
generate_one_block  0.009907245635986328
generate_one_block  0.009918212890625
generate_one_block  0.00864100456237793
generate_one_block  0.009308815002441406
generate_one_block  0.010372400283813477
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008473396301269531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

connection checking time:  0.31549978256225586
block generation total time  0.2664673328399658
average batch blocks generation time:  0.008327104151248932
block dataloader generation time/epoch 9.682456851005554
pseudo mini batch 0 input nodes size: 6079
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008076667785644531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008076667785644531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.010975360870361328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.010996341705322266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005452156066894531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005576133728027344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005576133728027344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005576133728027344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([352, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013895988464355469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013895988464355469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014231681823730469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01691722869873047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([326, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017060279846191406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017060279846191406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017371177673339844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022034645080566406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([286, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02228832244873047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02228832244873047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 286, 128]), torch.Size([1, 286, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022561073303222656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02856159210205078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 286, 128])
m.shape torch.Size([213, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02883148193359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02883148193359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 213, 128]), torch.Size([1, 213, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02903461456298828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03492546081542969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 213, 128])
m.shape torch.Size([176, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03524351119995117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03524351119995117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03541135787963867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04145383834838867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([159, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0418248176574707  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0418248176574707  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 159, 128]), torch.Size([1, 159, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0419764518737793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04849672317504883  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 159, 128])
m.shape torch.Size([144, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04890155792236328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04890155792236328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 144, 128]), torch.Size([1, 144, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04903888702392578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05590534210205078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 144, 128])
m.shape torch.Size([127, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056321144104003906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056321144104003906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0564422607421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06334590911865234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([91, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0636758804321289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0636758804321289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06376266479492188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06931686401367188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([921, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07366514205932617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07366514205932617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07410383224487305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10525083541870117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 460, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10525083541870117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10525083541870117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10569047927856445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13668584823608398  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 461, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1298232078552246  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13023996353149414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13065671920776367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1302189826965332  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2795, 40])
input nodes number: 6079
output nodes number: 2795
edges number: 16601
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13029050827026367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13029146194458008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0057830810546875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 1 input nodes size: 7689
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005458354949951172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005458354949951172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009124755859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009145736694335938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006226062774658203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006345272064208984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006345272064208984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006345272064208984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([395, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014379501342773438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014379501342773438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014756202697753906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017769813537597656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([339, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01790475845336914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01790475845336914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 339, 128]), torch.Size([1, 339, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01822805404663086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02307748794555664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 339, 128])
m.shape torch.Size([278, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023313522338867188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023313522338867188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 278, 128]), torch.Size([1, 278, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023578643798828125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02941131591796875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 278, 128])
m.shape torch.Size([231, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02971935272216797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02971935272216797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029939651489257812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03632831573486328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([205, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03670692443847656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03670692443847656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036902427673339844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04394054412841797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 205, 128])
m.shape torch.Size([173, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04433774948120117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04433774948120117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04450273513793945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05159711837768555  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 173, 128])
m.shape torch.Size([140, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05198192596435547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05198192596435547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 140, 128]), torch.Size([1, 140, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052115440368652344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058791160583496094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 140, 128])
m.shape torch.Size([123, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05919361114501953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05919361114501953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0593109130859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06599712371826172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([119, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06644916534423828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06644916534423828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06656265258789062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07382583618164062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([804, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07760286331176758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07760286331176758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 402, 128]), torch.Size([1, 402, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07798624038696289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10520601272583008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 402, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10520601272583008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10520601272583008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 402, 128]), torch.Size([1, 402, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10558938980102539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13261747360229492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 402, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12649106979370117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12690973281860352  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12732839584350586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12688875198364258  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2807, 40])
input nodes number: 7689
output nodes number: 2807
edges number: 15969
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1269693374633789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1269698143005371  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0065555572509765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 2 input nodes size: 6260
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006227970123291016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006227970123291016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009212970733642578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009234428405761719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005547046661376953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005673885345458984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005673885345458984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005673885345458984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([386, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014163017272949219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014163017272949219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 386, 128]), torch.Size([1, 386, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014531135559082031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01747608184814453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 386, 128])
m.shape torch.Size([329, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01760578155517578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01760578155517578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017919540405273438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02262592315673828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([286, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022878170013427734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022878170013427734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 286, 128]), torch.Size([1, 286, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023150920867919922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029151439666748047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 286, 128])
m.shape torch.Size([225, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029444217681884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029444217681884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 225, 128]), torch.Size([1, 225, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029658794403076172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03588151931762695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 225, 128])
m.shape torch.Size([192, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03623199462890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03623199462890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 192, 128]), torch.Size([1, 192, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03641510009765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04300689697265625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 192, 128])
m.shape torch.Size([154, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04335594177246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04335594177246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 154, 128]), torch.Size([1, 154, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0435028076171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04981803894042969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 154, 128])
m.shape torch.Size([117, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050135135650634766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050135135650634766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0502467155456543  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05582571029663086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([116, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056212425231933594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056212425231933594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05632305145263672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06262874603271484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([111, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0630497932434082  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0630497932434082  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 111, 128]), torch.Size([1, 111, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0631556510925293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0699305534362793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 111, 128])
m.shape torch.Size([948, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07469320297241211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07469320297241211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07514524459838867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10724020004272461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 474, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10724020004272461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10724020004272461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10769224166870117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13956117630004883  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 474, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13257646560668945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13300323486328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13343000411987305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1329817771911621  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2864, 40])
input nodes number: 6260
output nodes number: 2864
edges number: 16912
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1330580711364746  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1330585479736328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0058879852294921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 3 input nodes size: 6414
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005555152893066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005555152893066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009221553802490234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009242534637451172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006236076354980469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006343841552734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006343841552734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006343841552734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([514, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0136566162109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0136566162109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014146804809570312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018068313598632812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([423, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01822662353515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01822662353515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018630027770996094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02468109130859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([334, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02495718002319336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02495718002319336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 334, 128]), torch.Size([1, 334, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025275707244873047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03228330612182617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 334, 128])
m.shape torch.Size([216, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03253602981567383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03253602981567383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 216, 128]), torch.Size([1, 216, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03274202346801758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03871583938598633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 216, 128])
m.shape torch.Size([180, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.039041996002197266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.039041996002197266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 180, 128]), torch.Size([1, 180, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03921365737915039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04539346694946289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 180, 128])
m.shape torch.Size([148, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0457310676574707  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0457310676574707  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 148, 128]), torch.Size([1, 148, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04587221145629883  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0519413948059082  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 148, 128])
m.shape torch.Size([125, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052288055419921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052288055419921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052407264709472656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05836772918701172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([82, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05862092971801758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05862092971801758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05869913101196289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0631566047668457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([64, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06339216232299805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06339216232299805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 64, 128]), torch.Size([1, 64, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06345319747924805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06735944747924805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 64, 128])
m.shape torch.Size([724, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07078123092651367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07078123092651367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07112646102905273  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09563779830932617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 362, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09563779830932617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09563779830932617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09598302841186523  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12032175064086914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 362, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11458158493041992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11500072479248047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11541986465454102  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11497974395751953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2810, 40])
input nodes number: 6414
output nodes number: 2810
edges number: 14361
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11504125595092773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11504173278808594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006523609161376953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 4 input nodes size: 5482
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006228446960449219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006228446960449219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00884246826171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00886392593383789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005176544189453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005305290222167969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005305290222167969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005305290222167969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([350, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013934135437011719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013934135437011719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014267921447753906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016938209533691406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([324, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017080307006835938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017080307006835938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 324, 128]), torch.Size([1, 324, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017389297485351562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022024154663085938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 324, 128])
m.shape torch.Size([282, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02227306365966797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02227306365966797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 282, 128]), torch.Size([1, 282, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02254199981689453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028458595275878906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 282, 128])
m.shape torch.Size([231, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028764724731445312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028764724731445312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028985023498535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035373687744140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([184, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03570222854614258  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03570222854614258  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 184, 128]), torch.Size([1, 184, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03587770462036133  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04219484329223633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 184, 128])
m.shape torch.Size([163, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04257345199584961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04257345199584961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 163, 128]), torch.Size([1, 163, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04272890090942383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.049413204193115234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 163, 128])
m.shape torch.Size([132, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04977607727050781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04977607727050781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 132, 128]), torch.Size([1, 132, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04990196228027344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05619621276855469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 132, 128])
m.shape torch.Size([140, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056667327880859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056667327880859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 140, 128]), torch.Size([1, 140, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05680084228515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06441116333007812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 140, 128])
m.shape torch.Size([116, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06484222412109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06484222412109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06495285034179688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07203292846679688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([948, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0770106315612793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0770106315612793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07746267318725586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1095576286315918  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 474, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1095576286315918  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1095576286315918  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11000967025756836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14187860488891602  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 474, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13474178314208984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13516950607299805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13559722900390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1351480484008789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2870, 40])
input nodes number: 5482
output nodes number: 2870
edges number: 17234
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13521909713745117  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13521957397460938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00551605224609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 5 input nodes size: 6319
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005185127258300781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005185127258300781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00885152816772461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008873462677001953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006237983703613281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0063629150390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0063629150390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0063629150390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([373, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0147247314453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0147247314453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015080451965332031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01792621612548828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([376, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018106937408447266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018106937408447266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018465518951416016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023844242095947266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 376, 128])
m.shape torch.Size([283, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024069786071777344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024069786071777344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024339675903320312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030277252197265625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 283, 128])
m.shape torch.Size([263, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030643939971923828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030643939971923828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 263, 128]), torch.Size([1, 263, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030894756317138672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03816843032836914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 263, 128])
m.shape torch.Size([191, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0384984016418457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0384984016418457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0386805534362793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04523801803588867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([173, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04564189910888672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04564189910888672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 173, 128]), torch.Size([1, 173, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045806884765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052901268005371094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 173, 128])
m.shape torch.Size([150, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.053319454193115234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.053319454193115234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 150, 128]), torch.Size([1, 150, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05346250534057617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06061506271362305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 150, 128])
m.shape torch.Size([114, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06097841262817383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06097841262817383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06108713150024414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06728410720825195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 114, 128])
m.shape torch.Size([120, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06774473190307617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06774473190307617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06785917282104492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07518339157104492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([860, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07922697067260742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07922697067260742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07963705062866211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10875272750854492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 430, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10875272750854492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10875272750854492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10916280746459961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13807344436645508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 430, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13124847412109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1316814422607422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13211441040039062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13165950775146484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2903, 40])
input nodes number: 6319
output nodes number: 2903
edges number: 16661
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13173389434814453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13173437118530273  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006573200225830078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 6 input nodes size: 5678
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006243228912353516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006243228912353516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00895071029663086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008972644805908203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005284309387207031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005428314208984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005428314208984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005428314208984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([228, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014974117279052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014974117279052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 228, 128]), torch.Size([1, 228, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01519155502319336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01693105697631836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 228, 128])
m.shape torch.Size([250, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01706075668334961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01706075668334961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 250, 128]), torch.Size([1, 250, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017299175262451172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02087545394897461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 250, 128])
m.shape torch.Size([240, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021099567413330078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021099567413330078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 240, 128]), torch.Size([1, 240, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021328449249267578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.026363849639892578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 240, 128])
m.shape torch.Size([241, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02670907974243164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02670907974243164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 241, 128]), torch.Size([1, 241, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.026938915252685547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03360414505004883  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 241, 128])
m.shape torch.Size([221, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03401613235473633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03401613235473633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 221, 128]), torch.Size([1, 221, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03422689437866211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041814327239990234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 221, 128])
m.shape torch.Size([200, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.042281150817871094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.042281150817871094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 200, 128]), torch.Size([1, 200, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.042471885681152344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050673484802246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 200, 128])
m.shape torch.Size([180, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051178932189941406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051178932189941406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 180, 128]), torch.Size([1, 180, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05135059356689453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05993366241455078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 180, 128])
m.shape torch.Size([146, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06040477752685547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06040477752685547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 146, 128]), torch.Size([1, 146, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06054401397705078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0684804916381836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 146, 128])
m.shape torch.Size([107, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06887006759643555  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06887006759643555  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 107, 128]), torch.Size([1, 107, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06897211074829102  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07550287246704102  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 107, 128])
m.shape torch.Size([1114, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0807638168334961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0807638168334961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08129501342773438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12068939208984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 557, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12068939208984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12068939208984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12122058868408203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1594862937927246  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 557, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15137815475463867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15181446075439453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1522507667541504  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1517925262451172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2927, 40])
input nodes number: 5678
output nodes number: 2927
edges number: 19248
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15186023712158203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15186071395874023  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005650997161865234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 7 input nodes size: 5700
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005287647247314453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005287647247314453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008954048156738281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008975505828857422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006246089935302734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006374835968017578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006374835968017578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006374835968017578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([328, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014989852905273438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014989852905273438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015302658081054688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017805099487304688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([327, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017960548400878906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017960548400878906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01827239990234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.022950172424316406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([276, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023189067840576172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023189067840576172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 276, 128]), torch.Size([1, 276, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023452281951904297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029242992401123047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 276, 128])
m.shape torch.Size([269, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029624462127685547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029624462127685547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029881000518798828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037320613861083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([189, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0376429557800293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0376429557800293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 189, 128]), torch.Size([1, 189, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03782320022583008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0443120002746582  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 189, 128])
m.shape torch.Size([176, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04472541809082031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04472541809082031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04489326477050781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05211067199707031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([143, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05250406265258789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05250406265258789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 143, 128]), torch.Size([1, 143, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052640438079833984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05945920944213867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 143, 128])
m.shape torch.Size([113, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05982208251953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05982208251953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.059929847717285156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06607246398925781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([125, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06655502319335938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06655502319335938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 125, 128]), torch.Size([1, 125, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06667423248291016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07430362701416016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 125, 128])
m.shape torch.Size([931, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07868337631225586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07868337631225586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07912683486938477  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11061239242553711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 465, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11061239242553711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11061239242553711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11105680465698242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14238834381103516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 466, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13526201248168945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13569116592407227  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13612031936645508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13566970825195312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2877, 40])
input nodes number: 5700
output nodes number: 2877
edges number: 17227
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1357269287109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1357274055480957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006571769714355469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 8 input nodes size: 5143
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0062389373779296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0062389373779296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00869131088256836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008713245391845703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005025386810302734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005127429962158203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005127429962158203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005127429962158203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([530, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012073516845703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012073516845703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012578964233398438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01725625991821289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([476, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01745748519897461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01745748519897461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017911434173583984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02472066879272461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([350, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024994373321533203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024994373321533203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02532815933227539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032671451568603516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([261, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.033002376556396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.033002376556396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.033251285552978516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04046964645385742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([259, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04096269607543945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04096269607543945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04120969772338867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05010175704956055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([177, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050484657287597656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050484657287597656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 177, 128]), torch.Size([1, 177, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05065345764160156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05791187286376953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 177, 128])
m.shape torch.Size([179, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058424949645996094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058424949645996094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 179, 128]), torch.Size([1, 179, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05859565734863281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06713104248046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 179, 128])
m.shape torch.Size([116, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06748819351196289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06748819351196289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06759881973266602  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07390451431274414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([96, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07426118850708008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07426118850708008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 96, 128]), torch.Size([1, 96, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07435274124145508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08021211624145508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 96, 128])
m.shape torch.Size([460, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08235979080200195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08235979080200195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08257913589477539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09815263748168945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 230, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09815263748168945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09815263748168945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09837198257446289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11383581161499023  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 230, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10916471481323242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10959768295288086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1100306510925293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10957574844360352  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2904, 40])
input nodes number: 5143
output nodes number: 2904
edges number: 13578
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10964012145996094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10964059829711914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005304813385009766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 9 input nodes size: 5199
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005029201507568359  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005029201507568359  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007508277893066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007529735565185547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005055427551269531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005154609680175781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005154609680175781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005154609680175781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([517, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011932849884033203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011932849884033203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012425899505615234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016370296478271484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([462, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016564369201660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016564369201660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017004966735839844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023613929748535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([378, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023934364318847656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023934364318847656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02429485321044922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032225608825683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([294, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03260612487792969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03260612487792969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 294, 128]), torch.Size([1, 294, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032886505126953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04101753234863281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 294, 128])
m.shape torch.Size([238, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04144477844238281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04144477844238281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 238, 128]), torch.Size([1, 238, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0416717529296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04984283447265625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 238, 128])
m.shape torch.Size([181, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0502471923828125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0502471923828125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 181, 128]), torch.Size([1, 181, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05041980743408203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057842254638671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 181, 128])
m.shape torch.Size([149, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05825328826904297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05825328826904297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 149, 128]), torch.Size([1, 149, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0583953857421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06550025939941406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 149, 128])
m.shape torch.Size([122, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06589460372924805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06589460372924805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 122, 128]), torch.Size([1, 122, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06601095199584961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07264280319213867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 122, 128])
m.shape torch.Size([95, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07299232482910156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07299232482910156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07308292388916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07888126373291016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([435, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08091020584106445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08091020584106445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 217, 128]), torch.Size([1, 217, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08111715316772461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0958104133605957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 217, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0958104133605957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0958104133605957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09601831436157227  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11067581176757812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 218, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10556221008300781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10599040985107422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10641860961914062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10596895217895508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2871, 40])
input nodes number: 5199
output nodes number: 2871
edges number: 13251
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10602474212646484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10602521896362305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005320549011230469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 10 input nodes size: 5278
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0050506591796875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0050506591796875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007567405700683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0075893402099609375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00508880615234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00518035888671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00518035888671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00518035888671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([621, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011507034301757812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011507034301757812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012099266052246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016947269439697266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([511, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01713848114013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01713848114013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017625808715820312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02493572235107422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([416, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025287151336669922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025287151336669922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025683879852294922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03441190719604492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([269, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.034726619720458984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.034726619720458984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.034983158111572266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04242277145385742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([229, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04284048080444336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04284048080444336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 229, 128]), torch.Size([1, 229, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04305887222290039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050920963287353516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 229, 128])
m.shape torch.Size([167, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05128955841064453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05128955841064453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051448822021484375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058297157287597656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 167, 128])
m.shape torch.Size([122, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0586247444152832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0586247444152832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 122, 128]), torch.Size([1, 122, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058741092681884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06455850601196289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 122, 128])
m.shape torch.Size([113, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06493139266967773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06493139266967773  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06503915786743164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0711817741394043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([86, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07149696350097656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07149696350097656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 86, 128]), torch.Size([1, 86, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0715789794921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0768280029296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 86, 128])
m.shape torch.Size([357, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07848930358886719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07848930358886719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 178, 128]), torch.Size([1, 178, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0786590576171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09071159362792969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 178, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09071159362792969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09071159362792969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 179, 128]), torch.Size([1, 179, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0908823013305664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10291767120361328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 179, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0983266830444336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09875774383544922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09918880462646484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09873580932617188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2891, 40])
input nodes number: 5278
output nodes number: 2891
edges number: 12216
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0988001823425293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0988006591796875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005347251892089844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 11 input nodes size: 5582
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005091667175292969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005091667175292969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0077533721923828125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007775306701660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005236625671386719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005356788635253906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005356788635253906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005356788635253906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([399, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013457298278808594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013457298278808594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013837814331054688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016881942749023438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 399, 128])
m.shape torch.Size([368, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01704263687133789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01704263687133789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 368, 128]), torch.Size([1, 368, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01739358901977539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02265787124633789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 368, 128])
m.shape torch.Size([306, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02292013168334961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02292013168334961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 306, 128]), torch.Size([1, 306, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023211956024169922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029632091522216797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 306, 128])
m.shape torch.Size([265, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029991626739501953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029991626739501953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 265, 128]), torch.Size([1, 265, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03024435043334961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03757333755493164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 265, 128])
m.shape torch.Size([194, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037909507751464844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037909507751464844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 194, 128]), torch.Size([1, 194, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.038094520568847656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.044754981994628906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 194, 128])
m.shape torch.Size([175, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04516315460205078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04516315460205078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 175, 128]), torch.Size([1, 175, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045330047607421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052506446838378906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 175, 128])
m.shape torch.Size([169, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052987098693847656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052987098693847656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 169, 128]), torch.Size([1, 169, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05314826965332031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061206817626953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 169, 128])
m.shape torch.Size([138, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06165266036987305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06165266036987305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06178426742553711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06928586959838867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([129, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06977367401123047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06977367401123047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 129, 128]), torch.Size([1, 129, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06989669799804688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07777023315429688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 129, 128])
m.shape torch.Size([751, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0819096565246582  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0819096565246582  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08226728439331055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10765886306762695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 375, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10765886306762695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10765886306762695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1080174446105957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13329792022705078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 376, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12761926651000977  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1280508041381836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12848234176635742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12802886962890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2894, 40])
input nodes number: 5582
output nodes number: 2894
edges number: 16091
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12809324264526367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12809371948242188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0055522918701171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 12 input nodes size: 7180
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005237102508544922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005237102508544922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00866079330444336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008682727813720703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005999088287353516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006128787994384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006128787994384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006128787994384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([361, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0148162841796875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0148162841796875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015160560607910156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017914772033691406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([317, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01804494857788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01804494857788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01834726333618164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02288198471069336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([286, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02313995361328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02313995361328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 286, 128]), torch.Size([1, 286, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023412704467773438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029413223266601562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 286, 128])
m.shape torch.Size([255, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029763221740722656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029763221740722656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03000640869140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03705883026123047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 255, 128])
m.shape torch.Size([233, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03749275207519531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03749275207519531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 233, 128]), torch.Size([1, 233, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03771495819091797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045714378356933594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 233, 128])
m.shape torch.Size([147, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04602384567260742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04602384567260742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 147, 128]), torch.Size([1, 147, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04616403579711914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05219221115112305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 147, 128])
m.shape torch.Size([136, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05257606506347656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05257606506347656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 136, 128]), torch.Size([1, 136, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05270576477050781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05919075012207031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 136, 128])
m.shape torch.Size([151, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05970191955566406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05970191955566406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.059845924377441406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06805419921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([97, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06839847564697266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06839847564697266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06849098205566406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07441139221191406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([939, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0788426399230957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0788426399230957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07928991317749023  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11104631423950195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 469, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11104631423950195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11104631423950195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11149454116821289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1430950164794922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 470, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13593339920043945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1363692283630371  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13680505752563477  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13634729385375977  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2922, 40])
input nodes number: 7180
output nodes number: 2922
edges number: 17343
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1364274024963379  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1364278793334961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0063495635986328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 13 input nodes size: 5868
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006003379821777344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006003379821777344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008801460266113281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008823394775390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005377769470214844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005482673645019531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005482673645019531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005482673645019531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([549, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012641429901123047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012641429901123047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013164997100830078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017635822296142578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([430, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01778411865234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01778411865234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018194198608398438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02434539794921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([337, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024622440338134766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024622440338134766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024943828582763672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03201436996459961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([272, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032372474670410156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032372474670410156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 272, 128]), torch.Size([1, 272, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032631874084472656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040154457092285156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 272, 128])
m.shape torch.Size([220, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040549278259277344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040549278259277344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 220, 128]), torch.Size([1, 220, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04075908660888672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04831218719482422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 220, 128])
m.shape torch.Size([160, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04866504669189453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04866504669189453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 160, 128]), torch.Size([1, 160, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04881763458251953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05537891387939453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 160, 128])
m.shape torch.Size([121, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05570650100708008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05570650100708008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 121, 128]), torch.Size([1, 121, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.055821895599365234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06159162521362305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 121, 128])
m.shape torch.Size([128, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06202220916748047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06202220916748047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06214427947998047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06910228729248047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([87, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06941461563110352  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06941461563110352  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 87, 128]), torch.Size([1, 87, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06949758529663086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07480764389038086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 87, 128])
m.shape torch.Size([578, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07752227783203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07752227783203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07779788970947266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0973663330078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 289, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0973663330078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0973663330078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0976419448852539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11707258224487305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 289, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1115717887878418  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11200141906738281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11243104934692383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11197948455810547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2882, 40])
input nodes number: 5868
output nodes number: 2882
edges number: 14002
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11203908920288086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11203956604003906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005658149719238281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 14 input nodes size: 5894
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005371570587158203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005371570587158203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00879526138305664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008817195892333984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005997180938720703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006124973297119141  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006124973297119141  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006124973297119141  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([374, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014705181121826172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014705181121826172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01506185531616211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01791524887084961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([338, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018059253692626953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018059253692626953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018381595611572266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023216724395751953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 338, 128])
m.shape torch.Size([283, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02346038818359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02346038818359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02373027801513672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02966785430908203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 283, 128])
m.shape torch.Size([243, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029996395111083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029996395111083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030228137969970703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03694868087768555  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([191, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03728818893432617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03728818893432617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037470340728759766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04402780532836914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([138, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04433155059814453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04433155059814453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.044463157653808594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05012226104736328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([138, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05051708221435547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05051708221435547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05064868927001953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057229042053222656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([113, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05759429931640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05759429931640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057702064514160156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06384468078613281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([104, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06423711776733398  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06423711776733398  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06433629989624023  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07068395614624023  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 104, 128])
m.shape torch.Size([965, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07523584365844727  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07523584365844727  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07569551467895508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10833215713500977  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 482, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10833215713500977  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10833215713500977  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10879278182983398  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1412672996520996  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 483, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13419437408447266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13462495803833008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1350555419921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13460302352905273  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2887, 40])
input nodes number: 5894
output nodes number: 2887
edges number: 17110
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13467025756835938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13467073440551758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006330966949462891  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 15 input nodes size: 5795
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005998134613037109  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005998134613037109  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008761405944824219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008783340454101562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005337715148925781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0054531097412109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0054531097412109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0054531097412109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([413, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013222694396972656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013222694396972656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013616561889648438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016767501831054688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([434, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01698446273803711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01698446273803711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017398357391357422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02360677719116211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([314, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023849010467529297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.023849010467529297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 314, 128]), torch.Size([1, 314, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02414846420288086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030736446380615234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 314, 128])
m.shape torch.Size([259, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03108072280883789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03108072280883789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03132772445678711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03849077224731445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([230, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03891563415527344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03891563415527344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.039134979248046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.047031402587890625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 230, 128])
m.shape torch.Size([174, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04741954803466797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04741954803466797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 174, 128]), torch.Size([1, 174, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.047585487365722656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05472087860107422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 174, 128])
m.shape torch.Size([128, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.055065155029296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.055065155029296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.055187225341796875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061290740966796875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([116, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061672210693359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061672210693359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0617828369140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06808853149414062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([98, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06845378875732422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06845378875732422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06854724884033203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07452869415283203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([724, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07793426513671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07793426513671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07827949523925781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10279083251953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 362, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10279083251953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10279083251953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10313606262207031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12747478485107422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 362, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12194538116455078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1223764419555664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12280750274658203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12235450744628906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2890, 40])
input nodes number: 5795
output nodes number: 2890
edges number: 15399
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1224203109741211  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1224207878112793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005645275115966797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 16 input nodes size: 6976
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005338191986083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005338191986083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008761882781982422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00878286361694336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005997657775878906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006092071533203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006092071533203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006092071533203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([574, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012602806091308594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012602806091308594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013150215148925781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01752948760986328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([481, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017714500427246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017714500427246094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0181732177734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025053977966308594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([319, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02528095245361328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02528095245361328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025585174560546875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03227806091308594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([288, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03267526626586914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03267526626586914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03294992446899414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04091501235961914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([198, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041249752044677734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041249752044677734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 198, 128]), torch.Size([1, 198, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04143857955932617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04823637008666992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 198, 128])
m.shape torch.Size([151, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048573970794677734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048573970794677734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04871797561645508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05491018295288086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([113, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05521535873413086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05521535873413086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 113, 128]), torch.Size([1, 113, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.055323123931884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06071138381958008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 113, 128])
m.shape torch.Size([108, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061069488525390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061069488525390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0611724853515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06704330444335938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([76, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06731796264648438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06731796264648438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06739044189453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07202911376953125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([477, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07426738739013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07426738739013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 238, 128]), torch.Size([1, 238, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0744943618774414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09060955047607422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 238, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09060955047607422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09060955047607422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 239, 128]), torch.Size([1, 239, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09083747863769531  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10690689086914062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 239, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10256338119506836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10297870635986328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1033940315246582  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10295772552490234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2785, 40])
input nodes number: 6976
output nodes number: 2785
edges number: 12650
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10301494598388672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10301542282104492  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0062541961669921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 17 input nodes size: 8029
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005981922149658203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005981922149658203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009810447692871094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009831905364990234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006387233734130859  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006510257720947266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006510257720947266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006510257720947266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([408, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014796257019042969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014796257019042969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015185356140136719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01829814910888672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([371, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018457412719726562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018457412719726562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 371, 128]), torch.Size([1, 371, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01881122589111328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024118423461914062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 371, 128])
m.shape torch.Size([242, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024287700653076172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024287700653076172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 242, 128]), torch.Size([1, 242, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024518489837646484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02959585189819336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 242, 128])
m.shape torch.Size([230, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029919147491455078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029919147491455078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030138492584228516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0364995002746582  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 230, 128])
m.shape torch.Size([203, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036873817443847656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036873817443847656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 203, 128]), torch.Size([1, 203, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037067413330078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.044036865234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 203, 128])
m.shape torch.Size([165, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04441213607788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04441213607788086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04456949234008789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051335811614990234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 165, 128])
m.shape torch.Size([148, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051751136779785156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051751136779785156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 148, 128]), torch.Size([1, 148, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05189228057861328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05894947052001953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 148, 128])
m.shape torch.Size([117, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.059325218200683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.059325218200683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.059436798095703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0657968521118164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([100, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06617021560668945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06617021560668945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 100, 128]), torch.Size([1, 100, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06626558303833008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07236909866333008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 100, 128])
m.shape torch.Size([880, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07674551010131836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07674551010131836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07716512680053711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10695791244506836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 440, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10695791244506836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10695791244506836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10737752914428711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13696050643920898  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 440, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1302018165588379  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1306285858154297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13105535507202148  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13060712814331055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2864, 40])
input nodes number: 8029
output nodes number: 2864
edges number: 16473
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13070011138916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13070058822631836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006737232208251953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 18 input nodes size: 7207
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006398677825927734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006398677825927734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009835243225097656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009857177734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006007194519042969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0061187744140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0061187744140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0061187744140625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([499, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013835906982421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013835906982421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014311790466308594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018118858337402344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([388, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01825094223022461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01825094223022461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018620967864990234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02417135238647461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([352, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024489879608154297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024489879608154297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024825572967529297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0322108268737793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([242, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03250455856323242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03250455856323242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 242, 128]), torch.Size([1, 242, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032735347747802734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0394282341003418  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 242, 128])
m.shape torch.Size([240, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03988504409790039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03988504409790039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 240, 128]), torch.Size([1, 240, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04011392593383789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04835367202758789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 240, 128])
m.shape torch.Size([165, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048711299896240234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048711299896240234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048868656158447266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05563497543334961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 165, 128])
m.shape torch.Size([149, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05605363845825195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05605363845825195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 149, 128]), torch.Size([1, 149, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056195735931396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06330060958862305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 149, 128])
m.shape torch.Size([127, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06371402740478516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06371402740478516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 127, 128]), torch.Size([1, 127, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06383514404296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0707387924194336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 127, 128])
m.shape torch.Size([97, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07109451293945312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07109451293945312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 97, 128]), torch.Size([1, 97, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07118701934814453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07710742950439453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 97, 128])
m.shape torch.Size([644, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08013200759887695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08013200759887695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.08043909072875977  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10224199295043945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 322, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10224199295043945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10224199295043945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10254907608032227  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12419843673706055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 322, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11811637878417969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11854934692382812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11898231506347656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11852741241455078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2903, 40])
input nodes number: 7207
output nodes number: 2903
edges number: 14861
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11860942840576172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11860990524291992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006323337554931641  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 19 input nodes size: 6588
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006013393402099609  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006013393402099609  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009154796600341797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009176254272460938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005717754364013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005816936492919922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005816936492919922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005816936492919922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([496, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012575149536132812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012575149536132812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013048171997070312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.016832351684570312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([463, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017037391662597656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017037391662597656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01747894287109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024102210998535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([391, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024440765380859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024440765380859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 391, 128]), torch.Size([1, 391, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02481365203857422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03301715850830078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 391, 128])
m.shape torch.Size([262, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.033330440521240234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.033330440521240234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03358030319213867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04082632064819336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 262, 128])
m.shape torch.Size([227, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04124259948730469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04124259948730469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 227, 128]), torch.Size([1, 227, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041459083557128906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04925251007080078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 227, 128])
m.shape torch.Size([174, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.049642086029052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.049642086029052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 174, 128]), torch.Size([1, 174, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04980802536010742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056943416595458984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 174, 128])
m.shape torch.Size([115, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057244300842285156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057244300842285156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 115, 128]), torch.Size([1, 115, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057353973388671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06283760070800781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 115, 128])
m.shape torch.Size([103, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06317567825317383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06317567825317383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06327390670776367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06887292861938477  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([90, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06921005249023438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06921005249023438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06929588317871094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07478904724121094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([497, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07711601257324219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07711601257324219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 248, 128]), torch.Size([1, 248, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07735252380371094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09414482116699219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 248, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09414482116699219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09414482116699219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 249, 128]), torch.Size([1, 249, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09438228607177734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11112403869628906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 249, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10598039627075195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1064004898071289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10682058334350586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10637903213500977  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2818, 40])
input nodes number: 6588
output nodes number: 2818
edges number: 13231
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10643672943115234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10643720626831055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005984783172607422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 20 input nodes size: 8513
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0057048797607421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0057048797607421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00976419448852539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009785175323486328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006622314453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0067195892333984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0067195892333984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0067195892333984375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([556, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013392448425292969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013392448425292969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013922691345214844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018164634704589844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([484, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01836109161376953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01836109161376953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018822669982910156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02574634552001953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([323, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025977611541748047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025977611541748047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.026285648345947266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03306245803833008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([244, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03337383270263672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03337383270263672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 244, 128]), torch.Size([1, 244, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.033606529235839844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04035472869873047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 244, 128])
m.shape torch.Size([190, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040691375732421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040691375732421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 190, 128]), torch.Size([1, 190, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04087257385253906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04739570617675781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 190, 128])
m.shape torch.Size([151, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04773712158203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04773712158203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 151, 128]), torch.Size([1, 151, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.047881126403808594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.054073333740234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 151, 128])
m.shape torch.Size([128, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0544285774230957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0544285774230957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 128, 128]), torch.Size([1, 128, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0545506477355957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0606541633605957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 128, 128])
m.shape torch.Size([75, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06087923049926758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06087923049926758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 75, 128]), torch.Size([1, 75, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06095075607299805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06502771377563477  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 75, 128])
m.shape torch.Size([79, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06533098220825195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06533098220825195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06540632247924805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07022809982299805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([547, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0727987289428711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0727987289428711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 273, 128]), torch.Size([1, 273, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07305908203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09154415130615234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 273, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09154415130615234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09154415130615234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09180545806884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11022806167602539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 274, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10516357421875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10557746887207031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10599136352539062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10555648803710938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2777, 40])
input nodes number: 8513
output nodes number: 2777
edges number: 13002
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10563516616821289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1056356430053711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006906032562255859  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 21 input nodes size: 6870
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006616115570068359  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006616115570068359  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009891986846923828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009913444519042969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005833148956298828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005936145782470703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005936145782470703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005936145782470703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([565, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013621807098388672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013621807098388672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014160633087158203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018471240997314453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([435, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018616676330566406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018616676330566406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019031524658203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025254249572753906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([337, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025528907775878906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025528907775878906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025850296020507812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03292083740234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([255, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.033246517181396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.033246517181396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 255, 128]), torch.Size([1, 255, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03348970413208008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0405421257019043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 255, 128])
m.shape torch.Size([223, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040952205657958984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040952205657958984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 223, 128]), torch.Size([1, 223, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04116487503051758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04882097244262695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 223, 128])
m.shape torch.Size([158, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04916667938232422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04916667938232422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 158, 128]), torch.Size([1, 158, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.049317359924316406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05579662322998047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 158, 128])
m.shape torch.Size([123, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056131839752197266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056131839752197266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.056249141693115234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06211423873901367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([120, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06251335144042969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06251335144042969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 120, 128]), torch.Size([1, 120, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06262779235839844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06915092468261719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 120, 128])
m.shape torch.Size([84, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06945419311523438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06945419311523438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 84, 128]), torch.Size([1, 84, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0695343017578125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0746612548828125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 84, 128])
m.shape torch.Size([567, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07732486724853516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07732486724853516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07759475708007812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0967569351196289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 283, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0967569351196289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0967569351196289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09702777862548828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11612272262573242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 284, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11009502410888672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11052227020263672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11094951629638672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11050081253051758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2867, 40])
input nodes number: 6870
output nodes number: 2867
edges number: 13776
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11058712005615234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11058759689331055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006136417388916016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 22 input nodes size: 8743
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005846500396728516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.005846500396728516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.010015487670898438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.010036468505859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006739139556884766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006840229034423828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006840229034423828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006840229034423828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([504, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013709545135498047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013709545135498047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014190196990966797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018035411834716797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([428, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018203258514404297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018203258514404297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018611431121826172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024734020233154297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([339, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025014877319335938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025014877319335938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 339, 128]), torch.Size([1, 339, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025338172912597656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03245067596435547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 339, 128])
m.shape torch.Size([259, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03278303146362305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03278303146362305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 259, 128]), torch.Size([1, 259, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.033030033111572266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04019308090209961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 259, 128])
m.shape torch.Size([205, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0405583381652832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0405583381652832  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040753841400146484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04779195785522461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 205, 128])
m.shape torch.Size([161, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04815483093261719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04815483093261719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 161, 128]), torch.Size([1, 161, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.048308372497558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05491065979003906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 161, 128])
m.shape torch.Size([116, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0552210807800293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0552210807800293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05533170700073242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06086301803588867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([77, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061101436614990234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061101436614990234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 77, 128]), torch.Size([1, 77, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061174869537353516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06536054611206055  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 77, 128])
m.shape torch.Size([86, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06569290161132812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06569290161132812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 86, 128]), torch.Size([1, 86, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06577491760253906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07102394104003906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 86, 128])
m.shape torch.Size([585, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07377243041992188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07377243041992188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 292, 128]), torch.Size([1, 292, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0740509033203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09382247924804688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 292, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09382247924804688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09382247924804688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 293, 128]), torch.Size([1, 293, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0941019058227539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11380195617675781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 293, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10850286483764648  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10891437530517578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10932588577270508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10889339447021484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2760, 40])
input nodes number: 8743
output nodes number: 2760
edges number: 13456
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1089639663696289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10896444320678711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007022380828857422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 23 input nodes size: 9031
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0067234039306640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0067234039306640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011029720306396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.011051177978515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006861209869384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006980419158935547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006980419158935547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006980419158935547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([474, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015021324157714844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015021324157714844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015473365783691406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019089698791503906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([351, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01919841766357422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01919841766357422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019533157348632812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02455425262451172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([264, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024764537811279297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024764537811279297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025016307830810547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030555248260498047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([191, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03079366683959961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03079366683959961  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030975818634033203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03625822067260742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([201, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036646366119384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036646366119384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 201, 128]), torch.Size([1, 201, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03683805465698242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04373884201049805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 201, 128])
m.shape torch.Size([162, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.044106483459472656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.044106483459472656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 162, 128]), torch.Size([1, 162, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04426097869873047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050904273986816406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 162, 128])
m.shape torch.Size([109, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051190853118896484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051190853118896484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 109, 128]), torch.Size([1, 109, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051294803619384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05649232864379883  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 109, 128])
m.shape torch.Size([123, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05690956115722656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05690956115722656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05702686309814453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06371307373046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([85, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06401920318603516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06401920318603516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 85, 128]), torch.Size([1, 85, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06410026550292969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06928825378417969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 85, 128])
m.shape torch.Size([868, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07341670989990234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07341670989990234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07383060455322266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10321712493896484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 434, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10321712493896484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10321712493896484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10363101959228516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1328105926513672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 434, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1263103485107422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12673187255859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1271533966064453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1267104148864746  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2828, 40])
input nodes number: 9031
output nodes number: 2828
edges number: 15901
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12680959701538086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12681007385253906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00720977783203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 24 input nodes size: 12395
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006871223449707031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.006871223449707031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012781620025634766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.012802600860595703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00847482681274414  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008610248565673828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008610248565673828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008610248565673828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([322, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01764059066772461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01764059066772461  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017947673797607422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020404338836669922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([283, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020520687103271484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020520687103271484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020790576934814453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024838924407958984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 283, 128])
m.shape torch.Size([236, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025041580200195312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025041580200195312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025266647338867188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030218124389648438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([185, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030458450317382812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030458450317382812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 185, 128]), torch.Size([1, 185, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03063488006591797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0357513427734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 185, 128])
m.shape torch.Size([177, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03608512878417969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03608512878417969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 177, 128]), torch.Size([1, 177, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036253929138183594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04233074188232422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 177, 128])
m.shape torch.Size([124, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04260110855102539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04260110855102539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 124, 128]), torch.Size([1, 124, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.042719364166259766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04780435562133789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 124, 128])
m.shape torch.Size([114, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0481257438659668  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0481257438659668  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 114, 128]), torch.Size([1, 114, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04823446273803711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.053670406341552734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 114, 128])
m.shape torch.Size([99, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05399370193481445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05399370193481445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 99, 128]), torch.Size([1, 99, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05408811569213867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05946969985961914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 99, 128])
m.shape torch.Size([95, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0598301887512207  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0598301887512207  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 95, 128]), torch.Size([1, 95, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0599207878112793  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0657191276550293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 95, 128])
m.shape torch.Size([1169, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07124805450439453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07124805450439453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 584, 128]), torch.Size([1, 584, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07180500030517578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1135869026184082  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 584, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1135869026184082  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1135869026184082  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11414480209350586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1546311378479004  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 585, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14700031280517578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14741849899291992  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14783668518066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14739751815795898  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2804, 40])
input nodes number: 12395
output nodes number: 2804
edges number: 18100
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1475076675415039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1475081443786621  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008866310119628906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 25 input nodes size: 11431
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008471488952636719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008471488952636719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01392221450805664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013943195343017578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008011817932128906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008146286010742188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008146286010742188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008146286010742188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([341, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017121315002441406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017121315002441406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017446517944335938  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020048141479492188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([280, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020152568817138672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020152568817138672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 280, 128]), torch.Size([1, 280, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020419597625732422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024425029754638672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 280, 128])
m.shape torch.Size([237, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02463054656982422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02463054656982422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 237, 128]), torch.Size([1, 237, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0248565673828125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029829025268554688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 237, 128])
m.shape torch.Size([177, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03005361557006836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03005361557006836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 177, 128]), torch.Size([1, 177, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.030222415924072266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03511762619018555  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 177, 128])
m.shape torch.Size([177, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03545522689819336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03545522689819336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 177, 128]), torch.Size([1, 177, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035624027252197266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04170083999633789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 177, 128])
m.shape torch.Size([124, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04197120666503906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04197120666503906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 124, 128]), torch.Size([1, 124, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04208946228027344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04717445373535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 124, 128])
m.shape torch.Size([98, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04744243621826172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04744243621826172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04753589630126953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.052208900451660156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([82, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0524749755859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0524749755859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05255317687988281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.057010650634765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([74, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05728912353515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05728912353515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 74, 128]), torch.Size([1, 74, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05735969543457031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06187629699707031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 74, 128])
m.shape torch.Size([1201, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06756782531738281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06756782531738281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06814002990722656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10977363586425781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 600, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10977363586425781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10977363586425781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11034679412841797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15086936950683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 601, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14328813552856445  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14370441436767578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1441206932067871  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14368343353271484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2791, 40])
input nodes number: 11431
output nodes number: 2791
edges number: 17967
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14378786087036133  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14378833770751953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008395671844482422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 26 input nodes size: 10596
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008009910583496094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008009910583496094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013062477111816406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013083457946777344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007611751556396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007724285125732422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007724285125732422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007724285125732422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([464, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015320777893066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015320777893066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.015763282775878906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019303321838378906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([409, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019472122192382812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019472122192382812  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01986217498779297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025712966918945312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([289, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025931358337402344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025931358337402344  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02620697021484375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03227043151855469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([230, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03257131576538086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03257131576538086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0327906608581543  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.039151668548583984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 230, 128])
m.shape torch.Size([177, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03946399688720703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03946399688720703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 177, 128]), torch.Size([1, 177, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03963279724121094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04570960998535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 177, 128])
m.shape torch.Size([119, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04596567153930664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04596567153930664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 119, 128]), torch.Size([1, 119, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046079158782958984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.050959110260009766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 119, 128])
m.shape torch.Size([108, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051262855529785156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051262855529785156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 108, 128]), torch.Size([1, 108, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05136585235595703  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05651569366455078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 108, 128])
m.shape torch.Size([103, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05685710906982422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05685710906982422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 103, 128]), torch.Size([1, 103, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05695533752441406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06255435943603516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 103, 128])
m.shape torch.Size([69, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06280136108398438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06280136108398438  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0628671646118164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0670785903930664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([813, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0709223747253418  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0709223747253418  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07130956649780273  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0988001823425293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 406, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0988001823425293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0988001823425293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.09918832778930664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12655305862426758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 407, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12072277069091797  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12113761901855469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1215524673461914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12111663818359375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2781, 40])
input nodes number: 10596
output nodes number: 2781
edges number: 14999
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1212153434753418  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1212158203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007946014404296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 27 input nodes size: 11443
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007610321044921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.007610321044921875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013066768646240234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.013087749481201172  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008014202117919922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008159160614013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008159160614013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008159160614013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([289, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017772197723388672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.017772197723388672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018047809600830078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020252704620361328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([262, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020364761352539062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020364761352539062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0206146240234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024362564086914062  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 262, 128])
m.shape torch.Size([191, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024510860443115234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024510860443115234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024693012237548828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02870035171508789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([130, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02885723114013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02885723114013672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 130, 128]), torch.Size([1, 130, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02898120880126953  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032576560974121094  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 130, 128])
m.shape torch.Size([117, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032793521881103516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032793521881103516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 117, 128]), torch.Size([1, 117, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03290510177612305  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03692197799682617  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 117, 128])
m.shape torch.Size([98, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037146568298339844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037146568298339844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 98, 128]), torch.Size([1, 98, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.037240028381347656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041258811950683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 98, 128])
m.shape torch.Size([91, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04151582717895508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04151582717895508  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04160261154174805  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045941829681396484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([61, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046131134033203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046131134033203125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 61, 128]), torch.Size([1, 61, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.046189308166503906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04950523376464844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 61, 128])
m.shape torch.Size([80, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0498194694519043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0498194694519043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0498957633972168  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0547785758972168  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([1441, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06161165237426758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06161165237426758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 720, 128]), torch.Size([1, 720, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06229829788208008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11248064041137695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 720, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11248064041137695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11248064041137695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11316823959350586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16221094131469727  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 721, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15390539169311523  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15431690216064453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15472841262817383  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1542959213256836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2760, 40])
input nodes number: 11443
output nodes number: 2760
edges number: 19334
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15439891815185547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15439939498901367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008417606353759766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 28 input nodes size: 12976
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0080108642578125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0080108642578125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01419830322265625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014219284057617188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00874185562133789  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008890628814697266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008890628814697266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008890628814697266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([274, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018749713897705078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018749713897705078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01901102066040039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02110147476196289  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 274, 128])
m.shape torch.Size([229, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021189212799072266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021189212799072266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 229, 128]), torch.Size([1, 229, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021407604217529297  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024683475494384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 229, 128])
m.shape torch.Size([176, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0248260498046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0248260498046875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024993896484375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0286865234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([134, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028858184814453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028858184814453125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 134, 128]), torch.Size([1, 134, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.028985977172851562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03269195556640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 134, 128])
m.shape torch.Size([105, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03287839889526367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03287839889526367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03297853469848633  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03658342361450195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([105, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036833763122558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.036833763122558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03693389892578125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04123973846435547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([84, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04147005081176758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04147005081176758  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 84, 128]), torch.Size([1, 84, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0415501594543457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04555559158325195  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 84, 128])
m.shape torch.Size([59, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045740604400634766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045740604400634766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 59, 128]), torch.Size([1, 59, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045796871185302734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04900407791137695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 59, 128])
m.shape torch.Size([73, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04928922653198242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04928922653198242  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04935884475708008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05381441116333008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([1519, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06102275848388672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06102275848388672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 759, 128]), torch.Size([1, 759, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06174659729003906  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11455726623535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 759, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11455726623535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11455726623535156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 760, 128]), torch.Size([1, 760, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11528205871582031  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16776704788208008  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 760, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15919256210327148  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15960359573364258  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16001462936401367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15958261489868164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2758, 40])
input nodes number: 12976
output nodes number: 2758
edges number: 19858
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1596999168395996  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1597003936767578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009167194366455078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 29 input nodes size: 11725
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008741378784179688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008741378784179688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014332294464111328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014353752136230469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008145332336425781  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008270263671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008270263671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008270263671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([414, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01668262481689453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01668262481689453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01707744598388672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02023601531982422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([351, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02037334442138672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02037334442138672  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020708084106445312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02572917938232422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([246, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025913715362548828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025913715362548828  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 246, 128]), torch.Size([1, 246, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.026148319244384766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03130960464477539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 246, 128])
m.shape torch.Size([196, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03156614303588867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03156614303588867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 196, 128]), torch.Size([1, 196, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0317530632019043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03717374801635742  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 196, 128])
m.shape torch.Size([176, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03749990463256836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03749990463256836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 176, 128]), torch.Size([1, 176, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03766775131225586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04371023178100586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 176, 128])
m.shape torch.Size([131, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.044001102447509766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.044001102447509766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 131, 128]), torch.Size([1, 131, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.044126033782958984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04949808120727539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 131, 128])
m.shape torch.Size([106, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0497894287109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0497894287109375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04989051818847656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05494499206542969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 106, 128])
m.shape torch.Size([104, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.055291175842285156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.055291175842285156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.055390357971191406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.061043739318847656  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 104, 128])
m.shape torch.Size([80, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06133747100830078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06133747100830078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06141376495361328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06629657745361328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([1013, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07108879089355469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07108879089355469  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.07157135009765625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10583305358886719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 506, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10583305358886719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10583305358886719  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.10631656646728516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.14040470123291016  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 507, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13348388671875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.13390398025512695  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1343240737915039  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1338825225830078  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2817, 40])
input nodes number: 11725
output nodes number: 2817
edges number: 16728
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1340007781982422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1340012550354004  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008524417877197266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 30 input nodes size: 11500
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00815439224243164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00815439224243164  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.01434183120727539  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014362812042236328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008750438690185547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00888967514038086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00888967514038086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00888967514038086  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([296, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018186092376708984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018186092376708984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 296, 128]), torch.Size([1, 296, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.018468379974365234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020726680755615234  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 296, 128])
m.shape torch.Size([260, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020833492279052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.020833492279052734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02108144760131836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024800777435302734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([209, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02497577667236328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02497577667236328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 209, 128]), torch.Size([1, 209, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.025175094604492188  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029560089111328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 209, 128])
m.shape torch.Size([167, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02977895736694336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02977895736694336  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.029938220977783203  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03455686569213867  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 167, 128])
m.shape torch.Size([158, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03485393524169922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03485393524169922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 158, 128]), torch.Size([1, 158, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.035004615783691406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040429115295410156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 158, 128])
m.shape torch.Size([110, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040668487548828125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.040668487548828125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 110, 128]), torch.Size([1, 110, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04077339172363281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045284271240234375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 110, 128])
m.shape torch.Size([82, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045505523681640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045505523681640625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 82, 128]), torch.Size([1, 82, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04558372497558594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04949378967285156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 82, 128])
m.shape torch.Size([76, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.049744606018066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.049744606018066406  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 76, 128]), torch.Size([1, 76, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04981708526611328  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.053948402404785156  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 76, 128])
m.shape torch.Size([70, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05421257019042969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05421257019042969  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 70, 128]), torch.Size([1, 70, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.054279327392578125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.058551788330078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 70, 128])
m.shape torch.Size([1330, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06486034393310547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06486034393310547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06549453735351562  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1121678352355957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 665, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1121678352355957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1121678352355957  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.11280202865600586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1585235595703125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 665, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1505579948425293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1509690284729004  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15138006210327148  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.15094804763793945  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2758, 40])
input nodes number: 11500
output nodes number: 2758
edges number: 18673
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1510457992553711  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1510462760925293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.009137153625488281  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

pseudo mini batch 31 input nodes size: 12258
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008741378784179688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008741378784179688  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014586448669433594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.014607906341552734  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008399486541748047  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008557796478271484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008557796478271484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.008557796478271484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

m.shape torch.Size([262, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019065380096435547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019065380096435547  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 262, 128]), torch.Size([1, 262, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.019315242767333984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021314144134521484  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 262, 128])
m.shape torch.Size([201, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021380901336669922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021380901336669922  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 201, 128]), torch.Size([1, 201, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.021572589874267578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024447917938232422  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 201, 128])
m.shape torch.Size([191, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024625301361083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024625301361083984  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 191, 128]), torch.Size([1, 191, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.024807453155517578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02881479263305664  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 191, 128])
m.shape torch.Size([123, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02895832061767578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02895832061767578  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 123, 128]), torch.Size([1, 123, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.02907562255859375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.032477378845214844  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 123, 128])
m.shape torch.Size([116, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03269529342651367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03269529342651367  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 116, 128]), torch.Size([1, 116, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0328059196472168  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0367884635925293  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 116, 128])
m.shape torch.Size([105, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0370335578918457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0370335578918457  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.03713369369506836  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04143953323364258  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([88, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041683197021484375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041683197021484375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 88, 128]), torch.Size([1, 88, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.041767120361328125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.045963287353515625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 88, 128])
m.shape torch.Size([80, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04622650146484375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04622650146484375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 80, 128]), torch.Size([1, 80, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.04630279541015625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.05065155029296875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 80, 128])
m.shape torch.Size([93, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051012516021728516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.051012516021728516  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 93, 128]), torch.Size([1, 93, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0511012077331543  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.0567774772644043  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst.shape  torch.Size([1, 93, 128])
m.shape torch.Size([1617, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06444358825683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06444358825683594  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.06521415710449219  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1201171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 0 shape torch.Size([1, 808, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1201171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.1201171875  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.12088871002197266  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17528152465820312  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

rst 1 shape torch.Size([1, 809, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16609668731689453  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16652536392211914  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16695404052734375  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16650390625  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

torch.Size([2876, 40])
input nodes number: 12258
output nodes number: 2876
edges number: 21202
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16663455963134766  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.16663503646850586  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00885772705078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00885772705078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.00885772705078125  GigaBytes
Max Memory Allocated: 0.1855792999267578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004842355847358704 |0.0003653615713119507 |0.0363449826836586 |8.644163608551025e-05 |0.01933234930038452 |0.0017201900482177734 |
----------------------------------------------------------pseudo_mini_loss sum 3.1691365242004395
Total (block generation + training)time/epoch 11.731796503067017
* Pure training time/epoch 1.952807903289795
Training time/epoch 2.0796825885772705
Training time without block to device /epoch 2.067991018295288
Training time without total dataloading part /epoch 1.786160945892334
load block tensor time/epoch 0.15495538711547852
block to device time/epoch 0.011691570281982422
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  251841
Number of first layer input nodes during this epoch:  251841
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
