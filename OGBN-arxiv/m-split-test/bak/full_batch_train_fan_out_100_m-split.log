main start at this time 1653462217.5447743
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

<class 'int'>
----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

in degree  tensor([ 1,  5,  6,  ...,  2, 10,  2])
tensor([13428., 11706.,  9277.,  7320.,  6222.,  4868.,  4045.,  3472.,  2976.,
         2599.,  2203.,  1937.,  1656.,  1434.,  1289.,  1111.,  1030.,   948.,
          836.,   807.,   717.,   556.,   519.,   525.,   483.,   409.,   390.,
          370.,   329.,   261.,   300.,   273.,   261.,   231.,   200.,   226.,
          196.,   186.,   200.,   161.,   167.,   165.,   138.,   135.,   142.,
          106.,   105.,   112.,    91.,    89.,   104.,    81.,    79.,    78.,
           90.,    71.,    68.,    73.,    55.,    63.,    69.,    62.,    52.,
           49.,    54.,    51.,    68.,    42.,    47.,    44.,    43.,    63.,
           32.,    36.,    35.,    31.,    40.,    22.,    27.,    31.,    35.,
           35.,    29.,    33.,    27.,    39.,    38.,    25.,    24.,    23.,
           27.,    24.,    22.,    29.,    27.,    20.,    21.,    29.,    26.,
         1541.])
Counter({1: 13428, 2: 11706, 3: 9277, 4: 7320, 5: 6222, 6: 4868, 7: 4045, 8: 3472, 9: 2976, 10: 2599, 11: 2203, 12: 1937, 13: 1656, 100: 1541, 14: 1434, 15: 1289, 16: 1111, 17: 1030, 18: 948, 19: 836, 20: 807, 21: 717, 22: 556, 24: 525, 23: 519, 25: 483, 26: 409, 27: 390, 28: 370, 29: 329, 31: 300, 32: 273, 30: 261, 33: 261, 34: 231, 36: 226, 35: 200, 39: 200, 37: 196, 38: 186, 41: 167, 42: 165, 40: 161, 45: 142, 43: 138, 44: 135, 48: 112, 46: 106, 47: 105, 51: 104, 49: 91, 55: 90, 50: 89, 52: 81, 53: 79, 54: 78, 58: 73, 56: 71, 61: 69, 67: 68, 57: 68, 72: 63, 60: 63, 62: 62, 59: 55, 65: 54, 63: 52, 66: 51, 64: 49, 69: 47, 70: 44, 71: 43, 68: 42, 77: 40, 86: 39, 87: 38, 74: 36, 75: 35, 82: 35, 81: 35, 84: 33, 73: 32, 80: 31, 76: 31, 94: 29, 98: 29, 83: 29, 95: 27, 79: 27, 85: 27, 91: 27, 99: 26, 88: 25, 92: 24, 89: 24, 90: 23, 93: 22, 78: 22, 97: 21, 96: 20})

----------===============-------------===============-------------the number of batches *****---- 1

fan out in degree nodes number :  1541
drop half of them in-edges, instead of output nodes, as the 
 the number of edges now:  1008807

after drop half nodes in edges, the left in degree  tensor([ 1,  5,  6,  ...,  2, 10,  2])
Counter({1: 13428, 2: 11706, 3: 9277, 4: 7320, 5: 6222, 6: 4868, 7: 4045, 8: 3472, 9: 2976, 10: 2599, 11: 2203, 12: 1937, 13: 1656, 14: 1434, 15: 1289, 16: 1111, 17: 1030, 18: 948, 19: 836, 20: 807, 100: 771, 0: 770, 21: 717, 22: 556, 24: 525, 23: 519, 25: 483, 26: 409, 27: 390, 28: 370, 29: 329, 31: 300, 32: 273, 30: 261, 33: 261, 34: 231, 36: 226, 35: 200, 39: 200, 37: 196, 38: 186, 41: 167, 42: 165, 40: 161, 45: 142, 43: 138, 44: 135, 48: 112, 46: 106, 47: 105, 51: 104, 49: 91, 55: 90, 50: 89, 52: 81, 53: 79, 54: 78, 58: 73, 56: 71, 61: 69, 67: 68, 57: 68, 72: 63, 60: 63, 62: 62, 59: 55, 65: 54, 63: 52, 66: 51, 64: 49, 69: 47, 70: 44, 71: 43, 68: 42, 77: 40, 86: 39, 87: 38, 74: 36, 75: 35, 82: 35, 81: 35, 84: 33, 73: 32, 80: 31, 76: 31, 94: 29, 98: 29, 83: 29, 95: 27, 79: 27, 85: 27, 91: 27, 99: 26, 88: 25, 92: 24, 89: 24, 90: 23, 93: 22, 78: 22, 97: 21, 96: 20})
after remove half edges the number of edges now:  931807

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0946359634399414
pseudo mini batch 0 input nodes size: 160279
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.07695722579956055  GigaBytes
Max Memory Allocated: 0.07695722579956055  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.07763481140136719  GigaBytes
Max Memory Allocated: 0.07763481140136719  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.07763481140136719  GigaBytes
Max Memory Allocated: 0.07763481140136719  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09185934066772461  GigaBytes
Max Memory Allocated: 0.09185934066772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09185934066772461  GigaBytes
Max Memory Allocated: 0.09185934066772461  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09185934066772461  GigaBytes
Max Memory Allocated: 0.09185934066772461  GigaBytes

m.shape torch.Size([13428, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5457158088684082  GigaBytes
Max Memory Allocated: 0.5458660125732422  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5457158088684082  GigaBytes
Max Memory Allocated: 0.5458660125732422  GigaBytes

 h.shape torch.Size([1, 13428, 128]), torch.Size([1, 13428, 128])
----------------------------------------3
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5588440895080566  GigaBytes
Max Memory Allocated: 0.5588440895080566  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.6612915992736816  GigaBytes
Max Memory Allocated: 0.6680169105529785  GigaBytes

rst.shape  torch.Size([1, 13428, 128])
m.shape torch.Size([11706, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.6666073799133301  GigaBytes
Max Memory Allocated: 0.6680169105529785  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.6666073799133301  GigaBytes
Max Memory Allocated: 0.6680169105529785  GigaBytes

 h.shape torch.Size([1, 11706, 128]), torch.Size([1, 11706, 128])
----------------------------------------3
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.6786561012268066  GigaBytes
Max Memory Allocated: 0.6786561012268066  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.8461117744445801  GigaBytes
Max Memory Allocated: 0.8578305244445801  GigaBytes

rst.shape  torch.Size([1, 11706, 128])
m.shape torch.Size([9277, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.8544793128967285  GigaBytes
Max Memory Allocated: 0.8578305244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.8544793128967285  GigaBytes
Max Memory Allocated: 0.8578305244445801  GigaBytes

 h.shape torch.Size([1, 9277, 128]), torch.Size([1, 9277, 128])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.8633265495300293  GigaBytes
Max Memory Allocated: 0.8633265495300293  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 1.0579657554626465  GigaBytes
Max Memory Allocated: 1.0712366104125977  GigaBytes

rst.shape  torch.Size([1, 9277, 128])
m.shape torch.Size([7320, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 1.0675039291381836  GigaBytes
Max Memory Allocated: 1.0712366104125977  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 1.0675039291381836  GigaBytes
Max Memory Allocated: 1.0712366104125977  GigaBytes

 h.shape torch.Size([1, 7320, 128]), torch.Size([1, 7320, 128])
----------------------------------------3
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 1.075871467590332  GigaBytes
Max Memory Allocated: 1.075871467590332  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.2785301208496094  GigaBytes
Max Memory Allocated: 1.2924919128417969  GigaBytes

rst.shape  torch.Size([1, 7320, 128])
m.shape torch.Size([6222, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.2906646728515625  GigaBytes
Max Memory Allocated: 1.2924919128417969  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.2906646728515625  GigaBytes
Max Memory Allocated: 1.2924919128417969  GigaBytes

 h.shape torch.Size([1, 6222, 128]), torch.Size([1, 6222, 128])
----------------------------------------3
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.2965984344482422  GigaBytes
Max Memory Allocated: 1.2965984344482422  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8045654296875 GB
    Memory Allocated: 1.510213851928711  GigaBytes
Max Memory Allocated: 1.525838851928711  GigaBytes

rst.shape  torch.Size([1, 6222, 128])
m.shape torch.Size([4868, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8045654296875 GB
    Memory Allocated: 1.521174430847168  GigaBytes
Max Memory Allocated: 1.525838851928711  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8045654296875 GB
    Memory Allocated: 1.521174430847168  GigaBytes
Max Memory Allocated: 1.525838851928711  GigaBytes

 h.shape torch.Size([1, 4868, 128]), torch.Size([1, 4868, 128])
----------------------------------------3
 Nvidia-smi: 2.8045654296875 GB
    Memory Allocated: 1.5266485214233398  GigaBytes
Max Memory Allocated: 1.5266485214233398  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0350341796875 GB
    Memory Allocated: 1.737234115600586  GigaBytes
Max Memory Allocated: 1.7511615753173828  GigaBytes

rst.shape  torch.Size([1, 4868, 128])
m.shape torch.Size([4045, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0350341796875 GB
    Memory Allocated: 1.7484145164489746  GigaBytes
Max Memory Allocated: 1.7511615753173828  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0350341796875 GB
    Memory Allocated: 1.7484145164489746  GigaBytes
Max Memory Allocated: 1.7511615753173828  GigaBytes

 h.shape torch.Size([1, 4045, 128]), torch.Size([1, 4045, 128])
----------------------------------------3
 Nvidia-smi: 3.0350341796875 GB
    Memory Allocated: 1.752814769744873  GigaBytes
Max Memory Allocated: 1.752814769744873  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.9478354454040527  GigaBytes
Max Memory Allocated: 1.9615073204040527  GigaBytes

rst.shape  torch.Size([1, 4045, 128])
m.shape torch.Size([3472, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.959578514099121  GigaBytes
Max Memory Allocated: 1.9615073204040527  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.959578514099121  GigaBytes
Max Memory Allocated: 1.9615073204040527  GigaBytes

 h.shape torch.Size([1, 3472, 128]), torch.Size([1, 3472, 128])
----------------------------------------3
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.962904930114746  GigaBytes
Max Memory Allocated: 1.962904930114746  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4920654296875 GB
    Memory Allocated: 2.152320384979248  GigaBytes
Max Memory Allocated: 2.165992259979248  GigaBytes

rst.shape  torch.Size([1, 3472, 128])
m.shape torch.Size([2976, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4920654296875 GB
    Memory Allocated: 2.1634974479675293  GigaBytes
Max Memory Allocated: 2.165992259979248  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4920654296875 GB
    Memory Allocated: 2.1634974479675293  GigaBytes
Max Memory Allocated: 2.165992259979248  GigaBytes

 h.shape torch.Size([1, 2976, 128]), torch.Size([1, 2976, 128])
----------------------------------------3
 Nvidia-smi: 3.4920654296875 GB
    Memory Allocated: 2.1670336723327637  GigaBytes
Max Memory Allocated: 2.1670336723327637  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6033935546875 GB
    Memory Allocated: 2.3635425567626953  GigaBytes
Max Memory Allocated: 2.3772144317626953  GigaBytes

rst.shape  torch.Size([1, 2976, 128])
m.shape torch.Size([2599, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.6033935546875 GB
    Memory Allocated: 2.374098777770996  GigaBytes
Max Memory Allocated: 2.3772144317626953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6033935546875 GB
    Memory Allocated: 2.374098777770996  GigaBytes
Max Memory Allocated: 2.3772144317626953  GigaBytes

 h.shape torch.Size([1, 2599, 128]), torch.Size([1, 2599, 128])
----------------------------------------3
 Nvidia-smi: 3.6033935546875 GB
    Memory Allocated: 2.3767647743225098  GigaBytes
Max Memory Allocated: 2.3772144317626953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.5576257705688477  GigaBytes
Max Memory Allocated: 2.570018768310547  GigaBytes

rst.shape  torch.Size([1, 2599, 128])
m.shape torch.Size([2203, 11, 128])
----------------------------------------1
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.566999912261963  GigaBytes
Max Memory Allocated: 2.570018768310547  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.566999912261963  GigaBytes
Max Memory Allocated: 2.570018768310547  GigaBytes

 h.shape torch.Size([1, 2203, 128]), torch.Size([1, 2203, 128])
----------------------------------------3
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.56919002532959  GigaBytes
Max Memory Allocated: 2.570018768310547  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9471435546875 GB
    Memory Allocated: 2.7416577339172363  GigaBytes
Max Memory Allocated: 2.7533764839172363  GigaBytes

rst.shape  torch.Size([1, 2203, 128])
m.shape torch.Size([1937, 12, 128])
----------------------------------------1
 Nvidia-smi: 3.9471435546875 GB
    Memory Allocated: 2.7517032623291016  GigaBytes
Max Memory Allocated: 2.7533764839172363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9471435546875 GB
    Memory Allocated: 2.7517032623291016  GigaBytes
Max Memory Allocated: 2.7533764839172363  GigaBytes

 h.shape torch.Size([1, 1937, 128]), torch.Size([1, 1937, 128])
----------------------------------------3
 Nvidia-smi: 3.9490966796875 GB
    Memory Allocated: 2.7535505294799805  GigaBytes
Max Memory Allocated: 2.7535505294799805  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1229248046875 GB
    Memory Allocated: 2.9105682373046875  GigaBytes
Max Memory Allocated: 2.9222869873046875  GigaBytes

rst.shape  torch.Size([1, 1937, 128])
m.shape torch.Size([1656, 13, 128])
----------------------------------------1
 Nvidia-smi: 4.1229248046875 GB
    Memory Allocated: 2.919909954071045  GigaBytes
Max Memory Allocated: 2.9222869873046875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1229248046875 GB
    Memory Allocated: 2.919909954071045  GigaBytes
Max Memory Allocated: 2.9222869873046875  GigaBytes

 h.shape torch.Size([1, 1656, 128]), torch.Size([1, 1656, 128])
----------------------------------------3
 Nvidia-smi: 4.1229248046875 GB
    Memory Allocated: 2.9214892387390137  GigaBytes
Max Memory Allocated: 2.9222869873046875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 3.0702624320983887  GigaBytes
Max Memory Allocated: 3.0805277824401855  GigaBytes

rst.shape  torch.Size([1, 1656, 128])
m.shape torch.Size([1434, 14, 128])
----------------------------------------1
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 3.0790457725524902  GigaBytes
Max Memory Allocated: 3.0805277824401855  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 3.0790457725524902  GigaBytes
Max Memory Allocated: 3.0805277824401855  GigaBytes

 h.shape torch.Size([1, 1434, 128]), torch.Size([1, 1434, 128])
----------------------------------------3
 Nvidia-smi: 4.2889404296875 GB
    Memory Allocated: 3.080413341522217  GigaBytes
Max Memory Allocated: 3.0805277824401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4549560546875 GB
    Memory Allocated: 3.218635082244873  GigaBytes
Max Memory Allocated: 3.228208065032959  GigaBytes

rst.shape  torch.Size([1, 1434, 128])
m.shape torch.Size([1289, 15, 128])
----------------------------------------1
 Nvidia-smi: 4.4549560546875 GB
    Memory Allocated: 3.227170944213867  GigaBytes
Max Memory Allocated: 3.228208065032959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4549560546875 GB
    Memory Allocated: 3.227170944213867  GigaBytes
Max Memory Allocated: 3.228208065032959  GigaBytes

 h.shape torch.Size([1, 1289, 128]), torch.Size([1, 1289, 128])
----------------------------------------3
 Nvidia-smi: 4.4549560546875 GB
    Memory Allocated: 3.228400230407715  GigaBytes
Max Memory Allocated: 3.228400230407715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5916748046875 GB
    Memory Allocated: 3.3600730895996094  GigaBytes
Max Memory Allocated: 3.369770050048828  GigaBytes

rst.shape  torch.Size([1, 1289, 128])
m.shape torch.Size([1111, 16, 128])
----------------------------------------1
 Nvidia-smi: 4.5916748046875 GB
    Memory Allocated: 3.3679347038269043  GigaBytes
Max Memory Allocated: 3.369770050048828  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5916748046875 GB
    Memory Allocated: 3.3679347038269043  GigaBytes
Max Memory Allocated: 3.369770050048828  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 4.5916748046875 GB
    Memory Allocated: 3.3689942359924316  GigaBytes
Max Memory Allocated: 3.369770050048828  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7225341796875 GB
    Memory Allocated: 3.4915709495544434  GigaBytes
Max Memory Allocated: 3.500047206878662  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([1030, 17, 128])
----------------------------------------1
 Nvidia-smi: 4.7225341796875 GB
    Memory Allocated: 3.4993906021118164  GigaBytes
Max Memory Allocated: 3.500047206878662  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7225341796875 GB
    Memory Allocated: 3.4993906021118164  GigaBytes
Max Memory Allocated: 3.500047206878662  GigaBytes

 h.shape torch.Size([1, 1030, 128]), torch.Size([1, 1030, 128])
----------------------------------------3
 Nvidia-smi: 4.7244873046875 GB
    Memory Allocated: 3.500372886657715  GigaBytes
Max Memory Allocated: 3.500372886657715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8651123046875 GB
    Memory Allocated: 3.619015693664551  GigaBytes
Max Memory Allocated: 3.6273651123046875  GigaBytes

rst.shape  torch.Size([1, 1030, 128])
m.shape torch.Size([948, 18, 128])
----------------------------------------1
 Nvidia-smi: 4.8651123046875 GB
    Memory Allocated: 3.6266613006591797  GigaBytes
Max Memory Allocated: 3.6273651123046875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8651123046875 GB
    Memory Allocated: 3.6266613006591797  GigaBytes
Max Memory Allocated: 3.6273651123046875  GigaBytes

 h.shape torch.Size([1, 948, 128]), torch.Size([1, 948, 128])
----------------------------------------3
 Nvidia-smi: 4.8651123046875 GB
    Memory Allocated: 3.627565383911133  GigaBytes
Max Memory Allocated: 3.627565383911133  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9744873046875 GB
    Memory Allocated: 3.743295669555664  GigaBytes
Max Memory Allocated: 3.751432418823242  GigaBytes

rst.shape  torch.Size([1, 948, 128])
m.shape torch.Size([836, 19, 128])
----------------------------------------1
 Nvidia-smi: 4.9744873046875 GB
    Memory Allocated: 3.750417709350586  GigaBytes
Max Memory Allocated: 3.751432418823242  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9744873046875 GB
    Memory Allocated: 3.750417709350586  GigaBytes
Max Memory Allocated: 3.751432418823242  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 4.9764404296875 GB
    Memory Allocated: 3.7512149810791016  GigaBytes
Max Memory Allocated: 3.751432418823242  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0936279296875 GB
    Memory Allocated: 3.8600831031799316  GigaBytes
Max Memory Allocated: 3.86765718460083  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([807, 20, 128])
----------------------------------------1
 Nvidia-smi: 5.0936279296875 GB
    Memory Allocated: 3.8673806190490723  GigaBytes
Max Memory Allocated: 3.86765718460083  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0936279296875 GB
    Memory Allocated: 3.8673806190490723  GigaBytes
Max Memory Allocated: 3.86765718460083  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 5.0936279296875 GB
    Memory Allocated: 3.868150234222412  GigaBytes
Max Memory Allocated: 3.868150234222412  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 3.9776158332824707  GigaBytes
Max Memory Allocated: 3.985311985015869  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([717, 21, 128])
----------------------------------------1
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 3.9844107627868652  GigaBytes
Max Memory Allocated: 3.985311985015869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 3.9844107627868652  GigaBytes
Max Memory Allocated: 3.985311985015869  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 3.9850945472717285  GigaBytes
Max Memory Allocated: 3.985311985015869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3104248046875 GB
    Memory Allocated: 4.088459014892578  GigaBytes
Max Memory Allocated: 4.095638751983643  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([556, 22, 128])
----------------------------------------1
 Nvidia-smi: 5.3104248046875 GB
    Memory Allocated: 4.093949794769287  GigaBytes
Max Memory Allocated: 4.095638751983643  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3104248046875 GB
    Memory Allocated: 4.093949794769287  GigaBytes
Max Memory Allocated: 4.095638751983643  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 5.3104248046875 GB
    Memory Allocated: 4.094480037689209  GigaBytes
Max Memory Allocated: 4.095638751983643  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4022216796875 GB
    Memory Allocated: 4.178677082061768  GigaBytes
Max Memory Allocated: 4.184509754180908  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([519, 23, 128])
----------------------------------------1
 Nvidia-smi: 5.4022216796875 GB
    Memory Allocated: 4.184156894683838  GigaBytes
Max Memory Allocated: 4.184509754180908  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4022216796875 GB
    Memory Allocated: 4.184156894683838  GigaBytes
Max Memory Allocated: 4.184509754180908  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 5.4022216796875 GB
    Memory Allocated: 4.184651851654053  GigaBytes
Max Memory Allocated: 4.184651851654053  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4744873046875 GB
    Memory Allocated: 4.267417907714844  GigaBytes
Max Memory Allocated: 4.2731099128723145  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([525, 24, 128])
----------------------------------------1
 Nvidia-smi: 5.4744873046875 GB
    Memory Allocated: 4.273178577423096  GigaBytes
Max Memory Allocated: 4.273319721221924  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4744873046875 GB
    Memory Allocated: 4.273178577423096  GigaBytes
Max Memory Allocated: 4.273319721221924  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 5.4744873046875 GB
    Memory Allocated: 4.273679256439209  GigaBytes
Max Memory Allocated: 4.273679256439209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5662841796875 GB
    Memory Allocated: 4.360373020172119  GigaBytes
Max Memory Allocated: 4.3663811683654785  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([483, 25, 128])
----------------------------------------1
 Nvidia-smi: 5.5662841796875 GB
    Memory Allocated: 4.365880489349365  GigaBytes
Max Memory Allocated: 4.3663811683654785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5662841796875 GB
    Memory Allocated: 4.365880489349365  GigaBytes
Max Memory Allocated: 4.3663811683654785  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 5.5662841796875 GB
    Memory Allocated: 4.3663411140441895  GigaBytes
Max Memory Allocated: 4.3663811683654785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6502685546875 GB
    Memory Allocated: 4.447411060333252  GigaBytes
Max Memory Allocated: 4.453168869018555  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([409, 26, 128])
----------------------------------------1
 Nvidia-smi: 5.6502685546875 GB
    Memory Allocated: 4.452251434326172  GigaBytes
Max Memory Allocated: 4.453168869018555  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6502685546875 GB
    Memory Allocated: 4.452251434326172  GigaBytes
Max Memory Allocated: 4.453168869018555  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 5.6502685546875 GB
    Memory Allocated: 4.452641487121582  GigaBytes
Max Memory Allocated: 4.453168869018555  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7459716796875 GB
    Memory Allocated: 4.524021148681641  GigaBytes
Max Memory Allocated: 4.529091835021973  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([390, 27, 128])
----------------------------------------1
 Nvidia-smi: 5.7459716796875 GB
    Memory Allocated: 4.5288472175598145  GigaBytes
Max Memory Allocated: 4.529091835021973  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7459716796875 GB
    Memory Allocated: 4.5288472175598145  GigaBytes
Max Memory Allocated: 4.529091835021973  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 5.7459716796875 GB
    Memory Allocated: 4.529219150543213  GigaBytes
Max Memory Allocated: 4.529219150543213  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8260498046875 GB
    Memory Allocated: 4.599886417388916  GigaBytes
Max Memory Allocated: 4.604907512664795  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([370, 28, 128])
----------------------------------------1
 Nvidia-smi: 5.8260498046875 GB
    Memory Allocated: 4.604640483856201  GigaBytes
Max Memory Allocated: 4.604907512664795  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8260498046875 GB
    Memory Allocated: 4.604640483856201  GigaBytes
Max Memory Allocated: 4.604907512664795  GigaBytes

 h.shape torch.Size([1, 370, 128]), torch.Size([1, 370, 128])
----------------------------------------3
 Nvidia-smi: 5.8260498046875 GB
    Memory Allocated: 4.6049933433532715  GigaBytes
Max Memory Allocated: 4.6049933433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9080810546875 GB
    Memory Allocated: 4.674506664276123  GigaBytes
Max Memory Allocated: 4.679446697235107  GigaBytes

rst.shape  torch.Size([1, 370, 128])
m.shape torch.Size([329, 29, 128])
----------------------------------------1
 Nvidia-smi: 5.9080810546875 GB
    Memory Allocated: 4.678879737854004  GigaBytes
Max Memory Allocated: 4.679446697235107  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9080810546875 GB
    Memory Allocated: 4.678879737854004  GigaBytes
Max Memory Allocated: 4.679446697235107  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 5.9080810546875 GB
    Memory Allocated: 4.679193496704102  GigaBytes
Max Memory Allocated: 4.679446697235107  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9647216796875 GB
    Memory Allocated: 4.743200302124023  GigaBytes
Max Memory Allocated: 4.748220920562744  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([261, 30, 128])
----------------------------------------1
 Nvidia-smi: 5.9647216796875 GB
    Memory Allocated: 4.746777057647705  GigaBytes
Max Memory Allocated: 4.748220920562744  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9647216796875 GB
    Memory Allocated: 4.746777057647705  GigaBytes
Max Memory Allocated: 4.748220920562744  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 5.9647216796875 GB
    Memory Allocated: 4.747025966644287  GigaBytes
Max Memory Allocated: 4.748220920562744  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0291748046875 GB
    Memory Allocated: 4.799545764923096  GigaBytes
Max Memory Allocated: 4.803279399871826  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([300, 31, 128])
----------------------------------------1
 Nvidia-smi: 6.0291748046875 GB
    Memory Allocated: 4.803855895996094  GigaBytes
Max Memory Allocated: 4.80396032333374  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0291748046875 GB
    Memory Allocated: 4.803855895996094  GigaBytes
Max Memory Allocated: 4.80396032333374  GigaBytes

 h.shape torch.Size([1, 300, 128]), torch.Size([1, 300, 128])
----------------------------------------3
 Nvidia-smi: 6.0291748046875 GB
    Memory Allocated: 4.804141998291016  GigaBytes
Max Memory Allocated: 4.804141998291016  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0916748046875 GB
    Memory Allocated: 4.866512298583984  GigaBytes
Max Memory Allocated: 4.870946884155273  GigaBytes

rst.shape  torch.Size([1, 300, 128])
m.shape torch.Size([273, 32, 128])
----------------------------------------1
 Nvidia-smi: 6.0916748046875 GB
    Memory Allocated: 4.870534896850586  GigaBytes
Max Memory Allocated: 4.870946884155273  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0916748046875 GB
    Memory Allocated: 4.870534896850586  GigaBytes
Max Memory Allocated: 4.870946884155273  GigaBytes

 h.shape torch.Size([1, 273, 128]), torch.Size([1, 273, 128])
----------------------------------------3
 Nvidia-smi: 6.0916748046875 GB
    Memory Allocated: 4.870795249938965  GigaBytes
Max Memory Allocated: 4.870946884155273  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1541748046875 GB
    Memory Allocated: 4.929374694824219  GigaBytes
Max Memory Allocated: 4.933540344238281  GigaBytes

rst.shape  torch.Size([1, 273, 128])
m.shape torch.Size([261, 33, 128])
----------------------------------------1
 Nvidia-smi: 6.1541748046875 GB
    Memory Allocated: 4.933351516723633  GigaBytes
Max Memory Allocated: 4.933540344238281  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1541748046875 GB
    Memory Allocated: 4.933351516723633  GigaBytes
Max Memory Allocated: 4.933540344238281  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 6.1541748046875 GB
    Memory Allocated: 4.933600425720215  GigaBytes
Max Memory Allocated: 4.933600425720215  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2186279296875 GB
    Memory Allocated: 4.991347312927246  GigaBytes
Max Memory Allocated: 4.99545431137085  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([231, 34, 128])
----------------------------------------1
 Nvidia-smi: 6.2186279296875 GB
    Memory Allocated: 4.994967937469482  GigaBytes
Max Memory Allocated: 4.99545431137085  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2186279296875 GB
    Memory Allocated: 4.994967937469482  GigaBytes
Max Memory Allocated: 4.99545431137085  GigaBytes

 h.shape torch.Size([1, 231, 128]), torch.Size([1, 231, 128])
----------------------------------------3
 Nvidia-smi: 6.2186279296875 GB
    Memory Allocated: 4.995188236236572  GigaBytes
Max Memory Allocated: 4.99545431137085  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2791748046875 GB
    Memory Allocated: 5.047839641571045  GigaBytes
Max Memory Allocated: 5.051584720611572  GigaBytes

rst.shape  torch.Size([1, 231, 128])
m.shape torch.Size([200, 35, 128])
----------------------------------------1
 Nvidia-smi: 6.2791748046875 GB
    Memory Allocated: 5.051067352294922  GigaBytes
Max Memory Allocated: 5.051584720611572  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2791748046875 GB
    Memory Allocated: 5.051067352294922  GigaBytes
Max Memory Allocated: 5.051584720611572  GigaBytes

 h.shape torch.Size([1, 200, 128]), torch.Size([1, 200, 128])
----------------------------------------3
 Nvidia-smi: 6.2791748046875 GB
    Memory Allocated: 5.051258087158203  GigaBytes
Max Memory Allocated: 5.051584720611572  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3201904296875 GB
    Memory Allocated: 5.098178863525391  GigaBytes
Max Memory Allocated: 5.1015167236328125  GigaBytes

rst.shape  torch.Size([1, 200, 128])
m.shape torch.Size([226, 36, 128])
----------------------------------------1
 Nvidia-smi: 6.3201904296875 GB
    Memory Allocated: 5.101963043212891  GigaBytes
Max Memory Allocated: 5.102054595947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3201904296875 GB
    Memory Allocated: 5.101963043212891  GigaBytes
Max Memory Allocated: 5.102054595947266  GigaBytes

 h.shape torch.Size([1, 226, 128]), torch.Size([1, 226, 128])
----------------------------------------3
 Nvidia-smi: 6.3201904296875 GB
    Memory Allocated: 5.102178573608398  GigaBytes
Max Memory Allocated: 5.102178573608398  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3748779296875 GB
    Memory Allocated: 5.156707763671875  GigaBytes
Max Memory Allocated: 5.160587310791016  GigaBytes

rst.shape  torch.Size([1, 226, 128])
m.shape torch.Size([196, 37, 128])
----------------------------------------1
 Nvidia-smi: 6.3748779296875 GB
    Memory Allocated: 5.16005802154541  GigaBytes
Max Memory Allocated: 5.160587310791016  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3748779296875 GB
    Memory Allocated: 5.16005802154541  GigaBytes
Max Memory Allocated: 5.160587310791016  GigaBytes

 h.shape torch.Size([1, 196, 128]), torch.Size([1, 196, 128])
----------------------------------------3
 Nvidia-smi: 6.3748779296875 GB
    Memory Allocated: 5.160244941711426  GigaBytes
Max Memory Allocated: 5.160587310791016  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4217529296875 GB
    Memory Allocated: 5.208844184875488  GigaBytes
Max Memory Allocated: 5.212302207946777  GigaBytes

rst.shape  torch.Size([1, 196, 128])
m.shape torch.Size([186, 38, 128])
----------------------------------------1
 Nvidia-smi: 6.4217529296875 GB
    Memory Allocated: 5.21212100982666  GigaBytes
Max Memory Allocated: 5.212302207946777  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4217529296875 GB
    Memory Allocated: 5.21212100982666  GigaBytes
Max Memory Allocated: 5.212302207946777  GigaBytes

 h.shape torch.Size([1, 186, 128]), torch.Size([1, 186, 128])
----------------------------------------3
 Nvidia-smi: 6.4217529296875 GB
    Memory Allocated: 5.212298393249512  GigaBytes
Max Memory Allocated: 5.212302207946777  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4686279296875 GB
    Memory Allocated: 5.259659767150879  GigaBytes
Max Memory Allocated: 5.263030052185059  GigaBytes

rst.shape  torch.Size([1, 186, 128])
m.shape torch.Size([200, 39, 128])
----------------------------------------1
 Nvidia-smi: 6.4686279296875 GB
    Memory Allocated: 5.2632904052734375  GigaBytes
Max Memory Allocated: 5.263377666473389  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4686279296875 GB
    Memory Allocated: 5.2632904052734375  GigaBytes
Max Memory Allocated: 5.263377666473389  GigaBytes

 h.shape torch.Size([1, 200, 128]), torch.Size([1, 200, 128])
----------------------------------------3
 Nvidia-smi: 6.4686279296875 GB
    Memory Allocated: 5.263481140136719  GigaBytes
Max Memory Allocated: 5.263481140136719  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 5.315742492675781  GigaBytes
Max Memory Allocated: 5.319461822509766  GigaBytes

rst.shape  torch.Size([1, 200, 128])
m.shape torch.Size([161, 40, 128])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 5.318726062774658  GigaBytes
Max Memory Allocated: 5.319461822509766  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 5.318726062774658  GigaBytes
Max Memory Allocated: 5.319461822509766  GigaBytes

 h.shape torch.Size([1, 161, 128]), torch.Size([1, 161, 128])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 5.3188796043396  GigaBytes
Max Memory Allocated: 5.319461822509766  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5819091796875 GB
    Memory Allocated: 5.362024784088135  GigaBytes
Max Memory Allocated: 5.365095615386963  GigaBytes

rst.shape  torch.Size([1, 161, 128])
m.shape torch.Size([167, 41, 128])
----------------------------------------1
 Nvidia-smi: 6.5819091796875 GB
    Memory Allocated: 5.365212917327881  GigaBytes
Max Memory Allocated: 5.365289688110352  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5819091796875 GB
    Memory Allocated: 5.365212917327881  GigaBytes
Max Memory Allocated: 5.365289688110352  GigaBytes

 h.shape torch.Size([1, 167, 128]), torch.Size([1, 167, 128])
----------------------------------------3
 Nvidia-smi: 6.5819091796875 GB
    Memory Allocated: 5.365372180938721  GigaBytes
Max Memory Allocated: 5.365372180938721  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6287841796875 GB
    Memory Allocated: 5.411240100860596  GigaBytes
Max Memory Allocated: 5.4145050048828125  GigaBytes

rst.shape  torch.Size([1, 167, 128])
m.shape torch.Size([165, 42, 128])
----------------------------------------1
 Nvidia-smi: 6.6287841796875 GB
    Memory Allocated: 5.414464950561523  GigaBytes
Max Memory Allocated: 5.414543151855469  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6287841796875 GB
    Memory Allocated: 5.414464950561523  GigaBytes
Max Memory Allocated: 5.414543151855469  GigaBytes

 h.shape torch.Size([1, 165, 128]), torch.Size([1, 165, 128])
----------------------------------------3
 Nvidia-smi: 6.6287841796875 GB
    Memory Allocated: 5.4146223068237305  GigaBytes
Max Memory Allocated: 5.4146223068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6776123046875 GB
    Memory Allocated: 5.461042404174805  GigaBytes
Max Memory Allocated: 5.464346885681152  GigaBytes

rst.shape  torch.Size([1, 165, 128])
m.shape torch.Size([138, 43, 128])
----------------------------------------1
 Nvidia-smi: 6.6776123046875 GB
    Memory Allocated: 5.4637932777404785  GigaBytes
Max Memory Allocated: 5.464346885681152  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6776123046875 GB
    Memory Allocated: 5.4637932777404785  GigaBytes
Max Memory Allocated: 5.464346885681152  GigaBytes

 h.shape torch.Size([1, 138, 128]), torch.Size([1, 138, 128])
----------------------------------------3
 Nvidia-smi: 6.6776123046875 GB
    Memory Allocated: 5.463924884796143  GigaBytes
Max Memory Allocated: 5.464346885681152  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7147216796875 GB
    Memory Allocated: 5.5036702156066895  GigaBytes
Max Memory Allocated: 5.506499767303467  GigaBytes

rst.shape  torch.Size([1, 138, 128])
m.shape torch.Size([135, 44, 128])
----------------------------------------1
 Nvidia-smi: 6.7147216796875 GB
    Memory Allocated: 5.506436824798584  GigaBytes
Max Memory Allocated: 5.506503582000732  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7147216796875 GB
    Memory Allocated: 5.506436824798584  GigaBytes
Max Memory Allocated: 5.506503582000732  GigaBytes

 h.shape torch.Size([1, 135, 128]), torch.Size([1, 135, 128])
----------------------------------------3
 Nvidia-smi: 6.7147216796875 GB
    Memory Allocated: 5.506565570831299  GigaBytes
Max Memory Allocated: 5.506565570831299  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7518310546875 GB
    Memory Allocated: 5.5463480949401855  GigaBytes
Max Memory Allocated: 5.549180507659912  GigaBytes

rst.shape  torch.Size([1, 135, 128])
m.shape torch.Size([142, 45, 128])
----------------------------------------1
 Nvidia-smi: 6.7518310546875 GB
    Memory Allocated: 5.549330711364746  GigaBytes
Max Memory Allocated: 5.549402236938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7518310546875 GB
    Memory Allocated: 5.549330711364746  GigaBytes
Max Memory Allocated: 5.549402236938477  GigaBytes

 h.shape torch.Size([1, 142, 128]), torch.Size([1, 142, 128])
----------------------------------------3
 Nvidia-smi: 6.7537841796875 GB
    Memory Allocated: 5.549466133117676  GigaBytes
Max Memory Allocated: 5.549466133117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7967529296875 GB
    Memory Allocated: 5.592259407043457  GigaBytes
Max Memory Allocated: 5.595306396484375  GigaBytes

rst.shape  torch.Size([1, 142, 128])
m.shape torch.Size([106, 46, 128])
----------------------------------------1
 Nvidia-smi: 6.7967529296875 GB
    Memory Allocated: 5.594516754150391  GigaBytes
Max Memory Allocated: 5.595306396484375  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7967529296875 GB
    Memory Allocated: 5.594516754150391  GigaBytes
Max Memory Allocated: 5.595306396484375  GigaBytes

 h.shape torch.Size([1, 106, 128]), torch.Size([1, 106, 128])
----------------------------------------3
 Nvidia-smi: 6.7967529296875 GB
    Memory Allocated: 5.59461784362793  GigaBytes
Max Memory Allocated: 5.595306396484375  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8475341796875 GB
    Memory Allocated: 5.627269744873047  GigaBytes
Max Memory Allocated: 5.629594802856445  GigaBytes

rst.shape  torch.Size([1, 106, 128])
m.shape torch.Size([105, 47, 128])
----------------------------------------1
 Nvidia-smi: 6.8475341796875 GB
    Memory Allocated: 5.62957239151001  GigaBytes
Max Memory Allocated: 5.6296281814575195  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8475341796875 GB
    Memory Allocated: 5.62957239151001  GigaBytes
Max Memory Allocated: 5.6296281814575195  GigaBytes

 h.shape torch.Size([1, 105, 128]), torch.Size([1, 105, 128])
----------------------------------------3
 Nvidia-smi: 6.8475341796875 GB
    Memory Allocated: 5.629672527313232  GigaBytes
Max Memory Allocated: 5.629672527313232  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 5.662717342376709  GigaBytes
Max Memory Allocated: 5.665070533752441  GigaBytes

rst.shape  torch.Size([1, 105, 128])
m.shape torch.Size([112, 48, 128])
----------------------------------------1
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 5.665230751037598  GigaBytes
Max Memory Allocated: 5.665290832519531  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 5.665230751037598  GigaBytes
Max Memory Allocated: 5.665290832519531  GigaBytes

 h.shape torch.Size([1, 112, 128]), torch.Size([1, 112, 128])
----------------------------------------3
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 5.665337562561035  GigaBytes
Max Memory Allocated: 5.665337562561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9178466796875 GB
    Memory Allocated: 5.701333045959473  GigaBytes
Max Memory Allocated: 5.703896522521973  GigaBytes

rst.shape  torch.Size([1, 112, 128])
m.shape torch.Size([91, 49, 128])
----------------------------------------1
 Nvidia-smi: 6.9178466796875 GB
    Memory Allocated: 5.703405857086182  GigaBytes
Max Memory Allocated: 5.703896522521973  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9178466796875 GB
    Memory Allocated: 5.703405857086182  GigaBytes
Max Memory Allocated: 5.703896522521973  GigaBytes

 h.shape torch.Size([1, 91, 128]), torch.Size([1, 91, 128])
----------------------------------------3
 Nvidia-smi: 6.9178466796875 GB
    Memory Allocated: 5.703492641448975  GigaBytes
Max Memory Allocated: 5.703896522521973  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 5.733346462249756  GigaBytes
Max Memory Allocated: 5.735472679138184  GigaBytes

rst.shape  torch.Size([1, 91, 128])
m.shape torch.Size([89, 50, 128])
----------------------------------------1
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 5.735424995422363  GigaBytes
Max Memory Allocated: 5.735475063323975  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 5.735424995422363  GigaBytes
Max Memory Allocated: 5.735475063323975  GigaBytes

 h.shape torch.Size([1, 89, 128]), torch.Size([1, 89, 128])
----------------------------------------3
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 5.735509872436523  GigaBytes
Max Memory Allocated: 5.735509872436523  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9725341796875 GB
    Memory Allocated: 5.765301704406738  GigaBytes
Max Memory Allocated: 5.767423629760742  GigaBytes

rst.shape  torch.Size([1, 89, 128])
m.shape torch.Size([104, 51, 128])
----------------------------------------1
 Nvidia-smi: 6.9725341796875 GB
    Memory Allocated: 5.767788410186768  GigaBytes
Max Memory Allocated: 5.767848014831543  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9725341796875 GB
    Memory Allocated: 5.767788410186768  GigaBytes
Max Memory Allocated: 5.767848014831543  GigaBytes

 h.shape torch.Size([1, 104, 128]), torch.Size([1, 104, 128])
----------------------------------------3
 Nvidia-smi: 6.9725341796875 GB
    Memory Allocated: 5.767887592315674  GigaBytes
Max Memory Allocated: 5.767887592315674  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 5.803394794464111  GigaBytes
Max Memory Allocated: 5.805923938751221  GigaBytes

rst.shape  torch.Size([1, 104, 128])
m.shape torch.Size([81, 52, 128])
----------------------------------------1
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 5.80535364151001  GigaBytes
Max Memory Allocated: 5.805923938751221  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 5.80535364151001  GigaBytes
Max Memory Allocated: 5.805923938751221  GigaBytes

 h.shape torch.Size([1, 81, 128]), torch.Size([1, 81, 128])
----------------------------------------3
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 5.805430889129639  GigaBytes
Max Memory Allocated: 5.805923938751221  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 5.8336262702941895  GigaBytes
Max Memory Allocated: 5.835634708404541  GigaBytes

rst.shape  torch.Size([1, 81, 128])
m.shape torch.Size([79, 53, 128])
----------------------------------------1
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 5.8355841636657715  GigaBytes
Max Memory Allocated: 5.835634708404541  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 5.8355841636657715  GigaBytes
Max Memory Allocated: 5.835634708404541  GigaBytes

 h.shape torch.Size([1, 79, 128]), torch.Size([1, 79, 128])
----------------------------------------3
 Nvidia-smi: 7.0369873046875 GB
    Memory Allocated: 5.835659503936768  GigaBytes
Max Memory Allocated: 5.835659503936768  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0643310546875 GB
    Memory Allocated: 5.8636860847473145  GigaBytes
Max Memory Allocated: 5.865682601928711  GigaBytes

rst.shape  torch.Size([1, 79, 128])
m.shape torch.Size([78, 54, 128])
----------------------------------------1
 Nvidia-smi: 7.0643310546875 GB
    Memory Allocated: 5.865656852722168  GigaBytes
Max Memory Allocated: 5.86570405960083  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0643310546875 GB
    Memory Allocated: 5.865656852722168  GigaBytes
Max Memory Allocated: 5.86570405960083  GigaBytes

 h.shape torch.Size([1, 78, 128]), torch.Size([1, 78, 128])
----------------------------------------3
 Nvidia-smi: 7.0643310546875 GB
    Memory Allocated: 5.865731239318848  GigaBytes
Max Memory Allocated: 5.865731239318848  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1131591796875 GB
    Memory Allocated: 5.893923759460449  GigaBytes
Max Memory Allocated: 5.895932197570801  GigaBytes

rst.shape  torch.Size([1, 78, 128])
m.shape torch.Size([90, 55, 128])
----------------------------------------1
 Nvidia-smi: 7.1131591796875 GB
    Memory Allocated: 5.896246910095215  GigaBytes
Max Memory Allocated: 5.896302700042725  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1131591796875 GB
    Memory Allocated: 5.896246910095215  GigaBytes
Max Memory Allocated: 5.896302700042725  GigaBytes

 h.shape torch.Size([1, 90, 128]), torch.Size([1, 90, 128])
----------------------------------------3
 Nvidia-smi: 7.1131591796875 GB
    Memory Allocated: 5.896332740783691  GigaBytes
Max Memory Allocated: 5.896332740783691  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1463623046875 GB
    Memory Allocated: 5.9294633865356445  GigaBytes
Max Memory Allocated: 5.93182373046875  GigaBytes

rst.shape  torch.Size([1, 90, 128])
m.shape torch.Size([71, 56, 128])
----------------------------------------1
 Nvidia-smi: 7.1463623046875 GB
    Memory Allocated: 5.9313483238220215  GigaBytes
Max Memory Allocated: 5.93182373046875  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1463623046875 GB
    Memory Allocated: 5.9313483238220215  GigaBytes
Max Memory Allocated: 5.93182373046875  GigaBytes

 h.shape torch.Size([1, 71, 128]), torch.Size([1, 71, 128])
----------------------------------------3
 Nvidia-smi: 7.1463623046875 GB
    Memory Allocated: 5.931416034698486  GigaBytes
Max Memory Allocated: 5.93182373046875  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1737060546875 GB
    Memory Allocated: 5.95802640914917  GigaBytes
Max Memory Allocated: 5.9599223136901855  GigaBytes

rst.shape  torch.Size([1, 71, 128])
m.shape torch.Size([68, 57, 128])
----------------------------------------1
 Nvidia-smi: 7.1737060546875 GB
    Memory Allocated: 5.959840774536133  GigaBytes
Max Memory Allocated: 5.9599223136901855  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1737060546875 GB
    Memory Allocated: 5.959840774536133  GigaBytes
Max Memory Allocated: 5.9599223136901855  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 7.1737060546875 GB
    Memory Allocated: 5.959905624389648  GigaBytes
Max Memory Allocated: 5.9599223136901855  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1990966796875 GB
    Memory Allocated: 5.985845565795898  GigaBytes
Max Memory Allocated: 5.987693786621094  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([73, 58, 128])
----------------------------------------1
 Nvidia-smi: 7.1990966796875 GB
    Memory Allocated: 5.987832069396973  GigaBytes
Max Memory Allocated: 5.987880229949951  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1990966796875 GB
    Memory Allocated: 5.987832069396973  GigaBytes
Max Memory Allocated: 5.987880229949951  GigaBytes

 h.shape torch.Size([1, 73, 128]), torch.Size([1, 73, 128])
----------------------------------------3
 Nvidia-smi: 7.1990966796875 GB
    Memory Allocated: 5.98790168762207  GigaBytes
Max Memory Allocated: 5.98790168762207  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2264404296875 GB
    Memory Allocated: 6.016236305236816  GigaBytes
Max Memory Allocated: 6.018255233764648  GigaBytes

rst.shape  torch.Size([1, 73, 128])
m.shape torch.Size([55, 59, 128])
----------------------------------------1
 Nvidia-smi: 7.2264404296875 GB
    Memory Allocated: 6.017894744873047  GigaBytes
Max Memory Allocated: 6.018255233764648  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2264404296875 GB
    Memory Allocated: 6.017894744873047  GigaBytes
Max Memory Allocated: 6.018255233764648  GigaBytes

 h.shape torch.Size([1, 55, 128]), torch.Size([1, 55, 128])
----------------------------------------3
 Nvidia-smi: 7.2264404296875 GB
    Memory Allocated: 6.017947196960449  GigaBytes
Max Memory Allocated: 6.018255233764648  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2459716796875 GB
    Memory Allocated: 6.0396623611450195  GigaBytes
Max Memory Allocated: 6.041428565979004  GigaBytes

rst.shape  torch.Size([1, 55, 128])
m.shape torch.Size([63, 60, 128])
----------------------------------------1
 Nvidia-smi: 7.2479248046875 GB
    Memory Allocated: 6.041460037231445  GigaBytes
Max Memory Allocated: 6.041502952575684  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2479248046875 GB
    Memory Allocated: 6.041460037231445  GigaBytes
Max Memory Allocated: 6.041502952575684  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 7.2479248046875 GB
    Memory Allocated: 6.041520118713379  GigaBytes
Max Memory Allocated: 6.041520118713379  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2713623046875 GB
    Memory Allocated: 6.066814422607422  GigaBytes
Max Memory Allocated: 6.06861686706543  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([69, 61, 128])
----------------------------------------1
 Nvidia-smi: 7.2733154296875 GB
    Memory Allocated: 6.068791389465332  GigaBytes
Max Memory Allocated: 6.068838596343994  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2733154296875 GB
    Memory Allocated: 6.068791389465332  GigaBytes
Max Memory Allocated: 6.068838596343994  GigaBytes

 h.shape torch.Size([1, 69, 128]), torch.Size([1, 69, 128])
----------------------------------------3
 Nvidia-smi: 7.2733154296875 GB
    Memory Allocated: 6.068857192993164  GigaBytes
Max Memory Allocated: 6.068857192993164  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 6.097021102905273  GigaBytes
Max Memory Allocated: 6.09902811050415  GigaBytes

rst.shape  torch.Size([1, 69, 128])
m.shape torch.Size([62, 62, 128])
----------------------------------------1
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 6.09882116317749  GigaBytes
Max Memory Allocated: 6.09902811050415  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 6.09882116317749  GigaBytes
Max Memory Allocated: 6.09902811050415  GigaBytes

 h.shape torch.Size([1, 62, 128]), torch.Size([1, 62, 128])
----------------------------------------3
 Nvidia-smi: 7.3006591796875 GB
    Memory Allocated: 6.098880290985107  GigaBytes
Max Memory Allocated: 6.09902811050415  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3260498046875 GB
    Memory Allocated: 6.124600887298584  GigaBytes
Max Memory Allocated: 6.126433849334717  GigaBytes

rst.shape  torch.Size([1, 62, 128])
m.shape torch.Size([52, 63, 128])
----------------------------------------1
 Nvidia-smi: 7.3260498046875 GB
    Memory Allocated: 6.12633752822876  GigaBytes
Max Memory Allocated: 6.126433849334717  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3260498046875 GB
    Memory Allocated: 6.12633752822876  GigaBytes
Max Memory Allocated: 6.126433849334717  GigaBytes

 h.shape torch.Size([1, 52, 128]), torch.Size([1, 52, 128])
----------------------------------------3
 Nvidia-smi: 7.3260498046875 GB
    Memory Allocated: 6.126387119293213  GigaBytes
Max Memory Allocated: 6.126433849334717  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 6.148306369781494  GigaBytes
Max Memory Allocated: 6.149868488311768  GigaBytes

rst.shape  torch.Size([1, 52, 128])
m.shape torch.Size([49, 64, 128])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 6.149776935577393  GigaBytes
Max Memory Allocated: 6.149868488311768  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 6.149776935577393  GigaBytes
Max Memory Allocated: 6.149868488311768  GigaBytes

 h.shape torch.Size([1, 49, 128]), torch.Size([1, 49, 128])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 6.1498236656188965  GigaBytes
Max Memory Allocated: 6.149868488311768  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3690185546875 GB
    Memory Allocated: 6.17080545425415  GigaBytes
Max Memory Allocated: 6.172300815582275  GigaBytes

rst.shape  torch.Size([1, 49, 128])
m.shape torch.Size([54, 65, 128])
----------------------------------------1
 Nvidia-smi: 7.3690185546875 GB
    Memory Allocated: 6.172455787658691  GigaBytes
Max Memory Allocated: 6.172495365142822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3690185546875 GB
    Memory Allocated: 6.172455787658691  GigaBytes
Max Memory Allocated: 6.172495365142822  GigaBytes

 h.shape torch.Size([1, 54, 128]), torch.Size([1, 54, 128])
----------------------------------------3
 Nvidia-smi: 7.3690185546875 GB
    Memory Allocated: 6.172507286071777  GigaBytes
Max Memory Allocated: 6.172507286071777  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3924560546875 GB
    Memory Allocated: 6.195990562438965  GigaBytes
Max Memory Allocated: 6.197664260864258  GigaBytes

rst.shape  torch.Size([1, 54, 128])
m.shape torch.Size([51, 66, 128])
----------------------------------------1
 Nvidia-smi: 7.3924560546875 GB
    Memory Allocated: 6.197569847106934  GigaBytes
Max Memory Allocated: 6.197664260864258  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3924560546875 GB
    Memory Allocated: 6.197569847106934  GigaBytes
Max Memory Allocated: 6.197664260864258  GigaBytes

 h.shape torch.Size([1, 51, 128]), torch.Size([1, 51, 128])
----------------------------------------3
 Nvidia-smi: 7.3924560546875 GB
    Memory Allocated: 6.19761848449707  GigaBytes
Max Memory Allocated: 6.197664260864258  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 6.220137596130371  GigaBytes
Max Memory Allocated: 6.221742630004883  GigaBytes

rst.shape  torch.Size([1, 51, 128])
m.shape torch.Size([68, 67, 128])
----------------------------------------1
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 6.222285747528076  GigaBytes
Max Memory Allocated: 6.222337245941162  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 6.222285747528076  GigaBytes
Max Memory Allocated: 6.222337245941162  GigaBytes

 h.shape torch.Size([1, 68, 128]), torch.Size([1, 68, 128])
----------------------------------------3
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 6.222350597381592  GigaBytes
Max Memory Allocated: 6.222350597381592  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 6.2528300285339355  GigaBytes
Max Memory Allocated: 6.25534725189209  GigaBytes

rst.shape  torch.Size([1, 68, 128])
m.shape torch.Size([42, 68, 128])
----------------------------------------1
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 6.254159450531006  GigaBytes
Max Memory Allocated: 6.25534725189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 6.254159450531006  GigaBytes
Max Memory Allocated: 6.25534725189209  GigaBytes

 h.shape torch.Size([1, 42, 128]), torch.Size([1, 42, 128])
----------------------------------------3
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 6.254199504852295  GigaBytes
Max Memory Allocated: 6.25534725189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4822998046875 GB
    Memory Allocated: 6.273305416107178  GigaBytes
Max Memory Allocated: 6.274667263031006  GigaBytes

rst.shape  torch.Size([1, 42, 128])
m.shape torch.Size([47, 69, 128])
----------------------------------------1
 Nvidia-smi: 7.4822998046875 GB
    Memory Allocated: 6.274831771850586  GigaBytes
Max Memory Allocated: 6.274868488311768  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4822998046875 GB
    Memory Allocated: 6.274831771850586  GigaBytes
Max Memory Allocated: 6.274868488311768  GigaBytes

 h.shape torch.Size([1, 47, 128]), torch.Size([1, 47, 128])
----------------------------------------3
 Nvidia-smi: 7.4822998046875 GB
    Memory Allocated: 6.274876594543457  GigaBytes
Max Memory Allocated: 6.274876594543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 6.296570777893066  GigaBytes
Max Memory Allocated: 6.298117160797119  GigaBytes

rst.shape  torch.Size([1, 47, 128])
m.shape torch.Size([44, 70, 128])
----------------------------------------1
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 6.2980170249938965  GigaBytes
Max Memory Allocated: 6.298117160797119  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 6.2980170249938965  GigaBytes
Max Memory Allocated: 6.298117160797119  GigaBytes

 h.shape torch.Size([1, 44, 128]), torch.Size([1, 44, 128])
----------------------------------------3
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 6.298058986663818  GigaBytes
Max Memory Allocated: 6.298117160797119  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5252685546875 GB
    Memory Allocated: 6.318662166595459  GigaBytes
Max Memory Allocated: 6.320130825042725  GigaBytes

rst.shape  torch.Size([1, 44, 128])
m.shape torch.Size([43, 71, 128])
----------------------------------------1
 Nvidia-smi: 7.5252685546875 GB
    Memory Allocated: 6.320096969604492  GigaBytes
Max Memory Allocated: 6.320131301879883  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5252685546875 GB
    Memory Allocated: 6.320096969604492  GigaBytes
Max Memory Allocated: 6.320131301879883  GigaBytes

 h.shape torch.Size([1, 43, 128]), torch.Size([1, 43, 128])
----------------------------------------3
 Nvidia-smi: 7.5252685546875 GB
    Memory Allocated: 6.320137977600098  GigaBytes
Max Memory Allocated: 6.320137977600098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5467529296875 GB
    Memory Allocated: 6.340559959411621  GigaBytes
Max Memory Allocated: 6.342015743255615  GigaBytes

rst.shape  torch.Size([1, 43, 128])
m.shape torch.Size([63, 72, 128])
----------------------------------------1
 Nvidia-smi: 7.5467529296875 GB
    Memory Allocated: 6.342702388763428  GigaBytes
Max Memory Allocated: 6.3427534103393555  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5467529296875 GB
    Memory Allocated: 6.342702388763428  GigaBytes
Max Memory Allocated: 6.3427534103393555  GigaBytes

 h.shape torch.Size([1, 63, 128]), torch.Size([1, 63, 128])
----------------------------------------3
 Nvidia-smi: 7.5467529296875 GB
    Memory Allocated: 6.342762470245361  GigaBytes
Max Memory Allocated: 6.342762470245361  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5760498046875 GB
    Memory Allocated: 6.373103618621826  GigaBytes
Max Memory Allocated: 6.3752665519714355  GigaBytes

rst.shape  torch.Size([1, 63, 128])
m.shape torch.Size([32, 73, 128])
----------------------------------------1
 Nvidia-smi: 7.5760498046875 GB
    Memory Allocated: 6.3742289543151855  GigaBytes
Max Memory Allocated: 6.3752665519714355  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5760498046875 GB
    Memory Allocated: 6.3742289543151855  GigaBytes
Max Memory Allocated: 6.3752665519714355  GigaBytes

 h.shape torch.Size([1, 32, 128]), torch.Size([1, 32, 128])
----------------------------------------3
 Nvidia-smi: 7.5760498046875 GB
    Memory Allocated: 6.3742594718933105  GigaBytes
Max Memory Allocated: 6.3752665519714355  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5916748046875 GB
    Memory Allocated: 6.3898844718933105  GigaBytes
Max Memory Allocated: 6.391171455383301  GigaBytes

rst.shape  torch.Size([1, 32, 128])
m.shape torch.Size([36, 74, 128])
----------------------------------------1
 Nvidia-smi: 7.5916748046875 GB
    Memory Allocated: 6.391156196594238  GigaBytes
Max Memory Allocated: 6.391186237335205  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5916748046875 GB
    Memory Allocated: 6.391156196594238  GigaBytes
Max Memory Allocated: 6.391186237335205  GigaBytes

 h.shape torch.Size([1, 36, 128]), torch.Size([1, 36, 128])
----------------------------------------3
 Nvidia-smi: 7.5916748046875 GB
    Memory Allocated: 6.391190528869629  GigaBytes
Max Memory Allocated: 6.391190528869629  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6092529296875 GB
    Memory Allocated: 6.409008979797363  GigaBytes
Max Memory Allocated: 6.410279273986816  GigaBytes

rst.shape  torch.Size([1, 36, 128])
m.shape torch.Size([35, 75, 128])
----------------------------------------1
 Nvidia-smi: 7.6092529296875 GB
    Memory Allocated: 6.410243511199951  GigaBytes
Max Memory Allocated: 6.410279273986816  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6092529296875 GB
    Memory Allocated: 6.410243511199951  GigaBytes
Max Memory Allocated: 6.410279273986816  GigaBytes

 h.shape torch.Size([1, 35, 128]), torch.Size([1, 35, 128])
----------------------------------------3
 Nvidia-smi: 7.6092529296875 GB
    Memory Allocated: 6.410276889801025  GigaBytes
Max Memory Allocated: 6.410279273986816  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 6.4278340339660645  GigaBytes
Max Memory Allocated: 6.429085731506348  GigaBytes

rst.shape  torch.Size([1, 35, 128])
m.shape torch.Size([31, 76, 128])
----------------------------------------1
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 6.428940773010254  GigaBytes
Max Memory Allocated: 6.429085731506348  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 6.428940773010254  GigaBytes
Max Memory Allocated: 6.429085731506348  GigaBytes

 h.shape torch.Size([1, 31, 128]), torch.Size([1, 31, 128])
----------------------------------------3
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 6.4289703369140625  GigaBytes
Max Memory Allocated: 6.429085731506348  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 6.444727897644043  GigaBytes
Max Memory Allocated: 6.4458513259887695  GigaBytes

rst.shape  torch.Size([1, 31, 128])
m.shape torch.Size([40, 77, 128])
----------------------------------------1
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 6.446181774139404  GigaBytes
Max Memory Allocated: 6.446217060089111  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 6.446181774139404  GigaBytes
Max Memory Allocated: 6.446217060089111  GigaBytes

 h.shape torch.Size([1, 40, 128]), torch.Size([1, 40, 128])
----------------------------------------3
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 6.4462199211120605  GigaBytes
Max Memory Allocated: 6.4462199211120605  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6619873046875 GB
    Memory Allocated: 6.4668192863464355  GigaBytes
Max Memory Allocated: 6.468287944793701  GigaBytes

rst.shape  torch.Size([1, 40, 128])
m.shape torch.Size([22, 78, 128])
----------------------------------------1
 Nvidia-smi: 7.6639404296875 GB
    Memory Allocated: 6.467618465423584  GigaBytes
Max Memory Allocated: 6.468287944793701  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6639404296875 GB
    Memory Allocated: 6.467618465423584  GigaBytes
Max Memory Allocated: 6.468287944793701  GigaBytes

 h.shape torch.Size([1, 22, 128]), torch.Size([1, 22, 128])
----------------------------------------3
 Nvidia-smi: 7.6639404296875 GB
    Memory Allocated: 6.467639446258545  GigaBytes
Max Memory Allocated: 6.468287944793701  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6756591796875 GB
    Memory Allocated: 6.479115962982178  GigaBytes
Max Memory Allocated: 6.479934215545654  GigaBytes

rst.shape  torch.Size([1, 22, 128])
m.shape torch.Size([27, 79, 128])
----------------------------------------1
 Nvidia-smi: 7.6756591796875 GB
    Memory Allocated: 6.4801225662231445  GigaBytes
Max Memory Allocated: 6.480146884918213  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6756591796875 GB
    Memory Allocated: 6.4801225662231445  GigaBytes
Max Memory Allocated: 6.480146884918213  GigaBytes

 h.shape torch.Size([1, 27, 128]), torch.Size([1, 27, 128])
----------------------------------------3
 Nvidia-smi: 7.6756591796875 GB
    Memory Allocated: 6.4801483154296875  GigaBytes
Max Memory Allocated: 6.4801483154296875  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 6.494413375854492  GigaBytes
Max Memory Allocated: 6.4954304695129395  GigaBytes

rst.shape  torch.Size([1, 27, 128])
m.shape torch.Size([31, 80, 128])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 6.4955830574035645  GigaBytes
Max Memory Allocated: 6.495611190795898  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 6.4955830574035645  GigaBytes
Max Memory Allocated: 6.495611190795898  GigaBytes

 h.shape torch.Size([1, 31, 128]), torch.Size([1, 31, 128])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 6.495612621307373  GigaBytes
Max Memory Allocated: 6.495612621307373  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 6.512197971343994  GigaBytes
Max Memory Allocated: 6.513380527496338  GigaBytes

rst.shape  torch.Size([1, 31, 128])
m.shape torch.Size([35, 81, 128])
----------------------------------------1
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 6.513535022735596  GigaBytes
Max Memory Allocated: 6.5135674476623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 6.513535022735596  GigaBytes
Max Memory Allocated: 6.5135674476623535  GigaBytes

 h.shape torch.Size([1, 35, 128]), torch.Size([1, 35, 128])
----------------------------------------3
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 6.51356840133667  GigaBytes
Max Memory Allocated: 6.51356840133667  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7244873046875 GB
    Memory Allocated: 6.532527446746826  GigaBytes
Max Memory Allocated: 6.533879280090332  GigaBytes

rst.shape  torch.Size([1, 35, 128])
m.shape torch.Size([35, 82, 128])
----------------------------------------1
 Nvidia-smi: 7.7244873046875 GB
    Memory Allocated: 6.533879280090332  GigaBytes
Max Memory Allocated: 6.53391170501709  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7244873046875 GB
    Memory Allocated: 6.533879280090332  GigaBytes
Max Memory Allocated: 6.53391170501709  GigaBytes

 h.shape torch.Size([1, 35, 128]), torch.Size([1, 35, 128])
----------------------------------------3
 Nvidia-smi: 7.7244873046875 GB
    Memory Allocated: 6.533912658691406  GigaBytes
Max Memory Allocated: 6.533912658691406  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7440185546875 GB
    Memory Allocated: 6.553105354309082  GigaBytes
Max Memory Allocated: 6.554473876953125  GigaBytes

rst.shape  torch.Size([1, 35, 128])
m.shape torch.Size([29, 83, 128])
----------------------------------------1
 Nvidia-smi: 7.7440185546875 GB
    Memory Allocated: 6.55423641204834  GigaBytes
Max Memory Allocated: 6.554473876953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7440185546875 GB
    Memory Allocated: 6.55423641204834  GigaBytes
Max Memory Allocated: 6.554473876953125  GigaBytes

 h.shape torch.Size([1, 29, 128]), torch.Size([1, 29, 128])
----------------------------------------3
 Nvidia-smi: 7.7440185546875 GB
    Memory Allocated: 6.554264068603516  GigaBytes
Max Memory Allocated: 6.554473876953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7596435546875 GB
    Memory Allocated: 6.57036018371582  GigaBytes
Max Memory Allocated: 6.571507930755615  GigaBytes

rst.shape  torch.Size([1, 29, 128])
m.shape torch.Size([33, 84, 128])
----------------------------------------1
 Nvidia-smi: 7.7596435546875 GB
    Memory Allocated: 6.5716681480407715  GigaBytes
Max Memory Allocated: 6.571699619293213  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7596435546875 GB
    Memory Allocated: 6.5716681480407715  GigaBytes
Max Memory Allocated: 6.571699619293213  GigaBytes

 h.shape torch.Size([1, 33, 128]), torch.Size([1, 33, 128])
----------------------------------------3
 Nvidia-smi: 7.7596435546875 GB
    Memory Allocated: 6.571699619293213  GigaBytes
Max Memory Allocated: 6.571699619293213  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 6.590236186981201  GigaBytes
Max Memory Allocated: 6.59190034866333  GigaBytes

rst.shape  torch.Size([1, 33, 128])
m.shape torch.Size([27, 85, 128])
----------------------------------------1
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 6.591884613037109  GigaBytes
Max Memory Allocated: 6.591910362243652  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 6.591884613037109  GigaBytes
Max Memory Allocated: 6.591910362243652  GigaBytes

 h.shape torch.Size([1, 27, 128]), torch.Size([1, 27, 128])
----------------------------------------3
 Nvidia-smi: 7.7772216796875 GB
    Memory Allocated: 6.591910362243652  GigaBytes
Max Memory Allocated: 6.591910362243652  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8123779296875 GB
    Memory Allocated: 6.607256889343262  GigaBytes
Max Memory Allocated: 6.608351230621338  GigaBytes

rst.shape  torch.Size([1, 27, 128])
m.shape torch.Size([39, 86, 128])
----------------------------------------1
 Nvidia-smi: 7.8123779296875 GB
    Memory Allocated: 6.6088433265686035  GigaBytes
Max Memory Allocated: 6.60888147354126  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8123779296875 GB
    Memory Allocated: 6.6088433265686035  GigaBytes
Max Memory Allocated: 6.60888147354126  GigaBytes

 h.shape torch.Size([1, 39, 128]), torch.Size([1, 39, 128])
----------------------------------------3
 Nvidia-smi: 7.8123779296875 GB
    Memory Allocated: 6.608880519866943  GigaBytes
Max Memory Allocated: 6.60888147354126  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8358154296875 GB
    Memory Allocated: 6.631308078765869  GigaBytes
Max Memory Allocated: 6.632907390594482  GigaBytes

rst.shape  torch.Size([1, 39, 128])
m.shape torch.Size([38, 87, 128])
----------------------------------------1
 Nvidia-smi: 7.8358154296875 GB
    Memory Allocated: 6.632865905761719  GigaBytes
Max Memory Allocated: 6.632907390594482  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8358154296875 GB
    Memory Allocated: 6.632865905761719  GigaBytes
Max Memory Allocated: 6.632907390594482  GigaBytes

 h.shape torch.Size([1, 38, 128]), torch.Size([1, 38, 128])
----------------------------------------3
 Nvidia-smi: 7.8358154296875 GB
    Memory Allocated: 6.632902145385742  GigaBytes
Max Memory Allocated: 6.632907390594482  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 6.655008316040039  GigaBytes
Max Memory Allocated: 6.656584739685059  GigaBytes

rst.shape  torch.Size([1, 38, 128])
m.shape torch.Size([25, 88, 128])
----------------------------------------1
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 6.656039237976074  GigaBytes
Max Memory Allocated: 6.656584739685059  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 6.656039237976074  GigaBytes
Max Memory Allocated: 6.656584739685059  GigaBytes

 h.shape torch.Size([1, 25, 128]), torch.Size([1, 25, 128])
----------------------------------------3
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 6.656063079833984  GigaBytes
Max Memory Allocated: 6.656584739685059  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8729248046875 GB
    Memory Allocated: 6.670773506164551  GigaBytes
Max Memory Allocated: 6.671822547912598  GigaBytes

rst.shape  torch.Size([1, 25, 128])
m.shape torch.Size([24, 89, 128])
----------------------------------------1
 Nvidia-smi: 7.8729248046875 GB
    Memory Allocated: 6.671780109405518  GigaBytes
Max Memory Allocated: 6.671822547912598  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8729248046875 GB
    Memory Allocated: 6.671780109405518  GigaBytes
Max Memory Allocated: 6.671822547912598  GigaBytes

 h.shape torch.Size([1, 24, 128]), torch.Size([1, 24, 128])
----------------------------------------3
 Nvidia-smi: 7.8729248046875 GB
    Memory Allocated: 6.671802997589111  GigaBytes
Max Memory Allocated: 6.671822547912598  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8865966796875 GB
    Memory Allocated: 6.686085224151611  GigaBytes
Max Memory Allocated: 6.687103748321533  GigaBytes

rst.shape  torch.Size([1, 24, 128])
m.shape torch.Size([23, 90, 128])
----------------------------------------1
 Nvidia-smi: 7.8865966796875 GB
    Memory Allocated: 6.687060832977295  GigaBytes
Max Memory Allocated: 6.687103748321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8865966796875 GB
    Memory Allocated: 6.687060832977295  GigaBytes
Max Memory Allocated: 6.687103748321533  GigaBytes

 h.shape torch.Size([1, 23, 128]), torch.Size([1, 23, 128])
----------------------------------------3
 Nvidia-smi: 7.8865966796875 GB
    Memory Allocated: 6.687082767486572  GigaBytes
Max Memory Allocated: 6.687103748321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9002685546875 GB
    Memory Allocated: 6.700923442840576  GigaBytes
Max Memory Allocated: 6.701910495758057  GigaBytes

rst.shape  torch.Size([1, 23, 128])
m.shape torch.Size([27, 91, 128])
----------------------------------------1
 Nvidia-smi: 7.9002685546875 GB
    Memory Allocated: 6.702084064483643  GigaBytes
Max Memory Allocated: 6.702112197875977  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9002685546875 GB
    Memory Allocated: 6.702084064483643  GigaBytes
Max Memory Allocated: 6.702112197875977  GigaBytes

 h.shape torch.Size([1, 27, 128]), torch.Size([1, 27, 128])
----------------------------------------3
 Nvidia-smi: 7.9002685546875 GB
    Memory Allocated: 6.7021098136901855  GigaBytes
Max Memory Allocated: 6.702112197875977  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 6.7185378074646  GigaBytes
Max Memory Allocated: 6.719709396362305  GigaBytes

rst.shape  torch.Size([1, 27, 128])
m.shape torch.Size([24, 92, 128])
----------------------------------------1
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 6.719577789306641  GigaBytes
Max Memory Allocated: 6.719709396362305  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 6.719577789306641  GigaBytes
Max Memory Allocated: 6.719709396362305  GigaBytes

 h.shape torch.Size([1, 24, 128]), torch.Size([1, 24, 128])
----------------------------------------3
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 6.719600677490234  GigaBytes
Max Memory Allocated: 6.719709396362305  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9315185546875 GB
    Memory Allocated: 6.734363555908203  GigaBytes
Max Memory Allocated: 6.735416412353516  GigaBytes

rst.shape  torch.Size([1, 24, 128])
m.shape torch.Size([22, 93, 128])
----------------------------------------1
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 6.73532772064209  GigaBytes
Max Memory Allocated: 6.735416412353516  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 6.73532772064209  GigaBytes
Max Memory Allocated: 6.735416412353516  GigaBytes

 h.shape torch.Size([1, 22, 128]), torch.Size([1, 22, 128])
----------------------------------------3
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 6.735348701477051  GigaBytes
Max Memory Allocated: 6.735416412353516  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 6.749028205871582  GigaBytes
Max Memory Allocated: 6.750003814697266  GigaBytes

rst.shape  torch.Size([1, 22, 128])
m.shape torch.Size([29, 94, 128])
----------------------------------------1
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 6.750317573547363  GigaBytes
Max Memory Allocated: 6.7503485679626465  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 6.750317573547363  GigaBytes
Max Memory Allocated: 6.7503485679626465  GigaBytes

 h.shape torch.Size([1, 29, 128]), torch.Size([1, 29, 128])
----------------------------------------3
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 6.750345230102539  GigaBytes
Max Memory Allocated: 6.7503485679626465  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9647216796875 GB
    Memory Allocated: 6.768570899963379  GigaBytes
Max Memory Allocated: 6.769870758056641  GigaBytes

rst.shape  torch.Size([1, 29, 128])
m.shape torch.Size([27, 95, 128])
----------------------------------------1
 Nvidia-smi: 7.9647216796875 GB
    Memory Allocated: 6.769780158996582  GigaBytes
Max Memory Allocated: 6.769870758056641  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9647216796875 GB
    Memory Allocated: 6.769780158996582  GigaBytes
Max Memory Allocated: 6.769870758056641  GigaBytes

 h.shape torch.Size([1, 27, 128]), torch.Size([1, 27, 128])
----------------------------------------3
 Nvidia-smi: 7.9647216796875 GB
    Memory Allocated: 6.769805908203125  GigaBytes
Max Memory Allocated: 6.769870758056641  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 6.786954879760742  GigaBytes
Max Memory Allocated: 6.788177967071533  GigaBytes

rst.shape  torch.Size([1, 27, 128])
m.shape torch.Size([20, 96, 128])
----------------------------------------1
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 6.787857532501221  GigaBytes
Max Memory Allocated: 6.788177967071533  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 6.787857532501221  GigaBytes
Max Memory Allocated: 6.788177967071533  GigaBytes

 h.shape torch.Size([1, 20, 128]), torch.Size([1, 20, 128])
----------------------------------------3
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 6.787876605987549  GigaBytes
Max Memory Allocated: 6.788177967071533  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9959716796875 GB
    Memory Allocated: 6.800713062286377  GigaBytes
Max Memory Allocated: 6.801628589630127  GigaBytes

rst.shape  torch.Size([1, 20, 128])
m.shape torch.Size([21, 97, 128])
----------------------------------------1
 Nvidia-smi: 7.9979248046875 GB
    Memory Allocated: 6.801674842834473  GigaBytes
Max Memory Allocated: 6.801697731018066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9979248046875 GB
    Memory Allocated: 6.801674842834473  GigaBytes
Max Memory Allocated: 6.801697731018066  GigaBytes

 h.shape torch.Size([1, 21, 128]), torch.Size([1, 21, 128])
----------------------------------------3
 Nvidia-smi: 7.9979248046875 GB
    Memory Allocated: 6.801694869995117  GigaBytes
Max Memory Allocated: 6.801697731018066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0115966796875 GB
    Memory Allocated: 6.815313339233398  GigaBytes
Max Memory Allocated: 6.816284656524658  GigaBytes

rst.shape  torch.Size([1, 21, 128])
m.shape torch.Size([29, 98, 128])
----------------------------------------1
 Nvidia-smi: 8.0115966796875 GB
    Memory Allocated: 6.8166584968566895  GigaBytes
Max Memory Allocated: 6.816690921783447  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0115966796875 GB
    Memory Allocated: 6.8166584968566895  GigaBytes
Max Memory Allocated: 6.816690921783447  GigaBytes

 h.shape torch.Size([1, 29, 128]), torch.Size([1, 29, 128])
----------------------------------------3
 Nvidia-smi: 8.0115966796875 GB
    Memory Allocated: 6.816686153411865  GigaBytes
Max Memory Allocated: 6.816690921783447  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0291748046875 GB
    Memory Allocated: 6.835686206817627  GigaBytes
Max Memory Allocated: 6.83704137802124  GigaBytes

rst.shape  torch.Size([1, 29, 128])
m.shape torch.Size([26, 99, 128])
----------------------------------------1
 Nvidia-smi: 8.0291748046875 GB
    Memory Allocated: 6.836899757385254  GigaBytes
Max Memory Allocated: 6.83704137802124  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0291748046875 GB
    Memory Allocated: 6.836899757385254  GigaBytes
Max Memory Allocated: 6.83704137802124  GigaBytes

 h.shape torch.Size([1, 26, 128]), torch.Size([1, 26, 128])
----------------------------------------3
 Nvidia-smi: 8.0291748046875 GB
    Memory Allocated: 6.8369245529174805  GigaBytes
Max Memory Allocated: 6.83704137802124  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0467529296875 GB
    Memory Allocated: 6.854132652282715  GigaBytes
Max Memory Allocated: 6.85536003112793  GigaBytes

rst.shape  torch.Size([1, 26, 128])
m.shape torch.Size([771, 100, 128])
----------------------------------------1
 Nvidia-smi: 8.0838623046875 GB
    Memory Allocated: 6.891229629516602  GigaBytes
Max Memory Allocated: 6.892091751098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0838623046875 GB
    Memory Allocated: 6.891229629516602  GigaBytes
Max Memory Allocated: 6.892091751098633  GigaBytes

 h.shape torch.Size([1, 771, 128]), torch.Size([1, 771, 128])
----------------------------------------3
 Nvidia-smi: 8.0838623046875 GB
    Memory Allocated: 6.891964912414551  GigaBytes
Max Memory Allocated: 6.892091751098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6502685546875 GB
    Memory Allocated: 7.416592597961426  GigaBytes
Max Memory Allocated: 7.453701972961426  GigaBytes

rst.shape  torch.Size([1, 771, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.7850341796875 GB
    Memory Allocated: 7.011713981628418  GigaBytes
Max Memory Allocated: 7.5462565422058105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.7850341796875 GB
    Memory Allocated: 7.025265693664551  GigaBytes
Max Memory Allocated: 7.5462565422058105  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.7850341796875 GB
    Memory Allocated: 7.038817405700684  GigaBytes
Max Memory Allocated: 7.5462565422058105  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.7850341796875 GB
    Memory Allocated: 7.024588108062744  GigaBytes
Max Memory Allocated: 7.5462565422058105  GigaBytes

torch.Size([90941, 40])
input nodes number: 160279
output nodes number: 90941
edges number: 931807
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.7850341796875 GB
    Memory Allocated: 7.040375232696533  GigaBytes
Max Memory Allocated: 7.5462565422058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.7850341796875 GB
    Memory Allocated: 7.04037618637085  GigaBytes
Max Memory Allocated: 7.5462565422058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.7850341796875 GB
    Memory Allocated: 0.10817766189575195  GigaBytes
Max Memory Allocated: 7.5462565422058105  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.7850341796875 GB
    Memory Allocated: 0.1092381477355957  GigaBytes
Max Memory Allocated: 7.5462565422058105  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.7850341796875 GB
    Memory Allocated: 0.1092381477355957  GigaBytes
Max Memory Allocated: 7.5462565422058105  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030431032180786133 |0.3519306182861328 |1.3207018375396729 |0.000244140625 |0.7430644035339355 |0.002384185791015625 |
----------------------------------------------------------pseudo_mini_loss sum 3.8366472721099854
Total (block generation + training)time/epoch 2.5525505542755127
* Pure training time/epoch 2.448756217956543
Training time/epoch 2.456855058670044
Training time without block to device /epoch 2.104924440383911
Training time without total dataloading part /epoch 2.066394567489624
load block tensor time/epoch 0.030431032180786133
block to device time/epoch 0.3519306182861328
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 6.705522537231445e-08
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  160279
Number of first layer input nodes during this epoch:  160279
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
