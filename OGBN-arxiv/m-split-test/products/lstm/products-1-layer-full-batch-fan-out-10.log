main start at this time 1654546477.1147456
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

<class 'int'>
----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.09204554557800293
pseudo mini batch 0 input nodes size: 848126
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.3167438507080078  GigaBytes
Max Memory Allocated: 0.3167438507080078  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.3182086944580078  GigaBytes
Max Memory Allocated: 0.3182086944580078  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.3182086944580078  GigaBytes
Max Memory Allocated: 0.3182086944580078  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.3327302932739258  GigaBytes
Max Memory Allocated: 0.3327302932739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.3327302932739258  GigaBytes
Max Memory Allocated: 0.3327302932739258  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.3327302932739258  GigaBytes
Max Memory Allocated: 0.3327302932739258  GigaBytes

m.shape torch.Size([173, 1, 100])
----------------------------------------1
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 1.0812082290649414  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 1.0812082290649414  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

 h.shape torch.Size([1, 173, 100]), torch.Size([1, 173, 100])
----------------------------------------3
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 1.0813379287719727  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3436279296875 GB
    Memory Allocated: 1.0823712348937988  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

rst.shape  torch.Size([1, 173, 100])
m.shape torch.Size([221, 2, 100])
----------------------------------------1
 Nvidia-smi: 2.3436279296875 GB
    Memory Allocated: 1.0824713706970215  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3436279296875 GB
    Memory Allocated: 1.0824713706970215  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

 h.shape torch.Size([1, 221, 100]), torch.Size([1, 221, 100])
----------------------------------------3
 Nvidia-smi: 2.3436279296875 GB
    Memory Allocated: 1.0826363563537598  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 1.0851082801818848  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

rst.shape  torch.Size([1, 221, 100])
m.shape torch.Size([374, 3, 100])
----------------------------------------1
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 1.0854439735412598  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 1.0854439735412598  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

 h.shape torch.Size([1, 374, 100]), torch.Size([1, 374, 100])
----------------------------------------3
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 1.0857234001159668  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 1.09185791015625  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

rst.shape  torch.Size([1, 374, 100])
m.shape torch.Size([456, 4, 100])
----------------------------------------1
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 1.092397689819336  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 1.092397689819336  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

 h.shape torch.Size([1, 456, 100]), torch.Size([1, 456, 100])
----------------------------------------3
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 1.092738151550293  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.1025943756103516  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

rst.shape  torch.Size([1, 456, 100])
m.shape torch.Size([445, 5, 100])
----------------------------------------1
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.1032533645629883  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.1032533645629883  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

 h.shape torch.Size([1, 445, 100]), torch.Size([1, 445, 100])
----------------------------------------3
 Nvidia-smi: 2.3670654296875 GB
    Memory Allocated: 1.1035852432250977  GigaBytes
Max Memory Allocated: 1.1123156547546387  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.115525722503662  GigaBytes
Max Memory Allocated: 1.1163549423217773  GigaBytes

rst.shape  torch.Size([1, 445, 100])
m.shape torch.Size([550, 6, 100])
----------------------------------------1
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.1174397468566895  GigaBytes
Max Memory Allocated: 1.1174769401550293  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.1174397468566895  GigaBytes
Max Memory Allocated: 1.1174769401550293  GigaBytes

 h.shape torch.Size([1, 550, 100]), torch.Size([1, 550, 100])
----------------------------------------3
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.1178498268127441  GigaBytes
Max Memory Allocated: 1.1178498268127441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3983154296875 GB
    Memory Allocated: 1.135474681854248  GigaBytes
Max Memory Allocated: 1.1376137733459473  GigaBytes

rst.shape  torch.Size([1, 550, 100])
m.shape torch.Size([655, 7, 100])
----------------------------------------1
 Nvidia-smi: 2.3983154296875 GB
    Memory Allocated: 1.13740873336792  GigaBytes
Max Memory Allocated: 1.1376137733459473  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3983154296875 GB
    Memory Allocated: 1.13740873336792  GigaBytes
Max Memory Allocated: 1.1376137733459473  GigaBytes

 h.shape torch.Size([1, 655, 100]), torch.Size([1, 655, 100])
----------------------------------------3
 Nvidia-smi: 2.3983154296875 GB
    Memory Allocated: 1.13789701461792  GigaBytes
Max Memory Allocated: 1.13789701461792  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 1.1623010635375977  GigaBytes
Max Memory Allocated: 1.1640095710754395  GigaBytes

rst.shape  torch.Size([1, 655, 100])
m.shape torch.Size([512, 8, 100])
----------------------------------------1
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 1.1635828018188477  GigaBytes
Max Memory Allocated: 1.1640095710754395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 1.1635828018188477  GigaBytes
Max Memory Allocated: 1.1640095710754395  GigaBytes

 h.shape torch.Size([1, 512, 100]), torch.Size([1, 512, 100])
----------------------------------------3
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 1.1639642715454102  GigaBytes
Max Memory Allocated: 1.1640095710754395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.1857080459594727  GigaBytes
Max Memory Allocated: 1.1872339248657227  GigaBytes

rst.shape  torch.Size([1, 512, 100])
m.shape torch.Size([576, 9, 100])
----------------------------------------1
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.187448501586914  GigaBytes
Max Memory Allocated: 1.1875066757202148  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.187448501586914  GigaBytes
Max Memory Allocated: 1.1875066757202148  GigaBytes

 h.shape torch.Size([1, 576, 100]), torch.Size([1, 576, 100])
----------------------------------------3
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.1878776550292969  GigaBytes
Max Memory Allocated: 1.1878776550292969  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4725341796875 GB
    Memory Allocated: 1.2153434753417969  GigaBytes
Max Memory Allocated: 1.2172746658325195  GigaBytes

rst.shape  torch.Size([1, 576, 100])
m.shape torch.Size([192609, 10, 100])
----------------------------------------1
 Nvidia-smi: 3.1932373046875 GB
    Memory Allocated: 1.9326534271240234  GigaBytes
Max Memory Allocated: 1.9541797637939453  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1932373046875 GB
    Memory Allocated: 1.9326534271240234  GigaBytes
Max Memory Allocated: 1.9541797637939453  GigaBytes

 h.shape torch.Size([1, 192609, 100]), torch.Size([1, 192609, 100])
----------------------------------------3
 Nvidia-smi: 3.3377685546875 GB
    Memory Allocated: 2.0771846771240234  GigaBytes
Max Memory Allocated: 2.0771846771240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 12.280309677124023  GigaBytes
Max Memory Allocated: 12.997834205627441  GigaBytes

rst.shape  torch.Size([1, 192609, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 11.55052900314331  GigaBytes
Max Memory Allocated: 12.997834205627441  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 11.584946632385254  GigaBytes
Max Memory Allocated: 12.997834205627441  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 11.619364261627197  GigaBytes
Max Memory Allocated: 12.997834205627441  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 11.583481788635254  GigaBytes
Max Memory Allocated: 12.997834205627441  GigaBytes

torch.Size([196571, 47])
input nodes number: 848126
output nodes number: 196571
edges number: 1949041
 in-degree:  tensor([10, 10, 10,  ..., 10, 10, 10], device='cuda:0', dtype=torch.int32)
Counter({10: 192609, 7: 655, 9: 576, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 11.625683307647705  GigaBytes
Max Memory Allocated: 12.997834205627441  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 11.625684261322021  GigaBytes
Max Memory Allocated: 12.997834205627441  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 0.39052438735961914  GigaBytes
Max Memory Allocated: 12.997834205627441  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 0.39119958877563477  GigaBytes
Max Memory Allocated: 12.997834205627441  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 0.39119958877563477  GigaBytes
Max Memory Allocated: 12.997834205627441  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12038469314575195 |0.33484864234924316 |0.6115081310272217 |0.00021839141845703125 |0.023697853088378906 |0.003966808319091797 |
----------------------------------------------------------pseudo_mini_loss sum 4.790792942047119
Total (block generation + training)time/epoch 1.255453109741211
* Pure training time/epoch 1.0946245193481445
Training time/epoch 1.1631169319152832
Training time without block to device /epoch 0.82826828956604
Training time without total dataloading part /epoch 0.6393911838531494
load block tensor time/epoch 0.12038469314575195
block to device time/epoch 0.33484864234924316
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  848126
Number of first layer input nodes during this epoch:  848126
Number of first layer output nodes during this epoch:  196571
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=47, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  90200
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([47, 100])
layers.0.fc_neigh.weight, torch.Size([47, 100])
----------------------------------------
un-trainable parameters
