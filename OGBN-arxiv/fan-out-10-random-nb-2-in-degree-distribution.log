main start at this time 1653883063.3449357
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

<class 'int'>
----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026478052139282227
number of batches is  2
batch size is  45471
random selection method spend 0.006798505783081055
time for parepare:  0.017626523971557617
local_output_nid generation:  0.01610565185546875
local_in_edges_tensor generation:  0.014977693557739258
mini_batch_src_global generation:  0.007399797439575195
r_  generation:  0.11585545539855957
local_output_nid generation:  0.023424148559570312
local_in_edges_tensor generation:  0.01215052604675293
mini_batch_src_global generation:  0.010829448699951172
r_  generation:  0.12166118621826172
----------------------check_connections_block total spend ----------------------------- 0.3974902629852295
generate_one_block  0.1320803165435791
generate_one_block  0.13091158866882324
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
block dataloader generation time/epoch 0.7283751964569092
pseudo mini batch 0 input nodes size: 115349
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0740966796875 GB
    Memory Allocated: 0.05553293228149414  GigaBytes
Max Memory Allocated: 0.05553293228149414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0740966796875 GB
    Memory Allocated: 0.05587196350097656  GigaBytes
Max Memory Allocated: 0.05587196350097656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0740966796875 GB
    Memory Allocated: 0.05587196350097656  GigaBytes
Max Memory Allocated: 0.05587196350097656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.057784080505371094  GigaBytes
Max Memory Allocated: 0.057784080505371094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.057784080505371094  GigaBytes
Max Memory Allocated: 0.057784080505371094  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.057784080505371094  GigaBytes
Max Memory Allocated: 0.057784080505371094  GigaBytes

m.shape torch.Size([6709, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.18764305114746094  GigaBytes
Max Memory Allocated: 0.18803119659423828  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.18764305114746094  GigaBytes
Max Memory Allocated: 0.18803119659423828  GigaBytes

 h.shape torch.Size([1, 6709, 128]), torch.Size([1, 6709, 128])
----------------------------------------3
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.19404125213623047  GigaBytes
Max Memory Allocated: 0.19404125213623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.24785327911376953  GigaBytes
Max Memory Allocated: 0.2513890266418457  GigaBytes

rst.shape  torch.Size([1, 6709, 128])
m.shape torch.Size([5819, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.25020360946655273  GigaBytes
Max Memory Allocated: 0.2513890266418457  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.25020360946655273  GigaBytes
Max Memory Allocated: 0.2513890266418457  GigaBytes

 h.shape torch.Size([1, 5819, 128]), torch.Size([1, 5819, 128])
----------------------------------------3
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.25693845748901367  GigaBytes
Max Memory Allocated: 0.25693845748901367  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.3438992500305176  GigaBytes
Max Memory Allocated: 0.34944868087768555  GigaBytes

rst.shape  torch.Size([1, 5819, 128])
m.shape torch.Size([4628, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.3477449417114258  GigaBytes
Max Memory Allocated: 0.34944868087768555  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.3477449417114258  GigaBytes
Max Memory Allocated: 0.34944868087768555  GigaBytes

 h.shape torch.Size([1, 4628, 128]), torch.Size([1, 4628, 128])
----------------------------------------3
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.35283470153808594  GigaBytes
Max Memory Allocated: 0.35283470153808594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.4499340057373047  GigaBytes
Max Memory Allocated: 0.4565544128417969  GigaBytes

rst.shape  torch.Size([1, 4628, 128])
m.shape torch.Size([3719, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.4548206329345703  GigaBytes
Max Memory Allocated: 0.4565544128417969  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.4548206329345703  GigaBytes
Max Memory Allocated: 0.4565544128417969  GigaBytes

 h.shape torch.Size([1, 3719, 128]), torch.Size([1, 3719, 128])
----------------------------------------3
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.4585742950439453  GigaBytes
Max Memory Allocated: 0.4585742950439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.5620884895324707  GigaBytes
Max Memory Allocated: 0.5691819190979004  GigaBytes

rst.shape  torch.Size([1, 3719, 128])
m.shape torch.Size([3164, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.5678343772888184  GigaBytes
Max Memory Allocated: 0.5691819190979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.5678343772888184  GigaBytes
Max Memory Allocated: 0.5691819190979004  GigaBytes

 h.shape torch.Size([1, 3164, 128]), torch.Size([1, 3164, 128])
----------------------------------------3
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.5711760520935059  GigaBytes
Max Memory Allocated: 0.5711760520935059  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.683100700378418  GigaBytes
Max Memory Allocated: 0.6906442642211914  GigaBytes

rst.shape  torch.Size([1, 3164, 128])
m.shape torch.Size([2422, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.6890535354614258  GigaBytes
Max Memory Allocated: 0.6906442642211914  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.6890535354614258  GigaBytes
Max Memory Allocated: 0.6906442642211914  GigaBytes

 h.shape torch.Size([1, 2422, 128]), torch.Size([1, 2422, 128])
----------------------------------------3
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.6919069290161133  GigaBytes
Max Memory Allocated: 0.6919069290161133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.7930288314819336  GigaBytes
Max Memory Allocated: 0.7999582290649414  GigaBytes

rst.shape  torch.Size([1, 2422, 128])
m.shape torch.Size([2042, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.7986898422241211  GigaBytes
Max Memory Allocated: 0.7999582290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.7986898422241211  GigaBytes
Max Memory Allocated: 0.7999582290649414  GigaBytes

 h.shape torch.Size([1, 2042, 128]), torch.Size([1, 2042, 128])
----------------------------------------3
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.8006372451782227  GigaBytes
Max Memory Allocated: 0.8006372451782227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1072998046875 GB
    Memory Allocated: 0.8982362747192383  GigaBytes
Max Memory Allocated: 0.9050521850585938  GigaBytes

rst.shape  torch.Size([1, 2042, 128])
m.shape torch.Size([1701, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1072998046875 GB
    Memory Allocated: 0.9037513732910156  GigaBytes
Max Memory Allocated: 0.9050521850585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1072998046875 GB
    Memory Allocated: 0.9037513732910156  GigaBytes
Max Memory Allocated: 0.9050521850585938  GigaBytes

 h.shape torch.Size([1, 1701, 128]), torch.Size([1, 1701, 128])
----------------------------------------3
 Nvidia-smi: 2.1072998046875 GB
    Memory Allocated: 0.9053735733032227  GigaBytes
Max Memory Allocated: 0.9053735733032227  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2030029296875 GB
    Memory Allocated: 0.9980335235595703  GigaBytes
Max Memory Allocated: 1.004587173461914  GigaBytes

rst.shape  torch.Size([1, 1701, 128])
m.shape torch.Size([1462, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2030029296875 GB
    Memory Allocated: 1.0037760734558105  GigaBytes
Max Memory Allocated: 1.004587173461914  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2030029296875 GB
    Memory Allocated: 1.0037760734558105  GigaBytes
Max Memory Allocated: 1.004587173461914  GigaBytes

 h.shape torch.Size([1, 1462, 128]), torch.Size([1, 1462, 128])
----------------------------------------3
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 1.0051703453063965  GigaBytes
Max Memory Allocated: 1.0051703453063965  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 1.094438076019287  GigaBytes
Max Memory Allocated: 1.1007122993469238  GigaBytes

rst.shape  torch.Size([1, 1462, 128])
m.shape torch.Size([13805, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1601471900939941  GigaBytes
Max Memory Allocated: 1.1617145538330078  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1601471900939941  GigaBytes
Max Memory Allocated: 1.1617145538330078  GigaBytes

 h.shape torch.Size([1, 13805, 128]), torch.Size([1, 13805, 128])
----------------------------------------3
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1733126640319824  GigaBytes
Max Memory Allocated: 1.1733126640319824  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 2.1080613136291504  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

rst.shape  torch.Size([1, 13805, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 1.9984426498413086  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 2.005218505859375  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 2.0119943618774414  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 2.0048794746398926  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

torch.Size([45471, 40])
input nodes number: 115349
output nodes number: 45471
edges number: 256569
 in-degree:  tensor([ 5,  2, 10,  ...,  1,  1,  1], device='cuda:0', dtype=torch.int32)
Counter({10: 13805, 1: 6709, 2: 5819, 3: 4628, 4: 3719, 5: 3164, 6: 2422, 7: 2042, 8: 1701, 9: 1462})

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 2.0128540992736816  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 2.012855052947998  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.06837177276611328  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

pseudo mini batch 1 input nodes size: 115154
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.06317901611328125  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.06317901611328125  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.1180887222290039  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.11842775344848633  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.06308603286743164  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.06500005722045898  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.06500005722045898  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.06500005722045898  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

m.shape torch.Size([6719, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.19486522674560547  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.19486522674560547  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

 h.shape torch.Size([1, 6719, 128]), torch.Size([1, 6719, 128])
----------------------------------------3
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.20127296447753906  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.25510406494140625  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

rst.shape  torch.Size([1, 6719, 128])
m.shape torch.Size([5887, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.25751447677612305  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.25751447677612305  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

 h.shape torch.Size([1, 5887, 128]), torch.Size([1, 5887, 128])
----------------------------------------3
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.26352548599243164  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.3497004508972168  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

rst.shape  torch.Size([1, 5887, 128])
m.shape torch.Size([4649, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.353543758392334  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.353543758392334  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

 h.shape torch.Size([1, 4649, 128]), torch.Size([1, 4649, 128])
----------------------------------------3
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.3585515022277832  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.45609140396118164  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

rst.shape  torch.Size([1, 4649, 128])
m.shape torch.Size([3601, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.4607429504394531  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.4607429504394531  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

 h.shape torch.Size([1, 3601, 128]), torch.Size([1, 3601, 128])
----------------------------------------3
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.4643363952636719  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.5654773712158203  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

rst.shape  torch.Size([1, 3601, 128])
m.shape torch.Size([3058, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.5710511207580566  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.5710511207580566  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

 h.shape torch.Size([1, 3058, 128]), torch.Size([1, 3058, 128])
----------------------------------------3
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.5744204521179199  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.6831860542297363  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

rst.shape  torch.Size([1, 3058, 128])
m.shape torch.Size([2446, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.6887259483337402  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.6887259483337402  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

 h.shape torch.Size([1, 2446, 128]), torch.Size([1, 2446, 128])
----------------------------------------3
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.6916041374206543  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.7962584495544434  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

rst.shape  torch.Size([1, 2446, 128])
m.shape torch.Size([2003, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.8017778396606445  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.8017778396606445  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

 h.shape torch.Size([1, 2003, 128]), torch.Size([1, 2003, 128])
----------------------------------------3
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.8036880493164062  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.9004859924316406  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

rst.shape  torch.Size([1, 2003, 128])
m.shape torch.Size([1771, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.9062867164611816  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.9062867164611816  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

 h.shape torch.Size([1, 1771, 128]), torch.Size([1, 1771, 128])
----------------------------------------3
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 0.9079756736755371  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 1.0042462348937988  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

rst.shape  torch.Size([1, 1771, 128])
m.shape torch.Size([1514, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 1.0098991394042969  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 1.0098991394042969  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

 h.shape torch.Size([1, 1514, 128]), torch.Size([1, 1514, 128])
----------------------------------------3
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 1.011343002319336  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4901123046875 GB
    Memory Allocated: 1.103994369506836  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

rst.shape  torch.Size([1, 1514, 128])
m.shape torch.Size([13822, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.5565185546875 GB
    Memory Allocated: 1.1696786880493164  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5565185546875 GB
    Memory Allocated: 1.1696786880493164  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

 h.shape torch.Size([1, 13822, 128]), torch.Size([1, 13822, 128])
----------------------------------------3
 Nvidia-smi: 3.5565185546875 GB
    Memory Allocated: 1.1828603744506836  GigaBytes
Max Memory Allocated: 2.1744675636291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 2.118760108947754  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

rst.shape  torch.Size([1, 13822, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 2.0092673301696777  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 2.016043186187744  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 2.0228190422058105  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 2.0157041549682617  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

torch.Size([45470, 40])
input nodes number: 115154
output nodes number: 45470
edges number: 256845
 in-degree:  tensor([10,  2, 10,  ...,  3, 10,  3], device='cuda:0', dtype=torch.int32)
Counter({10: 13822, 1: 6719, 2: 5887, 3: 4649, 4: 3601, 5: 3058, 6: 2446, 7: 2003, 8: 1771, 9: 1514})

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 2.0169014930725098  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 2.016901969909668  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 0.06828117370605469  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 0.06934165954589844  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 0.06934165954589844  GigaBytes
Max Memory Allocated: 2.185166358947754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033675432205200195 |0.1692134141921997 |0.2798478603363037 |0.00016570091247558594 |0.017237067222595215 |0.0033440589904785156 |
----------------------------------------------------------pseudo_mini_loss sum 3.837982654571533
Total (block generation + training)time/epoch 1.7407572269439697
* Pure training time/epoch 1.0036230087280273
Training time/epoch 1.011533260345459
Training time without block to device /epoch 0.6731064319610596
Training time without total dataloading part /epoch 0.5978453159332275
load block tensor time/epoch 0.06735086441040039
block to device time/epoch 0.3384268283843994
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  230503
Number of first layer input nodes during this epoch:  230503
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (bns): ModuleList()
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
