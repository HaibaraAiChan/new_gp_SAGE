main start at this time 1655958146.2905781
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.22292399406433105
global_2_local spend time (sec) 0.3958706855773926
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.04893612861633301
A = g.adjacency_matrix() spent  0.07489347457885742
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5815794467926025
remove nodes length
1009015
auxiliary_graph.remove_nodes spent  2.7210075855255127
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.1257526874542236

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 51547889, 51547890, 51547891])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
Convert a graph into a bidirected graph: 2.861 seconds
Metis partitioning: 11.470 seconds
Split the graph: 2.912 seconds
Construct subgraphs: 0.393 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  17.657819509506226
50598
47710
47750
50513
total k batches seeds list generation spend  38.974634408950806
after graph partition
graph partition algorithm spend time 39.67667245864868
50598
47710
47750
50513
partition_len_list
[330111, 344895, 381134, 391624]
shared_neighbor_graph_partition_s0 selection method  spend 40.30602216720581
time for parepare:  0.23793578147888184
local_output_nid generation:  0.008500337600708008
local_in_edges_tensor generation:  0.012504816055297852
mini_batch_src_global generation:  0.039493560791015625
r_  generation:  0.47867703437805176
local_output_nid generation:  0.009139537811279297
local_in_edges_tensor generation:  0.023864269256591797
mini_batch_src_global generation:  0.04953646659851074
r_  generation:  0.4924280643463135
local_output_nid generation:  0.010146379470825195
local_in_edges_tensor generation:  0.02720022201538086
mini_batch_src_global generation:  0.041437387466430664
r_  generation:  0.6478736400604248
local_output_nid generation:  0.014635562896728516
local_in_edges_tensor generation:  0.04999518394470215
mini_batch_src_global generation:  0.051363229751586914
r_  generation:  0.7301125526428223
----------------------check_connections_block total spend ----------------------------- 3.3809592723846436
generate_one_block  2.072070360183716
generate_one_block  0.6149485111236572
generate_one_block  0.5953724384307861
generate_one_block  0.6691234111785889
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6712255477905273
gen group dst list time:  0.03975844383239746
time for parepare:  0.4287686347961426
local_output_nid generation:  0.07448887825012207
local_in_edges_tensor generation:  0.17744231224060059
mini_batch_src_global generation:  0.09452009201049805
r_  generation:  1.4702181816101074
local_output_nid generation:  0.09194755554199219
local_in_edges_tensor generation:  0.11009073257446289
mini_batch_src_global generation:  0.12918901443481445
r_  generation:  1.7406258583068848
local_output_nid generation:  0.12489676475524902
local_in_edges_tensor generation:  0.15685820579528809
mini_batch_src_global generation:  0.13503289222717285
r_  generation:  1.9455235004425049
local_output_nid generation:  0.09873104095458984
local_in_edges_tensor generation:  0.10683012008666992
mini_batch_src_global generation:  0.17911434173583984
r_  generation:  2.083568811416626
----------------------check_connections_block total spend ----------------------------- 10.510897397994995
generate_one_block  2.1708526611328125
generate_one_block  2.064635992050171
generate_one_block  2.3330628871917725
generate_one_block  2.3581695556640625
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  0
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  13.891856670379639
block generation total time  12.878235816955566
average batch blocks generation time:  1.6097794771194458
block dataloader generation time/epoch 69.05222225189209
pseudo mini batch 0 input nodes size: 699592
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.26316213607788086  GigaBytes
Max Memory Allocated: 0.26316213607788086  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.26353931427001953  GigaBytes
Max Memory Allocated: 0.26353931427001953  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.26353931427001953  GigaBytes
Max Memory Allocated: 0.26353931427001953  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.29611968994140625  GigaBytes
Max Memory Allocated: 0.29611968994140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.29611968994140625  GigaBytes
Max Memory Allocated: 0.29611968994140625  GigaBytes

first layer input nodes number: 699592
first layer output nodes number: 330111
edges number: 3148919
----------------------------------------before model layer 0
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.30379199981689453  GigaBytes
Max Memory Allocated: 0.3155226707458496  GigaBytes

torch.Size([699592, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.30379199981689453  GigaBytes
Max Memory Allocated: 0.3155226707458496  GigaBytes

m.shape torch.Size([1438, 1, 100])
----------------------------------------1
 Nvidia-smi: 2.7967529296875 GB
    Memory Allocated: 1.5136027336120605  GigaBytes
Max Memory Allocated: 1.561676025390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7967529296875 GB
    Memory Allocated: 1.5136027336120605  GigaBytes
Max Memory Allocated: 1.561676025390625  GigaBytes

 h.shape torch.Size([1, 1438, 100]), torch.Size([1, 1438, 100])
----------------------------------------3
 Nvidia-smi: 2.7967529296875 GB
    Memory Allocated: 1.5146746635437012  GigaBytes
Max Memory Allocated: 1.561676025390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.5238442420959473  GigaBytes
Max Memory Allocated: 1.561676025390625  GigaBytes

rst.shape  torch.Size([1, 1438, 100])
m.shape torch.Size([2225, 2, 100])
----------------------------------------1
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.5252494812011719  GigaBytes
Max Memory Allocated: 1.561676025390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.5252494812011719  GigaBytes
Max Memory Allocated: 1.561676025390625  GigaBytes

 h.shape torch.Size([1, 2225, 100]), torch.Size([1, 2225, 100])
----------------------------------------3
 Nvidia-smi: 2.8026123046875 GB
    Memory Allocated: 1.5269079208374023  GigaBytes
Max Memory Allocated: 1.561676025390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8084716796875 GB
    Memory Allocated: 1.551778793334961  GigaBytes
Max Memory Allocated: 1.561676025390625  GigaBytes

rst.shape  torch.Size([1, 2225, 100])
m.shape torch.Size([3162, 3, 100])
----------------------------------------1
 Nvidia-smi: 2.8084716796875 GB
    Memory Allocated: 1.554483413696289  GigaBytes
Max Memory Allocated: 1.561676025390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8084716796875 GB
    Memory Allocated: 1.554483413696289  GigaBytes
Max Memory Allocated: 1.561676025390625  GigaBytes

 h.shape torch.Size([1, 3162, 100]), torch.Size([1, 3162, 100])
----------------------------------------3
 Nvidia-smi: 2.8084716796875 GB
    Memory Allocated: 1.5583858489990234  GigaBytes
Max Memory Allocated: 1.561676025390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8475341796875 GB
    Memory Allocated: 1.612264633178711  GigaBytes
Max Memory Allocated: 1.6157984733581543  GigaBytes

rst.shape  torch.Size([1, 3162, 100])
m.shape torch.Size([3987, 4, 100])
----------------------------------------1
 Nvidia-smi: 2.8475341796875 GB
    Memory Allocated: 1.6163458824157715  GigaBytes
Max Memory Allocated: 1.6165246963500977  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8475341796875 GB
    Memory Allocated: 1.6163458824157715  GigaBytes
Max Memory Allocated: 1.6165246963500977  GigaBytes

 h.shape torch.Size([1, 3987, 100]), torch.Size([1, 3987, 100])
----------------------------------------3
 Nvidia-smi: 2.8475341796875 GB
    Memory Allocated: 1.6196913719177246  GigaBytes
Max Memory Allocated: 1.6196913719177246  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.707291603088379  GigaBytes
Max Memory Allocated: 1.7132329940795898  GigaBytes

rst.shape  torch.Size([1, 3987, 100])
m.shape torch.Size([4687, 5, 100])
----------------------------------------1
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.714940071105957  GigaBytes
Max Memory Allocated: 1.715202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.714940071105957  GigaBytes
Max Memory Allocated: 1.715202808380127  GigaBytes

 h.shape torch.Size([1, 4687, 100]), torch.Size([1, 4687, 100])
----------------------------------------3
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.7184324264526367  GigaBytes
Max Memory Allocated: 1.7184324264526367  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1014404296875 GB
    Memory Allocated: 1.845564842224121  GigaBytes
Max Memory Allocated: 1.854295253753662  GigaBytes

rst.shape  torch.Size([1, 4687, 100])
m.shape torch.Size([5087, 6, 100])
----------------------------------------1
 Nvidia-smi: 3.1131591796875 GB
    Memory Allocated: 1.8552131652832031  GigaBytes
Max Memory Allocated: 1.8555545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1131591796875 GB
    Memory Allocated: 1.8552131652832031  GigaBytes
Max Memory Allocated: 1.8555545806884766  GigaBytes

 h.shape torch.Size([1, 5087, 100]), torch.Size([1, 5087, 100])
----------------------------------------3
 Nvidia-smi: 3.1131591796875 GB
    Memory Allocated: 1.859354019165039  GigaBytes
Max Memory Allocated: 1.859354019165039  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2889404296875 GB
    Memory Allocated: 2.0263938903808594  GigaBytes
Max Memory Allocated: 2.0383448600769043  GigaBytes

rst.shape  torch.Size([1, 5087, 100])
m.shape torch.Size([5289, 7, 100])
----------------------------------------1
 Nvidia-smi: 3.3045654296875 GB
    Memory Allocated: 2.0382909774780273  GigaBytes
Max Memory Allocated: 2.038705348968506  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3045654296875 GB
    Memory Allocated: 2.0382909774780273  GigaBytes
Max Memory Allocated: 2.038705348968506  GigaBytes

 h.shape torch.Size([1, 5289, 100]), torch.Size([1, 5289, 100])
----------------------------------------3
 Nvidia-smi: 3.3045654296875 GB
    Memory Allocated: 2.042661666870117  GigaBytes
Max Memory Allocated: 2.042661666870117  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5155029296875 GB
    Memory Allocated: 2.2398362159729004  GigaBytes
Max Memory Allocated: 2.253628730773926  GigaBytes

rst.shape  torch.Size([1, 5289, 100])
m.shape torch.Size([5299, 8, 100])
----------------------------------------1
 Nvidia-smi: 3.5330810546875 GB
    Memory Allocated: 2.253657817840576  GigaBytes
Max Memory Allocated: 2.2541322708129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5330810546875 GB
    Memory Allocated: 2.253657817840576  GigaBytes
Max Memory Allocated: 2.2541322708129883  GigaBytes

 h.shape torch.Size([1, 5299, 100]), torch.Size([1, 5299, 100])
----------------------------------------3
 Nvidia-smi: 3.5330810546875 GB
    Memory Allocated: 2.257606029510498  GigaBytes
Max Memory Allocated: 2.257606029510498  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 2.482654094696045  GigaBytes
Max Memory Allocated: 2.498446464538574  GigaBytes

rst.shape  torch.Size([1, 5299, 100])
m.shape torch.Size([5145, 9, 100])
----------------------------------------1
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 2.498258113861084  GigaBytes
Max Memory Allocated: 2.4987759590148926  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 2.498258113861084  GigaBytes
Max Memory Allocated: 2.4987759590148926  GigaBytes

 h.shape torch.Size([1, 5145, 100]), torch.Size([1, 5145, 100])
----------------------------------------3
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 2.5022029876708984  GigaBytes
Max Memory Allocated: 2.5022029876708984  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0565185546875 GB
    Memory Allocated: 2.751204490661621  GigaBytes
Max Memory Allocated: 2.768782615661621  GigaBytes

rst.shape  torch.Size([1, 5145, 100])
m.shape torch.Size([293792, 10, 100])
----------------------------------------1
 Nvidia-smi: 5.2108154296875 GB
    Memory Allocated: 3.843748092651367  GigaBytes
Max Memory Allocated: 3.8773560523986816  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2108154296875 GB
    Memory Allocated: 3.843748092651367  GigaBytes
Max Memory Allocated: 3.8773560523986816  GigaBytes

 h.shape torch.Size([1, 293792, 100]), torch.Size([1, 293792, 100])
----------------------------------------3
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 4.062640190124512  GigaBytes
Max Memory Allocated: 4.062640190124512  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1619873046875 GB
    Memory Allocated: 19.603979110717773  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 293792, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1619873046875 GB
    Memory Allocated: 18.43515157699585  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1619873046875 GB
    Memory Allocated: 18.749969959259033  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1619873046875 GB
    Memory Allocated: 19.064788341522217  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1619873046875 GB
    Memory Allocated: 18.749969959259033  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

torch.Size([330111, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1619873046875 GB
    Memory Allocated: 19.064788341522217  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1619873046875 GB
    Memory Allocated: 19.143493175506592  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1619873046875 GB
    Memory Allocated: 19.143493175506592  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

m.shape torch.Size([47, 1, 256])
----------------------------------------1
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 20.322529792785645  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 20.322529792785645  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 20.322619438171387  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 20.323336601257324  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([62, 2, 256])
----------------------------------------1
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 20.323410987854004  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 20.323410987854004  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 20.32352924346924  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 20.325303077697754  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([83, 3, 256])
----------------------------------------1
 Nvidia-smi: 23.3319091796875 GB
    Memory Allocated: 20.325483322143555  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.3319091796875 GB
    Memory Allocated: 20.325483322143555  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 23.3319091796875 GB
    Memory Allocated: 20.325641632080078  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.329124450683594  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([114, 4, 256])
----------------------------------------1
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.32948398590088  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.32948398590088  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 23.3358154296875 GB
    Memory Allocated: 20.32970142364502  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.3416748046875 GB
    Memory Allocated: 20.336007118225098  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([133, 5, 256])
----------------------------------------1
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.336537837982178  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.336537837982178  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 23.3436279296875 GB
    Memory Allocated: 20.336791515350342  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 20.345923900604248  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([144, 6, 256])
----------------------------------------1
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 20.346627712249756  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 20.346627712249756  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 23.3533935546875 GB
    Memory Allocated: 20.34690237045288  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.358712673187256  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([160, 7, 256])
----------------------------------------1
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.359683990478516  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.359683990478516  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.359989166259766  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.3826904296875 GB
    Memory Allocated: 20.375247955322266  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([145, 8, 256])
----------------------------------------1
 Nvidia-smi: 23.3826904296875 GB
    Memory Allocated: 20.376282691955566  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.3826904296875 GB
    Memory Allocated: 20.376282691955566  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 23.3826904296875 GB
    Memory Allocated: 20.376559257507324  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.3983154296875 GB
    Memory Allocated: 20.39232349395752  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([149, 9, 256])
----------------------------------------1
 Nvidia-smi: 23.3983154296875 GB
    Memory Allocated: 20.393680572509766  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.3983154296875 GB
    Memory Allocated: 20.393680572509766  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 23.3983154296875 GB
    Memory Allocated: 20.393964767456055  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.412153244018555  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([168, 10, 256])
----------------------------------------1
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.413638591766357  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.413638591766357  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 23.4178466796875 GB
    Memory Allocated: 20.41395902633667  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.4412841796875 GB
    Memory Allocated: 20.436709880828857  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([188, 11, 256])
----------------------------------------1
 Nvidia-smi: 23.4412841796875 GB
    Memory Allocated: 20.438539505004883  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.4412841796875 GB
    Memory Allocated: 20.438539505004883  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 23.4412841796875 GB
    Memory Allocated: 20.43889808654785  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.4725341796875 GB
    Memory Allocated: 20.466867446899414  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([162, 12, 256])
----------------------------------------1
 Nvidia-smi: 23.4725341796875 GB
    Memory Allocated: 20.46858501434326  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.4725341796875 GB
    Memory Allocated: 20.46858501434326  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 23.4725341796875 GB
    Memory Allocated: 20.468894004821777  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 20.495158195495605  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([193, 13, 256])
----------------------------------------1
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 20.4976224899292  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 20.4976224899292  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 23.4979248046875 GB
    Memory Allocated: 20.497990608215332  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 20.53185749053955  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([190, 14, 256])
----------------------------------------1
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 20.534589767456055  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 20.534589767456055  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 23.5350341796875 GB
    Memory Allocated: 20.53495216369629  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.570829391479492  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([168, 15, 256])
----------------------------------------1
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.573070526123047  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.573070526123047  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 23.5760498046875 GB
    Memory Allocated: 20.57339096069336  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 20.607357025146484  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([182, 16, 256])
----------------------------------------1
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 20.60999584197998  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 20.60999584197998  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 23.6053466796875 GB
    Memory Allocated: 20.610342979431152  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.649569511413574  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([174, 17, 256])
----------------------------------------1
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.652239322662354  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.652239322662354  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 20.652571201324463  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.4158935546875 GB
    Memory Allocated: 20.692396640777588  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([160, 18, 256])
----------------------------------------1
 Nvidia-smi: 23.4158935546875 GB
    Memory Allocated: 20.694998741149902  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.4158935546875 GB
    Memory Allocated: 20.694998741149902  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 23.4158935546875 GB
    Memory Allocated: 20.695303916931152  GigaBytes
Max Memory Allocated: 20.698439598083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.4393310546875 GB
    Memory Allocated: 20.734061241149902  GigaBytes
Max Memory Allocated: 20.736807823181152  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([172, 19, 256])
----------------------------------------1
 Nvidia-smi: 23.4393310546875 GB
    Memory Allocated: 20.73705005645752  GigaBytes
Max Memory Allocated: 20.737062454223633  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.4393310546875 GB
    Memory Allocated: 20.73705005645752  GigaBytes
Max Memory Allocated: 20.737062454223633  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 23.4412841796875 GB
    Memory Allocated: 20.737378120422363  GigaBytes
Max Memory Allocated: 20.737378120422363  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 20.781338691711426  GigaBytes
Max Memory Allocated: 20.78445529937744  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([167, 20, 256])
----------------------------------------1
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 20.784385204315186  GigaBytes
Max Memory Allocated: 20.78445529937744  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 20.784385204315186  GigaBytes
Max Memory Allocated: 20.78445529937744  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 23.4959716796875 GB
    Memory Allocated: 20.784703731536865  GigaBytes
Max Memory Allocated: 20.784703731536865  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 20.8296160697937  GigaBytes
Max Memory Allocated: 20.832801342010498  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([168, 21, 256])
----------------------------------------1
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 20.832848072052002  GigaBytes
Max Memory Allocated: 20.83286142349243  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 20.832848072052002  GigaBytes
Max Memory Allocated: 20.83286142349243  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 20.833168506622314  GigaBytes
Max Memory Allocated: 20.833168506622314  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 20.880592823028564  GigaBytes
Max Memory Allocated: 20.883957386016846  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([190, 22, 256])
----------------------------------------1
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 20.884450435638428  GigaBytes
Max Memory Allocated: 20.88446617126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 20.884450435638428  GigaBytes
Max Memory Allocated: 20.88446617126465  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 23.5819091796875 GB
    Memory Allocated: 20.884812831878662  GigaBytes
Max Memory Allocated: 20.884812831878662  GigaBytes

