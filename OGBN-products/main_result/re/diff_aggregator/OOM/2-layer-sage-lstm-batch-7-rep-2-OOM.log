main start at this time 1656023513.4060335
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.33507680892944336
global_2_local spend time (sec) 0.4114232063293457
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.05303621292114258
A = g.adjacency_matrix() spent  0.07994723320007324
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6108477115631104
remove nodes length  1009015

auxiliary_graph.remove_nodes spent  2.974609375
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.4074480533599854

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
Convert a graph into a bidirected graph: 3.223 seconds
Metis partitioning: 12.830 seconds
Split the graph: 2.019 seconds
Construct subgraphs: 0.395 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  18.49183940887451
28894
27815
27348
28925
27353
28700
27536
total k batches seeds list generation spend  34.83945274353027
after graph partition
graph partition algorithm spend time 35.48476243019104
28894
27815
27348
28925
27353
28700
27536
partition_len_list
[235934, 228824, 227464, 204779, 187732, 227635, 228408]
REG selection method  spend 36.13784146308899
time for parepare:  0.24120116233825684
local_output_nid generation:  0.006386518478393555
local_in_edges_tensor generation:  0.008588314056396484
mini_batch_src_global generation:  0.022260189056396484
r_  generation:  0.2653946876525879
local_output_nid generation:  0.008531332015991211
local_in_edges_tensor generation:  0.015973567962646484
mini_batch_src_global generation:  0.028109312057495117
r_  generation:  0.2848389148712158
local_output_nid generation:  0.008321285247802734
local_in_edges_tensor generation:  0.00992584228515625
mini_batch_src_global generation:  0.022081613540649414
r_  generation:  0.2657029628753662
local_output_nid generation:  0.007544040679931641
local_in_edges_tensor generation:  0.008391380310058594
mini_batch_src_global generation:  0.025966405868530273
r_  generation:  0.308474063873291
local_output_nid generation:  0.007247447967529297
local_in_edges_tensor generation:  0.008166790008544922
mini_batch_src_global generation:  0.02668619155883789
r_  generation:  0.2880895137786865
local_output_nid generation:  0.007510662078857422
local_in_edges_tensor generation:  0.010277271270751953
mini_batch_src_global generation:  0.030211925506591797
r_  generation:  0.33199357986450195
local_output_nid generation:  0.0072324275970458984
local_in_edges_tensor generation:  0.008148908615112305
mini_batch_src_global generation:  0.030312538146972656
r_  generation:  0.3183252811431885
----------------------check_connections_block total spend ----------------------------- 3.030320882797241
generate_one_block  1.7894225120544434
generate_one_block  0.3462193012237549
generate_one_block  0.3115253448486328
generate_one_block  0.3534281253814697
generate_one_block  0.3202943801879883
generate_one_block  0.3625481128692627
generate_one_block  0.3504495620727539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7342782020568848
gen group dst list time:  0.041532039642333984
time for parepare:  0.41155529022216797
local_output_nid generation:  0.04871702194213867
local_in_edges_tensor generation:  0.13661789894104004
mini_batch_src_global generation:  0.07597160339355469
r_  generation:  1.0016720294952393
local_output_nid generation:  0.05616331100463867
local_in_edges_tensor generation:  0.07825088500976562
mini_batch_src_global generation:  0.08440923690795898
r_  generation:  1.018345594406128
local_output_nid generation:  0.059865713119506836
local_in_edges_tensor generation:  0.07734370231628418
mini_batch_src_global generation:  0.08130669593811035
r_  generation:  1.0817842483520508
local_output_nid generation:  0.05056166648864746
local_in_edges_tensor generation:  0.05389666557312012
mini_batch_src_global generation:  0.08109068870544434
r_  generation:  0.9406468868255615
local_output_nid generation:  0.04609346389770508
local_in_edges_tensor generation:  0.11561322212219238
mini_batch_src_global generation:  0.0738687515258789
r_  generation:  0.8856544494628906
local_output_nid generation:  0.0559537410736084
local_in_edges_tensor generation:  0.07861709594726562
mini_batch_src_global generation:  0.09436225891113281
r_  generation:  1.0942621231079102
local_output_nid generation:  0.058325767517089844
local_in_edges_tensor generation:  0.05994057655334473
mini_batch_src_global generation:  0.09143972396850586
r_  generation:  1.1223137378692627
----------------------check_connections_block total spend ----------------------------- 10.503118515014648
generate_one_block  1.5891826152801514
generate_one_block  1.3556058406829834
generate_one_block  1.3138623237609863
generate_one_block  1.0301125049591064
generate_one_block  0.9879491329193115
generate_one_block  1.266620397567749
generate_one_block  1.3936412334442139
global_2_local spend time (sec) 0.05970025062561035
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.005882740020751953
A = g.adjacency_matrix() spent  0.00654149055480957
auxiliary_graph
Graph(num_nodes=227464, num_edges=7867336,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.11423969268798828
remove nodes length  200116

auxiliary_graph.remove_nodes spent  0.3389463424682617
after remove non output nodes the auxiliary_graph
Graph(num_nodes=27348, num_edges=7867336,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.33042335510253906

the counter of shared neighbor distribution
Counter({1.0: 5307120, 2.0: 1233816, 3.0: 518262, 4.0: 281458, 5.0: 171834, 6.0: 105670, 7.0: 69408, 8.0: 43534, 9.0: 29142, 10.0: 19306, 11.0: 12796, 12.0: 8338, 13.0: 5980, 15.0: 5442, 14.0: 5398, 18.0: 3688, 16.0: 3416, 20.0: 2788, 17.0: 2526, 19.0: 2360, 22.0: 1826, 23.0: 1798, 21.0: 1592, 24.0: 1582, 25.0: 908})
7839988
Convert a graph into a bidirected graph: 0.234 seconds
Metis partitioning: 0.824 seconds
Split the graph: 0.537 seconds
Construct subgraphs: 0.027 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  1.6259264945983887
13352
13996
total k batches seeds list generation spend  3.832714319229126
after graph partition
graph partition algorithm spend time 3.904862880706787
13352
13996
time for parepare:  0.2862417697906494
local_output_nid generation:  0.004526615142822266
local_in_edges_tensor generation:  0.027279376983642578
mini_batch_src_global generation:  0.010433197021484375
r_  generation:  0.10074520111083984
local_output_nid generation:  0.0052852630615234375
local_in_edges_tensor generation:  0.010535240173339844
mini_batch_src_global generation:  0.013097524642944336
r_  generation:  0.1191856861114502
----------------------check_connections_block total spend ----------------------------- 0.6636497974395752
generate_one_block  0.1484055519104004
generate_one_block  0.17013120651245117
time for parepare:  0.4063606262207031
local_output_nid generation:  0.028043746948242188
local_in_edges_tensor generation:  0.03171253204345703
mini_batch_src_global generation:  0.0323028564453125
r_  generation:  0.4617435932159424
local_output_nid generation:  0.037950754165649414
local_in_edges_tensor generation:  0.07294821739196777
mini_batch_src_global generation:  0.05143165588378906
r_  generation:  0.6379382610321045
----------------------check_connections_block total spend ----------------------------- 2.063398599624634
generate_one_block  0.9196164608001709
generate_one_block  0.8104631900787354
global_2_local spend time (sec) 0.06299948692321777
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.006234645843505859
A = g.adjacency_matrix() spent  0.007421731948852539
auxiliary_graph
Graph(num_nodes=228408, num_edges=3962712,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.11892127990722656
remove nodes length  200872

auxiliary_graph.remove_nodes spent  0.16739535331726074
after remove non output nodes the auxiliary_graph
Graph(num_nodes=27536, num_edges=3962712,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.16064143180847168

the counter of shared neighbor distribution
Counter({1.0: 3185096, 2.0: 528426, 3.0: 139494, 4.0: 46676, 5.0: 18712, 6.0: 8162, 7.0: 3790, 8.0: 2056, 9.0: 964, 10.0: 642, 11.0: 396, 12.0: 254, 13.0: 170, 14.0: 100, 15.0: 68, 16.0: 60, 17.0: 56, 18.0: 28, 22.0: 8, 20.0: 8, 19.0: 6, 21.0: 2, 23.0: 2})
3935176
Convert a graph into a bidirected graph: 0.116 seconds
Metis partitioning: 0.480 seconds
Split the graph: 0.295 seconds
Construct subgraphs: 0.050 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.9465935230255127
14144
13392
total k batches seeds list generation spend  2.2982046604156494
after graph partition
graph partition algorithm spend time 2.368927001953125
14144
13392
time for parepare:  0.2610499858856201
local_output_nid generation:  0.0036170482635498047
local_in_edges_tensor generation:  0.02586674690246582
mini_batch_src_global generation:  0.014189481735229492
r_  generation:  0.12521076202392578
local_output_nid generation:  0.004114866256713867
local_in_edges_tensor generation:  0.008829355239868164
mini_batch_src_global generation:  0.013781547546386719
r_  generation:  0.12604117393493652
----------------------check_connections_block total spend ----------------------------- 0.6666579246520996
generate_one_block  0.3640737533569336
generate_one_block  0.24457740783691406
time for parepare:  0.39522528648376465
local_output_nid generation:  0.031182527542114258
local_in_edges_tensor generation:  0.075408935546875
mini_batch_src_global generation:  0.03813958168029785
r_  generation:  0.527724027633667
local_output_nid generation:  0.03153228759765625
local_in_edges_tensor generation:  0.043762922286987305
mini_batch_src_global generation:  0.04436612129211426
r_  generation:  0.4756793975830078
----------------------check_connections_block total spend ----------------------------- 1.9313650131225586
generate_one_block  0.7913718223571777
generate_one_block  0.7919309139251709
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  7
re graph partition time:  2.4674789905548096

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  16.131462335586548
block generation total time  14.962815284729004
average batch blocks generation time:  0.831267515818278
block dataloader generation time/epoch 80.82646560668945
pseudo mini batch 0 input nodes size: 572304
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.2157435417175293  GigaBytes
Max Memory Allocated: 0.2157435417175293  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.2159590721130371  GigaBytes
Max Memory Allocated: 0.2159590721130371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.2159590721130371  GigaBytes
Max Memory Allocated: 0.2159590721130371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.23839902877807617  GigaBytes
Max Memory Allocated: 0.23839902877807617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.23839902877807617  GigaBytes
Max Memory Allocated: 0.23839902877807617  GigaBytes

first layer input nodes number: 572304
first layer output nodes number: 235934
edges number: 2308306
torch.Size([572304, 100])
torch.Size([235934, 256])
