main start at this time 1656022876.8334727
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.216902494430542
global_2_local spend time (sec) 0.3849008083343506
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.048642635345458984
A = g.adjacency_matrix() spent  0.0742030143737793
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5873658657073975
remove nodes length  1009015

auxiliary_graph.remove_nodes spent  2.6792099475860596
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.065969467163086

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
Convert a graph into a bidirected graph: 2.895 seconds
Metis partitioning: 11.565 seconds
Split the graph: 6.448 seconds
Construct subgraphs: 0.086 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  21.026987552642822
99885
96686
total k batches seeds list generation spend  36.54492139816284
after graph partition
graph partition algorithm spend time 37.311131715774536
99885
96686
partition_len_list
[677235, 607702]
REG selection method  spend 37.93542003631592
time for parepare:  0.24126935005187988
local_output_nid generation:  0.013206005096435547
local_in_edges_tensor generation:  0.028912067413330078
mini_batch_src_global generation:  0.0764620304107666
r_  generation:  1.1036818027496338
local_output_nid generation:  0.017271757125854492
local_in_edges_tensor generation:  0.061388492584228516
mini_batch_src_global generation:  0.11604523658752441
r_  generation:  1.1747157573699951
----------------------check_connections_block total spend ----------------------------- 3.2895684242248535
generate_one_block  2.890315294265747
generate_one_block  1.3736608028411865
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7474594116210938
gen group dst list time:  0.0371859073638916
time for parepare:  0.3978757858276367
local_output_nid generation:  0.10244607925415039
local_in_edges_tensor generation:  0.23721647262573242
mini_batch_src_global generation:  0.21145868301391602
r_  generation:  3.3840417861938477
local_output_nid generation:  0.14526629447937012
local_in_edges_tensor generation:  0.20662379264831543
mini_batch_src_global generation:  0.2429065704345703
r_  generation:  3.127169370651245
----------------------check_connections_block total spend ----------------------------- 9.226553201675415
generate_one_block  4.692902088165283
generate_one_block  4.217421054840088
global_2_local spend time (sec) 0.21330904960632324
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.019178390502929688
A = g.adjacency_matrix() spent  0.04017329216003418
auxiliary_graph
Graph(num_nodes=677235, num_edges=27039053,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.3464038372039795
remove nodes length  577350

auxiliary_graph.remove_nodes spent  1.341984748840332
after remove non output nodes the auxiliary_graph
Graph(num_nodes=99885, num_edges=27039053,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.0917372703552246

the counter of shared neighbor distribution
Counter({1.0: 21554316, 2.0: 3177090, 3.0: 1047172, 4.0: 481738, 5.0: 259580, 6.0: 147950, 7.0: 91136, 8.0: 54842, 9.0: 35396, 10.0: 22730, 11.0: 14782, 12.0: 9680, 13.0: 6936, 14.0: 6144, 15.0: 5920, 18.0: 3918, 16.0: 3726, 20.0: 2842, 17.0: 2748, 19.0: 2640, 22.0: 1892, 23.0: 1834, 24.0: 1622, 21.0: 1616, 25.0: 918})
26939168
Convert a graph into a bidirected graph: 1.148 seconds
Metis partitioning: 5.858 seconds
Split the graph: 2.646 seconds
Construct subgraphs: 0.021 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.685229063034058
51182
48703
total k batches seeds list generation spend  17.707653045654297
after graph partition
graph partition algorithm spend time 18.066344738006592
51182
48703
time for parepare:  0.24674105644226074
local_output_nid generation:  0.008313894271850586
local_in_edges_tensor generation:  0.04763078689575195
mini_batch_src_global generation:  0.041367530822753906
r_  generation:  0.5195410251617432
local_output_nid generation:  0.00915384292602539
local_in_edges_tensor generation:  0.018265485763549805
mini_batch_src_global generation:  0.05058693885803223
r_  generation:  0.5674889087677002
----------------------check_connections_block total spend ----------------------------- 1.743471622467041
generate_one_block  1.0195133686065674
generate_one_block  0.6745240688323975
time for parepare:  0.41110849380493164
local_output_nid generation:  0.07460308074951172
local_in_edges_tensor generation:  0.1916797161102295
mini_batch_src_global generation:  0.12181282043457031
r_  generation:  1.8221962451934814
local_output_nid generation:  0.10955023765563965
local_in_edges_tensor generation:  0.16113662719726562
mini_batch_src_global generation:  0.15239381790161133
r_  generation:  1.9456522464752197
----------------------check_connections_block total spend ----------------------------- 5.7682044506073
generate_one_block  2.709648609161377
generate_one_block  2.6849050521850586
global_2_local spend time (sec) 0.18959331512451172
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.019263744354248047
A = g.adjacency_matrix() spent  0.02665257453918457
auxiliary_graph
Graph(num_nodes=607702, num_edges=22787378,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.3101375102996826
remove nodes length  511016

auxiliary_graph.remove_nodes spent  1.197528600692749
after remove non output nodes the auxiliary_graph
Graph(num_nodes=96686, num_edges=22787378,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.9348433017730713

the counter of shared neighbor distribution
Counter({1.0: 19241668, 2.0: 2499316, 3.0: 615886, 4.0: 197874, 5.0: 74398, 6.0: 31216, 7.0: 14062, 8.0: 6946, 9.0: 3836, 10.0: 2040, 11.0: 1250, 12.0: 706, 13.0: 470, 14.0: 328, 15.0: 188, 16.0: 148, 17.0: 144, 19.0: 72, 18.0: 56, 25.0: 30, 20.0: 22, 22.0: 16, 21.0: 14, 23.0: 4, 24.0: 2})
22690692
Convert a graph into a bidirected graph: 0.968 seconds
Metis partitioning: 5.198 seconds
Split the graph: 2.108 seconds
Construct subgraphs: 0.047 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.331923007965088
49729
46957
total k batches seeds list generation spend  15.207603931427002
after graph partition
graph partition algorithm spend time 15.56669569015503
49729
46957
time for parepare:  0.25171756744384766
local_output_nid generation:  0.008230447769165039
local_in_edges_tensor generation:  0.0272979736328125
mini_batch_src_global generation:  0.03952193260192871
r_  generation:  0.4658374786376953
local_output_nid generation:  0.008927106857299805
local_in_edges_tensor generation:  0.021429061889648438
mini_batch_src_global generation:  0.0479435920715332
r_  generation:  0.4769163131713867
----------------------check_connections_block total spend ----------------------------- 1.5615863800048828
generate_one_block  0.916832685470581
generate_one_block  0.6753425598144531
time for parepare:  0.40291595458984375
local_output_nid generation:  0.06182265281677246
local_in_edges_tensor generation:  0.12259125709533691
mini_batch_src_global generation:  0.09897279739379883
r_  generation:  1.420414686203003
local_output_nid generation:  0.09323978424072266
local_in_edges_tensor generation:  0.1458902359008789
mini_batch_src_global generation:  0.1262505054473877
r_  generation:  1.6069786548614502
----------------------check_connections_block total spend ----------------------------- 4.717067718505859
generate_one_block  2.1314573287963867
generate_one_block  1.9651808738708496
global_2_local spend time (sec) 0.11848115921020508
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.010149955749511719
A = g.adjacency_matrix() spent  0.012557268142700195
auxiliary_graph
Graph(num_nodes=391068, num_edges=11909549,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.19265294075012207
remove nodes length  342365

auxiliary_graph.remove_nodes spent  0.7090418338775635
after remove non output nodes the auxiliary_graph
Graph(num_nodes=48703, num_edges=11909549,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.48454833030700684

the counter of shared neighbor distribution
Counter({1.0: 8744334, 2.0: 1658792, 3.0: 620512, 4.0: 313594, 5.0: 184212, 6.0: 111238, 7.0: 72010, 8.0: 44846, 9.0: 29886, 10.0: 19532, 11.0: 13102, 12.0: 8600, 13.0: 6168, 14.0: 5588, 15.0: 5580, 18.0: 3746, 16.0: 3522, 20.0: 2800, 17.0: 2606, 19.0: 2394, 22.0: 1850, 23.0: 1812, 24.0: 1612, 21.0: 1598, 25.0: 912})
11860846
Convert a graph into a bidirected graph: 0.420 seconds
Metis partitioning: 1.828 seconds
Split the graph: 1.176 seconds
Construct subgraphs: 0.034 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  3.464524030685425
23702
25001
total k batches seeds list generation spend  7.215260744094849
after graph partition
graph partition algorithm spend time 7.353303909301758
23702
25001
time for parepare:  0.24524998664855957
local_output_nid generation:  0.005023002624511719
local_in_edges_tensor generation:  0.023088693618774414
mini_batch_src_global generation:  0.020125627517700195
r_  generation:  0.21942830085754395
local_output_nid generation:  0.007137775421142578
local_in_edges_tensor generation:  0.010587930679321289
mini_batch_src_global generation:  0.02544689178466797
r_  generation:  0.26797986030578613
----------------------check_connections_block total spend ----------------------------- 0.994718074798584
generate_one_block  0.5071742534637451
generate_one_block  0.4187312126159668
time for parepare:  0.38983607292175293
local_output_nid generation:  0.04752159118652344
local_in_edges_tensor generation:  0.08554863929748535
mini_batch_src_global generation:  0.06043720245361328
r_  generation:  0.8547263145446777
local_output_nid generation:  0.06163597106933594
local_in_edges_tensor generation:  0.0834815502166748
mini_batch_src_global generation:  0.0943143367767334
r_  generation:  1.1002681255340576
----------------------check_connections_block total spend ----------------------------- 3.2456181049346924
generate_one_block  1.5139286518096924
generate_one_block  1.395287275314331
global_2_local spend time (sec) 0.12769770622253418
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.010607004165649414
A = g.adjacency_matrix() spent  0.012469291687011719
auxiliary_graph
Graph(num_nodes=381164, num_edges=12637212,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.19467639923095703
remove nodes length  329982

auxiliary_graph.remove_nodes spent  0.6170454025268555
after remove non output nodes the auxiliary_graph
Graph(num_nodes=51182, num_edges=12637212,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.5097637176513672

the counter of shared neighbor distribution
Counter({1.0: 10499136, 2.0: 1390942, 3.0: 396120, 4.0: 155776, 5.0: 70140, 6.0: 34094, 7.0: 17684, 8.0: 9288, 9.0: 5076, 10.0: 2912, 11.0: 1518, 12.0: 954, 13.0: 688, 14.0: 520, 15.0: 304, 19.0: 244, 16.0: 196, 18.0: 166, 17.0: 134, 20.0: 42, 22.0: 40, 23.0: 22, 21.0: 18, 24.0: 10, 25.0: 6})
12586030
Convert a graph into a bidirected graph: 0.469 seconds
Metis partitioning: 2.601 seconds
Split the graph: 1.086 seconds
Construct subgraphs: 0.067 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.230124235153198
25915
25267
total k batches seeds list generation spend  8.024382829666138
after graph partition
graph partition algorithm spend time 8.188748121261597
25915
25267
time for parepare:  0.2516903877258301
local_output_nid generation:  0.007692575454711914
local_in_edges_tensor generation:  0.020961761474609375
mini_batch_src_global generation:  0.019896268844604492
r_  generation:  0.23545169830322266
local_output_nid generation:  0.00634455680847168
local_in_edges_tensor generation:  0.013369321823120117
mini_batch_src_global generation:  0.025711536407470703
r_  generation:  0.2656126022338867
----------------------check_connections_block total spend ----------------------------- 0.9970605373382568
generate_one_block  0.5578415393829346
generate_one_block  0.4164435863494873
time for parepare:  0.41359686851501465
local_output_nid generation:  0.0441436767578125
local_in_edges_tensor generation:  0.09277892112731934
mini_batch_src_global generation:  0.06683683395385742
r_  generation:  0.8533635139465332
local_output_nid generation:  0.055414676666259766
local_in_edges_tensor generation:  0.056557655334472656
mini_batch_src_global generation:  0.08098793029785156
r_  generation:  1.0228314399719238
----------------------check_connections_block total spend ----------------------------- 3.169628858566284
generate_one_block  1.4739367961883545
generate_one_block  1.2051587104797363
global_2_local spend time (sec) 0.10338902473449707
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.01313924789428711
A = g.adjacency_matrix() spent  0.012647390365600586
auxiliary_graph
Graph(num_nodes=337304, num_edges=10549697,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.1892261505126953
remove nodes length  290347

auxiliary_graph.remove_nodes spent  0.5675053596496582
after remove non output nodes the auxiliary_graph
Graph(num_nodes=46957, num_edges=10549697,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.44208836555480957

the counter of shared neighbor distribution
Counter({1.0: 8723386, 2.0: 1288962, 3.0: 324264, 4.0: 101438, 5.0: 36482, 6.0: 14604, 7.0: 6126, 8.0: 2966, 9.0: 1826, 10.0: 932, 11.0: 546, 12.0: 326, 13.0: 210, 14.0: 184, 15.0: 104, 16.0: 102, 17.0: 100, 19.0: 68, 18.0: 36, 25.0: 30, 20.0: 18, 21.0: 12, 22.0: 12, 23.0: 4, 24.0: 2})
10502740
Convert a graph into a bidirected graph: 0.372 seconds
Metis partitioning: 1.846 seconds
Split the graph: 1.198 seconds
Construct subgraphs: 0.036 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  3.4577584266662598
24120
22837
total k batches seeds list generation spend  6.757894277572632
after graph partition
graph partition algorithm spend time 6.89847993850708
24120
22837
time for parepare:  0.2648332118988037
local_output_nid generation:  0.005249738693237305
local_in_edges_tensor generation:  0.02000260353088379
mini_batch_src_global generation:  0.018830060958862305
r_  generation:  0.22995376586914062
local_output_nid generation:  0.006014347076416016
local_in_edges_tensor generation:  0.0121917724609375
mini_batch_src_global generation:  0.02269768714904785
r_  generation:  0.20446062088012695
----------------------check_connections_block total spend ----------------------------- 0.9250593185424805
generate_one_block  0.5426478385925293
generate_one_block  0.34982991218566895
time for parepare:  0.3912043571472168
local_output_nid generation:  0.046672821044921875
local_in_edges_tensor generation:  0.09001302719116211
mini_batch_src_global generation:  0.0651850700378418
r_  generation:  0.8603816032409668
local_output_nid generation:  0.04248046875
local_in_edges_tensor generation:  0.04897284507751465
mini_batch_src_global generation:  0.06550216674804688
r_  generation:  0.7169070243835449
----------------------check_connections_block total spend ----------------------------- 2.7131192684173584
generate_one_block  1.439924955368042
generate_one_block  0.8575594425201416
global_2_local spend time (sec) 0.1067957878112793
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.011881589889526367
A = g.adjacency_matrix() spent  0.019098520278930664
auxiliary_graph
Graph(num_nodes=320531, num_edges=11025359,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.16039705276489258
remove nodes length  270802

auxiliary_graph.remove_nodes spent  0.5773317813873291
after remove non output nodes the auxiliary_graph
Graph(num_nodes=49729, num_edges=11025359,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.45279645919799805

the counter of shared neighbor distribution
Counter({1.0: 9424902, 2.0: 1124630, 3.0: 271454, 4.0: 89326, 5.0: 34786, 6.0: 15192, 7.0: 7260, 8.0: 3678, 9.0: 1836, 10.0: 1006, 11.0: 662, 12.0: 348, 13.0: 236, 14.0: 126, 15.0: 72, 16.0: 44, 17.0: 38, 18.0: 20, 20.0: 4, 19.0: 4, 22.0: 4, 21.0: 2})
10975630
Convert a graph into a bidirected graph: 0.458 seconds
Metis partitioning: 2.042 seconds
Split the graph: 0.982 seconds
Construct subgraphs: 0.067 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  3.554777145385742
24175
25554
total k batches seeds list generation spend  6.852388858795166
after graph partition
graph partition algorithm spend time 7.013915300369263
24175
25554
time for parepare:  0.2583303451538086
local_output_nid generation:  0.0052967071533203125
local_in_edges_tensor generation:  0.020240306854248047
mini_batch_src_global generation:  0.018690109252929688
r_  generation:  0.22493290901184082
local_output_nid generation:  0.006331920623779297
local_in_edges_tensor generation:  0.011063814163208008
mini_batch_src_global generation:  0.02662491798400879
r_  generation:  0.24713850021362305
----------------------check_connections_block total spend ----------------------------- 0.9839766025543213
generate_one_block  0.5269722938537598
generate_one_block  0.3787264823913574
time for parepare:  0.3849055767059326
local_output_nid generation:  0.04600644111633301
local_in_edges_tensor generation:  0.09256362915039062
mini_batch_src_global generation:  0.06396722793579102
r_  generation:  0.883807897567749
local_output_nid generation:  0.04492640495300293
local_in_edges_tensor generation:  0.05467057228088379
mini_batch_src_global generation:  0.06899261474609375
r_  generation:  0.7662336826324463
----------------------check_connections_block total spend ----------------------------- 2.7978973388671875
generate_one_block  1.3657810688018799
generate_one_block  0.9378821849822998
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  2
re graph partition time:  7.176922798156738

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  16.297995567321777
block generation total time  16.3836612701416
average batch blocks generation time:  1.02397882938385
block dataloader generation time/epoch 187.21619939804077
pseudo mini batch 0 input nodes size: 573177
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.21606874465942383  GigaBytes
Max Memory Allocated: 0.21606874465942383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.2162456512451172  GigaBytes
Max Memory Allocated: 0.2162456512451172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.2162456512451172  GigaBytes
Max Memory Allocated: 0.2162456512451172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.23469257354736328  GigaBytes
Max Memory Allocated: 0.23469257354736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.23469257354736328  GigaBytes
Max Memory Allocated: 0.23469257354736328  GigaBytes

first layer input nodes number: 573177
first layer output nodes number: 196051
edges number: 1928240
torch.Size([573177, 100])
torch.Size([196051, 256])
torch.Size([23702, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1893310546875 GB
    Memory Allocated: 19.74556589126587  GigaBytes
Max Memory Allocated: 20.73388385772705  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1893310546875 GB
    Memory Allocated: 19.749717235565186  GigaBytes
Max Memory Allocated: 20.73388385772705  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.2711954116821289  GigaBytes
Max Memory Allocated: 20.73388385772705  GigaBytes

pseudo mini batch 1 input nodes size: 621379
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.22294044494628906  GigaBytes
Max Memory Allocated: 20.73388385772705  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.22294044494628906  GigaBytes
Max Memory Allocated: 20.73388385772705  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.4544224739074707  GigaBytes
Max Memory Allocated: 20.73388385772705  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.4546089172363281  GigaBytes
Max Memory Allocated: 20.73388385772705  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.2409067153930664  GigaBytes
Max Memory Allocated: 20.73388385772705  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.2629680633544922  GigaBytes
Max Memory Allocated: 20.73388385772705  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.2629680633544922  GigaBytes
Max Memory Allocated: 20.73388385772705  GigaBytes

first layer input nodes number: 621379
first layer output nodes number: 237035
edges number: 2342572
torch.Size([621379, 100])
torch.Size([237035, 256])
