main start at this time 1656023254.2702055
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.3419373035430908
global_2_local spend time (sec) 0.39942121505737305
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.050702810287475586
A = g.adjacency_matrix() spent  0.0821230411529541
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6045095920562744
remove nodes length  1009015

auxiliary_graph.remove_nodes spent  2.8415350914001465
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.0534613132476807

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
Convert a graph into a bidirected graph: 3.162 seconds
Metis partitioning: 12.153 seconds
Split the graph: 4.072 seconds
Construct subgraphs: 0.055 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  19.463932037353516
65655
63774
67142
total k batches seeds list generation spend  35.66302251815796
after graph partition
graph partition algorithm spend time 36.422648906707764
65655
63774
67142
partition_len_list
[414237, 469244, 462884]
REG selection method  spend 37.07757067680359
time for parepare:  0.2411344051361084
local_output_nid generation:  0.010962963104248047
local_in_edges_tensor generation:  0.05383110046386719
mini_batch_src_global generation:  0.047655582427978516
r_  generation:  0.6406154632568359
local_output_nid generation:  0.010711193084716797
local_in_edges_tensor generation:  0.031263113021850586
mini_batch_src_global generation:  0.06067490577697754
r_  generation:  0.6819319725036621
local_output_nid generation:  0.011138200759887695
local_in_edges_tensor generation:  0.027842283248901367
mini_batch_src_global generation:  0.055497169494628906
r_  generation:  0.7634007930755615
----------------------check_connections_block total spend ----------------------------- 3.0249404907226562
generate_one_block  2.314328670501709
generate_one_block  0.8406360149383545
generate_one_block  0.8962705135345459
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7759048938751221
gen group dst list time:  0.03604245185852051
time for parepare:  0.3795039653778076
local_output_nid generation:  0.07023930549621582
local_in_edges_tensor generation:  0.21687960624694824
mini_batch_src_global generation:  0.12126517295837402
r_  generation:  1.9017150402069092
local_output_nid generation:  0.0976104736328125
local_in_edges_tensor generation:  0.14667010307312012
mini_batch_src_global generation:  0.18633341789245605
r_  generation:  2.383638620376587
local_output_nid generation:  0.11992287635803223
local_in_edges_tensor generation:  0.1710500717163086
mini_batch_src_global generation:  0.1807239055633545
r_  generation:  2.3809635639190674
----------------------check_connections_block total spend ----------------------------- 9.557390213012695
generate_one_block  2.6764299869537354
generate_one_block  2.841423511505127
generate_one_block  2.7131357192993164
global_2_local spend time (sec) 0.13741183280944824
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.014096736907958984
A = g.adjacency_matrix() spent  0.017297983169555664
auxiliary_graph
Graph(num_nodes=469244, num_edges=14033058,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.2565338611602783
remove nodes length  405470

auxiliary_graph.remove_nodes spent  0.7270832061767578
after remove non output nodes the auxiliary_graph
Graph(num_nodes=63774, num_edges=14033058,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.696141242980957

the counter of shared neighbor distribution
Counter({1.0: 11125928, 2.0: 1778252, 3.0: 563158, 4.0: 237800, 5.0: 114702, 6.0: 60636, 7.0: 33688, 8.0: 19178, 9.0: 12024, 10.0: 6896, 11.0: 4418, 12.0: 2842, 13.0: 1982, 14.0: 1578, 15.0: 1132, 16.0: 1040, 17.0: 846, 18.0: 706, 24.0: 604, 19.0: 578, 21.0: 364, 20.0: 316, 22.0: 236, 23.0: 222, 25.0: 158})
13969284
Convert a graph into a bidirected graph: 0.528 seconds
Metis partitioning: 2.926 seconds
Split the graph: 1.296 seconds
Construct subgraphs: 0.047 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  4.803416013717651
31183
32591
total k batches seeds list generation spend  9.39221477508545
after graph partition
graph partition algorithm spend time 9.599456310272217
31183
32591
time for parepare:  0.2469477653503418
local_output_nid generation:  0.006084918975830078
local_in_edges_tensor generation:  0.02325296401977539
mini_batch_src_global generation:  0.024484634399414062
r_  generation:  0.28023362159729004
local_output_nid generation:  0.00722956657409668
local_in_edges_tensor generation:  0.016114234924316406
mini_batch_src_global generation:  0.033463478088378906
r_  generation:  0.33906102180480957
----------------------check_connections_block total spend ----------------------------- 1.128007411956787
generate_one_block  0.6989231109619141
generate_one_block  0.49596524238586426
time for parepare:  0.41074132919311523
local_output_nid generation:  0.055702924728393555
local_in_edges_tensor generation:  0.1638479232788086
mini_batch_src_global generation:  0.07595014572143555
r_  generation:  1.1124398708343506
local_output_nid generation:  0.07633018493652344
local_in_edges_tensor generation:  0.10303068161010742
mini_batch_src_global generation:  0.08911657333374023
r_  generation:  1.0915157794952393
----------------------check_connections_block total spend ----------------------------- 3.6700589656829834
generate_one_block  1.7803599834442139
generate_one_block  1.3982157707214355
global_2_local spend time (sec) 0.14130020141601562
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.013603687286376953
A = g.adjacency_matrix() spent  0.01566004753112793
auxiliary_graph
Graph(num_nodes=462884, num_edges=17598072,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.23044800758361816
remove nodes length  395742

auxiliary_graph.remove_nodes spent  1.0965962409973145
after remove non output nodes the auxiliary_graph
Graph(num_nodes=67142, num_edges=17598072,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.7123372554779053

the counter of shared neighbor distribution
Counter({1.0: 14105764, 2.0: 2017770, 3.0: 653668, 4.0: 301052, 5.0: 166928, 6.0: 96480, 7.0: 61278, 8.0: 37352, 9.0: 24366, 10.0: 16184, 11.0: 10460, 12.0: 6966, 13.0: 4944, 15.0: 4740, 14.0: 4574, 18.0: 3170, 16.0: 2632, 20.0: 2442, 19.0: 2086, 17.0: 1872, 22.0: 1598, 23.0: 1586, 21.0: 1234, 24.0: 1010, 25.0: 774})
17530930
Convert a graph into a bidirected graph: 0.682 seconds
Metis partitioning: 3.450 seconds
Split the graph: 1.370 seconds
Construct subgraphs: 0.047 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.557159662246704
32692
34450
total k batches seeds list generation spend  10.974688053131104
after graph partition
graph partition algorithm spend time 11.204559803009033
32692
34450
time for parepare:  0.2819383144378662
local_output_nid generation:  0.006601572036743164
local_in_edges_tensor generation:  0.031404733657836914
mini_batch_src_global generation:  0.024410009384155273
r_  generation:  0.29045867919921875
local_output_nid generation:  0.008883476257324219
local_in_edges_tensor generation:  0.018148422241210938
mini_batch_src_global generation:  0.035917043685913086
r_  generation:  0.3611903190612793
----------------------check_connections_block total spend ----------------------------- 1.2387018203735352
generate_one_block  0.6846551895141602
generate_one_block  0.6305344104766846
time for parepare:  0.4008829593658447
local_output_nid generation:  0.0629725456237793
local_in_edges_tensor generation:  0.11378359794616699
mini_batch_src_global generation:  0.0782322883605957
r_  generation:  1.1902952194213867
local_output_nid generation:  0.06568217277526855
local_in_edges_tensor generation:  0.10736918449401855
mini_batch_src_global generation:  0.10903048515319824
r_  generation:  1.3730335235595703
----------------------check_connections_block total spend ----------------------------- 4.113876819610596
generate_one_block  1.8901166915893555
generate_one_block  1.573042869567871
global_2_local spend time (sec) 0.13854384422302246
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.01339268684387207
A = g.adjacency_matrix() spent  0.015436410903930664
auxiliary_graph
Graph(num_nodes=414237, num_edges=16217377,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.21903085708618164
remove nodes length  348582

auxiliary_graph.remove_nodes spent  0.7988870143890381
after remove non output nodes the auxiliary_graph
Graph(num_nodes=65655, num_edges=16217377,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.6642475128173828

the counter of shared neighbor distribution
Counter({1.0: 13774104, 2.0: 1753508, 3.0: 413848, 4.0: 127228, 5.0: 45690, 6.0: 18844, 7.0: 8360, 8.0: 4290, 9.0: 2214, 10.0: 1350, 11.0: 848, 12.0: 458, 13.0: 316, 14.0: 234, 15.0: 134, 16.0: 112, 17.0: 90, 18.0: 50, 19.0: 16, 20.0: 12, 22.0: 8, 21.0: 4, 23.0: 4})
16151722
Convert a graph into a bidirected graph: 0.632 seconds
Metis partitioning: 3.329 seconds
Split the graph: 1.326 seconds
Construct subgraphs: 0.084 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.377590179443359
33749
31906
total k batches seeds list generation spend  10.1122407913208
after graph partition
graph partition algorithm spend time 10.339078187942505
33749
31906
time for parepare:  0.24428939819335938
local_output_nid generation:  0.006346225738525391
local_in_edges_tensor generation:  0.02636861801147461
mini_batch_src_global generation:  0.029761075973510742
r_  generation:  0.30330872535705566
local_output_nid generation:  0.0072329044342041016
local_in_edges_tensor generation:  0.010848522186279297
mini_batch_src_global generation:  0.033144235610961914
r_  generation:  0.30600810050964355
----------------------check_connections_block total spend ----------------------------- 1.1264476776123047
generate_one_block  0.6617765426635742
generate_one_block  0.4515066146850586
time for parepare:  0.4137911796569824
local_output_nid generation:  0.05102086067199707
local_in_edges_tensor generation:  0.09661555290222168
mini_batch_src_global generation:  0.07183647155761719
r_  generation:  0.9683148860931396
local_output_nid generation:  0.05280113220214844
local_in_edges_tensor generation:  0.07184863090515137
mini_batch_src_global generation:  0.0813589096069336
r_  generation:  0.968132734298706
----------------------check_connections_block total spend ----------------------------- 3.2132809162139893
generate_one_block  1.26902174949646
generate_one_block  1.204002857208252
global_2_local spend time (sec) 0.07166576385498047
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.007097482681274414
A = g.adjacency_matrix() spent  0.009588241577148438
auxiliary_graph
Graph(num_nodes=261481, num_edges=8238184,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.1423642635345459
remove nodes length  228789

auxiliary_graph.remove_nodes spent  0.3643629550933838
after remove non output nodes the auxiliary_graph
Graph(num_nodes=32692, num_edges=8238184,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.3384981155395508

the counter of shared neighbor distribution
Counter({1.0: 5889522, 2.0: 1229808, 3.0: 466468, 4.0: 233288, 5.0: 136110, 6.0: 81084, 7.0: 52862, 8.0: 32692, 9.0: 21786, 10.0: 14710, 11.0: 9578, 12.0: 6326, 15.0: 4594, 13.0: 4444, 14.0: 4372, 18.0: 3108, 16.0: 2528, 20.0: 2432, 19.0: 1880, 17.0: 1776, 23.0: 1576, 22.0: 1574, 21.0: 1218, 24.0: 984, 25.0: 772})
8205492
Convert a graph into a bidirected graph: 0.263 seconds
Metis partitioning: 0.914 seconds
Split the graph: 0.550 seconds
Construct subgraphs: 0.068 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  1.799581527709961
16608
16084
total k batches seeds list generation spend  4.30574107170105
after graph partition
graph partition algorithm spend time 4.383981704711914
16608
16084
time for parepare:  0.22841978073120117
local_output_nid generation:  0.004011392593383789
local_in_edges_tensor generation:  0.018121004104614258
mini_batch_src_global generation:  0.014575004577636719
r_  generation:  0.1323394775390625
local_output_nid generation:  0.004590749740600586
local_in_edges_tensor generation:  0.007111072540283203
mini_batch_src_global generation:  0.015890836715698242
r_  generation:  0.15103435516357422
----------------------check_connections_block total spend ----------------------------- 0.6704146862030029
generate_one_block  0.36354541778564453
generate_one_block  0.28859567642211914
time for parepare:  0.39974403381347656
local_output_nid generation:  0.03390169143676758
local_in_edges_tensor generation:  0.06588959693908691
mini_batch_src_global generation:  0.042871713638305664
r_  generation:  0.569312334060669
local_output_nid generation:  0.03941822052001953
local_in_edges_tensor generation:  0.07154011726379395
mini_batch_src_global generation:  0.05623483657836914
r_  generation:  0.6707336902618408
----------------------check_connections_block total spend ----------------------------- 2.2779812812805176
generate_one_block  1.0357697010040283
generate_one_block  0.8453884124755859
global_2_local spend time (sec) 0.07685971260070801
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.008901834487915039
A = g.adjacency_matrix() spent  0.008186578750610352
auxiliary_graph
Graph(num_nodes=253554, num_edges=6058433,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.1259632110595703
remove nodes length  222371

auxiliary_graph.remove_nodes spent  0.3001561164855957
after remove non output nodes the auxiliary_graph
Graph(num_nodes=31183, num_edges=6058433,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.2452995777130127

the counter of shared neighbor distribution
Counter({1.0: 4558580, 2.0: 926746, 3.0: 306400, 4.0: 124500, 5.0: 54576, 6.0: 26198, 7.0: 12908, 8.0: 6576, 9.0: 3660, 10.0: 2274, 11.0: 1294, 12.0: 838, 14.0: 666, 13.0: 548, 15.0: 366, 16.0: 278, 17.0: 174, 18.0: 174, 24.0: 160, 20.0: 110, 19.0: 102, 21.0: 40, 22.0: 36, 23.0: 36, 25.0: 10})
6027250
Convert a graph into a bidirected graph: 0.193 seconds
Metis partitioning: 0.688 seconds
Split the graph: 0.384 seconds
Construct subgraphs: 0.046 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  1.3143501281738281
15591
15592
total k batches seeds list generation spend  3.207122564315796
after graph partition
graph partition algorithm spend time 3.284803628921509
15591
15592
time for parepare:  0.24025464057922363
local_output_nid generation:  0.0038976669311523438
local_in_edges_tensor generation:  0.01779913902282715
mini_batch_src_global generation:  0.014179706573486328
r_  generation:  0.13548779487609863
local_output_nid generation:  0.004593372344970703
local_in_edges_tensor generation:  0.009532690048217773
mini_batch_src_global generation:  0.018143892288208008
r_  generation:  0.1440412998199463
----------------------check_connections_block total spend ----------------------------- 0.6718571186065674
generate_one_block  0.19810080528259277
generate_one_block  0.19583845138549805
time for parepare:  0.4039883613586426
local_output_nid generation:  0.02768564224243164
local_in_edges_tensor generation:  0.07193398475646973
mini_batch_src_global generation:  0.037203311920166016
r_  generation:  0.47623300552368164
local_output_nid generation:  0.03691267967224121
local_in_edges_tensor generation:  0.05003046989440918
mini_batch_src_global generation:  0.05446910858154297
r_  generation:  0.6167647838592529
----------------------check_connections_block total spend ----------------------------- 2.059432029724121
generate_one_block  0.7715659141540527
generate_one_block  0.8200404644012451
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  3
re graph partition time:  3.394087553024292

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  15.31361985206604
block generation total time  14.267770051956177
average batch blocks generation time:  0.891735628247261
block dataloader generation time/epoch 141.83846712112427
pseudo mini batch 0 input nodes size: 615576
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.23186349868774414  GigaBytes
Max Memory Allocated: 0.23186349868774414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.23210668563842773  GigaBytes
Max Memory Allocated: 0.23210668563842773  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.23210668563842773  GigaBytes
Max Memory Allocated: 0.23210668563842773  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.2557682991027832  GigaBytes
Max Memory Allocated: 0.2557682991027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.2557682991027832  GigaBytes
Max Memory Allocated: 0.2557682991027832  GigaBytes

first layer input nodes number: 615576
first layer output nodes number: 241772
edges number: 2373289
torch.Size([615576, 100])
torch.Size([241772, 256])
