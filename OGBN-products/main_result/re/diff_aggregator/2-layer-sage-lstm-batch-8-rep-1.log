main start at this time 1656024178.5725636
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.31828951835632324
global_2_local spend time (sec) 0.4082796573638916
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.05116009712219238
A = g.adjacency_matrix() spent  0.07974433898925781
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6235888004302979
remove nodes length  1009015

auxiliary_graph.remove_nodes spent  2.7894086837768555
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.0665509700775146

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
Convert a graph into a bidirected graph: 2.885 seconds
Metis partitioning: 12.321 seconds
Split the graph: 1.861 seconds
Construct subgraphs: 0.363 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  17.45267605781555
25075
23860
25292
24125
24558
23863
24545
25253
total k batches seeds list generation spend  33.11014795303345
after graph partition
graph partition algorithm spend time 33.770724058151245
25075
23860
25292
24125
24558
23863
24545
25253
partition_len_list
[198308, 173052, 188565, 174976, 200705, 216757, 222357, 208037]
REG selection method  spend 34.43242621421814
time for parepare:  0.24467206001281738
local_output_nid generation:  0.005851030349731445
local_in_edges_tensor generation:  0.00788259506225586
mini_batch_src_global generation:  0.01984405517578125
r_  generation:  0.23399066925048828
local_output_nid generation:  0.006584644317626953
local_in_edges_tensor generation:  0.012293100357055664
mini_batch_src_global generation:  0.024038314819335938
r_  generation:  0.2161552906036377
local_output_nid generation:  0.008457660675048828
local_in_edges_tensor generation:  0.00776219367980957
mini_batch_src_global generation:  0.02205634117126465
r_  generation:  0.25782132148742676
local_output_nid generation:  0.007670879364013672
local_in_edges_tensor generation:  0.0076503753662109375
mini_batch_src_global generation:  0.022657394409179688
r_  generation:  0.23591351509094238
local_output_nid generation:  0.006892681121826172
local_in_edges_tensor generation:  0.0076520442962646484
mini_batch_src_global generation:  0.02328777313232422
r_  generation:  0.25896120071411133
local_output_nid generation:  0.006681919097900391
local_in_edges_tensor generation:  0.008931398391723633
mini_batch_src_global generation:  0.02441573143005371
r_  generation:  0.2541213035583496
local_output_nid generation:  0.006868600845336914
local_in_edges_tensor generation:  0.007744550704956055
mini_batch_src_global generation:  0.02560567855834961
r_  generation:  0.2867472171783447
local_output_nid generation:  0.006972074508666992
local_in_edges_tensor generation:  0.009767293930053711
mini_batch_src_global generation:  0.02896404266357422
r_  generation:  0.2894318103790283
----------------------check_connections_block total spend ----------------------------- 3.0311226844787598
generate_one_block  1.7317023277282715
generate_one_block  0.28197240829467773
generate_one_block  0.30058932304382324
generate_one_block  0.2862968444824219
generate_one_block  0.29259252548217773
generate_one_block  0.2950618267059326
generate_one_block  0.3116021156311035
generate_one_block  0.31485438346862793
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7190208435058594
gen group dst list time:  0.042147159576416016
time for parepare:  0.3962056636810303
local_output_nid generation:  0.04366612434387207
local_in_edges_tensor generation:  0.11957716941833496
mini_batch_src_global generation:  0.05939316749572754
r_  generation:  0.8416087627410889
local_output_nid generation:  0.0428621768951416
local_in_edges_tensor generation:  0.057530879974365234
mini_batch_src_global generation:  0.06425714492797852
r_  generation:  0.7248058319091797
local_output_nid generation:  0.04609537124633789
local_in_edges_tensor generation:  0.045523643493652344
mini_batch_src_global generation:  0.06415987014770508
r_  generation:  0.8269627094268799
local_output_nid generation:  0.046767234802246094
local_in_edges_tensor generation:  0.05721759796142578
mini_batch_src_global generation:  0.06539011001586914
r_  generation:  0.7951803207397461
local_output_nid generation:  0.04991865158081055
local_in_edges_tensor generation:  0.0560603141784668
mini_batch_src_global generation:  0.07957315444946289
r_  generation:  0.9303078651428223
local_output_nid generation:  0.056171417236328125
local_in_edges_tensor generation:  0.08368182182312012
mini_batch_src_global generation:  0.08327698707580566
r_  generation:  1.0591402053833008
local_output_nid generation:  0.06352639198303223
local_in_edges_tensor generation:  0.08689045906066895
mini_batch_src_global generation:  0.09855937957763672
r_  generation:  1.103957176208496
local_output_nid generation:  0.0515294075012207
local_in_edges_tensor generation:  0.053278446197509766
mini_batch_src_global generation:  0.09161686897277832
r_  generation:  0.9912741184234619
----------------------check_connections_block total spend ----------------------------- 10.717894315719604
generate_one_block  1.4149036407470703
generate_one_block  0.901498556137085
generate_one_block  0.9560465812683105
generate_one_block  0.9081614017486572
generate_one_block  1.2575387954711914
generate_one_block  1.2523167133331299
generate_one_block  1.2480707168579102
generate_one_block  1.090287446975708
global_2_local spend time (sec) 0.056793928146362305
----------------------------  graph partition start---------------------
random_init for graph_partition spend:  0.002629518508911133
The batched output nid list before graph partition
total k batches seeds list generation spend  0.002664804458618164
after graph partition
graph partition algorithm spend time 0.07590055465698242
11932
11931
time for parepare:  0.23915600776672363
local_output_nid generation:  0.00403594970703125
local_in_edges_tensor generation:  0.03786969184875488
mini_batch_src_global generation:  0.008690357208251953
r_  generation:  0.09651947021484375
local_output_nid generation:  0.004304647445678711
local_in_edges_tensor generation:  0.015433549880981445
mini_batch_src_global generation:  0.011739730834960938
r_  generation:  0.10480332374572754
----------------------check_connections_block total spend ----------------------------- 0.593217134475708
generate_one_block  0.14282941818237305
generate_one_block  0.1456747055053711
time for parepare:  0.3901400566101074
local_output_nid generation:  0.03957033157348633
local_in_edges_tensor generation:  0.04810047149658203
mini_batch_src_global generation:  0.04291558265686035
r_  generation:  0.6379048824310303
local_output_nid generation:  0.04378390312194824
local_in_edges_tensor generation:  0.06049013137817383
mini_batch_src_global generation:  0.05325126647949219
r_  generation:  0.643949031829834
----------------------check_connections_block total spend ----------------------------- 2.271514654159546
generate_one_block  0.7879886627197266
generate_one_block  0.8193151950836182
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  8
re graph partition time:  0.16583967208862305

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  16.613748788833618
block generation total time  14.739303588867188
average batch blocks generation time:  0.8188501993815104
block dataloader generation time/epoch 68.15060210227966
pseudo mini batch 0 input nodes size: 475344
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1971435546875 GB
    Memory Allocated: 0.18027782440185547  GigaBytes
Max Memory Allocated: 0.18027782440185547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1971435546875 GB
    Memory Allocated: 0.1804647445678711  GigaBytes
Max Memory Allocated: 0.1804647445678711  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1971435546875 GB
    Memory Allocated: 0.1804647445678711  GigaBytes
Max Memory Allocated: 0.1804647445678711  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.1999959945678711  GigaBytes
Max Memory Allocated: 0.1999959945678711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.1999959945678711  GigaBytes
Max Memory Allocated: 0.1999959945678711  GigaBytes

first layer input nodes number: 475344
first layer output nodes number: 198308
edges number: 1956383
torch.Size([475344, 100])
torch.Size([198308, 256])
torch.Size([25075, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 20.90323257446289  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 20.90762424468994  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.5975341796875 GB
    Memory Allocated: 0.23836517333984375  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

pseudo mini batch 1 input nodes size: 439715
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.5975341796875 GB
    Memory Allocated: 0.18739986419677734  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.5975341796875 GB
    Memory Allocated: 0.18739986419677734  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.5975341796875 GB
    Memory Allocated: 0.35120677947998047  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.5975341796875 GB
    Memory Allocated: 0.35138463973999023  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.5975341796875 GB
    Memory Allocated: 0.1734633445739746  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.5975341796875 GB
    Memory Allocated: 0.19078779220581055  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5975341796875 GB
    Memory Allocated: 0.19078779220581055  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

first layer input nodes number: 439715
first layer output nodes number: 173052
edges number: 1674800
torch.Size([439715, 100])
torch.Size([173052, 256])
torch.Size([23860, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7420654296875 GB
    Memory Allocated: 18.426978588104248  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7420654296875 GB
    Memory Allocated: 18.43136978149414  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7459716796875 GB
    Memory Allocated: 0.2194209098815918  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

pseudo mini batch 2 input nodes size: 434719
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7459716796875 GB
    Memory Allocated: 0.17325067520141602  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7459716796875 GB
    Memory Allocated: 0.17325067520141602  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7459716796875 GB
    Memory Allocated: 0.33519649505615234  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7459716796875 GB
    Memory Allocated: 0.3353853225708008  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7459716796875 GB
    Memory Allocated: 0.1714005470275879  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7459716796875 GB
    Memory Allocated: 0.18938970565795898  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7459716796875 GB
    Memory Allocated: 0.18938970565795898  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

first layer input nodes number: 434719
first layer output nodes number: 188565
edges number: 1803276
torch.Size([434719, 100])
torch.Size([188565, 256])
torch.Size([25292, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0115966796875 GB
    Memory Allocated: 19.871460914611816  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.0115966796875 GB
    Memory Allocated: 19.876476764678955  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.21974563598632812  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

pseudo mini batch 3 input nodes size: 454719
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.17186784744262695  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.17186784744262695  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.3412642478942871  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.3414440155029297  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.17930936813354492  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.19711637496948242  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.19711637496948242  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

first layer input nodes number: 454719
first layer output nodes number: 174976
edges number: 1687730
torch.Size([454719, 100])
torch.Size([174976, 256])
torch.Size([24125, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 18.772827625274658  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 18.777052402496338  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.22507476806640625  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

pseudo mini batch 4 input nodes size: 558802
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.17888832092285156  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.17888832092285156  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.38705873489379883  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.38724184036254883  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.2176656723022461  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.23662471771240234  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0155029296875 GB
    Memory Allocated: 0.23662471771240234  GigaBytes
Max Memory Allocated: 22.074665546417236  GigaBytes

first layer input nodes number: 558802
first layer output nodes number: 200705
edges number: 1956156
torch.Size([558802, 100])
torch.Size([200705, 256])
