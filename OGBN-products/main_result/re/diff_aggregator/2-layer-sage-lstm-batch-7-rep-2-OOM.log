main start at this time 1655957791.1871088
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.317324161529541
global_2_local spend time (sec) 0.404094934463501
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.050620317459106445
A = g.adjacency_matrix() spent  0.08716058731079102
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5963401794433594
remove nodes length
1009015
auxiliary_graph.remove_nodes spent  2.780085563659668
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.1249430179595947

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 51547889, 51547890, 51547891])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
Convert a graph into a bidirected graph: 3.123 seconds
Metis partitioning: 12.497 seconds
Split the graph: 1.979 seconds
Construct subgraphs: 0.433 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  18.054285764694214
27377
28909
27321
28829
28838
27435
27862
total k batches seeds list generation spend  39.676159381866455
after graph partition
graph partition algorithm spend time 40.322553634643555
27377
28909
27321
28829
28838
27435
27862
partition_len_list
[175465, 199615, 214228, 246709, 244108, 227569, 223523]
shared_neighbor_graph_partition_s0 selection method  spend 40.977234840393066
time for parepare:  0.2544431686401367
local_output_nid generation:  0.010377168655395508
local_in_edges_tensor generation:  0.008399009704589844
mini_batch_src_global generation:  0.02108025550842285
r_  generation:  0.22728776931762695
local_output_nid generation:  0.007508039474487305
local_in_edges_tensor generation:  0.014125823974609375
mini_batch_src_global generation:  0.02900385856628418
r_  generation:  0.2925288677215576
local_output_nid generation:  0.0083770751953125
local_in_edges_tensor generation:  0.041649580001831055
mini_batch_src_global generation:  0.02456974983215332
r_  generation:  0.30355238914489746
local_output_nid generation:  0.009940385818481445
local_in_edges_tensor generation:  0.012115478515625
mini_batch_src_global generation:  0.026641845703125
r_  generation:  0.3180074691772461
local_output_nid generation:  0.007567644119262695
local_in_edges_tensor generation:  0.010125398635864258
mini_batch_src_global generation:  0.030225276947021484
r_  generation:  0.32469987869262695
local_output_nid generation:  0.007276296615600586
local_in_edges_tensor generation:  0.0074689388275146484
mini_batch_src_global generation:  0.02769613265991211
r_  generation:  0.30020833015441895
local_output_nid generation:  0.007386684417724609
local_in_edges_tensor generation:  0.007548809051513672
mini_batch_src_global generation:  0.03021979331970215
r_  generation:  0.30927515029907227
----------------------check_connections_block total spend ----------------------------- 3.1080543994903564
generate_one_block  1.7416164875030518
generate_one_block  0.338151216506958
generate_one_block  0.33251333236694336
generate_one_block  0.3762631416320801
generate_one_block  0.37322545051574707
generate_one_block  0.3234100341796875
generate_one_block  0.3413698673248291
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.699150800704956
gen group dst list time:  0.044027090072631836
time for parepare:  0.4132380485534668
local_output_nid generation:  0.03698921203613281
local_in_edges_tensor generation:  0.11529874801635742
mini_batch_src_global generation:  0.05677032470703125
r_  generation:  0.7539887428283691
local_output_nid generation:  0.07543587684631348
local_in_edges_tensor generation:  0.09658646583557129
mini_batch_src_global generation:  0.07395815849304199
r_  generation:  0.8428285121917725
local_output_nid generation:  0.05681180953979492
local_in_edges_tensor generation:  0.05912280082702637
mini_batch_src_global generation:  0.07565832138061523
r_  generation:  1.0019752979278564
local_output_nid generation:  0.06641578674316406
local_in_edges_tensor generation:  0.08254170417785645
mini_batch_src_global generation:  0.09929037094116211
r_  generation:  1.2132694721221924
local_output_nid generation:  0.06440258026123047
local_in_edges_tensor generation:  0.08864784240722656
mini_batch_src_global generation:  0.09383702278137207
r_  generation:  1.2450518608093262
local_output_nid generation:  0.0819237232208252
local_in_edges_tensor generation:  0.07685422897338867
mini_batch_src_global generation:  0.09292268753051758
r_  generation:  1.0994884967803955
local_output_nid generation:  0.07152271270751953
local_in_edges_tensor generation:  0.05962657928466797
mini_batch_src_global generation:  0.09169816970825195
r_  generation:  1.1369683742523193
----------------------check_connections_block total spend ----------------------------- 10.765742063522339
generate_one_block  1.2546131610870361
generate_one_block  1.20892333984375
generate_one_block  1.4283931255340576
generate_one_block  1.458524227142334
generate_one_block  1.387772798538208
generate_one_block  1.2992022037506104
generate_one_block  1.4140398502349854
----------===============-------------===============-------------the number of batches *****---- 7

original number of batches:  5
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  13.873796463012695
block generation total time  13.278018236160278
average batch blocks generation time:  0.9484298740114484
block dataloader generation time/epoch 70.24282598495483
pseudo mini batch 0 input nodes size: 394621
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.1495513916015625  GigaBytes
Max Memory Allocated: 0.1495513916015625  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.14975547790527344  GigaBytes
Max Memory Allocated: 0.14975547790527344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.14975547790527344  GigaBytes
Max Memory Allocated: 0.14975547790527344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.16729450225830078  GigaBytes
Max Memory Allocated: 0.16729450225830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.16729450225830078  GigaBytes
Max Memory Allocated: 0.16729450225830078  GigaBytes

first layer input nodes number: 394621
first layer output nodes number: 175465
edges number: 1697979
----------------------------------------before model layer 0
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.17166423797607422  GigaBytes
Max Memory Allocated: 0.17798995971679688  GigaBytes

torch.Size([394621, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.17166423797607422  GigaBytes
Max Memory Allocated: 0.17798995971679688  GigaBytes

m.shape torch.Size([439, 1, 100])
----------------------------------------1
 Nvidia-smi: 2.0604248046875 GB
    Memory Allocated: 0.8225274085998535  GigaBytes
Max Memory Allocated: 0.8499641418457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0604248046875 GB
    Memory Allocated: 0.8225274085998535  GigaBytes
Max Memory Allocated: 0.8499641418457031  GigaBytes

 h.shape torch.Size([1, 439, 100]), torch.Size([1, 439, 100])
----------------------------------------3
 Nvidia-smi: 2.0604248046875 GB
    Memory Allocated: 0.8228545188903809  GigaBytes
Max Memory Allocated: 0.8499641418457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.8254714012145996  GigaBytes
Max Memory Allocated: 0.8499641418457031  GigaBytes

rst.shape  torch.Size([1, 439, 100])
m.shape torch.Size([833, 2, 100])
----------------------------------------1
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.8259286880493164  GigaBytes
Max Memory Allocated: 0.8499641418457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.8259286880493164  GigaBytes
Max Memory Allocated: 0.8499641418457031  GigaBytes

 h.shape torch.Size([1, 833, 100]), torch.Size([1, 833, 100])
----------------------------------------3
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.8265495300292969  GigaBytes
Max Memory Allocated: 0.8499641418457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.8369073867797852  GigaBytes
Max Memory Allocated: 0.8499641418457031  GigaBytes

rst.shape  torch.Size([1, 833, 100])
m.shape torch.Size([1062, 3, 100])
----------------------------------------1
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.8377842903137207  GigaBytes
Max Memory Allocated: 0.8499641418457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.8377842903137207  GigaBytes
Max Memory Allocated: 0.8499641418457031  GigaBytes

 h.shape torch.Size([1, 1062, 100]), torch.Size([1, 1062, 100])
----------------------------------------3
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.8385758399963379  GigaBytes
Max Memory Allocated: 0.8499641418457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.8559856414794922  GigaBytes
Max Memory Allocated: 0.857172966003418  GigaBytes

rst.shape  torch.Size([1, 1062, 100])
m.shape torch.Size([1444, 4, 100])
----------------------------------------1
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.8577418327331543  GigaBytes
Max Memory Allocated: 0.8578071594238281  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.8577418327331543  GigaBytes
Max Memory Allocated: 0.8578071594238281  GigaBytes

 h.shape torch.Size([1, 1444, 100]), torch.Size([1, 1444, 100])
----------------------------------------3
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.858818531036377  GigaBytes
Max Memory Allocated: 0.858818531036377  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8908839225769043  GigaBytes
Max Memory Allocated: 0.8931994438171387  GigaBytes

rst.shape  torch.Size([1, 1444, 100])
m.shape torch.Size([1765, 5, 100])
----------------------------------------1
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.8936333656311035  GigaBytes
Max Memory Allocated: 0.8937320709228516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.8936333656311035  GigaBytes
Max Memory Allocated: 0.8937320709228516  GigaBytes

 h.shape torch.Size([1, 1765, 100]), torch.Size([1, 1765, 100])
----------------------------------------3
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.8949484825134277  GigaBytes
Max Memory Allocated: 0.8949484825134277  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.9427547454833984  GigaBytes
Max Memory Allocated: 0.946042537689209  GigaBytes

rst.shape  torch.Size([1, 1765, 100])
m.shape torch.Size([1983, 6, 100])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.9465298652648926  GigaBytes
Max Memory Allocated: 0.9466629028320312  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.9465298652648926  GigaBytes
Max Memory Allocated: 0.9466629028320312  GigaBytes

 h.shape torch.Size([1, 1983, 100]), torch.Size([1, 1983, 100])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.9480080604553223  GigaBytes
Max Memory Allocated: 0.9480080604553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 1.0125179290771484  GigaBytes
Max Memory Allocated: 1.0169506072998047  GigaBytes

rst.shape  torch.Size([1, 1983, 100])
m.shape torch.Size([2124, 7, 100])
----------------------------------------1
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 1.017317771911621  GigaBytes
Max Memory Allocated: 1.0174846649169922  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 1.017317771911621  GigaBytes
Max Memory Allocated: 1.0174846649169922  GigaBytes

 h.shape torch.Size([1, 2124, 100]), torch.Size([1, 2124, 100])
----------------------------------------3
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 1.0189008712768555  GigaBytes
Max Memory Allocated: 1.0189008712768555  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 1.0996551513671875  GigaBytes
Max Memory Allocated: 1.105194091796875  GigaBytes

rst.shape  torch.Size([1, 2124, 100])
m.shape torch.Size([2282, 8, 100])
----------------------------------------1
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 1.1056647300720215  GigaBytes
Max Memory Allocated: 1.1058692932128906  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 1.1056647300720215  GigaBytes
Max Memory Allocated: 1.1058692932128906  GigaBytes

 h.shape torch.Size([1, 2282, 100]), torch.Size([1, 2282, 100])
----------------------------------------3
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 1.1073651313781738  GigaBytes
Max Memory Allocated: 1.1073651313781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4549560546875 GB
    Memory Allocated: 1.2042880058288574  GigaBytes
Max Memory Allocated: 1.2110891342163086  GigaBytes

rst.shape  torch.Size([1, 2282, 100])
m.shape torch.Size([2265, 9, 100])
----------------------------------------1
 Nvidia-smi: 2.4549560546875 GB
    Memory Allocated: 1.2110319137573242  GigaBytes
Max Memory Allocated: 1.2112603187561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4549560546875 GB
    Memory Allocated: 1.2110319137573242  GigaBytes
Max Memory Allocated: 1.2112603187561035  GigaBytes

 h.shape torch.Size([1, 2265, 100]), torch.Size([1, 2265, 100])
----------------------------------------3
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 1.2127199172973633  GigaBytes
Max Memory Allocated: 1.2127199172973633  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5936279296875 GB
    Memory Allocated: 1.3207392692565918  GigaBytes
Max Memory Allocated: 1.3283333778381348  GigaBytes

rst.shape  torch.Size([1, 2265, 100])
m.shape torch.Size([161268, 10, 100])
----------------------------------------1
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 1.9214577674865723  GigaBytes
Max Memory Allocated: 1.9394817352294922  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2147216796875 GB
    Memory Allocated: 1.9214577674865723  GigaBytes
Max Memory Allocated: 1.9394817352294922  GigaBytes

 h.shape torch.Size([1, 161268, 100]), torch.Size([1, 161268, 100])
----------------------------------------3
 Nvidia-smi: 3.3358154296875 GB
    Memory Allocated: 2.0425515174865723  GigaBytes
Max Memory Allocated: 2.0425515174865723  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5350341796875 GB
    Memory Allocated: 10.583831310272217  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 161268, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5350341796875 GB
    Memory Allocated: 9.95251989364624  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5350341796875 GB
    Memory Allocated: 10.119856357574463  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.5350341796875 GB
    Memory Allocated: 10.287192821502686  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.5350341796875 GB
    Memory Allocated: 10.119856357574463  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

torch.Size([175465, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.5350341796875 GB
    Memory Allocated: 10.287192821502686  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.5350341796875 GB
    Memory Allocated: 10.32902717590332  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5350341796875 GB
    Memory Allocated: 10.32902717590332  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

m.shape torch.Size([39, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.960706233978271  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.960706233978271  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.960780620574951  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.961375713348389  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([60, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.961453914642334  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.961453914642334  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.961568355560303  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.963284969329834  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([63, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.963409423828125  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.963409423828125  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.963529586791992  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.96617317199707  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([112, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.966543674468994  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.966543674468994  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.96675729751587  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.972952365875244  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([94, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.973297595977783  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.973297595977783  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.973476886749268  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.979931354522705  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([116, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.980510711669922  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.980510711669922  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 13.1619873046875 GB
    Memory Allocated: 10.980731964111328  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1678466796875 GB
    Memory Allocated: 10.990245819091797  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.1678466796875 GB
    Memory Allocated: 10.990909099578857  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1678466796875 GB
    Memory Allocated: 10.990909099578857  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 13.1678466796875 GB
    Memory Allocated: 10.99112844467163  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1795654296875 GB
    Memory Allocated: 11.002095699310303  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([126, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.1815185546875 GB
    Memory Allocated: 11.002954959869385  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1815185546875 GB
    Memory Allocated: 11.002954959869385  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 13.1815185546875 GB
    Memory Allocated: 11.00319528579712  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1951904296875 GB
    Memory Allocated: 11.016893863677979  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.1951904296875 GB
    Memory Allocated: 11.017647743225098  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.1951904296875 GB
    Memory Allocated: 11.017647743225098  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 13.1951904296875 GB
    Memory Allocated: 11.017840385437012  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.2088623046875 GB
    Memory Allocated: 11.030169486999512  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([105, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.2088623046875 GB
    Memory Allocated: 11.031200885772705  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.2088623046875 GB
    Memory Allocated: 11.031200885772705  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 13.2088623046875 GB
    Memory Allocated: 11.03140115737915  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.2225341796875 GB
    Memory Allocated: 11.045620441436768  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([102, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.2225341796875 GB
    Memory Allocated: 11.046716213226318  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.2225341796875 GB
    Memory Allocated: 11.046716213226318  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 13.2225341796875 GB
    Memory Allocated: 11.046910762786865  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.2381591796875 GB
    Memory Allocated: 11.062085628509521  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([88, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.2381591796875 GB
    Memory Allocated: 11.063393592834473  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.2381591796875 GB
    Memory Allocated: 11.063393592834473  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 13.2381591796875 GB
    Memory Allocated: 11.06356143951416  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.2518310546875 GB
    Memory Allocated: 11.077828407287598  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.2518310546875 GB
    Memory Allocated: 11.079556465148926  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.2518310546875 GB
    Memory Allocated: 11.079556465148926  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 13.2518310546875 GB
    Memory Allocated: 11.079758644104004  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.2713623046875 GB
    Memory Allocated: 11.098359107971191  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([104, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.2713623046875 GB
    Memory Allocated: 11.100070476531982  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.2713623046875 GB
    Memory Allocated: 11.100070476531982  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 13.2713623046875 GB
    Memory Allocated: 11.100268840789795  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.2908935546875 GB
    Memory Allocated: 11.119906902313232  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([116, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.2908935546875 GB
    Memory Allocated: 11.121700286865234  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.2908935546875 GB
    Memory Allocated: 11.121700286865234  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 13.2908935546875 GB
    Memory Allocated: 11.12192153930664  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3162841796875 GB
    Memory Allocated: 11.145374298095703  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([101, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.3162841796875 GB
    Memory Allocated: 11.147155284881592  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3162841796875 GB
    Memory Allocated: 11.147155284881592  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 13.3162841796875 GB
    Memory Allocated: 11.147347927093506  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3377685546875 GB
    Memory Allocated: 11.169116497039795  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([119, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.3377685546875 GB
    Memory Allocated: 11.170997619628906  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3377685546875 GB
    Memory Allocated: 11.170997619628906  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 13.3377685546875 GB
    Memory Allocated: 11.171224594116211  GigaBytes
Max Memory Allocated: 11.185393810272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3651123046875 GB
    Memory Allocated: 11.198461532592773  GigaBytes
Max Memory Allocated: 11.200777053833008  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([108, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.3651123046875 GB
    Memory Allocated: 11.200242042541504  GigaBytes
Max Memory Allocated: 11.200777053833008  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3651123046875 GB
    Memory Allocated: 11.200242042541504  GigaBytes
Max Memory Allocated: 11.200777053833008  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 13.3651123046875 GB
    Memory Allocated: 11.200448036193848  GigaBytes
Max Memory Allocated: 11.200777053833008  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3924560546875 GB
    Memory Allocated: 11.226609230041504  GigaBytes
Max Memory Allocated: 11.228488445281982  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([114, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.3924560546875 GB
    Memory Allocated: 11.228837966918945  GigaBytes
Max Memory Allocated: 11.228846073150635  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3924560546875 GB
    Memory Allocated: 11.228837966918945  GigaBytes
Max Memory Allocated: 11.228846073150635  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 13.3944091796875 GB
    Memory Allocated: 11.229055404663086  GigaBytes
Max Memory Allocated: 11.229055404663086  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4237060546875 GB
    Memory Allocated: 11.25819206237793  GigaBytes
Max Memory Allocated: 11.260595321655273  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([95, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.4237060546875 GB
    Memory Allocated: 11.259976863861084  GigaBytes
Max Memory Allocated: 11.260595321655273  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4237060546875 GB
    Memory Allocated: 11.259976863861084  GigaBytes
Max Memory Allocated: 11.260595321655273  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 13.4237060546875 GB
    Memory Allocated: 11.260158061981201  GigaBytes
Max Memory Allocated: 11.260595321655273  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4471435546875 GB
    Memory Allocated: 11.285706996917725  GigaBytes
Max Memory Allocated: 11.287586212158203  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([100, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.4471435546875 GB
    Memory Allocated: 11.28803539276123  GigaBytes
Max Memory Allocated: 11.28804349899292  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4471435546875 GB
    Memory Allocated: 11.28803539276123  GigaBytes
Max Memory Allocated: 11.28804349899292  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 13.4471435546875 GB
    Memory Allocated: 11.288226127624512  GigaBytes
Max Memory Allocated: 11.288226127624512  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4764404296875 GB
    Memory Allocated: 11.316454887390137  GigaBytes
Max Memory Allocated: 11.318982124328613  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([105, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.4764404296875 GB
    Memory Allocated: 11.318904399871826  GigaBytes
Max Memory Allocated: 11.318982124328613  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4764404296875 GB
    Memory Allocated: 11.318904399871826  GigaBytes
Max Memory Allocated: 11.318982124328613  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 13.4764404296875 GB
    Memory Allocated: 11.319104671478271  GigaBytes
Max Memory Allocated: 11.319104671478271  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5096435546875 GB
    Memory Allocated: 11.350146770477295  GigaBytes
Max Memory Allocated: 11.352674007415771  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([93, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.5096435546875 GB
    Memory Allocated: 11.352590084075928  GigaBytes
Max Memory Allocated: 11.352674007415771  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5096435546875 GB
    Memory Allocated: 11.352590084075928  GigaBytes
Max Memory Allocated: 11.352674007415771  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 13.5096435546875 GB
    Memory Allocated: 11.35276746749878  GigaBytes
Max Memory Allocated: 11.35276746749878  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5369873046875 GB
    Memory Allocated: 11.381503582000732  GigaBytes
Max Memory Allocated: 11.384157180786133  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([116, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.5369873046875 GB
    Memory Allocated: 11.384434700012207  GigaBytes
Max Memory Allocated: 11.384445190429688  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5369873046875 GB
    Memory Allocated: 11.384434700012207  GigaBytes
Max Memory Allocated: 11.384445190429688  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 13.5369873046875 GB
    Memory Allocated: 11.384655952453613  GigaBytes
Max Memory Allocated: 11.384655952453613  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5760498046875 GB
    Memory Allocated: 11.42204761505127  GigaBytes
Max Memory Allocated: 11.424702644348145  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([24979, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.1717529296875 GB
    Memory Allocated: 12.022293090820312  GigaBytes
Max Memory Allocated: 12.024946689605713  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1717529296875 GB
    Memory Allocated: 12.022293090820312  GigaBytes
Max Memory Allocated: 12.024946689605713  GigaBytes

 h.shape torch.Size([1, 24979, 256]), torch.Size([1, 24979, 256])
----------------------------------------3
 Nvidia-smi: 14.1717529296875 GB
    Memory Allocated: 12.069936752319336  GigaBytes
Max Memory Allocated: 12.069936752319336  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 20.48491096496582  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 24979, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 19.86112117767334  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 19.865914821624756  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 19.870708465576172  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 19.865710735321045  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

torch.Size([27377, 47])
input nodes number: 175465
output nodes number: 27377
edges number: 655943
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 19.87227725982666  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 19.872278213500977  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.20494508743286133  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

pseudo mini batch 1 input nodes size: 438535
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.15709352493286133  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.15709352493286133  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.32046079635620117  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.320676326751709  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.17346429824829102  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.19281625747680664  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.19281625747680664  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

first layer input nodes number: 438535
first layer output nodes number: 199615
edges number: 1900403
----------------------------------------before model layer 0
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.1975712776184082  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

torch.Size([438535, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.1975712776184082  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

m.shape torch.Size([932, 1, 100])
----------------------------------------1
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.9266891479492188  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.9266891479492188  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 932, 100]), torch.Size([1, 932, 100])
----------------------------------------3
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.9273843765258789  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.9330401420593262  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 932, 100])
m.shape torch.Size([1457, 2, 100])
----------------------------------------1
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.9337782859802246  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.9337782859802246  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 1457, 100]), torch.Size([1, 1457, 100])
----------------------------------------3
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.9348645210266113  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.9511523246765137  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 1457, 100])
m.shape torch.Size([1989, 3, 100])
----------------------------------------1
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.9528322219848633  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.9528322219848633  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 1989, 100]), torch.Size([1, 1989, 100])
----------------------------------------3
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.9543142318725586  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.9872350692749023  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 1989, 100])
m.shape torch.Size([2491, 4, 100])
----------------------------------------1
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.990206241607666  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.990206241607666  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 2491, 100]), torch.Size([1, 2491, 100])
----------------------------------------3
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 0.992063045501709  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.0480847358703613  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 2491, 100])
m.shape torch.Size([2926, 5, 100])
----------------------------------------1
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.0526065826416016  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.0526065826416016  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 2926, 100]), torch.Size([1, 2926, 100])
----------------------------------------3
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.0557012557983398  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.1347432136535645  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 2926, 100])
m.shape torch.Size([3147, 6, 100])
----------------------------------------1
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.1406874656677246  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.1406874656677246  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 3147, 100]), torch.Size([1, 3147, 100])
----------------------------------------3
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.1439504623413086  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.249312400817871  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 3147, 100])
m.shape torch.Size([3230, 7, 100])
----------------------------------------1
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.255791187286377  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.255791187286377  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 3230, 100]), torch.Size([1, 3230, 100])
----------------------------------------3
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.2596807479858398  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.3816819190979004  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 3230, 100])
m.shape torch.Size([3346, 8, 100])
----------------------------------------1
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.3904504776000977  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.3904504776000977  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 3346, 100]), torch.Size([1, 3346, 100])
----------------------------------------3
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.3929443359375  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.5381078720092773  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 3346, 100])
m.shape torch.Size([3234, 9, 100])
----------------------------------------1
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.5480799674987793  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.5480799674987793  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 3234, 100]), torch.Size([1, 3234, 100])
----------------------------------------3
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.550489902496338  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0545654296875 GB
    Memory Allocated: 1.7053203582763672  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 3234, 100])
m.shape torch.Size([176863, 10, 100])
----------------------------------------1
 Nvidia-smi: 16.7147216796875 GB
    Memory Allocated: 2.3629817962646484  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7147216796875 GB
    Memory Allocated: 2.3629817962646484  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 176863, 100]), torch.Size([1, 176863, 100])
----------------------------------------3
 Nvidia-smi: 16.7147216796875 GB
    Memory Allocated: 2.494755744934082  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 11.852669715881348  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 176863, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 11.149380207061768  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 11.339747905731201  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 11.530115604400635  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 11.339747905731201  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

torch.Size([199615, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 11.530115604400635  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 11.577707767486572  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 11.577707767486572  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

m.shape torch.Size([29, 1, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.24862813949585  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.24862813949585  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.248683452606201  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.249125957489014  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([44, 2, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.249183177947998  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.249183177947998  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.249267101287842  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.250525951385498  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([48, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.250622749328613  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.250622749328613  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.250714302062988  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.252728462219238  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([66, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.252936840057373  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.252936840057373  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.253062725067139  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.256713390350342  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([82, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.257044792175293  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.257044792175293  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.257201194763184  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.262831687927246  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([92, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.26328420639038  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.26328420639038  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.2634596824646  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.271005153656006  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([93, 7, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.271543502807617  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.271543502807617  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.271720886230469  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.280590057373047  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([93, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.281216621398926  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.281216621398926  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.281394004821777  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.291504859924316  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.292177677154541  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.292177677154541  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.292345523834229  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.303087711334229  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([112, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.304096698760986  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.304096698760986  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.304310321807861  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.319477558135986  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.320583820343018  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.320583820343018  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.320799350738525  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.337610721588135  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([102, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.338748455047607  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.338748455047607  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.338943004608154  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.355479717254639  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([135, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.357585906982422  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.357585906982422  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.357843399047852  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.381532669067383  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([127, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.383112907409668  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.383112907409668  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.383355140686035  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.407336235046387  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([103, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.408858299255371  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.408858299255371  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.40905475616455  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.429879188537598  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([121, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.431642055511475  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.431642055511475  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.431872844696045  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.45795202255249  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([108, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.460294723510742  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.460294723510742  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.460500717163086  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.485219955444336  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([94, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.486743450164795  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.486743450164795  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.48692274093628  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.509692668914795  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([114, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.511684894561768  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.511684894561768  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.511902332305908  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.541038990020752  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([111, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.54306411743164  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.54306411743164  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.543275833129883  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.573127746582031  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([115, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.575826168060303  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.575826168060303  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.576045513153076  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.608508586883545  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([109, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.610703945159912  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.610703945159912  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.610911846160889  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.643136501312256  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([128, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.645862102508545  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.645862102508545  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.646106243133545  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.685657024383545  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([103, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.687911033630371  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.687911033630371  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.68810749053955  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 12.721308708190918  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([26579, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 13.359854221343994  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 13.359854221343994  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

 h.shape torch.Size([1, 26579, 256]), torch.Size([1, 26579, 256])
----------------------------------------3
 Nvidia-smi: 21.5936279296875 GB
    Memory Allocated: 13.410549640655518  GigaBytes
Max Memory Allocated: 21.08061408996582  GigaBytes

