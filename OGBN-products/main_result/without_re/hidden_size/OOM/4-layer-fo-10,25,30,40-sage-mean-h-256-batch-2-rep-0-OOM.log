main start at this time 1656050544.2240705
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.44455838203430176
global_2_local spend time (sec) 0.45914220809936523
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.08206963539123535
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1181171, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.1254866123199463
auxiliary_graph
Graph(num_nodes=1377742, num_edges=101873543,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.7060439586639404
remove nodes length  1181171

auxiliary_graph.remove_nodes spent  5.56329345703125
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101873543,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  3.9917306900024414

the counter of shared neighbor distribution
Counter({1.0: 76625834, 2.0: 14048222, 3.0: 5011620, 4.0: 2308328, 5.0: 1244288, 6.0: 737614, 7.0: 469104, 8.0: 320932, 9.0: 223716, 10.0: 162494, 11.0: 118854, 12.0: 89870, 13.0: 69466, 14.0: 53028, 15.0: 41764, 16.0: 31248, 17.0: 22002, 18.0: 19492, 19.0: 13018, 20.0: 10882, 21.0: 7144, 22.0: 5740, 23.0: 4796, 24.0: 3814, 25.0: 3584, 33.0: 3046, 28.0: 2926, 26.0: 2688, 30.0: 2312, 27.0: 2286, 31.0: 2154, 39.0: 2098, 32.0: 2040, 35.0: 1750, 29.0: 1680, 37.0: 1650, 36.0: 1526, 38.0: 1460, 34.0: 1422, 40.0: 1080})
101676972
Convert a graph into a bidirected graph: 7.200 seconds
Metis partitioning: 22.346 seconds
Split the graph: 11.560 seconds
Construct subgraphs: 0.057 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  41.20557355880737
100369
96202
total k batches seeds list generation spend  72.30342602729797
after graph partition
graph partition algorithm spend time 73.5884907245636
100369
96202
partition_len_list
[720831, 765107]
REG selection method  spend 74.3332839012146
time for parepare:  0.2822685241699219
local_output_nid generation:  0.013288259506225586
local_in_edges_tensor generation:  0.06519341468811035
mini_batch_src_global generation:  0.11095404624938965
r_  generation:  1.7294893264770508
local_output_nid generation:  0.01561737060546875
local_in_edges_tensor generation:  0.09008550643920898
mini_batch_src_global generation:  0.13596224784851074
r_  generation:  1.6722664833068848
----------------------check_connections_block total spend ----------------------------- 4.733366966247559
generate_one_block  3.4889204502105713
generate_one_block  1.9918277263641357
The real block id is  2
get_global_graph_edges_ids_block function  spend 1.9365661144256592
gen group dst list time:  0.04551982879638672
time for parepare:  0.44925928115844727
local_output_nid generation:  0.11975407600402832
local_in_edges_tensor generation:  0.4548466205596924
mini_batch_src_global generation:  0.5379366874694824
r_  generation:  7.979278087615967
local_output_nid generation:  0.13242745399475098
local_in_edges_tensor generation:  0.40581226348876953
mini_batch_src_global generation:  0.7535455226898193
r_  generation:  8.804827213287354
----------------------check_connections_block total spend ----------------------------- 22.52697253227234
generate_one_block  10.332017660140991
generate_one_block  10.946806907653809
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.38856840133667
gen group dst list time:  0.12819266319274902
time for parepare:  0.49643516540527344
local_output_nid generation:  0.33574748039245605
local_in_edges_tensor generation:  0.8894309997558594
mini_batch_src_global generation:  0.9073185920715332
r_  generation:  13.585689544677734
local_output_nid generation:  0.3645210266113281
local_in_edges_tensor generation:  0.8478240966796875
mini_batch_src_global generation:  1.266873836517334
r_  generation:  13.741912841796875
----------------------check_connections_block total spend ----------------------------- 37.42461657524109
generate_one_block  16.68039608001709
generate_one_block  17.617780447006226
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.1348743438720703
gen group dst list time:  0.1421804428100586
time for parepare:  0.4752323627471924
local_output_nid generation:  0.5277867317199707
local_in_edges_tensor generation:  0.9434211254119873
mini_batch_src_global generation:  0.5920116901397705
r_  generation:  9.928105354309082
local_output_nid generation:  0.5560333728790283
local_in_edges_tensor generation:  0.8444857597351074
mini_batch_src_global generation:  0.7507727146148682
r_  generation:  9.290794610977173
----------------------check_connections_block total spend ----------------------------- 27.73940682411194
generate_one_block  12.360468626022339
generate_one_block  11.92167067527771
----------===============-------------===============-------------the number of batches *****---- 2

original number of batches:  2
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

connection checking time:  92.42436289787292
block generation total time  85.33988857269287
average batch blocks generation time:  10.667486071586609
block dataloader generation time/epoch 265.85053539276123
pseudo mini batch 0 input nodes size: 2207973
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.8237910270690918  GigaBytes
Max Memory Allocated: 0.8237910270690918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.8245391845703125  GigaBytes
Max Memory Allocated: 0.8245391845703125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.8245391845703125  GigaBytes
Max Memory Allocated: 0.8245391845703125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4315185546875 GB
    Memory Allocated: 1.3386592864990234  GigaBytes
Max Memory Allocated: 1.3386592864990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4315185546875 GB
    Memory Allocated: 1.3386592864990234  GigaBytes
Max Memory Allocated: 1.3386592864990234  GigaBytes

first layer input nodes number: 2207973
first layer output nodes number: 2063446
edges number: 18523004
torch.Size([2207973, 100])
torch.Size([2063446, 256])
input nodes number: 2063446
output nodes number: 1466261
edges number: 28635674
torch.Size([2063446, 256])
torch.Size([1466261, 256])
input nodes number: 1466261
output nodes number: 720831
edges number: 17844092
torch.Size([1466261, 256])
torch.Size([720831, 256])
torch.Size([100369, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7362060546875 GB
    Memory Allocated: 14.059646129608154  GigaBytes
Max Memory Allocated: 14.587148189544678  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7362060546875 GB
    Memory Allocated: 14.077220916748047  GigaBytes
Max Memory Allocated: 14.587148189544678  GigaBytes

