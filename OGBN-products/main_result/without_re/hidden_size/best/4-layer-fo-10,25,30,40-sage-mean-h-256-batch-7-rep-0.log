main start at this time 1656052440.521524
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.34961414337158203
global_2_local spend time (sec) 0.42702436447143555
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.07545232772827148
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1181171, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.12159204483032227
auxiliary_graph
Graph(num_nodes=1377742, num_edges=101873543,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.7016351222991943
remove nodes length  1181171

auxiliary_graph.remove_nodes spent  5.660468339920044
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101873543,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.382791519165039

the counter of shared neighbor distribution
Counter({1.0: 76625834, 2.0: 14048222, 3.0: 5011620, 4.0: 2308328, 5.0: 1244288, 6.0: 737614, 7.0: 469104, 8.0: 320932, 9.0: 223716, 10.0: 162494, 11.0: 118854, 12.0: 89870, 13.0: 69466, 14.0: 53028, 15.0: 41764, 16.0: 31248, 17.0: 22002, 18.0: 19492, 19.0: 13018, 20.0: 10882, 21.0: 7144, 22.0: 5740, 23.0: 4796, 24.0: 3814, 25.0: 3584, 33.0: 3046, 28.0: 2926, 26.0: 2688, 30.0: 2312, 27.0: 2286, 31.0: 2154, 39.0: 2098, 32.0: 2040, 35.0: 1750, 29.0: 1680, 37.0: 1650, 36.0: 1526, 38.0: 1460, 34.0: 1422, 40.0: 1080})
101676972
Convert a graph into a bidirected graph: 6.560 seconds
Metis partitioning: 22.750 seconds
Split the graph: 4.050 seconds
Construct subgraphs: 0.035 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  33.436819553375244
28551
27347
27803
28878
27649
27965
28378
total k batches seeds list generation spend  65.07301068305969
after graph partition
graph partition algorithm spend time 66.1133189201355
28551
27347
27803
28878
27649
27965
28378
partition_len_list
[220079, 252856, 251480, 283515, 268625, 303711, 273890]
REG selection method  spend 66.81247043609619
time for parepare:  0.2897496223449707
local_output_nid generation:  0.006335735321044922
local_in_edges_tensor generation:  0.013229131698608398
mini_batch_src_global generation:  0.03343462944030762
r_  generation:  0.37937378883361816
local_output_nid generation:  0.008058786392211914
local_in_edges_tensor generation:  0.06873035430908203
mini_batch_src_global generation:  0.03987765312194824
r_  generation:  0.3991856575012207
local_output_nid generation:  0.009649276733398438
local_in_edges_tensor generation:  0.03964948654174805
mini_batch_src_global generation:  0.03676462173461914
r_  generation:  0.4060232639312744
local_output_nid generation:  0.007378339767456055
local_in_edges_tensor generation:  0.01622915267944336
mini_batch_src_global generation:  0.04243969917297363
r_  generation:  0.452786922454834
local_output_nid generation:  0.007282733917236328
local_in_edges_tensor generation:  0.009872198104858398
mini_batch_src_global generation:  0.03882789611816406
r_  generation:  0.41629624366760254
local_output_nid generation:  0.0073359012603759766
local_in_edges_tensor generation:  0.016107797622680664
mini_batch_src_global generation:  0.06564211845397949
r_  generation:  0.4969606399536133
local_output_nid generation:  0.007291555404663086
local_in_edges_tensor generation:  0.019231081008911133
mini_batch_src_global generation:  0.048690080642700195
r_  generation:  0.4982120990753174
----------------------check_connections_block total spend ----------------------------- 4.495684385299683
generate_one_block  1.91508150100708
generate_one_block  0.4996683597564697
generate_one_block  0.5036098957061768
generate_one_block  0.5539953708648682
generate_one_block  0.5612423419952393
generate_one_block  0.5745337009429932
generate_one_block  0.581298828125
The real block id is  2
get_global_graph_edges_ids_block function  spend 1.9886248111724854
gen group dst list time:  0.05279803276062012
time for parepare:  0.4571044445037842
local_output_nid generation:  0.05386948585510254
local_in_edges_tensor generation:  0.22861623764038086
mini_batch_src_global generation:  0.174546480178833
r_  generation:  2.0474655628204346
local_output_nid generation:  0.07121062278747559
local_in_edges_tensor generation:  0.1758713722229004
mini_batch_src_global generation:  0.2509429454803467
r_  generation:  2.6594629287719727
local_output_nid generation:  0.0745840072631836
local_in_edges_tensor generation:  0.21983695030212402
mini_batch_src_global generation:  0.2617945671081543
r_  generation:  2.4800336360931396
local_output_nid generation:  0.08004570007324219
local_in_edges_tensor generation:  0.19471263885498047
mini_batch_src_global generation:  0.28075265884399414
r_  generation:  3.0246145725250244
local_output_nid generation:  0.07728934288024902
local_in_edges_tensor generation:  0.31884050369262695
mini_batch_src_global generation:  0.31027793884277344
r_  generation:  3.074425458908081
local_output_nid generation:  0.09772515296936035
local_in_edges_tensor generation:  0.23691272735595703
mini_batch_src_global generation:  0.3330566883087158
r_  generation:  3.5627965927124023
local_output_nid generation:  0.07007813453674316
local_in_edges_tensor generation:  0.20341730117797852
mini_batch_src_global generation:  0.334320068359375
r_  generation:  3.1642682552337646
----------------------check_connections_block total spend ----------------------------- 28.146565675735474
generate_one_block  3.2319016456604004
generate_one_block  3.4387025833129883
generate_one_block  3.1608340740203857
generate_one_block  3.9287164211273193
generate_one_block  4.264698266983032
generate_one_block  4.607460260391235
generate_one_block  3.9744226932525635
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2437191009521484
gen group dst list time:  0.21505355834960938
time for parepare:  0.4763963222503662
local_output_nid generation:  0.18247008323669434
local_in_edges_tensor generation:  0.4875965118408203
mini_batch_src_global generation:  0.42629218101501465
r_  generation:  5.88286566734314
local_output_nid generation:  0.3205251693725586
local_in_edges_tensor generation:  0.6801936626434326
mini_batch_src_global generation:  0.7007336616516113
r_  generation:  8.316225290298462
local_output_nid generation:  0.25855064392089844
local_in_edges_tensor generation:  0.6266160011291504
mini_batch_src_global generation:  0.6338770389556885
r_  generation:  6.922466039657593
local_output_nid generation:  0.27519702911376953
local_in_edges_tensor generation:  0.5399580001831055
mini_batch_src_global generation:  0.7454943656921387
r_  generation:  8.815557956695557
local_output_nid generation:  0.27783679962158203
local_in_edges_tensor generation:  0.6827142238616943
mini_batch_src_global generation:  0.8119878768920898
r_  generation:  9.169163942337036
local_output_nid generation:  0.30634498596191406
local_in_edges_tensor generation:  0.5721988677978516
mini_batch_src_global generation:  0.834068775177002
r_  generation:  9.290313243865967
local_output_nid generation:  0.24466466903686523
local_in_edges_tensor generation:  0.6129109859466553
mini_batch_src_global generation:  0.7499094009399414
r_  generation:  8.224302768707275
----------------------check_connections_block total spend ----------------------------- 77.96944570541382
generate_one_block  7.869121313095093
generate_one_block  10.63893747329712
generate_one_block  8.64460277557373
generate_one_block  10.64538836479187
generate_one_block  11.988300323486328
generate_one_block  11.276033163070679
generate_one_block  10.090670347213745
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.0798149108886719
gen group dst list time:  0.43324756622314453
time for parepare:  0.4811060428619385
local_output_nid generation:  0.4851970672607422
local_in_edges_tensor generation:  0.8378820419311523
mini_batch_src_global generation:  0.46922779083251953
r_  generation:  8.026182174682617
local_output_nid generation:  0.6255710124969482
local_in_edges_tensor generation:  0.9100892543792725
mini_batch_src_global generation:  0.6555018424987793
r_  generation:  8.176109790802002
local_output_nid generation:  0.5646848678588867
local_in_edges_tensor generation:  0.8451733589172363
mini_batch_src_global generation:  0.6381900310516357
r_  generation:  7.899457216262817
local_output_nid generation:  0.5668168067932129
local_in_edges_tensor generation:  0.7893586158752441
mini_batch_src_global generation:  0.7102746963500977
r_  generation:  8.91211462020874
local_output_nid generation:  0.6055676937103271
local_in_edges_tensor generation:  0.852550745010376
mini_batch_src_global generation:  0.6670258045196533
r_  generation:  8.65114140510559
local_output_nid generation:  0.6188948154449463
local_in_edges_tensor generation:  0.8682408332824707
mini_batch_src_global generation:  0.6516966819763184
r_  generation:  8.51488733291626
local_output_nid generation:  0.5091714859008789
local_in_edges_tensor generation:  0.7676987648010254
mini_batch_src_global generation:  0.6353623867034912
r_  generation:  7.9579315185546875
----------------------check_connections_block total spend ----------------------------- 84.79345560073853
generate_one_block  9.436800241470337
generate_one_block  10.044826030731201
generate_one_block  10.141690492630005
generate_one_block  10.283140659332275
generate_one_block  10.985952615737915
generate_one_block  10.210230350494385
generate_one_block  9.271463871002197
----------===============-------------===============-------------the number of batches *****---- 7

original number of batches:  7
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

connection checking time:  195.4051513671875
block generation total time  173.32332396507263
average batch blocks generation time:  6.190118713038308
block dataloader generation time/epoch 452.507541179657
pseudo mini batch 0 input nodes size: 1981982
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.7396030426025391  GigaBytes
Max Memory Allocated: 0.7396030426025391  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.7398161888122559  GigaBytes
Max Memory Allocated: 0.7398161888122559  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.7398161888122559  GigaBytes
Max Memory Allocated: 0.7398161888122559  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.9991650581359863  GigaBytes
Max Memory Allocated: 0.9991650581359863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.9991650581359863  GigaBytes
Max Memory Allocated: 0.9991650581359863  GigaBytes

first layer input nodes number: 1981982
first layer output nodes number: 1545544
edges number: 14345159
torch.Size([1981982, 100])
torch.Size([1545544, 256])
input nodes number: 1545544
output nodes number: 656426
edges number: 13554600
torch.Size([1545544, 256])
torch.Size([656426, 256])
input nodes number: 656426
output nodes number: 220079
edges number: 5605107
torch.Size([656426, 256])
torch.Size([220079, 256])
torch.Size([28551, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4842529296875 GB
    Memory Allocated: 7.969969272613525  GigaBytes
Max Memory Allocated: 8.134475231170654  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4842529296875 GB
    Memory Allocated: 7.974969387054443  GigaBytes
Max Memory Allocated: 8.134475231170654  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.9569091796875 GB
    Memory Allocated: 1.4834861755371094  GigaBytes
Max Memory Allocated: 8.561778545379639  GigaBytes

pseudo mini batch 1 input nodes size: 2060093
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.9569091796875 GB
    Memory Allocated: 0.7460732460021973  GigaBytes
Max Memory Allocated: 8.561778545379639  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.9569091796875 GB
    Memory Allocated: 0.7460732460021973  GigaBytes
Max Memory Allocated: 8.561778545379639  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.9569091796875 GB
    Memory Allocated: 1.5135178565979004  GigaBytes
Max Memory Allocated: 8.561778545379639  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.9569091796875 GB
    Memory Allocated: 1.5137219429016113  GigaBytes
Max Memory Allocated: 8.561778545379639  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.9569091796875 GB
    Memory Allocated: 0.7751626968383789  GigaBytes
Max Memory Allocated: 8.561778545379639  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.9569091796875 GB
    Memory Allocated: 1.090188980102539  GigaBytes
Max Memory Allocated: 8.561778545379639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9569091796875 GB
    Memory Allocated: 1.090188980102539  GigaBytes
Max Memory Allocated: 8.561778545379639  GigaBytes

first layer input nodes number: 2060093
first layer output nodes number: 1744206
edges number: 16057385
torch.Size([2060093, 100])
torch.Size([1744206, 256])
input nodes number: 1744206
output nodes number: 890884
edges number: 18707929
torch.Size([1744206, 256])
torch.Size([890884, 256])
input nodes number: 890884
output nodes number: 252856
edges number: 6478143
torch.Size([890884, 256])
torch.Size([252856, 256])
torch.Size([27347, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1776123046875 GB
    Memory Allocated: 9.448394298553467  GigaBytes
Max Memory Allocated: 9.65018606185913  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.1776123046875 GB
    Memory Allocated: 9.4531831741333  GigaBytes
Max Memory Allocated: 9.65018606185913  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 1.6806116104125977  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

pseudo mini batch 2 input nodes size: 2057664
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 0.7749519348144531  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 0.7749519348144531  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 1.5414915084838867  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 1.541698932647705  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 0.774050235748291  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 1.0566182136535645  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 1.0566182136535645  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

first layer input nodes number: 2057664
first layer output nodes number: 1689842
edges number: 15509298
torch.Size([2057664, 100])
torch.Size([1689842, 256])
input nodes number: 1689842
output nodes number: 782341
edges number: 15393454
torch.Size([1689842, 256])
torch.Size([782341, 256])
input nodes number: 782341
output nodes number: 251480
edges number: 5984882
torch.Size([782341, 256])
torch.Size([251480, 256])
torch.Size([27803, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 8.89917516708374  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 8.904043674468994  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 1.5813055038452148  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

pseudo mini batch 3 input nodes size: 2056019
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 0.7741298675537109  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 0.7741298675537109  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 1.5400567054748535  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 1.5402722358703613  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 0.7735252380371094  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 1.101029396057129  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0311279296875 GB
    Memory Allocated: 1.101029396057129  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

first layer input nodes number: 2056019
first layer output nodes number: 1739338
edges number: 16263545
torch.Size([2056019, 100])
torch.Size([1739338, 256])
input nodes number: 1739338
output nodes number: 903022
edges number: 19278723
torch.Size([1739338, 256])
torch.Size([903022, 256])
input nodes number: 903022
output nodes number: 283515
edges number: 7325547
torch.Size([903022, 256])
torch.Size([283515, 256])
torch.Size([28878, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 9.594434261322021  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 9.599491119384766  GigaBytes
Max Memory Allocated: 10.392261028289795  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 1.717130184173584  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

pseudo mini batch 4 input nodes size: 2022787
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 0.7737135887145996  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 0.7737135887145996  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 1.5272607803344727  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 1.5274672508239746  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 0.7613248825073242  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 1.0935754776000977  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 1.0935754776000977  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

first layer input nodes number: 2022787
first layer output nodes number: 1697588
edges number: 15856496
torch.Size([2022787, 100])
torch.Size([1697588, 256])
input nodes number: 1697588
output nodes number: 924200
edges number: 20425549
torch.Size([1697588, 256])
torch.Size([924200, 256])
input nodes number: 924200
output nodes number: 268625
edges number: 7332249
torch.Size([924200, 256])
torch.Size([268625, 256])
torch.Size([27649, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 9.502495288848877  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 9.507337093353271  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.7199773788452148  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

pseudo mini batch 5 input nodes size: 2041814
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 0.7611098289489746  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 0.7611098289489746  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.521745204925537  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.5219535827636719  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 0.7681999206542969  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.1099119186401367  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.1099119186401367  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

first layer input nodes number: 2041814
first layer output nodes number: 1710019
edges number: 15964789
torch.Size([2041814, 100])
torch.Size([1710019, 256])
input nodes number: 1710019
output nodes number: 914831
edges number: 20334418
torch.Size([1710019, 256])
torch.Size([914831, 256])
input nodes number: 914831
output nodes number: 303711
edges number: 8462706
torch.Size([914831, 256])
torch.Size([303711, 256])
torch.Size([27965, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 9.6415376663208  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 9.646739959716797  GigaBytes
Max Memory Allocated: 10.471680164337158  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.7560548782348633  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

pseudo mini batch 6 input nodes size: 1951869
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 0.7682552337646484  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 0.7682552337646484  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.4953832626342773  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.4955949783325195  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 0.7347512245178223  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.0431914329528809  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.0431914329528809  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

first layer input nodes number: 1951869
first layer output nodes number: 1563594
edges number: 14726767
torch.Size([1951869, 100])
torch.Size([1563594, 256])
input nodes number: 1563594
output nodes number: 810858
edges number: 18025917
torch.Size([1563594, 256])
torch.Size([810858, 256])
input nodes number: 810858
output nodes number: 273890
edges number: 7526120
torch.Size([810858, 256])
torch.Size([273890, 256])
torch.Size([28378, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 8.750373840332031  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 8.755343437194824  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.6245250701904297  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.6270389556884766  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.0623779296875 GB
    Memory Allocated: 1.6270389556884766  GigaBytes
Max Memory Allocated: 10.48829174041748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4094625881740025 |0.44649849619184223 |0.27084783145359587 |0.00016948154994419644 |0.045247282300676615 |0.0041980743408203125 |
----------------------------------------------------------pseudo_mini_loss sum 11.007647514343262
Total (block generation + training)time/epoch 460.97238421440125
Training time/epoch 8.464550256729126
Training time without block to device /epoch 5.3390607833862305
Training time without total dataloading part /epoch 2.218050241470337
load block tensor time/epoch 2.8662381172180176
block to device time/epoch 3.1254894733428955
input features size transfer per epoch 9.387731552124023e-07
blocks size to device per epoch 6.258487701416016e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  33599077
Number of first layer input nodes during this epoch:  14172228
Number of first layer output nodes during this epoch:  11690131
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  337408
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([47, 256])
layers.3.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
