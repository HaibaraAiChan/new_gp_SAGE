main start at this time 1656053452.7825923
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.34512877464294434
global_2_local spend time (sec) 0.43422555923461914
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.07629561424255371
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1181171, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.12076950073242188
auxiliary_graph
Graph(num_nodes=1377742, num_edges=101873543,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6878323554992676
remove nodes length  1181171

auxiliary_graph.remove_nodes spent  5.676799535751343
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101873543,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.090204954147339

the counter of shared neighbor distribution
Counter({1.0: 76625834, 2.0: 14048222, 3.0: 5011620, 4.0: 2308328, 5.0: 1244288, 6.0: 737614, 7.0: 469104, 8.0: 320932, 9.0: 223716, 10.0: 162494, 11.0: 118854, 12.0: 89870, 13.0: 69466, 14.0: 53028, 15.0: 41764, 16.0: 31248, 17.0: 22002, 18.0: 19492, 19.0: 13018, 20.0: 10882, 21.0: 7144, 22.0: 5740, 23.0: 4796, 24.0: 3814, 25.0: 3584, 33.0: 3046, 28.0: 2926, 26.0: 2688, 30.0: 2312, 27.0: 2286, 31.0: 2154, 39.0: 2098, 32.0: 2040, 35.0: 1750, 29.0: 1680, 37.0: 1650, 36.0: 1526, 38.0: 1460, 34.0: 1422, 40.0: 1080})
101676972
Convert a graph into a bidirected graph: 6.396 seconds
Metis partitioning: 24.162 seconds
Split the graph: 2.642 seconds
Construct subgraphs: 0.043 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  33.28457760810852
12577
11942
12572
11927
12654
12033
12654
12306
12553
12644
12365
11968
11927
12359
12077
12013
total k batches seeds list generation spend  64.02128481864929
after graph partition
graph partition algorithm spend time 64.85688543319702
12577
11942
12572
11927
12654
12033
12654
12306
12553
12644
12365
11968
11927
12359
12077
12013
partition_len_list
[116427, 112159, 142093, 142460, 127014, 140312, 93121, 110749, 160730, 113125, 133213, 125442, 136872, 137069, 135271, 154595]
REG selection method  spend 65.55049467086792
time for parepare:  0.3270378112792969
local_output_nid generation:  0.005419254302978516
local_in_edges_tensor generation:  0.005569934844970703
mini_batch_src_global generation:  0.016324520111083984
r_  generation:  0.1501448154449463
local_output_nid generation:  0.005605459213256836
local_in_edges_tensor generation:  0.005768299102783203
mini_batch_src_global generation:  0.0194549560546875
r_  generation:  0.1506481170654297
local_output_nid generation:  0.00591731071472168
local_in_edges_tensor generation:  0.005351066589355469
mini_batch_src_global generation:  0.017954349517822266
r_  generation:  0.17247533798217773
local_output_nid generation:  0.005783557891845703
local_in_edges_tensor generation:  0.005615949630737305
mini_batch_src_global generation:  0.020574092864990234
r_  generation:  0.1690080165863037
local_output_nid generation:  0.00599360466003418
local_in_edges_tensor generation:  0.006012439727783203
mini_batch_src_global generation:  0.02176666259765625
r_  generation:  0.18566584587097168
local_output_nid generation:  0.005808115005493164
local_in_edges_tensor generation:  0.005780696868896484
mini_batch_src_global generation:  0.02239203453063965
r_  generation:  0.1864304542541504
local_output_nid generation:  0.006041765213012695
local_in_edges_tensor generation:  0.005793571472167969
mini_batch_src_global generation:  0.02252054214477539
r_  generation:  0.16811108589172363
local_output_nid generation:  0.005967855453491211
local_in_edges_tensor generation:  0.005969524383544922
mini_batch_src_global generation:  0.03972673416137695
r_  generation:  0.17191433906555176
local_output_nid generation:  0.006031513214111328
local_in_edges_tensor generation:  0.005872488021850586
mini_batch_src_global generation:  0.02770686149597168
r_  generation:  0.18905401229858398
local_output_nid generation:  0.00602412223815918
local_in_edges_tensor generation:  0.006517171859741211
mini_batch_src_global generation:  0.021786928176879883
r_  generation:  0.18918061256408691
local_output_nid generation:  0.007024288177490234
local_in_edges_tensor generation:  0.022098064422607422
mini_batch_src_global generation:  0.019985675811767578
r_  generation:  0.16595768928527832
local_output_nid generation:  0.005841493606567383
local_in_edges_tensor generation:  0.012151241302490234
mini_batch_src_global generation:  0.01957559585571289
r_  generation:  0.17595458030700684
local_output_nid generation:  0.00583195686340332
local_in_edges_tensor generation:  0.009030818939208984
mini_batch_src_global generation:  0.024807214736938477
r_  generation:  0.18575835227966309
local_output_nid generation:  0.005993366241455078
local_in_edges_tensor generation:  0.007861614227294922
mini_batch_src_global generation:  0.023271799087524414
r_  generation:  0.18988728523254395
local_output_nid generation:  0.0058956146240234375
local_in_edges_tensor generation:  0.00581812858581543
mini_batch_src_global generation:  0.021151304244995117
r_  generation:  0.1990821361541748
local_output_nid generation:  0.0058727264404296875
local_in_edges_tensor generation:  0.006902933120727539
mini_batch_src_global generation:  0.02234935760498047
r_  generation:  0.1881718635559082
----------------------check_connections_block total spend ----------------------------- 4.369786739349365
generate_one_block  1.6520004272460938
generate_one_block  0.20483613014221191
generate_one_block  0.23027276992797852
generate_one_block  0.28182315826416016
generate_one_block  0.23996829986572266
generate_one_block  0.22964119911193848
generate_one_block  0.20795011520385742
generate_one_block  0.21838712692260742
generate_one_block  0.24457240104675293
generate_one_block  0.2118206024169922
generate_one_block  0.21064519882202148
generate_one_block  0.20728516578674316
generate_one_block  0.2354114055633545
generate_one_block  0.23984622955322266
generate_one_block  0.23232793807983398
generate_one_block  0.23235154151916504
The real block id is  2
get_global_graph_edges_ids_block function  spend 1.871093511581421
gen group dst list time:  0.060842275619506836
time for parepare:  0.45341968536376953
local_output_nid generation:  0.031369686126708984
local_in_edges_tensor generation:  0.15673446655273438
mini_batch_src_global generation:  0.0870218276977539
r_  generation:  1.0225918292999268
local_output_nid generation:  0.03391432762145996
local_in_edges_tensor generation:  0.07137846946716309
mini_batch_src_global generation:  0.1096808910369873
r_  generation:  1.0284631252288818
local_output_nid generation:  0.04094290733337402
local_in_edges_tensor generation:  0.08904194831848145
mini_batch_src_global generation:  0.1258699893951416
r_  generation:  1.3354921340942383
local_output_nid generation:  0.04279613494873047
local_in_edges_tensor generation:  0.07539916038513184
mini_batch_src_global generation:  0.14036798477172852
r_  generation:  1.4733195304870605
local_output_nid generation:  0.03700709342956543
local_in_edges_tensor generation:  0.05935502052307129
mini_batch_src_global generation:  0.13761067390441895
r_  generation:  1.3350036144256592
local_output_nid generation:  0.03900146484375
local_in_edges_tensor generation:  0.07289624214172363
mini_batch_src_global generation:  0.15790963172912598
r_  generation:  1.5023224353790283
local_output_nid generation:  0.02487659454345703
local_in_edges_tensor generation:  0.029649734497070312
mini_batch_src_global generation:  0.1071622371673584
r_  generation:  0.832343339920044
local_output_nid generation:  0.031328678131103516
local_in_edges_tensor generation:  0.0631248950958252
mini_batch_src_global generation:  0.10928654670715332
r_  generation:  1.0996620655059814
local_output_nid generation:  0.0433807373046875
local_in_edges_tensor generation:  0.08077383041381836
mini_batch_src_global generation:  0.17334246635437012
r_  generation:  1.7572977542877197
local_output_nid generation:  0.029129981994628906
local_in_edges_tensor generation:  0.05568194389343262
mini_batch_src_global generation:  0.12063980102539062
r_  generation:  1.0587186813354492
local_output_nid generation:  0.04161953926086426
local_in_edges_tensor generation:  0.06670832633972168
mini_batch_src_global generation:  0.14361906051635742
r_  generation:  1.4386110305786133
local_output_nid generation:  0.038079261779785156
local_in_edges_tensor generation:  0.08900213241577148
mini_batch_src_global generation:  0.1406540870666504
r_  generation:  1.3682456016540527
local_output_nid generation:  0.0385589599609375
local_in_edges_tensor generation:  0.09479475021362305
mini_batch_src_global generation:  0.15026116371154785
r_  generation:  1.4780147075653076
local_output_nid generation:  0.03887510299682617
local_in_edges_tensor generation:  0.07926726341247559
mini_batch_src_global generation:  0.15266942977905273
r_  generation:  1.4921197891235352
local_output_nid generation:  0.038326263427734375
local_in_edges_tensor generation:  0.0694735050201416
mini_batch_src_global generation:  0.153045654296875
r_  generation:  1.4809880256652832
local_output_nid generation:  0.045660972595214844
local_in_edges_tensor generation:  0.08913612365722656
mini_batch_src_global generation:  0.178999662399292
r_  generation:  1.7722761631011963
----------------------check_connections_block total spend ----------------------------- 30.03067898750305
generate_one_block  1.6834311485290527
generate_one_block  1.4777648448944092
generate_one_block  1.7525629997253418
generate_one_block  1.9480929374694824
generate_one_block  1.6558637619018555
generate_one_block  1.9445984363555908
generate_one_block  1.0243501663208008
generate_one_block  1.3303229808807373
generate_one_block  2.253005027770996
generate_one_block  1.3157787322998047
generate_one_block  1.8634414672851562
generate_one_block  1.8438270092010498
generate_one_block  1.917975902557373
generate_one_block  1.9728703498840332
generate_one_block  1.980891466140747
generate_one_block  2.1719532012939453
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.3171050548553467
gen group dst list time:  0.26668238639831543
time for parepare:  0.4321174621582031
local_output_nid generation:  0.1253833770751953
local_in_edges_tensor generation:  0.4200778007507324
mini_batch_src_global generation:  0.27068543434143066
r_  generation:  3.3961939811706543
local_output_nid generation:  0.14173674583435059
local_in_edges_tensor generation:  0.26889801025390625
mini_batch_src_global generation:  0.3622887134552002
r_  generation:  3.799886465072632
local_output_nid generation:  0.1602156162261963
local_in_edges_tensor generation:  0.29886746406555176
mini_batch_src_global generation:  0.3921523094177246
r_  generation:  4.346482753753662
local_output_nid generation:  0.22580552101135254
local_in_edges_tensor generation:  0.44385528564453125
mini_batch_src_global generation:  0.5619475841522217
r_  generation:  6.42130184173584
local_output_nid generation:  0.15857744216918945
local_in_edges_tensor generation:  0.3240013122558594
mini_batch_src_global generation:  0.4870879650115967
r_  generation:  4.880007028579712
local_output_nid generation:  0.17458701133728027
local_in_edges_tensor generation:  0.35703229904174805
mini_batch_src_global generation:  0.536461353302002
r_  generation:  5.551467418670654
local_output_nid generation:  0.0843038558959961
local_in_edges_tensor generation:  0.2529730796813965
mini_batch_src_global generation:  0.31498050689697266
r_  generation:  2.3921632766723633
local_output_nid generation:  0.16902613639831543
local_in_edges_tensor generation:  0.2921154499053955
mini_batch_src_global generation:  0.3593754768371582
r_  generation:  3.8728935718536377
local_output_nid generation:  0.24785542488098145
local_in_edges_tensor generation:  0.4839212894439697
mini_batch_src_global generation:  0.6214029788970947
r_  generation:  7.166330814361572
local_output_nid generation:  0.13907670974731445
local_in_edges_tensor generation:  0.27396607398986816
mini_batch_src_global generation:  0.46040844917297363
r_  generation:  4.225377321243286
local_output_nid generation:  0.2001035213470459
local_in_edges_tensor generation:  0.3993098735809326
mini_batch_src_global generation:  0.5630743503570557
r_  generation:  6.360292911529541
local_output_nid generation:  0.24426960945129395
local_in_edges_tensor generation:  0.6183679103851318
mini_batch_src_global generation:  0.6171660423278809
r_  generation:  6.511271953582764
local_output_nid generation:  0.18913936614990234
local_in_edges_tensor generation:  0.9120991230010986
mini_batch_src_global generation:  0.5475695133209229
r_  generation:  5.3551552295684814
local_output_nid generation:  0.17763423919677734
local_in_edges_tensor generation:  0.36155128479003906
mini_batch_src_global generation:  0.5478157997131348
r_  generation:  5.7551491260528564
local_output_nid generation:  0.1796419620513916
local_in_edges_tensor generation:  0.4847850799560547
mini_batch_src_global generation:  0.572983980178833
r_  generation:  5.724235773086548
local_output_nid generation:  0.24196457862854004
local_in_edges_tensor generation:  0.4334099292755127
mini_batch_src_global generation:  0.6065099239349365
r_  generation:  6.588138103485107
----------------------check_connections_block total spend ----------------------------- 115.16668844223022
generate_one_block  5.142786502838135
generate_one_block  5.259410619735718
generate_one_block  6.126393795013428
generate_one_block  8.805282831192017
generate_one_block  6.258284568786621
generate_one_block  7.3359904289245605
generate_one_block  2.9228103160858154
generate_one_block  5.102157831192017
generate_one_block  9.177286148071289
generate_one_block  5.682727336883545
generate_one_block  7.723690032958984
generate_one_block  8.463213205337524
generate_one_block  6.8940770626068115
generate_one_block  7.185070276260376
generate_one_block  7.130303621292114
generate_one_block  8.140538215637207
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.221384048461914
gen group dst list time:  0.8291854858398438
time for parepare:  0.4672396183013916
local_output_nid generation:  0.44002795219421387
local_in_edges_tensor generation:  0.7171108722686768
mini_batch_src_global generation:  0.3670516014099121
r_  generation:  5.529895305633545
local_output_nid generation:  0.46170973777770996
local_in_edges_tensor generation:  0.7205972671508789
mini_batch_src_global generation:  0.4980733394622803
r_  generation:  5.894812345504761
local_output_nid generation:  0.4568469524383545
local_in_edges_tensor generation:  0.6578350067138672
mini_batch_src_global generation:  0.495851993560791
r_  generation:  6.334111213684082
local_output_nid generation:  0.5727603435516357
local_in_edges_tensor generation:  0.9855899810791016
mini_batch_src_global generation:  0.6256499290466309
r_  generation:  7.887437582015991
local_output_nid generation:  0.4920005798339844
local_in_edges_tensor generation:  0.6851480007171631
mini_batch_src_global generation:  0.5604181289672852
r_  generation:  6.933306694030762
local_output_nid generation:  0.4998488426208496
local_in_edges_tensor generation:  0.7682595252990723
mini_batch_src_global generation:  0.5930888652801514
r_  generation:  7.357290029525757
local_output_nid generation:  0.34531378746032715
local_in_edges_tensor generation:  0.4541490077972412
mini_batch_src_global generation:  0.40784215927124023
r_  generation:  4.472957372665405
local_output_nid generation:  0.4258615970611572
local_in_edges_tensor generation:  0.6120593547821045
mini_batch_src_global generation:  0.4777088165283203
r_  generation:  6.1100523471832275
local_output_nid generation:  0.5762684345245361
local_in_edges_tensor generation:  0.8332486152648926
mini_batch_src_global generation:  0.6629672050476074
r_  generation:  8.599843978881836
local_output_nid generation:  0.46968960762023926
local_in_edges_tensor generation:  0.6940701007843018
mini_batch_src_global generation:  0.5601181983947754
r_  generation:  6.3771984577178955
local_output_nid generation:  0.5050754547119141
local_in_edges_tensor generation:  0.7524752616882324
mini_batch_src_global generation:  0.6129462718963623
r_  generation:  7.695838689804077
local_output_nid generation:  0.5467433929443359
local_in_edges_tensor generation:  0.8339939117431641
mini_batch_src_global generation:  0.6493031978607178
r_  generation:  7.675093412399292
local_output_nid generation:  0.48412585258483887
local_in_edges_tensor generation:  0.6669459342956543
mini_batch_src_global generation:  0.6305909156799316
r_  generation:  7.2121546268463135
local_output_nid generation:  0.567439079284668
local_in_edges_tensor generation:  0.8057076930999756
mini_batch_src_global generation:  0.6725389957427979
r_  generation:  7.339093923568726
local_output_nid generation:  0.4903390407562256
local_in_edges_tensor generation:  0.6934938430786133
mini_batch_src_global generation:  0.6223745346069336
r_  generation:  7.221621513366699
local_output_nid generation:  0.524921178817749
local_in_edges_tensor generation:  0.7748124599456787
mini_batch_src_global generation:  0.5794925689697266
r_  generation:  7.101539850234985
----------------------check_connections_block total spend ----------------------------- 161.73937940597534
generate_one_block  7.406885862350464
generate_one_block  7.535605430603027
generate_one_block  7.772165060043335
generate_one_block  9.781007289886475
generate_one_block  8.27207326889038
generate_one_block  9.243902444839478
generate_one_block  5.247009992599487
generate_one_block  8.365172147750854
generate_one_block  10.423582553863525
generate_one_block  7.746035814285278
generate_one_block  9.159459352493286
generate_one_block  9.476981163024902
generate_one_block  8.239946365356445
generate_one_block  8.812023639678955
generate_one_block  8.197784423828125
generate_one_block  8.920590877532959
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

connection checking time:  311.306533575058
block generation total time  275.1661186218262
average batch blocks generation time:  4.299470603466034
block dataloader generation time/epoch 672.7003173828125
pseudo mini batch 0 input nodes size: 1778261
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.6637110710144043  GigaBytes
Max Memory Allocated: 0.6637110710144043  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.6638050079345703  GigaBytes
Max Memory Allocated: 0.6638050079345703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.6638050079345703  GigaBytes
Max Memory Allocated: 0.6638050079345703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.8334636688232422  GigaBytes
Max Memory Allocated: 0.8334636688232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.8334636688232422  GigaBytes
Max Memory Allocated: 0.8334636688232422  GigaBytes

first layer input nodes number: 1778261
first layer output nodes number: 1179062
edges number: 10944891
torch.Size([1778261, 100])
torch.Size([1179062, 256])
input nodes number: 1179062
output nodes number: 417337
edges number: 8400089
torch.Size([1179062, 256])
torch.Size([417337, 256])
input nodes number: 417337
output nodes number: 116427
edges number: 2848177
torch.Size([417337, 256])
torch.Size([116427, 256])
torch.Size([12577, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0155029296875 GB
    Memory Allocated: 5.693495273590088  GigaBytes
Max Memory Allocated: 5.783962249755859  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0155029296875 GB
    Memory Allocated: 5.6956987380981445  GigaBytes
Max Memory Allocated: 5.783962249755859  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.7752685546875 GB
    Memory Allocated: 1.1470832824707031  GigaBytes
Max Memory Allocated: 6.367455959320068  GigaBytes

pseudo mini batch 1 input nodes size: 1795165
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.7752685546875 GB
    Memory Allocated: 0.6672654151916504  GigaBytes
Max Memory Allocated: 6.367455959320068  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.7752685546875 GB
    Memory Allocated: 0.6672654151916504  GigaBytes
Max Memory Allocated: 6.367455959320068  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.7752685546875 GB
    Memory Allocated: 1.3360166549682617  GigaBytes
Max Memory Allocated: 6.367455959320068  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.7752685546875 GB
    Memory Allocated: 1.3361058235168457  GigaBytes
Max Memory Allocated: 6.367455959320068  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.7752685546875 GB
    Memory Allocated: 0.6735577583312988  GigaBytes
Max Memory Allocated: 6.367455959320068  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.7752685546875 GB
    Memory Allocated: 0.853294849395752  GigaBytes
Max Memory Allocated: 6.367455959320068  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7752685546875 GB
    Memory Allocated: 0.853294849395752  GigaBytes
Max Memory Allocated: 6.367455959320068  GigaBytes

first layer input nodes number: 1795165
first layer output nodes number: 1255906
edges number: 11681154
torch.Size([1795165, 100])
torch.Size([1255906, 256])
input nodes number: 1255906
output nodes number: 445235
edges number: 9175417
torch.Size([1255906, 256])
torch.Size([445235, 256])
input nodes number: 445235
output nodes number: 112159
edges number: 2785772
torch.Size([445235, 256])
torch.Size([112159, 256])
torch.Size([11942, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4022216796875 GB
    Memory Allocated: 5.986478328704834  GigaBytes
Max Memory Allocated: 6.367455959320068  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4022216796875 GB
    Memory Allocated: 5.989153861999512  GigaBytes
Max Memory Allocated: 6.367455959320068  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.6756591796875 GB
    Memory Allocated: 1.1810293197631836  GigaBytes
Max Memory Allocated: 6.739223957061768  GigaBytes

pseudo mini batch 2 input nodes size: 1835969
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.6756591796875 GB
    Memory Allocated: 0.6737303733825684  GigaBytes
Max Memory Allocated: 6.739223957061768  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.6756591796875 GB
    Memory Allocated: 0.6737303733825684  GigaBytes
Max Memory Allocated: 6.739223957061768  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.6756591796875 GB
    Memory Allocated: 1.357682228088379  GigaBytes
Max Memory Allocated: 6.739223957061768  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.6756591796875 GB
    Memory Allocated: 1.357776165008545  GigaBytes
Max Memory Allocated: 6.739223957061768  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.6756591796875 GB
    Memory Allocated: 0.6889357566833496  GigaBytes
Max Memory Allocated: 6.739223957061768  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.6756591796875 GB
    Memory Allocated: 0.8840208053588867  GigaBytes
Max Memory Allocated: 6.739223957061768  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6756591796875 GB
    Memory Allocated: 0.8840208053588867  GigaBytes
Max Memory Allocated: 6.739223957061768  GigaBytes

first layer input nodes number: 1835969
first layer output nodes number: 1305084
edges number: 11975130
torch.Size([1835969, 100])
torch.Size([1305084, 256])
input nodes number: 1305084
output nodes number: 518836
edges number: 10156264
torch.Size([1305084, 256])
torch.Size([518836, 256])
input nodes number: 518836
output nodes number: 142093
edges number: 3493699
torch.Size([518836, 256])
torch.Size([142093, 256])
torch.Size([12572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 6.480747699737549  GigaBytes
Max Memory Allocated: 6.739223957061768  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 6.482949733734131  GigaBytes
Max Memory Allocated: 6.739223957061768  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.7342529296875 GB
    Memory Allocated: 1.2415518760681152  GigaBytes
Max Memory Allocated: 7.047244548797607  GigaBytes

pseudo mini batch 3 input nodes size: 2032190
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.7342529296875 GB
    Memory Allocated: 0.6887621879577637  GigaBytes
Max Memory Allocated: 7.047244548797607  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.7342529296875 GB
    Memory Allocated: 0.6887621879577637  GigaBytes
Max Memory Allocated: 7.047244548797607  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7342529296875 GB
    Memory Allocated: 1.4458122253417969  GigaBytes
Max Memory Allocated: 7.047244548797607  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7342529296875 GB
    Memory Allocated: 1.4459013938903809  GigaBytes
Max Memory Allocated: 7.047244548797607  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.7342529296875 GB
    Memory Allocated: 0.7618556022644043  GigaBytes
Max Memory Allocated: 7.047244548797607  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.7342529296875 GB
    Memory Allocated: 1.0192933082580566  GigaBytes
Max Memory Allocated: 7.047244548797607  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7342529296875 GB
    Memory Allocated: 1.0192933082580566  GigaBytes
Max Memory Allocated: 7.047244548797607  GigaBytes

first layer input nodes number: 2032190
first layer output nodes number: 1650656
edges number: 15339387
torch.Size([2032190, 100])
torch.Size([1650656, 256])
input nodes number: 1650656
output nodes number: 697475
edges number: 15010947
torch.Size([1650656, 256])
torch.Size([697475, 256])
input nodes number: 697475
output nodes number: 142460
edges number: 3749850
torch.Size([697475, 256])
torch.Size([142460, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9354248046875 GB
    Memory Allocated: 8.117460250854492  GigaBytes
Max Memory Allocated: 8.287256240844727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.9354248046875 GB
    Memory Allocated: 8.11954927444458  GigaBytes
Max Memory Allocated: 8.287256240844727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0780029296875 GB
    Memory Allocated: 1.4926972389221191  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

pseudo mini batch 4 input nodes size: 1880185
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0780029296875 GB
    Memory Allocated: 0.7617425918579102  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0780029296875 GB
    Memory Allocated: 0.7617425918579102  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0780029296875 GB
    Memory Allocated: 1.4621663093566895  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0780029296875 GB
    Memory Allocated: 1.4622607231140137  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0780029296875 GB
    Memory Allocated: 0.7051215171813965  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0780029296875 GB
    Memory Allocated: 0.9162735939025879  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0780029296875 GB
    Memory Allocated: 0.9162735939025879  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

first layer input nodes number: 1880185
first layer output nodes number: 1376723
edges number: 13089474
torch.Size([1880185, 100])
torch.Size([1376723, 256])
input nodes number: 1376723
output nodes number: 496997
edges number: 11182167
torch.Size([1376723, 256])
torch.Size([496997, 256])
input nodes number: 496997
output nodes number: 127014
edges number: 3477664
torch.Size([496997, 256])
torch.Size([127014, 256])
torch.Size([12654, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 6.595869541168213  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 6.598085880279541  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.3002982139587402  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

pseudo mini batch 5 input nodes size: 1934251
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.7052488327026367  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.7052488327026367  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.4258136749267578  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.4259037971496582  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.7253856658935547  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.9566431045532227  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.9566431045532227  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

first layer input nodes number: 1934251
first layer output nodes number: 1468278
edges number: 13985440
torch.Size([1934251, 100])
torch.Size([1468278, 256])
input nodes number: 1468278
output nodes number: 553773
edges number: 12615276
torch.Size([1468278, 256])
torch.Size([553773, 256])
input nodes number: 553773
output nodes number: 140312
edges number: 3962920
torch.Size([553773, 256])
torch.Size([140312, 256])
torch.Size([12033, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 7.109099864959717  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 7.111207485198975  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.3795008659362793  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

pseudo mini batch 6 input nodes size: 1582333
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.7252769470214844  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.7252769470214844  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.314742088317871  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.3148365020751953  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.5941815376281738  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.7176966667175293  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.7176966667175293  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

first layer input nodes number: 1582333
first layer output nodes number: 887010
edges number: 8316189
torch.Size([1582333, 100])
torch.Size([887010, 256])
input nodes number: 887010
output nodes number: 275397
edges number: 5520662
torch.Size([887010, 256])
torch.Size([275397, 256])
input nodes number: 275397
output nodes number: 93121
edges number: 2281947
torch.Size([275397, 256])
torch.Size([93121, 256])
torch.Size([12654, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 4.268507480621338  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 4.271677494049072  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.9439277648925781  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

pseudo mini batch 7 input nodes size: 1824782
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.5942902565002441  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.5942902565002441  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.2740745544433594  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.2741665840148926  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.6846070289611816  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.8640971183776855  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.8640971183776855  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

first layer input nodes number: 1824782
first layer output nodes number: 1242876
edges number: 11576791
torch.Size([1824782, 100])
torch.Size([1242876, 256])
input nodes number: 1242876
output nodes number: 437559
edges number: 9170409
torch.Size([1242876, 256])
torch.Size([437559, 256])
input nodes number: 437559
output nodes number: 110749
edges number: 2877013
torch.Size([437559, 256])
torch.Size([110749, 256])
torch.Size([12306, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 5.9364423751831055  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 5.939446926116943  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.1909923553466797  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

pseudo mini batch 8 input nodes size: 2047919
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.6846837997436523  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.6846837997436523  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.4475932121276855  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.4476871490478516  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.7678108215332031  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.046126365661621  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 1.046126365661621  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

first layer input nodes number: 2047919
first layer output nodes number: 1702111
edges number: 16055945
torch.Size([2047919, 100])
torch.Size([1702111, 256])
input nodes number: 1702111
output nodes number: 737396
edges number: 16470391
torch.Size([1702111, 256])
torch.Size([737396, 256])
input nodes number: 737396
output nodes number: 160730
edges number: 4341377
torch.Size([737396, 256])
torch.Size([160730, 256])
torch.Size([12553, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.9940185546875 GB
    Memory Allocated: 8.477004051208496  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.9940185546875 GB
    Memory Allocated: 8.479469299316406  GigaBytes
Max Memory Allocated: 9.028873920440674  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.5586585998535156  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

pseudo mini batch 9 input nodes size: 1787783
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.7677164077758789  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.7677164077758789  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.433732032775879  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.4338264465332031  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.6708230972290039  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.8564348220825195  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.8564348220825195  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

first layer input nodes number: 1787783
first layer output nodes number: 1288750
edges number: 12265989
torch.Size([1787783, 100])
torch.Size([1288750, 256])
input nodes number: 1288750
output nodes number: 452299
edges number: 9468978
torch.Size([1288750, 256])
torch.Size([452299, 256])
input nodes number: 452299
output nodes number: 113125
edges number: 2684338
torch.Size([452299, 256])
torch.Size([113125, 256])
torch.Size([12644, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 6.104212760925293  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 6.106427192687988  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.1907672882080078  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

pseudo mini batch 10 input nodes size: 1928931
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.6708388328552246  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.6708388328552246  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.3894219398498535  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.389514446258545  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.7234044075012207  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.9646964073181152  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.9646964073181152  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

first layer input nodes number: 1928931
first layer output nodes number: 1515559
edges number: 14343470
torch.Size([1928931, 100])
torch.Size([1515559, 256])
input nodes number: 1515559
output nodes number: 621728
edges number: 13969480
torch.Size([1515559, 256])
torch.Size([621728, 256])
input nodes number: 621728
output nodes number: 133213
edges number: 3618245
torch.Size([621728, 256])
torch.Size([133213, 256])
torch.Size([12365, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 7.436917781829834  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 7.439855575561523  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.4062690734863281  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

pseudo mini batch 11 input nodes size: 1956845
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.7235841751098633  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.7235841751098633  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.452566146850586  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.45265531539917  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.7339797019958496  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.9861040115356445  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.9861040115356445  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

first layer input nodes number: 1956845
first layer output nodes number: 1562157
edges number: 14796402
torch.Size([1956845, 100])
torch.Size([1562157, 256])
input nodes number: 1562157
output nodes number: 664116
edges number: 15073550
torch.Size([1562157, 256])
torch.Size([664116, 256])
input nodes number: 664116
output nodes number: 125442
edges number: 3423837
torch.Size([664116, 256])
torch.Size([125442, 256])
torch.Size([11968, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 7.693750381469727  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 7.6961445808410645  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.4469141960144043  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

pseudo mini batch 12 input nodes size: 1832412
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.7336816787719727  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.7336816787719727  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.4163084030151367  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.4163975715637207  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.6873264312744141  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.9069337844848633  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.9069337844848633  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

first layer input nodes number: 1832412
first layer output nodes number: 1350431
edges number: 12902420
torch.Size([1832412, 100])
torch.Size([1350431, 256])
input nodes number: 1350431
output nodes number: 539076
edges number: 12308774
torch.Size([1350431, 256])
torch.Size([539076, 256])
input nodes number: 539076
output nodes number: 136872
edges number: 3795139
torch.Size([539076, 256])
torch.Size([136872, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 6.690192699432373  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 6.693175792694092  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.3126673698425293  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

pseudo mini batch 13 input nodes size: 1905074
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.687319278717041  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.687319278717041  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.39701509475708  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.3971076011657715  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.7143917083740234  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.940852165222168  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.940852165222168  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

first layer input nodes number: 1905074
first layer output nodes number: 1445921
edges number: 13717979
torch.Size([1905074, 100])
torch.Size([1445921, 256])
input nodes number: 1445921
output nodes number: 548569
edges number: 12403044
torch.Size([1445921, 256])
torch.Size([548569, 256])
input nodes number: 548569
output nodes number: 137069
edges number: 3788656
torch.Size([548569, 256])
torch.Size([137069, 256])
torch.Size([12359, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 7.0048112869262695  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 7.006976127624512  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.3541011810302734  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

pseudo mini batch 14 input nodes size: 1821626
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.7144675254821777  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.7144675254821777  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.3930764198303223  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.3931665420532227  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.6833782196044922  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.9095773696899414  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.9095773696899414  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

first layer input nodes number: 1821626
first layer output nodes number: 1373732
edges number: 13114363
torch.Size([1821626, 100])
torch.Size([1373732, 256])
input nodes number: 1373732
output nodes number: 566759
edges number: 12983283
torch.Size([1373732, 256])
torch.Size([566759, 256])
input nodes number: 566759
output nodes number: 135271
edges number: 3785961
torch.Size([566759, 256])
torch.Size([135271, 256])
torch.Size([12077, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 6.842136859893799  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 6.844252109527588  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.3259615898132324  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

pseudo mini batch 15 input nodes size: 1857003
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.6833286285400391  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.6833286285400391  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.3751163482666016  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.3752059936523438  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.6965069770812988  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.9435782432556152  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 0.9435782432556152  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

first layer input nodes number: 1857003
first layer output nodes number: 1422174
edges number: 13511870
torch.Size([1857003, 100])
torch.Size([1422174, 256])
input nodes number: 1422174
output nodes number: 652520
edges number: 14856291
torch.Size([1422174, 256])
torch.Size([652520, 256])
input nodes number: 652520
output nodes number: 154595
edges number: 4319678
torch.Size([652520, 256])
torch.Size([154595, 256])
torch.Size([12013, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 7.345989227294922  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 7.348104476928711  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.4013714790344238  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.4038853645324707  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.6697998046875 GB
    Memory Allocated: 1.4038853645324707  GigaBytes
Max Memory Allocated: 9.41075849533081  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.32057616114616394 |0.3068598210811615 |0.1831682026386261 |0.00015647709369659424 |0.03349675238132477 |0.0020449161529541016 |
----------------------------------------------------------pseudo_mini_loss sum 11.075848579406738
Total (block generation + training)time/epoch 686.4366674423218
Training time/epoch 13.736073732376099
Training time without block to device /epoch 8.826316595077515
Training time without total dataloading part /epoch 3.4711878299713135
load block tensor time/epoch 5.129218578338623
block to device time/epoch 4.909757137298584
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  62532883
Number of first layer input nodes during this epoch:  29800729
Number of first layer output nodes during this epoch:  22026430
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  337408
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([47, 256])
layers.3.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
