main start at this time 1658188432.093629
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.1478886604309082
global_2_local spend time (sec) 0.35694169998168945
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.020853519439697266
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 923219, 20: 186421, 14: 695, 15: 673, 7: 655, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 19: 584, 12: 583, 9: 576, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.06386017799377441
auxiliary_graph
Graph(num_nodes=1119790, num_edges=36432845,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5610442161560059
remove nodes length  923219

auxiliary_graph.remove_nodes spent  2.4328606128692627
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=36432845,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.496417760848999

the counter of shared neighbor distribution
Counter({1.0: 31037260, 2.0: 3559638, 3.0: 934718, 4.0: 352706, 5.0: 157994, 6.0: 75034, 7.0: 39694, 8.0: 21888, 9.0: 14508, 10.0: 9932, 11.0: 6334, 15.0: 4762, 12.0: 4542, 14.0: 3970, 13.0: 3506, 18.0: 2758, 16.0: 2682, 17.0: 1656, 19.0: 1422, 20.0: 1270})
36236274
Convert a graph into a bidirected graph: 2.292 seconds
Metis partitioning: 8.518 seconds
Split the graph: 4.474 seconds
Construct subgraphs: 0.113 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  15.413324117660522
97570
99001
total k batches seeds list generation spend  27.75594425201416
after graph partition
graph partition algorithm spend time 28.389036893844604
97570
99001
partition_len_list
[608050, 575356]
REG selection method  spend 28.983919858932495
time for parepare:  0.23032522201538086
local_output_nid generation:  0.013313531875610352
local_in_edges_tensor generation:  0.019247055053710938
mini_batch_src_global generation:  0.06261229515075684
r_  generation:  0.8568122386932373
local_output_nid generation:  0.014901161193847656
local_in_edges_tensor generation:  0.0404353141784668
mini_batch_src_global generation:  0.07520675659179688
r_  generation:  0.958888053894043
----------------------check_connections_block total spend ----------------------------- 2.613602638244629
generate_one_block  2.5404882431030273
generate_one_block  1.116159439086914
The real block id is  2
get_global_graph_edges_ids_block function  spend 1.0765750408172607
gen group dst list time:  0.031221866607666016
time for parepare:  0.4153444766998291
local_output_nid generation:  0.09876108169555664
local_in_edges_tensor generation:  0.31053686141967773
mini_batch_src_global generation:  0.35480499267578125
r_  generation:  5.240045070648193
local_output_nid generation:  0.10742020606994629
local_in_edges_tensor generation:  0.23677587509155273
mini_batch_src_global generation:  0.41445374488830566
r_  generation:  4.962193727493286
----------------------check_connections_block total spend ----------------------------- 13.790835618972778
generate_one_block  7.100402116775513
generate_one_block  6.120408296585083
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.486865758895874
gen group dst list time:  0.09189081192016602
time for parepare:  0.4409496784210205
local_output_nid generation:  0.23845601081848145
local_in_edges_tensor generation:  0.5557131767272949
mini_batch_src_global generation:  0.5413773059844971
r_  generation:  8.431960344314575
local_output_nid generation:  0.25557398796081543
local_in_edges_tensor generation:  0.47124814987182617
mini_batch_src_global generation:  0.6353271007537842
r_  generation:  8.076712846755981
----------------------check_connections_block total spend ----------------------------- 22.417563915252686
generate_one_block  10.86076283454895
generate_one_block  10.025946140289307
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.1458933353424072
gen group dst list time:  0.12832927703857422
time for parepare:  0.47166872024536133
local_output_nid generation:  0.40105700492858887
local_in_edges_tensor generation:  0.7613217830657959
mini_batch_src_global generation:  0.5324869155883789
r_  generation:  8.885714054107666
local_output_nid generation:  0.5201702117919922
local_in_edges_tensor generation:  0.7772080898284912
mini_batch_src_global generation:  0.6941485404968262
r_  generation:  8.933151245117188
----------------------check_connections_block total spend ----------------------------- 25.363234758377075
generate_one_block  11.139894962310791
generate_one_block  11.136241674423218
----------===============-------------===============-------------the number of batches *****---- 2

original number of batches:  2
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

connection checking time:  64.18523693084717
block generation total time  60.0403037071228
average batch blocks generation time:  7.50503796339035
block dataloader generation time/epoch 162.4693398475647
pseudo mini batch 0 input nodes size: 2068313
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.771763801574707  GigaBytes
Max Memory Allocated: 0.771763801574707  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.7724909782409668  GigaBytes
Max Memory Allocated: 0.7724909782409668  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.7724909782409668  GigaBytes
Max Memory Allocated: 0.7724909782409668  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 1.1304430961608887  GigaBytes
Max Memory Allocated: 1.1304430961608887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 1.1304430961608887  GigaBytes
Max Memory Allocated: 1.1304430961608887  GigaBytes

first layer input nodes number: 2068313
first layer output nodes number: 1799447
edges number: 16629847
----------------------------------------before model layer 0
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 1.1597399711608887  GigaBytes
Max Memory Allocated: 1.2222399711608887  GigaBytes

torch.Size([2068313, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 1.1597399711608887  GigaBytes
Max Memory Allocated: 1.2222399711608887  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.7655029296875 GB
    Memory Allocated: 3.678586959838867  GigaBytes
Max Memory Allocated: 3.678586959838867  GigaBytes

h_neigh size torch.Size([1799447, 256])
torch.Size([1799447, 256])
torch.Size([1799447, 256])
----------------------------------------after rst
 Nvidia-smi: 10.1990966796875 GB
    Memory Allocated: 5.395383834838867  GigaBytes
Max Memory Allocated: 7.112180709838867  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.1990966796875 GB
    Memory Allocated: 3.678586959838867  GigaBytes
Max Memory Allocated: 7.112180709838867  GigaBytes

torch.Size([1799447, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.1990966796875 GB
    Memory Allocated: 5.395383834838867  GigaBytes
Max Memory Allocated: 7.112180709838867  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.1990966796875 GB
    Memory Allocated: 5.824405670166016  GigaBytes
Max Memory Allocated: 7.541202545166016  GigaBytes

input nodes number: 1799447
output nodes number: 1289872
edges number: 17693193
----------------------------------------before model layer 1
 Nvidia-smi: 10.1990966796875 GB
    Memory Allocated: 5.847423553466797  GigaBytes
Max Memory Allocated: 7.541202545166016  GigaBytes

torch.Size([1799447, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 10.1990966796875 GB
    Memory Allocated: 5.847423553466797  GigaBytes
Max Memory Allocated: 7.541202545166016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 11.9881591796875 GB
    Memory Allocated: 8.449970245361328  GigaBytes
Max Memory Allocated: 8.449970245361328  GigaBytes

h_neigh size torch.Size([1289872, 256])
torch.Size([1289872, 256])
torch.Size([1289872, 256])
----------------------------------------after rst
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 9.680438995361328  GigaBytes
Max Memory Allocated: 10.910907745361328  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.450321197509766  GigaBytes
Max Memory Allocated: 10.910907745361328  GigaBytes

torch.Size([1289872, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 9.680789947509766  GigaBytes
Max Memory Allocated: 10.910907745361328  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 9.987968444824219  GigaBytes
Max Memory Allocated: 11.218437194824219  GigaBytes

input nodes number: 1289872
output nodes number: 608050
edges number: 11493565
----------------------------------------before model layer 2
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 10.002110004425049  GigaBytes
Max Memory Allocated: 11.218437194824219  GigaBytes

torch.Size([1289872, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 10.002110004425049  GigaBytes
Max Memory Allocated: 11.218437194824219  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 11.252038478851318  GigaBytes
Max Memory Allocated: 11.252038478851318  GigaBytes

h_neigh size torch.Size([608050, 256])
torch.Size([608050, 256])
torch.Size([608050, 256])
----------------------------------------after rst
 Nvidia-smi: 15.6092529296875 GB
    Memory Allocated: 11.832116603851318  GigaBytes
Max Memory Allocated: 12.412194728851318  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 15.6092529296875 GB
    Memory Allocated: 11.252234935760498  GigaBytes
Max Memory Allocated: 12.412194728851318  GigaBytes

torch.Size([608050, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 15.6092529296875 GB
    Memory Allocated: 11.832116603851318  GigaBytes
Max Memory Allocated: 12.412194728851318  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 15.6092529296875 GB
    Memory Allocated: 11.977283477783203  GigaBytes
Max Memory Allocated: 12.557165145874023  GigaBytes

----------------input nodes number: 608050
----------------output nodes number: 97570
----------------edges number: 1906172
----------------------------------------before mean aggregator
 Nvidia-smi: 15.6092529296875 GB
    Memory Allocated: 11.98254108428955  GigaBytes
Max Memory Allocated: 12.557165145874023  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 15.6112060546875 GB
    Memory Allocated: 12.107804298400879  GigaBytes
Max Memory Allocated: 12.557165145874023  GigaBytes

h_neigh size torch.Size([97570, 47])
torch.Size([97570, 47])
torch.Size([97570, 47])
----------------------------------------after rst
 Nvidia-smi: 15.6112060546875 GB
    Memory Allocated: 12.124887943267822  GigaBytes
Max Memory Allocated: 12.557165145874023  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.6112060546875 GB
    Memory Allocated: 12.107804298400879  GigaBytes
Max Memory Allocated: 12.557165145874023  GigaBytes

torch.Size([97570, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6112060546875 GB
    Memory Allocated: 12.124887943267822  GigaBytes
Max Memory Allocated: 12.557165145874023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.6112060546875 GB
    Memory Allocated: 12.141972541809082  GigaBytes
Max Memory Allocated: 12.557165145874023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 1.8378562927246094  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

pseudo mini batch 1 input nodes size: 2108181
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.79083251953125  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.79083251953125  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 1.5761914253234863  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 1.5769290924072266  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 0.8056950569152832  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 1.144763469696045  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 1.144763469696045  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

first layer input nodes number: 2108181
first layer output nodes number: 1847223
edges number: 16798414
----------------------------------------before model layer 0
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 1.1742339134216309  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

torch.Size([2108181, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 23.1522216796875 GB
    Memory Allocated: 1.1742339134216309  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 12.1268310546875 GB
    Memory Allocated: 3.756136894226074  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

h_neigh size torch.Size([1847223, 256])
torch.Size([1847223, 256])
torch.Size([1847223, 256])
----------------------------------------after rst
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 5.517855644226074  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 3.756136894226074  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

torch.Size([1847223, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 5.517855644226074  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 5.958268165588379  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

input nodes number: 1847223
output nodes number: 1241141
edges number: 16295369
----------------------------------------before model layer 1
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 5.981278419494629  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

torch.Size([1847223, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 5.981278419494629  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 8.47929859161377  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

h_neigh size torch.Size([1241141, 256])
torch.Size([1241141, 256])
torch.Size([1241141, 256])
----------------------------------------after rst
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 9.662942886352539  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 8.47929859161377  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

torch.Size([1241141, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 9.662942886352539  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 9.95885419845581  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

input nodes number: 1241141
output nodes number: 575356
edges number: 10480448
----------------------------------------before model layer 2
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 9.97238826751709  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

torch.Size([1241141, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 9.97238826751709  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 11.152618885040283  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

h_neigh size torch.Size([575356, 256])
torch.Size([575356, 256])
torch.Size([575356, 256])
----------------------------------------after rst
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 11.701321125030518  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 11.152618885040283  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

torch.Size([575356, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 11.701321125030518  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 11.838496685028076  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------input nodes number: 575356
----------------output nodes number: 99001
----------------edges number: 1934523
----------------------------------------before mean aggregator
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 11.843521118164062  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 18.0233154296875 GB
    Memory Allocated: 11.970966815948486  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

h_neigh size torch.Size([99001, 47])
torch.Size([99001, 47])
torch.Size([99001, 47])
----------------------------------------after rst
 Nvidia-smi: 18.0233154296875 GB
    Memory Allocated: 11.988300800323486  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.0233154296875 GB
    Memory Allocated: 11.970966815948486  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

torch.Size([99001, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0233154296875 GB
    Memory Allocated: 11.971217155456543  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.0233154296875 GB
    Memory Allocated: 11.988551616668701  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2186279296875 GB
    Memory Allocated: 1.7979216575622559  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.2225341796875 GB
    Memory Allocated: 1.8004355430603027  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.2225341796875 GB
    Memory Allocated: 1.8004355430603027  GigaBytes
Max Memory Allocated: 13.190908432006836  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2690284252166748 |0.5168263912200928 |0.7722439765930176 |0.00024127960205078125 |0.3133509159088135 |0.004976511001586914 |
----------------------------------------------------------pseudo_mini_loss sum 11.253469467163086
Total (block generation + training)time/epoch 166.29030680656433
Training time/epoch 3.820594072341919
Training time without block to device /epoch 2.7869412899017334
Training time without total dataloading part /epoch 2.1766488552093506
load block tensor time/epoch 0.5380568504333496
block to device time/epoch 1.0336527824401855
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  11537583
Number of first layer input nodes during this epoch:  4176494
Number of first layer output nodes during this epoch:  3646670
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  337408
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([47, 256])
layers.3.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
