main start at this time 1656648663.7375793
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.32222723960876465
number of batches is  16
batch size is  12286
range selection method spend 0.028031110763549805
time for parepare:  0.2734692096710205
local_output_nid generation:  0.003131389617919922
local_in_edges_tensor generation:  0.02548527717590332
mini_batch_src_global generation:  0.01410818099975586
r_  generation:  0.18255090713500977
local_output_nid generation:  0.0037221908569335938
local_in_edges_tensor generation:  0.0034508705139160156
mini_batch_src_global generation:  0.021175622940063477
r_  generation:  0.20680594444274902
local_output_nid generation:  0.0036079883575439453
local_in_edges_tensor generation:  0.0034830570220947266
mini_batch_src_global generation:  0.01241159439086914
r_  generation:  0.22080588340759277
local_output_nid generation:  0.003711700439453125
local_in_edges_tensor generation:  0.0036094188690185547
mini_batch_src_global generation:  0.013382911682128906
r_  generation:  0.22560429573059082
local_output_nid generation:  0.0036306381225585938
local_in_edges_tensor generation:  0.0034389495849609375
mini_batch_src_global generation:  0.013267278671264648
r_  generation:  0.2327735424041748
local_output_nid generation:  0.003728628158569336
local_in_edges_tensor generation:  0.0033173561096191406
mini_batch_src_global generation:  0.01565408706665039
r_  generation:  0.2451000213623047
local_output_nid generation:  0.003643035888671875
local_in_edges_tensor generation:  0.0034630298614501953
mini_batch_src_global generation:  0.0167696475982666
r_  generation:  0.2530243396759033
local_output_nid generation:  0.003628253936767578
local_in_edges_tensor generation:  0.003326416015625
mini_batch_src_global generation:  0.016983985900878906
r_  generation:  0.25617408752441406
local_output_nid generation:  0.003656625747680664
local_in_edges_tensor generation:  0.0036885738372802734
mini_batch_src_global generation:  0.01709890365600586
r_  generation:  0.25662684440612793
local_output_nid generation:  0.0036728382110595703
local_in_edges_tensor generation:  0.05139780044555664
mini_batch_src_global generation:  0.01748824119567871
r_  generation:  0.2648463249206543
local_output_nid generation:  0.0036466121673583984
local_in_edges_tensor generation:  0.003457307815551758
mini_batch_src_global generation:  0.019124984741210938
r_  generation:  0.2663106918334961
local_output_nid generation:  0.0036590099334716797
local_in_edges_tensor generation:  0.003503084182739258
mini_batch_src_global generation:  0.019631385803222656
r_  generation:  0.2701680660247803
local_output_nid generation:  0.003617525100708008
local_in_edges_tensor generation:  0.0035033226013183594
mini_batch_src_global generation:  0.02021002769470215
r_  generation:  0.26873350143432617
local_output_nid generation:  0.003643512725830078
local_in_edges_tensor generation:  0.003482818603515625
mini_batch_src_global generation:  0.020392656326293945
r_  generation:  0.270658016204834
local_output_nid generation:  0.003636598587036133
local_in_edges_tensor generation:  0.0034143924713134766
mini_batch_src_global generation:  0.020920515060424805
r_  generation:  0.26755309104919434
local_output_nid generation:  0.003645181655883789
local_in_edges_tensor generation:  0.0035448074340820312
mini_batch_src_global generation:  0.021086692810058594
r_  generation:  0.27078914642333984
----------------------check_connections_block total spend ----------------------------- 5.418626546859741
generate_one_block  1.2808842658996582
generate_one_block  0.27088189125061035
generate_one_block  0.27733349800109863
generate_one_block  0.268768310546875
generate_one_block  0.2711358070373535
generate_one_block  0.2779674530029297
generate_one_block  0.27196621894836426
generate_one_block  0.2774972915649414
generate_one_block  0.27446985244750977
generate_one_block  0.2760612964630127
generate_one_block  0.27480340003967285
generate_one_block  0.27635669708251953
generate_one_block  0.2709493637084961
generate_one_block  0.27171921730041504
generate_one_block  0.27912402153015137
generate_one_block  0.2812156677246094
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.963059663772583
gen group dst list time:  0.15381956100463867
time for parepare:  0.4470183849334717
local_output_nid generation:  0.06830954551696777
local_in_edges_tensor generation:  0.3253331184387207
mini_batch_src_global generation:  0.3309595584869385
r_  generation:  4.387320518493652
local_output_nid generation:  0.08555126190185547
local_in_edges_tensor generation:  0.24302220344543457
mini_batch_src_global generation:  0.4201216697692871
r_  generation:  4.599505662918091
local_output_nid generation:  0.09219694137573242
local_in_edges_tensor generation:  0.25736093521118164
mini_batch_src_global generation:  0.4067392349243164
r_  generation:  4.676351547241211
local_output_nid generation:  0.09491825103759766
local_in_edges_tensor generation:  0.2653682231903076
mini_batch_src_global generation:  0.4267098903656006
r_  generation:  4.812791109085083
local_output_nid generation:  0.09783530235290527
local_in_edges_tensor generation:  0.378098726272583
mini_batch_src_global generation:  0.43922924995422363
r_  generation:  4.864487171173096
local_output_nid generation:  0.10143136978149414
local_in_edges_tensor generation:  0.2877063751220703
mini_batch_src_global generation:  0.45807957649230957
r_  generation:  4.943765640258789
local_output_nid generation:  0.12012362480163574
local_in_edges_tensor generation:  0.395374059677124
mini_batch_src_global generation:  0.47556447982788086
r_  generation:  4.913440942764282
local_output_nid generation:  0.11468744277954102
local_in_edges_tensor generation:  0.29018664360046387
mini_batch_src_global generation:  0.4597947597503662
r_  generation:  4.925693988800049
local_output_nid generation:  0.11073732376098633
local_in_edges_tensor generation:  0.29796934127807617
mini_batch_src_global generation:  0.4844930171966553
r_  generation:  5.056136608123779
local_output_nid generation:  0.11047506332397461
local_in_edges_tensor generation:  0.3405766487121582
mini_batch_src_global generation:  0.46233391761779785
r_  generation:  4.993348836898804
local_output_nid generation:  0.11790871620178223
local_in_edges_tensor generation:  0.3433825969696045
mini_batch_src_global generation:  0.48755717277526855
r_  generation:  4.99056077003479
local_output_nid generation:  0.12020087242126465
local_in_edges_tensor generation:  0.29771900177001953
mini_batch_src_global generation:  0.47231221199035645
r_  generation:  5.024667024612427
local_output_nid generation:  0.12122511863708496
local_in_edges_tensor generation:  0.2936527729034424
mini_batch_src_global generation:  0.48105788230895996
r_  generation:  4.980746269226074
local_output_nid generation:  0.11344075202941895
local_in_edges_tensor generation:  0.34751152992248535
mini_batch_src_global generation:  0.47040605545043945
r_  generation:  5.067884922027588
local_output_nid generation:  0.12046527862548828
local_in_edges_tensor generation:  0.34746432304382324
mini_batch_src_global generation:  0.48273396492004395
r_  generation:  4.986818552017212
local_output_nid generation:  0.12268686294555664
local_in_edges_tensor generation:  0.2914607524871826
mini_batch_src_global generation:  0.4714975357055664
r_  generation:  5.010695457458496
----------------------check_connections_block total spend ----------------------------- 105.60758423805237
generate_one_block  6.447413206100464
generate_one_block  6.275519609451294
generate_one_block  6.05730676651001
generate_one_block  6.126924276351929
generate_one_block  6.112484693527222
generate_one_block  6.599084138870239
generate_one_block  6.134383201599121
generate_one_block  6.076406955718994
generate_one_block  6.101815700531006
generate_one_block  6.252998352050781
generate_one_block  6.2503674030303955
generate_one_block  6.0529961585998535
generate_one_block  6.067854881286621
generate_one_block  6.3611955642700195
generate_one_block  6.254448652267456
generate_one_block  6.065084934234619
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1850578784942627
gen group dst list time:  0.8613710403442383
time for parepare:  0.47544074058532715
local_output_nid generation:  0.47287702560424805
local_in_edges_tensor generation:  1.1373169422149658
mini_batch_src_global generation:  1.0171153545379639
r_  generation:  14.019877672195435
local_output_nid generation:  0.5252752304077148
local_in_edges_tensor generation:  1.0924651622772217
mini_batch_src_global generation:  1.4381740093231201
r_  generation:  14.14698076248169
local_output_nid generation:  0.5197975635528564
local_in_edges_tensor generation:  1.2101945877075195
mini_batch_src_global generation:  1.3477168083190918
r_  generation:  14.298451662063599
local_output_nid generation:  0.550260066986084
local_in_edges_tensor generation:  1.0406520366668701
mini_batch_src_global generation:  1.359222173690796
r_  generation:  14.359956979751587
local_output_nid generation:  0.5543951988220215
local_in_edges_tensor generation:  1.099025011062622
mini_batch_src_global generation:  1.3097972869873047
r_  generation:  14.480493068695068
local_output_nid generation:  0.5180606842041016
local_in_edges_tensor generation:  1.0937855243682861
mini_batch_src_global generation:  1.4052836894989014
r_  generation:  14.371116876602173
local_output_nid generation:  0.5391972064971924
local_in_edges_tensor generation:  1.0912840366363525
mini_batch_src_global generation:  1.402388572692871
r_  generation:  14.38251781463623
local_output_nid generation:  0.5737922191619873
local_in_edges_tensor generation:  1.064241647720337
mini_batch_src_global generation:  1.3650121688842773
r_  generation:  14.551779508590698
local_output_nid generation:  0.5649809837341309
local_in_edges_tensor generation:  1.129603624343872
mini_batch_src_global generation:  1.3644251823425293
r_  generation:  14.514572620391846
local_output_nid generation:  0.5276072025299072
local_in_edges_tensor generation:  1.1066920757293701
mini_batch_src_global generation:  1.4076457023620605
r_  generation:  14.36492133140564
local_output_nid generation:  0.5492539405822754
local_in_edges_tensor generation:  1.0963611602783203
mini_batch_src_global generation:  1.3994529247283936
r_  generation:  14.600115537643433
local_output_nid generation:  0.5744602680206299
local_in_edges_tensor generation:  1.0801589488983154
mini_batch_src_global generation:  1.3777506351470947
r_  generation:  14.60047960281372
local_output_nid generation:  0.5748214721679688
local_in_edges_tensor generation:  1.1374554634094238
mini_batch_src_global generation:  1.3197402954101562
r_  generation:  14.404527187347412
local_output_nid generation:  0.5317788124084473
local_in_edges_tensor generation:  1.077322244644165
mini_batch_src_global generation:  1.395005702972412
r_  generation:  14.39518404006958
local_output_nid generation:  0.5767884254455566
local_in_edges_tensor generation:  1.088318109512329
mini_batch_src_global generation:  1.4095451831817627
r_  generation:  14.635023832321167
local_output_nid generation:  0.5757360458374023
local_in_edges_tensor generation:  1.1351780891418457
mini_batch_src_global generation:  1.3240916728973389
r_  generation:  14.530654430389404
----------------------check_connections_block total spend ----------------------------- 319.5760633945465
generate_one_block  19.225877046585083
generate_one_block  18.832136154174805
generate_one_block  18.91926336288452
generate_one_block  20.26493525505066
generate_one_block  19.245394468307495
generate_one_block  19.23849129676819
generate_one_block  18.68661403656006
generate_one_block  18.959436893463135
generate_one_block  18.994061946868896
generate_one_block  19.05396866798401
generate_one_block  19.177612781524658
generate_one_block  19.53556180000305
generate_one_block  19.195773363113403
generate_one_block  19.037728786468506
generate_one_block  19.066481590270996
generate_one_block  18.77230405807495
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  425.1836476325989
block generation total time  405.44192600250244
average batch blocks generation time:  25.340120375156403
block dataloader generation time/epoch 864.9527914524078
pseudo mini batch 0 input nodes size: 2126569
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.7937374114990234  GigaBytes
Max Memory Allocated: 0.7937374114990234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.7938289642333984  GigaBytes
Max Memory Allocated: 0.7938289642333984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.7938289642333984  GigaBytes
Max Memory Allocated: 0.7938289642333984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 1.1254100799560547  GigaBytes
Max Memory Allocated: 1.1254100799560547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 1.1254100799560547  GigaBytes
Max Memory Allocated: 1.1254100799560547  GigaBytes

first layer input nodes number: 2126569
first layer output nodes number: 1540080
edges number: 32996304
torch.Size([2126569, 100])
torch.Size([1540080, 256])
input nodes number: 1540080
output nodes number: 335000
edges number: 10833040
torch.Size([1540080, 256])
torch.Size([335000, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.7537841796875 GB
    Memory Allocated: 6.439767360687256  GigaBytes
Max Memory Allocated: 6.752687454223633  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.7537841796875 GB
    Memory Allocated: 6.441919803619385  GigaBytes
Max Memory Allocated: 6.752687454223633  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3319091796875 GB
    Memory Allocated: 1.5993361473083496  GigaBytes
Max Memory Allocated: 8.415547847747803  GigaBytes

pseudo mini batch 1 input nodes size: 2127955
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3319091796875 GB
    Memory Allocated: 0.7967500686645508  GigaBytes
Max Memory Allocated: 8.415547847747803  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3319091796875 GB
    Memory Allocated: 0.7967500686645508  GigaBytes
Max Memory Allocated: 8.415547847747803  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3319091796875 GB
    Memory Allocated: 1.589475154876709  GigaBytes
Max Memory Allocated: 8.415547847747803  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3319091796875 GB
    Memory Allocated: 1.589566707611084  GigaBytes
Max Memory Allocated: 8.415547847747803  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3319091796875 GB
    Memory Allocated: 0.796506404876709  GigaBytes
Max Memory Allocated: 8.415547847747803  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3319091796875 GB
    Memory Allocated: 1.128258228302002  GigaBytes
Max Memory Allocated: 8.415547847747803  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3319091796875 GB
    Memory Allocated: 1.128258228302002  GigaBytes
Max Memory Allocated: 8.415547847747803  GigaBytes

first layer input nodes number: 2127955
first layer output nodes number: 1543991
edges number: 33052109
torch.Size([2127955, 100])
torch.Size([1543991, 256])
input nodes number: 1543991
output nodes number: 335793
edges number: 10871577
torch.Size([1543991, 256])
torch.Size([335793, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7518310546875 GB
    Memory Allocated: 6.453365325927734  GigaBytes
Max Memory Allocated: 8.415547847747803  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7518310546875 GB
    Memory Allocated: 6.455517292022705  GigaBytes
Max Memory Allocated: 8.415547847747803  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.5989279747009277  GigaBytes
Max Memory Allocated: 8.432851314544678  GigaBytes

pseudo mini batch 2 input nodes size: 2130266
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 0.796506404876709  GigaBytes
Max Memory Allocated: 8.432851314544678  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 0.796506404876709  GigaBytes
Max Memory Allocated: 8.432851314544678  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.590092658996582  GigaBytes
Max Memory Allocated: 8.432851314544678  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.590184211730957  GigaBytes
Max Memory Allocated: 8.432851314544678  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 0.7973675727844238  GigaBytes
Max Memory Allocated: 8.432851314544678  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.129122257232666  GigaBytes
Max Memory Allocated: 8.432851314544678  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.129122257232666  GigaBytes
Max Memory Allocated: 8.432851314544678  GigaBytes

first layer input nodes number: 2130266
first layer output nodes number: 1543899
edges number: 33052056
torch.Size([2130266, 100])
torch.Size([1543899, 256])
input nodes number: 1543899
output nodes number: 336437
edges number: 10880144
torch.Size([1543899, 256])
torch.Size([336437, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 6.456312656402588  GigaBytes
Max Memory Allocated: 8.432851314544678  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 6.458464622497559  GigaBytes
Max Memory Allocated: 8.432851314544678  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.601358413696289  GigaBytes
Max Memory Allocated: 8.43522596359253  GigaBytes

pseudo mini batch 3 input nodes size: 2131680
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 0.7973675727844238  GigaBytes
Max Memory Allocated: 8.43522596359253  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 0.7973675727844238  GigaBytes
Max Memory Allocated: 8.43522596359253  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.5914802551269531  GigaBytes
Max Memory Allocated: 8.43522596359253  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.5915718078613281  GigaBytes
Max Memory Allocated: 8.43522596359253  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 0.7978940010070801  GigaBytes
Max Memory Allocated: 8.43522596359253  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.1306328773498535  GigaBytes
Max Memory Allocated: 8.43522596359253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.1306328773498535  GigaBytes
Max Memory Allocated: 8.43522596359253  GigaBytes

first layer input nodes number: 2131680
first layer output nodes number: 1549771
edges number: 33185766
torch.Size([2131680, 100])
torch.Size([1549771, 256])
input nodes number: 1549771
output nodes number: 335187
edges number: 10843560
torch.Size([1549771, 256])
torch.Size([335187, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 6.469962120056152  GigaBytes
Max Memory Allocated: 8.43522596359253  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 6.472114086151123  GigaBytes
Max Memory Allocated: 8.43522596359253  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.60331392288208  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

pseudo mini batch 4 input nodes size: 2127848
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 0.7978940010070801  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 0.7978940010070801  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.59086275100708  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.590954303741455  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 0.7967500686645508  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.1289167404174805  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.1289167404174805  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

first layer input nodes number: 2127848
first layer output nodes number: 1542426
edges number: 33031847
torch.Size([2127848, 100])
torch.Size([1542426, 256])
input nodes number: 1542426
output nodes number: 334534
edges number: 10828462
torch.Size([1542426, 256])
torch.Size([334534, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 6.446300506591797  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 6.448452472686768  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.6005544662475586  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

pseudo mini batch 5 input nodes size: 2128071
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 0.7967500686645508  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 0.7967500686645508  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.5895185470581055  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.5896100997924805  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 0.7965497970581055  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.128565788269043  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.128565788269043  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

first layer input nodes number: 2128071
first layer output nodes number: 1545386
edges number: 33087724
torch.Size([2128071, 100])
torch.Size([1545386, 256])
input nodes number: 1545386
output nodes number: 336673
edges number: 10895330
torch.Size([1545386, 256])
torch.Size([336673, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 6.460502624511719  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 6.4634928703308105  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.6023917198181152  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

pseudo mini batch 6 input nodes size: 2125858
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 0.7965497970581055  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 0.7965497970581055  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.588493824005127  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.588585376739502  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 0.7957253456115723  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.1281466484069824  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.1281466484069824  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

first layer input nodes number: 2125858
first layer output nodes number: 1540974
edges number: 33013516
torch.Size([2125858, 100])
torch.Size([1540974, 256])
input nodes number: 1540974
output nodes number: 336179
edges number: 10879458
torch.Size([1540974, 256])
torch.Size([336179, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 6.446382522583008  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 6.4485344886779785  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.6010322570800781  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

pseudo mini batch 7 input nodes size: 2132923
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 0.796572208404541  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 0.796572208404541  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.5911483764648438  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.5912399291992188  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 0.7992043495178223  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.1320977210998535  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4119873046875 GB
    Memory Allocated: 1.1320977210998535  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

first layer input nodes number: 2132923
first layer output nodes number: 1550764
edges number: 33206431
torch.Size([2132923, 100])
torch.Size([1550764, 256])
input nodes number: 1550764
output nodes number: 336089
edges number: 10868396
torch.Size([1550764, 256])
torch.Size([336089, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8533935546875 GB
    Memory Allocated: 6.474144458770752  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8533935546875 GB
    Memory Allocated: 6.476296424865723  GigaBytes
Max Memory Allocated: 8.464206218719482  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.6040453910827637  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

pseudo mini batch 8 input nodes size: 2126619
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7983574867248535  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7983574867248535  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5913262367248535  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5914177894592285  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7967500686645508  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1285409927368164  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1285409927368164  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

first layer input nodes number: 2126619
first layer output nodes number: 1542584
edges number: 33056616
torch.Size([2126619, 100])
torch.Size([1542584, 256])
input nodes number: 1542584
output nodes number: 336742
edges number: 10906719
torch.Size([1542584, 256])
torch.Size([336742, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.452454090118408  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.454606056213379  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.6013898849487305  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

pseudo mini batch 9 input nodes size: 2126280
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7967500686645508  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7967500686645508  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5888514518737793  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5889430046081543  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7958827018737793  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1274714469909668  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1274714469909668  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

first layer input nodes number: 2126280
first layer output nodes number: 1537568
edges number: 32936678
torch.Size([2126280, 100])
torch.Size([1537568, 256])
input nodes number: 1537568
output nodes number: 335527
edges number: 10843177
torch.Size([1537568, 256])
torch.Size([335527, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.435067653656006  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.437219619750977  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.599639892578125  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

pseudo mini batch 10 input nodes size: 2130303
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7958827018737793  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7958827018737793  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5894827842712402  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5895743370056152  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7973814010620117  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.129995346069336  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.129995346069336  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

first layer input nodes number: 2130303
first layer output nodes number: 1548278
edges number: 33168406
torch.Size([2130303, 100])
torch.Size([1548278, 256])
input nodes number: 1548278
output nodes number: 336920
edges number: 10900323
torch.Size([1548278, 256])
torch.Size([336920, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.470694541931152  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.473631858825684  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.6046438217163086  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

pseudo mini batch 11 input nodes size: 2129161
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7973814010620117  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7973814010620117  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5905561447143555  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5906476974487305  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7969560623168945  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1291799545288086  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1291799545288086  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

first layer input nodes number: 2129161
first layer output nodes number: 1545923
edges number: 33114767
torch.Size([2129161, 100])
torch.Size([1545923, 256])
input nodes number: 1545923
output nodes number: 336161
edges number: 10874477
torch.Size([1545923, 256])
torch.Size([336161, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.459028244018555  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.461180210113525  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.6011161804199219  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

pseudo mini batch 12 input nodes size: 2125531
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7969560623168945  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7969560623168945  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5887784957885742  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5888700485229492  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7956037521362305  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1268949508666992  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1268949508666992  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

first layer input nodes number: 2125531
first layer output nodes number: 1541897
edges number: 32991043
torch.Size([2125531, 100])
torch.Size([1541897, 256])
input nodes number: 1541897
output nodes number: 334587
edges number: 10822080
torch.Size([1541897, 256])
torch.Size([334587, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.443519592285156  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.445671558380127  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5977330207824707  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

pseudo mini batch 13 input nodes size: 2127938
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7956037521362305  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7956037521362305  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.588322639465332  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.588414192199707  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7965002059936523  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1285314559936523  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1285314559936523  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

first layer input nodes number: 2127938
first layer output nodes number: 1545458
edges number: 33089933
torch.Size([2127938, 100])
torch.Size([1545458, 256])
input nodes number: 1545458
output nodes number: 336510
edges number: 10878535
torch.Size([1545458, 256])
torch.Size([336510, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.46013069152832  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.463053226470947  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.6022472381591797  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

pseudo mini batch 14 input nodes size: 2130923
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7965002059936523  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7965002059936523  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5903310775756836  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5904226303100586  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.797612190246582  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1313199996948242  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1313199996948242  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

first layer input nodes number: 2130923
first layer output nodes number: 1550501
edges number: 33210831
torch.Size([2130923, 100])
torch.Size([1550501, 256])
input nodes number: 1550501
output nodes number: 337473
edges number: 10918290
torch.Size([1550501, 256])
torch.Size([337473, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.478775501251221  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.480927467346191  GigaBytes
Max Memory Allocated: 8.467176914215088  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.6065292358398438  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

pseudo mini batch 15 input nodes size: 2124869
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.797612190246582  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.797612190246582  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5891876220703125  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5892791748046875  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 0.7953567504882812  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1269407272338867  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.1269407272338867  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

first layer input nodes number: 2124869
first layer output nodes number: 1541654
edges number: 33002808
torch.Size([2124869, 100])
torch.Size([1541654, 256])
input nodes number: 1541654
output nodes number: 335870
edges number: 10870192
torch.Size([1541654, 256])
torch.Size([335870, 256])
torch.Size([12281, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.445216655731201  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 6.4473676681518555  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3358154296875 GB
    Memory Allocated: 1.5985684394836426  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.6001057624816895  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.6001057624816895  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.357142373919487 |0.46766118705272675 |0.1559506505727768 |0.00015141069889068604 |0.023221641778945923 |0.004626035690307617 |
----------------------------------------------------------pseudo_mini_loss sum 7.18531608581543
Total (block generation + training)time/epoch 881.2226574420929
Training time/epoch 16.26954436302185
Training time without block to device /epoch 8.786965370178223
Training time without total dataloading part /epoch 2.873805284500122
load block tensor time/epoch 5.714277982711792
block to device time/epoch 7.482578992843628
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64139630
Number of first layer input nodes during this epoch:  34052794
Number of first layer output nodes during this epoch:  24711154
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.6001052856445312  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.43745875358581543
number of batches is  16
batch size is  12286
range selection method spend 0.02941155433654785
time for parepare:  0.2885756492614746
local_output_nid generation:  0.003182649612426758
local_in_edges_tensor generation:  0.03099203109741211
mini_batch_src_global generation:  0.014658689498901367
r_  generation:  0.19090771675109863
local_output_nid generation:  0.003885984420776367
local_in_edges_tensor generation:  0.006104469299316406
mini_batch_src_global generation:  0.02222919464111328
r_  generation:  0.2095658779144287
local_output_nid generation:  0.003733396530151367
local_in_edges_tensor generation:  0.0042455196380615234
mini_batch_src_global generation:  0.012420892715454102
r_  generation:  0.22244906425476074
local_output_nid generation:  0.0040454864501953125
local_in_edges_tensor generation:  0.004301786422729492
mini_batch_src_global generation:  0.013736486434936523
r_  generation:  0.23962092399597168
local_output_nid generation:  0.0038323402404785156
local_in_edges_tensor generation:  0.003631114959716797
mini_batch_src_global generation:  0.013228416442871094
r_  generation:  0.23546957969665527
local_output_nid generation:  0.0038237571716308594
local_in_edges_tensor generation:  0.003482818603515625
mini_batch_src_global generation:  0.015686988830566406
r_  generation:  0.25547051429748535
local_output_nid generation:  0.004065990447998047
local_in_edges_tensor generation:  0.0048902034759521484
mini_batch_src_global generation:  0.016764163970947266
r_  generation:  0.26221728324890137
local_output_nid generation:  0.003972768783569336
local_in_edges_tensor generation:  0.006524085998535156
mini_batch_src_global generation:  0.017203807830810547
r_  generation:  0.26819610595703125
local_output_nid generation:  0.003946065902709961
local_in_edges_tensor generation:  0.004805803298950195
mini_batch_src_global generation:  0.017421960830688477
r_  generation:  0.2729001045227051
local_output_nid generation:  0.004094123840332031
local_in_edges_tensor generation:  0.005251169204711914
mini_batch_src_global generation:  0.018325328826904297
r_  generation:  0.26591038703918457
local_output_nid generation:  0.00411534309387207
local_in_edges_tensor generation:  0.004887104034423828
mini_batch_src_global generation:  0.019496440887451172
r_  generation:  0.27135419845581055
local_output_nid generation:  0.004098653793334961
local_in_edges_tensor generation:  0.004940032958984375
mini_batch_src_global generation:  0.01988816261291504
r_  generation:  0.2723097801208496
local_output_nid generation:  0.0041544437408447266
local_in_edges_tensor generation:  0.006110668182373047
mini_batch_src_global generation:  0.020295381546020508
r_  generation:  0.2781538963317871
local_output_nid generation:  0.004084110260009766
local_in_edges_tensor generation:  0.004740238189697266
mini_batch_src_global generation:  0.02073383331298828
r_  generation:  0.2745954990386963
local_output_nid generation:  0.0040705204010009766
local_in_edges_tensor generation:  0.005023479461669922
mini_batch_src_global generation:  0.021477937698364258
r_  generation:  0.2711770534515381
local_output_nid generation:  0.004026651382446289
local_in_edges_tensor generation:  0.0047512054443359375
mini_batch_src_global generation:  0.021633625030517578
r_  generation:  0.278350830078125
----------------------check_connections_block total spend ----------------------------- 5.624587535858154
generate_one_block  0.5900447368621826
generate_one_block  0.3307454586029053
generate_one_block  0.2981688976287842
generate_one_block  0.28803563117980957
generate_one_block  0.2823352813720703
generate_one_block  0.28448987007141113
generate_one_block  0.2837862968444824
generate_one_block  0.28359365463256836
generate_one_block  0.2814023494720459
generate_one_block  0.28275394439697266
generate_one_block  0.30067920684814453
generate_one_block  0.28348350524902344
generate_one_block  0.2836475372314453
generate_one_block  0.28379106521606445
generate_one_block  0.28676342964172363
generate_one_block  0.2895946502685547
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2369980812072754
gen group dst list time:  0.1728208065032959
time for parepare:  0.46820735931396484
local_output_nid generation:  0.07574081420898438
local_in_edges_tensor generation:  0.3349747657775879
mini_batch_src_global generation:  0.35718488693237305
r_  generation:  4.534748077392578
local_output_nid generation:  0.1035759449005127
local_in_edges_tensor generation:  0.30747365951538086
mini_batch_src_global generation:  0.4447312355041504
r_  generation:  4.8667051792144775
local_output_nid generation:  0.113189697265625
local_in_edges_tensor generation:  0.36529088020324707
mini_batch_src_global generation:  0.4195866584777832
r_  generation:  4.793116569519043
local_output_nid generation:  0.10497212409973145
local_in_edges_tensor generation:  0.2784461975097656
mini_batch_src_global generation:  0.4444732666015625
r_  generation:  5.016797304153442
local_output_nid generation:  0.11263918876647949
local_in_edges_tensor generation:  0.39730024337768555
mini_batch_src_global generation:  0.4658815860748291
r_  generation:  4.9139015674591064
local_output_nid generation:  0.11798214912414551
local_in_edges_tensor generation:  0.2798309326171875
mini_batch_src_global generation:  0.4602193832397461
r_  generation:  5.076148271560669
local_output_nid generation:  0.11514472961425781
local_in_edges_tensor generation:  0.32477760314941406
mini_batch_src_global generation:  0.49465084075927734
r_  generation:  5.075962066650391
local_output_nid generation:  0.13391399383544922
local_in_edges_tensor generation:  0.33610010147094727
mini_batch_src_global generation:  0.4650595188140869
r_  generation:  5.013587236404419
local_output_nid generation:  0.11457967758178711
local_in_edges_tensor generation:  0.2939581871032715
mini_batch_src_global generation:  0.4892308712005615
r_  generation:  5.189252853393555
local_output_nid generation:  0.13788127899169922
local_in_edges_tensor generation:  0.3864109516143799
mini_batch_src_global generation:  0.4687156677246094
r_  generation:  4.988689422607422
local_output_nid generation:  0.11499857902526855
local_in_edges_tensor generation:  0.29262280464172363
mini_batch_src_global generation:  0.4729490280151367
r_  generation:  5.098641872406006
local_output_nid generation:  0.11516046524047852
local_in_edges_tensor generation:  0.33956122398376465
mini_batch_src_global generation:  0.48873186111450195
r_  generation:  5.142244815826416
local_output_nid generation:  0.14357352256774902
local_in_edges_tensor generation:  0.3721742630004883
mini_batch_src_global generation:  0.47124552726745605
r_  generation:  5.0726683139801025
local_output_nid generation:  0.1158592700958252
local_in_edges_tensor generation:  0.30080485343933105
mini_batch_src_global generation:  0.49428844451904297
r_  generation:  5.209604501724243
local_output_nid generation:  0.1435399055480957
local_in_edges_tensor generation:  0.40354132652282715
mini_batch_src_global generation:  0.4812147617340088
r_  generation:  5.0283520221710205
local_output_nid generation:  0.11785006523132324
local_in_edges_tensor generation:  0.3016507625579834
mini_batch_src_global generation:  0.48143625259399414
r_  generation:  5.1526198387146
----------------------check_connections_block total spend ----------------------------- 108.57009506225586
generate_one_block  6.526354551315308
generate_one_block  6.218490362167358
generate_one_block  6.287379026412964
generate_one_block  6.471660614013672
generate_one_block  6.216340065002441
generate_one_block  6.473576784133911
generate_one_block  6.759856700897217
generate_one_block  6.588237524032593
generate_one_block  6.1493144035339355
generate_one_block  6.5165696144104
generate_one_block  6.359471321105957
generate_one_block  6.715430021286011
generate_one_block  6.488922595977783
generate_one_block  6.168311834335327
generate_one_block  6.355130910873413
generate_one_block  6.3153111934661865
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.235380172729492
gen group dst list time:  0.8791818618774414
time for parepare:  0.4807121753692627
local_output_nid generation:  0.44673728942871094
local_in_edges_tensor generation:  1.0696513652801514
mini_batch_src_global generation:  1.0101752281188965
r_  generation:  13.989421844482422
local_output_nid generation:  0.5218226909637451
local_in_edges_tensor generation:  1.1024188995361328
mini_batch_src_global generation:  1.2995641231536865
r_  generation:  14.316569566726685
local_output_nid generation:  0.508389949798584
local_in_edges_tensor generation:  1.1909446716308594
mini_batch_src_global generation:  1.3247103691101074
r_  generation:  14.306341409683228
local_output_nid generation:  0.5478417873382568
local_in_edges_tensor generation:  1.1081116199493408
mini_batch_src_global generation:  1.3762648105621338
r_  generation:  14.319517135620117
local_output_nid generation:  0.5640120506286621
local_in_edges_tensor generation:  1.0773646831512451
mini_batch_src_global generation:  1.4306919574737549
r_  generation:  14.717008590698242
local_output_nid generation:  0.5616672039031982
local_in_edges_tensor generation:  1.0377967357635498
mini_batch_src_global generation:  1.3353919982910156
r_  generation:  14.736818313598633
local_output_nid generation:  0.5309958457946777
local_in_edges_tensor generation:  1.1482021808624268
mini_batch_src_global generation:  1.3691577911376953
r_  generation:  14.369298934936523
local_output_nid generation:  0.5551037788391113
local_in_edges_tensor generation:  1.1710739135742188
mini_batch_src_global generation:  1.4027888774871826
r_  generation:  14.40377402305603
local_output_nid generation:  0.5686326026916504
local_in_edges_tensor generation:  1.0110952854156494
mini_batch_src_global generation:  1.4359514713287354
r_  generation:  14.584420680999756
local_output_nid generation:  0.5718767642974854
local_in_edges_tensor generation:  1.148200273513794
mini_batch_src_global generation:  1.3743720054626465
r_  generation:  15.278486728668213
local_output_nid generation:  0.5778396129608154
local_in_edges_tensor generation:  1.1808247566223145
mini_batch_src_global generation:  1.4558310508728027
r_  generation:  14.558755874633789
local_output_nid generation:  0.5601866245269775
local_in_edges_tensor generation:  1.1503942012786865
mini_batch_src_global generation:  1.3937315940856934
r_  generation:  14.351194143295288
local_output_nid generation:  0.5745491981506348
local_in_edges_tensor generation:  1.0276193618774414
mini_batch_src_global generation:  1.4448668956756592
r_  generation:  14.636464834213257
local_output_nid generation:  0.5685296058654785
local_in_edges_tensor generation:  1.1406748294830322
mini_batch_src_global generation:  1.3358607292175293
r_  generation:  14.590286254882812
local_output_nid generation:  0.5409219264984131
local_in_edges_tensor generation:  1.1470706462860107
mini_batch_src_global generation:  1.3942041397094727
r_  generation:  14.54640245437622
local_output_nid generation:  0.5759239196777344
local_in_edges_tensor generation:  1.1632874011993408
mini_batch_src_global generation:  1.3733000755310059
r_  generation:  14.427515268325806
----------------------check_connections_block total spend ----------------------------- 322.07440996170044
generate_one_block  19.401346445083618
generate_one_block  19.364543437957764
generate_one_block  20.874209880828857
generate_one_block  19.32929754257202
generate_one_block  19.433475255966187
generate_one_block  19.397360801696777
generate_one_block  19.415441513061523
generate_one_block  19.620002508163452
generate_one_block  19.44095754623413
generate_one_block  19.56391954421997
generate_one_block  19.566410064697266
generate_one_block  19.272968769073486
generate_one_block  19.549436569213867
generate_one_block  19.425849199295044
generate_one_block  19.453874111175537
generate_one_block  19.738341808319092
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.6001052856445312  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

connection checking time:  430.6445050239563
block generation total time  415.45779252052307
average batch blocks generation time:  25.966112032532692
block dataloader generation time/epoch 873.3152046203613
pseudo mini batch 0 input nodes size: 2126712
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7968921661376953  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7968921661376953  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5891542434692383  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5892457962036133  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7975788116455078  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.1291465759277344  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.1291465759277344  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

first layer input nodes number: 2126712
first layer output nodes number: 1541044
edges number: 32996559
torch.Size([2126712, 100])
torch.Size([1541044, 256])
input nodes number: 1541044
output nodes number: 333953
edges number: 10795271
torch.Size([1541044, 256])
torch.Size([333953, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.439006328582764  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.442092418670654  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.600233554840088  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

pseudo mini batch 1 input nodes size: 2127656
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7975807189941406  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7975807189941406  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5905494689941406  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5906410217285156  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.1302766799926758  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.1302766799926758  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

first layer input nodes number: 2127656
first layer output nodes number: 1543541
edges number: 33083729
torch.Size([2127656, 100])
torch.Size([1543541, 256])
input nodes number: 1543541
output nodes number: 335573
edges number: 10864915
torch.Size([1543541, 256])
torch.Size([335573, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.454509735107422  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.4566874504089355  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.6038079261779785  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

pseudo mini batch 2 input nodes size: 2129796
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5916986465454102  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5917901992797852  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7987298965454102  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.1319913864135742  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.1319913864135742  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

first layer input nodes number: 2129796
first layer output nodes number: 1547471
edges number: 33138434
torch.Size([2129796, 100])
torch.Size([1547471, 256])
input nodes number: 1547471
output nodes number: 337355
edges number: 10909285
torch.Size([1547471, 256])
torch.Size([337355, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.470623970031738  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.472775936126709  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.6056747436523438  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

pseudo mini batch 3 input nodes size: 2130491
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7987298965454102  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7987298965454102  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.592400074005127  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.592491626739502  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7989888191223145  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.131659984588623  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.131659984588623  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

first layer input nodes number: 2130491
first layer output nodes number: 1549989
edges number: 33174407
torch.Size([2130491, 100])
torch.Size([1549989, 256])
input nodes number: 1549989
output nodes number: 337436
edges number: 10921012
torch.Size([1549989, 256])
torch.Size([337436, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.478516101837158  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.480668067932129  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.6067042350769043  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

pseudo mini batch 4 input nodes size: 2130576
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7989888191223145  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7989888191223145  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5926904678344727  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5927820205688477  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7990202903747559  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.132063388824463  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.132063388824463  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

first layer input nodes number: 2130576
first layer output nodes number: 1550947
edges number: 33225829
torch.Size([2130576, 100])
torch.Size([1550947, 256])
input nodes number: 1550947
output nodes number: 335675
edges number: 10853298
torch.Size([1550947, 256])
torch.Size([335675, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.475732326507568  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.477884292602539  GigaBytes
Max Memory Allocated: 8.468496799468994  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.605900764465332  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

pseudo mini batch 5 input nodes size: 2131797
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7990202903747559  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7990202903747559  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5931768417358398  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5932683944702148  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7994751930236816  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.1318421363830566  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.1318421363830566  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

first layer input nodes number: 2131797
first layer output nodes number: 1548876
edges number: 33134168
torch.Size([2131797, 100])
torch.Size([1548876, 256])
input nodes number: 1548876
output nodes number: 336771
edges number: 10883572
torch.Size([1548876, 256])
torch.Size([336771, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.473312854766846  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.475464820861816  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.6054620742797852  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

pseudo mini batch 6 input nodes size: 2128007
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7994751930236816  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7994751930236816  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5924439430236816  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5925354957580566  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.1304969787597656  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.1304969787597656  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

first layer input nodes number: 2128007
first layer output nodes number: 1546180
edges number: 33113705
torch.Size([2128007, 100])
torch.Size([1546180, 256])
input nodes number: 1546180
output nodes number: 336403
edges number: 10888671
torch.Size([1546180, 256])
torch.Size([336403, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.463361740112305  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 6.465513706207275  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.6041350364685059  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

pseudo mini batch 7 input nodes size: 2132109
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5925602912902832  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.5926518440246582  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 0.7995915412902832  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.1338143348693848  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3377685546875 GB
    Memory Allocated: 1.1338143348693848  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

first layer input nodes number: 2132109
first layer output nodes number: 1552554
edges number: 33254797
torch.Size([2132109, 100])
torch.Size([1552554, 256])
input nodes number: 1552554
output nodes number: 336767
edges number: 10907729
torch.Size([1552554, 256])
torch.Size([336767, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6287841796875 GB
    Memory Allocated: 6.485640525817871  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6287841796875 GB
    Memory Allocated: 6.487792491912842  GigaBytes
Max Memory Allocated: 8.469842433929443  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.6089229583740234  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 8 input nodes size: 2127454
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7995915412902832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7995915412902832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.5925602912902832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.5926518440246582  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.1304206848144531  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.1304206848144531  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127454
first layer output nodes number: 1546169
edges number: 33102765
torch.Size([2127454, 100])
torch.Size([1546169, 256])
input nodes number: 1546169
output nodes number: 337307
edges number: 10908543
torch.Size([1546169, 256])
torch.Size([337307, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 6.466217041015625  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 6.468593597412109  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.604550838470459  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 9 input nodes size: 2127905
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.590993881225586  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.591085433959961  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7980251312255859  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.1296148300170898  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.1296148300170898  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127905
first layer output nodes number: 1541668
edges number: 33022168
torch.Size([2127905, 100])
torch.Size([1541668, 256])
input nodes number: 1541668
output nodes number: 335164
edges number: 10848032
torch.Size([1541668, 256])
torch.Size([335164, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 6.447977066040039  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 6.45012903213501  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.6026830673217773  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 10 input nodes size: 2127000
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7980251312255859  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7980251312255859  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.590993881225586  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.591085433959961  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.1298828125  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.1298828125  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127000
first layer output nodes number: 1541845
edges number: 33031560
torch.Size([2127000, 100])
torch.Size([1541845, 256])
input nodes number: 1541845
output nodes number: 335383
edges number: 10858813
torch.Size([1541845, 256])
torch.Size([335383, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 6.449072360992432  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 6.451699733734131  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.6041231155395508  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 11 input nodes size: 2125591
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.5901317596435547  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.5902233123779297  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7971630096435547  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.129439353942871  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.129439353942871  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2125591
first layer output nodes number: 1539665
edges number: 32992847
torch.Size([2125591, 100])
torch.Size([1539665, 256])
input nodes number: 1539665
output nodes number: 335280
edges number: 10845726
torch.Size([1539665, 256])
torch.Size([335280, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 6.440255165100098  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 6.442787170410156  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.6006388664245605  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 12 input nodes size: 2127849
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7971630096435547  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7971630096435547  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.5901317596435547  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.5902233123779297  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.1303825378417969  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 1.1303825378417969  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127849
first layer output nodes number: 1544160
edges number: 33098789
torch.Size([2127849, 100])
torch.Size([1544160, 256])
input nodes number: 1544160
output nodes number: 335381
edges number: 10857596
torch.Size([1544160, 256])
torch.Size([335381, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 6.454151630401611  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4354248046875 GB
    Memory Allocated: 6.456303596496582  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.6030588150024414  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 13 input nodes size: 2127001
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.5906572341918945  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.5907487869262695  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 0.7976884841918945  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.1292695999145508  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.1292695999145508  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127001
first layer output nodes number: 1543167
edges number: 33030038
torch.Size([2127001, 100])
torch.Size([1543167, 256])
input nodes number: 1543167
output nodes number: 335958
edges number: 10858875
torch.Size([1543167, 256])
torch.Size([335958, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 6.452938079833984  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 6.455090045928955  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.602470874786377  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 14 input nodes size: 2126823
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 0.7976884841918945  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 0.7976884841918945  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.5906572341918945  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.5907487869262695  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.130979061126709  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.130979061126709  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2126823
first layer output nodes number: 1545387
edges number: 33124301
torch.Size([2126823, 100])
torch.Size([1545387, 256])
input nodes number: 1545387
output nodes number: 336492
edges number: 10880746
torch.Size([1545387, 256])
torch.Size([336492, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 6.461945056915283  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 6.464097023010254  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.6039280891418457  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 15 input nodes size: 2130422
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.5919318199157715  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.5920233726501465  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 0.7989630699157715  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.1311602592468262  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.1311602592468262  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2130422
first layer output nodes number: 1547014
edges number: 33111615
torch.Size([2130422, 100])
torch.Size([1547014, 256])
input nodes number: 1547014
output nodes number: 336751
edges number: 10890008
torch.Size([1547014, 256])
torch.Size([336751, 256])
torch.Size([12281, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 6.466305732727051  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 6.468796730041504  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9080810546875 GB
    Memory Allocated: 1.6043596267700195  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.6043596267700195  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.6043596267700195  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3571240305900574 |0.31698615849018097 |0.11794006824493408 |0.00013914704322814941 |0.014889135956764221 |0.0017325878143310547 |
----------------------------------------------------------pseudo_mini_loss sum 12.463977813720703
Total (block generation + training)time/epoch 888.0202847719193
Training time/epoch 13.140023946762085
Training time without block to device /epoch 8.06824541091919
Training time without total dataloading part /epoch 2.1292262077331543
load block tensor time/epoch 5.713984489440918
block to device time/epoch 5.0717785358428955
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64164515
Number of first layer input nodes during this epoch:  34057189
Number of first layer output nodes during this epoch:  24729677
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.6043591499328613  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3103768825531006
number of batches is  16
batch size is  12286
range selection method spend 0.03495597839355469
time for parepare:  0.2823162078857422
local_output_nid generation:  0.00331878662109375
local_in_edges_tensor generation:  0.026125669479370117
mini_batch_src_global generation:  0.018374204635620117
r_  generation:  0.1970527172088623
local_output_nid generation:  0.003960371017456055
local_in_edges_tensor generation:  0.006261110305786133
mini_batch_src_global generation:  0.022061586380004883
r_  generation:  0.21696233749389648
local_output_nid generation:  0.003835916519165039
local_in_edges_tensor generation:  0.004248142242431641
mini_batch_src_global generation:  0.014719486236572266
r_  generation:  0.228973388671875
local_output_nid generation:  0.003941059112548828
local_in_edges_tensor generation:  0.003554821014404297
mini_batch_src_global generation:  0.01563119888305664
r_  generation:  0.23490667343139648
local_output_nid generation:  0.0039017200469970703
local_in_edges_tensor generation:  0.004293918609619141
mini_batch_src_global generation:  0.01584911346435547
r_  generation:  0.2488391399383545
local_output_nid generation:  0.003987789154052734
local_in_edges_tensor generation:  0.0036258697509765625
mini_batch_src_global generation:  0.018778085708618164
r_  generation:  0.26199865341186523
local_output_nid generation:  0.0039215087890625
local_in_edges_tensor generation:  0.005947589874267578
mini_batch_src_global generation:  0.020137310028076172
r_  generation:  0.26544928550720215
local_output_nid generation:  0.004041433334350586
local_in_edges_tensor generation:  0.0036115646362304688
mini_batch_src_global generation:  0.020065784454345703
r_  generation:  0.27298474311828613
local_output_nid generation:  0.0037724971771240234
local_in_edges_tensor generation:  0.0034995079040527344
mini_batch_src_global generation:  0.020781755447387695
r_  generation:  0.2671394348144531
local_output_nid generation:  0.0038805007934570312
local_in_edges_tensor generation:  0.0041294097900390625
mini_batch_src_global generation:  0.01857590675354004
r_  generation:  0.27153468132019043
local_output_nid generation:  0.003937244415283203
local_in_edges_tensor generation:  0.0036110877990722656
mini_batch_src_global generation:  0.020975828170776367
r_  generation:  0.283966064453125
local_output_nid generation:  0.003885030746459961
local_in_edges_tensor generation:  0.004617929458618164
mini_batch_src_global generation:  0.021444082260131836
r_  generation:  0.27701687812805176
local_output_nid generation:  0.004136562347412109
local_in_edges_tensor generation:  0.0035228729248046875
mini_batch_src_global generation:  0.02060246467590332
r_  generation:  0.27881288528442383
local_output_nid generation:  0.003904581069946289
local_in_edges_tensor generation:  0.005486011505126953
mini_batch_src_global generation:  0.02135920524597168
r_  generation:  0.28218507766723633
local_output_nid generation:  0.0039501190185546875
local_in_edges_tensor generation:  0.003604412078857422
mini_batch_src_global generation:  0.02411031723022461
r_  generation:  0.2784709930419922
local_output_nid generation:  0.0039479732513427734
local_in_edges_tensor generation:  0.0055370330810546875
mini_batch_src_global generation:  0.02181220054626465
r_  generation:  0.28534531593322754
----------------------check_connections_block total spend ----------------------------- 5.681334733963013
generate_one_block  0.602520227432251
generate_one_block  0.3470582962036133
generate_one_block  0.3011901378631592
generate_one_block  0.29059886932373047
generate_one_block  0.28434062004089355
generate_one_block  0.2890453338623047
generate_one_block  0.28384900093078613
generate_one_block  0.29595518112182617
generate_one_block  0.28821325302124023
generate_one_block  0.2841148376464844
generate_one_block  0.284374475479126
generate_one_block  0.29056286811828613
generate_one_block  0.2889399528503418
generate_one_block  0.2905135154724121
generate_one_block  0.2887609004974365
generate_one_block  0.30038905143737793
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.8958137035369873
gen group dst list time:  0.153822660446167
time for parepare:  0.43285083770751953
local_output_nid generation:  0.07734847068786621
local_in_edges_tensor generation:  0.2778286933898926
mini_batch_src_global generation:  0.3488497734069824
r_  generation:  4.687897205352783
local_output_nid generation:  0.10365915298461914
local_in_edges_tensor generation:  0.32911181449890137
mini_batch_src_global generation:  0.4330017566680908
r_  generation:  4.813332796096802
local_output_nid generation:  0.10889816284179688
local_in_edges_tensor generation:  0.3535900115966797
mini_batch_src_global generation:  0.46135878562927246
r_  generation:  4.937469482421875
local_output_nid generation:  0.11514592170715332
local_in_edges_tensor generation:  0.27990269660949707
mini_batch_src_global generation:  0.44263386726379395
r_  generation:  4.927470922470093
local_output_nid generation:  0.1122138500213623
local_in_edges_tensor generation:  0.3253324031829834
mini_batch_src_global generation:  0.46174049377441406
r_  generation:  5.006624221801758
local_output_nid generation:  0.1133112907409668
local_in_edges_tensor generation:  0.3348209857940674
mini_batch_src_global generation:  0.5086886882781982
r_  generation:  5.076809883117676
local_output_nid generation:  0.1253342628479004
local_in_edges_tensor generation:  0.2907862663269043
mini_batch_src_global generation:  0.4708282947540283
r_  generation:  4.9673168659210205
local_output_nid generation:  0.11900734901428223
local_in_edges_tensor generation:  0.3390309810638428
mini_batch_src_global generation:  0.4743785858154297
r_  generation:  5.042717933654785
local_output_nid generation:  0.1148228645324707
local_in_edges_tensor generation:  0.29786062240600586
mini_batch_src_global generation:  0.4944009780883789
r_  generation:  5.245523691177368
local_output_nid generation:  0.12958121299743652
local_in_edges_tensor generation:  0.3419525623321533
mini_batch_src_global generation:  0.47520923614501953
r_  generation:  5.348806619644165
local_output_nid generation:  0.1393723487854004
local_in_edges_tensor generation:  0.4091625213623047
mini_batch_src_global generation:  0.492948055267334
r_  generation:  5.126596689224243
local_output_nid generation:  0.12744140625
local_in_edges_tensor generation:  0.35023045539855957
mini_batch_src_global generation:  0.4910275936126709
r_  generation:  5.2719666957855225
local_output_nid generation:  0.13508296012878418
local_in_edges_tensor generation:  0.35532689094543457
mini_batch_src_global generation:  0.4775702953338623
r_  generation:  5.059322118759155
local_output_nid generation:  0.12475252151489258
local_in_edges_tensor generation:  0.35471248626708984
mini_batch_src_global generation:  0.4852116107940674
r_  generation:  5.089465856552124
local_output_nid generation:  0.11641812324523926
local_in_edges_tensor generation:  0.3638169765472412
mini_batch_src_global generation:  0.5060727596282959
r_  generation:  5.2336952686309814
local_output_nid generation:  0.13642621040344238
local_in_edges_tensor generation:  0.3081974983215332
mini_batch_src_global generation:  0.48381686210632324
r_  generation:  5.062920808792114
----------------------check_connections_block total spend ----------------------------- 109.60330510139465
generate_one_block  6.636757850646973
generate_one_block  6.295386075973511
generate_one_block  6.635727405548096
generate_one_block  6.607120990753174
generate_one_block  6.192183494567871
generate_one_block  6.250214338302612
generate_one_block  6.558818340301514
generate_one_block  6.257521629333496
generate_one_block  6.268869400024414
generate_one_block  6.2233123779296875
generate_one_block  6.611665725708008
generate_one_block  6.186877012252808
generate_one_block  6.237610816955566
generate_one_block  6.274543762207031
generate_one_block  6.59393310546875
generate_one_block  6.240413427352905
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2160260677337646
gen group dst list time:  0.8518335819244385
time for parepare:  0.45980358123779297
local_output_nid generation:  0.4534275531768799
local_in_edges_tensor generation:  1.0845227241516113
mini_batch_src_global generation:  1.0495402812957764
r_  generation:  13.851531744003296
local_output_nid generation:  0.48543715476989746
local_in_edges_tensor generation:  1.1241614818572998
mini_batch_src_global generation:  1.3042428493499756
r_  generation:  14.137661218643188
local_output_nid generation:  0.5425124168395996
local_in_edges_tensor generation:  1.03035569190979
mini_batch_src_global generation:  1.4037833213806152
r_  generation:  14.34433889389038
local_output_nid generation:  0.5570380687713623
local_in_edges_tensor generation:  1.2503371238708496
mini_batch_src_global generation:  1.3099086284637451
r_  generation:  14.710625410079956
local_output_nid generation:  0.5646641254425049
local_in_edges_tensor generation:  1.1157915592193604
mini_batch_src_global generation:  1.302048683166504
r_  generation:  14.46956491470337
local_output_nid generation:  0.5471851825714111
local_in_edges_tensor generation:  1.1322989463806152
mini_batch_src_global generation:  1.4138543605804443
r_  generation:  14.363739252090454
local_output_nid generation:  0.5510194301605225
local_in_edges_tensor generation:  1.0081160068511963
mini_batch_src_global generation:  1.4212205410003662
r_  generation:  14.441994905471802
local_output_nid generation:  0.5740892887115479
local_in_edges_tensor generation:  1.1477553844451904
mini_batch_src_global generation:  1.3275821208953857
r_  generation:  14.716898441314697
local_output_nid generation:  0.5725247859954834
local_in_edges_tensor generation:  1.1607844829559326
mini_batch_src_global generation:  1.336454153060913
r_  generation:  14.8291916847229
local_output_nid generation:  0.5756659507751465
local_in_edges_tensor generation:  1.159691333770752
mini_batch_src_global generation:  1.515495777130127
r_  generation:  14.341377973556519
local_output_nid generation:  0.5563523769378662
local_in_edges_tensor generation:  1.0178658962249756
mini_batch_src_global generation:  1.4355018138885498
r_  generation:  14.4607515335083
local_output_nid generation:  0.5829784870147705
local_in_edges_tensor generation:  1.1580684185028076
mini_batch_src_global generation:  1.3634612560272217
r_  generation:  14.51988935470581
local_output_nid generation:  0.559361457824707
local_in_edges_tensor generation:  1.1469340324401855
mini_batch_src_global generation:  1.31205153465271
r_  generation:  14.418878316879272
local_output_nid generation:  0.5521667003631592
local_in_edges_tensor generation:  1.1433379650115967
mini_batch_src_global generation:  1.4237713813781738
r_  generation:  14.212909460067749
local_output_nid generation:  0.5667951107025146
local_in_edges_tensor generation:  1.0297253131866455
mini_batch_src_global generation:  1.4826200008392334
r_  generation:  14.43608045578003
local_output_nid generation:  0.5848426818847656
local_in_edges_tensor generation:  1.1493194103240967
mini_batch_src_global generation:  1.4116802215576172
r_  generation:  15.120805978775024
----------------------check_connections_block total spend ----------------------------- 320.81854367256165
generate_one_block  20.77997088432312
generate_one_block  19.190842628479004
generate_one_block  18.70861029624939
generate_one_block  19.337199687957764
generate_one_block  19.342278480529785
generate_one_block  19.341788291931152
generate_one_block  18.965404272079468
generate_one_block  19.009541034698486
generate_one_block  19.32672095298767
generate_one_block  19.434590816497803
generate_one_block  19.305947303771973
generate_one_block  19.028897523880005
generate_one_block  18.959517002105713
generate_one_block  19.608269691467285
generate_one_block  19.414425134658813
generate_one_block  19.36781644821167
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.6043591499328613  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

connection checking time:  430.4218487739563
block generation total time  411.1927762031555
average batch blocks generation time:  25.69954851269722
block dataloader generation time/epoch 874.0655532677969
pseudo mini batch 0 input nodes size: 2131296
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 0.7989611625671387  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 0.7989611625671387  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.592930793762207  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.593022346496582  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 0.7992863655090332  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.1319780349731445  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.1319780349731445  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2131296
first layer output nodes number: 1545678
edges number: 33086783
torch.Size([2131296, 100])
torch.Size([1545678, 256])
input nodes number: 1545678
output nodes number: 335201
edges number: 10828454
torch.Size([1545678, 256])
torch.Size([335201, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 6.459863185882568  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 6.462015628814697  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.6036787033081055  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 1 input nodes size: 2132079
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 0.799288272857666  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 0.799288272857666  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.5935497283935547  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.5936412811279297  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 0.7995800971984863  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.1319060325622559  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.1319060325622559  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2132079
first layer output nodes number: 1546742
edges number: 33128188
torch.Size([2132079, 100])
torch.Size([1546742, 256])
input nodes number: 1546742
output nodes number: 337515
edges number: 10917889
torch.Size([1546742, 256])
torch.Size([337515, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 6.469940662384033  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 6.47260856628418  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.606353759765625  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 2 input nodes size: 2129219
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 0.7995800971984863  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 0.7995800971984863  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.5927762985229492  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.5928678512573242  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 0.7985148429870605  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.1314334869384766  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.1314334869384766  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2129219
first layer output nodes number: 1544978
edges number: 33083154
torch.Size([2129219, 100])
torch.Size([1544978, 256])
input nodes number: 1544978
output nodes number: 336532
edges number: 10887873
torch.Size([1544978, 256])
torch.Size([336532, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 6.4620466232299805  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 6.464198589324951  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.604982852935791  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 3 input nodes size: 2129761
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 0.7985148429870605  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 0.7985148429870605  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.5919127464294434  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.5920042991638184  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 0.7987165451049805  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.131514549255371  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 1.131514549255371  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2129761
first layer output nodes number: 1551656
edges number: 33192197
torch.Size([2129761, 100])
torch.Size([1551656, 256])
input nodes number: 1551656
output nodes number: 336724
edges number: 10892321
torch.Size([1551656, 256])
torch.Size([336724, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 6.479557991027832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9100341796875 GB
    Memory Allocated: 6.481709957122803  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6057801246643066  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 4 input nodes size: 2126528
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7987165451049805  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7987165451049805  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5916852951049805  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5917768478393555  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1299381256103516  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1299381256103516  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2126528
first layer output nodes number: 1544255
edges number: 33038944
torch.Size([2126528, 100])
torch.Size([1544255, 256])
input nodes number: 1544255
output nodes number: 335597
edges number: 10849214
torch.Size([1544255, 256])
torch.Size([335597, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.45479679107666  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.456948757171631  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6022624969482422  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 5 input nodes size: 2124399
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5896878242492676  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5897793769836426  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7967190742492676  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1283059120178223  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1283059120178223  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2124399
first layer output nodes number: 1541869
edges number: 33017544
torch.Size([2124399, 100])
torch.Size([1541869, 256])
input nodes number: 1541869
output nodes number: 336967
edges number: 10906537
torch.Size([1541869, 256])
torch.Size([336967, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.452955722808838  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.456060409545898  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6004161834716797  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 6 input nodes size: 2129848
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7967190742492676  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7967190742492676  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5901494026184082  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5902409553527832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7987489700317383  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130326271057129  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130326271057129  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2129848
first layer output nodes number: 1542078
edges number: 33009650
torch.Size([2129848, 100])
torch.Size([1542078, 256])
input nodes number: 1542078
output nodes number: 334453
edges number: 10807392
torch.Size([1542078, 256])
torch.Size([334453, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.446038246154785  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.448190212249756  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.601463794708252  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 7 input nodes size: 2129041
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7987489700317383  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7987489700317383  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.591878890991211  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.591970443725586  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984485626220703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1310234069824219  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1310234069824219  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2129041
first layer output nodes number: 1547161
edges number: 33161314
torch.Size([2129041, 100])
torch.Size([1547161, 256])
input nodes number: 1547161
output nodes number: 337884
edges number: 10943214
torch.Size([1547161, 256])
torch.Size([337884, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.472442150115967  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.4745941162109375  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6060466766357422  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 8 input nodes size: 2128886
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984485626220703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984485626220703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5915207862854004  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5916123390197754  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7983908653259277  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130664348602295  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130664348602295  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128886
first layer output nodes number: 1547190
edges number: 33123382
torch.Size([2128886, 100])
torch.Size([1547190, 256])
input nodes number: 1547190
output nodes number: 337051
edges number: 10896805
torch.Size([1547190, 256])
torch.Size([337051, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.468609809875488  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.4712138175964355  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6034750938415527  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 9 input nodes size: 2130819
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7983908653259277  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7983908653259277  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5921831130981445  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5922746658325195  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7991108894348145  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1320338249206543  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1320338249206543  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2130819
first layer output nodes number: 1550787
edges number: 33210359
torch.Size([2130819, 100])
torch.Size([1550787, 256])
input nodes number: 1550787
output nodes number: 335950
edges number: 10875623
torch.Size([1550787, 256])
torch.Size([335950, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.476629257202148  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.478781223297119  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6056056022644043  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 10 input nodes size: 2126821
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7991108894348145  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7991108894348145  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5920796394348145  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5921711921691895  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130706787109375  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130706787109375  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2126821
first layer output nodes number: 1546270
edges number: 33141945
torch.Size([2126821, 100])
torch.Size([1546270, 256])
input nodes number: 1546270
output nodes number: 335881
edges number: 10868612
torch.Size([1546270, 256])
torch.Size([335881, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.462138652801514  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.464290618896484  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.603841781616211  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 11 input nodes size: 2127066
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.590681552886963  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.590773105621338  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7977128028869629  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.129300594329834  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.129300594329834  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127066
first layer output nodes number: 1542773
edges number: 33031483
torch.Size([2127066, 100])
torch.Size([1542773, 256])
input nodes number: 1542773
output nodes number: 334608
edges number: 10820864
torch.Size([1542773, 256])
torch.Size([334608, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.447021961212158  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.449173927307129  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6010966300964355  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 12 input nodes size: 2128595
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7978506088256836  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7978506088256836  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5908193588256836  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5909109115600586  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984251976013184  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1303620338439941  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1303620338439941  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128595
first layer output nodes number: 1543300
edges number: 33077232
torch.Size([2128595, 100])
torch.Size([1543300, 256])
input nodes number: 1543300
output nodes number: 335401
edges number: 10853471
torch.Size([1543300, 256])
torch.Size([335401, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.452305316925049  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.45459508895874  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6020941734313965  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 13 input nodes size: 2128580
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5912456512451172  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5913372039794922  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982769012451172  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1301860809326172  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1301860809326172  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128580
first layer output nodes number: 1543391
edges number: 33073713
torch.Size([2128580, 100])
torch.Size([1543391, 256])
input nodes number: 1543391
output nodes number: 335461
edges number: 10863492
torch.Size([1543391, 256])
torch.Size([335461, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.452723503112793  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.454875469207764  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6031818389892578  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 14 input nodes size: 2127615
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982769012451172  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982769012451172  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5912456512451172  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5913372039794922  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1298770904541016  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1298770904541016  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127615
first layer output nodes number: 1539579
edges number: 32968627
torch.Size([2127615, 100])
torch.Size([1539579, 256])
input nodes number: 1539579
output nodes number: 335975
edges number: 10871712
torch.Size([1539579, 256])
torch.Size([335975, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.44352912902832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.445777416229248  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6018800735473633  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 15 input nodes size: 2126873
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5906095504760742  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5907011032104492  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7976408004760742  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1301941871643066  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1301941871643066  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2126873
first layer output nodes number: 1546363
edges number: 33090315
torch.Size([2126873, 100])
torch.Size([1546363, 256])
input nodes number: 1546363
output nodes number: 337234
edges number: 10897693
torch.Size([1546363, 256])
torch.Size([337234, 256])
torch.Size([12281, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.465206623077393  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.467357635498047  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.602449893951416  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.602449893951416  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.602449893951416  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38037583231925964 |0.4193923771381378 |0.10054250061511993 |0.0001414865255355835 |0.00430847704410553 |0.0034248828887939453 |
----------------------------------------------------------pseudo_mini_loss sum 3.6362907886505127
Total (block generation + training)time/epoch 888.7714726130167
Training time/epoch 14.707393646240234
Training time without block to device /epoch 7.997115612030029
Training time without total dataloading part /epoch 1.6833043098449707
load block tensor time/epoch 6.086013317108154
block to device time/epoch 6.710278034210205
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  64159930
Number of first layer input nodes during this epoch:  34057426
Number of first layer output nodes during this epoch:  24724070
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6024494171142578  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3193645477294922
number of batches is  16
batch size is  12286
range selection method spend 0.03399777412414551
time for parepare:  0.2899034023284912
local_output_nid generation:  0.0034172534942626953
local_in_edges_tensor generation:  0.024493932723999023
mini_batch_src_global generation:  0.01800227165222168
r_  generation:  0.1897416114807129
local_output_nid generation:  0.003962039947509766
local_in_edges_tensor generation:  0.005956411361694336
mini_batch_src_global generation:  0.02004694938659668
r_  generation:  0.21403288841247559
local_output_nid generation:  0.00398564338684082
local_in_edges_tensor generation:  0.004053592681884766
mini_batch_src_global generation:  0.01227426528930664
r_  generation:  0.2241363525390625
local_output_nid generation:  0.0040700435638427734
local_in_edges_tensor generation:  0.005259275436401367
mini_batch_src_global generation:  0.013138294219970703
r_  generation:  0.23517942428588867
local_output_nid generation:  0.004091501235961914
local_in_edges_tensor generation:  0.004708766937255859
mini_batch_src_global generation:  0.014857769012451172
r_  generation:  0.24007773399353027
local_output_nid generation:  0.0039958953857421875
local_in_edges_tensor generation:  0.004060506820678711
mini_batch_src_global generation:  0.016990184783935547
r_  generation:  0.24862194061279297
local_output_nid generation:  0.0040056705474853516
local_in_edges_tensor generation:  0.004826545715332031
mini_batch_src_global generation:  0.016622304916381836
r_  generation:  0.26317381858825684
local_output_nid generation:  0.003998756408691406
local_in_edges_tensor generation:  0.004779338836669922
mini_batch_src_global generation:  0.017296314239501953
r_  generation:  0.26569581031799316
local_output_nid generation:  0.003994941711425781
local_in_edges_tensor generation:  0.004065990447998047
mini_batch_src_global generation:  0.01732039451599121
r_  generation:  0.26497435569763184
local_output_nid generation:  0.0039899349212646484
local_in_edges_tensor generation:  0.004790306091308594
mini_batch_src_global generation:  0.018410921096801758
r_  generation:  0.27026987075805664
local_output_nid generation:  0.004019021987915039
local_in_edges_tensor generation:  0.004996299743652344
mini_batch_src_global generation:  0.019791603088378906
r_  generation:  0.27268218994140625
local_output_nid generation:  0.003915548324584961
local_in_edges_tensor generation:  0.005387544631958008
mini_batch_src_global generation:  0.02081298828125
r_  generation:  0.2761824131011963
local_output_nid generation:  0.004152774810791016
local_in_edges_tensor generation:  0.004812479019165039
mini_batch_src_global generation:  0.020404338836669922
r_  generation:  0.2796142101287842
local_output_nid generation:  0.003972291946411133
local_in_edges_tensor generation:  0.00558018684387207
mini_batch_src_global generation:  0.020951032638549805
r_  generation:  0.27729058265686035
local_output_nid generation:  0.0038862228393554688
local_in_edges_tensor generation:  0.005382061004638672
mini_batch_src_global generation:  0.021342754364013672
r_  generation:  0.2736215591430664
local_output_nid generation:  0.003926277160644531
local_in_edges_tensor generation:  0.004744291305541992
mini_batch_src_global generation:  0.021999120712280273
r_  generation:  0.2814066410064697
----------------------check_connections_block total spend ----------------------------- 5.589877128601074
generate_one_block  0.6030199527740479
generate_one_block  0.3383796215057373
generate_one_block  0.2997713088989258
generate_one_block  0.28902411460876465
generate_one_block  0.2882394790649414
generate_one_block  0.286637544631958
generate_one_block  0.2861206531524658
generate_one_block  0.28717851638793945
generate_one_block  0.3074967861175537
generate_one_block  0.2923123836517334
generate_one_block  0.2920219898223877
generate_one_block  0.2865743637084961
generate_one_block  0.28984785079956055
generate_one_block  0.29599499702453613
generate_one_block  0.28536105155944824
generate_one_block  0.2950921058654785
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.007289171218872
gen group dst list time:  0.17482614517211914
time for parepare:  0.41943883895874023
local_output_nid generation:  0.07752490043640137
local_in_edges_tensor generation:  0.23606514930725098
mini_batch_src_global generation:  0.35335588455200195
r_  generation:  4.613703012466431
local_output_nid generation:  0.10655474662780762
local_in_edges_tensor generation:  0.25028443336486816
mini_batch_src_global generation:  0.43328857421875
r_  generation:  4.74906849861145
local_output_nid generation:  0.10743117332458496
local_in_edges_tensor generation:  0.266066312789917
mini_batch_src_global generation:  0.45009922981262207
r_  generation:  4.998918056488037
local_output_nid generation:  0.12333250045776367
local_in_edges_tensor generation:  0.4038839340209961
mini_batch_src_global generation:  0.4433884620666504
r_  generation:  4.806156158447266
local_output_nid generation:  0.12304282188415527
local_in_edges_tensor generation:  0.28513193130493164
mini_batch_src_global generation:  0.46061015129089355
r_  generation:  4.9928810596466064
local_output_nid generation:  0.12135887145996094
local_in_edges_tensor generation:  0.28449130058288574
mini_batch_src_global generation:  0.471921443939209
r_  generation:  5.104891538619995
local_output_nid generation:  0.12051534652709961
local_in_edges_tensor generation:  0.3931114673614502
mini_batch_src_global generation:  0.49551892280578613
r_  generation:  4.960063934326172
local_output_nid generation:  0.1282660961151123
local_in_edges_tensor generation:  0.297351598739624
mini_batch_src_global generation:  0.47432494163513184
r_  generation:  4.994445085525513
local_output_nid generation:  0.12845516204833984
local_in_edges_tensor generation:  0.30608630180358887
mini_batch_src_global generation:  0.4902496337890625
r_  generation:  5.022257089614868
local_output_nid generation:  0.12387704849243164
local_in_edges_tensor generation:  0.4110255241394043
mini_batch_src_global generation:  0.49369215965270996
r_  generation:  5.1584391593933105
local_output_nid generation:  0.13995671272277832
local_in_edges_tensor generation:  0.29608607292175293
mini_batch_src_global generation:  0.4836277961730957
r_  generation:  5.0066375732421875
local_output_nid generation:  0.13232111930847168
local_in_edges_tensor generation:  0.29152464866638184
mini_batch_src_global generation:  0.4764535427093506
r_  generation:  5.045831680297852
local_output_nid generation:  0.12445330619812012
local_in_edges_tensor generation:  0.30433058738708496
mini_batch_src_global generation:  0.48622775077819824
r_  generation:  5.104095220565796
local_output_nid generation:  0.1147608757019043
local_in_edges_tensor generation:  0.41661643981933594
mini_batch_src_global generation:  0.49950385093688965
r_  generation:  5.112810373306274
local_output_nid generation:  0.13652896881103516
local_in_edges_tensor generation:  0.29939699172973633
mini_batch_src_global generation:  0.48801541328430176
r_  generation:  5.019647598266602
local_output_nid generation:  0.1263594627380371
local_in_edges_tensor generation:  0.29003071784973145
mini_batch_src_global generation:  0.48158693313598633
r_  generation:  5.0745532512664795
----------------------check_connections_block total spend ----------------------------- 107.93762540817261
generate_one_block  6.661728620529175
generate_one_block  6.570288419723511
generate_one_block  6.183807373046875
generate_one_block  6.170910358428955
generate_one_block  6.551467180252075
generate_one_block  6.61327338218689
generate_one_block  6.157989263534546
generate_one_block  6.272441148757935
generate_one_block  6.21762752532959
generate_one_block  6.594573736190796
generate_one_block  6.157270908355713
generate_one_block  6.187175512313843
generate_one_block  6.244852542877197
generate_one_block  6.4615678787231445
generate_one_block  6.324859619140625
generate_one_block  6.199202060699463
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1515018939971924
gen group dst list time:  0.8840525150299072
time for parepare:  0.4820559024810791
local_output_nid generation:  0.4568042755126953
local_in_edges_tensor generation:  1.283839225769043
mini_batch_src_global generation:  1.0403532981872559
r_  generation:  14.041184663772583
local_output_nid generation:  0.5151472091674805
local_in_edges_tensor generation:  1.1472270488739014
mini_batch_src_global generation:  1.3502328395843506
r_  generation:  14.17720627784729
local_output_nid generation:  0.5284569263458252
local_in_edges_tensor generation:  1.0549931526184082
mini_batch_src_global generation:  1.3568155765533447
r_  generation:  14.50900673866272
local_output_nid generation:  0.5506818294525146
local_in_edges_tensor generation:  1.0535860061645508
mini_batch_src_global generation:  1.309812307357788
r_  generation:  14.426520824432373
local_output_nid generation:  0.532473087310791
local_in_edges_tensor generation:  1.0808496475219727
mini_batch_src_global generation:  1.3835790157318115
r_  generation:  14.350512504577637
local_output_nid generation:  0.563488245010376
local_in_edges_tensor generation:  1.1238117218017578
mini_batch_src_global generation:  1.3606986999511719
r_  generation:  14.42971134185791
local_output_nid generation:  0.5726211071014404
local_in_edges_tensor generation:  1.0705547332763672
mini_batch_src_global generation:  1.3204412460327148
r_  generation:  14.565077304840088
local_output_nid generation:  0.544853687286377
local_in_edges_tensor generation:  1.157050371170044
mini_batch_src_global generation:  1.4412007331848145
r_  generation:  14.353062391281128
local_output_nid generation:  0.5532581806182861
local_in_edges_tensor generation:  1.0768368244171143
mini_batch_src_global generation:  1.4213428497314453
r_  generation:  14.584311723709106
local_output_nid generation:  0.5660398006439209
local_in_edges_tensor generation:  1.0690891742706299
mini_batch_src_global generation:  1.3193340301513672
r_  generation:  14.514432668685913
local_output_nid generation:  0.5666079521179199
local_in_edges_tensor generation:  1.1738531589508057
mini_batch_src_global generation:  1.437873125076294
r_  generation:  14.738937139511108
local_output_nid generation:  0.5540111064910889
local_in_edges_tensor generation:  1.1570823192596436
mini_batch_src_global generation:  1.4355063438415527
r_  generation:  14.385416984558105
local_output_nid generation:  0.5515792369842529
local_in_edges_tensor generation:  1.0907490253448486
mini_batch_src_global generation:  1.397155523300171
r_  generation:  14.554351091384888
local_output_nid generation:  0.5738086700439453
local_in_edges_tensor generation:  1.088623046875
mini_batch_src_global generation:  1.381178379058838
r_  generation:  14.530953884124756
local_output_nid generation:  0.5378191471099854
local_in_edges_tensor generation:  1.1559691429138184
mini_batch_src_global generation:  1.384997844696045
r_  generation:  14.356638431549072
local_output_nid generation:  0.5648994445800781
local_in_edges_tensor generation:  1.0858075618743896
mini_batch_src_global generation:  1.357832431793213
r_  generation:  14.416128396987915
----------------------check_connections_block total spend ----------------------------- 319.5279498100281
generate_one_block  19.417294025421143
generate_one_block  20.734718322753906
generate_one_block  19.25529146194458
generate_one_block  19.46263837814331
generate_one_block  19.311734676361084
generate_one_block  18.96467423439026
generate_one_block  18.87570810317993
generate_one_block  19.28571653366089
generate_one_block  19.28756093978882
generate_one_block  19.215012788772583
generate_one_block  18.962594747543335
generate_one_block  18.938190698623657
generate_one_block  19.156145095825195
generate_one_block  19.406273365020752
generate_one_block  19.545197010040283
generate_one_block  19.249654531478882
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6024494171142578  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

connection checking time:  427.4655752182007
block generation total time  410.63744044303894
average batch blocks generation time:  25.664840027689934
block dataloader generation time/epoch 873.8794755339622
pseudo mini batch 0 input nodes size: 2128825
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7976388931274414  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7976388931274414  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5906882286071777  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5907797813415527  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7983660697937012  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130277156829834  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130277156829834  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128825
first layer output nodes number: 1546312
edges number: 33074644
torch.Size([2128825, 100])
torch.Size([1546312, 256])
input nodes number: 1546312
output nodes number: 336625
edges number: 10875503
torch.Size([1546312, 256])
torch.Size([336625, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.462332725524902  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.464670181274414  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.602686882019043  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 1 input nodes size: 2127251
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.798367977142334  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.798367977142334  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.591336727142334  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.591428279876709  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1303739547729492  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1303739547729492  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127251
first layer output nodes number: 1544175
edges number: 33097635
torch.Size([2127251, 100])
torch.Size([1544175, 256])
input nodes number: 1544175
output nodes number: 334839
edges number: 10841351
torch.Size([1544175, 256])
torch.Size([334839, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.4536237716674805  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.4562482833862305  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6023321151733398  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 2 input nodes size: 2126747
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5905628204345703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5906543731689453  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7975940704345703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1298465728759766  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1298465728759766  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2126747
first layer output nodes number: 1545852
edges number: 33119772
torch.Size([2126747, 100])
torch.Size([1545852, 256])
input nodes number: 1545852
output nodes number: 337372
edges number: 10911397
torch.Size([1545852, 256])
torch.Size([337372, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.466148376464844  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.46832799911499  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.604891300201416  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 3 input nodes size: 2127950
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7975940704345703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7975940704345703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5905628204345703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5906543731689453  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1307497024536133  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1307497024536133  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127950
first layer output nodes number: 1545266
edges number: 33076768
torch.Size([2127950, 100])
torch.Size([1545266, 256])
input nodes number: 1545266
output nodes number: 335266
edges number: 10839226
torch.Size([1545266, 256])
torch.Size([335266, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.458024978637695  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.460176944732666  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.60235595703125  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 4 input nodes size: 2128386
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5911731719970703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5912647247314453  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982044219970703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130035400390625  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130035400390625  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128386
first layer output nodes number: 1544961
edges number: 33062561
torch.Size([2128386, 100])
torch.Size([1544961, 256])
input nodes number: 1544961
output nodes number: 336411
edges number: 10874961
torch.Size([1544961, 256])
torch.Size([336411, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.459469795227051  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.462590217590332  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6028180122375488  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 5 input nodes size: 2126511
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982044219970703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982044219970703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5911731719970703  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5912647247314453  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1302242279052734  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1302242279052734  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2126511
first layer output nodes number: 1544672
edges number: 33077461
torch.Size([2126511, 100])
torch.Size([1544672, 256])
input nodes number: 1544672
output nodes number: 335542
edges number: 10855389
torch.Size([1544672, 256])
torch.Size([335542, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.455987453460693  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.458255767822266  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.601790428161621  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 6 input nodes size: 2127756
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5909385681152344  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5910301208496094  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7979698181152344  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1299400329589844  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1299400329589844  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127756
first layer output nodes number: 1543756
edges number: 33083104
torch.Size([2127756, 100])
torch.Size([1543756, 256])
input nodes number: 1543756
output nodes number: 335522
edges number: 10853803
torch.Size([1543756, 256])
torch.Size([335522, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.454732418060303  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.456884384155273  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6024479866027832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 7 input nodes size: 2132342
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7979698181152344  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7979698181152344  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.592329502105713  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.592421054840088  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7996783256530762  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1324067115783691  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1324067115783691  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2132342
first layer output nodes number: 1549726
edges number: 33182081
torch.Size([2132342, 100])
torch.Size([1549726, 256])
input nodes number: 1549726
output nodes number: 338315
edges number: 10956541
torch.Size([1549726, 256])
torch.Size([338315, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.482212543487549  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.484549522399902  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.608081340789795  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 8 input nodes size: 2127235
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7996783256530762  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7996783256530762  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5926470756530762  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5927386283874512  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1306710243225098  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1306710243225098  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127235
first layer output nodes number: 1543862
edges number: 33054685
torch.Size([2127235, 100])
torch.Size([1543862, 256])
input nodes number: 1543862
output nodes number: 336403
edges number: 10890451
torch.Size([1543862, 256])
torch.Size([336403, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.457139492034912  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.459291458129883  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6034250259399414  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 9 input nodes size: 2127882
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5909852981567383  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5910768508911133  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7980165481567383  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1299028396606445  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1299028396606445  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127882
first layer output nodes number: 1544962
edges number: 33069722
torch.Size([2127882, 100])
torch.Size([1544962, 256])
input nodes number: 1544962
output nodes number: 337353
edges number: 10907719
torch.Size([1544962, 256])
torch.Size([337353, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.462555408477783  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.464707374572754  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.602630615234375  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 10 input nodes size: 2127865
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7980165481567383  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7980165481567383  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5909852981567383  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5910768508911133  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1306180953979492  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1306180953979492  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127865
first layer output nodes number: 1547603
edges number: 33131059
torch.Size([2127865, 100])
torch.Size([1547603, 256])
input nodes number: 1547603
output nodes number: 335727
edges number: 10852034
torch.Size([1547603, 256])
torch.Size([335727, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.465389728546143  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.467541694641113  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6051058769226074  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 11 input nodes size: 2127974
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7983355522155762  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7983355522155762  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5910677909851074  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5911593437194824  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7980990409851074  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130155086517334  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130155086517334  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127974
first layer output nodes number: 1544102
edges number: 33093211
torch.Size([2127974, 100])
torch.Size([1544102, 256])
input nodes number: 1544102
output nodes number: 335614
edges number: 10864853
torch.Size([1544102, 256])
torch.Size([335614, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.453991889953613  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.456143856048584  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.602074146270752  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 12 input nodes size: 2131230
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7980508804321289  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7980508804321289  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.591996192932129  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.592087745666504  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7992639541625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1321992874145508  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1321992874145508  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2131230
first layer output nodes number: 1548396
edges number: 33192832
torch.Size([2131230, 100])
torch.Size([1548396, 256])
input nodes number: 1548396
output nodes number: 336932
edges number: 10914415
torch.Size([1548396, 256])
torch.Size([336932, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.472754001617432  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.474905967712402  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6058268547058105  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 13 input nodes size: 2127702
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7992639541625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7992639541625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5922327041625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5923242568969727  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1308860778808594  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1308860778808594  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127702
first layer output nodes number: 1545193
edges number: 33082887
torch.Size([2127702, 100])
torch.Size([1545193, 256])
input nodes number: 1545193
output nodes number: 336039
edges number: 10867234
torch.Size([1545193, 256])
torch.Size([336039, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.45925235748291  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.461807727813721  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.602466106414795  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 14 input nodes size: 2129905
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5917391777038574  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5918307304382324  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7987704277038574  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1317448616027832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1317448616027832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2129905
first layer output nodes number: 1545031
edges number: 33105920
torch.Size([2129905, 100])
torch.Size([1545031, 256])
input nodes number: 1545031
output nodes number: 335234
edges number: 10844380
torch.Size([1545031, 256])
torch.Size([335234, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.457301139831543  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.459453105926514  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6035199165344238  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 15 input nodes size: 2130097
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7987704277038574  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7987704277038574  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5922937393188477  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5923852920532227  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7988419532775879  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1310515403747559  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1310515403747559  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2130097
first layer output nodes number: 1546387
edges number: 33114889
torch.Size([2130097, 100])
torch.Size([1546387, 256])
input nodes number: 1546387
output nodes number: 335921
edges number: 10877835
torch.Size([1546387, 256])
torch.Size([335921, 256])
torch.Size([12281, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.463146209716797  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.466165065765381  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.604069709777832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.604069709777832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.604069709777832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37671300768852234 |0.3030078560113907 |0.10044856369495392 |0.0001459568738937378 |0.00402243435382843 |0.0027794837951660156 |
----------------------------------------------------------pseudo_mini_loss sum 4.490123271942139
Total (block generation + training)time/epoch 888.1034640669823
Training time/epoch 12.777991533279419
Training time without block to device /epoch 7.929865837097168
Training time without total dataloading part /epoch 1.6766507625579834
load block tensor time/epoch 6.027408123016357
block to device time/epoch 4.848125696182251
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  64165029
Number of first layer input nodes during this epoch:  34055658
Number of first layer output nodes during this epoch:  24730256
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6040692329406738  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.31595921516418457
number of batches is  16
batch size is  12286
range selection method spend 0.046529531478881836
time for parepare:  0.2926671504974365
local_output_nid generation:  0.0035033226013183594
local_in_edges_tensor generation:  0.03509640693664551
mini_batch_src_global generation:  0.015877246856689453
r_  generation:  0.19241070747375488
local_output_nid generation:  0.003875255584716797
local_in_edges_tensor generation:  0.0057108402252197266
mini_batch_src_global generation:  0.021977663040161133
r_  generation:  0.21375250816345215
local_output_nid generation:  0.0038955211639404297
local_in_edges_tensor generation:  0.006075859069824219
mini_batch_src_global generation:  0.013070106506347656
r_  generation:  0.22528743743896484
local_output_nid generation:  0.004117250442504883
local_in_edges_tensor generation:  0.004114866256713867
mini_batch_src_global generation:  0.013204336166381836
r_  generation:  0.23468613624572754
local_output_nid generation:  0.004006862640380859
local_in_edges_tensor generation:  0.0046803951263427734
mini_batch_src_global generation:  0.015802621841430664
r_  generation:  0.243574857711792
local_output_nid generation:  0.003937244415283203
local_in_edges_tensor generation:  0.0061037540435791016
mini_batch_src_global generation:  0.016643285751342773
r_  generation:  0.25165462493896484
local_output_nid generation:  0.0038368701934814453
local_in_edges_tensor generation:  0.004742622375488281
mini_batch_src_global generation:  0.016791343688964844
r_  generation:  0.26793646812438965
local_output_nid generation:  0.003983974456787109
local_in_edges_tensor generation:  0.004195451736450195
mini_batch_src_global generation:  0.0180819034576416
r_  generation:  0.26641416549682617
local_output_nid generation:  0.0039365291595458984
local_in_edges_tensor generation:  0.005167484283447266
mini_batch_src_global generation:  0.017461538314819336
r_  generation:  0.26471948623657227
local_output_nid generation:  0.0039293766021728516
local_in_edges_tensor generation:  0.0041887760162353516
mini_batch_src_global generation:  0.018491029739379883
r_  generation:  0.2721822261810303
local_output_nid generation:  0.003966331481933594
local_in_edges_tensor generation:  0.00420832633972168
mini_batch_src_global generation:  0.01988506317138672
r_  generation:  0.2829904556274414
local_output_nid generation:  0.003939628601074219
local_in_edges_tensor generation:  0.0041844844818115234
mini_batch_src_global generation:  0.02036118507385254
r_  generation:  0.2897958755493164
local_output_nid generation:  0.003826618194580078
local_in_edges_tensor generation:  0.004858732223510742
mini_batch_src_global generation:  0.02064800262451172
r_  generation:  0.28130006790161133
local_output_nid generation:  0.004013776779174805
local_in_edges_tensor generation:  0.00414276123046875
mini_batch_src_global generation:  0.024203777313232422
r_  generation:  0.2846229076385498
local_output_nid generation:  0.003828287124633789
local_in_edges_tensor generation:  0.004254579544067383
mini_batch_src_global generation:  0.022126436233520508
r_  generation:  0.2856614589691162
local_output_nid generation:  0.004097700119018555
local_in_edges_tensor generation:  0.004510164260864258
mini_batch_src_global generation:  0.02238941192626953
r_  generation:  0.2877380847930908
----------------------check_connections_block total spend ----------------------------- 5.694467782974243
generate_one_block  0.6229550838470459
generate_one_block  0.3489201068878174
generate_one_block  0.3705446720123291
generate_one_block  0.4035923480987549
generate_one_block  0.3131868839263916
generate_one_block  0.46475672721862793
generate_one_block  0.3287498950958252
generate_one_block  0.29558420181274414
generate_one_block  0.30170249938964844
generate_one_block  0.30065393447875977
generate_one_block  0.29155707359313965
generate_one_block  0.2887282371520996
generate_one_block  0.2915806770324707
generate_one_block  0.2924387454986572
generate_one_block  0.2875981330871582
generate_one_block  0.29035520553588867
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1624436378479004
gen group dst list time:  0.15975308418273926
time for parepare:  0.4465324878692627
local_output_nid generation:  0.08084940910339355
local_in_edges_tensor generation:  0.3327808380126953
mini_batch_src_global generation:  0.3589808940887451
r_  generation:  4.605397939682007
local_output_nid generation:  0.10177350044250488
local_in_edges_tensor generation:  0.3203768730163574
mini_batch_src_global generation:  0.45528721809387207
r_  generation:  4.694254159927368
local_output_nid generation:  0.10766911506652832
local_in_edges_tensor generation:  0.2822401523590088
mini_batch_src_global generation:  0.4381113052368164
r_  generation:  4.9791107177734375
local_output_nid generation:  0.11406850814819336
local_in_edges_tensor generation:  0.42352795600891113
mini_batch_src_global generation:  0.44694066047668457
r_  generation:  4.808888673782349
local_output_nid generation:  0.11014890670776367
local_in_edges_tensor generation:  0.28445005416870117
mini_batch_src_global generation:  0.4616861343383789
r_  generation:  4.899685382843018
local_output_nid generation:  0.10929155349731445
local_in_edges_tensor generation:  0.29259586334228516
mini_batch_src_global generation:  0.5334551334381104
r_  generation:  5.416074514389038
local_output_nid generation:  0.12666797637939453
local_in_edges_tensor generation:  0.4136648178100586
mini_batch_src_global generation:  0.5004384517669678
r_  generation:  5.1267945766448975
local_output_nid generation:  0.12388944625854492
local_in_edges_tensor generation:  0.4111049175262451
mini_batch_src_global generation:  0.595771074295044
r_  generation:  5.008532524108887
local_output_nid generation:  0.12190961837768555
local_in_edges_tensor generation:  0.29776883125305176
mini_batch_src_global generation:  0.48241734504699707
r_  generation:  5.002024412155151
local_output_nid generation:  0.12224698066711426
local_in_edges_tensor generation:  0.2928755283355713
mini_batch_src_global generation:  0.479400634765625
r_  generation:  5.054461717605591
local_output_nid generation:  0.11424589157104492
local_in_edges_tensor generation:  0.3559234142303467
mini_batch_src_global generation:  0.5004768371582031
r_  generation:  5.200891971588135
local_output_nid generation:  0.13384032249450684
local_in_edges_tensor generation:  0.3498697280883789
mini_batch_src_global generation:  0.4799158573150635
r_  generation:  5.034042835235596
local_output_nid generation:  0.1240997314453125
local_in_edges_tensor generation:  0.30090928077697754
mini_batch_src_global generation:  0.4836883544921875
r_  generation:  5.103007793426514
local_output_nid generation:  0.11628866195678711
local_in_edges_tensor generation:  0.29814887046813965
mini_batch_src_global generation:  0.48734116554260254
r_  generation:  5.129601955413818
local_output_nid generation:  0.11989855766296387
local_in_edges_tensor generation:  0.4331636428833008
mini_batch_src_global generation:  0.5352532863616943
r_  generation:  5.038362503051758
local_output_nid generation:  0.13064002990722656
local_in_edges_tensor generation:  0.30495142936706543
mini_batch_src_global generation:  0.48145055770874023
r_  generation:  5.040980577468872
----------------------check_connections_block total spend ----------------------------- 109.1517403125763
generate_one_block  6.65835165977478
generate_one_block  6.2582457065582275
generate_one_block  6.5737199783325195
generate_one_block  6.205490827560425
generate_one_block  6.539686679840088
generate_one_block  6.237225294113159
generate_one_block  6.618960857391357
generate_one_block  6.25105094909668
generate_one_block  6.267230272293091
generate_one_block  6.241346120834351
generate_one_block  6.589388847351074
generate_one_block  6.215108156204224
generate_one_block  6.251091480255127
generate_one_block  6.336412668228149
generate_one_block  6.568045616149902
generate_one_block  6.251318693161011
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3582816123962402
gen group dst list time:  0.9009065628051758
time for parepare:  0.4798445701599121
local_output_nid generation:  0.45120668411254883
local_in_edges_tensor generation:  1.1513574123382568
mini_batch_src_global generation:  1.0406038761138916
r_  generation:  14.071023225784302
local_output_nid generation:  0.5291094779968262
local_in_edges_tensor generation:  1.2306768894195557
mini_batch_src_global generation:  1.3549222946166992
r_  generation:  14.097380638122559
local_output_nid generation:  0.5125458240509033
local_in_edges_tensor generation:  1.0577216148376465
mini_batch_src_global generation:  1.4405498504638672
r_  generation:  14.420450210571289
local_output_nid generation:  0.5519986152648926
local_in_edges_tensor generation:  1.0849063396453857
mini_batch_src_global generation:  1.3238170146942139
r_  generation:  14.655789375305176
local_output_nid generation:  0.5096299648284912
local_in_edges_tensor generation:  1.1338284015655518
mini_batch_src_global generation:  1.342799425125122
r_  generation:  14.300098896026611
local_output_nid generation:  0.5390450954437256
local_in_edges_tensor generation:  1.0774738788604736
mini_batch_src_global generation:  1.601609468460083
r_  generation:  14.932195663452148
local_output_nid generation:  0.5552890300750732
local_in_edges_tensor generation:  1.16300630569458
mini_batch_src_global generation:  1.442450761795044
r_  generation:  15.356744050979614
local_output_nid generation:  0.5760970115661621
local_in_edges_tensor generation:  1.1512770652770996
mini_batch_src_global generation:  2.0124001502990723
r_  generation:  14.452831745147705
local_output_nid generation:  0.5505683422088623
local_in_edges_tensor generation:  1.0872740745544434
mini_batch_src_global generation:  1.4311668872833252
r_  generation:  14.62058711051941
local_output_nid generation:  0.5718638896942139
local_in_edges_tensor generation:  1.1492040157318115
mini_batch_src_global generation:  1.3388168811798096
r_  generation:  14.769994497299194
local_output_nid generation:  0.5253169536590576
local_in_edges_tensor generation:  1.1508729457855225
mini_batch_src_global generation:  1.4177093505859375
r_  generation:  15.102628707885742
local_output_nid generation:  0.5782983303070068
local_in_edges_tensor generation:  1.179314374923706
mini_batch_src_global generation:  1.6060419082641602
r_  generation:  14.379732847213745
local_output_nid generation:  0.5771205425262451
local_in_edges_tensor generation:  1.0889456272125244
mini_batch_src_global generation:  1.4210717678070068
r_  generation:  14.619057893753052
local_output_nid generation:  0.5608036518096924
local_in_edges_tensor generation:  1.1544814109802246
mini_batch_src_global generation:  1.3292663097381592
r_  generation:  14.72855806350708
local_output_nid generation:  0.550861120223999
local_in_edges_tensor generation:  1.159407615661621
mini_batch_src_global generation:  1.3778660297393799
r_  generation:  14.406657218933105
local_output_nid generation:  0.5687389373779297
local_in_edges_tensor generation:  1.1096124649047852
mini_batch_src_global generation:  1.4306528568267822
r_  generation:  14.469452857971191
----------------------check_connections_block total spend ----------------------------- 324.8147270679474
generate_one_block  19.314549684524536
generate_one_block  20.82916021347046
generate_one_block  19.43600106239319
generate_one_block  19.360960483551025
generate_one_block  18.86470627784729
generate_one_block  18.966580867767334
generate_one_block  19.360002756118774
generate_one_block  19.379767179489136
generate_one_block  19.23061466217041
generate_one_block  18.926694869995117
generate_one_block  18.84147548675537
generate_one_block  19.28564763069153
generate_one_block  19.42298698425293
generate_one_block  19.338395833969116
generate_one_block  19.654707431793213
generate_one_block  19.22547149658203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6040692329406738  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

connection checking time:  433.9664673805237
block generation total time  411.5003967285156
average batch blocks generation time:  25.718774795532227
block dataloader generation time/epoch 875.4235714912414
pseudo mini batch 0 input nodes size: 2128007
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7988400459289551  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7988400459289551  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.591808795928955  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.59190034866333  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982854843139648  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1298656463623047  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1298656463623047  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128007
first layer output nodes number: 1541806
edges number: 32986809
torch.Size([2128007, 100])
torch.Size([1541806, 256])
input nodes number: 1541806
output nodes number: 334732
edges number: 10831539
torch.Size([1541806, 256])
torch.Size([334732, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.446047782897949  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.448200225830078  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.600182056427002  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 1 input nodes size: 2125726
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5901823043823242  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5902738571166992  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7972135543823242  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1289434432983398  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1289434432983398  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2125726
first layer output nodes number: 1541210
edges number: 33049469
torch.Size([2125726, 100])
torch.Size([1541210, 256])
input nodes number: 1541210
output nodes number: 335381
edges number: 10860096
torch.Size([1541210, 256])
torch.Size([335381, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.44580078125  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.448357582092285  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.602344036102295  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 2 input nodes size: 2128067
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7972135543823242  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7972135543823242  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5901823043823242  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5902738571166992  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1301774978637695  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1301774978637695  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128067
first layer output nodes number: 1543938
edges number: 33069996
torch.Size([2128067, 100])
torch.Size([1543938, 256])
input nodes number: 1543938
output nodes number: 336313
edges number: 10882606
torch.Size([1543938, 256])
torch.Size([336313, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.456916809082031  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.459068775177002  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6037406921386719  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 3 input nodes size: 2128135
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5910797119140625  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5911712646484375  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7981109619140625  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1301240921020508  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1301240921020508  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128135
first layer output nodes number: 1545640
edges number: 33087527
torch.Size([2128135, 100])
torch.Size([1545640, 256])
input nodes number: 1545640
output nodes number: 335869
edges number: 10871432
torch.Size([1545640, 256])
torch.Size([335869, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.459333419799805  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.461485385894775  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6023635864257812  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 4 input nodes size: 2128514
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7981109619140625  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7981109619140625  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5910797119140625  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5911712646484375  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1303706169128418  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1303706169128418  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128514
first layer output nodes number: 1543354
edges number: 33043690
torch.Size([2128514, 100])
torch.Size([1543354, 256])
input nodes number: 1543354
output nodes number: 334047
edges number: 10801173
torch.Size([1543354, 256])
torch.Size([334047, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.448413848876953  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.450565814971924  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6008505821228027  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 5 input nodes size: 2129017
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5914082527160645  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5914998054504395  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984395027160645  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1310410499572754  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1310410499572754  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2129017
first layer output nodes number: 1547994
edges number: 33165619
torch.Size([2129017, 100])
torch.Size([1547994, 256])
input nodes number: 1547994
output nodes number: 337121
edges number: 10910730
torch.Size([1547994, 256])
torch.Size([337121, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.471887111663818  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.474039077758789  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6052241325378418  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 6 input nodes size: 2130215
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984395027160645  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984395027160645  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5920066833496094  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5920982360839844  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7988858222961426  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.131772518157959  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.131772518157959  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2130215
first layer output nodes number: 1547393
edges number: 33133839
torch.Size([2130215, 100])
torch.Size([1547393, 256])
input nodes number: 1547393
output nodes number: 336740
edges number: 10890043
torch.Size([1547393, 256])
torch.Size([336740, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.467677593231201  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.469829559326172  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6039924621582031  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 7 input nodes size: 2129541
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7988858222961426  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7988858222961426  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5922017097473145  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5922932624816895  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7986345291137695  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1312475204467773  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1312475204467773  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2129541
first layer output nodes number: 1549157
edges number: 33166329
torch.Size([2129541, 100])
torch.Size([1549157, 256])
input nodes number: 1549157
output nodes number: 338028
edges number: 10944310
torch.Size([1549157, 256])
torch.Size([338028, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.478279113769531  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.480431079864502  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6059956550598145  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 8 input nodes size: 2128386
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7986345291137695  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7986345291137695  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5916032791137695  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5916948318481445  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1304454803466797  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1304454803466797  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128386
first layer output nodes number: 1545744
edges number: 33108061
torch.Size([2128386, 100])
torch.Size([1545744, 256])
input nodes number: 1545744
output nodes number: 335306
edges number: 10860609
torch.Size([1545744, 256])
torch.Size([335306, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.457907199859619  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.46005916595459  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.602644920349121  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 9 input nodes size: 2130111
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5918159484863281  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5919075012207031  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7988471984863281  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1312060356140137  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1312060356140137  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2130111
first layer output nodes number: 1545861
edges number: 33120552
torch.Size([2130111, 100])
torch.Size([1545861, 256])
input nodes number: 1545861
output nodes number: 335805
edges number: 10870129
torch.Size([1545861, 256])
torch.Size([335805, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.461535453796387  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.464227199554443  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6050453186035156  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 10 input nodes size: 2130679
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7988471984863281  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7988471984863281  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5925869941711426  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5926785469055176  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7990584373474121  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1309542655944824  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1309542655944824  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2130679
first layer output nodes number: 1545591
edges number: 33071595
torch.Size([2130679, 100])
torch.Size([1545591, 256])
input nodes number: 1545591
output nodes number: 336345
edges number: 10870031
torch.Size([1545591, 256])
torch.Size([336345, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.4607768058776855  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.462928771972656  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6027827262878418  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 11 input nodes size: 2125333
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7991137504577637  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7991137504577637  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5908622741699219  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5909538269042969  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7971224784851074  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.128892421722412  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.128892421722412  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2125333
first layer output nodes number: 1542858
edges number: 33054298
torch.Size([2125333, 100])
torch.Size([1542858, 256])
input nodes number: 1542858
output nodes number: 336114
edges number: 10877714
torch.Size([1542858, 256])
torch.Size([336114, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.451351642608643  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.453503608703613  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5996508598327637  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 12 input nodes size: 2125687
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7970671653747559  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7970671653747559  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5889472961425781  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5890388488769531  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7971987724304199  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1287922859191895  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1287922859191895  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2125687
first layer output nodes number: 1540208
edges number: 32972958
torch.Size([2125687, 100])
torch.Size([1540208, 256])
input nodes number: 1540208
output nodes number: 335568
edges number: 10856812
torch.Size([1540208, 256])
torch.Size([335568, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.4438934326171875  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.446045398712158  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6021952629089355  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 13 input nodes size: 2128303
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7971987724304199  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7971987724304199  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.59016752243042  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.590259075164795  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1300010681152344  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1300010681152344  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128303
first layer output nodes number: 1543813
edges number: 33047090
torch.Size([2128303, 100])
torch.Size([1543813, 256])
input nodes number: 1543813
output nodes number: 336734
edges number: 10883935
torch.Size([1543813, 256])
torch.Size([336734, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.457028388977051  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.4591803550720215  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6017522811889648  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 14 input nodes size: 2128007
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5910320281982422  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5911235809326172  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7980632781982422  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1301183700561523  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1301183700561523  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128007
first layer output nodes number: 1546938
edges number: 33094321
torch.Size([2128007, 100])
torch.Size([1546938, 256])
input nodes number: 1546938
output nodes number: 335912
edges number: 10849321
torch.Size([1546938, 256])
torch.Size([335912, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.4624247550964355  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.464917182922363  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6025376319885254  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 15 input nodes size: 2129992
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7980632781982422  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7980632781982422  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5915474891662598  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5916390419006348  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7988028526306152  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1326274871826172  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1326274871826172  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2129992
first layer output nodes number: 1550729
edges number: 33228197
torch.Size([2129992, 100])
torch.Size([1550729, 256])
input nodes number: 1550729
output nodes number: 336677
edges number: 10899367
torch.Size([1550729, 256])
torch.Size([336677, 256])
torch.Size([12281, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.477643966674805  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.480123043060303  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6076135635375977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6076135635375977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6076135635375977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.36304888129234314 |0.31101804971694946 |0.10039539635181427 |0.0001392960548400879 |0.004039645195007324 |0.0013115406036376953 |
----------------------------------------------------------pseudo_mini_loss sum 3.3813343048095703
Total (block generation + training)time/epoch 889.3397904872894
Training time/epoch 12.68485403060913
Training time without block to device /epoch 7.7085652351379395
Training time without total dataloading part /epoch 1.6745009422302246
load block tensor time/epoch 5.80878210067749
block to device time/epoch 4.976288795471191
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  64152646
Number of first layer input nodes during this epoch:  34053720
Number of first layer output nodes during this epoch:  24722234
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6076130867004395  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.31638073921203613
number of batches is  16
batch size is  12286
range selection method spend 0.03519105911254883
time for parepare:  0.28232526779174805
local_output_nid generation:  0.003485441207885742
local_in_edges_tensor generation:  0.025255441665649414
mini_batch_src_global generation:  0.01576685905456543
r_  generation:  0.18730902671813965
local_output_nid generation:  0.003926515579223633
local_in_edges_tensor generation:  0.005822181701660156
mini_batch_src_global generation:  0.0201416015625
r_  generation:  0.21294188499450684
local_output_nid generation:  0.004027128219604492
local_in_edges_tensor generation:  0.004752397537231445
mini_batch_src_global generation:  0.012363672256469727
r_  generation:  0.22390961647033691
local_output_nid generation:  0.004046440124511719
local_in_edges_tensor generation:  0.004736423492431641
mini_batch_src_global generation:  0.014470577239990234
r_  generation:  0.2319958209991455
local_output_nid generation:  0.003937482833862305
local_in_edges_tensor generation:  0.004063606262207031
mini_batch_src_global generation:  0.013541221618652344
r_  generation:  0.24145960807800293
local_output_nid generation:  0.00386810302734375
local_in_edges_tensor generation:  0.004811763763427734
mini_batch_src_global generation:  0.015797853469848633
r_  generation:  0.2509469985961914
local_output_nid generation:  0.003979206085205078
local_in_edges_tensor generation:  0.0037882328033447266
mini_batch_src_global generation:  0.01766371726989746
r_  generation:  0.2628755569458008
local_output_nid generation:  0.00394129753112793
local_in_edges_tensor generation:  0.0036013126373291016
mini_batch_src_global generation:  0.019281864166259766
r_  generation:  0.26696228981018066
local_output_nid generation:  0.0038056373596191406
local_in_edges_tensor generation:  0.004176139831542969
mini_batch_src_global generation:  0.017339706420898438
r_  generation:  0.2642703056335449
local_output_nid generation:  0.0038220882415771484
local_in_edges_tensor generation:  0.004154205322265625
mini_batch_src_global generation:  0.01850271224975586
r_  generation:  0.2680928707122803
local_output_nid generation:  0.0038242340087890625
local_in_edges_tensor generation:  0.004347562789916992
mini_batch_src_global generation:  0.019689559936523438
r_  generation:  0.27730226516723633
local_output_nid generation:  0.003788471221923828
local_in_edges_tensor generation:  0.004172325134277344
mini_batch_src_global generation:  0.01992034912109375
r_  generation:  0.27361178398132324
local_output_nid generation:  0.003766775131225586
local_in_edges_tensor generation:  0.005533456802368164
mini_batch_src_global generation:  0.020539522171020508
r_  generation:  0.2740137577056885
local_output_nid generation:  0.003848552703857422
local_in_edges_tensor generation:  0.004813432693481445
mini_batch_src_global generation:  0.020940542221069336
r_  generation:  0.28098249435424805
local_output_nid generation:  0.004046916961669922
local_in_edges_tensor generation:  0.004828929901123047
mini_batch_src_global generation:  0.021478891372680664
r_  generation:  0.2748394012451172
local_output_nid generation:  0.0040509700775146484
local_in_edges_tensor generation:  0.005466938018798828
mini_batch_src_global generation:  0.02256917953491211
r_  generation:  0.2768261432647705
----------------------check_connections_block total spend ----------------------------- 5.571106910705566
generate_one_block  0.6049582958221436
generate_one_block  0.33767056465148926
generate_one_block  0.3003880977630615
generate_one_block  0.28652429580688477
generate_one_block  0.2888944149017334
generate_one_block  0.29175353050231934
generate_one_block  0.2846097946166992
generate_one_block  0.2883484363555908
generate_one_block  0.30138301849365234
generate_one_block  0.28927087783813477
generate_one_block  0.29153943061828613
generate_one_block  0.2937026023864746
generate_one_block  0.29291677474975586
generate_one_block  0.2904050350189209
generate_one_block  0.2885918617248535
generate_one_block  0.29288387298583984
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1937508583068848
gen group dst list time:  0.15974855422973633
time for parepare:  0.44322824478149414
local_output_nid generation:  0.07621455192565918
local_in_edges_tensor generation:  0.2913541793823242
mini_batch_src_global generation:  0.36428093910217285
r_  generation:  4.6519153118133545
local_output_nid generation:  0.10293865203857422
local_in_edges_tensor generation:  0.30008912086486816
mini_batch_src_global generation:  0.45297837257385254
r_  generation:  4.816758632659912
local_output_nid generation:  0.10740876197814941
local_in_edges_tensor generation:  0.3238043785095215
mini_batch_src_global generation:  0.455859899520874
r_  generation:  5.002107620239258
local_output_nid generation:  0.11275768280029297
local_in_edges_tensor generation:  0.349700927734375
mini_batch_src_global generation:  0.4494156837463379
r_  generation:  4.834670066833496
local_output_nid generation:  0.10590767860412598
local_in_edges_tensor generation:  0.29787325859069824
mini_batch_src_global generation:  0.46498942375183105
r_  generation:  5.0280091762542725
local_output_nid generation:  0.11341333389282227
local_in_edges_tensor generation:  0.29584789276123047
mini_batch_src_global generation:  0.47792863845825195
r_  generation:  5.168995380401611
local_output_nid generation:  0.1235957145690918
local_in_edges_tensor generation:  0.424898624420166
mini_batch_src_global generation:  0.4838268756866455
r_  generation:  4.973541498184204
local_output_nid generation:  0.11175298690795898
local_in_edges_tensor generation:  0.2963404655456543
mini_batch_src_global generation:  0.4794018268585205
r_  generation:  5.052473306655884
local_output_nid generation:  0.13241028785705566
local_in_edges_tensor generation:  0.2939620018005371
mini_batch_src_global generation:  0.485889196395874
r_  generation:  5.0298590660095215
local_output_nid generation:  0.11280369758605957
local_in_edges_tensor generation:  0.4224677085876465
mini_batch_src_global generation:  0.5099453926086426
r_  generation:  5.049883842468262
local_output_nid generation:  0.13301849365234375
local_in_edges_tensor generation:  0.2997913360595703
mini_batch_src_global generation:  0.48350071907043457
r_  generation:  5.048723220825195
local_output_nid generation:  0.1223454475402832
local_in_edges_tensor generation:  0.2945520877838135
mini_batch_src_global generation:  0.49704575538635254
r_  generation:  5.0749781131744385
local_output_nid generation:  0.11838197708129883
local_in_edges_tensor generation:  0.3688993453979492
mini_batch_src_global generation:  0.5110716819763184
r_  generation:  5.194910049438477
local_output_nid generation:  0.13390278816223145
local_in_edges_tensor generation:  0.3627610206604004
mini_batch_src_global generation:  0.48798394203186035
r_  generation:  5.00969386100769
local_output_nid generation:  0.11827945709228516
local_in_edges_tensor generation:  0.3006856441497803
mini_batch_src_global generation:  0.48487162590026855
r_  generation:  5.115861177444458
local_output_nid generation:  0.12703442573547363
local_in_edges_tensor generation:  0.2995903491973877
mini_batch_src_global generation:  0.4930899143218994
r_  generation:  5.097466230392456
----------------------check_connections_block total spend ----------------------------- 108.75285601615906
generate_one_block  6.632009506225586
generate_one_block  6.2334277629852295
generate_one_block  6.309498071670532
generate_one_block  6.285009860992432
generate_one_block  6.938146591186523
generate_one_block  6.261713266372681
generate_one_block  6.375607490539551
generate_one_block  6.452545881271362
generate_one_block  6.471097469329834
generate_one_block  6.263794898986816
generate_one_block  6.322121620178223
generate_one_block  6.48527979850769
generate_one_block  6.417754173278809
generate_one_block  6.223769903182983
generate_one_block  6.298717975616455
generate_one_block  6.518251657485962
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2649481296539307
gen group dst list time:  0.8687808513641357
time for parepare:  0.4668407440185547
local_output_nid generation:  0.46230220794677734
local_in_edges_tensor generation:  1.0912837982177734
mini_batch_src_global generation:  1.1011216640472412
r_  generation:  14.156009197235107
local_output_nid generation:  0.5514955520629883
local_in_edges_tensor generation:  1.1662633419036865
mini_batch_src_global generation:  1.5371625423431396
r_  generation:  14.17959976196289
local_output_nid generation:  0.5365011692047119
local_in_edges_tensor generation:  1.1206367015838623
mini_batch_src_global generation:  1.4052584171295166
r_  generation:  14.52826189994812
local_output_nid generation:  0.5546748638153076
local_in_edges_tensor generation:  1.0844790935516357
mini_batch_src_global generation:  1.3202605247497559
r_  generation:  14.699782609939575
local_output_nid generation:  0.5274622440338135
local_in_edges_tensor generation:  1.1401913166046143
mini_batch_src_global generation:  1.3700237274169922
r_  generation:  14.338571310043335
local_output_nid generation:  0.5464646816253662
local_in_edges_tensor generation:  1.0846507549285889
mini_batch_src_global generation:  1.4479544162750244
r_  generation:  14.483125448226929
local_output_nid generation:  0.5813562870025635
local_in_edges_tensor generation:  1.101515293121338
mini_batch_src_global generation:  1.3926219940185547
r_  generation:  14.637352705001831
local_output_nid generation:  0.559617280960083
local_in_edges_tensor generation:  1.140676736831665
mini_batch_src_global generation:  1.3377685546875
r_  generation:  14.671992301940918
local_output_nid generation:  0.5633461475372314
local_in_edges_tensor generation:  1.1775691509246826
mini_batch_src_global generation:  1.417806625366211
r_  generation:  14.369298696517944
local_output_nid generation:  0.5651164054870605
local_in_edges_tensor generation:  1.0957181453704834
mini_batch_src_global generation:  1.4522285461425781
r_  generation:  14.467138290405273
local_output_nid generation:  0.5850107669830322
local_in_edges_tensor generation:  1.1022446155548096
mini_batch_src_global generation:  1.3986716270446777
r_  generation:  14.64833116531372
local_output_nid generation:  0.5580401420593262
local_in_edges_tensor generation:  1.1424610614776611
mini_batch_src_global generation:  1.3342881202697754
r_  generation:  14.635291576385498
local_output_nid generation:  0.5504405498504639
local_in_edges_tensor generation:  1.1746704578399658
mini_batch_src_global generation:  1.4173431396484375
r_  generation:  14.298530340194702
local_output_nid generation:  0.5648365020751953
local_in_edges_tensor generation:  1.1001684665679932
mini_batch_src_global generation:  1.4071941375732422
r_  generation:  14.447970628738403
local_output_nid generation:  0.5829353332519531
local_in_edges_tensor generation:  1.1028087139129639
mini_batch_src_global generation:  1.4139900207519531
r_  generation:  14.711277723312378
local_output_nid generation:  0.5673770904541016
local_in_edges_tensor generation:  1.1514337062835693
mini_batch_src_global generation:  1.3357079029083252
r_  generation:  14.684575080871582
----------------------check_connections_block total spend ----------------------------- 322.0582342147827
generate_one_block  19.375787258148193
generate_one_block  20.248839855194092
generate_one_block  19.167712926864624
generate_one_block  19.31071710586548
generate_one_block  19.36205816268921
generate_one_block  19.137443780899048
generate_one_block  18.984241724014282
generate_one_block  19.186021089553833
generate_one_block  19.270662784576416
generate_one_block  19.34289050102234
generate_one_block  19.361295700073242
generate_one_block  19.000530242919922
generate_one_block  18.913385152816772
generate_one_block  19.148312091827393
generate_one_block  19.602153301239014
generate_one_block  19.48379111289978
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6076130867004395  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

connection checking time:  430.8110902309418
block generation total time  411.3845887184143
average batch blocks generation time:  25.711536794900894
block dataloader generation time/epoch 875.6657286087672
pseudo mini batch 0 input nodes size: 2125752
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7989273071289062  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7989273071289062  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5908317565917969  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5909233093261719  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7973475456237793  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1290497779846191  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1290497779846191  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2125752
first layer output nodes number: 1541285
edges number: 33046030
torch.Size([2125752, 100])
torch.Size([1541285, 256])
input nodes number: 1541285
output nodes number: 335119
edges number: 10852988
torch.Size([1541285, 256])
torch.Size([335119, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.444698333740234  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.446976184844971  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6007261276245117  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 1 input nodes size: 2129230
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7972230911254883  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7972230911254883  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5904231071472168  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5905146598815918  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7985186576843262  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1303982734680176  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1303982734680176  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2129230
first layer output nodes number: 1545124
edges number: 33069215
torch.Size([2129230, 100])
torch.Size([1545124, 256])
input nodes number: 1545124
output nodes number: 336072
edges number: 10873774
torch.Size([1545124, 256])
torch.Size([336072, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.45903205871582  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.461536884307861  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6034107208251953  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 2 input nodes size: 2131694
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7985186576843262  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7985186576843262  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5926365852355957  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5927281379699707  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7994365692138672  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.131983757019043  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.131983757019043  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2131694
first layer output nodes number: 1549077
edges number: 33158598
torch.Size([2131694, 100])
torch.Size([1549077, 256])
input nodes number: 1549077
output nodes number: 336554
edges number: 10875861
torch.Size([1549077, 256])
torch.Size([336554, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.473270893096924  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.4754228591918945  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6055688858032227  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 3 input nodes size: 2125317
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7994365692138672  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7994365692138672  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5911788940429688  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5912704467773438  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7970609664916992  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1286354064941406  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1286354064941406  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2125317
first layer output nodes number: 1538804
edges number: 32966288
torch.Size([2125317, 100])
torch.Size([1538804, 256])
input nodes number: 1538804
output nodes number: 334107
edges number: 10806894
torch.Size([1538804, 256])
torch.Size([334107, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.432609558105469  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.4347615242004395  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5979046821594238  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 4 input nodes size: 2129027
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7970609664916992  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7970609664916992  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5901856422424316  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5902771949768066  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984433174133301  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1308560371398926  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1308560371398926  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2129027
first layer output nodes number: 1548801
edges number: 33140036
torch.Size([2129027, 100])
torch.Size([1548801, 256])
input nodes number: 1548801
output nodes number: 337049
edges number: 10904932
torch.Size([1548801, 256])
torch.Size([337049, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.472973346710205  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.475125312805176  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.604990005493164  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 5 input nodes size: 2128008
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984433174133301  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984433174133301  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.59141206741333  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.591503620147705  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1305484771728516  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1305484771728516  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128008
first layer output nodes number: 1547835
edges number: 33120746
torch.Size([2128008, 100])
torch.Size([1547835, 256])
input nodes number: 1547835
output nodes number: 335690
edges number: 10855127
torch.Size([1547835, 256])
torch.Size([335690, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.465939044952393  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.468091011047363  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6050000190734863  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 6 input nodes size: 2127916
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5909981727600098  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5910897254943848  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7980294227600098  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1305346488952637  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1305346488952637  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127916
first layer output nodes number: 1542702
edges number: 33062382
torch.Size([2127916, 100])
torch.Size([1542702, 256])
input nodes number: 1542702
output nodes number: 335525
edges number: 10864971
torch.Size([1542702, 256])
torch.Size([335525, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.452099323272705  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.454251289367676  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6044435501098633  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 7 input nodes size: 2130314
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7986569404602051  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7986569404602051  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5922608375549316  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5923523902893066  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7995500564575195  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.131814956665039  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.131814956665039  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2130314
first layer output nodes number: 1546863
edges number: 33120873
torch.Size([2130314, 100])
torch.Size([1546863, 256])
input nodes number: 1546863
output nodes number: 336857
edges number: 10899212
torch.Size([1546863, 256])
torch.Size([336857, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.466660022735596  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.469575881958008  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6039981842041016  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 8 input nodes size: 2128315
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7989225387573242  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7989225387573242  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5918912887573242  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5919828414916992  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1304206848144531  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1304206848144531  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128315
first layer output nodes number: 1545777
edges number: 33103603
torch.Size([2128315, 100])
torch.Size([1545777, 256])
input nodes number: 1545777
output nodes number: 336090
edges number: 10865764
torch.Size([1545777, 256])
torch.Size([336090, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.460518836975098  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.462670803070068  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.603044033050537  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 9 input nodes size: 2127629
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5908913612365723  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5909829139709473  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7979226112365723  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1297821998596191  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1297821998596191  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2127629
first layer output nodes number: 1544050
edges number: 33066148
torch.Size([2127629, 100])
torch.Size([1544050, 256])
input nodes number: 1544050
output nodes number: 336361
edges number: 10895951
torch.Size([1544050, 256])
torch.Size([336361, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.456257343292236  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.458910942077637  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.602799892425537  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 10 input nodes size: 2128588
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7979226112365723  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7979226112365723  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5908913612365723  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5909829139709473  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1303863525390625  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1303863525390625  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2128588
first layer output nodes number: 1545138
edges number: 33099528
torch.Size([2128588, 100])
torch.Size([1545138, 256])
input nodes number: 1545138
output nodes number: 337304
edges number: 10900754
torch.Size([1545138, 256])
torch.Size([337304, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.463480472564697  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.466422080993652  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.603062629699707  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 11 input nodes size: 2129085
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5914335250854492  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5915250778198242  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984647750854492  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130406379699707  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.130406379699707  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2129085
first layer output nodes number: 1544287
edges number: 33078849
torch.Size([2129085, 100])
torch.Size([1544287, 256])
input nodes number: 1544287
output nodes number: 334893
edges number: 10823001
torch.Size([1544287, 256])
torch.Size([334893, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.453840732574463  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.456832408905029  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.601956844329834  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 12 input nodes size: 2126244
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984647750854492  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7984647750854492  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5914335250854492  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5915250778198242  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1299467086791992  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1299467086791992  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2126244
first layer output nodes number: 1542862
edges number: 33039832
torch.Size([2126244, 100])
torch.Size([1542862, 256])
input nodes number: 1542862
output nodes number: 336121
edges number: 10878551
torch.Size([1542862, 256])
torch.Size([336121, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.452671051025391  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.454823017120361  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6022677421569824  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 13 input nodes size: 2126851
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5906014442443848  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5906929969787598  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7976326942443848  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1293578147888184  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1293578147888184  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2126851
first layer output nodes number: 1542226
edges number: 33047592
torch.Size([2126851, 100])
torch.Size([1542226, 256])
input nodes number: 1542226
output nodes number: 335654
edges number: 10863187
torch.Size([1542226, 256])
torch.Size([335654, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.448525428771973  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.450677394866943  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6007914543151855  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 14 input nodes size: 2129431
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7976326942443848  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7976326942443848  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5909075736999512  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5909991264343262  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7985935211181641  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1312904357910156  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1312904357910156  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2129431
first layer output nodes number: 1547723
edges number: 33179889
torch.Size([2129431, 100])
torch.Size([1547723, 256])
input nodes number: 1547723
output nodes number: 336675
edges number: 10909446
torch.Size([1547723, 256])
torch.Size([336675, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.468228816986084  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.470380783081055  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6051058769226074  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

pseudo mini batch 15 input nodes size: 2130850
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7985935211181641  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7985935211181641  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5923972129821777  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.5924887657165527  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.7991223335266113  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1323976516723633  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.1323976516723633  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

first layer input nodes number: 2130850
first layer output nodes number: 1550960
edges number: 33207823
torch.Size([2130850, 100])
torch.Size([1550960, 256])
input nodes number: 1550960
output nodes number: 336999
edges number: 10902062
torch.Size([1550960, 256])
torch.Size([336999, 256])
torch.Size([12281, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.480534553527832  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 6.483015060424805  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6080517768859863  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6080517768859863  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 1.6080517768859863  GigaBytes
Max Memory Allocated: 8.479976177215576  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37011465430259705 |0.3615977615118027 |0.09979918599128723 |0.0001437366008758545 |0.004037514328956604 |0.0029134750366210938 |
----------------------------------------------------------pseudo_mini_loss sum 2.2220423221588135
Total (block generation + training)time/epoch 889.5294300715128
Training time/epoch 13.600729703903198
Training time without block to device /epoch 7.8151655197143555
Training time without total dataloading part /epoch 1.6666004657745361
load block tensor time/epoch 5.921834468841553
block to device time/epoch 5.785564184188843
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  64154835
Number of first layer input nodes during this epoch:  34054251
Number of first layer output nodes during this epoch:  24723514
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
