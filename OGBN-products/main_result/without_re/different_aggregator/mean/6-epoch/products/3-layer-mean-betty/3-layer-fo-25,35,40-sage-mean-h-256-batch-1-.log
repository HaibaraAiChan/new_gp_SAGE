main start at this time 1656618662.6748097
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 3.793120861053467
pseudo mini batch 0 input nodes size: 2268901
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.8464717864990234  GigaBytes
Max Memory Allocated: 0.8464717864990234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.8479366302490234  GigaBytes
Max Memory Allocated: 0.8479366302490234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.8479366302490234  GigaBytes
Max Memory Allocated: 0.8479366302490234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.499110221862793  GigaBytes
Max Memory Allocated: 1.499110221862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.499110221862793  GigaBytes
Max Memory Allocated: 1.499110221862793  GigaBytes

first layer input nodes number: 2268901
first layer output nodes number: 2127629
edges number: 40433769
torch.Size([2268901, 100])
torch.Size([2127629, 256])
input nodes number: 2127629
output nodes number: 1377703
edges number: 39534554
torch.Size([2127629, 256])
torch.Size([1377703, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2362060546875 GB
    Memory Allocated: 12.115200519561768  GigaBytes
Max Memory Allocated: 13.116526126861572  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.2362060546875 GB
    Memory Allocated: 12.149619102478027  GigaBytes
Max Memory Allocated: 13.116526126861572  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 2.6213669776916504  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 2.6229043006896973  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 2.6229043006896973  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.374906063079834 |0.910048246383667 |0.9299154281616211 |0.00032210350036621094 |0.5181713104248047 |0.005559444427490234 |
----------------------------------------------------------pseudo_mini_loss sum 7.196291446685791
Total (block generation + training)time/epoch 6.612932443618774
Training time/epoch 2.8195583820343018
Training time without block to device /epoch 1.9095101356506348
Training time without total dataloading part /epoch 1.4539682865142822
load block tensor time/epoch 0.374906063079834
block to device time/epoch 0.910048246383667
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5774233
Number of first layer input nodes during this epoch:  2268901
Number of first layer output nodes during this epoch:  2127629
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 2.622903823852539  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 2.622903823852539  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 3.7948780059814453
pseudo mini batch 0 input nodes size: 2269058
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 1.7299504280090332  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 1.7314152717590332  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 0.8842473030090332  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 1.5353646278381348  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 1.5353646278381348  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

first layer input nodes number: 2269058
first layer output nodes number: 2127647
edges number: 40428736
torch.Size([2269058, 100])
torch.Size([2127647, 256])
input nodes number: 2127647
output nodes number: 1378144
edges number: 39531985
torch.Size([2127647, 256])
torch.Size([1378144, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6112060546875 GB
    Memory Allocated: 12.11742639541626  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6112060546875 GB
    Memory Allocated: 12.15184497833252  GigaBytes
Max Memory Allocated: 14.582077980041504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 2.6223812103271484  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 2.6223812103271484  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 2.6223812103271484  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.30142736434936523 |0.5671443939208984 |0.19649505615234375 |0.00023126602172851562 |0.5826351642608643 |0.0034809112548828125 |
----------------------------------------------------------pseudo_mini_loss sum 12.430387496948242
Total (block generation + training)time/epoch 6.078624725341797
Training time/epoch 1.7475030422210693
Training time without block to device /epoch 1.180358648300171
Training time without total dataloading part /epoch 0.7828423976898193
load block tensor time/epoch 0.30142736434936523
block to device time/epoch 0.5671443939208984
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5774849
Number of first layer input nodes during this epoch:  2269058
Number of first layer output nodes during this epoch:  2127647
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 2.6223807334899902  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 2.6223807334899902  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 3.786561886469523
pseudo mini batch 0 input nodes size: 2269268
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 0.8842473030090332  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 0.8842473030090332  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 1.7299504280090332  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 1.7314152717590332  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 1.535860538482666  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 1.535860538482666  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

first layer input nodes number: 2269268
first layer output nodes number: 2128035
edges number: 40442995
torch.Size([2269268, 100])
torch.Size([2128035, 256])
input nodes number: 2128035
output nodes number: 1377649
edges number: 39528945
torch.Size([2128035, 256])
torch.Size([1377649, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5760498046875 GB
    Memory Allocated: 12.117698192596436  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5760498046875 GB
    Memory Allocated: 12.152116775512695  GigaBytes
Max Memory Allocated: 14.584215641021729  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 2.622673511505127  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 2.622673511505127  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 2.622673511505127  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.29947876930236816 |0.545860767364502 |0.38573575019836426 |0.00014591217041015625 |0.599689245223999 |0.003495931625366211 |
----------------------------------------------------------pseudo_mini_loss sum 3.647691249847412
Total (block generation + training)time/epoch 5.952184836069743
Training time/epoch 1.9292149543762207
Training time without block to device /epoch 1.3833541870117188
Training time without total dataloading part /epoch 0.9890668392181396
load block tensor time/epoch 0.29947876930236816
block to device time/epoch 0.545860767364502
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5774952
Number of first layer input nodes during this epoch:  2269268
Number of first layer output nodes during this epoch:  2128035
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 2.6226730346679688  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 2.6226730346679688  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 3.776279866695404
pseudo mini batch 0 input nodes size: 2269448
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 1.7300958633422852  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 1.7315607070922852  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 0.8843927383422852  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 1.5354537963867188  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 1.5354537963867188  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

first layer input nodes number: 2269448
first layer output nodes number: 2127420
edges number: 40434784
torch.Size([2269448, 100])
torch.Size([2127420, 256])
input nodes number: 2127420
output nodes number: 1377606
edges number: 39518400
torch.Size([2127420, 256])
torch.Size([1377606, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2947998046875 GB
    Memory Allocated: 12.115138053894043  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.2947998046875 GB
    Memory Allocated: 12.149556636810303  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 2.6222991943359375  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 2.6222991943359375  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 2.6222991943359375  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.30239295959472656 |0.5523951053619385 |0.13639068603515625 |0.00013780593872070312 |0.014632701873779297 |0.003485441207885742 |
----------------------------------------------------------pseudo_mini_loss sum 4.5268988609313965
Total (block generation + training)time/epoch 5.776716768741608
Training time/epoch 1.504718542098999
Training time without block to device /epoch 0.9523234367370605
Training time without total dataloading part /epoch 0.154646635055542
load block tensor time/epoch 0.30239295959472656
block to device time/epoch 0.5523951053619385
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5774474
Number of first layer input nodes during this epoch:  2269448
Number of first layer output nodes during this epoch:  2127420
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 2.6222987174987793  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 2.6222987174987793  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 3.7735476016998293
pseudo mini batch 0 input nodes size: 2269684
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 0.8843927383422852  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 0.8843927383422852  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 1.7300958633422852  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 1.7315607070922852  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 1.5356011390686035  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 1.5356011390686035  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

first layer input nodes number: 2269684
first layer output nodes number: 2126894
edges number: 40421133
torch.Size([2269684, 100])
torch.Size([2126894, 256])
input nodes number: 2126894
output nodes number: 1377515
edges number: 39515884
torch.Size([2126894, 256])
torch.Size([1377515, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 12.113372802734375  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 12.147791385650635  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 2.622032642364502  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 2.622032642364502  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 2.622032642364502  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.30159807205200195 |0.5493664741516113 |0.13335371017456055 |0.00012969970703125 |0.0063588619232177734 |0.003377199172973633 |
----------------------------------------------------------pseudo_mini_loss sum 3.360546588897705
Total (block generation + training)time/epoch 5.674208641052246
Training time/epoch 1.5013959407806396
Training time without block to device /epoch 0.9520294666290283
Training time without total dataloading part /epoch 0.1432194709777832
load block tensor time/epoch 0.30159807205200195
block to device time/epoch 0.5493664741516113
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5774093
Number of first layer input nodes during this epoch:  2269684
Number of first layer output nodes during this epoch:  2126894
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 2.6220321655273438  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 2.6220321655273438  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 3.7765783866246543
pseudo mini batch 0 input nodes size: 2269194
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 1.7300009727478027  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 1.7314658164978027  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 0.8842978477478027  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 1.5354008674621582  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 1.5354008674621582  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

first layer input nodes number: 2269194
first layer output nodes number: 2127254
edges number: 40430813
torch.Size([2269194, 100])
torch.Size([2127254, 256])
input nodes number: 2127254
output nodes number: 1377539
edges number: 39528062
torch.Size([2127254, 256])
torch.Size([1377539, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 12.113832473754883  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6092529296875 GB
    Memory Allocated: 12.148251056671143  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 2.6223554611206055  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 2.6223554611206055  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 2.6223554611206055  GigaBytes
Max Memory Allocated: 14.584485530853271  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.30397891998291016 |0.5656044483184814 |0.13321328163146973 |0.00012755393981933594 |0.2512993812561035 |0.0034296512603759766 |
----------------------------------------------------------pseudo_mini_loss sum 2.227400064468384
Total (block generation + training)time/epoch 5.620146036148071
Training time/epoch 1.557939052581787
Training time without block to device /epoch 0.9923346042633057
Training time without total dataloading part /epoch 0.38806986808776855
load block tensor time/epoch 0.30397891998291016
block to device time/epoch 0.5656044483184814
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5773987
Number of first layer input nodes during this epoch:  2269194
Number of first layer output nodes during this epoch:  2127254
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
