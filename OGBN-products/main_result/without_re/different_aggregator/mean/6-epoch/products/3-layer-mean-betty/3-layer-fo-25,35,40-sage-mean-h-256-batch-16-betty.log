main start at this time 1657001405.894179
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.33069467544555664
global_2_local spend time (sec) 0.5140695571899414
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0827641487121582
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1181132, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.12116360664367676
auxiliary_graph
Graph(num_nodes=1377703, num_edges=101856625,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6017441749572754
remove nodes length  1181132

auxiliary_graph.remove_nodes spent  5.769873142242432
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101856625,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.277672529220581

the counter of shared neighbor distribution
Counter({1.0: 76591578, 2.0: 14049546, 3.0: 5010892, 4.0: 2311722, 5.0: 1250786, 6.0: 739600, 7.0: 472478, 8.0: 320570, 9.0: 222488, 10.0: 161872, 11.0: 120832, 12.0: 90056, 13.0: 69248, 14.0: 53652, 15.0: 42676, 16.0: 31336, 17.0: 22028, 18.0: 19462, 19.0: 13316, 20.0: 10776, 21.0: 7196, 22.0: 5792, 23.0: 4758, 24.0: 3924, 25.0: 3444, 33.0: 2970, 28.0: 2904, 26.0: 2622, 30.0: 2388, 27.0: 2258, 32.0: 2096, 31.0: 2082, 39.0: 2070, 35.0: 1734, 29.0: 1726, 37.0: 1702, 36.0: 1500, 34.0: 1446, 38.0: 1436, 40.0: 1092})
101660054
Convert a graph into a bidirected graph: 6.901 seconds
Metis partitioning: 26.300 seconds
Split the graph: 2.778 seconds
Construct subgraphs: 0.608 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  36.64858603477478
12620
12618
12490
12654
12622
12397
11957
11927
11944
12534
12027
12233
11927
12600
11936
12085
total k batches seeds list generation spend  65.79755926132202
after graph partition
graph partition algorithm spend time 66.68615317344666
12620
12618
12490
12654
12622
12397
11957
11927
11944
12534
12027
12233
11927
12600
11936
12085
partition_len_list
[142381, 127141, 111415, 97206, 121387, 148809, 129529, 111275, 133120, 112352, 124831, 134900, 142860, 145533, 144340, 160066]
REG selection method  spend 67.47310781478882
time for parepare:  0.2814185619354248
local_output_nid generation:  0.0037910938262939453
local_in_edges_tensor generation:  0.016531944274902344
mini_batch_src_global generation:  0.03487443923950195
r_  generation:  0.1566009521484375
local_output_nid generation:  0.004527091979980469
local_in_edges_tensor generation:  0.009617328643798828
mini_batch_src_global generation:  0.028679609298706055
r_  generation:  0.16315054893493652
local_output_nid generation:  0.007138967514038086
local_in_edges_tensor generation:  0.019540071487426758
mini_batch_src_global generation:  0.01746344566345215
r_  generation:  0.1552596092224121
local_output_nid generation:  0.004548072814941406
local_in_edges_tensor generation:  0.005761623382568359
mini_batch_src_global generation:  0.018265485763549805
r_  generation:  0.1539926528930664
local_output_nid generation:  0.004485607147216797
local_in_edges_tensor generation:  0.006287097930908203
mini_batch_src_global generation:  0.019190311431884766
r_  generation:  0.16636013984680176
local_output_nid generation:  0.004461526870727539
local_in_edges_tensor generation:  0.008254766464233398
mini_batch_src_global generation:  0.01998114585876465
r_  generation:  0.17316603660583496
local_output_nid generation:  0.004380226135253906
local_in_edges_tensor generation:  0.005377769470214844
mini_batch_src_global generation:  0.019768476486206055
r_  generation:  0.16526055335998535
local_output_nid generation:  0.004374027252197266
local_in_edges_tensor generation:  0.005305051803588867
mini_batch_src_global generation:  0.019392013549804688
r_  generation:  0.16384172439575195
local_output_nid generation:  0.004311561584472656
local_in_edges_tensor generation:  0.005155086517333984
mini_batch_src_global generation:  0.02142810821533203
r_  generation:  0.17012310028076172
local_output_nid generation:  0.004462480545043945
local_in_edges_tensor generation:  0.006625175476074219
mini_batch_src_global generation:  0.020017623901367188
r_  generation:  0.16274046897888184
local_output_nid generation:  0.004383563995361328
local_in_edges_tensor generation:  0.0050487518310546875
mini_batch_src_global generation:  0.0186769962310791
r_  generation:  0.14957785606384277
local_output_nid generation:  0.0043985843658447266
local_in_edges_tensor generation:  0.005174160003662109
mini_batch_src_global generation:  0.019533395767211914
r_  generation:  0.16278648376464844
local_output_nid generation:  0.004313945770263672
local_in_edges_tensor generation:  0.009638786315917969
mini_batch_src_global generation:  0.021289825439453125
r_  generation:  0.18436384201049805
local_output_nid generation:  0.004487752914428711
local_in_edges_tensor generation:  0.007071018218994141
mini_batch_src_global generation:  0.023850440979003906
r_  generation:  0.18843913078308105
local_output_nid generation:  0.00433039665222168
local_in_edges_tensor generation:  0.0052869319915771484
mini_batch_src_global generation:  0.020969867706298828
r_  generation:  0.17981982231140137
local_output_nid generation:  0.0043752193450927734
local_in_edges_tensor generation:  0.005444526672363281
mini_batch_src_global generation:  0.022313356399536133
r_  generation:  0.1891465187072754
----------------------check_connections_block total spend ----------------------------- 4.124984502792358
generate_one_block  1.821685552597046
generate_one_block  0.2289433479309082
generate_one_block  0.20990872383117676
generate_one_block  0.21928167343139648
generate_one_block  0.2189171314239502
generate_one_block  0.22163844108581543
generate_one_block  0.21258163452148438
generate_one_block  0.2023298740386963
generate_one_block  0.2238624095916748
generate_one_block  0.22421908378601074
generate_one_block  0.22353672981262207
generate_one_block  0.25115013122558594
generate_one_block  0.25502586364746094
generate_one_block  0.2837948799133301
generate_one_block  0.25432467460632324
generate_one_block  0.24930524826049805
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.274674654006958
gen group dst list time:  0.05877089500427246
time for parepare:  0.460996150970459
local_output_nid generation:  0.03591465950012207
local_in_edges_tensor generation:  0.26444149017333984
mini_batch_src_global generation:  0.16210579872131348
r_  generation:  1.5491201877593994
local_output_nid generation:  0.059125661849975586
local_in_edges_tensor generation:  0.11305427551269531
mini_batch_src_global generation:  0.16492438316345215
r_  generation:  1.4332239627838135
local_output_nid generation:  0.0343174934387207
local_in_edges_tensor generation:  0.0934441089630127
mini_batch_src_global generation:  0.13222861289978027
r_  generation:  1.1949398517608643
local_output_nid generation:  0.02816033363342285
local_in_edges_tensor generation:  0.054112911224365234
mini_batch_src_global generation:  0.11770272254943848
r_  generation:  0.9004783630371094
local_output_nid generation:  0.03657960891723633
local_in_edges_tensor generation:  0.06716632843017578
mini_batch_src_global generation:  0.12757110595703125
r_  generation:  1.264509677886963
local_output_nid generation:  0.044809818267822266
local_in_edges_tensor generation:  0.14855670928955078
mini_batch_src_global generation:  0.17290258407592773
r_  generation:  1.6524693965911865
local_output_nid generation:  0.0709834098815918
local_in_edges_tensor generation:  0.1659071445465088
mini_batch_src_global generation:  0.16274118423461914
r_  generation:  1.488478660583496
local_output_nid generation:  0.03469228744506836
local_in_edges_tensor generation:  0.11296987533569336
mini_batch_src_global generation:  0.1348733901977539
r_  generation:  1.1744575500488281
local_output_nid generation:  0.0386500358581543
local_in_edges_tensor generation:  0.10233473777770996
mini_batch_src_global generation:  0.19331884384155273
r_  generation:  1.5559308528900146
local_output_nid generation:  0.0314335823059082
local_in_edges_tensor generation:  0.11732053756713867
mini_batch_src_global generation:  0.13725948333740234
r_  generation:  1.1655914783477783
local_output_nid generation:  0.0705714225769043
local_in_edges_tensor generation:  0.14919543266296387
mini_batch_src_global generation:  0.1645059585571289
r_  generation:  1.5472443103790283
local_output_nid generation:  0.04369640350341797
local_in_edges_tensor generation:  0.11682772636413574
mini_batch_src_global generation:  0.17081379890441895
r_  generation:  1.5712053775787354
local_output_nid generation:  0.04307055473327637
local_in_edges_tensor generation:  0.11779356002807617
mini_batch_src_global generation:  0.20334315299987793
r_  generation:  1.731503963470459
local_output_nid generation:  0.04401135444641113
local_in_edges_tensor generation:  0.09315705299377441
mini_batch_src_global generation:  0.20723700523376465
r_  generation:  1.7634153366088867
local_output_nid generation:  0.04430389404296875
local_in_edges_tensor generation:  0.1228945255279541
mini_batch_src_global generation:  0.1988818645477295
r_  generation:  1.7261121273040771
local_output_nid generation:  0.0503849983215332
local_in_edges_tensor generation:  0.11910653114318848
mini_batch_src_global generation:  0.2230978012084961
r_  generation:  2.091343402862549
----------------------check_connections_block total spend ----------------------------- 34.134567975997925
generate_one_block  2.661062002182007
generate_one_block  2.0496020317077637
generate_one_block  1.5361034870147705
generate_one_block  1.1699919700622559
generate_one_block  1.4930171966552734
generate_one_block  2.0891995429992676
generate_one_block  1.915163278579712
generate_one_block  1.443509817123413
generate_one_block  2.0079405307769775
generate_one_block  1.4462177753448486
generate_one_block  1.8739080429077148
generate_one_block  2.024806261062622
generate_one_block  2.2267303466796875
generate_one_block  2.33060622215271
generate_one_block  2.269683361053467
generate_one_block  2.6231815814971924
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2607181072235107
gen group dst list time:  0.30128979682922363
time for parepare:  0.45213961601257324
local_output_nid generation:  0.1855478286743164
local_in_edges_tensor generation:  0.5644817352294922
mini_batch_src_global generation:  0.4611172676086426
r_  generation:  5.208173513412476
local_output_nid generation:  0.17902612686157227
local_in_edges_tensor generation:  0.3722879886627197
mini_batch_src_global generation:  0.4842205047607422
r_  generation:  4.538355827331543
local_output_nid generation:  0.17998957633972168
local_in_edges_tensor generation:  0.33200979232788086
mini_batch_src_global generation:  0.4108123779296875
r_  generation:  4.0759358406066895
local_output_nid generation:  0.10019397735595703
local_in_edges_tensor generation:  0.17824673652648926
mini_batch_src_global generation:  0.28847217559814453
r_  generation:  2.4989945888519287
local_output_nid generation:  0.1510462760925293
local_in_edges_tensor generation:  0.29187655448913574
mini_batch_src_global generation:  0.3407912254333496
r_  generation:  3.637723684310913
local_output_nid generation:  0.21445131301879883
local_in_edges_tensor generation:  0.4389336109161377
mini_batch_src_global generation:  0.5084242820739746
r_  generation:  5.5542213916778564
local_output_nid generation:  0.223130464553833
local_in_edges_tensor generation:  0.46489572525024414
mini_batch_src_global generation:  0.5817422866821289
r_  generation:  5.898844957351685
local_output_nid generation:  0.16478443145751953
local_in_edges_tensor generation:  0.3294494152069092
mini_batch_src_global generation:  0.46202778816223145
r_  generation:  4.121394872665405
local_output_nid generation:  0.21021127700805664
local_in_edges_tensor generation:  0.45854616165161133
mini_batch_src_global generation:  0.5592880249023438
r_  generation:  6.149330139160156
local_output_nid generation:  0.16191673278808594
local_in_edges_tensor generation:  0.3382759094238281
mini_batch_src_global generation:  0.48935508728027344
r_  generation:  4.339871406555176
local_output_nid generation:  0.2515695095062256
local_in_edges_tensor generation:  0.5466289520263672
mini_batch_src_global generation:  0.6413748264312744
r_  generation:  6.835679054260254
local_output_nid generation:  0.2280864715576172
local_in_edges_tensor generation:  0.4927358627319336
mini_batch_src_global generation:  0.6523375511169434
r_  generation:  6.536507606506348
local_output_nid generation:  0.21110010147094727
local_in_edges_tensor generation:  1.0778937339782715
mini_batch_src_global generation:  0.5994207859039307
r_  generation:  6.004128932952881
local_output_nid generation:  0.22311925888061523
local_in_edges_tensor generation:  0.5024573802947998
mini_batch_src_global generation:  0.6513655185699463
r_  generation:  6.641062498092651
local_output_nid generation:  0.20418047904968262
local_in_edges_tensor generation:  0.4627225399017334
mini_batch_src_global generation:  0.6161806583404541
r_  generation:  6.02674412727356
local_output_nid generation:  0.24454545974731445
local_in_edges_tensor generation:  0.5498430728912354
mini_batch_src_global generation:  0.688234806060791
r_  generation:  6.965157747268677
----------------------check_connections_block total spend ----------------------------- 119.95342516899109
generate_one_block  7.557657957077026
generate_one_block  6.071063756942749
generate_one_block  5.431639909744263
generate_one_block  3.25356125831604
generate_one_block  4.699528694152832
generate_one_block  6.990568399429321
generate_one_block  7.408449172973633
generate_one_block  5.231429576873779
generate_one_block  7.488217830657959
generate_one_block  5.484068393707275
generate_one_block  8.871165752410889
generate_one_block  8.014296054840088
generate_one_block  7.184497594833374
generate_one_block  8.052516222000122
generate_one_block  7.230035305023193
generate_one_block  8.513320684432983
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  158.21297764778137
block generation total time  143.9432454109192
average batch blocks generation time:  2.9988176127274833
block dataloader generation time/epoch 382.6933808326721
pseudo mini batch 0 input nodes size: 1474968
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.5502371788024902  GigaBytes
Max Memory Allocated: 0.5502371788024902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.5503315925598145  GigaBytes
Max Memory Allocated: 0.5503315925598145  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.5503315925598145  GigaBytes
Max Memory Allocated: 0.5503315925598145  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.6868710517883301  GigaBytes
Max Memory Allocated: 0.6868710517883301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.6868710517883301  GigaBytes
Max Memory Allocated: 0.6868710517883301  GigaBytes

first layer input nodes number: 1474968
first layer output nodes number: 573657
edges number: 13048989
torch.Size([1474968, 100])
torch.Size([573657, 256])
input nodes number: 573657
output nodes number: 142381
edges number: 4612989
torch.Size([573657, 256])
torch.Size([142381, 256])
torch.Size([12620, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7264404296875 GB
    Memory Allocated: 2.750448703765869  GigaBytes
Max Memory Allocated: 2.865462303161621  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7264404296875 GB
    Memory Allocated: 2.752659320831299  GigaBytes
Max Memory Allocated: 2.865462303161621  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6463623046875 GB
    Memory Allocated: 0.8908934593200684  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

pseudo mini batch 1 input nodes size: 1386286
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6463623046875 GB
    Memory Allocated: 0.5538063049316406  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6463623046875 GB
    Memory Allocated: 0.5538063049316406  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6463623046875 GB
    Memory Allocated: 1.0702381134033203  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6463623046875 GB
    Memory Allocated: 1.0703325271606445  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6463623046875 GB
    Memory Allocated: 0.5207695960998535  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6463623046875 GB
    Memory Allocated: 0.6396565437316895  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6463623046875 GB
    Memory Allocated: 0.6396565437316895  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

first layer input nodes number: 1386286
first layer output nodes number: 501681
edges number: 11238079
torch.Size([1386286, 100])
torch.Size([501681, 256])
input nodes number: 501681
output nodes number: 127141
edges number: 3996506
torch.Size([501681, 256])
torch.Size([127141, 256])
torch.Size([12618, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 2.450326919555664  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 2.4528708457946777  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.8144536018371582  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

pseudo mini batch 2 input nodes size: 1328241
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.5202741622924805  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.5202741622924805  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 1.015082836151123  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 1.0151762962341309  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.49865007400512695  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.6024422645568848  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.6024422645568848  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

first layer input nodes number: 1328241
first layer output nodes number: 478158
edges number: 10079169
torch.Size([1328241, 100])
torch.Size([478158, 256])
input nodes number: 478158
output nodes number: 111415
edges number: 3272014
torch.Size([478158, 256])
torch.Size([111415, 256])
torch.Size([12490, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 2.290489673614502  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 2.2926998138427734  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.7574334144592285  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

pseudo mini batch 3 input nodes size: 950287
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.4986276626586914  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.4986276626586914  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.8526372909545898  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.8527317047119141  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.35782957077026367  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.4268374443054199  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.4268374443054199  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

first layer input nodes number: 950287
first layer output nodes number: 302999
edges number: 6093222
torch.Size([950287, 100])
torch.Size([302999, 256])
input nodes number: 302999
output nodes number: 97206
edges number: 2706747
torch.Size([302999, 256])
torch.Size([97206, 256])
torch.Size([12654, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 1.5900301933288574  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 1.5927681922912598  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.5372519493103027  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

pseudo mini batch 4 input nodes size: 1201674
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.35785818099975586  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.35785818099975586  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.8055167198181152  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.8056111335754395  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.4515070915222168  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.543057918548584  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.543057918548584  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

first layer input nodes number: 1201674
first layer output nodes number: 439379
edges number: 8557237
torch.Size([1201674, 100])
torch.Size([439379, 256])
input nodes number: 439379
output nodes number: 121387
edges number: 3260079
torch.Size([439379, 256])
torch.Size([121387, 256])
torch.Size([12622, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 2.1516189575195312  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 2.154672145843506  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.685394287109375  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

pseudo mini batch 5 input nodes size: 1543130
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.4518857002258301  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6483154296875 GB
    Memory Allocated: 0.4518857002258301  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2244873046875 GB
    Memory Allocated: 1.0267467498779297  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2244873046875 GB
    Memory Allocated: 1.026839256286621  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2244873046875 GB
    Memory Allocated: 0.5790863037109375  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2244873046875 GB
    Memory Allocated: 0.7089691162109375  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2244873046875 GB
    Memory Allocated: 0.7089691162109375  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

first layer input nodes number: 1543130
first layer output nodes number: 636390
edges number: 12713891
torch.Size([1543130, 100])
torch.Size([636390, 256])
input nodes number: 636390
output nodes number: 148809
edges number: 4204064
torch.Size([636390, 256])
torch.Size([148809, 256])
torch.Size([12397, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0701904296875 GB
    Memory Allocated: 2.944178581237793  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0701904296875 GB
    Memory Allocated: 2.94635009765625  GigaBytes
Max Memory Allocated: 3.4295053482055664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.7362060546875 GB
    Memory Allocated: 0.9024267196655273  GigaBytes
Max Memory Allocated: 3.7209157943725586  GigaBytes

pseudo mini batch 6 input nodes size: 1556306
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.7362060546875 GB
    Memory Allocated: 0.5786628723144531  GigaBytes
Max Memory Allocated: 3.7209157943725586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.7362060546875 GB
    Memory Allocated: 0.5786628723144531  GigaBytes
Max Memory Allocated: 3.7209157943725586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.7362060546875 GB
    Memory Allocated: 1.1584324836730957  GigaBytes
Max Memory Allocated: 3.7209157943725586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.7362060546875 GB
    Memory Allocated: 1.1585216522216797  GigaBytes
Max Memory Allocated: 3.7209157943725586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.7362060546875 GB
    Memory Allocated: 0.5835680961608887  GigaBytes
Max Memory Allocated: 3.7209157943725586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.7362060546875 GB
    Memory Allocated: 0.7184252738952637  GigaBytes
Max Memory Allocated: 3.7209157943725586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.7362060546875 GB
    Memory Allocated: 0.7184252738952637  GigaBytes
Max Memory Allocated: 3.7209157943725586  GigaBytes

first layer input nodes number: 1556306
first layer output nodes number: 637374
edges number: 13763483
torch.Size([1556306, 100])
torch.Size([637374, 256])
input nodes number: 637374
output nodes number: 129529
edges number: 3882435
torch.Size([637374, 256])
torch.Size([129529, 256])
torch.Size([11957, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.5643310546875 GB
    Memory Allocated: 2.9009594917297363  GigaBytes
Max Memory Allocated: 3.7209157943725586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.5643310546875 GB
    Memory Allocated: 2.9030537605285645  GigaBytes
Max Memory Allocated: 3.7209157943725586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.9148797988891602  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

pseudo mini batch 7 input nodes size: 1292389
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.5834908485412598  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.5834908485412598  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 1.0649433135986328  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 1.0650324821472168  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.48517370223999023  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.5833535194396973  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.5833535194396973  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

first layer input nodes number: 1292389
first layer output nodes number: 466527
edges number: 9619765
torch.Size([1292389, 100])
torch.Size([466527, 256])
input nodes number: 466527
output nodes number: 111275
edges number: 3111349
torch.Size([466527, 256])
torch.Size([111275, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 2.234877109527588  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 2.236966133117676  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.7303676605224609  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

pseudo mini batch 8 input nodes size: 1523882
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.48516845703125  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.48516845703125  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 1.052858829498291  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 1.052947998046875  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.571406364440918  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.7090415954589844  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.7090415954589844  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

first layer input nodes number: 1523882
first layer output nodes number: 620378
edges number: 13848270
torch.Size([1523882, 100])
torch.Size([620378, 256])
input nodes number: 620378
output nodes number: 133120
edges number: 4069447
torch.Size([620378, 256])
torch.Size([133120, 256])
torch.Size([11944, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 2.8629469871520996  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 2.8650388717651367  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.9107561111450195  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

pseudo mini batch 9 input nodes size: 1328888
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.5714092254638672  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.5714092254638672  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 1.0664587020874023  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 1.0665521621704102  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.49877262115478516  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.6014103889465332  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.6014103889465332  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

first layer input nodes number: 1328888
first layer output nodes number: 487068
edges number: 10236655
torch.Size([1328888, 100])
torch.Size([487068, 256])
input nodes number: 487068
output nodes number: 112352
edges number: 3006389
torch.Size([487068, 256])
torch.Size([112352, 256])
torch.Size([12534, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 2.316213607788086  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 2.318408966064453  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.7541837692260742  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

pseudo mini batch 10 input nodes size: 1611681
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.49887609481811523  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.49887609481811523  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 1.0992741584777832  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 1.0993638038635254  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.6042208671569824  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.7570271492004395  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.1756591796875 GB
    Memory Allocated: 0.7570271492004395  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

first layer input nodes number: 1611681
first layer output nodes number: 715229
edges number: 16210947
torch.Size([1611681, 100])
torch.Size([715229, 256])
input nodes number: 715229
output nodes number: 124831
edges number: 3877868
torch.Size([715229, 256])
torch.Size([124831, 256])
torch.Size([12027, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2557373046875 GB
    Memory Allocated: 3.139892101287842  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2557373046875 GB
    Memory Allocated: 3.1422014236450195  GigaBytes
Max Memory Allocated: 3.7356715202331543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.9736132621765137  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 11 input nodes size: 1571507
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.6041321754455566  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.6041321754455566  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.1895642280578613  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.1896557807922363  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5891680717468262  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.7351469993591309  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.7351469993591309  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1571507
first layer output nodes number: 665472
edges number: 14874264
torch.Size([1571507, 100])
torch.Size([665472, 256])
input nodes number: 665472
output nodes number: 134900
edges number: 4154565
torch.Size([665472, 256])
torch.Size([134900, 256])
torch.Size([12233, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 3.015359878540039  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 3.0179238319396973  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.9451665878295898  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 12 input nodes size: 1441378
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5892038345336914  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5892038345336914  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.1261591911315918  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.1262483596801758  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5407247543334961  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.6807861328125  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.6807861328125  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1441378
first layer output nodes number: 601643
edges number: 13609742
torch.Size([1441378, 100])
torch.Size([601643, 256])
input nodes number: 601643
output nodes number: 142860
edges number: 4543792
torch.Size([601643, 256])
torch.Size([142860, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 2.816950798034668  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 2.8190932273864746  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.8851709365844727  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 13 input nodes size: 1561750
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5409407615661621  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5409407615661621  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.1227383613586426  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.1228322982788086  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5857877731323242  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.7362852096557617  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.7362852096557617  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1561750
first layer output nodes number: 659781
edges number: 14988124
torch.Size([1561750, 100])
torch.Size([659781, 256])
input nodes number: 659781
output nodes number: 145533
edges number: 4635424
torch.Size([659781, 256])
torch.Size([145533, 256])
torch.Size([12600, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 3.0399036407470703  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 3.0421104431152344  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.953364372253418  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 14 input nodes size: 1428210
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5856361389160156  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5856361389160156  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.1176862716674805  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.1177754402160645  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.535883903503418  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.6774759292602539  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.6774759292602539  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1428210
first layer output nodes number: 605692
edges number: 13817687
torch.Size([1428210, 100])
torch.Size([605692, 256])
input nodes number: 605692
output nodes number: 144340
edges number: 4585952
torch.Size([605692, 256])
torch.Size([144340, 256])
torch.Size([11936, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 2.830683708190918  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 2.8327741622924805  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.8835086822509766  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 15 input nodes size: 1479664
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5357675552368164  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5357675552368164  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.0869855880737305  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.0870757102966309  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.554936408996582  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.7177839279174805  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.7177839279174805  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1479664
first layer output nodes number: 713237
edges number: 16203950
torch.Size([1479664, 100])
torch.Size([713237, 256])
input nodes number: 713237
output nodes number: 160066
edges number: 5108358
torch.Size([713237, 256])
torch.Size([160066, 256])
torch.Size([12085, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 3.2137012481689453  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 3.215817928314209  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.9536490440368652  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.9551863670349121  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.9551863670349121  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2041540890932083 |0.1607525497674942 |0.08516044914722443 |0.00014366209506988525 |0.011532023549079895 |0.00420069694519043 |
----------------------------------------------------------pseudo_mini_loss sum 7.150781631469727
Total (block generation + training)time/epoch 390.1975448131561
Training time/epoch 7.503781318664551
Training time without block to device /epoch 4.9317405223846436
Training time without total dataloading part /epoch 1.5535788536071777
load block tensor time/epoch 3.266465425491333
block to device time/epoch 2.5720407962799072
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  33872051
Number of first layer input nodes during this epoch:  22680241
Number of first layer output nodes during this epoch:  9104665
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.9551858901977539  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.42735815048217773
global_2_local spend time (sec) 0.5353589057922363
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.036646366119384766
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1181573, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.11827373504638672
auxiliary_graph
Graph(num_nodes=1378144, num_edges=101440449,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6444277763366699
remove nodes length  1181573

auxiliary_graph.remove_nodes spent  5.280625581741333
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101440449,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.208742618560791

the counter of shared neighbor distribution
Counter({1.0: 76262470, 2.0: 13999502, 3.0: 4993082, 4.0: 2303996, 5.0: 1242502, 6.0: 739396, 7.0: 471654, 8.0: 318818, 9.0: 223652, 10.0: 162218, 11.0: 119508, 12.0: 90236, 13.0: 68272, 14.0: 52940, 15.0: 42884, 16.0: 30994, 17.0: 22020, 18.0: 20014, 19.0: 13430, 20.0: 10922, 21.0: 7462, 22.0: 5748, 23.0: 4694, 24.0: 3946, 25.0: 3448, 33.0: 2964, 28.0: 2830, 26.0: 2556, 30.0: 2394, 27.0: 2196, 32.0: 2176, 31.0: 2104, 39.0: 2086, 29.0: 1842, 35.0: 1724, 37.0: 1628, 36.0: 1536, 38.0: 1480, 34.0: 1476, 40.0: 1078})
101243878
Convert a graph into a bidirected graph: 6.676 seconds
Metis partitioning: 27.827 seconds
Split the graph: 2.702 seconds
Construct subgraphs: 0.637 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  37.8810977935791
11930
12326
11986
12607
12631
12545
12433
11927
12652
12511
12033
12490
12576
12070
11927
11927
total k batches seeds list generation spend  66.10434532165527
after graph partition
graph partition algorithm spend time 66.94580602645874
11930
12326
11986
12607
12631
12545
12433
11927
12652
12511
12033
12490
12576
12070
11927
11927
partition_len_list
[137025, 146273, 113794, 115315, 127378, 143682, 94676, 110237, 114005, 154763, 119083, 140698, 139420, 158839, 137997, 147083]
REG selection method  spend 67.75886273384094
time for parepare:  0.27103519439697266
local_output_nid generation:  0.0037004947662353516
local_in_edges_tensor generation:  0.0068018436431884766
mini_batch_src_global generation:  0.018121957778930664
r_  generation:  0.14187955856323242
local_output_nid generation:  0.004441499710083008
local_in_edges_tensor generation:  0.005760908126831055
mini_batch_src_global generation:  0.022261857986450195
r_  generation:  0.15619707107543945
local_output_nid generation:  0.0043487548828125
local_in_edges_tensor generation:  0.005469799041748047
mini_batch_src_global generation:  0.021438121795654297
r_  generation:  0.15180635452270508
local_output_nid generation:  0.004490375518798828
local_in_edges_tensor generation:  0.0075342655181884766
mini_batch_src_global generation:  0.025899410247802734
r_  generation:  0.1654644012451172
local_output_nid generation:  0.004557371139526367
local_in_edges_tensor generation:  0.0077288150787353516
mini_batch_src_global generation:  0.022799015045166016
r_  generation:  0.1796121597290039
local_output_nid generation:  0.0045740604400634766
local_in_edges_tensor generation:  0.0088958740234375
mini_batch_src_global generation:  0.02328801155090332
r_  generation:  0.18566465377807617
local_output_nid generation:  0.00447535514831543
local_in_edges_tensor generation:  0.005639553070068359
mini_batch_src_global generation:  0.022400617599487305
r_  generation:  0.1603102684020996
local_output_nid generation:  0.004512310028076172
local_in_edges_tensor generation:  0.005370616912841797
mini_batch_src_global generation:  0.02242445945739746
r_  generation:  0.16245222091674805
local_output_nid generation:  0.00463557243347168
local_in_edges_tensor generation:  0.006745100021362305
mini_batch_src_global generation:  0.02336907386779785
r_  generation:  0.16185259819030762
local_output_nid generation:  0.004631757736206055
local_in_edges_tensor generation:  0.009250164031982422
mini_batch_src_global generation:  0.026312828063964844
r_  generation:  0.187835693359375
local_output_nid generation:  0.0045282840728759766
local_in_edges_tensor generation:  0.005200624465942383
mini_batch_src_global generation:  0.022054195404052734
r_  generation:  0.1526792049407959
local_output_nid generation:  0.0045697689056396484
local_in_edges_tensor generation:  0.005457401275634766
mini_batch_src_global generation:  0.021837949752807617
r_  generation:  0.17023706436157227
local_output_nid generation:  0.00453495979309082
local_in_edges_tensor generation:  0.006998777389526367
mini_batch_src_global generation:  0.025429487228393555
r_  generation:  0.1900796890258789
local_output_nid generation:  0.004431486129760742
local_in_edges_tensor generation:  0.0054874420166015625
mini_batch_src_global generation:  0.025252819061279297
r_  generation:  0.19188857078552246
local_output_nid generation:  0.004403829574584961
local_in_edges_tensor generation:  0.005491495132446289
mini_batch_src_global generation:  0.024793624877929688
r_  generation:  0.18495845794677734
local_output_nid generation:  0.004366874694824219
local_in_edges_tensor generation:  0.005548000335693359
mini_batch_src_global generation:  0.02353668212890625
r_  generation:  0.19044089317321777
----------------------check_connections_block total spend ----------------------------- 4.136427164077759
generate_one_block  0.4330456256866455
generate_one_block  0.3216433525085449
generate_one_block  0.24830102920532227
generate_one_block  0.23906230926513672
generate_one_block  0.2630012035369873
generate_one_block  0.26154327392578125
generate_one_block  0.2316896915435791
generate_one_block  0.22295522689819336
generate_one_block  0.2512552738189697
generate_one_block  0.29939866065979004
generate_one_block  0.22513556480407715
generate_one_block  0.24364376068115234
generate_one_block  0.28107523918151855
generate_one_block  0.2767214775085449
generate_one_block  0.2453749179840088
generate_one_block  0.2721076011657715
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.3298115730285645
gen group dst list time:  0.06317138671875
time for parepare:  0.5025432109832764
local_output_nid generation:  0.039307594299316406
local_in_edges_tensor generation:  0.17148327827453613
mini_batch_src_global generation:  0.13141250610351562
r_  generation:  1.4378421306610107
local_output_nid generation:  0.04392743110656738
local_in_edges_tensor generation:  0.10764789581298828
mini_batch_src_global generation:  0.16155600547790527
r_  generation:  1.5891287326812744
local_output_nid generation:  0.034140825271606445
local_in_edges_tensor generation:  0.04729795455932617
mini_batch_src_global generation:  0.13612699508666992
r_  generation:  1.2161750793457031
local_output_nid generation:  0.03420114517211914
local_in_edges_tensor generation:  0.07748794555664062
mini_batch_src_global generation:  0.14839887619018555
r_  generation:  1.1932477951049805
local_output_nid generation:  0.03770565986633301
local_in_edges_tensor generation:  0.09264135360717773
mini_batch_src_global generation:  0.15020966529846191
r_  generation:  1.4246628284454346
local_output_nid generation:  0.04168081283569336
local_in_edges_tensor generation:  0.11646032333374023
mini_batch_src_global generation:  0.19904685020446777
r_  generation:  1.718860149383545
local_output_nid generation:  0.026734590530395508
local_in_edges_tensor generation:  0.04499554634094238
mini_batch_src_global generation:  0.13202714920043945
r_  generation:  0.9048001766204834
local_output_nid generation:  0.03297567367553711
local_in_edges_tensor generation:  0.15805912017822266
mini_batch_src_global generation:  0.13106417655944824
r_  generation:  1.2147090435028076
local_output_nid generation:  0.06140923500061035
local_in_edges_tensor generation:  0.11157560348510742
mini_batch_src_global generation:  0.12778496742248535
r_  generation:  1.0911335945129395
local_output_nid generation:  0.048475027084350586
local_in_edges_tensor generation:  0.16152620315551758
mini_batch_src_global generation:  0.19190645217895508
r_  generation:  1.8488349914550781
local_output_nid generation:  0.038141489028930664
local_in_edges_tensor generation:  0.10630059242248535
mini_batch_src_global generation:  0.1618788242340088
r_  generation:  1.3944900035858154
local_output_nid generation:  0.04197120666503906
local_in_edges_tensor generation:  0.1243751049041748
mini_batch_src_global generation:  0.18575119972229004
r_  generation:  1.654836654663086
local_output_nid generation:  0.041739463806152344
local_in_edges_tensor generation:  0.1203758716583252
mini_batch_src_global generation:  0.19768595695495605
r_  generation:  1.666543960571289
local_output_nid generation:  0.0497279167175293
local_in_edges_tensor generation:  0.145782470703125
mini_batch_src_global generation:  0.2208728790283203
r_  generation:  1.9491515159606934
local_output_nid generation:  0.0417943000793457
local_in_edges_tensor generation:  0.10980677604675293
mini_batch_src_global generation:  0.22067570686340332
r_  generation:  1.6274652481079102
local_output_nid generation:  0.0450284481048584
local_in_edges_tensor generation:  0.19513177871704102
mini_batch_src_global generation:  0.23192620277404785
r_  generation:  1.8572242259979248
----------------------check_connections_block total spend ----------------------------- 34.18612504005432
generate_one_block  2.440507411956787
generate_one_block  2.048124074935913
generate_one_block  1.5114269256591797
generate_one_block  1.4474334716796875
generate_one_block  1.8909904956817627
generate_one_block  2.221087694168091
generate_one_block  1.129791498184204
generate_one_block  1.5165748596191406
generate_one_block  1.5546770095825195
generate_one_block  2.3532726764678955
generate_one_block  1.8253350257873535
generate_one_block  2.169771909713745
generate_one_block  2.1692912578582764
generate_one_block  2.6313745975494385
generate_one_block  2.1990604400634766
generate_one_block  2.4753806591033936
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.341487407684326
gen group dst list time:  0.30521321296691895
time for parepare:  0.49384284019470215
local_output_nid generation:  0.21771645545959473
local_in_edges_tensor generation:  0.5866971015930176
mini_batch_src_global generation:  0.46039628982543945
r_  generation:  5.323944091796875
local_output_nid generation:  0.2252211570739746
local_in_edges_tensor generation:  0.42182135581970215
mini_batch_src_global generation:  0.5272550582885742
r_  generation:  5.34037446975708
local_output_nid generation:  0.17441058158874512
local_in_edges_tensor generation:  0.3441295623779297
mini_batch_src_global generation:  0.4350111484527588
r_  generation:  4.239346265792847
local_output_nid generation:  0.15182089805603027
local_in_edges_tensor generation:  0.3747222423553467
mini_batch_src_global generation:  0.3981931209564209
r_  generation:  3.867110252380371
local_output_nid generation:  0.17518258094787598
local_in_edges_tensor generation:  0.38321661949157715
mini_batch_src_global generation:  0.4664497375488281
r_  generation:  4.840977430343628
local_output_nid generation:  0.19658327102661133
local_in_edges_tensor generation:  0.43643879890441895
mini_batch_src_global generation:  0.5883083343505859
r_  generation:  5.642858028411865
local_output_nid generation:  0.14633560180664062
local_in_edges_tensor generation:  0.25626611709594727
mini_batch_src_global generation:  0.33784985542297363
r_  generation:  2.5507590770721436
local_output_nid generation:  0.16133427619934082
local_in_edges_tensor generation:  0.34198784828186035
mini_batch_src_global generation:  0.40230631828308105
r_  generation:  4.035681962966919
local_output_nid generation:  0.1559741497039795
local_in_edges_tensor generation:  0.3374752998352051
mini_batch_src_global generation:  0.4453318119049072
r_  generation:  4.218736410140991
local_output_nid generation:  0.23993492126464844
local_in_edges_tensor generation:  0.5361723899841309
mini_batch_src_global generation:  0.6451599597930908
r_  generation:  6.9192445278167725
local_output_nid generation:  0.2319493293762207
local_in_edges_tensor generation:  0.5179188251495361
mini_batch_src_global generation:  0.6930196285247803
r_  generation:  6.618976593017578
local_output_nid generation:  0.2338712215423584
local_in_edges_tensor generation:  0.6557483673095703
mini_batch_src_global generation:  0.6749529838562012
r_  generation:  6.854932069778442
local_output_nid generation:  0.20201444625854492
local_in_edges_tensor generation:  0.4384942054748535
mini_batch_src_global generation:  0.6177444458007812
r_  generation:  5.880850076675415
local_output_nid generation:  0.28704833984375
local_in_edges_tensor generation:  0.646442174911499
mini_batch_src_global generation:  0.6648457050323486
r_  generation:  6.806446313858032
local_output_nid generation:  0.20775771141052246
local_in_edges_tensor generation:  0.4468240737915039
mini_batch_src_global generation:  0.6229953765869141
r_  generation:  5.951159477233887
local_output_nid generation:  0.21462631225585938
local_in_edges_tensor generation:  0.4541306495666504
mini_batch_src_global generation:  0.6216256618499756
r_  generation:  6.218281269073486
----------------------check_connections_block total spend ----------------------------- 120.25975942611694
generate_one_block  7.680909872055054
generate_one_block  6.915282726287842
generate_one_block  5.532463788986206
generate_one_block  4.90022087097168
generate_one_block  6.588871479034424
generate_one_block  7.108128786087036
generate_one_block  3.5157487392425537
generate_one_block  5.34843373298645
generate_one_block  5.58479905128479
generate_one_block  9.00118637084961
generate_one_block  8.39762282371521
generate_one_block  8.442708730697632
generate_one_block  7.345247030258179
generate_one_block  8.49822211265564
generate_one_block  7.444851875305176
generate_one_block  7.723323106765747
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.9551858901977539  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

connection checking time:  158.58231163024902
block generation total time  145.92807531356812
average batch blocks generation time:  3.0401682356993356
block dataloader generation time/epoch 384.4198046922684
pseudo mini batch 0 input nodes size: 1511365
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5564990043640137  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5564990043640137  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.1195263862609863  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.1196155548095703  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5683073997497559  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.7028031349182129  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.7028031349182129  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1511365
first layer output nodes number: 637211
edges number: 13333094
torch.Size([1511365, 100])
torch.Size([637211, 256])
input nodes number: 637211
output nodes number: 137025
edges number: 4019545
torch.Size([637211, 256])
torch.Size([137025, 256])
torch.Size([11930, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 2.904017448425293  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 2.9070825576782227  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.8964567184448242  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 1 input nodes size: 1504229
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5682811737060547  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5682811737060547  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.128650188446045  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 1.1287422180175781  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.5656256675720215  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.6943187713623047  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0135498046875 GB
    Memory Allocated: 0.6943187713623047  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1504229
first layer output nodes number: 627441
edges number: 12632906
torch.Size([1504229, 100])
torch.Size([627441, 256])
input nodes number: 627441
output nodes number: 146273
edges number: 4089330
torch.Size([627441, 256])
torch.Size([146273, 256])
torch.Size([12326, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.8956527709960938  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.8978114128112793  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.8848052024841309  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 2 input nodes size: 1338380
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5656948089599609  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5656948089599609  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 1.0642805099487305  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 1.0643701553344727  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5039091110229492  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.606287956237793  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.606287956237793  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1338380
first layer output nodes number: 488781
edges number: 10089101
torch.Size([1338380, 100])
torch.Size([488781, 256])
input nodes number: 488781
output nodes number: 113794
edges number: 3186311
torch.Size([488781, 256])
torch.Size([113794, 256])
torch.Size([11986, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.32711124420166  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.3292107582092285  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.758885383605957  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 3 input nodes size: 1246106
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.503849983215332  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.503849983215332  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.9680609703063965  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.9681549072265625  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.4694795608520508  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.563471794128418  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.563471794128418  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1246106
first layer output nodes number: 447914
edges number: 9001664
torch.Size([1246106, 100])
torch.Size([447914, 256])
input nodes number: 447914
output nodes number: 115315
edges number: 3140088
torch.Size([447914, 256])
torch.Size([115315, 256])
torch.Size([12607, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.1778693199157715  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.1810450553894043  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.7073984146118164  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 4 input nodes size: 1385854
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.47012901306152344  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.47012901306152344  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.9864001274108887  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.9864945411682129  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5221896171569824  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.640925407409668  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.640925407409668  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1385854
first layer output nodes number: 505863
edges number: 11336190
torch.Size([1385854, 100])
torch.Size([505863, 256])
input nodes number: 505863
output nodes number: 127378
edges number: 3986658
torch.Size([505863, 256])
torch.Size([127378, 256])
torch.Size([12631, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.46498441696167  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.467733383178711  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.8194694519042969  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 5 input nodes size: 1500974
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5216526985168457  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5216526985168457  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 1.0808091163635254  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 1.0809030532836914  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.564537525177002  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.7026457786560059  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.7026457786560059  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1500974
first layer output nodes number: 586208
edges number: 13278847
torch.Size([1500974, 100])
torch.Size([586208, 256])
input nodes number: 586208
output nodes number: 143682
edges number: 4666628
torch.Size([586208, 256])
torch.Size([143682, 256])
torch.Size([12545, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.802145481109619  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.8043575286865234  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.9072704315185547  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 6 input nodes size: 978773
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5645227432250977  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5645227432250977  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.9291443824768066  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.9292373657226562  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.36998701095581055  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.43845224380493164  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.43845224380493164  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 978773
first layer output nodes number: 302661
edges number: 6106649
torch.Size([978773, 100])
torch.Size([302661, 256])
input nodes number: 302661
output nodes number: 94676
edges number: 2630225
torch.Size([302661, 256])
torch.Size([94676, 256])
torch.Size([12433, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 1.5923233032226562  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 1.59450101852417  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5459604263305664  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 7 input nodes size: 1295852
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.3699674606323242  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.3699674606323242  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.8527102470397949  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.8527994155883789  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.4880847930908203  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5895605087280273  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5895605087280273  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1295852
first layer output nodes number: 472863
edges number: 9941555
torch.Size([1295852, 100])
torch.Size([472863, 256])
input nodes number: 472863
output nodes number: 110237
edges number: 3229518
torch.Size([472863, 256])
torch.Size([110237, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.258297920227051  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.2604360580444336  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.7423548698425293  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 8 input nodes size: 1327879
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.48799610137939453  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.48799610137939453  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.9826698303222656  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.9827642440795898  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.49993228912353516  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.6022787094116211  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.6022787094116211  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1327879
first layer output nodes number: 484095
edges number: 10148363
torch.Size([1327879, 100])
torch.Size([484095, 256])
input nodes number: 484095
output nodes number: 114005
edges number: 3040343
torch.Size([484095, 256])
torch.Size([114005, 256])
torch.Size([12652, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.3132376670837402  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 2.31545352935791  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.7552394866943359  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

pseudo mini batch 9 input nodes size: 1681464
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5000591278076172  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.5000591278076172  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 1.1264533996582031  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 1.126546859741211  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.6317787170410156  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.7920742034912109  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0155029296875 GB
    Memory Allocated: 0.7920742034912109  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

first layer input nodes number: 1681464
first layer output nodes number: 725935
edges number: 16236311
torch.Size([1681464, 100])
torch.Size([725935, 256])
input nodes number: 725935
output nodes number: 154763
edges number: 4790636
torch.Size([725935, 256])
torch.Size([154763, 256])
torch.Size([12511, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0994873046875 GB
    Memory Allocated: 3.3046860694885254  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0994873046875 GB
    Memory Allocated: 3.3069019317626953  GigaBytes
Max Memory Allocated: 4.13896369934082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.0253376960754395  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 10 input nodes size: 1591046
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6317539215087891  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6317539215087891  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.2244648933410645  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.2245550155639648  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5980672836303711  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7447109222412109  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7447109222412109  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1591046
first layer output nodes number: 688712
edges number: 15604793
torch.Size([1591046, 100])
torch.Size([688712, 256])
input nodes number: 688712
output nodes number: 119083
edges number: 3667658
torch.Size([688712, 256])
torch.Size([119083, 256])
torch.Size([12033, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 3.0363306999206543  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 3.038438320159912  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9522800445556641  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 11 input nodes size: 1562022
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5979838371276855  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5979838371276855  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.179882526397705  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.179975986480713  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5871748924255371  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7388415336608887  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7388415336608887  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1562022
first layer output nodes number: 690093
edges number: 15505222
torch.Size([1562022, 100])
torch.Size([690093, 256])
input nodes number: 690093
output nodes number: 140698
edges number: 4403203
torch.Size([690093, 256])
torch.Size([140698, 256])
torch.Size([12490, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 3.106076717376709  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 3.108893394470215  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9567337036132812  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 12 input nodes size: 1409243
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5872550010681152  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5872550010681152  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.1122393608093262  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.1123332977294922  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5303411483764648  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6712570190429688  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6712570190429688  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1409243
first layer output nodes number: 598613
edges number: 13697229
torch.Size([1409243, 100])
torch.Size([598613, 256])
input nodes number: 598613
output nodes number: 139420
edges number: 4475426
torch.Size([598613, 256])
torch.Size([139420, 256])
torch.Size([12576, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.7896227836608887  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.791825294494629  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.8754239082336426  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 13 input nodes size: 1463396
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5303559303283691  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5303559303283691  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.0755138397216797  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.07560396194458  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5505256652832031  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7111587524414062  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7111587524414062  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1463396
first layer output nodes number: 699707
edges number: 15910682
torch.Size([1463396, 100])
torch.Size([699707, 256])
input nodes number: 699707
output nodes number: 158839
edges number: 5069935
torch.Size([699707, 256])
torch.Size([158839, 256])
torch.Size([12070, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 3.167328357696533  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 3.170344352722168  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.943303108215332  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 14 input nodes size: 1461134
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5504369735717773  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5504369735717773  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.0947518348693848  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.0948410034179688  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5495929718017578  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6898174285888672  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6898174285888672  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1461134
first layer output nodes number: 611959
edges number: 13984313
torch.Size([1461134, 100])
torch.Size([611959, 256])
input nodes number: 611959
output nodes number: 137997
edges number: 4369636
torch.Size([611959, 256])
torch.Size([137997, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.8391947746276855  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.84130859375  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.8958706855773926  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 15 input nodes size: 1489430
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5495681762695312  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5495681762695312  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.1044244766235352  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.1045136451721191  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5601096153259277  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.705420970916748  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.705420970916748  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1489430
first layer output nodes number: 632246
edges number: 14314687
torch.Size([1489430, 100])
torch.Size([632246, 256])
input nodes number: 632246
output nodes number: 147083
edges number: 4700615
torch.Size([632246, 256])
torch.Size([147083, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.938640594482422  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.9410176277160645  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9184837341308594  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9184837341308594  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9184837341308594  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2105870246887207 |0.11494356393814087 |0.04084321856498718 |0.00013840198516845703 |0.006841793656349182 |0.002721548080444336 |
----------------------------------------------------------pseudo_mini_loss sum 12.436334609985352
Total (block generation + training)time/epoch 391.21500873565674
Training time/epoch 6.086010932922363
Training time without block to device /epoch 4.246913909912109
Training time without total dataloading part /epoch 0.7678961753845215
load block tensor time/epoch 3.3693923950195312
block to device time/epoch 1.839097023010254
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  34047717
Number of first layer input nodes during this epoch:  22747147
Number of first layer output nodes during this epoch:  9200302
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9184832572937012  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3694005012512207
global_2_local spend time (sec) 0.5749375820159912
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.03695487976074219
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1181078, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.08218502998352051
auxiliary_graph
Graph(num_nodes=1377649, num_edges=101592085,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6410770416259766
remove nodes length  1181078

auxiliary_graph.remove_nodes spent  5.818974018096924
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101592085,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.282892942428589

the counter of shared neighbor distribution
Counter({1.0: 76339074, 2.0: 14045470, 3.0: 5010672, 4.0: 2310438, 5.0: 1250692, 6.0: 739836, 7.0: 471014, 8.0: 320252, 9.0: 222946, 10.0: 161434, 11.0: 118206, 12.0: 90108, 13.0: 68208, 14.0: 53080, 15.0: 42064, 16.0: 31386, 17.0: 22226, 18.0: 19100, 19.0: 13390, 20.0: 10732, 21.0: 7146, 22.0: 5532, 23.0: 4856, 24.0: 3998, 25.0: 3558, 33.0: 3082, 28.0: 2884, 26.0: 2734, 30.0: 2352, 27.0: 2180, 39.0: 2092, 31.0: 2088, 32.0: 2088, 29.0: 1736, 35.0: 1716, 37.0: 1686, 36.0: 1476, 38.0: 1450, 34.0: 1444, 40.0: 1088})
101395514
Convert a graph into a bidirected graph: 6.647 seconds
Metis partitioning: 28.268 seconds
Split the graph: 2.764 seconds
Construct subgraphs: 0.590 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  38.310258865356445
11944
12591
12029
12653
11943
12637
12374
12654
12538
12654
11984
12057
11927
11927
12499
12160
total k batches seeds list generation spend  67.20960593223572
after graph partition
graph partition algorithm spend time 68.11355638504028
11944
12591
12029
12653
11943
12637
12374
12654
12538
12654
11984
12057
11927
11927
12499
12160
partition_len_list
[108808, 119706, 122217, 150950, 131539, 129980, 114398, 93805, 156294, 114190, 127409, 141202, 141553, 158233, 147221, 151462]
REG selection method  spend 68.954918384552
time for parepare:  0.25645875930786133
local_output_nid generation:  0.0037093162536621094
local_in_edges_tensor generation:  0.005277156829833984
mini_batch_src_global generation:  0.02087712287902832
r_  generation:  0.13692998886108398
local_output_nid generation:  0.00450444221496582
local_in_edges_tensor generation:  0.005364418029785156
mini_batch_src_global generation:  0.022525548934936523
r_  generation:  0.1565539836883545
local_output_nid generation:  0.0043604373931884766
local_in_edges_tensor generation:  0.005434989929199219
mini_batch_src_global generation:  0.01988077163696289
r_  generation:  0.15192675590515137
local_output_nid generation:  0.004584074020385742
local_in_edges_tensor generation:  0.005351543426513672
mini_batch_src_global generation:  0.020965099334716797
r_  generation:  0.16784095764160156
local_output_nid generation:  0.004372358322143555
local_in_edges_tensor generation:  0.005566835403442383
mini_batch_src_global generation:  0.024033546447753906
r_  generation:  0.16971302032470703
local_output_nid generation:  0.0045528411865234375
local_in_edges_tensor generation:  0.005615711212158203
mini_batch_src_global generation:  0.022969722747802734
r_  generation:  0.1789722442626953
local_output_nid generation:  0.004465818405151367
local_in_edges_tensor generation:  0.005526065826416016
mini_batch_src_global generation:  0.023247241973876953
r_  generation:  0.16704249382019043
local_output_nid generation:  0.004570960998535156
local_in_edges_tensor generation:  0.005588054656982422
mini_batch_src_global generation:  0.022212743759155273
r_  generation:  0.16294145584106445
local_output_nid generation:  0.004496097564697266
local_in_edges_tensor generation:  0.0072536468505859375
mini_batch_src_global generation:  0.02408313751220703
r_  generation:  0.18050837516784668
local_output_nid generation:  0.0046160221099853516
local_in_edges_tensor generation:  0.0055408477783203125
mini_batch_src_global generation:  0.023012638092041016
r_  generation:  0.16639423370361328
local_output_nid generation:  0.004380464553833008
local_in_edges_tensor generation:  0.0065305233001708984
mini_batch_src_global generation:  0.02281928062438965
r_  generation:  0.15358448028564453
local_output_nid generation:  0.004452705383300781
local_in_edges_tensor generation:  0.00782465934753418
mini_batch_src_global generation:  0.02211141586303711
r_  generation:  0.15976905822753906
local_output_nid generation:  0.004362821578979492
local_in_edges_tensor generation:  0.005402326583862305
mini_batch_src_global generation:  0.022933244705200195
r_  generation:  0.17873454093933105
local_output_nid generation:  0.004389286041259766
local_in_edges_tensor generation:  0.005420207977294922
mini_batch_src_global generation:  0.023976564407348633
r_  generation:  0.18335556983947754
local_output_nid generation:  0.004538774490356445
local_in_edges_tensor generation:  0.007419586181640625
mini_batch_src_global generation:  0.02528095245361328
r_  generation:  0.19221234321594238
local_output_nid generation:  0.004458904266357422
local_in_edges_tensor generation:  0.007153749465942383
mini_batch_src_global generation:  0.025175094604492188
r_  generation:  0.18998479843139648
----------------------check_connections_block total spend ----------------------------- 4.07456111907959
generate_one_block  0.3848249912261963
generate_one_block  0.31917238235473633
generate_one_block  0.26642370223999023
generate_one_block  0.26774024963378906
generate_one_block  0.2577857971191406
generate_one_block  0.24244356155395508
generate_one_block  0.22159838676452637
generate_one_block  0.2077012062072754
generate_one_block  0.24251723289489746
generate_one_block  0.20836758613586426
generate_one_block  0.20583176612854004
generate_one_block  0.200897216796875
generate_one_block  0.24137616157531738
generate_one_block  0.2270371913909912
generate_one_block  0.24659204483032227
generate_one_block  0.23024725914001465
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2645111083984375
gen group dst list time:  0.06307721138000488
time for parepare:  0.43192481994628906
local_output_nid generation:  0.03129291534423828
local_in_edges_tensor generation:  0.14875292778015137
mini_batch_src_global generation:  0.09915947914123535
r_  generation:  0.9850716590881348
local_output_nid generation:  0.03594326972961426
local_in_edges_tensor generation:  0.0848543643951416
mini_batch_src_global generation:  0.1392064094543457
r_  generation:  1.1149864196777344
local_output_nid generation:  0.03719305992126465
local_in_edges_tensor generation:  0.09259200096130371
mini_batch_src_global generation:  0.13420605659484863
r_  generation:  1.2351346015930176
local_output_nid generation:  0.04317903518676758
local_in_edges_tensor generation:  0.06270503997802734
mini_batch_src_global generation:  0.16352438926696777
r_  generation:  1.588878870010376
local_output_nid generation:  0.037398576736450195
local_in_edges_tensor generation:  0.05539679527282715
mini_batch_src_global generation:  0.17421865463256836
r_  generation:  1.503617286682129
local_output_nid generation:  0.03809094429016113
local_in_edges_tensor generation:  0.0618138313293457
mini_batch_src_global generation:  0.1661849021911621
r_  generation:  1.433520793914795
local_output_nid generation:  0.03353714942932129
local_in_edges_tensor generation:  0.042290449142456055
mini_batch_src_global generation:  0.14353466033935547
r_  generation:  1.1941213607788086
local_output_nid generation:  0.02575540542602539
local_in_edges_tensor generation:  0.03971290588378906
mini_batch_src_global generation:  0.1299426555633545
r_  generation:  0.8999004364013672
local_output_nid generation:  0.04576611518859863
local_in_edges_tensor generation:  0.15469884872436523
mini_batch_src_global generation:  0.19935274124145508
r_  generation:  1.826143741607666
local_output_nid generation:  0.04147791862487793
local_in_edges_tensor generation:  0.06052541732788086
mini_batch_src_global generation:  0.1413578987121582
r_  generation:  1.1011672019958496
local_output_nid generation:  0.04159402847290039
local_in_edges_tensor generation:  0.07618045806884766
mini_batch_src_global generation:  0.15095853805541992
r_  generation:  1.4948525428771973
local_output_nid generation:  0.04179096221923828
local_in_edges_tensor generation:  0.07053661346435547
mini_batch_src_global generation:  0.20371508598327637
r_  generation:  1.699770450592041
local_output_nid generation:  0.042595624923706055
local_in_edges_tensor generation:  0.08977675437927246
mini_batch_src_global generation:  0.17742061614990234
r_  generation:  1.6269779205322266
local_output_nid generation:  0.04835343360900879
local_in_edges_tensor generation:  0.08594393730163574
mini_batch_src_global generation:  0.22118544578552246
r_  generation:  1.849914789199829
local_output_nid generation:  0.04368877410888672
local_in_edges_tensor generation:  0.07220602035522461
mini_batch_src_global generation:  0.19356369972229004
r_  generation:  1.7422311305999756
local_output_nid generation:  0.04655098915100098
local_in_edges_tensor generation:  0.09335875511169434
mini_batch_src_global generation:  0.19556832313537598
r_  generation:  1.8066339492797852
----------------------check_connections_block total spend ----------------------------- 32.425133228302
generate_one_block  1.7832257747650146
generate_one_block  1.5068161487579346
generate_one_block  1.6572151184082031
generate_one_block  2.050283670425415
generate_one_block  1.9069459438323975
generate_one_block  1.8425159454345703
generate_one_block  1.5507237911224365
generate_one_block  1.1148731708526611
generate_one_block  2.4989402294158936
generate_one_block  1.4075212478637695
generate_one_block  1.9009337425231934
generate_one_block  2.156200408935547
generate_one_block  2.143880605697632
generate_one_block  2.4192910194396973
generate_one_block  2.272862672805786
generate_one_block  2.323746919631958
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.329838991165161
gen group dst list time:  0.3148198127746582
time for parepare:  0.49448370933532715
local_output_nid generation:  0.1528151035308838
local_in_edges_tensor generation:  0.4429166316986084
mini_batch_src_global generation:  0.3099193572998047
r_  generation:  3.7026114463806152
local_output_nid generation:  0.1558222770690918
local_in_edges_tensor generation:  0.36429715156555176
mini_batch_src_global generation:  0.3804185390472412
r_  generation:  3.671893835067749
local_output_nid generation:  0.19062542915344238
local_in_edges_tensor generation:  0.38407158851623535
mini_batch_src_global generation:  0.4873509407043457
r_  generation:  4.86359715461731
local_output_nid generation:  0.27843785285949707
local_in_edges_tensor generation:  0.525291919708252
mini_batch_src_global generation:  0.5640909671783447
r_  generation:  6.049434661865234
local_output_nid generation:  0.18540620803833008
local_in_edges_tensor generation:  0.3989081382751465
mini_batch_src_global generation:  0.5396037101745605
r_  generation:  5.222015857696533
local_output_nid generation:  0.18166136741638184
local_in_edges_tensor generation:  0.38675594329833984
mini_batch_src_global generation:  0.5054295063018799
r_  generation:  5.07488226890564
local_output_nid generation:  0.16939592361450195
local_in_edges_tensor generation:  0.4652523994445801
mini_batch_src_global generation:  0.48247194290161133
r_  generation:  4.381044387817383
local_output_nid generation:  0.09392023086547852
local_in_edges_tensor generation:  0.27740907669067383
mini_batch_src_global generation:  0.33730626106262207
r_  generation:  2.4253149032592773
local_output_nid generation:  0.2822592258453369
local_in_edges_tensor generation:  0.562157392501831
mini_batch_src_global generation:  0.6048810482025146
r_  generation:  6.850304841995239
local_output_nid generation:  0.17447948455810547
local_in_edges_tensor generation:  0.3422694206237793
mini_batch_src_global generation:  0.48760104179382324
r_  generation:  4.185547351837158
local_output_nid generation:  0.25519680976867676
local_in_edges_tensor generation:  0.5298490524291992
mini_batch_src_global generation:  0.6484191417694092
r_  generation:  6.845036029815674
local_output_nid generation:  0.2429790496826172
local_in_edges_tensor generation:  0.49977612495422363
mini_batch_src_global generation:  0.6850249767303467
r_  generation:  6.859403133392334
local_output_nid generation:  0.20074748992919922
local_in_edges_tensor generation:  0.42158985137939453
mini_batch_src_global generation:  0.6115572452545166
r_  generation:  5.687010765075684
local_output_nid generation:  0.23625969886779785
local_in_edges_tensor generation:  0.4927072525024414
mini_batch_src_global generation:  0.6613693237304688
r_  generation:  6.4878528118133545
local_output_nid generation:  0.21406340599060059
local_in_edges_tensor generation:  0.5175426006317139
mini_batch_src_global generation:  0.6254208087921143
r_  generation:  6.355956792831421
local_output_nid generation:  0.22844719886779785
local_in_edges_tensor generation:  0.5403997898101807
mini_batch_src_global generation:  0.6863813400268555
r_  generation:  6.447361707687378
----------------------check_connections_block total spend ----------------------------- 120.23576664924622
generate_one_block  5.522190093994141
generate_one_block  4.862224102020264
generate_one_block  6.1223108768463135
generate_one_block  7.621097803115845
generate_one_block  6.611783504486084
generate_one_block  6.7737462520599365
generate_one_block  5.595142126083374
generate_one_block  3.111581563949585
generate_one_block  8.747297048568726
generate_one_block  5.44520378112793
generate_one_block  8.88579273223877
generate_one_block  8.597482681274414
generate_one_block  7.060251235961914
generate_one_block  8.188107013702393
generate_one_block  7.8171164989471436
generate_one_block  7.977372646331787
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9184832572937012  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

connection checking time:  156.7354609966278
block generation total time  143.44523310661316
average batch blocks generation time:  2.988442356387774
block dataloader generation time/epoch 383.8503788312276
pseudo mini batch 0 input nodes size: 1264394
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5601086616516113  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5601086616516113  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.0311322212219238  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.0312213897705078  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.4762759208679199  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5720710754394531  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5720710754394531  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1264394
first layer output nodes number: 452251
edges number: 9289174
torch.Size([1264394, 100])
torch.Size([452251, 256])
input nodes number: 452251
output nodes number: 108808
edges number: 3025884
torch.Size([452251, 256])
torch.Size([108808, 256])
torch.Size([11944, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.178290367126465  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.181123733520508  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7164115905761719  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 1 input nodes size: 1256242
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.47667646408081055  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.47667646408081055  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9446635246276855  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9447574615478516  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.4736447334289551  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5682520866394043  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5682520866394043  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1256242
first layer output nodes number: 453416
edges number: 8984890
torch.Size([1256242, 100])
torch.Size([453416, 256])
input nodes number: 453416
output nodes number: 119706
edges number: 3241801
torch.Size([453416, 256])
torch.Size([119706, 256])
torch.Size([12591, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.2108631134033203  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.2140140533447266  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7144207954406738  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 2 input nodes size: 1393903
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.47388744354248047  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.47388744354248047  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.993156909942627  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9932465553283691  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5251655578613281  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6398258209228516  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6398258209228516  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1393903
first layer output nodes number: 550358
edges number: 11405966
torch.Size([1393903, 100])
torch.Size([550358, 256])
input nodes number: 550358
output nodes number: 122217
edges number: 3527284
torch.Size([550358, 256])
torch.Size([122217, 256])
torch.Size([12029, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.5552992820739746  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.557405948638916  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.8095049858093262  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 3 input nodes size: 1595923
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.524540901184082  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.524540901184082  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.1190686225891113  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.1191630363464355  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5998039245605469  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7402329444885254  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7402329444885254  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1595923
first layer output nodes number: 679353
edges number: 13970836
torch.Size([1595923, 100])
torch.Size([679353, 256])
input nodes number: 679353
output nodes number: 150950
edges number: 4309172
torch.Size([679353, 256])
torch.Size([150950, 256])
torch.Size([12653, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 3.1003923416137695  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 3.1026086807250977  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9461565017700195  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 4 input nodes size: 1481523
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5999135971069336  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5999135971069336  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.1518239974975586  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.1519131660461426  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5572910308837891  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6846494674682617  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6846494674682617  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1481523
first layer output nodes number: 546819
edges number: 12375097
torch.Size([1481523, 100])
torch.Size([546819, 256])
input nodes number: 546819
output nodes number: 131539
edges number: 4239528
torch.Size([546819, 256])
torch.Size([131539, 256])
torch.Size([11943, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.6347904205322266  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.6375179290771484  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.8731818199157715  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 5 input nodes size: 1423244
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.557166576385498  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.557166576385498  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.0873665809631348  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.087460994720459  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.53546142578125  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6576294898986816  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6576294898986816  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1423244
first layer output nodes number: 523569
edges number: 11726186
torch.Size([1423244, 100])
torch.Size([523569, 256])
input nodes number: 523569
output nodes number: 129980
edges number: 4073175
torch.Size([523569, 256])
torch.Size([129980, 256])
torch.Size([12637, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.538273334503174  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.5404868125915527  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.8390183448791504  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 6 input nodes size: 1363126
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5363016128540039  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5363016128540039  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.0441060066223145  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.0441985130310059  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5139040946960449  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.620673656463623  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.620673656463623  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1363126
first layer output nodes number: 496023
edges number: 10434318
torch.Size([1363126, 100])
torch.Size([496023, 256])
input nodes number: 496023
output nodes number: 114398
edges number: 3373573
torch.Size([496023, 256])
torch.Size([114398, 256])
torch.Size([12374, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.365128993988037  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.3672962188720703  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7781190872192383  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 7 input nodes size: 948885
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5131392478942871  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5131392478942871  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.8666267395019531  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.8667211532592773  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.3588242530822754  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.42510032653808594  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.42510032653808594  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 948885
first layer output nodes number: 289197
edges number: 5806617
torch.Size([948885, 100])
torch.Size([289197, 256])
input nodes number: 289197
output nodes number: 93805
edges number: 2588968
torch.Size([289197, 256])
torch.Size([93805, 256])
torch.Size([12654, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.5396456718444824  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.5418620109558105  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5309567451477051  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 8 input nodes size: 1620448
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.3588733673095703  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.3588733673095703  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9625372886657715  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.9626307487487793  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6090488433837891  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7694849967956543  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7694849967956543  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1620448
first layer output nodes number: 718358
edges number: 16159179
torch.Size([1620448, 100])
torch.Size([718358, 256])
input nodes number: 718358
output nodes number: 156294
edges number: 4869654
torch.Size([718358, 256])
torch.Size([156294, 256])
torch.Size([12538, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 3.26560640335083  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 3.2678022384643555  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.0010185241699219  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 9 input nodes size: 1319732
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6090283393859863  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6090283393859863  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.1006669998168945  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.1007614135742188  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.49700403213500977  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5987753868103027  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.5987753868103027  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1319732
first layer output nodes number: 481356
edges number: 10070756
torch.Size([1319732, 100])
torch.Size([481356, 256])
input nodes number: 481356
output nodes number: 114190
edges number: 3032627
torch.Size([481356, 256])
torch.Size([114190, 256])
torch.Size([12654, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.3021960258483887  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 2.304412364959717  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7500386238098145  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 10 input nodes size: 1625931
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.4970245361328125  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.4970245361328125  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.1027312278747559  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 1.102820873260498  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.6110877990722656  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7673869132995605  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8026123046875 GB
    Memory Allocated: 0.7673869132995605  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1625931
first layer output nodes number: 731425
edges number: 16576788
torch.Size([1625931, 100])
torch.Size([731425, 256])
input nodes number: 731425
output nodes number: 127409
edges number: 3958452
torch.Size([731425, 256])
torch.Size([127409, 256])
torch.Size([11984, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 3.201829433441162  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.9022216796875 GB
    Memory Allocated: 3.2039284706115723  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.9871835708618164  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 11 input nodes size: 1591230
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.6109704971313477  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.6109704971313477  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 1.2037501335144043  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 1.2038402557373047  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.5980439186096191  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.7520241737365723  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.7520241737365723  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1591230
first layer output nodes number: 706251
edges number: 15836996
torch.Size([1591230, 100])
torch.Size([706251, 256])
input nodes number: 706251
output nodes number: 141202
edges number: 4411070
torch.Size([706251, 256])
torch.Size([141202, 256])
torch.Size([12057, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 3.1654796600341797  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 3.1675915718078613  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.973961353302002  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 12 input nodes size: 1378872
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.5980567932128906  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.5980567932128906  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 1.1117267608642578  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 1.1118159294128418  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.5189461708068848  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.6569857597351074  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.6569857597351074  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1378872
first layer output nodes number: 584812
edges number: 13340508
torch.Size([1378872, 100])
torch.Size([584812, 256])
input nodes number: 584812
output nodes number: 141553
edges number: 4504438
torch.Size([584812, 256])
torch.Size([141553, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 2.7417845726013184  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 2.7438735961914062  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.8561224937438965  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 13 input nodes size: 1545381
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.518923282623291  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.518923282623291  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 1.095095157623291  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 1.095184326171875  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.5814251899719238  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.73760986328125  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.73760986328125  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1545381
first layer output nodes number: 679517
edges number: 15343910
torch.Size([1545381, 100])
torch.Size([679517, 256])
input nodes number: 679517
output nodes number: 158233
edges number: 5055812
torch.Size([679517, 256])
torch.Size([158233, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 3.1355180740356445  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 3.1376070976257324  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.964113712310791  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 14 input nodes size: 1421190
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.5814251899719238  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.5814251899719238  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 1.1108598709106445  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 1.1109533309936523  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.5346922874450684  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.6800012588500977  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.6800012588500977  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1421190
first layer output nodes number: 625333
edges number: 14271723
torch.Size([1421190, 100])
torch.Size([625333, 256])
input nodes number: 625333
output nodes number: 147221
edges number: 4725975
torch.Size([625333, 256])
torch.Size([147221, 256])
torch.Size([12499, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 2.8963069915771484  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 2.898496150970459  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.8926434516906738  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

pseudo mini batch 15 input nodes size: 1428202
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.534792423248291  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.534792423248291  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 1.0668392181396484  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 1.066929817199707  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.5374016761779785  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.6874594688415527  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.6874594688415527  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1428202
first layer output nodes number: 651907
edges number: 14820796
torch.Size([1428202, 100])
torch.Size([651907, 256])
input nodes number: 651907
output nodes number: 151462
edges number: 4840228
torch.Size([651907, 256])
torch.Size([151462, 256])
torch.Size([12160, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 2.987614631652832  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 2.989744186401367  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.9054369926452637  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.9054369926452637  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.9054369926452637  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.20533306896686554 |0.1266103833913803 |0.040511950850486755 |0.00013870000839233398 |0.007644921541213989 |0.0012803077697753906 |
----------------------------------------------------------pseudo_mini_loss sum 3.650017023086548
Total (block generation + training)time/epoch 390.4467986424764
Training time/epoch 6.198613166809082
Training time without block to device /epoch 4.172847032546997
Training time without total dataloading part /epoch 0.7740094661712646
load block tensor time/epoch 3.2853291034698486
block to device time/epoch 2.025766134262085
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  33937138
Number of first layer input nodes during this epoch:  22658226
Number of first layer output nodes during this epoch:  9169945
----------------------------------------before generate dataloader block 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.9054365158081055  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.36861157417297363
global_2_local spend time (sec) 0.5826151371002197
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.036394596099853516
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1181035, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.07702922821044922
auxiliary_graph
Graph(num_nodes=1377606, num_edges=101674287,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6487696170806885
remove nodes length  1181035

auxiliary_graph.remove_nodes spent  5.50113582611084
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101674287,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.626093626022339

the counter of shared neighbor distribution
Counter({1.0: 76438302, 2.0: 14044614, 3.0: 5010044, 4.0: 2306628, 5.0: 1243674, 6.0: 737406, 7.0: 470430, 8.0: 317834, 9.0: 224420, 10.0: 161934, 11.0: 118450, 12.0: 89198, 13.0: 68550, 14.0: 52286, 15.0: 42424, 16.0: 31166, 17.0: 21944, 18.0: 19188, 19.0: 13520, 20.0: 10676, 21.0: 6852, 22.0: 5766, 23.0: 4726, 24.0: 4066, 25.0: 3670, 33.0: 2968, 28.0: 2830, 26.0: 2596, 30.0: 2356, 27.0: 2246, 31.0: 2206, 39.0: 2084, 32.0: 2044, 35.0: 1740, 29.0: 1672, 37.0: 1660, 36.0: 1542, 34.0: 1470, 38.0: 1456, 40.0: 1078})
101477716
Convert a graph into a bidirected graph: 6.701 seconds
Metis partitioning: 28.887 seconds
Split the graph: 2.402 seconds
Construct subgraphs: 0.679 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  38.70907735824585
12587
12652
11982
12259
11927
12654
12058
12622
11960
11927
11966
12118
12581
12654
11970
12654
total k batches seeds list generation spend  68.1272189617157
after graph partition
graph partition algorithm spend time 69.00337052345276
12587
12652
11982
12259
11927
12654
12058
12622
11960
11927
11966
12118
12581
12654
11970
12654
partition_len_list
[160247, 113862, 112429, 137726, 131144, 144134, 140906, 156217, 124487, 135297, 108969, 120256, 143737, 128115, 109642, 95733]
REG selection method  spend 69.85260677337646
time for parepare:  0.25937747955322266
local_output_nid generation:  0.003905773162841797
local_in_edges_tensor generation:  0.005520343780517578
mini_batch_src_global generation:  0.019537687301635742
r_  generation:  0.15389418601989746
local_output_nid generation:  0.00458979606628418
local_in_edges_tensor generation:  0.005384683609008789
mini_batch_src_global generation:  0.022480487823486328
r_  generation:  0.14519405364990234
local_output_nid generation:  0.004391908645629883
local_in_edges_tensor generation:  0.004914760589599609
mini_batch_src_global generation:  0.024481534957885742
r_  generation:  0.13198113441467285
local_output_nid generation:  0.0044841766357421875
local_in_edges_tensor generation:  0.00510859489440918
mini_batch_src_global generation:  0.01989889144897461
r_  generation:  0.14504098892211914
local_output_nid generation:  0.0043926239013671875
local_in_edges_tensor generation:  0.005280494689941406
mini_batch_src_global generation:  0.020988941192626953
r_  generation:  0.17247557640075684
local_output_nid generation:  0.004566192626953125
local_in_edges_tensor generation:  0.00566864013671875
mini_batch_src_global generation:  0.02341914176940918
r_  generation:  0.17806172370910645
local_output_nid generation:  0.004426717758178711
local_in_edges_tensor generation:  0.005384683609008789
mini_batch_src_global generation:  0.023179054260253906
r_  generation:  0.17668461799621582
local_output_nid generation:  0.004588603973388672
local_in_edges_tensor generation:  0.005597591400146484
mini_batch_src_global generation:  0.024667024612426758
r_  generation:  0.1860203742980957
local_output_nid generation:  0.004413604736328125
local_in_edges_tensor generation:  0.0050699710845947266
mini_batch_src_global generation:  0.023227691650390625
r_  generation:  0.17023563385009766
local_output_nid generation:  0.004435539245605469
local_in_edges_tensor generation:  0.005404233932495117
mini_batch_src_global generation:  0.02241969108581543
r_  generation:  0.16977214813232422
local_output_nid generation:  0.0044400691986083984
local_in_edges_tensor generation:  0.005218982696533203
mini_batch_src_global generation:  0.023494958877563477
r_  generation:  0.1646714210510254
local_output_nid generation:  0.004421710968017578
local_in_edges_tensor generation:  0.005411386489868164
mini_batch_src_global generation:  0.02319955825805664
r_  generation:  0.16913509368896484
local_output_nid generation:  0.00459599494934082
local_in_edges_tensor generation:  0.007188081741333008
mini_batch_src_global generation:  0.027811050415039062
r_  generation:  0.20106101036071777
local_output_nid generation:  0.00460052490234375
local_in_edges_tensor generation:  0.007199764251708984
mini_batch_src_global generation:  0.024742841720581055
r_  generation:  0.1851825714111328
local_output_nid generation:  0.004438877105712891
local_in_edges_tensor generation:  0.005466461181640625
mini_batch_src_global generation:  0.024925708770751953
r_  generation:  0.16812968254089355
local_output_nid generation:  0.004606008529663086
local_in_edges_tensor generation:  0.005399465560913086
mini_batch_src_global generation:  0.023748159408569336
r_  generation:  0.16373014450073242
----------------------check_connections_block total spend ----------------------------- 4.081488847732544
generate_one_block  0.46751904487609863
generate_one_block  0.28546738624572754
generate_one_block  0.23483514785766602
generate_one_block  0.23750877380371094
generate_one_block  0.2430405616760254
generate_one_block  0.24863982200622559
generate_one_block  0.23546051979064941
generate_one_block  0.2741122245788574
generate_one_block  0.2515830993652344
generate_one_block  0.26001691818237305
generate_one_block  0.2286055088043213
generate_one_block  0.2493753433227539
generate_one_block  0.28224968910217285
generate_one_block  0.2400658130645752
generate_one_block  0.21490263938903809
generate_one_block  0.2124190330505371
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.273372173309326
gen group dst list time:  0.06362152099609375
time for parepare:  0.44916486740112305
local_output_nid generation:  0.04358839988708496
local_in_edges_tensor generation:  0.17033958435058594
mini_batch_src_global generation:  0.16760754585266113
r_  generation:  1.789534330368042
local_output_nid generation:  0.031687259674072266
local_in_edges_tensor generation:  0.049347639083862305
mini_batch_src_global generation:  0.1443941593170166
r_  generation:  1.0533380508422852
local_output_nid generation:  0.03485465049743652
local_in_edges_tensor generation:  0.049132585525512695
mini_batch_src_global generation:  0.13194036483764648
r_  generation:  1.2327852249145508
local_output_nid generation:  0.03998303413391113
local_in_edges_tensor generation:  0.0687558650970459
mini_batch_src_global generation:  0.164506196975708
r_  generation:  1.5693376064300537
local_output_nid generation:  0.03923535346984863
local_in_edges_tensor generation:  0.09626364707946777
mini_batch_src_global generation:  0.17285919189453125
r_  generation:  1.4795076847076416
local_output_nid generation:  0.04296445846557617
local_in_edges_tensor generation:  0.06992387771606445
mini_batch_src_global generation:  0.18750905990600586
r_  generation:  1.6914865970611572
local_output_nid generation:  0.043849945068359375
local_in_edges_tensor generation:  0.07129931449890137
mini_batch_src_global generation:  0.18459033966064453
r_  generation:  1.636380910873413
local_output_nid generation:  0.054602622985839844
local_in_edges_tensor generation:  0.10639834403991699
mini_batch_src_global generation:  0.20742034912109375
r_  generation:  1.8771469593048096
local_output_nid generation:  0.037626028060913086
local_in_edges_tensor generation:  0.0603022575378418
mini_batch_src_global generation:  0.15805554389953613
r_  generation:  1.3392305374145508
local_output_nid generation:  0.04146766662597656
local_in_edges_tensor generation:  0.07581830024719238
mini_batch_src_global generation:  0.15355134010314941
r_  generation:  1.490450143814087
local_output_nid generation:  0.032906293869018555
local_in_edges_tensor generation:  0.08499956130981445
mini_batch_src_global generation:  0.13357973098754883
r_  generation:  1.1731047630310059
local_output_nid generation:  0.036255598068237305
local_in_edges_tensor generation:  0.0699317455291748
mini_batch_src_global generation:  0.1450333595275879
r_  generation:  1.3551509380340576
local_output_nid generation:  0.04232311248779297
local_in_edges_tensor generation:  0.07463264465332031
mini_batch_src_global generation:  0.1869964599609375
r_  generation:  1.6988840103149414
local_output_nid generation:  0.03880119323730469
local_in_edges_tensor generation:  0.09729361534118652
mini_batch_src_global generation:  0.17490029335021973
r_  generation:  1.5075247287750244
local_output_nid generation:  0.03259849548339844
local_in_edges_tensor generation:  0.06579351425170898
mini_batch_src_global generation:  0.148695707321167
r_  generation:  1.2334253787994385
local_output_nid generation:  0.02694392204284668
local_in_edges_tensor generation:  0.06348061561584473
mini_batch_src_global generation:  0.1191561222076416
r_  generation:  0.9206318855285645
----------------------check_connections_block total spend ----------------------------- 32.355857372283936
generate_one_block  2.6846566200256348
generate_one_block  1.4492559432983398
generate_one_block  1.8358259201049805
generate_one_block  2.081970691680908
generate_one_block  1.9339821338653564
generate_one_block  2.197690010070801
generate_one_block  2.1469736099243164
generate_one_block  2.484065294265747
generate_one_block  1.757462978363037
generate_one_block  1.8085973262786865
generate_one_block  1.4197299480438232
generate_one_block  1.6683604717254639
generate_one_block  2.2253897190093994
generate_one_block  1.9132304191589355
generate_one_block  1.4899241924285889
generate_one_block  1.1418681144714355
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.373887538909912
gen group dst list time:  0.31946277618408203
time for parepare:  0.48766660690307617
local_output_nid generation:  0.25962114334106445
local_in_edges_tensor generation:  0.7204768657684326
mini_batch_src_global generation:  0.573589563369751
r_  generation:  6.92432165145874
local_output_nid generation:  0.1553816795349121
local_in_edges_tensor generation:  0.4766559600830078
mini_batch_src_global generation:  0.5215787887573242
r_  generation:  4.2359888553619385
local_output_nid generation:  0.22032523155212402
local_in_edges_tensor generation:  0.5063138008117676
mini_batch_src_global generation:  0.6111965179443359
r_  generation:  6.1511454582214355
local_output_nid generation:  0.2852604389190674
local_in_edges_tensor generation:  0.518301248550415
mini_batch_src_global generation:  0.642963171005249
r_  generation:  6.599212646484375
local_output_nid generation:  0.18723082542419434
local_in_edges_tensor generation:  0.4072706699371338
mini_batch_src_global generation:  0.5557100772857666
r_  generation:  5.1483988761901855
local_output_nid generation:  0.2134706974029541
local_in_edges_tensor generation:  0.4692816734313965
mini_batch_src_global generation:  0.5960168838500977
r_  generation:  5.883705139160156
local_output_nid generation:  0.22101855278015137
local_in_edges_tensor generation:  0.6256723403930664
mini_batch_src_global generation:  0.6323103904724121
r_  generation:  6.171736717224121
local_output_nid generation:  0.22185587882995605
local_in_edges_tensor generation:  0.624567985534668
mini_batch_src_global generation:  0.6738669872283936
r_  generation:  6.570279359817505
local_output_nid generation:  0.22754526138305664
local_in_edges_tensor generation:  0.3420853614807129
mini_batch_src_global generation:  0.48975515365600586
r_  generation:  4.416769981384277
local_output_nid generation:  0.2088470458984375
local_in_edges_tensor generation:  0.40044069290161133
mini_batch_src_global generation:  0.5271968841552734
r_  generation:  5.44691276550293
local_output_nid generation:  0.16817021369934082
local_in_edges_tensor generation:  0.32298946380615234
mini_batch_src_global generation:  0.46004819869995117
r_  generation:  4.2940075397491455
local_output_nid generation:  0.20036578178405762
local_in_edges_tensor generation:  0.3794276714324951
mini_batch_src_global generation:  0.5002312660217285
r_  generation:  5.140145301818848
local_output_nid generation:  0.20223093032836914
local_in_edges_tensor generation:  0.4129965305328369
mini_batch_src_global generation:  0.5631659030914307
r_  generation:  5.686879396438599
local_output_nid generation:  0.1873159408569336
local_in_edges_tensor generation:  0.3836557865142822
mini_batch_src_global generation:  0.5374233722686768
r_  generation:  5.07072114944458
local_output_nid generation:  0.16186857223510742
local_in_edges_tensor generation:  0.38190746307373047
mini_batch_src_global generation:  0.465503454208374
r_  generation:  4.135713577270508
local_output_nid generation:  0.10088253021240234
local_in_edges_tensor generation:  0.19629240036010742
mini_batch_src_global generation:  0.3227241039276123
r_  generation:  2.5155839920043945
----------------------check_connections_block total spend ----------------------------- 119.20821332931519
generate_one_block  9.877522230148315
generate_one_block  5.708484649658203
generate_one_block  7.93563175201416
generate_one_block  8.586230278015137
generate_one_block  6.546322345733643
generate_one_block  7.948217868804932
generate_one_block  7.595297574996948
generate_one_block  7.8951334953308105
generate_one_block  5.5422585010528564
generate_one_block  6.728002309799194
generate_one_block  5.363708257675171
generate_one_block  6.319967269897461
generate_one_block  7.060169219970703
generate_one_block  6.483571290969849
generate_one_block  5.273096799850464
generate_one_block  3.2490413188934326
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.9054365158081055  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

connection checking time:  155.64555954933167
block generation total time  142.5174400806427
average batch blocks generation time:  2.9691133350133896
block dataloader generation time/epoch 383.298543214798
pseudo mini batch 0 input nodes size: 1714446
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.5373411178588867  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.5373411178588867  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 1.1760220527648926  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 1.1761159896850586  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.6439785957336426  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.8133149147033691  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6072998046875 GB
    Memory Allocated: 0.8133149147033691  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

first layer input nodes number: 1714446
first layer output nodes number: 766762
edges number: 17200044
torch.Size([1714446, 100])
torch.Size([766762, 256])
input nodes number: 766762
output nodes number: 160247
edges number: 4963549
torch.Size([766762, 256])
torch.Size([160247, 256])
torch.Size([12587, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8182373046875 GB
    Memory Allocated: 3.453688144683838  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8182373046875 GB
    Memory Allocated: 3.4559879302978516  GigaBytes
Max Memory Allocated: 4.2380690574646  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.055994987487793  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 1 input nodes size: 1320810
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6440544128417969  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6440544128417969  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.136094570159912  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.1361889839172363  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.49741411209106445  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6001906394958496  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6001906394958496  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1320810
first layer output nodes number: 487447
edges number: 10229349
torch.Size([1320810, 100])
torch.Size([487447, 256])
input nodes number: 487447
output nodes number: 113862
edges number: 3029918
torch.Size([487447, 256])
torch.Size([113862, 256])
torch.Size([12652, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.3208022117614746  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.3230180740356445  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7546324729919434  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 2 input nodes size: 1557739
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.49742555618286133  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.49742555618286133  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0777287483215332  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0778183937072754  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5856838226318359  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7236480712890625  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7236480712890625  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1557739
first layer output nodes number: 638745
edges number: 14466901
torch.Size([1557739, 100])
torch.Size([638745, 256])
input nodes number: 638745
output nodes number: 112429
edges number: 3452416
torch.Size([638745, 256])
torch.Size([112429, 256])
torch.Size([11982, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.8575639724731445  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.8597798347473145  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9187154769897461  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 3 input nodes size: 1576059
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.585566520690918  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.585566520690918  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.1726946830749512  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.1727862358093262  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5923933982849121  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.742647647857666  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.742647647857666  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1576059
first layer output nodes number: 687851
edges number: 15448147
torch.Size([1576059, 100])
torch.Size([687851, 256])
input nodes number: 687851
output nodes number: 137726
edges number: 4278362
torch.Size([687851, 256])
torch.Size([137726, 256])
torch.Size([12259, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 3.0935420989990234  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 3.095689296722412  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9597024917602539  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 4 input nodes size: 1348801
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5924420356750488  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5924420356750488  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.09490966796875  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.094998836517334  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5077791213989258  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6347646713256836  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6347646713256836  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1348801
first layer output nodes number: 536103
edges number: 12205387
torch.Size([1348801, 100])
torch.Size([536103, 256])
input nodes number: 536103
output nodes number: 131144
edges number: 4115572
torch.Size([536103, 256])
torch.Size([131144, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.5522584915161133  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.554347515106201  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8194622993469238  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 5 input nodes size: 1385103
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.507720947265625  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.507720947265625  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.023712158203125  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0238065719604492  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5212497711181641  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6637334823608398  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6637334823608398  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1385103
first layer output nodes number: 611388
edges number: 13904030
torch.Size([1385103, 100])
torch.Size([611388, 256])
input nodes number: 611388
output nodes number: 144134
edges number: 4586495
torch.Size([611388, 256])
torch.Size([144134, 256])
torch.Size([12654, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.8319292068481445  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.834768772125244  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8723011016845703  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 6 input nodes size: 1542016
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5213770866394043  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5213770866394043  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.095822811126709  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0959129333496094  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5798273086547852  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7205791473388672  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7205791473388672  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1542016
first layer output nodes number: 627275
edges number: 14019601
torch.Size([1542016, 100])
torch.Size([627275, 256])
input nodes number: 627275
output nodes number: 140906
edges number: 4400177
torch.Size([627275, 256])
torch.Size([140906, 256])
torch.Size([12058, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.9184317588806152  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.920543670654297  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9263248443603516  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 7 input nodes size: 1432253
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5797228813171387  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5797228813171387  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.113278865814209  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.1133732795715332  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5388374328613281  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6910557746887207  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6910557746887207  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1432253
first layer output nodes number: 647075
edges number: 14787205
torch.Size([1432253, 100])
torch.Size([647075, 256])
input nodes number: 647075
output nodes number: 156217
edges number: 5046581
torch.Size([647075, 256])
torch.Size([156217, 256])
torch.Size([12622, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.997623920440674  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 3.000736713409424  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.913459300994873  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 8 input nodes size: 1362086
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5389361381530762  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5389361381530762  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0463528633117676  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0464420318603516  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.512791633605957  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6167354583740234  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6167354583740234  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1362086
first layer output nodes number: 509519
edges number: 10122853
torch.Size([1362086, 100])
torch.Size([509519, 256])
input nodes number: 509519
output nodes number: 124487
edges number: 3381964
torch.Size([509519, 256])
torch.Size([124487, 256])
torch.Size([11960, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.4257187843322754  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.4284629821777344  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7741928100585938  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 9 input nodes size: 1508764
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5126757621765137  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5126757621765137  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0747342109680176  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0748233795166016  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5673174858093262  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6907286643981934  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6907286643981934  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1508764
first layer output nodes number: 604131
edges number: 12294825
torch.Size([1508764, 100])
torch.Size([604131, 256])
input nodes number: 604131
output nodes number: 135297
edges number: 3821821
torch.Size([604131, 256])
torch.Size([135297, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.7953081130981445  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.797402858734131  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8761115074157715  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 10 input nodes size: 1315393
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.568026065826416  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.568026065826416  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0580482482910156  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0581374168395996  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.4959897994995117  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5969734191894531  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5969734191894531  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1315393
first layer output nodes number: 474780
edges number: 9881732
torch.Size([1315393, 100])
torch.Size([474780, 256])
input nodes number: 474780
output nodes number: 108969
edges number: 3043061
torch.Size([474780, 256])
torch.Size([108969, 256])
torch.Size([11966, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.264050006866455  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.266568660736084  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7457370758056641  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 11 input nodes size: 1445528
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.4952821731567383  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.4952821731567383  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0337834358215332  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0338740348815918  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5437626838684082  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6605706214904785  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6605706214904785  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1445528
first layer output nodes number: 558800
edges number: 11688111
torch.Size([1445528, 100])
torch.Size([558800, 256])
input nodes number: 558800
output nodes number: 120256
edges number: 3527402
torch.Size([558800, 256])
torch.Size([120256, 256])
torch.Size([12118, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.5957250595092773  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.5984997749328613  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8342704772949219  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 12 input nodes size: 1489868
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5441989898681641  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5441989898681641  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0992183685302734  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0993123054504395  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5607204437255859  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6978445053100586  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6978445053100586  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1489868
first layer output nodes number: 580324
edges number: 13188688
torch.Size([1489868, 100])
torch.Size([580324, 256])
input nodes number: 580324
output nodes number: 143737
edges number: 4672584
torch.Size([580324, 256])
torch.Size([143737, 256])
torch.Size([12581, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.780900478363037  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.7831039428710938  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9000210762023926  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 13 input nodes size: 1403822
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.560391902923584  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.560391902923584  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0833563804626465  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0834507942199707  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5283374786376953  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6514692306518555  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6514692306518555  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1403822
first layer output nodes number: 529009
edges number: 11898381
torch.Size([1403822, 100])
torch.Size([529009, 256])
input nodes number: 529009
output nodes number: 128115
edges number: 4014563
torch.Size([529009, 256])
torch.Size([128115, 256])
torch.Size([12654, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.542440891265869  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.5446572303771973  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8350348472595215  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 14 input nodes size: 1308204
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5284214019775391  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5284214019775391  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.01576566696167  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.015855312347412  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.4927964210510254  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.593630313873291  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.593630313873291  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1308204
first layer output nodes number: 467671
edges number: 9817267
torch.Size([1308204, 100])
torch.Size([467671, 256])
input nodes number: 467671
output nodes number: 109642
edges number: 3237346
torch.Size([467671, 256])
torch.Size([109642, 256])
torch.Size([11970, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.247067928314209  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.249164581298828  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7457842826843262  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 15 input nodes size: 965711
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.49260568618774414  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.49260568618774414  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8523612022399902  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8524556159973145  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.3650217056274414  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.43364715576171875  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.43364715576171875  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 965711
first layer output nodes number: 301222
edges number: 6072739
torch.Size([965711, 100])
torch.Size([301222, 256])
input nodes number: 301222
output nodes number: 95733
edges number: 2657048
torch.Size([301222, 256])
torch.Size([95733, 256])
torch.Size([12654, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.5877923965454102  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.5903162956237793  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5428581237792969  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5428581237792969  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5428581237792969  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.20854468643665314 |0.12727445363998413 |0.03984977304935455 |0.0001382678747177124 |0.008123531937599182 |0.0013136863708496094 |
----------------------------------------------------------pseudo_mini_loss sum 4.467086315155029
Total (block generation + training)time/epoch 389.7993814945221
Training time/epoch 6.213866949081421
Training time without block to device /epoch 4.177475690841675
Training time without total dataloading part /epoch 0.7710988521575928
load block tensor time/epoch 3.33671498298645
block to device time/epoch 2.036391258239746
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  33767606
Number of first layer input nodes during this epoch:  22676603
Number of first layer output nodes during this epoch:  9028102
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5428576469421387  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3775064945220947
global_2_local spend time (sec) 0.5812346935272217
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.03830981254577637
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1180944, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.12624716758728027
auxiliary_graph
Graph(num_nodes=1377515, num_edges=101823085,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6510839462280273
remove nodes length  1180944

auxiliary_graph.remove_nodes spent  5.230479955673218
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101823085,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.260069847106934

the counter of shared neighbor distribution
Counter({1.0: 76547122, 2.0: 14056272, 3.0: 5017922, 4.0: 2311666, 5.0: 1247774, 6.0: 739896, 7.0: 471840, 8.0: 321294, 9.0: 224538, 10.0: 162872, 11.0: 119210, 12.0: 90016, 13.0: 68792, 14.0: 52750, 15.0: 42010, 16.0: 30888, 17.0: 21954, 18.0: 19466, 19.0: 13842, 20.0: 10936, 21.0: 7212, 22.0: 5854, 23.0: 4770, 24.0: 4078, 25.0: 3548, 33.0: 2986, 28.0: 2878, 26.0: 2574, 30.0: 2376, 27.0: 2218, 31.0: 2152, 39.0: 2088, 32.0: 2030, 29.0: 1774, 35.0: 1730, 37.0: 1692, 36.0: 1502, 38.0: 1458, 34.0: 1450, 40.0: 1084})
101626514
Convert a graph into a bidirected graph: 6.542 seconds
Metis partitioning: 30.034 seconds
Split the graph: 2.419 seconds
Construct subgraphs: 0.568 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  39.60242581367493
11927
12652
12115
11927
12653
11988
11936
12600
12318
12536
12423
12205
12518
12568
12040
12165
total k batches seeds list generation spend  68.16825151443481
after graph partition
graph partition algorithm spend time 69.03467345237732
11927
12652
12115
11927
12653
11988
11936
12600
12318
12536
12423
12205
12518
12568
12040
12165
partition_len_list
[138970, 113417, 91148, 114710, 133522, 110460, 122027, 124262, 132407, 139474, 140570, 157960, 145384, 154301, 113813, 152871]
REG selection method  spend 69.88973331451416
time for parepare:  0.2563769817352295
local_output_nid generation:  0.003822803497314453
local_in_edges_tensor generation:  0.005281925201416016
mini_batch_src_global generation:  0.01629495620727539
r_  generation:  0.1441364288330078
local_output_nid generation:  0.004549503326416016
local_in_edges_tensor generation:  0.0051953792572021484
mini_batch_src_global generation:  0.02006816864013672
r_  generation:  0.1472158432006836
local_output_nid generation:  0.004389762878417969
local_in_edges_tensor generation:  0.0050144195556640625
mini_batch_src_global generation:  0.01607227325439453
r_  generation:  0.1398913860321045
local_output_nid generation:  0.0043489933013916016
local_in_edges_tensor generation:  0.005267620086669922
mini_batch_src_global generation:  0.017724275588989258
r_  generation:  0.1499922275543213
local_output_nid generation:  0.004636526107788086
local_in_edges_tensor generation:  0.005285739898681641
mini_batch_src_global generation:  0.01937079429626465
r_  generation:  0.16276812553405762
local_output_nid generation:  0.004370689392089844
local_in_edges_tensor generation:  0.006703853607177734
mini_batch_src_global generation:  0.022674560546875
r_  generation:  0.1586623191833496
local_output_nid generation:  0.004343271255493164
local_in_edges_tensor generation:  0.005172252655029297
mini_batch_src_global generation:  0.021720170974731445
r_  generation:  0.1582329273223877
local_output_nid generation:  0.004559516906738281
local_in_edges_tensor generation:  0.0054628849029541016
mini_batch_src_global generation:  0.021136760711669922
r_  generation:  0.1702728271484375
local_output_nid generation:  0.00447535514831543
local_in_edges_tensor generation:  0.008501291275024414
mini_batch_src_global generation:  0.021355390548706055
r_  generation:  0.17401409149169922
local_output_nid generation:  0.004522085189819336
local_in_edges_tensor generation:  0.005460500717163086
mini_batch_src_global generation:  0.0216829776763916
r_  generation:  0.1833336353302002
local_output_nid generation:  0.004535675048828125
local_in_edges_tensor generation:  0.005417346954345703
mini_batch_src_global generation:  0.021856069564819336
r_  generation:  0.18637514114379883
local_output_nid generation:  0.004439592361450195
local_in_edges_tensor generation:  0.005532264709472656
mini_batch_src_global generation:  0.022123336791992188
r_  generation:  0.18582510948181152
local_output_nid generation:  0.00455474853515625
local_in_edges_tensor generation:  0.00550389289855957
mini_batch_src_global generation:  0.02299356460571289
r_  generation:  0.19045352935791016
local_output_nid generation:  0.0045435428619384766
local_in_edges_tensor generation:  0.00726008415222168
mini_batch_src_global generation:  0.022411584854125977
r_  generation:  0.1959841251373291
local_output_nid generation:  0.004433393478393555
local_in_edges_tensor generation:  0.00492095947265625
mini_batch_src_global generation:  0.023710012435913086
r_  generation:  0.1477828025817871
local_output_nid generation:  0.004416465759277344
local_in_edges_tensor generation:  0.005084991455078125
mini_batch_src_global generation:  0.022022485733032227
r_  generation:  0.16898083686828613
----------------------check_connections_block total spend ----------------------------- 3.9764206409454346
generate_one_block  0.43564939498901367
generate_one_block  0.2934737205505371
generate_one_block  0.2436540126800537
generate_one_block  0.23230409622192383
generate_one_block  0.24945783615112305
generate_one_block  0.22640419006347656
generate_one_block  0.21307706832885742
generate_one_block  0.2204909324645996
generate_one_block  0.2319507598876953
generate_one_block  0.24065256118774414
generate_one_block  0.23465943336486816
generate_one_block  0.2287123203277588
generate_one_block  0.24859237670898438
generate_one_block  0.23737692832946777
generate_one_block  0.18811607360839844
generate_one_block  0.20858120918273926
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1389434337615967
gen group dst list time:  0.06368207931518555
time for parepare:  0.4364962577819824
local_output_nid generation:  0.03776812553405762
local_in_edges_tensor generation:  0.18532419204711914
mini_batch_src_global generation:  0.1555790901184082
r_  generation:  1.457700252532959
local_output_nid generation:  0.03095245361328125
local_in_edges_tensor generation:  0.04829144477844238
mini_batch_src_global generation:  0.14064407348632812
r_  generation:  1.0479276180267334
local_output_nid generation:  0.025112628936767578
local_in_edges_tensor generation:  0.04817914962768555
mini_batch_src_global generation:  0.10263824462890625
r_  generation:  0.8126702308654785
local_output_nid generation:  0.03339695930480957
local_in_edges_tensor generation:  0.0850822925567627
mini_batch_src_global generation:  0.14225387573242188
r_  generation:  1.1745808124542236
local_output_nid generation:  0.03821301460266113
local_in_edges_tensor generation:  0.07694077491760254
mini_batch_src_global generation:  0.15057682991027832
r_  generation:  1.378058671951294
local_output_nid generation:  0.033298492431640625
local_in_edges_tensor generation:  0.05182981491088867
mini_batch_src_global generation:  0.13536930084228516
r_  generation:  1.183333158493042
local_output_nid generation:  0.03621840476989746
local_in_edges_tensor generation:  0.06816744804382324
mini_batch_src_global generation:  0.13912129402160645
r_  generation:  1.240814208984375
local_output_nid generation:  0.036154985427856445
local_in_edges_tensor generation:  0.04607558250427246
mini_batch_src_global generation:  0.1459348201751709
r_  generation:  1.2357089519500732
local_output_nid generation:  0.037197113037109375
local_in_edges_tensor generation:  0.12517738342285156
mini_batch_src_global generation:  0.16509342193603516
r_  generation:  1.4255797863006592
local_output_nid generation:  0.040984153747558594
local_in_edges_tensor generation:  0.13106799125671387
mini_batch_src_global generation:  0.18533778190612793
r_  generation:  1.6286001205444336
local_output_nid generation:  0.03928256034851074
local_in_edges_tensor generation:  0.09103822708129883
mini_batch_src_global generation:  0.18369460105895996
r_  generation:  1.6528091430664062
local_output_nid generation:  0.04748797416687012
local_in_edges_tensor generation:  0.10935449600219727
mini_batch_src_global generation:  0.23014116287231445
r_  generation:  1.8804864883422852
local_output_nid generation:  0.042523860931396484
local_in_edges_tensor generation:  0.16432595252990723
mini_batch_src_global generation:  0.19336390495300293
r_  generation:  1.7300646305084229
local_output_nid generation:  0.04348111152648926
local_in_edges_tensor generation:  0.10887336730957031
mini_batch_src_global generation:  0.21481060981750488
r_  generation:  1.809082269668579
local_output_nid generation:  0.039647579193115234
local_in_edges_tensor generation:  0.07205820083618164
mini_batch_src_global generation:  0.15780973434448242
r_  generation:  1.3148653507232666
local_output_nid generation:  0.044078826904296875
local_in_edges_tensor generation:  0.07689547538757324
mini_batch_src_global generation:  0.1864604949951172
r_  generation:  1.8738036155700684
----------------------check_connections_block total spend ----------------------------- 32.35092759132385
generate_one_block  2.5248658657073975
generate_one_block  1.4167304039001465
generate_one_block  1.111222267150879
generate_one_block  1.5861639976501465
generate_one_block  1.782644510269165
generate_one_block  1.518845796585083
generate_one_block  1.560880422592163
generate_one_block  1.5349085330963135
generate_one_block  2.015533924102783
generate_one_block  2.088198661804199
generate_one_block  2.1427903175354004
generate_one_block  2.4379334449768066
generate_one_block  2.256708860397339
generate_one_block  2.3862216472625732
generate_one_block  1.6968376636505127
generate_one_block  2.361703395843506
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.4413223266601562
gen group dst list time:  0.31299901008605957
time for parepare:  0.47846055030822754
local_output_nid generation:  0.23207473754882812
local_in_edges_tensor generation:  0.649651288986206
mini_batch_src_global generation:  0.5005054473876953
r_  generation:  5.951659917831421
local_output_nid generation:  0.15404605865478516
local_in_edges_tensor generation:  0.5913312435150146
mini_batch_src_global generation:  0.5008888244628906
r_  generation:  4.024965763092041
local_output_nid generation:  0.09389019012451172
local_in_edges_tensor generation:  0.1939098834991455
mini_batch_src_global generation:  0.2691185474395752
r_  generation:  2.34722900390625
local_output_nid generation:  0.17945408821105957
local_in_edges_tensor generation:  0.35723423957824707
mini_batch_src_global generation:  0.42302775382995605
r_  generation:  4.4793760776519775
local_output_nid generation:  0.2071857452392578
local_in_edges_tensor generation:  0.34893107414245605
mini_batch_src_global generation:  0.46499133110046387
r_  generation:  4.537986516952515
local_output_nid generation:  0.2110731601715088
local_in_edges_tensor generation:  0.36609697341918945
mini_batch_src_global generation:  0.48859357833862305
r_  generation:  4.797774076461792
local_output_nid generation:  0.18707656860351562
local_in_edges_tensor generation:  0.3452584743499756
mini_batch_src_global generation:  0.46857285499572754
r_  generation:  4.558217287063599
local_output_nid generation:  0.15180540084838867
local_in_edges_tensor generation:  0.2713620662689209
mini_batch_src_global generation:  0.3968391418457031
r_  generation:  3.5620172023773193
local_output_nid generation:  0.17604684829711914
local_in_edges_tensor generation:  0.3545083999633789
mini_batch_src_global generation:  0.4663267135620117
r_  generation:  4.679738521575928
local_output_nid generation:  0.21165704727172852
local_in_edges_tensor generation:  0.42534375190734863
mini_batch_src_global generation:  0.5611679553985596
r_  generation:  5.832862615585327
local_output_nid generation:  0.21610426902770996
local_in_edges_tensor generation:  0.5105009078979492
mini_batch_src_global generation:  0.624093770980835
r_  generation:  6.136980295181274
local_output_nid generation:  0.24202823638916016
local_in_edges_tensor generation:  0.5675392150878906
mini_batch_src_global generation:  0.655381441116333
r_  generation:  6.763601779937744
local_output_nid generation:  0.2346019744873047
local_in_edges_tensor generation:  0.4761009216308594
mini_batch_src_global generation:  0.6463577747344971
r_  generation:  6.091363191604614
local_output_nid generation:  0.23931407928466797
local_in_edges_tensor generation:  0.4449896812438965
mini_batch_src_global generation:  0.6166951656341553
r_  generation:  6.053088903427124
local_output_nid generation:  0.243361234664917
local_in_edges_tensor generation:  0.4826984405517578
mini_batch_src_global generation:  0.6457929611206055
r_  generation:  6.276953220367432
local_output_nid generation:  0.27198004722595215
local_in_edges_tensor generation:  0.54899001121521
mini_batch_src_global generation:  0.7261238098144531
r_  generation:  7.378363132476807
----------------------check_connections_block total spend ----------------------------- 117.7876672744751
generate_one_block  8.713252544403076
generate_one_block  5.470200061798096
generate_one_block  3.0682570934295654
generate_one_block  5.784940481185913
generate_one_block  5.891024589538574
generate_one_block  6.57900857925415
generate_one_block  5.768141746520996
generate_one_block  4.556085586547852
generate_one_block  6.076448678970337
generate_one_block  7.651580810546875
generate_one_block  7.669115304946899
generate_one_block  8.356938362121582
generate_one_block  7.467320203781128
generate_one_block  7.495327472686768
generate_one_block  7.976244211196899
generate_one_block  9.390324831008911
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5428576469421387  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

connection checking time:  154.11501550674438
block generation total time  142.26955318450928
average batch blocks generation time:  2.9639490246772766
block dataloader generation time/epoch 382.6024892807007
pseudo mini batch 0 input nodes size: 1688490
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.365140438079834  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.365140438079834  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9941520690917969  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9942412376403809  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6343913078308105  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7815060615539551  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7815060615539551  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1688490
first layer output nodes number: 679128
edges number: 15007429
torch.Size([1688490, 100])
torch.Size([679128, 256])
input nodes number: 679128
output nodes number: 138970
edges number: 4277444
torch.Size([679128, 256])
torch.Size([138970, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 3.1106157302856445  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 3.1127052307128906  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9953055381774902  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 1 input nodes size: 1328047
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6342649459838867  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6342649459838867  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.1290011405944824  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.1290955543518066  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.49999475479125977  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6012253761291504  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6012253761291504  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1328047
first layer output nodes number: 483072
edges number: 10120993
torch.Size([1328047, 100])
torch.Size([483072, 256])
input nodes number: 483072
output nodes number: 113417
edges number: 3013489
torch.Size([483072, 256])
torch.Size([113417, 256])
torch.Size([12652, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.307328224182129  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.309575080871582  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7536659240722656  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 2 input nodes size: 934832
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5001215934753418  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5001215934753418  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8483738899230957  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8484644889831543  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.3536338806152344  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.4193992614746094  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.4193992614746094  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 934832
first layer output nodes number: 288222
edges number: 5788673
torch.Size([934832, 100])
torch.Size([288222, 256])
input nodes number: 288222
output nodes number: 91148
edges number: 2516706
torch.Size([288222, 256])
torch.Size([91148, 256])
torch.Size([12115, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.5206966400146484  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.5228185653686523  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5228018760681152  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 3 input nodes size: 1371843
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.35353994369506836  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.35353994369506836  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8645915985107422  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8646807670593262  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5163378715515137  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6256108283996582  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6256108283996582  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1371843
first layer output nodes number: 513751
edges number: 10821300
torch.Size([1371843, 100])
torch.Size([513751, 256])
input nodes number: 513751
output nodes number: 114710
edges number: 3373341
torch.Size([513751, 256])
torch.Size([114710, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.4201345443725586  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.4222235679626465  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7884926795959473  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 4 input nodes size: 1375858
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5172319412231445  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5172319412231445  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0297794342041016  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0298738479614258  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.518733024597168  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6311120986938477  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6311120986938477  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1375858
first layer output nodes number: 542050
edges number: 10813355
torch.Size([1375858, 100])
torch.Size([542050, 256])
input nodes number: 542050
output nodes number: 133522
edges number: 3796855
torch.Size([542050, 256])
torch.Size([133522, 256])
torch.Size([12653, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.5604052543640137  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.562621593475342  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.800206184387207  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 5 input nodes size: 1410104
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5179333686828613  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5179333686828613  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0432381629943848  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.043327808380127  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5306859016418457  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6438717842102051  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6438717842102051  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1410104
first layer output nodes number: 531581
edges number: 11483708
torch.Size([1410104, 100])
torch.Size([531581, 256])
input nodes number: 531581
output nodes number: 110460
edges number: 3246692
torch.Size([531581, 256])
torch.Size([110460, 256])
torch.Size([11988, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.4745407104492188  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.476757049560547  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8100247383117676  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 6 input nodes size: 1407343
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5309658050537109  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5309658050537109  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0552420616149902  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0553312301635742  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5299367904663086  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6383790969848633  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6383790969848633  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1407343
first layer output nodes number: 526256
edges number: 10733417
torch.Size([1407343, 100])
torch.Size([526256, 256])
input nodes number: 526256
output nodes number: 122027
edges number: 3375211
torch.Size([526256, 256])
torch.Size([122027, 256])
torch.Size([11936, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.4855880737304688  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.488060474395752  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7999515533447266  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 7 input nodes size: 1162842
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5295310020446777  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5295310020446777  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9627237319946289  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9628176689147949  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.43845224380493164  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5312161445617676  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5312161445617676  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1162842
first layer output nodes number: 439151
edges number: 8522002
torch.Size([1162842, 100])
torch.Size([439151, 256])
input nodes number: 439151
output nodes number: 124262
edges number: 3360421
torch.Size([439151, 256])
torch.Size([124262, 256])
torch.Size([12600, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.1494626998901367  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.1522655487060547  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6746606826782227  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 8 input nodes size: 1308597
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.4387812614440918  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.4387812614440918  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.926271915435791  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9263639450073242  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.49307727813720703  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6131534576416016  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6131534576416016  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1308597
first layer output nodes number: 503196
edges number: 11397745
torch.Size([1308597, 100])
torch.Size([503196, 256])
input nodes number: 503196
output nodes number: 132407
edges number: 4150710
torch.Size([503196, 256])
torch.Size([132407, 256])
torch.Size([12318, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.447242259979248  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.449399948120117  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7926058769226074  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 9 input nodes size: 1499681
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.4928154945373535  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.4928154945373535  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.051490306854248  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0515837669372559  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5640010833740234  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7017073631286621  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7017073631286621  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1499681
first layer output nodes number: 597662
edges number: 13499801
torch.Size([1499681, 100])
torch.Size([597662, 256])
input nodes number: 597662
output nodes number: 139474
edges number: 4412212
torch.Size([597662, 256])
torch.Size([139474, 256])
torch.Size([12536, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.8150205612182617  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.8176302909851074  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9023799896240234  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 10 input nodes size: 1419574
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5640392303466797  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5640392303466797  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.092872142791748  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0929651260375977  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5341968536376953  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6783857345581055  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6783857345581055  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1419574
first layer output nodes number: 619036
edges number: 14143888
torch.Size([1419574, 100])
torch.Size([619036, 256])
input nodes number: 619036
output nodes number: 140570
edges number: 4493443
torch.Size([619036, 256])
torch.Size([140570, 256])
torch.Size([12423, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.8549375534057617  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.8571133613586426  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8857011795043945  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 11 input nodes size: 1445641
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5341768264770508  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5341768264770508  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0727205276489258  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0728116035461426  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5438857078552246  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7012295722961426  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7012295722961426  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1445641
first layer output nodes number: 682766
edges number: 15497404
torch.Size([1445641, 100])
torch.Size([682766, 256])
input nodes number: 682766
output nodes number: 157960
edges number: 5036283
torch.Size([682766, 256])
torch.Size([157960, 256])
torch.Size([12205, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 3.108159065246582  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 3.110334873199463  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9302630424499512  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 12 input nodes size: 1450625
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.544196605682373  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.544196605682373  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0845966339111328  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.0846900939941406  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5460553169250488  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6902909278869629  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6902909278869629  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1450625
first layer output nodes number: 618696
edges number: 14147217
torch.Size([1450625, 100])
torch.Size([618696, 256])
input nodes number: 618696
output nodes number: 145384
edges number: 4703889
torch.Size([618696, 256])
torch.Size([145384, 256])
torch.Size([12518, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.883890151977539  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.886082649230957  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9016656875610352  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 13 input nodes size: 1511968
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5457611083984375  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5457611083984375  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.1090130805969238  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.1091070175170898  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5686135292053223  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7162580490112305  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7162580490112305  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1511968
first layer output nodes number: 626746
edges number: 14205142
torch.Size([1511968, 100])
torch.Size([626746, 256])
input nodes number: 626746
output nodes number: 154301
edges number: 4986160
torch.Size([626746, 256])
torch.Size([154301, 256])
torch.Size([12568, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.9612197875976562  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.9637675285339355  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9341964721679688  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 14 input nodes size: 1574821
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5686221122741699  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5686221122741699  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.1552886962890625  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.155378818511963  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5920329093933105  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7340569496154785  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.7340569496154785  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1574821
first layer output nodes number: 666811
edges number: 15145722
torch.Size([1574821, 100])
torch.Size([666811, 256])
input nodes number: 666811
output nodes number: 113813
edges number: 3509636
torch.Size([666811, 256])
torch.Size([113813, 256])
torch.Size([12040, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.950291156768799  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 2.952399730682373  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.9357199668884277  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

pseudo mini batch 15 input nodes size: 1687836
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5919404029846191  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.5919404029846191  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.2207083702087402  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 1.220799446105957  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.6340427398681641  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8030033111572266  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5838623046875 GB
    Memory Allocated: 0.8030033111572266  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

first layer input nodes number: 1687836
first layer output nodes number: 784779
edges number: 17475108
torch.Size([1687836, 100])
torch.Size([784779, 256])
input nodes number: 784779
output nodes number: 152871
edges number: 4726642
torch.Size([784779, 256])
torch.Size([152871, 256])
torch.Size([12165, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6405029296875 GB
    Memory Allocated: 3.467116355895996  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6405029296875 GB
    Memory Allocated: 3.4692468643188477  GigaBytes
Max Memory Allocated: 4.449411392211914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 1.0447821617126465  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 1.0447821617126465  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 1.0447821617126465  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2081557661294937 |0.11262305080890656 |0.04592236876487732 |0.0001373291015625 |0.008326992392539978 |0.003964900970458984 |
----------------------------------------------------------pseudo_mini_loss sum 3.3352315425872803
Total (block generation + training)time/epoch 389.02362928390505
Training time/epoch 6.102057456970215
Training time without block to device /epoch 4.30008864402771
Training time without total dataloading part /epoch 0.8741519451141357
load block tensor time/epoch 3.3304922580718994
block to device time/epoch 1.8019688129425049
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  33766301
Number of first layer input nodes during this epoch:  22578102
Number of first layer output nodes during this epoch:  9102903
----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 1.0447816848754883  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3457510471343994
global_2_local spend time (sec) 0.6386773586273193
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.03659534454345703
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1180968, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.12563753128051758
auxiliary_graph
Graph(num_nodes=1377539, num_edges=101778399,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6579735279083252
remove nodes length  1180968

auxiliary_graph.remove_nodes spent  5.6929240226745605
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101778399,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.311366558074951

the counter of shared neighbor distribution
Counter({1.0: 76534596, 2.0: 14039790, 3.0: 5006502, 4.0: 2312414, 5.0: 1247454, 6.0: 739086, 7.0: 470314, 8.0: 321348, 9.0: 224020, 10.0: 161382, 11.0: 118914, 12.0: 90378, 13.0: 69162, 14.0: 52818, 15.0: 41862, 16.0: 30822, 17.0: 21642, 18.0: 19400, 19.0: 13432, 20.0: 10984, 21.0: 7158, 22.0: 5670, 23.0: 5046, 24.0: 4118, 25.0: 3436, 28.0: 2922, 33.0: 2914, 26.0: 2610, 30.0: 2360, 27.0: 2328, 32.0: 2094, 39.0: 2088, 31.0: 2076, 29.0: 1772, 35.0: 1676, 37.0: 1662, 36.0: 1516, 34.0: 1496, 38.0: 1486, 40.0: 1080})
101581828
Convert a graph into a bidirected graph: 6.561 seconds
Metis partitioning: 29.507 seconds
Split the graph: 2.675 seconds
Construct subgraphs: 0.615 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  39.39684867858887
12500
11929
12475
12252
12464
12308
11927
11987
12178
12648
12598
12324
11931
12523
12140
12387
total k batches seeds list generation spend  68.69189739227295
after graph partition
graph partition algorithm spend time 69.5558454990387
12500
11929
12475
12252
12464
12308
11927
11987
12178
12648
12598
12324
11931
12523
12140
12387
partition_len_list
[93213, 110295, 106913, 149624, 144264, 118646, 143212, 146440, 143975, 130147, 154675, 127848, 138748, 122610, 109609, 134032]
REG selection method  spend 70.45403623580933
time for parepare:  0.27150654792785645
local_output_nid generation:  0.012145519256591797
local_in_edges_tensor generation:  0.005335807800292969
mini_batch_src_global generation:  0.016243934631347656
r_  generation:  0.13267207145690918
local_output_nid generation:  0.0043430328369140625
local_in_edges_tensor generation:  0.005033731460571289
mini_batch_src_global generation:  0.019646644592285156
r_  generation:  0.14226675033569336
local_output_nid generation:  0.004595279693603516
local_in_edges_tensor generation:  0.005091428756713867
mini_batch_src_global generation:  0.017427921295166016
r_  generation:  0.14039325714111328
local_output_nid generation:  0.004502058029174805
local_in_edges_tensor generation:  0.005252838134765625
mini_batch_src_global generation:  0.018458843231201172
r_  generation:  0.15935778617858887
local_output_nid generation:  0.004594564437866211
local_in_edges_tensor generation:  0.005446195602416992
mini_batch_src_global generation:  0.027210712432861328
r_  generation:  0.1742708683013916
local_output_nid generation:  0.004565238952636719
local_in_edges_tensor generation:  0.006797313690185547
mini_batch_src_global generation:  0.019489049911499023
r_  generation:  0.1644582748413086
local_output_nid generation:  0.004413127899169922
local_in_edges_tensor generation:  0.006009101867675781
mini_batch_src_global generation:  0.020357131958007812
r_  generation:  0.1703500747680664
local_output_nid generation:  0.0044400691986083984
local_in_edges_tensor generation:  0.00536799430847168
mini_batch_src_global generation:  0.021524906158447266
r_  generation:  0.17897868156433105
local_output_nid generation:  0.004549741744995117
local_in_edges_tensor generation:  0.006784677505493164
mini_batch_src_global generation:  0.021427392959594727
r_  generation:  0.1818561553955078
local_output_nid generation:  0.0047109127044677734
local_in_edges_tensor generation:  0.008449316024780273
mini_batch_src_global generation:  0.030176162719726562
r_  generation:  0.18131160736083984
local_output_nid generation:  0.004652738571166992
local_in_edges_tensor generation:  0.0054187774658203125
mini_batch_src_global generation:  0.021976947784423828
r_  generation:  0.18927669525146484
local_output_nid generation:  0.004569053649902344
local_in_edges_tensor generation:  0.005060434341430664
mini_batch_src_global generation:  0.020499467849731445
r_  generation:  0.15582871437072754
local_output_nid generation:  0.004423618316650391
local_in_edges_tensor generation:  0.005209445953369141
mini_batch_src_global generation:  0.019743919372558594
r_  generation:  0.1712486743927002
local_output_nid generation:  0.0046236515045166016
local_in_edges_tensor generation:  0.005331754684448242
mini_batch_src_global generation:  0.02195000648498535
r_  generation:  0.1757950782775879
local_output_nid generation:  0.004483699798583984
local_in_edges_tensor generation:  0.006038188934326172
mini_batch_src_global generation:  0.02053070068359375
r_  generation:  0.17986392974853516
local_output_nid generation:  0.004573345184326172
local_in_edges_tensor generation:  0.005323648452758789
mini_batch_src_global generation:  0.02273845672607422
r_  generation:  0.17611193656921387
----------------------check_connections_block total spend ----------------------------- 4.053720712661743
generate_one_block  0.35736942291259766
generate_one_block  0.31129908561706543
generate_one_block  0.2901623249053955
generate_one_block  0.32413578033447266
generate_one_block  0.30566906929016113
generate_one_block  0.2573256492614746
generate_one_block  0.23949360847473145
generate_one_block  0.2341465950012207
generate_one_block  0.25230836868286133
generate_one_block  0.23898029327392578
generate_one_block  0.24011492729187012
generate_one_block  0.20183157920837402
generate_one_block  0.22730469703674316
generate_one_block  0.22022390365600586
generate_one_block  0.20867562294006348
generate_one_block  0.2238025665283203
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2529916763305664
gen group dst list time:  0.06691741943359375
time for parepare:  0.44350314140319824
local_output_nid generation:  0.0246889591217041
local_in_edges_tensor generation:  0.1546940803527832
mini_batch_src_global generation:  0.09184122085571289
r_  generation:  0.7752864360809326
local_output_nid generation:  0.03342556953430176
local_in_edges_tensor generation:  0.060874223709106445
mini_batch_src_global generation:  0.13622093200683594
r_  generation:  1.0920038223266602
local_output_nid generation:  0.029497623443603516
local_in_edges_tensor generation:  0.04991459846496582
mini_batch_src_global generation:  0.11383938789367676
r_  generation:  0.9635810852050781
local_output_nid generation:  0.04206395149230957
local_in_edges_tensor generation:  0.06171298027038574
mini_batch_src_global generation:  0.1706833839416504
r_  generation:  1.752007246017456
local_output_nid generation:  0.04143977165222168
local_in_edges_tensor generation:  0.0724332332611084
mini_batch_src_global generation:  0.18637442588806152
r_  generation:  1.6335792541503906
local_output_nid generation:  0.03522801399230957
local_in_edges_tensor generation:  0.10594820976257324
mini_batch_src_global generation:  0.1535177230834961
r_  generation:  1.32517409324646
local_output_nid generation:  0.043211936950683594
local_in_edges_tensor generation:  0.07410430908203125
mini_batch_src_global generation:  0.19384169578552246
r_  generation:  1.643622636795044
local_output_nid generation:  0.044454097747802734
local_in_edges_tensor generation:  0.07668042182922363
mini_batch_src_global generation:  0.19354462623596191
r_  generation:  1.7449829578399658
local_output_nid generation:  0.042020320892333984
local_in_edges_tensor generation:  0.08169412612915039
mini_batch_src_global generation:  0.19208979606628418
r_  generation:  1.7532641887664795
local_output_nid generation:  0.048593759536743164
local_in_edges_tensor generation:  0.07834529876708984
mini_batch_src_global generation:  0.18610095977783203
r_  generation:  1.4995472431182861
local_output_nid generation:  0.044335126876831055
local_in_edges_tensor generation:  0.06489849090576172
mini_batch_src_global generation:  0.19518208503723145
r_  generation:  1.8798003196716309
local_output_nid generation:  0.035860538482666016
local_in_edges_tensor generation:  0.12848997116088867
mini_batch_src_global generation:  0.1715559959411621
r_  generation:  1.5031321048736572
local_output_nid generation:  0.040755271911621094
local_in_edges_tensor generation:  0.09959697723388672
mini_batch_src_global generation:  0.16159486770629883
r_  generation:  1.5170323848724365
local_output_nid generation:  0.03618311882019043
local_in_edges_tensor generation:  0.08840107917785645
mini_batch_src_global generation:  0.1555168628692627
r_  generation:  1.280994176864624
local_output_nid generation:  0.0333704948425293
local_in_edges_tensor generation:  0.07448768615722656
mini_batch_src_global generation:  0.1383686065673828
r_  generation:  1.190354347229004
local_output_nid generation:  0.03942513465881348
local_in_edges_tensor generation:  0.0876774787902832
mini_batch_src_global generation:  0.16266274452209473
r_  generation:  1.481919527053833
----------------------check_connections_block total spend ----------------------------- 32.395368576049805
generate_one_block  1.2774271965026855
generate_one_block  1.5537941455841064
generate_one_block  1.4699785709381104
generate_one_block  2.4032392501831055
generate_one_block  2.1664674282073975
generate_one_block  1.8685390949249268
generate_one_block  2.237528085708618
generate_one_block  2.236415147781372
generate_one_block  2.337907075881958
generate_one_block  1.9205970764160156
generate_one_block  2.3748857975006104
generate_one_block  1.8666212558746338
generate_one_block  1.883554458618164
generate_one_block  1.5279045104980469
generate_one_block  1.444840669631958
generate_one_block  1.806304931640625
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3704867362976074
gen group dst list time:  0.32032012939453125
time for parepare:  0.47828030586242676
local_output_nid generation:  0.09322524070739746
local_in_edges_tensor generation:  0.33145785331726074
mini_batch_src_global generation:  0.20450067520141602
r_  generation:  2.203887939453125
local_output_nid generation:  0.16328167915344238
local_in_edges_tensor generation:  0.3218071460723877
mini_batch_src_global generation:  0.395982027053833
r_  generation:  3.8331029415130615
local_output_nid generation:  0.1521449089050293
local_in_edges_tensor generation:  0.423004150390625
mini_batch_src_global generation:  0.4048149585723877
r_  generation:  3.9192910194396973
local_output_nid generation:  0.24247026443481445
local_in_edges_tensor generation:  0.5913386344909668
mini_batch_src_global generation:  0.637242317199707
r_  generation:  7.138786554336548
local_output_nid generation:  0.2438347339630127
local_in_edges_tensor generation:  0.4171266555786133
mini_batch_src_global generation:  0.5847659111022949
r_  generation:  5.36114239692688
local_output_nid generation:  0.18613338470458984
local_in_edges_tensor generation:  0.39646220207214355
mini_batch_src_global generation:  0.5237312316894531
r_  generation:  5.182114601135254
local_output_nid generation:  0.24138617515563965
local_in_edges_tensor generation:  0.5156118869781494
mini_batch_src_global generation:  0.6490535736083984
r_  generation:  6.497007369995117
local_output_nid generation:  0.21751928329467773
local_in_edges_tensor generation:  0.7724158763885498
mini_batch_src_global generation:  0.6488468647003174
r_  generation:  6.191328763961792
local_output_nid generation:  0.21298789978027344
local_in_edges_tensor generation:  0.4648299217224121
mini_batch_src_global generation:  0.6405220031738281
r_  generation:  5.798472881317139
local_output_nid generation:  0.2326366901397705
local_in_edges_tensor generation:  0.4153296947479248
mini_batch_src_global generation:  0.5754702091217041
r_  generation:  5.463872671127319
local_output_nid generation:  0.2506084442138672
local_in_edges_tensor generation:  0.530526876449585
mini_batch_src_global generation:  0.6845569610595703
r_  generation:  7.038482666015625
local_output_nid generation:  0.21147871017456055
local_in_edges_tensor generation:  0.43987298011779785
mini_batch_src_global generation:  0.6251277923583984
r_  generation:  5.77390718460083
local_output_nid generation:  0.21863102912902832
local_in_edges_tensor generation:  0.42900776863098145
mini_batch_src_global generation:  0.5779738426208496
r_  generation:  5.756527423858643
local_output_nid generation:  0.15259122848510742
local_in_edges_tensor generation:  0.3469672203063965
mini_batch_src_global generation:  0.43557024002075195
r_  generation:  3.730612277984619
local_output_nid generation:  0.17192387580871582
local_in_edges_tensor generation:  0.37991929054260254
mini_batch_src_global generation:  0.46329760551452637
r_  generation:  4.368319272994995
local_output_nid generation:  0.20369720458984375
local_in_edges_tensor generation:  0.474989652633667
mini_batch_src_global generation:  0.5273087024688721
r_  generation:  5.305825710296631
----------------------check_connections_block total spend ----------------------------- 118.5137894153595
generate_one_block  3.750253200531006
generate_one_block  5.349634885787964
generate_one_block  5.308191537857056
generate_one_block  8.944502115249634
generate_one_block  6.807086944580078
generate_one_block  6.9763054847717285
generate_one_block  8.373433828353882
generate_one_block  7.5913310050964355
generate_one_block  7.511667013168335
generate_one_block  6.989065647125244
generate_one_block  8.950149297714233
generate_one_block  7.403083324432373
generate_one_block  7.232618808746338
generate_one_block  4.7379961013793945
generate_one_block  5.533079385757446
generate_one_block  6.6609368324279785
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 1.0447816848754883  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

connection checking time:  154.96287870407104
block generation total time  142.62818360328674
average batch blocks generation time:  2.9714204917351403
block dataloader generation time/epoch 382.4231384197871
pseudo mini batch 0 input nodes size: 972234
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.6344709396362305  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.6344709396362305  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.9966564178466797  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.9967498779296875  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.3678908348083496  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.43495798110961914  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.43495798110961914  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 972234
first layer output nodes number: 296766
edges number: 5975321
torch.Size([972234, 100])
torch.Size([296766, 256])
input nodes number: 296766
output nodes number: 93213
edges number: 2572180
torch.Size([296766, 256])
torch.Size([93213, 256])
torch.Size([12500, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 1.5678658485412598  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 1.5700554847717285  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.5422172546386719  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 1 input nodes size: 1304103
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.36754322052001953  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.36754322052001953  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.8533596992492676  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.8534488677978516  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.49116992950439453  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.5922126770019531  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.5922126770019531  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1304103
first layer output nodes number: 470755
edges number: 9855473
torch.Size([1304103, 100])
torch.Size([470755, 256])
input nodes number: 470755
output nodes number: 110295
edges number: 3231391
torch.Size([470755, 256])
torch.Size([110295, 256])
torch.Size([11929, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 2.254284381866455  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 2.256373882293701  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.7436800003051758  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 2 input nodes size: 1301280
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.4910702705383301  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.4910702705383301  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.975834846496582  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.9759278297424316  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.4900221824645996  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.5866484642028809  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.5866484642028809  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1301280
first layer output nodes number: 463820
edges number: 9714120
torch.Size([1301280, 100])
torch.Size([463820, 256])
input nodes number: 463820
output nodes number: 106913
edges number: 2810209
torch.Size([463820, 256])
torch.Size([106913, 256])
torch.Size([12475, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 2.2188501358032227  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 2.2210350036621094  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.7312107086181641  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 3 input nodes size: 1679455
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.4904899597167969  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.4904899597167969  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 1.116136074066162  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 1.116227626800537  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.6313700675964355  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.7937498092651367  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 0.7937498092651367  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1679455
first layer output nodes number: 737745
edges number: 16574844
torch.Size([1679455, 100])
torch.Size([737745, 256])
input nodes number: 737745
output nodes number: 149624
edges number: 4730463
torch.Size([737745, 256])
torch.Size([149624, 256])
torch.Size([12252, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 3.3216981887817383  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.4080810546875 GB
    Memory Allocated: 3.3238439559936523  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.0278739929199219  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 4 input nodes size: 1349529
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6309585571289062  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6309585571289062  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.133697509765625  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.1337904930114746  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5080528259277344  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6435389518737793  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6435389518737793  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1349529
first layer output nodes number: 563867
edges number: 12867663
torch.Size([1349529, 100])
torch.Size([563867, 256])
input nodes number: 563867
output nodes number: 144264
edges number: 4607438
torch.Size([563867, 256])
torch.Size([144264, 256])
torch.Size([12464, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.682999610900879  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.685182571411133  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.8432407379150391  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 5 input nodes size: 1432161
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5080900192260742  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5080900192260742  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.041611671447754  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.041703701019287  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5388717651367188  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6586809158325195  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6586809158325195  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1432161
first layer output nodes number: 529130
edges number: 11884879
torch.Size([1432161, 100])
torch.Size([529130, 256])
input nodes number: 529130
output nodes number: 118646
edges number: 3672466
torch.Size([529130, 256])
torch.Size([118646, 256])
torch.Size([12308, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.515946865081787  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.5181026458740234  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.8355803489685059  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 6 input nodes size: 1507051
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5388445854187012  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5388445854187012  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.1002650260925293  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.1003541946411133  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5667405128479004  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.7225527763366699  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.7225527763366699  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1507051
first layer output nodes number: 688722
edges number: 15725573
torch.Size([1507051, 100])
torch.Size([688722, 256])
input nodes number: 688722
output nodes number: 143212
edges number: 4582917
torch.Size([688722, 256])
torch.Size([143212, 256])
torch.Size([11927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 3.0966739654541016  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 3.0987629890441895  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.9449672698974609  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 7 input nodes size: 1396680
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.566673755645752  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.566673755645752  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.0869779586791992  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.0870676040649414  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5255579948425293  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6704192161560059  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6704192161560059  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1396680
first layer output nodes number: 627414
edges number: 14251510
torch.Size([1396680, 100])
torch.Size([627414, 256])
input nodes number: 627414
output nodes number: 146440
edges number: 4651743
torch.Size([627414, 256])
torch.Size([146440, 256])
torch.Size([11987, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.888546943664551  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.891235828399658  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.8825201988220215  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 8 input nodes size: 1541891
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5255684852600098  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5255684852600098  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.0999679565429688  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.1000590324401855  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5796651840209961  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.7227096557617188  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.7227096557617188  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1541891
first layer output nodes number: 617049
edges number: 14000503
torch.Size([1541891, 100])
torch.Size([617049, 256])
input nodes number: 617049
output nodes number: 143975
edges number: 4666063
torch.Size([617049, 256])
torch.Size([143975, 256])
torch.Size([12178, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.9048757553100586  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.9070639610290527  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.9322099685668945  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 9 input nodes size: 1468303
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5796985626220703  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5796985626220703  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.1266841888427734  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.1267786026000977  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5522880554199219  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6829729080200195  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6829729080200195  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1468303
first layer output nodes number: 574123
edges number: 12903709
torch.Size([1468303, 100])
torch.Size([574123, 256])
input nodes number: 574123
output nodes number: 130147
edges number: 4059539
torch.Size([574123, 256])
torch.Size([130147, 256])
torch.Size([12648, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.7016515731811523  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.703866958618164  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.8741931915283203  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 10 input nodes size: 1623945
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.552370548248291  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.552370548248291  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.1573376655578613  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.1574316024780273  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6103515625  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.7734222412109375  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.7734222412109375  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1623945
first layer output nodes number: 735388
edges number: 16536935
torch.Size([1623945, 100])
torch.Size([735388, 256])
input nodes number: 735388
output nodes number: 154675
edges number: 4867589
torch.Size([735388, 256])
torch.Size([154675, 256])
torch.Size([12598, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 3.3117852210998535  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 3.313993453979492  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.0089550018310547  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 11 input nodes size: 1503931
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6103425025939941  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6103425025939941  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.1706008911132812  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.1706929206848145  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5656318664550781  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.7012028694152832  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.7012028694152832  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1503931
first layer output nodes number: 615025
edges number: 13746506
torch.Size([1503931, 100])
torch.Size([615025, 256])
input nodes number: 615025
output nodes number: 127848
edges number: 3944683
torch.Size([615025, 256])
torch.Size([127848, 256])
torch.Size([12324, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.8212356567382812  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.823394298553467  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.8974967002868652  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 12 input nodes size: 1588794
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5655841827392578  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5655841827392578  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.157456398010254  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.157545566558838  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5971951484680176  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.7266707420349121  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.7266707420349121  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1588794
first layer output nodes number: 641516
edges number: 13057822
torch.Size([1588794, 100])
torch.Size([641516, 256])
input nodes number: 641516
output nodes number: 138748
edges number: 3873402
torch.Size([641516, 256])
torch.Size([138748, 256])
torch.Size([11931, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.9431748390197754  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.945730209350586  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.9195613861083984  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 13 input nodes size: 1200116
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5971260070800781  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5971260070800781  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.0442042350769043  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.044297695159912  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.45233631134033203  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5461926460266113  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5461926460266113  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1200116
first layer output nodes number: 448723
edges number: 8765695
torch.Size([1200116, 100])
torch.Size([448723, 256])
input nodes number: 448723
output nodes number: 122610
edges number: 3322301
torch.Size([448723, 256])
torch.Size([122610, 256])
torch.Size([12523, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.1835474967956543  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.186336040496826  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6892433166503906  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 14 input nodes size: 1331540
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.4524402618408203  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.4524402618408203  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.9484777450561523  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.9485683441162109  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.501396656036377  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6043925285339355  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6043925285339355  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1331540
first layer output nodes number: 490738
edges number: 10244710
torch.Size([1331540, 100])
torch.Size([490738, 256])
input nodes number: 490738
output nodes number: 109609
edges number: 3121552
torch.Size([490738, 256])
torch.Size([109609, 256])
torch.Size([12140, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.3195009231567383  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.321627140045166  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.7587599754333496  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

pseudo mini batch 15 input nodes size: 1478076
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5021171569824219  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5021171569824219  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.0527434349060059  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 1.0528359413146973  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.5567078590393066  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6803231239318848  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.6803231239318848  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

first layer input nodes number: 1478076
first layer output nodes number: 593111
edges number: 12243045
torch.Size([1478076, 100])
torch.Size([593111, 256])
input nodes number: 593111
output nodes number: 134032
edges number: 3879696
torch.Size([593111, 256])
torch.Size([134032, 256])
torch.Size([12387, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.751221179962158  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 2.7533907890319824  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.8634839057922363  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.8634839057922363  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.8634839057922363  GigaBytes
Max Memory Allocated: 4.5179362297058105  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2081153839826584 |0.12666229903697968 |0.03997159004211426 |0.00013841688632965088 |0.005219578742980957 |0.0012676715850830078 |
----------------------------------------------------------pseudo_mini_loss sum 2.1964304447174072
Total (block generation + training)time/epoch 388.8045132954915
Training time/epoch 6.1823060512542725
Training time without block to device /epoch 4.155709266662598
Training time without total dataloading part /epoch 0.7265410423278809
load block tensor time/epoch 3.329846143722534
block to device time/epoch 2.026596784591675
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  33847232
Number of first layer input nodes during this epoch:  22679089
Number of first layer output nodes during this epoch:  9093892
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
