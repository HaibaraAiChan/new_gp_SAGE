main start at this time 1656622214.4423673
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3399085998535156
number of batches is  4
batch size is  49143
random selection method spend 0.018273353576660156
time for parepare:  0.28661489486694336
local_output_nid generation:  0.023934602737426758
local_in_edges_tensor generation:  0.04660344123840332
mini_batch_src_global generation:  0.0605013370513916
r_  generation:  0.8974463939666748
local_output_nid generation:  0.025798559188842773
local_in_edges_tensor generation:  0.04737544059753418
mini_batch_src_global generation:  0.07849693298339844
r_  generation:  0.9854497909545898
local_output_nid generation:  0.025443553924560547
local_in_edges_tensor generation:  0.03406119346618652
mini_batch_src_global generation:  0.0594480037689209
r_  generation:  0.994990348815918
local_output_nid generation:  0.027244091033935547
local_in_edges_tensor generation:  0.0359950065612793
mini_batch_src_global generation:  0.06888794898986816
r_  generation:  1.0907573699951172
----------------------check_connections_block total spend ----------------------------- 5.445255756378174
generate_one_block  2.145371913909912
generate_one_block  1.0829691886901855
generate_one_block  1.085008144378662
generate_one_block  1.0825722217559814
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.9962356090545654
gen group dst list time:  0.0904083251953125
time for parepare:  0.4434514045715332
local_output_nid generation:  0.24206185340881348
local_in_edges_tensor generation:  0.7579255104064941
mini_batch_src_global generation:  0.8236956596374512
r_  generation:  9.922427654266357
local_output_nid generation:  0.2529416084289551
local_in_edges_tensor generation:  0.6707024574279785
mini_batch_src_global generation:  1.0134367942810059
r_  generation:  10.363469362258911
local_output_nid generation:  0.25350213050842285
local_in_edges_tensor generation:  0.6744937896728516
mini_batch_src_global generation:  1.0151641368865967
r_  generation:  10.473155736923218
local_output_nid generation:  0.25009942054748535
local_in_edges_tensor generation:  0.8106143474578857
mini_batch_src_global generation:  1.0363373756408691
r_  generation:  10.615594387054443
----------------------check_connections_block total spend ----------------------------- 56.61930322647095
generate_one_block  14.187827348709106
generate_one_block  13.829195261001587
generate_one_block  13.93931531906128
generate_one_block  13.907241582870483
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.395350217819214
gen group dst list time:  0.2980201244354248
time for parepare:  0.47803235054016113
local_output_nid generation:  0.6285545825958252
local_in_edges_tensor generation:  1.4854600429534912
mini_batch_src_global generation:  1.2825191020965576
r_  generation:  16.76314640045166
local_output_nid generation:  0.6895885467529297
local_in_edges_tensor generation:  1.4539849758148193
mini_batch_src_global generation:  1.7585644721984863
r_  generation:  16.74474859237671
local_output_nid generation:  0.6763408184051514
local_in_edges_tensor generation:  1.5337586402893066
mini_batch_src_global generation:  1.6350431442260742
r_  generation:  16.79115104675293
local_output_nid generation:  0.6888506412506104
local_in_edges_tensor generation:  1.38031005859375
mini_batch_src_global generation:  1.699742078781128
r_  generation:  16.891728401184082
----------------------check_connections_block total spend ----------------------------- 94.71417927742004
generate_one_block  22.47855496406555
generate_one_block  21.135289907455444
generate_one_block  21.505335807800293
generate_one_block  21.154240608215332
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  151.333482503891
block generation total time  142.13700079917908
average batch blocks generation time:  35.53425019979477
block dataloader generation time/epoch 317.32452487945557
pseudo mini batch 0 input nodes size: 2222364
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8455810546875 GB
    Memory Allocated: 0.8288936614990234  GigaBytes
Max Memory Allocated: 0.8288936614990234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8455810546875 GB
    Memory Allocated: 0.8292598724365234  GigaBytes
Max Memory Allocated: 0.8292598724365234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8455810546875 GB
    Memory Allocated: 0.8292598724365234  GigaBytes
Max Memory Allocated: 0.8292598724365234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 1.316965103149414  GigaBytes
Max Memory Allocated: 1.316965103149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 1.316965103149414  GigaBytes
Max Memory Allocated: 1.316965103149414  GigaBytes

first layer input nodes number: 2222364
first layer output nodes number: 1923454
edges number: 38435926
torch.Size([2222364, 100])
torch.Size([1923454, 256])
input nodes number: 1923454
output nodes number: 809236
edges number: 25167367
torch.Size([1923454, 256])
torch.Size([809236, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3045654296875 GB
    Memory Allocated: 9.286322593688965  GigaBytes
Max Memory Allocated: 9.979301452636719  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3045654296875 GB
    Memory Allocated: 9.294928073883057  GigaBytes
Max Memory Allocated: 9.979301452636719  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.5252685546875 GB
    Memory Allocated: 2.0871729850769043  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

pseudo mini batch 1 input nodes size: 2223800
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.5252685546875 GB
    Memory Allocated: 0.8386340141296387  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.5252685546875 GB
    Memory Allocated: 0.8386340141296387  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.5252685546875 GB
    Memory Allocated: 1.6670641899108887  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.5252685546875 GB
    Memory Allocated: 1.6674304008483887  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.5252685546875 GB
    Memory Allocated: 0.8389391899108887  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.5252685546875 GB
    Memory Allocated: 1.3265748023986816  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5252685546875 GB
    Memory Allocated: 1.3265748023986816  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

first layer input nodes number: 2223800
first layer output nodes number: 1921028
edges number: 38392535
torch.Size([2223800, 100])
torch.Size([1921028, 256])
input nodes number: 1921028
output nodes number: 808859
edges number: 25197661
torch.Size([1921028, 256])
torch.Size([808859, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5252685546875 GB
    Memory Allocated: 9.279569625854492  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.5252685546875 GB
    Memory Allocated: 9.288174629211426  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 2.088820457458496  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

pseudo mini batch 2 input nodes size: 2222552
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 0.8389391899108887  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 0.8389391899108887  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 1.6669044494628906  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 1.6672706604003906  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 0.8384742736816406  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 1.3262958526611328  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 1.3262958526611328  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

first layer input nodes number: 2222552
first layer output nodes number: 1921581
edges number: 38418096
torch.Size([2222552, 100])
torch.Size([1921581, 256])
input nodes number: 1921581
output nodes number: 809122
edges number: 25198966
torch.Size([1921581, 256])
torch.Size([809122, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 9.28261423110962  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 9.291219234466553  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 2.088174343109131  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

pseudo mini batch 3 input nodes size: 2223281
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 0.8384742736816406  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 0.8384742736816406  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 1.6669044494628906  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 1.6672706604003906  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 0.8389391899108887  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 1.3270363807678223  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 1.3270363807678223  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

first layer input nodes number: 2223281
first layer output nodes number: 1923568
edges number: 38452504
torch.Size([2223281, 100])
torch.Size([1923568, 256])
input nodes number: 1923568
output nodes number: 809742
edges number: 25199256
torch.Size([1923568, 256])
torch.Size([809742, 256])
torch.Size([49142, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 9.290120601654053  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.3592529296875 GB
    Memory Allocated: 9.299150466918945  GigaBytes
Max Memory Allocated: 10.790587425231934  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1951904296875 GB
    Memory Allocated: 2.0891623497009277  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 2.0906996726989746  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 2.0906996726989746  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4692707061767578 |0.7276421785354614 |0.3160095810890198 |0.00018161535263061523 |0.09931021928787231 |0.0060083866119384766 |
----------------------------------------------------------pseudo_mini_loss sum 7.151483058929443
Total (block generation + training)time/epoch 323.9205734729767
Training time/epoch 6.595738887786865
Training time without block to device /epoch 3.6851701736450195
Training time without total dataloading part /epoch 1.6680140495300293
load block tensor time/epoch 1.8770828247070312
block to device time/epoch 2.9105687141418457
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  19818587
Number of first layer input nodes during this epoch:  8891997
Number of first layer output nodes during this epoch:  7689631
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 2.0906991958618164  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.45284509658813477
number of batches is  4
batch size is  49143
random selection method spend 0.012964725494384766
time for parepare:  0.28728580474853516
local_output_nid generation:  0.023162126541137695
local_in_edges_tensor generation:  0.06419110298156738
mini_batch_src_global generation:  0.061156272888183594
r_  generation:  0.8527958393096924
local_output_nid generation:  0.025251150131225586
local_in_edges_tensor generation:  0.04815220832824707
mini_batch_src_global generation:  0.07812881469726562
r_  generation:  0.9487752914428711
local_output_nid generation:  0.024881601333618164
local_in_edges_tensor generation:  0.02706623077392578
mini_batch_src_global generation:  0.060730934143066406
r_  generation:  0.9727392196655273
local_output_nid generation:  0.025321245193481445
local_in_edges_tensor generation:  0.034986019134521484
mini_batch_src_global generation:  0.06896615028381348
r_  generation:  1.0583343505859375
----------------------check_connections_block total spend ----------------------------- 5.3034210205078125
generate_one_block  1.0973773002624512
generate_one_block  1.1334459781646729
generate_one_block  1.1025104522705078
generate_one_block  1.0963525772094727
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0498485565185547
gen group dst list time:  0.09586787223815918
time for parepare:  0.4393749237060547
local_output_nid generation:  0.2508871555328369
local_in_edges_tensor generation:  0.7774546146392822
mini_batch_src_global generation:  0.8192012310028076
r_  generation:  9.992430925369263
local_output_nid generation:  0.2564859390258789
local_in_edges_tensor generation:  0.684208869934082
mini_batch_src_global generation:  1.007439374923706
r_  generation:  10.423919916152954
local_output_nid generation:  0.25614500045776367
local_in_edges_tensor generation:  0.6875574588775635
mini_batch_src_global generation:  1.0361223220825195
r_  generation:  10.49563193321228
local_output_nid generation:  0.26108527183532715
local_in_edges_tensor generation:  0.9930622577667236
mini_batch_src_global generation:  1.056272029876709
r_  generation:  10.685623407363892
----------------------check_connections_block total spend ----------------------------- 57.204665422439575
generate_one_block  14.272613286972046
generate_one_block  13.93998098373413
generate_one_block  13.8212308883667
generate_one_block  14.371773958206177
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.4026272296905518
gen group dst list time:  0.28627943992614746
time for parepare:  0.4750242233276367
local_output_nid generation:  0.608522891998291
local_in_edges_tensor generation:  1.4096884727478027
mini_batch_src_global generation:  1.2672219276428223
r_  generation:  16.05457043647766
local_output_nid generation:  0.6141657829284668
local_in_edges_tensor generation:  1.2726740837097168
mini_batch_src_global generation:  1.6497888565063477
r_  generation:  16.522553205490112
local_output_nid generation:  0.6219007968902588
local_in_edges_tensor generation:  1.2726702690124512
mini_batch_src_global generation:  1.610889196395874
r_  generation:  16.706377744674683
local_output_nid generation:  0.6233115196228027
local_in_edges_tensor generation:  1.2789759635925293
mini_batch_src_global generation:  1.613386631011963
r_  generation:  16.644861698150635
----------------------check_connections_block total spend ----------------------------- 92.00075364112854
generate_one_block  22.344706058502197
generate_one_block  21.231579542160034
generate_one_block  21.130322694778442
generate_one_block  21.19301724433899
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 2.0906991958618164  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

connection checking time:  149.20541906356812
block generation total time  142.30522465705872
average batch blocks generation time:  35.57630616426468
block dataloader generation time/epoch 315.9013066291809
pseudo mini batch 0 input nodes size: 2223156
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 0.8404755592346191  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 0.8404755592346191  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 1.668665885925293  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 1.669032096862793  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 0.840235710144043  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 1.327371597290039  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 1.327371597290039  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

first layer input nodes number: 2223156
first layer output nodes number: 1920817
edges number: 38410802
torch.Size([2223156, 100])
torch.Size([1920817, 256])
input nodes number: 1920817
output nodes number: 806752
edges number: 25117379
torch.Size([1920817, 256])
torch.Size([806752, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 9.273097038269043  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 9.281702518463135  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 2.0878849029541016  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

pseudo mini batch 1 input nodes size: 2224281
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 0.8402366638183594  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 0.8402366638183594  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 1.6688461303710938  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 1.6692123413085938  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 0.8406558036804199  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 1.3287405967712402  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1971435546875 GB
    Memory Allocated: 1.3287405967712402  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

first layer input nodes number: 2224281
first layer output nodes number: 1922680
edges number: 38407542
torch.Size([2224281, 100])
torch.Size([1922680, 256])
input nodes number: 1922680
output nodes number: 811218
edges number: 25242080
torch.Size([1922680, 256])
torch.Size([811218, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.293337345123291  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.301942348480225  GigaBytes
Max Memory Allocated: 10.795798301696777  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.091179847717285  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

pseudo mini batch 2 input nodes size: 2223481
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8406558036804199  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8406558036804199  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6689672470092773  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6693334579467773  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.840357780456543  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3286800384521484  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3286800384521484  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

first layer input nodes number: 2223481
first layer output nodes number: 1924563
edges number: 38478890
torch.Size([2223481, 100])
torch.Size([1924563, 256])
input nodes number: 1924563
output nodes number: 809730
edges number: 25202933
torch.Size([1924563, 256])
torch.Size([809730, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.29471492767334  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.303755283355713  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.091228485107422  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

pseudo mini batch 3 input nodes size: 2222921
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.840357780456543  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.840357780456543  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.668482780456543  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.668848991394043  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8401713371276855  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3282675743103027  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3282675743103027  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

first layer input nodes number: 2222921
first layer output nodes number: 1923730
edges number: 38411152
torch.Size([2222921, 100])
torch.Size([1923730, 256])
input nodes number: 1923730
output nodes number: 810800
edges number: 25242509
torch.Size([1923730, 256])
torch.Size([810800, 256])
torch.Size([49142, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.29477596282959  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.304140567779541  GigaBytes
Max Memory Allocated: 10.80244779586792  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.0904483795166016  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.0904483795166016  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.0904483795166016  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.43580639362335205 |0.5731450915336609 |0.1304377317428589 |0.0001481771469116211 |0.05747056007385254 |0.0011806488037109375 |
----------------------------------------------------------pseudo_mini_loss sum 12.461009979248047
Total (block generation + training)time/epoch 321.7614371776581
Training time/epoch 5.123936891555786
Training time without block to device /epoch 2.8313565254211426
Training time without total dataloading part /epoch 0.7534065246582031
load block tensor time/epoch 1.7432255744934082
block to device time/epoch 2.2925803661346436
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  19824129
Number of first layer input nodes during this epoch:  8893839
Number of first layer output nodes during this epoch:  7691790
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.0904479026794434  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4216890335083008
number of batches is  4
batch size is  49143
random selection method spend 0.0165865421295166
time for parepare:  0.30286550521850586
local_output_nid generation:  0.024545669555664062
local_in_edges_tensor generation:  0.058359622955322266
mini_batch_src_global generation:  0.06398725509643555
r_  generation:  0.8752942085266113
local_output_nid generation:  0.028592824935913086
local_in_edges_tensor generation:  0.03491067886352539
mini_batch_src_global generation:  0.08264303207397461
r_  generation:  0.940070629119873
local_output_nid generation:  0.0264739990234375
local_in_edges_tensor generation:  0.02348184585571289
mini_batch_src_global generation:  0.06310653686523438
r_  generation:  0.9640834331512451
local_output_nid generation:  0.02609419822692871
local_in_edges_tensor generation:  0.025849342346191406
mini_batch_src_global generation:  0.07184195518493652
r_  generation:  1.0520353317260742
----------------------check_connections_block total spend ----------------------------- 5.342929840087891
generate_one_block  1.5375375747680664
generate_one_block  1.0839755535125732
generate_one_block  1.0682051181793213
generate_one_block  1.0747032165527344
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.042686939239502
gen group dst list time:  0.10242867469787598
time for parepare:  0.39910268783569336
local_output_nid generation:  0.255277156829834
local_in_edges_tensor generation:  0.7954456806182861
mini_batch_src_global generation:  0.8304970264434814
r_  generation:  9.875573873519897
local_output_nid generation:  0.26389598846435547
local_in_edges_tensor generation:  0.6776230335235596
mini_batch_src_global generation:  1.0324959754943848
r_  generation:  10.137234449386597
local_output_nid generation:  0.2539536952972412
local_in_edges_tensor generation:  0.6836490631103516
mini_batch_src_global generation:  1.0241386890411377
r_  generation:  10.477785587310791
local_output_nid generation:  0.2547783851623535
local_in_edges_tensor generation:  0.6799628734588623
mini_batch_src_global generation:  1.0449085235595703
r_  generation:  10.698235988616943
----------------------check_connections_block total spend ----------------------------- 56.41712474822998
generate_one_block  14.202948093414307
generate_one_block  13.815900564193726
generate_one_block  13.64061164855957
generate_one_block  13.644509315490723
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3797905445098877
gen group dst list time:  0.27614760398864746
time for parepare:  0.4161965847015381
local_output_nid generation:  0.6264228820800781
local_in_edges_tensor generation:  1.4591906070709229
mini_batch_src_global generation:  1.2762110233306885
r_  generation:  16.367347717285156
local_output_nid generation:  0.6904768943786621
local_in_edges_tensor generation:  1.4616823196411133
mini_batch_src_global generation:  1.5908122062683105
r_  generation:  16.43660020828247
local_output_nid generation:  0.639625072479248
local_in_edges_tensor generation:  1.3812410831451416
mini_batch_src_global generation:  1.661191463470459
r_  generation:  17.109569787979126
local_output_nid generation:  0.6748456954956055
local_in_edges_tensor generation:  1.4617893695831299
mini_batch_src_global generation:  1.6251749992370605
r_  generation:  16.585238456726074
----------------------check_connections_block total spend ----------------------------- 93.26450514793396
generate_one_block  21.67436671257019
generate_one_block  21.410932540893555
generate_one_block  21.550416707992554
generate_one_block  21.205931186676025
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.0904479026794434  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

connection checking time:  149.68162989616394
block generation total time  141.14561676979065
average batch blocks generation time:  35.28640419244766
block dataloader generation time/epoch 315.3555845419566
pseudo mini batch 0 input nodes size: 2222169
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8401703834533691  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8401703834533691  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6679930686950684  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6683592796325684  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8398680686950684  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3276686668395996  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3276686668395996  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

first layer input nodes number: 2222169
first layer output nodes number: 1921831
edges number: 38433516
torch.Size([2222169, 100])
torch.Size([1921831, 256])
input nodes number: 1921831
output nodes number: 808598
edges number: 25180018
torch.Size([1921831, 256])
torch.Size([808598, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.281777381896973  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.290382862091064  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.0896248817443848  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

pseudo mini batch 1 input nodes size: 2224049
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8398690223693848  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8398690223693848  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6683921813964844  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6687583923339844  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8405694961547852  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3292818069458008  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3292818069458008  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

first layer input nodes number: 2224049
first layer output nodes number: 1924036
edges number: 38433922
torch.Size([2224049, 100])
torch.Size([1924036, 256])
input nodes number: 1924036
output nodes number: 808784
edges number: 25185631
torch.Size([1924036, 256])
torch.Size([808784, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.289544105529785  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.298149108886719  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.091169834136963  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

pseudo mini batch 2 input nodes size: 2222175
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8405694961547852  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8405694961547852  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6686944961547852  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6690607070922852  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8401713371276855  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3276762962341309  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3276762962341309  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

first layer input nodes number: 2222175
first layer output nodes number: 1920082
edges number: 38363632
torch.Size([2222175, 100])
torch.Size([1920082, 256])
input nodes number: 1920082
output nodes number: 810004
edges number: 25211820
torch.Size([1920082, 256])
torch.Size([810004, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.283222198486328  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.291827201843262  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.089395523071289  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

pseudo mini batch 3 input nodes size: 2224447
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8401713371276855  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8401713371276855  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6688427925109863  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6692090034484863  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8407177925109863  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3289237022399902  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3289237022399902  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

first layer input nodes number: 2224447
first layer output nodes number: 1925020
edges number: 38466409
torch.Size([2224447, 100])
torch.Size([1925020, 256])
input nodes number: 1925020
output nodes number: 810000
edges number: 25201560
torch.Size([1925020, 256])
torch.Size([810000, 256])
torch.Size([49142, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.296818256378174  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.305423259735107  GigaBytes
Max Memory Allocated: 10.803004741668701  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.0914363861083984  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.0914363861083984  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.0914363861083984  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.47199469804763794 |0.48876380920410156 |0.12471753358840942 |0.00015181303024291992 |0.0595095157623291 |0.0037789344787597656 |
----------------------------------------------------------pseudo_mini_loss sum 3.638749599456787
Total (block generation + training)time/epoch 320.8479600747426
Training time/epoch 4.756640195846558
Training time without block to device /epoch 2.8015849590301514
Training time without total dataloading part /epoch 0.7412943840026855
load block tensor time/epoch 1.8879787921905518
block to device time/epoch 1.9550552368164062
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  19821195
Number of first layer input nodes during this epoch:  8892840
Number of first layer output nodes during this epoch:  7690969
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.0914359092712402  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3589653968811035
number of batches is  4
batch size is  49143
random selection method spend 0.014317035675048828
time for parepare:  0.26813673973083496
local_output_nid generation:  0.023358583450317383
local_in_edges_tensor generation:  0.05434226989746094
mini_batch_src_global generation:  0.06755542755126953
r_  generation:  0.8656208515167236
local_output_nid generation:  0.025333881378173828
local_in_edges_tensor generation:  0.03278088569641113
mini_batch_src_global generation:  0.08597540855407715
r_  generation:  0.9386336803436279
local_output_nid generation:  0.025811195373535156
local_in_edges_tensor generation:  0.025884389877319336
mini_batch_src_global generation:  0.06269669532775879
r_  generation:  0.9615728855133057
local_output_nid generation:  0.025566577911376953
local_in_edges_tensor generation:  0.025716066360473633
mini_batch_src_global generation:  0.07178163528442383
r_  generation:  1.1004936695098877
----------------------check_connections_block total spend ----------------------------- 5.313415288925171
generate_one_block  1.5409836769104004
generate_one_block  1.0702970027923584
generate_one_block  1.055976152420044
generate_one_block  1.061432123184204
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.209991216659546
gen group dst list time:  0.0967855453491211
time for parepare:  0.40958499908447266
local_output_nid generation:  0.25643110275268555
local_in_edges_tensor generation:  0.7881255149841309
mini_batch_src_global generation:  0.837550163269043
r_  generation:  9.978261947631836
local_output_nid generation:  0.2697727680206299
local_in_edges_tensor generation:  0.6734423637390137
mini_batch_src_global generation:  1.05269193649292
r_  generation:  10.488801956176758
local_output_nid generation:  0.26091742515563965
local_in_edges_tensor generation:  0.6799890995025635
mini_batch_src_global generation:  1.0543808937072754
r_  generation:  10.654455423355103
local_output_nid generation:  0.287477970123291
local_in_edges_tensor generation:  0.9923336505889893
mini_batch_src_global generation:  1.0466210842132568
r_  generation:  10.513329029083252
----------------------check_connections_block total spend ----------------------------- 57.4332115650177
generate_one_block  14.217135190963745
generate_one_block  13.847969055175781
generate_one_block  14.23988938331604
generate_one_block  13.60946536064148
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.356781005859375
gen group dst list time:  0.285400390625
time for parepare:  0.4588172435760498
local_output_nid generation:  0.6137135028839111
local_in_edges_tensor generation:  1.4061880111694336
mini_batch_src_global generation:  1.2613284587860107
r_  generation:  15.96432113647461
local_output_nid generation:  0.6326653957366943
local_in_edges_tensor generation:  1.2813093662261963
mini_batch_src_global generation:  1.6014773845672607
r_  generation:  16.20352053642273
local_output_nid generation:  0.6134190559387207
local_in_edges_tensor generation:  1.2845048904418945
mini_batch_src_global generation:  1.5768733024597168
r_  generation:  16.38141393661499
local_output_nid generation:  0.6167812347412109
local_in_edges_tensor generation:  1.2741520404815674
mini_batch_src_global generation:  1.572843313217163
r_  generation:  16.50569725036621
----------------------check_connections_block total spend ----------------------------- 90.76185441017151
generate_one_block  20.87163281440735
generate_one_block  21.393370866775513
generate_one_block  21.614831924438477
generate_one_block  20.865000247955322
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.0914359092712402  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

connection checking time:  148.1950659751892
block generation total time  140.6592948436737
average batch blocks generation time:  35.16482371091843
block dataloader generation time/epoch 314.5458197593689
pseudo mini batch 0 input nodes size: 2223106
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8415584564208984  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8415584564208984  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6697301864624023  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6700963973999023  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8410587310791016  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3293132781982422  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3293132781982422  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

first layer input nodes number: 2223106
first layer output nodes number: 1924371
edges number: 38445641
torch.Size([2223106, 100])
torch.Size([1924371, 256])
input nodes number: 1924371
output nodes number: 810890
edges number: 25229535
torch.Size([1924371, 256])
torch.Size([810890, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.29792833328247  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.306533813476562  GigaBytes
Max Memory Allocated: 10.803938865661621  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.091215133666992  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

pseudo mini batch 1 input nodes size: 2222393
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8402180671691895  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8402180671691895  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6688895225524902  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6692557334899902  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8407177925109863  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3289341926574707  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.3289341926574707  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

first layer input nodes number: 2222393
first layer output nodes number: 1923246
edges number: 38402250
torch.Size([2222393, 100])
torch.Size([1923246, 256])
input nodes number: 1923246
output nodes number: 811598
edges number: 25264676
torch.Size([1923246, 256])
torch.Size([811598, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.296599864959717  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 9.30520486831665  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 2.0910720825195312  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

pseudo mini batch 2 input nodes size: 2225886
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8407177925109863  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8407177925109863  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6699252128601074  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.6702914237976074  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 0.8412537574768066  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.329622745513916  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 1.329622745513916  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

first layer input nodes number: 2225886
first layer output nodes number: 1926621
edges number: 38479806
torch.Size([2225886, 100])
torch.Size([1926621, 256])
input nodes number: 1926621
output nodes number: 809874
edges number: 25210804
torch.Size([1926621, 256])
torch.Size([809874, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6971435546875 GB
    Memory Allocated: 9.301372528076172  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.6971435546875 GB
    Memory Allocated: 9.309977531433105  GigaBytes
Max Memory Allocated: 10.806725978851318  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 2.091564178466797  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

pseudo mini batch 3 input nodes size: 2222599
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 0.8412537574768066  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 0.8412537574768066  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.6699252128601074  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.6702914237976074  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 0.8407177925109863  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.3276352882385254  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.3276352882385254  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

first layer input nodes number: 2222599
first layer output nodes number: 1920177
edges number: 38399593
torch.Size([2222599, 100])
torch.Size([1920177, 256])
input nodes number: 1920177
output nodes number: 806229
edges number: 25096878
torch.Size([1920177, 256])
torch.Size([806229, 256])
torch.Size([49142, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 9.269824981689453  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 9.278429985046387  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 2.088372230529785  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 2.088372230529785  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 2.088372230529785  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.45356565713882446 |0.5848746299743652 |0.2118593454360962 |0.00020164251327514648 |0.057854533195495605 |0.0012028217315673828 |
----------------------------------------------------------pseudo_mini_loss sum 4.487483978271484
Total (block generation + training)time/epoch 320.0578764677048
Training time/epoch 5.570808172225952
Training time without block to device /epoch 3.231309652328491
Training time without total dataloading part /epoch 1.0808649063110352
load block tensor time/epoch 1.8142626285552979
block to device time/epoch 2.339498519897461
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  19826990
Number of first layer input nodes during this epoch:  8893984
Number of first layer output nodes during this epoch:  7694415
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 2.088371753692627  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.36401820182800293
number of batches is  4
batch size is  49143
random selection method spend 0.0169527530670166
time for parepare:  0.2808856964111328
local_output_nid generation:  0.024076461791992188
local_in_edges_tensor generation:  0.055613040924072266
mini_batch_src_global generation:  0.06726217269897461
r_  generation:  0.8610730171203613
local_output_nid generation:  0.025583982467651367
local_in_edges_tensor generation:  0.030095338821411133
mini_batch_src_global generation:  0.07943534851074219
r_  generation:  0.9326162338256836
local_output_nid generation:  0.02537846565246582
local_in_edges_tensor generation:  0.029093027114868164
mini_batch_src_global generation:  0.059354305267333984
r_  generation:  0.950913667678833
local_output_nid generation:  0.02577042579650879
local_in_edges_tensor generation:  0.02890753746032715
mini_batch_src_global generation:  0.07285785675048828
r_  generation:  1.0383038520812988
----------------------check_connections_block total spend ----------------------------- 5.240312576293945
generate_one_block  1.0717651844024658
generate_one_block  1.058872938156128
generate_one_block  1.0647883415222168
generate_one_block  1.0718638896942139
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0056755542755127
gen group dst list time:  0.09523367881774902
time for parepare:  0.42620038986206055
local_output_nid generation:  0.2582244873046875
local_in_edges_tensor generation:  0.8010339736938477
mini_batch_src_global generation:  0.8443429470062256
r_  generation:  9.975683450698853
local_output_nid generation:  0.2590796947479248
local_in_edges_tensor generation:  0.6719245910644531
mini_batch_src_global generation:  1.0428054332733154
r_  generation:  10.278274774551392
local_output_nid generation:  0.2598428726196289
local_in_edges_tensor generation:  0.6843905448913574
mini_batch_src_global generation:  1.0360140800476074
r_  generation:  10.477960586547852
local_output_nid generation:  0.25961828231811523
local_in_edges_tensor generation:  0.6822888851165771
mini_batch_src_global generation:  1.0553126335144043
r_  generation:  10.749508142471313
----------------------check_connections_block total spend ----------------------------- 56.78618884086609
generate_one_block  14.123903751373291
generate_one_block  14.131353855133057
generate_one_block  13.93024230003357
generate_one_block  13.986502408981323
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3787684440612793
gen group dst list time:  0.28491783142089844
time for parepare:  0.42375636100769043
local_output_nid generation:  0.6162567138671875
local_in_edges_tensor generation:  1.2899775505065918
mini_batch_src_global generation:  1.303210973739624
r_  generation:  17.99328327178955
local_output_nid generation:  0.6498689651489258
local_in_edges_tensor generation:  1.1591041088104248
mini_batch_src_global generation:  1.8264009952545166
r_  generation:  17.169596433639526
local_output_nid generation:  0.6357681751251221
local_in_edges_tensor generation:  1.319495439529419
mini_batch_src_global generation:  1.6318180561065674
r_  generation:  16.77292275428772
local_output_nid generation:  0.6800942420959473
local_in_edges_tensor generation:  1.2926666736602783
mini_batch_src_global generation:  1.6140031814575195
r_  generation:  16.627198696136475
----------------------check_connections_block total spend ----------------------------- 94.96989393234253
generate_one_block  21.569833278656006
generate_one_block  21.335394382476807
generate_one_block  21.883937120437622
generate_one_block  20.91823387145996
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 2.088371753692627  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

connection checking time:  151.75608277320862
block generation total time  141.87940096855164
average batch blocks generation time:  35.46985024213791
block dataloader generation time/epoch 314.9081645011902
pseudo mini batch 0 input nodes size: 2224106
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 0.8407168388366699  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 0.8407168388366699  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.6692609786987305  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.6696271896362305  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 0.8405895233154297  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.3278350830078125  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.3278350830078125  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

first layer input nodes number: 2224106
first layer output nodes number: 1921492
edges number: 38394347
torch.Size([2224106, 100])
torch.Size([1921492, 256])
input nodes number: 1921492
output nodes number: 807779
edges number: 25145194
torch.Size([1921492, 256])
torch.Size([807779, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 9.27857780456543  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 9.287183284759521  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 2.0889177322387695  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

pseudo mini batch 1 input nodes size: 2221789
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 0.8405904769897461  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 0.8405904769897461  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.668271541595459  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.668637752532959  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 0.8397274017333984  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.326918601989746  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.326918601989746  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

first layer input nodes number: 2221789
first layer output nodes number: 1921754
edges number: 38381873
torch.Size([2221789, 100])
torch.Size([1921754, 256])
input nodes number: 1921754
output nodes number: 808539
edges number: 25150610
torch.Size([1921754, 256])
torch.Size([808539, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 9.280853271484375  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 9.289458274841309  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 2.088747501373291  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

pseudo mini batch 2 input nodes size: 2224340
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 0.8397274017333984  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 0.8397274017333984  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.6683588027954102  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.6687250137329102  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 0.8406777381896973  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.329357624053955  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 1.329357624053955  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

first layer input nodes number: 2224340
first layer output nodes number: 1926322
edges number: 38494260
torch.Size([2224340, 100])
torch.Size([1926322, 256])
input nodes number: 1926322
output nodes number: 811073
edges number: 25237740
torch.Size([1926322, 256])
torch.Size([811073, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 9.304952621459961  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.3104248046875 GB
    Memory Allocated: 9.313912868499756  GigaBytes
Max Memory Allocated: 10.807284355163574  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 2.092376708984375  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

pseudo mini batch 3 input nodes size: 2222989
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.8406777381896973  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.8406777381896973  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.6688060760498047  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.6691722869873047  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.840174674987793  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.3284187316894531  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.3284187316894531  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

first layer input nodes number: 2222989
first layer output nodes number: 1924601
edges number: 38456803
torch.Size([2222989, 100])
torch.Size([1924601, 256])
input nodes number: 1924601
output nodes number: 809356
edges number: 25215176
torch.Size([1924601, 256])
torch.Size([809356, 256])
torch.Size([49142, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 9.292239665985107  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 9.300844669342041  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 2.090923309326172  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 2.090923309326172  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 2.090923309326172  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4837360382080078 |0.5320773124694824 |0.12752068042755127 |0.00015282630920410156 |0.007512331008911133 |0.0012001991271972656 |
----------------------------------------------------------pseudo_mini_loss sum 3.3668766021728516
Total (block generation + training)time/epoch 320.30569114685056
Training time/epoch 4.939166784286499
Training time without block to device /epoch 2.8108575344085693
Training time without total dataloading part /epoch 0.5419435501098633
load block tensor time/epoch 1.9349441528320312
block to device time/epoch 2.1283092498779297
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  19824140
Number of first layer input nodes during this epoch:  8893224
Number of first layer output nodes during this epoch:  7694169
----------------------------------------before generate dataloader block 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 2.0909228324890137  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3632996082305908
number of batches is  4
batch size is  49143
random selection method spend 0.014170646667480469
time for parepare:  0.2787327766418457
local_output_nid generation:  0.02331089973449707
local_in_edges_tensor generation:  0.05581474304199219
mini_batch_src_global generation:  0.06691145896911621
r_  generation:  0.8620803356170654
local_output_nid generation:  0.025357723236083984
local_in_edges_tensor generation:  0.03529024124145508
mini_batch_src_global generation:  0.08325958251953125
r_  generation:  0.9195420742034912
local_output_nid generation:  0.025090456008911133
local_in_edges_tensor generation:  0.024659156799316406
mini_batch_src_global generation:  0.06094956398010254
r_  generation:  0.958186149597168
local_output_nid generation:  0.02541208267211914
local_in_edges_tensor generation:  0.0271756649017334
mini_batch_src_global generation:  0.0701448917388916
r_  generation:  1.0404582023620605
----------------------check_connections_block total spend ----------------------------- 5.2290027141571045
generate_one_block  1.0841126441955566
generate_one_block  1.0571234226226807
generate_one_block  1.070037841796875
generate_one_block  1.2316703796386719
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.215289354324341
gen group dst list time:  0.0967257022857666
time for parepare:  0.4069802761077881
local_output_nid generation:  0.259185791015625
local_in_edges_tensor generation:  0.7741570472717285
mini_batch_src_global generation:  0.8399815559387207
r_  generation:  10.26469349861145
local_output_nid generation:  0.2864859104156494
local_in_edges_tensor generation:  0.9632668495178223
mini_batch_src_global generation:  1.043668508529663
r_  generation:  10.153928995132446
local_output_nid generation:  0.2619011402130127
local_in_edges_tensor generation:  0.6615092754364014
mini_batch_src_global generation:  1.0357882976531982
r_  generation:  10.358323097229004
local_output_nid generation:  0.2746560573577881
local_in_edges_tensor generation:  0.6582667827606201
mini_batch_src_global generation:  1.0495996475219727
r_  generation:  10.511251449584961
----------------------check_connections_block total spend ----------------------------- 56.950716972351074
generate_one_block  14.261991262435913
generate_one_block  13.907406568527222
generate_one_block  13.593112230300903
generate_one_block  13.61816692352295
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.44003963470459
gen group dst list time:  0.30350399017333984
time for parepare:  0.4347352981567383
local_output_nid generation:  0.6303184032440186
local_in_edges_tensor generation:  1.4350817203521729
mini_batch_src_global generation:  1.3186426162719727
r_  generation:  19.17661476135254
local_output_nid generation:  0.6625382900238037
local_in_edges_tensor generation:  1.5290782451629639
mini_batch_src_global generation:  1.705354928970337
r_  generation:  16.210139513015747
local_output_nid generation:  0.6571977138519287
local_in_edges_tensor generation:  1.2336149215698242
mini_batch_src_global generation:  1.634427785873413
r_  generation:  16.633521795272827
local_output_nid generation:  0.6447124481201172
local_in_edges_tensor generation:  1.302037239074707
mini_batch_src_global generation:  1.675455093383789
r_  generation:  16.432290077209473
----------------------check_connections_block total spend ----------------------------- 95.43083047866821
generate_one_block  21.354299306869507
generate_one_block  20.874897480010986
generate_one_block  21.661890745162964
generate_one_block  20.889578342437744
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 2.0909228324890137  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

connection checking time:  152.3815474510193
block generation total time  140.1613428592682
average batch blocks generation time:  35.04033571481705
block dataloader generation time/epoch 315.02669707934064
pseudo mini batch 0 input nodes size: 2225546
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.8401737213134766  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.8401737213134766  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.6692543029785156  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.6696205139160156  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.8411259651184082  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.3301100730895996  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.3301100730895996  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

first layer input nodes number: 2225546
first layer output nodes number: 1925845
edges number: 38481666
torch.Size([2225546, 100])
torch.Size([1925845, 256])
input nodes number: 1925845
output nodes number: 812737
edges number: 25291350
torch.Size([1925845, 256])
torch.Size([812737, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 9.309463500976562  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 9.318068981170654  GigaBytes
Max Memory Allocated: 10.813722610473633  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 2.0943679809570312  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

pseudo mini batch 1 input nodes size: 2222049
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.8411269187927246  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.8411269187927246  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.669255256652832  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.669621467590332  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.840174674987793  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.328141212463379  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.328141212463379  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

first layer input nodes number: 2222049
first layer output nodes number: 1922690
edges number: 38421844
torch.Size([2222049, 100])
torch.Size([1922690, 256])
input nodes number: 1922690
output nodes number: 809734
edges number: 25215567
torch.Size([1922690, 256])
torch.Size([809734, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 9.288008689880371  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 9.296613693237305  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 2.0903048515319824  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

pseudo mini batch 2 input nodes size: 2221782
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.840174674987793  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.840174674987793  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.6678533554077148  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.6682195663452148  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.8397250175476074  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.3270316123962402  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.3270316123962402  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

first layer input nodes number: 2221782
first layer output nodes number: 1920473
edges number: 38385832
torch.Size([2221782, 100])
torch.Size([1920473, 256])
input nodes number: 1920473
output nodes number: 808455
edges number: 25161578
torch.Size([1920473, 256])
torch.Size([808455, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 9.277761936187744  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 9.286366939544678  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 2.0888724327087402  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

pseudo mini batch 3 input nodes size: 2221573
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.8404965400695801  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.8404965400695801  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.6686248779296875  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.6689910888671875  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 0.8409461975097656  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.3279800415039062  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 1.3279800415039062  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

first layer input nodes number: 2221573
first layer output nodes number: 1920739
edges number: 38384876
torch.Size([2221573, 100])
torch.Size([1920739, 256])
input nodes number: 1920739
output nodes number: 807120
edges number: 25123794
torch.Size([1920739, 256])
torch.Size([807120, 256])
torch.Size([49142, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 9.273542404174805  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 9.282147407531738  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 2.087594509124756  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 2.087594509124756  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.1483154296875 GB
    Memory Allocated: 2.087594509124756  GigaBytes
Max Memory Allocated: 10.820838451385498  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4948599338531494 |0.6174830794334412 |0.12877964973449707 |0.00015038251876831055 |0.003795802593231201 |0.001203298568725586 |
----------------------------------------------------------pseudo_mini_loss sum 2.228717088699341
Total (block generation + training)time/epoch 320.4104885657628
Training time/epoch 5.314890384674072
Training time without block to device /epoch 2.8449580669403076
Training time without total dataloading part /epoch 0.5321066379547119
load block tensor time/epoch 1.9794397354125977
block to device time/epoch 2.4699323177337646
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  19818743
Number of first layer input nodes during this epoch:  8890950
Number of first layer output nodes during this epoch:  7689747
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
