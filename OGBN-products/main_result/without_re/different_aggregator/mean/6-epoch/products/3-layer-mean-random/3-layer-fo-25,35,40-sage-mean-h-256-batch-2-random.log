main start at this time 1656621029.204761
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.32907724380493164
number of batches is  2
batch size is  98286
random selection method spend 0.01659679412841797
time for parepare:  0.2767517566680908
local_output_nid generation:  0.044438838958740234
local_in_edges_tensor generation:  0.10985875129699707
mini_batch_src_global generation:  0.12290072441101074
r_  generation:  1.7703814506530762
local_output_nid generation:  0.04721188545227051
local_in_edges_tensor generation:  0.0888826847076416
mini_batch_src_global generation:  0.15607261657714844
r_  generation:  1.9394805431365967
----------------------check_connections_block total spend ----------------------------- 5.155393838882446
generate_one_block  3.355076789855957
generate_one_block  2.278587818145752
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0150485038757324
gen group dst list time:  0.06247401237487793
time for parepare:  0.42989039421081543
local_output_nid generation:  0.3183143138885498
local_in_edges_tensor generation:  0.9921977519989014
mini_batch_src_global generation:  1.0666167736053467
r_  generation:  14.336540699005127
local_output_nid generation:  0.3250613212585449
local_in_edges_tensor generation:  0.8962283134460449
mini_batch_src_global generation:  1.3176395893096924
r_  generation:  13.940786123275757
----------------------check_connections_block total spend ----------------------------- 38.43357849121094
generate_one_block  18.508197784423828
generate_one_block  18.1231632232666
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.4970290660858154
gen group dst list time:  0.16531848907470703
time for parepare:  0.47269272804260254
local_output_nid generation:  0.6174073219299316
local_in_edges_tensor generation:  1.4080731868743896
mini_batch_src_global generation:  1.3169727325439453
r_  generation:  17.374428272247314
local_output_nid generation:  0.6194074153900146
local_in_edges_tensor generation:  1.446549415588379
mini_batch_src_global generation:  1.6923444271087646
r_  generation:  17.700753688812256
----------------------check_connections_block total spend ----------------------------- 49.13733792304993
generate_one_block  23.24036955833435
generate_one_block  23.01530361175537
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  87.57091641426086
block generation total time  82.88703417778015
average batch blocks generation time:  41.443517088890076
block dataloader generation time/epoch 192.40076303482056
pseudo mini batch 0 input nodes size: 2249074
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.8386592864990234  GigaBytes
Max Memory Allocated: 0.8386592864990234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.8393917083740234  GigaBytes
Max Memory Allocated: 0.8393917083740234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.8393917083740234  GigaBytes
Max Memory Allocated: 0.8393917083740234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 1.4100332260131836  GigaBytes
Max Memory Allocated: 1.4100332260131836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4940185546875 GB
    Memory Allocated: 1.4100332260131836  GigaBytes
Max Memory Allocated: 1.4100332260131836  GigaBytes

first layer input nodes number: 2249074
first layer output nodes number: 2039785
edges number: 39646867
torch.Size([2249074, 100])
torch.Size([2039785, 256])
input nodes number: 2039785
output nodes number: 1098482
edges number: 33008657
torch.Size([2039785, 256])
torch.Size([1098482, 256])
torch.Size([98286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7264404296875 GB
    Memory Allocated: 10.723275661468506  GigaBytes
Max Memory Allocated: 11.61431360244751  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7264404296875 GB
    Memory Allocated: 10.740485668182373  GigaBytes
Max Memory Allocated: 11.61431360244751  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7147216796875 GB
    Memory Allocated: 2.3524351119995117  GigaBytes
Max Memory Allocated: 12.739011287689209  GigaBytes

pseudo mini batch 1 input nodes size: 2249392
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7147216796875 GB
    Memory Allocated: 0.8573703765869141  GigaBytes
Max Memory Allocated: 12.739011287689209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7147216796875 GB
    Memory Allocated: 0.8573703765869141  GigaBytes
Max Memory Allocated: 12.739011287689209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7147216796875 GB
    Memory Allocated: 1.6953344345092773  GigaBytes
Max Memory Allocated: 12.739011287689209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7147216796875 GB
    Memory Allocated: 1.6960668563842773  GigaBytes
Max Memory Allocated: 12.739011287689209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7147216796875 GB
    Memory Allocated: 0.8574438095092773  GigaBytes
Max Memory Allocated: 12.739011287689209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7147216796875 GB
    Memory Allocated: 1.4281024932861328  GigaBytes
Max Memory Allocated: 12.739011287689209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7147216796875 GB
    Memory Allocated: 1.4281024932861328  GigaBytes
Max Memory Allocated: 12.739011287689209  GigaBytes

first layer input nodes number: 2249392
first layer output nodes number: 2041394
edges number: 39690052
torch.Size([2249392, 100])
torch.Size([2041394, 256])
input nodes number: 2041394
output nodes number: 1098142
edges number: 33006294
torch.Size([2041394, 256])
torch.Size([1098142, 256])
torch.Size([98285, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2713623046875 GB
    Memory Allocated: 10.728548049926758  GigaBytes
Max Memory Allocated: 12.739011287689209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.2713623046875 GB
    Memory Allocated: 10.745757579803467  GigaBytes
Max Memory Allocated: 12.739011287689209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.2694091796875 GB
    Memory Allocated: 2.353543758392334  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 2.355081081390381  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 2.355081081390381  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4229937791824341 |0.8985295295715332 |0.6625558137893677 |0.00023508071899414062 |0.2528425455093384 |0.0056688785552978516 |
----------------------------------------------------------pseudo_mini_loss sum 7.163670539855957
Total (block generation + training)time/epoch 196.9990906715393
Training time/epoch 4.597926139831543
Training time without block to device /epoch 2.8008670806884766
Training time without total dataloading part /epoch 1.8369357585906982
load block tensor time/epoch 0.8459875583648682
block to device time/epoch 1.7970590591430664
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10776269
Number of first layer input nodes during this epoch:  4498466
Number of first layer output nodes during this epoch:  4081179
----------------------------------------before generate dataloader block 
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 2.3550806045532227  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.48697972297668457
number of batches is  2
batch size is  98286
random selection method spend 0.017596006393432617
time for parepare:  0.2833256721496582
local_output_nid generation:  0.04385805130004883
local_in_edges_tensor generation:  0.10862493515014648
mini_batch_src_global generation:  0.12276268005371094
r_  generation:  1.7916498184204102
local_output_nid generation:  0.04698061943054199
local_in_edges_tensor generation:  0.08026957511901855
mini_batch_src_global generation:  0.1599578857421875
r_  generation:  1.8975324630737305
----------------------check_connections_block total spend ----------------------------- 5.178338527679443
generate_one_block  2.7327733039855957
generate_one_block  2.3098225593566895
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.9890046119689941
gen group dst list time:  0.07030057907104492
time for parepare:  0.41368579864501953
local_output_nid generation:  0.3230173587799072
local_in_edges_tensor generation:  0.9665236473083496
mini_batch_src_global generation:  1.0650646686553955
r_  generation:  13.787668228149414
local_output_nid generation:  0.3325183391571045
local_in_edges_tensor generation:  0.8821530342102051
mini_batch_src_global generation:  1.4145534038543701
r_  generation:  14.153531789779663
----------------------check_connections_block total spend ----------------------------- 38.278958797454834
generate_one_block  18.998527765274048
generate_one_block  18.676918029785156
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2853615283966064
gen group dst list time:  0.17609953880310059
time for parepare:  0.4766697883605957
local_output_nid generation:  0.636667013168335
local_in_edges_tensor generation:  1.4341933727264404
mini_batch_src_global generation:  1.3061435222625732
r_  generation:  17.916504859924316
local_output_nid generation:  0.6881272792816162
local_in_edges_tensor generation:  1.502476453781128
mini_batch_src_global generation:  1.667590856552124
r_  generation:  18.10592555999756
----------------------check_connections_block total spend ----------------------------- 50.173139333724976
generate_one_block  22.948303699493408
generate_one_block  22.527620553970337
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 2.3550806045532227  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

connection checking time:  88.45209813117981
block generation total time  83.15137004852295
average batch blocks generation time:  41.575685024261475
block dataloader generation time/epoch 192.7425651550293
pseudo mini batch 0 input nodes size: 2250393
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 0.8589801788330078  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 0.8589801788330078  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 1.697317123413086  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 1.698049545288086  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 0.8593530654907227  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 1.4299917221069336  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 1.4299917221069336  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

first layer input nodes number: 2250393
first layer output nodes number: 2039739
edges number: 39644474
torch.Size([2250393, 100])
torch.Size([2039739, 256])
input nodes number: 2039739
output nodes number: 1097898
edges number: 32990512
torch.Size([2039739, 256])
torch.Size([1097898, 256])
torch.Size([98286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 10.723908424377441  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 10.741118431091309  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 2.35471248626709  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

pseudo mini batch 1 input nodes size: 2249384
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 0.8593540191650391  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 0.8593540191650391  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 1.6973152160644531  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 1.6980476379394531  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 0.858978271484375  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 1.429713249206543  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2713623046875 GB
    Memory Allocated: 1.429713249206543  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

first layer input nodes number: 2249384
first layer output nodes number: 2042990
edges number: 39694784
torch.Size([2249384, 100])
torch.Size([2042990, 256])
input nodes number: 2042990
output nodes number: 1099555
edges number: 33039956
torch.Size([2042990, 256])
torch.Size([1099555, 256])
torch.Size([98285, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3221435546875 GB
    Memory Allocated: 10.73921823501587  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.3221435546875 GB
    Memory Allocated: 10.756427764892578  GigaBytes
Max Memory Allocated: 12.74399709701538  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 2.3546195030212402  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 2.3546195030212402  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 2.3546195030212402  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4714897871017456 |0.7565715312957764 |0.2810478210449219 |0.00016689300537109375 |0.1461406946182251 |0.003720521926879883 |
----------------------------------------------------------pseudo_mini_loss sum 12.456296920776367
Total (block generation + training)time/epoch 196.78445482254028
Training time/epoch 3.485241174697876
Training time without block to device /epoch 1.9720981121063232
Training time without total dataloading part /epoch 0.858431339263916
load block tensor time/epoch 0.9429795742034912
block to device time/epoch 1.5131430625915527
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10779959
Number of first layer input nodes during this epoch:  4499777
Number of first layer output nodes during this epoch:  4082729
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 2.354619026184082  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4507319927215576
number of batches is  2
batch size is  98286
random selection method spend 0.0206449031829834
time for parepare:  0.30188417434692383
local_output_nid generation:  0.0494844913482666
local_in_edges_tensor generation:  0.0874171257019043
mini_batch_src_global generation:  0.12690329551696777
r_  generation:  1.7650468349456787
local_output_nid generation:  0.052190303802490234
local_in_edges_tensor generation:  0.07963109016418457
mini_batch_src_global generation:  0.15507268905639648
r_  generation:  1.8761556148529053
----------------------check_connections_block total spend ----------------------------- 5.123352527618408
generate_one_block  2.7559053897857666
generate_one_block  2.3027896881103516
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0158960819244385
gen group dst list time:  0.07083773612976074
time for parepare:  0.4280517101287842
local_output_nid generation:  0.3511078357696533
local_in_edges_tensor generation:  0.9952600002288818
mini_batch_src_global generation:  1.0714740753173828
r_  generation:  14.051356792449951
local_output_nid generation:  0.3775808811187744
local_in_edges_tensor generation:  1.1574368476867676
mini_batch_src_global generation:  1.3328588008880615
r_  generation:  13.971209287643433
----------------------check_connections_block total spend ----------------------------- 38.66384720802307
generate_one_block  18.989728450775146
generate_one_block  18.488046884536743
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.351473569869995
gen group dst list time:  0.16916990280151367
time for parepare:  0.4287710189819336
local_output_nid generation:  0.6513240337371826
local_in_edges_tensor generation:  1.3168468475341797
mini_batch_src_global generation:  1.3439867496490479
r_  generation:  17.400402069091797
local_output_nid generation:  0.6767013072967529
local_in_edges_tensor generation:  1.4549412727355957
mini_batch_src_global generation:  1.618170976638794
r_  generation:  17.838299989700317
----------------------check_connections_block total spend ----------------------------- 49.12501072883606
generate_one_block  22.531705379486084
generate_one_block  22.34125065803528
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 2.354619026184082  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

connection checking time:  87.78885793685913
block generation total time  82.35073137283325
average batch blocks generation time:  41.175365686416626
block dataloader generation time/epoch 192.4295792579651
pseudo mini batch 0 input nodes size: 2249437
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.8589773178100586  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.8589773178100586  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 1.696958065032959  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 1.697690486907959  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.8589968681335449  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 1.4292969703674316  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 1.4292969703674316  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

first layer input nodes number: 2249437
first layer output nodes number: 2040698
edges number: 39670369
torch.Size([2249437, 100])
torch.Size([2040698, 256])
input nodes number: 2040698
output nodes number: 1096921
edges number: 32981682
torch.Size([2040698, 256])
torch.Size([1096921, 256])
torch.Size([98286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 10.721244812011719  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 10.738454818725586  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 2.3529934883117676  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

pseudo mini batch 1 input nodes size: 2249487
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.8589978218078613  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.8589978218078613  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 1.6969971656799316  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 1.6977295875549316  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.8590164184570312  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 1.43049955368042  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 1.43049955368042  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

first layer input nodes number: 2249487
first layer output nodes number: 2040640
edges number: 39655701
torch.Size([2249487, 100])
torch.Size([2040640, 256])
input nodes number: 2040640
output nodes number: 1098977
edges number: 33013839
torch.Size([2040640, 256])
torch.Size([1098977, 256])
torch.Size([98285, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 10.731099128723145  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 10.748308658599854  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 2.3538899421691895  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 2.3538899421691895  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 2.3538899421691895  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5204367637634277 |0.7437618970870972 |0.1335129737854004 |0.00016367435455322266 |0.007464289665222168 |0.0019867420196533203 |
----------------------------------------------------------pseudo_mini_loss sum 3.639657497406006
Total (block generation + training)time/epoch 196.20129537582397
Training time/epoch 3.2310919761657715
Training time without block to device /epoch 1.7435681819915771
Training time without total dataloading part /epoch 0.2842686176300049
load block tensor time/epoch 1.0408735275268555
block to device time/epoch 1.4875237941741943
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  10776160
Number of first layer input nodes during this epoch:  4498924
Number of first layer output nodes during this epoch:  4081338
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 2.3538894653320312  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.35972166061401367
number of batches is  2
batch size is  98286
random selection method spend 0.01642918586730957
time for parepare:  0.27695727348327637
local_output_nid generation:  0.04466414451599121
local_in_edges_tensor generation:  0.08415961265563965
mini_batch_src_global generation:  0.1282188892364502
r_  generation:  1.7308168411254883
local_output_nid generation:  0.04817485809326172
local_in_edges_tensor generation:  0.0719301700592041
mini_batch_src_global generation:  0.1619713306427002
r_  generation:  1.8483119010925293
----------------------check_connections_block total spend ----------------------------- 5.012439250946045
generate_one_block  2.666135311126709
generate_one_block  2.2059175968170166
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.007686138153076
gen group dst list time:  0.06502413749694824
time for parepare:  0.43309450149536133
local_output_nid generation:  0.3367137908935547
local_in_edges_tensor generation:  0.9832248687744141
mini_batch_src_global generation:  1.0625486373901367
r_  generation:  13.706746101379395
local_output_nid generation:  0.34069132804870605
local_in_edges_tensor generation:  0.865372896194458
mini_batch_src_global generation:  1.3204858303070068
r_  generation:  14.296611547470093
----------------------check_connections_block total spend ----------------------------- 38.209609031677246
generate_one_block  18.69474172592163
generate_one_block  18.408506631851196
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.303475856781006
gen group dst list time:  0.1662311553955078
time for parepare:  0.45160341262817383
local_output_nid generation:  0.632474422454834
local_in_edges_tensor generation:  1.4507360458374023
mini_batch_src_global generation:  1.2700612545013428
r_  generation:  17.036808729171753
local_output_nid generation:  0.6227011680603027
local_in_edges_tensor generation:  1.3184335231781006
mini_batch_src_global generation:  1.6266570091247559
r_  generation:  17.43730926513672
----------------------check_connections_block total spend ----------------------------- 48.14211940765381
generate_one_block  22.432402849197388
generate_one_block  22.56347131729126
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 2.3538894653320312  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

connection checking time:  86.35172843933105
block generation total time  82.09912252426147
average batch blocks generation time:  41.04956126213074
block dataloader generation time/epoch 191.674107670784
pseudo mini batch 0 input nodes size: 2249038
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.8590154647827148  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.8590154647827148  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 1.6969060897827148  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 1.6976385116577148  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 0.8589067459106445  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 1.4298171997070312  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2713623046875 GB
    Memory Allocated: 1.4298171997070312  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

first layer input nodes number: 2249038
first layer output nodes number: 2042148
edges number: 39665669
torch.Size([2249038, 100])
torch.Size([2042148, 256])
input nodes number: 2042148
output nodes number: 1100414
edges number: 33062932
torch.Size([2042148, 256])
torch.Size([1100414, 256])
torch.Size([98286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1287841796875 GB
    Memory Allocated: 10.736886978149414  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.1287841796875 GB
    Memory Allocated: 10.754096984863281  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.1795654296875 GB
    Memory Allocated: 2.3544921875  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

pseudo mini batch 1 input nodes size: 2251108
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.1795654296875 GB
    Memory Allocated: 0.8589076995849609  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.1795654296875 GB
    Memory Allocated: 0.8589076995849609  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.1795654296875 GB
    Memory Allocated: 1.6975111961364746  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.1795654296875 GB
    Memory Allocated: 1.6982436180114746  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.1795654296875 GB
    Memory Allocated: 0.8596205711364746  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.1795654296875 GB
    Memory Allocated: 1.4297223091125488  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1795654296875 GB
    Memory Allocated: 1.4297223091125488  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

first layer input nodes number: 2251108
first layer output nodes number: 2042437
edges number: 39692989
torch.Size([2251108, 100])
torch.Size([2042437, 256])
input nodes number: 2042437
output nodes number: 1096768
edges number: 32958506
torch.Size([2042437, 256])
torch.Size([1096768, 256])
torch.Size([98285, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1795654296875 GB
    Memory Allocated: 10.72663402557373  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.1795654296875 GB
    Memory Allocated: 10.74384355545044  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.3541717529296875  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.3541717529296875  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.3541717529296875  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4514303207397461 |0.5767821073532104 |0.2541927099227905 |0.0002516508102416992 |0.01131594181060791 |0.003740549087524414 |
----------------------------------------------------------pseudo_mini_loss sum 4.489462852478027
Total (block generation + training)time/epoch 195.2548547387123
Training time/epoch 3.0075337886810303
Training time without block to device /epoch 1.8539695739746094
Training time without total dataloading part /epoch 0.5352611541748047
load block tensor time/epoch 0.9028606414794922
block to device time/epoch 1.153564214706421
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  10781913
Number of first layer input nodes during this epoch:  4500146
Number of first layer output nodes during this epoch:  4084585
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.3541712760925293  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3671693801879883
number of batches is  2
batch size is  98286
random selection method spend 0.01199650764465332
time for parepare:  0.2899341583251953
local_output_nid generation:  0.04419565200805664
local_in_edges_tensor generation:  0.07622456550598145
mini_batch_src_global generation:  0.11882638931274414
r_  generation:  1.7067646980285645
local_output_nid generation:  0.04753589630126953
local_in_edges_tensor generation:  0.04900836944580078
mini_batch_src_global generation:  0.1521165370941162
r_  generation:  1.8326480388641357
----------------------check_connections_block total spend ----------------------------- 4.936068058013916
generate_one_block  2.2057435512542725
generate_one_block  2.2016916275024414
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.9889883995056152
gen group dst list time:  0.06495904922485352
time for parepare:  0.41637301445007324
local_output_nid generation:  0.33565807342529297
local_in_edges_tensor generation:  1.0438599586486816
mini_batch_src_global generation:  1.0725300312042236
r_  generation:  13.498334646224976
local_output_nid generation:  0.33806753158569336
local_in_edges_tensor generation:  0.849276065826416
mini_batch_src_global generation:  1.3697800636291504
r_  generation:  13.975709199905396
----------------------check_connections_block total spend ----------------------------- 37.6803560256958
generate_one_block  18.026512145996094
generate_one_block  18.358547687530518
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3320021629333496
gen group dst list time:  0.14408278465270996
time for parepare:  0.45346832275390625
local_output_nid generation:  0.6254055500030518
local_in_edges_tensor generation:  1.3658771514892578
mini_batch_src_global generation:  1.292947769165039
r_  generation:  17.050021648406982
local_output_nid generation:  0.6664414405822754
local_in_edges_tensor generation:  1.2603473663330078
mini_batch_src_global generation:  1.6199443340301514
r_  generation:  17.720220804214478
----------------------check_connections_block total spend ----------------------------- 48.31178402900696
generate_one_block  22.178500175476074
generate_one_block  22.442115306854248
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.3541712760925293  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

connection checking time:  85.99214005470276
block generation total time  81.00567531585693
average batch blocks generation time:  40.50283765792847
block dataloader generation time/epoch 190.8427502632141
pseudo mini batch 0 input nodes size: 2249646
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 0.8596196174621582  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 0.8596196174621582  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.6976780891418457  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.6984105110168457  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 0.859074592590332  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.4292583465576172  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.4292583465576172  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

first layer input nodes number: 2249646
first layer output nodes number: 2040267
edges number: 39637332
torch.Size([2249646, 100])
torch.Size([2040267, 256])
input nodes number: 2040267
output nodes number: 1097468
edges number: 32968522
torch.Size([2040267, 256])
torch.Size([1097468, 256])
torch.Size([98286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 10.722370147705078  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 10.739580154418945  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.3525032997131348  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

pseudo mini batch 1 input nodes size: 2249500
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 0.8590755462646484  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 0.8590755462646484  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.6970796585083008  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.6978120803833008  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 0.8590211868286133  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.429656982421875  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.429656982421875  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

first layer input nodes number: 2249500
first layer output nodes number: 2042959
edges number: 39708849
torch.Size([2249500, 100])
torch.Size([2042959, 256])
input nodes number: 2042959
output nodes number: 1098801
edges number: 33027139
torch.Size([2042959, 256])
torch.Size([1098801, 256])
torch.Size([98285, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 10.735188484191895  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 10.752398014068604  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.3530044555664062  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.3530044555664062  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.3530044555664062  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5146249532699585 |0.6943635940551758 |0.13085567951202393 |0.0001634359359741211 |0.00548243522644043 |0.0012028217315673828 |
----------------------------------------------------------pseudo_mini_loss sum 3.3675575256347656
Total (block generation + training)time/epoch 194.33010730743408
Training time/epoch 3.113532304763794
Training time without block to device /epoch 1.7248051166534424
Training time without total dataloading part /epoch 0.27420592308044434
load block tensor time/epoch 1.029249906539917
block to device time/epoch 1.3887271881103516
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  10778641
Number of first layer input nodes during this epoch:  4499146
Number of first layer output nodes during this epoch:  4083226
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.353003978729248  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.44221997261047363
number of batches is  2
batch size is  98286
random selection method spend 0.013260841369628906
time for parepare:  0.26224756240844727
local_output_nid generation:  0.045365095138549805
local_in_edges_tensor generation:  0.0802156925201416
mini_batch_src_global generation:  0.12736129760742188
r_  generation:  1.7468254566192627
local_output_nid generation:  0.04628920555114746
local_in_edges_tensor generation:  0.0568392276763916
mini_batch_src_global generation:  0.1617269515991211
r_  generation:  1.828451156616211
----------------------check_connections_block total spend ----------------------------- 4.97680401802063
generate_one_block  2.2889838218688965
generate_one_block  2.21651029586792
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0107250213623047
gen group dst list time:  0.06570982933044434
time for parepare:  0.42487668991088867
local_output_nid generation:  0.3438069820404053
local_in_edges_tensor generation:  0.9799103736877441
mini_batch_src_global generation:  1.0669000148773193
r_  generation:  13.368505239486694
local_output_nid generation:  0.33964109420776367
local_in_edges_tensor generation:  0.8688251972198486
mini_batch_src_global generation:  1.3302686214447021
r_  generation:  13.59149432182312
----------------------check_connections_block total spend ----------------------------- 37.09805631637573
generate_one_block  17.86905312538147
generate_one_block  18.16665554046631
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1944401264190674
gen group dst list time:  0.1416912078857422
time for parepare:  0.4193229675292969
local_output_nid generation:  0.6089935302734375
local_in_edges_tensor generation:  1.2664196491241455
mini_batch_src_global generation:  1.2580337524414062
r_  generation:  17.262919425964355
local_output_nid generation:  0.6099567413330078
local_in_edges_tensor generation:  1.3356380462646484
mini_batch_src_global generation:  1.6508426666259766
r_  generation:  17.155311822891235
----------------------check_connections_block total spend ----------------------------- 47.7540717124939
generate_one_block  22.326796054840088
generate_one_block  21.857396364212036
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.353003978729248  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

connection checking time:  84.85212802886963
block generation total time  80.2199010848999
average batch blocks generation time:  40.10995054244995
block dataloader generation time/epoch 189.9769694407781
pseudo mini batch 0 input nodes size: 2250760
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 0.8590202331542969  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 0.8590202331542969  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.6974940299987793  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.6982264518737793  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 0.859489917755127  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.430433750152588  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.430433750152588  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

first layer input nodes number: 2250760
first layer output nodes number: 2042305
edges number: 39687325
torch.Size([2250760, 100])
torch.Size([2042305, 256])
input nodes number: 2042305
output nodes number: 1100437
edges number: 33071589
torch.Size([2042305, 256])
torch.Size([1100437, 256])
torch.Size([98286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 10.738805770874023  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 10.75601577758789  GigaBytes
Max Memory Allocated: 12.758045673370361  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.354745864868164  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

pseudo mini batch 1 input nodes size: 2247754
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 0.8594908714294434  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 0.8594908714294434  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.6973814964294434  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.6981139183044434  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 0.8589076995849609  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.4290456771850586  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 1.4290456771850586  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

first layer input nodes number: 2247754
first layer output nodes number: 2039155
edges number: 39634602
torch.Size([2247754, 100])
torch.Size([2039155, 256])
input nodes number: 2039155
output nodes number: 1096950
edges number: 32959309
torch.Size([2039155, 256])
torch.Size([1096950, 256])
torch.Size([98285, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 10.717193603515625  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 10.734403133392334  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.352140426635742  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.352140426635742  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.2264404296875 GB
    Memory Allocated: 2.352140426635742  GigaBytes
Max Memory Allocated: 12.758258819580078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.495341420173645 |0.5784701108932495 |0.1571657657623291 |0.0002503395080566406 |0.005737900733947754 |0.0012192726135253906 |
----------------------------------------------------------pseudo_mini_loss sum 2.2181270122528076
Total (block generation + training)time/epoch 193.3660635550817
Training time/epoch 2.8975014686584473
Training time without block to device /epoch 1.7405612468719482
Training time without total dataloading part /epoch 0.3275272846221924
load block tensor time/epoch 0.99068284034729
block to device time/epoch 1.156940221786499
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  10777361
Number of first layer input nodes during this epoch:  4498514
Number of first layer output nodes during this epoch:  4081460
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
