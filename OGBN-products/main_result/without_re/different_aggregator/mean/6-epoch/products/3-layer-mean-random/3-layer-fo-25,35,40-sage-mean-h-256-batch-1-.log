main start at this time 1656620970.6361427
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 3.7819535732269287
pseudo mini batch 0 input nodes size: 2269247
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.8464717864990234  GigaBytes
Max Memory Allocated: 0.8464717864990234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.8479366302490234  GigaBytes
Max Memory Allocated: 0.8479366302490234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.8479366302490234  GigaBytes
Max Memory Allocated: 0.8479366302490234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.498983383178711  GigaBytes
Max Memory Allocated: 1.498983383178711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.498983383178711  GigaBytes
Max Memory Allocated: 1.498983383178711  GigaBytes

first layer input nodes number: 2269247
first layer output nodes number: 2126623
edges number: 40424243
torch.Size([2269247, 100])
torch.Size([2126623, 256])
input nodes number: 2126623
output nodes number: 1377639
edges number: 39526935
torch.Size([2126623, 256])
torch.Size([1377639, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2362060546875 GB
    Memory Allocated: 12.11223030090332  GigaBytes
Max Memory Allocated: 13.113555908203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.2362060546875 GB
    Memory Allocated: 12.14664888381958  GigaBytes
Max Memory Allocated: 13.113555908203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.6639404296875 GB
    Memory Allocated: 2.6210951805114746  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 2.6226325035095215  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 2.6226325035095215  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4432554244995117 |0.916048526763916 |0.9340901374816895 |0.0002925395965576172 |0.5337603092193604 |0.005335330963134766 |
----------------------------------------------------------pseudo_mini_loss sum 7.191042423248291
Total (block generation + training)time/epoch 6.6953747272491455
Training time/epoch 2.9129035472869873
Training time without block to device /epoch 1.9968550205230713
Training time without total dataloading part /epoch 1.4734783172607422
load block tensor time/epoch 0.4432554244995117
block to device time/epoch 0.916048526763916
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5773509
Number of first layer input nodes during this epoch:  2269247
Number of first layer output nodes during this epoch:  2126623
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 2.6226320266723633  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 2.6226320266723633  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 3.7855851650238037
pseudo mini batch 0 input nodes size: 2269388
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 1.7300734519958496  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 1.7315382957458496  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 0.8843703269958496  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 1.5355095863342285  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6658935546875 GB
    Memory Allocated: 1.5355095863342285  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

first layer input nodes number: 2269388
first layer output nodes number: 2127375
edges number: 40430802
torch.Size([2269388, 100])
torch.Size([2127375, 256])
input nodes number: 2127375
output nodes number: 1378293
edges number: 39532899
torch.Size([2127375, 256])
torch.Size([1378293, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6112060546875 GB
    Memory Allocated: 12.117600917816162  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6112060546875 GB
    Memory Allocated: 12.152019500732422  GigaBytes
Max Memory Allocated: 14.579107284545898  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5994873046875 GB
    Memory Allocated: 2.6225500106811523  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.5994873046875 GB
    Memory Allocated: 2.6225500106811523  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.5994873046875 GB
    Memory Allocated: 2.6225500106811523  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.29889822006225586 |0.5737712383270264 |0.19776177406311035 |0.00023651123046875 |0.5829849243164062 |0.003577709197998047 |
----------------------------------------------------------pseudo_mini_loss sum 12.431529998779297
Total (block generation + training)time/epoch 6.118769407272339
Training time/epoch 1.7527649402618408
Training time without block to device /epoch 1.1789937019348145
Training time without total dataloading part /epoch 0.7845609188079834
load block tensor time/epoch 0.29889822006225586
block to device time/epoch 0.5737712383270264
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5775056
Number of first layer input nodes during this epoch:  2269388
Number of first layer output nodes during this epoch:  2127375
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.5994873046875 GB
    Memory Allocated: 2.622549533843994  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.5994873046875 GB
    Memory Allocated: 2.622549533843994  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 3.768803596496582
pseudo mini batch 0 input nodes size: 2268977
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5994873046875 GB
    Memory Allocated: 0.8843703269958496  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5994873046875 GB
    Memory Allocated: 0.8843703269958496  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5994873046875 GB
    Memory Allocated: 1.7300734519958496  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5994873046875 GB
    Memory Allocated: 1.7315382957458496  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5994873046875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5994873046875 GB
    Memory Allocated: 1.535581111907959  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5994873046875 GB
    Memory Allocated: 1.535581111907959  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

first layer input nodes number: 2268977
first layer output nodes number: 2126632
edges number: 40420991
torch.Size([2268977, 100])
torch.Size([2126632, 256])
input nodes number: 2126632
output nodes number: 1376892
edges number: 39513444
torch.Size([2126632, 256])
torch.Size([1376892, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 12.110147476196289  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 12.144566059112549  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.622549057006836  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.622549057006836  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.622549057006836  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3018150329589844 |0.5513002872467041 |0.1366724967956543 |0.00013065338134765625 |0.014225244522094727 |0.00345611572265625 |
----------------------------------------------------------pseudo_mini_loss sum 3.6571226119995117
Total (block generation + training)time/epoch 5.82588545481364
Training time/epoch 1.504702091217041
Training time without block to device /epoch 0.9534018039703369
Training time without total dataloading part /epoch 0.15448451042175293
load block tensor time/epoch 0.3018150329589844
block to device time/epoch 0.5513002872467041
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5772501
Number of first layer input nodes during this epoch:  2268977
Number of first layer output nodes during this epoch:  2126632
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.6225485801696777  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.6225485801696777  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 3.759978175163269
pseudo mini batch 0 input nodes size: 2269677
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 1.7301812171936035  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 1.7316460609436035  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 0.8844780921936035  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 1.5355830192565918  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 1.5355830192565918  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

first layer input nodes number: 2269677
first layer output nodes number: 2127696
edges number: 40430969
torch.Size([2269677, 100])
torch.Size([2127696, 256])
input nodes number: 2127696
output nodes number: 1377933
edges number: 39528149
torch.Size([2127696, 256])
torch.Size([1377933, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 12.117053985595703  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 12.151472568511963  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.622555732727051  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.622555732727051  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.622555732727051  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3025083541870117 |0.5520577430725098 |0.13334250450134277 |0.00012922286987304688 |0.37204861640930176 |0.0035009384155273438 |
----------------------------------------------------------pseudo_mini_loss sum 4.498876571655273
Total (block generation + training)time/epoch 5.6947521567344666
Training time/epoch 1.567678451538086
Training time without block to device /epoch 1.0156207084655762
Training time without total dataloading part /epoch 0.5090212821960449
load block tensor time/epoch 0.3025083541870117
block to device time/epoch 0.5520577430725098
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5775306
Number of first layer input nodes during this epoch:  2269677
Number of first layer output nodes during this epoch:  2127696
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.6225552558898926  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.6225552558898926  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 3.7568356513977053
pseudo mini batch 0 input nodes size: 2268942
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 0.8844780921936035  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 0.8844780921936035  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 1.7301812171936035  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 1.7316460609436035  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 1.5356173515319824  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 1.5356173515319824  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

first layer input nodes number: 2268942
first layer output nodes number: 2127273
edges number: 40427497
torch.Size([2268942, 100])
torch.Size([2127273, 256])
input nodes number: 2127273
output nodes number: 1377203
edges number: 39511750
torch.Size([2127273, 256])
torch.Size([1377203, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 12.113801002502441  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 12.148219585418701  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.622053623199463  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.622053623199463  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.622053623199463  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3069767951965332 |0.562283992767334 |0.14035320281982422 |0.0001361370086669922 |0.005399942398071289 |0.0023546218872070312 |
----------------------------------------------------------pseudo_mini_loss sum 3.3682680130004883
Total (block generation + training)time/epoch 5.609745836257934
Training time/epoch 1.5252773761749268
Training time without block to device /epoch 0.9629933834075928
Training time without total dataloading part /epoch 0.14824390411376953
load block tensor time/epoch 0.3069767951965332
block to device time/epoch 0.562283992767334
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5773418
Number of first layer input nodes during this epoch:  2268942
Number of first layer output nodes during this epoch:  2127273
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.6220531463623047  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.6220531463623047  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 3.7577614386876426
pseudo mini batch 0 input nodes size: 2269386
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 0.8846602439880371  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 1.7300724983215332  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 1.7315373420715332  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 0.8843693733215332  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 1.5354714393615723  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 1.5354714393615723  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

first layer input nodes number: 2269386
first layer output nodes number: 2127409
edges number: 40429387
torch.Size([2269386, 100])
torch.Size([2127409, 256])
input nodes number: 2127409
output nodes number: 1377823
edges number: 39529344
torch.Size([2127409, 256])
torch.Size([1377823, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 12.11652135848999  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 12.15093994140625  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.6224417686462402  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.6224417686462402  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.5447998046875 GB
    Memory Allocated: 2.6224417686462402  GigaBytes
Max Memory Allocated: 14.584390640258789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.30521559715270996 |0.6274158954620361 |0.13341093063354492 |0.0001277923583984375 |0.005656242370605469 |0.0010900497436523438 |
----------------------------------------------------------pseudo_mini_loss sum 2.2402524948120117
Total (block generation + training)time/epoch 5.565705140431722
Training time/epoch 1.5829391479492188
Training time without block to device /epoch 0.9555232524871826
Training time without total dataloading part /epoch 0.14028501510620117
load block tensor time/epoch 0.30521559715270996
block to device time/epoch 0.6274158954620361
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5774618
Number of first layer input nodes during this epoch:  2269386
Number of first layer output nodes during this epoch:  2127409
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
