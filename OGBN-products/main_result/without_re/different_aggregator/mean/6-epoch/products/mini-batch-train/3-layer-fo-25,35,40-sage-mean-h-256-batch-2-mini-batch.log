main start at this time 1656995563.5172575
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.8386592864990234  GigaBytes
Max Memory Allocated: 0.8386592864990234  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.8393917083740234  GigaBytes
Max Memory Allocated: 0.8393917083740234  GigaBytes

first layer input nodes number: 2247220
first layer output nodes number: 2041158
edges number: 39672474
torch.Size([2247220, 100])
torch.Size([2041158, 256])
input nodes number: 2041158
output nodes number: 1098440
edges number: 33011417
torch.Size([2041158, 256])
torch.Size([1098440, 256])
torch.Size([98285, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.7283935546875 GB
    Memory Allocated: 2.3541131019592285  GigaBytes
Max Memory Allocated: 12.743661403656006  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 21.7283935546875 GB
    Memory Allocated: 0.8589072227478027  GigaBytes
Max Memory Allocated: 12.743661403656006  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7283935546875 GB
    Memory Allocated: 1.6973538398742676  GigaBytes
Max Memory Allocated: 12.743661403656006  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7283935546875 GB
    Memory Allocated: 1.6980862617492676  GigaBytes
Max Memory Allocated: 12.743661403656006  GigaBytes

first layer input nodes number: 2250687
first layer output nodes number: 2042211
edges number: 39677847
torch.Size([2250687, 100])
torch.Size([2042211, 256])
input nodes number: 2042211
output nodes number: 1098618
edges number: 33023067
torch.Size([2042211, 256])
torch.Size([1098618, 256])
torch.Size([98285, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 2.3551907539367676  GigaBytes
Max Memory Allocated: 12.749077320098877  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 0.8594632148742676  GigaBytes
Max Memory Allocated: 12.749077320098877  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 0.8659844398498535  GigaBytes
Max Memory Allocated: 12.749077320098877  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 0.8659849166870117  GigaBytes
Max Memory Allocated: 12.749077320098877  GigaBytes

first layer input nodes number: 17505
first layer output nodes number: 1136
edges number: 26773
torch.Size([17505, 100])
torch.Size([1136, 256])
input nodes number: 1136
output nodes number: 41
edges number: 1283
torch.Size([1136, 256])
torch.Size([41, 256])
torch.Size([1, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 0.010190486907958984  GigaBytes
Max Memory Allocated: 12.749077320098877  GigaBytes

Total (block generation + training)time/epoch 40.479400396347046
* Pure training time/epoch 4.06648850440979
Training time/epoch 1656995628.4362106
Training time without block to device /epoch 1656995627.0477052
Training time without total dataloading part /epoch 1.84834885597229
load block tensor time/epoch 0.8296341896057129
block to device time/epoch 1.388505458831787
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10797016
Number of first layer input nodes during this epoch:  4515412
Number of first layer output nodes during this epoch:  0
Number of all edges in block send to gpu during this epoch:  152843421
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 0.009597301483154297  GigaBytes
Max Memory Allocated: 12.749077320098877  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 0.8474879264831543  GigaBytes
Max Memory Allocated: 12.749077320098877  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 0.8482203483581543  GigaBytes
Max Memory Allocated: 12.749077320098877  GigaBytes

first layer input nodes number: 2248381
first layer output nodes number: 2040371
edges number: 39666435
torch.Size([2248381, 100])
torch.Size([2040371, 256])
input nodes number: 2040371
output nodes number: 1098652
edges number: 33023209
torch.Size([2040371, 256])
torch.Size([1098652, 256])
torch.Size([98285, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 2.3542532920837402  GigaBytes
Max Memory Allocated: 12.749077320098877  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 0.8589072227478027  GigaBytes
Max Memory Allocated: 12.749077320098877  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 1.697770595550537  GigaBytes
Max Memory Allocated: 12.749077320098877  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 1.698503017425537  GigaBytes
Max Memory Allocated: 12.749077320098877  GigaBytes

first layer input nodes number: 2251806
first layer output nodes number: 2042443
edges number: 39685705
torch.Size([2251806, 100])
torch.Size([2042443, 256])
input nodes number: 2042443
output nodes number: 1099043
edges number: 33012926
torch.Size([2042443, 256])
torch.Size([1099043, 256])
torch.Size([98285, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 2.3550596237182617  GigaBytes
Max Memory Allocated: 12.754530906677246  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 0.8598799705505371  GigaBytes
Max Memory Allocated: 12.754530906677246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 0.8625006675720215  GigaBytes
Max Memory Allocated: 12.754530906677246  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2830810546875 GB
    Memory Allocated: 0.8625011444091797  GigaBytes
Max Memory Allocated: 12.754530906677246  GigaBytes

first layer input nodes number: 7034
first layer output nodes number: 781
edges number: 18740
torch.Size([7034, 100])
torch.Size([781, 256])
input nodes number: 781
output nodes number: 41
edges number: 1311
torch.Size([781, 256])
torch.Size([41, 256])
torch.Size([1, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.006084918975830078  GigaBytes
Max Memory Allocated: 12.754530906677246  GigaBytes

Total (block generation + training)time/epoch 28.819733500480652
* Pure training time/epoch 2.3916096687316895
Training time/epoch 1656995645.596917
Training time without block to device /epoch 1656995644.5460322
Training time without total dataloading part /epoch 0.5808365345001221
load block tensor time/epoch 0.7598884105682373
block to device time/epoch 1.05088472366333
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10788552
Number of first layer input nodes during this epoch:  4507221
Number of first layer output nodes during this epoch:  0
Number of all edges in block send to gpu during this epoch:  152838886
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.005696773529052734  GigaBytes
Max Memory Allocated: 12.754530906677246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.843599796295166  GigaBytes
Max Memory Allocated: 12.754530906677246  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.844332218170166  GigaBytes
Max Memory Allocated: 12.754530906677246  GigaBytes

first layer input nodes number: 2249228
first layer output nodes number: 2040580
edges number: 39651595
torch.Size([2249228, 100])
torch.Size([2040580, 256])
input nodes number: 2040580
output nodes number: 1098679
edges number: 33014151
torch.Size([2040580, 256])
torch.Size([1098679, 256])
torch.Size([98285, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 2.3545260429382324  GigaBytes
Max Memory Allocated: 12.754530906677246  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.858919620513916  GigaBytes
Max Memory Allocated: 12.754530906677246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 1.69755220413208  GigaBytes
Max Memory Allocated: 12.754530906677246  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 1.69828462600708  GigaBytes
Max Memory Allocated: 12.754530906677246  GigaBytes

first layer input nodes number: 2251186
first layer output nodes number: 2043006
edges number: 39701864
torch.Size([2251186, 100])
torch.Size([2043006, 256])
input nodes number: 2043006
output nodes number: 1099170
edges number: 33028091
torch.Size([2043006, 256])
torch.Size([1099170, 256])
torch.Size([98285, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 2.355642795562744  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.8596491813659668  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.8625216484069824  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.8625221252441406  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

first layer input nodes number: 7710
first layer output nodes number: 848
edges number: 20979
torch.Size([7710, 100])
torch.Size([848, 256])
input nodes number: 848
output nodes number: 41
edges number: 1380
torch.Size([848, 256])
torch.Size([41, 256])
torch.Size([1, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.006375312805175781  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

Total (block generation + training)time/epoch 25.044995069503784
* Pure training time/epoch 2.4199705123901367
Training time/epoch 1656995663.0928745
Training time without block to device /epoch 1656995662.0445154
Training time without total dataloading part /epoch 0.5635113716125488
load block tensor time/epoch 0.8080999851226807
block to device time/epoch 1.0483591556549072
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  10790448
Number of first layer input nodes during this epoch:  4508124
Number of first layer output nodes during this epoch:  0
Number of all edges in block send to gpu during this epoch:  152848620
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.005948543548583984  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.8443856239318848  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.8451180458068848  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

first layer input nodes number: 2250662
first layer output nodes number: 2040748
edges number: 39666667
torch.Size([2250662, 100])
torch.Size([2040748, 256])
input nodes number: 2040748
output nodes number: 1098707
edges number: 33022986
torch.Size([2040748, 256])
torch.Size([1098707, 256])
torch.Size([98285, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 2.354825019836426  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.8594536781311035  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 1.6973443031311035  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 1.6980767250061035  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

first layer input nodes number: 2248634
first layer output nodes number: 2041044
edges number: 39666032
torch.Size([2248634, 100])
torch.Size([2041044, 256])
input nodes number: 2041044
output nodes number: 1097314
edges number: 32976069
torch.Size([2041044, 256])
torch.Size([1097314, 256])
torch.Size([98285, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 2.353921890258789  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.8589072227478027  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.8629264831542969  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2850341796875 GB
    Memory Allocated: 0.8629269599914551  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

first layer input nodes number: 10789
first layer output nodes number: 896
edges number: 22043
torch.Size([10789, 100])
torch.Size([896, 256])
input nodes number: 896
output nodes number: 41
edges number: 1435
torch.Size([896, 256])
torch.Size([41, 256])
torch.Size([1, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.007565975189208984  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

Total (block generation + training)time/epoch 23.126807808876038
* Pure training time/epoch 2.3553314208984375
Training time/epoch 1656995680.4654334
Training time without block to device /epoch 1656995679.3330789
Training time without total dataloading part /epoch 0.26993370056152344
load block tensor time/epoch 0.9530432224273682
block to device time/epoch 1.132354497909546
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  10788835
Number of first layer input nodes during this epoch:  4510085
Number of first layer output nodes during this epoch:  0
Number of all edges in block send to gpu during this epoch:  152785792
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.0070953369140625  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.8453950881958008  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.8461275100708008  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

first layer input nodes number: 2250293
first layer output nodes number: 2040138
edges number: 39662780
torch.Size([2250293, 100])
torch.Size([2040138, 256])
input nodes number: 2040138
output nodes number: 1098155
edges number: 33008059
torch.Size([2040138, 256])
torch.Size([1098155, 256])
torch.Size([98285, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 2.3544235229492188  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.859316349029541  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 1.6973676681518555  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 1.6981000900268555  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

first layer input nodes number: 2249626
first layer output nodes number: 2041580
edges number: 39660577
torch.Size([2249626, 100])
torch.Size([2041580, 256])
input nodes number: 2041580
output nodes number: 1098649
edges number: 33010496
torch.Size([2041580, 256])
torch.Size([1098649, 256])
torch.Size([98285, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 2.355438232421875  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.8590679168701172  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.8629846572875977  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.8629851341247559  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

first layer input nodes number: 10513
first layer output nodes number: 1041
edges number: 25506
torch.Size([10513, 100])
torch.Size([1041, 256])
input nodes number: 1041
output nodes number: 41
edges number: 1415
torch.Size([1041, 256])
torch.Size([41, 256])
torch.Size([1, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.0075168609619140625  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

Total (block generation + training)time/epoch 22.14332585334778
* Pure training time/epoch 2.7854979038238525
Training time/epoch 1656995698.6750572
Training time without block to device /epoch 1656995697.208286
Training time without total dataloading part /epoch 0.2810394763946533
load block tensor time/epoch 1.0376873016357422
block to device time/epoch 1.466771125793457
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  10790036
Number of first layer input nodes during this epoch:  4510432
Number of first layer output nodes during this epoch:  0
Number of all edges in block send to gpu during this epoch:  152799393
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.006992816925048828  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.8453292846679688  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.8460617065429688  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

first layer input nodes number: 2250392
first layer output nodes number: 2040406
edges number: 39653505
torch.Size([2250392, 100])
torch.Size([2040406, 256])
input nodes number: 2040406
output nodes number: 1096528
edges number: 32945841
torch.Size([2040406, 256])
torch.Size([1096528, 256])
torch.Size([98285, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 2.3535046577453613  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 0.8593530654907227  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 1.6974201202392578  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2869873046875 GB
    Memory Allocated: 1.6981525421142578  GigaBytes
Max Memory Allocated: 12.75770378112793  GigaBytes

first layer input nodes number: 2249668
first layer output nodes number: 2041801
edges number: 39685491
torch.Size([2249668, 100])
torch.Size([2041801, 256])
input nodes number: 2041801
output nodes number: 1101118
edges number: 33090335
torch.Size([2041801, 256])
torch.Size([1101118, 256])
torch.Size([98285, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.1678466796875 GB
    Memory Allocated: 2.3547840118408203  GigaBytes
Max Memory Allocated: 12.762237548828125  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 21.1678466796875 GB
    Memory Allocated: 0.8590836524963379  GigaBytes
Max Memory Allocated: 12.762237548828125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.1678466796875 GB
    Memory Allocated: 0.8608717918395996  GigaBytes
Max Memory Allocated: 12.762237548828125  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.1678466796875 GB
    Memory Allocated: 0.8608722686767578  GigaBytes
Max Memory Allocated: 12.762237548828125  GigaBytes

first layer input nodes number: 4799
first layer output nodes number: 615
edges number: 13626
torch.Size([4799, 100])
torch.Size([615, 256])
input nodes number: 615
output nodes number: 41
edges number: 1265
torch.Size([615, 256])
torch.Size([41, 256])
torch.Size([1, 47])
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 0.0051517486572265625  GigaBytes
Max Memory Allocated: 12.762237548828125  GigaBytes

Total (block generation + training)time/epoch 21.47506046295166
* Pure training time/epoch 2.7845048904418945
Training time/epoch 1656995716.8094764
Training time without block to device /epoch 1656995715.4429505
Training time without total dataloading part /epoch 0.5321290493011475
load block tensor time/epoch 0.8858499526977539
block to device time/epoch 1.3665258884429932
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  10785368
Number of first layer input nodes during this epoch:  4504859
Number of first layer output nodes during this epoch:  0
Number of all edges in block send to gpu during this epoch:  152820623
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
