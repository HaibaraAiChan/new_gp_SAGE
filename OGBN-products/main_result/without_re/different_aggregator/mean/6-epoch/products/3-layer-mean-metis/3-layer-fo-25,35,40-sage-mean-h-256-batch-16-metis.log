main start at this time 1656970330.438542
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3262801170349121
global_2_local spend time (sec) 0.4948849678039551
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 1.405 seconds
Metis partitioning: 2.293 seconds
Split the graph: 0.197 seconds
Construct subgraphs: 0.045 seconds
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
The batched output nid list before graph partition
total k batches seeds list generation spend  3.991237163543701
after graph partition
graph partition algorithm spend time 5.012088775634766
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
partition_len_list
[341335, 334995, 334388, 331965, 330972, 338154, 331094, 329950, 343533, 342707, 340093, 338765, 330853, 328380, 338695, 342062]
metis selection method  spend 5.750967979431152
time for parepare:  0.27954792976379395
local_output_nid generation:  0.003773212432861328
local_in_edges_tensor generation:  0.00565648078918457
mini_batch_src_global generation:  0.018291950225830078
r_  generation:  0.18453550338745117
local_output_nid generation:  0.004408597946166992
local_in_edges_tensor generation:  0.005542278289794922
mini_batch_src_global generation:  0.02182292938232422
r_  generation:  0.20325732231140137
local_output_nid generation:  0.004381418228149414
local_in_edges_tensor generation:  0.005471706390380859
mini_batch_src_global generation:  0.015268325805664062
r_  generation:  0.20739150047302246
local_output_nid generation:  0.0044214725494384766
local_in_edges_tensor generation:  0.005478620529174805
mini_batch_src_global generation:  0.016248226165771484
r_  generation:  0.21203041076660156
local_output_nid generation:  0.0044019222259521484
local_in_edges_tensor generation:  0.0053555965423583984
mini_batch_src_global generation:  0.016052961349487305
r_  generation:  0.22665047645568848
local_output_nid generation:  0.004624605178833008
local_in_edges_tensor generation:  0.007451534271240234
mini_batch_src_global generation:  0.02494025230407715
r_  generation:  0.24204516410827637
local_output_nid generation:  0.004429340362548828
local_in_edges_tensor generation:  0.0063648223876953125
mini_batch_src_global generation:  0.022822141647338867
r_  generation:  0.2469642162322998
local_output_nid generation:  0.004387855529785156
local_in_edges_tensor generation:  0.006610393524169922
mini_batch_src_global generation:  0.023360013961791992
r_  generation:  0.24515342712402344
local_output_nid generation:  0.004590749740600586
local_in_edges_tensor generation:  0.0056340694427490234
mini_batch_src_global generation:  0.02086925506591797
r_  generation:  0.2602822780609131
local_output_nid generation:  0.005877494812011719
local_in_edges_tensor generation:  0.005663633346557617
mini_batch_src_global generation:  0.022057294845581055
r_  generation:  0.26130104064941406
local_output_nid generation:  0.004513740539550781
local_in_edges_tensor generation:  0.0055353641510009766
mini_batch_src_global generation:  0.022977352142333984
r_  generation:  0.267134428024292
local_output_nid generation:  0.004556894302368164
local_in_edges_tensor generation:  0.022998809814453125
mini_batch_src_global generation:  0.023411035537719727
r_  generation:  0.27184104919433594
local_output_nid generation:  0.015494823455810547
local_in_edges_tensor generation:  0.02892470359802246
mini_batch_src_global generation:  0.023979663848876953
r_  generation:  0.26870155334472656
local_output_nid generation:  0.007344722747802734
local_in_edges_tensor generation:  0.015180826187133789
mini_batch_src_global generation:  0.02323126792907715
r_  generation:  0.2611527442932129
local_output_nid generation:  0.004588603973388672
local_in_edges_tensor generation:  0.00956106185913086
mini_batch_src_global generation:  0.024636030197143555
r_  generation:  0.26691675186157227
local_output_nid generation:  0.00457453727722168
local_in_edges_tensor generation:  0.006938934326171875
mini_batch_src_global generation:  0.025755643844604492
r_  generation:  0.2684667110443115
----------------------check_connections_block total spend ----------------------------- 5.563743591308594
generate_one_block  1.8482980728149414
generate_one_block  0.2830629348754883
generate_one_block  0.28770971298217773
generate_one_block  0.30245494842529297
generate_one_block  0.4227275848388672
generate_one_block  0.44324398040771484
generate_one_block  0.3476138114929199
generate_one_block  0.29198741912841797
generate_one_block  0.30882716178894043
generate_one_block  0.28203392028808594
generate_one_block  0.2748541831970215
generate_one_block  0.27564477920532227
generate_one_block  0.2654435634613037
generate_one_block  0.2617931365966797
generate_one_block  0.2795071601867676
generate_one_block  0.2829713821411133
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.17818284034729
gen group dst list time:  0.17740702629089355
time for parepare:  0.46198129653930664
local_output_nid generation:  0.11147189140319824
local_in_edges_tensor generation:  0.4371919631958008
mini_batch_src_global generation:  0.37137389183044434
r_  generation:  4.461427688598633
local_output_nid generation:  0.13780927658081055
local_in_edges_tensor generation:  0.314072847366333
mini_batch_src_global generation:  0.48085522651672363
r_  generation:  4.553062200546265
local_output_nid generation:  0.1408824920654297
local_in_edges_tensor generation:  0.41182494163513184
mini_batch_src_global generation:  0.43523526191711426
r_  generation:  4.629580020904541
local_output_nid generation:  0.11652088165283203
local_in_edges_tensor generation:  0.5290699005126953
mini_batch_src_global generation:  0.4854311943054199
r_  generation:  4.681248426437378
local_output_nid generation:  0.13991189002990723
local_in_edges_tensor generation:  0.2973172664642334
mini_batch_src_global generation:  0.4627213478088379
r_  generation:  4.665530681610107
local_output_nid generation:  0.1101231575012207
local_in_edges_tensor generation:  0.30231237411499023
mini_batch_src_global generation:  0.501837968826294
r_  generation:  4.830960988998413
local_output_nid generation:  0.10843133926391602
local_in_edges_tensor generation:  0.41416049003601074
mini_batch_src_global generation:  0.4813196659088135
r_  generation:  4.777568101882935
local_output_nid generation:  0.15186262130737305
local_in_edges_tensor generation:  0.29242706298828125
mini_batch_src_global generation:  0.5026466846466064
r_  generation:  4.652402639389038
local_output_nid generation:  0.11308622360229492
local_in_edges_tensor generation:  0.29387950897216797
mini_batch_src_global generation:  0.5099210739135742
r_  generation:  4.832790374755859
local_output_nid generation:  0.1118326187133789
local_in_edges_tensor generation:  0.2934856414794922
mini_batch_src_global generation:  0.4991943836212158
r_  generation:  4.928339719772339
local_output_nid generation:  0.11202645301818848
local_in_edges_tensor generation:  0.28929972648620605
mini_batch_src_global generation:  0.5146477222442627
r_  generation:  4.887284755706787
local_output_nid generation:  0.11251592636108398
local_in_edges_tensor generation:  0.3177199363708496
mini_batch_src_global generation:  0.49915194511413574
r_  generation:  5.048700332641602
local_output_nid generation:  0.11059284210205078
local_in_edges_tensor generation:  0.40383410453796387
mini_batch_src_global generation:  0.522061824798584
r_  generation:  4.84806227684021
local_output_nid generation:  0.11738729476928711
local_in_edges_tensor generation:  0.2901170253753662
mini_batch_src_global generation:  0.48969221115112305
r_  generation:  4.8024327754974365
local_output_nid generation:  0.13139629364013672
local_in_edges_tensor generation:  0.2898542881011963
mini_batch_src_global generation:  0.49784207344055176
r_  generation:  4.822713613510132
local_output_nid generation:  0.11176657676696777
local_in_edges_tensor generation:  0.2908322811126709
mini_batch_src_global generation:  0.5050888061523438
r_  generation:  4.909090280532837
----------------------check_connections_block total spend ----------------------------- 104.82964992523193
generate_one_block  6.753608465194702
generate_one_block  5.90678334236145
generate_one_block  5.927592754364014
generate_one_block  5.817777633666992
generate_one_block  5.846174478530884
generate_one_block  6.043944358825684
generate_one_block  5.936288356781006
generate_one_block  5.9060282707214355
generate_one_block  6.155355930328369
generate_one_block  6.094391822814941
generate_one_block  5.952112436294556
generate_one_block  5.940968751907349
generate_one_block  5.8224029541015625
generate_one_block  5.75673770904541
generate_one_block  5.953253746032715
generate_one_block  5.990760564804077
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.296307325363159
gen group dst list time:  0.9023334980010986
time for parepare:  0.4701201915740967
local_output_nid generation:  0.5126862525939941
local_in_edges_tensor generation:  1.2967805862426758
mini_batch_src_global generation:  1.120793104171753
r_  generation:  13.518719911575317
local_output_nid generation:  0.5649416446685791
local_in_edges_tensor generation:  1.269406795501709
mini_batch_src_global generation:  1.3837153911590576
r_  generation:  13.608184099197388
local_output_nid generation:  0.5318703651428223
local_in_edges_tensor generation:  1.4062354564666748
mini_batch_src_global generation:  1.3783812522888184
r_  generation:  13.36221694946289
local_output_nid generation:  0.5511770248413086
local_in_edges_tensor generation:  1.0551066398620605
mini_batch_src_global generation:  1.415381908416748
r_  generation:  13.582828760147095
local_output_nid generation:  0.5266783237457275
local_in_edges_tensor generation:  1.1380891799926758
mini_batch_src_global generation:  1.3453865051269531
r_  generation:  13.407243251800537
local_output_nid generation:  0.5478346347808838
local_in_edges_tensor generation:  2.167595863342285
mini_batch_src_global generation:  1.3576481342315674
r_  generation:  13.562597751617432
local_output_nid generation:  0.5023062229156494
local_in_edges_tensor generation:  1.054485559463501
mini_batch_src_global generation:  1.4095790386199951
r_  generation:  13.46975588798523
local_output_nid generation:  0.5047194957733154
local_in_edges_tensor generation:  1.040210247039795
mini_batch_src_global generation:  1.3556628227233887
r_  generation:  13.411346912384033
local_output_nid generation:  0.5036067962646484
local_in_edges_tensor generation:  1.0523922443389893
mini_batch_src_global generation:  1.3947696685791016
r_  generation:  13.56787919998169
local_output_nid generation:  0.5371346473693848
local_in_edges_tensor generation:  1.2070386409759521
mini_batch_src_global generation:  1.3759782314300537
r_  generation:  13.491633892059326
local_output_nid generation:  0.5375618934631348
local_in_edges_tensor generation:  1.0592892169952393
mini_batch_src_global generation:  1.3690879344940186
r_  generation:  13.524096488952637
local_output_nid generation:  0.5217373371124268
local_in_edges_tensor generation:  1.0653164386749268
mini_batch_src_global generation:  1.3647613525390625
r_  generation:  13.560067892074585
local_output_nid generation:  0.511878252029419
local_in_edges_tensor generation:  1.0490977764129639
mini_batch_src_global generation:  1.3804759979248047
r_  generation:  13.40720796585083
local_output_nid generation:  0.5066299438476562
local_in_edges_tensor generation:  1.0483381748199463
mini_batch_src_global generation:  1.355294942855835
r_  generation:  13.42441725730896
local_output_nid generation:  0.5233545303344727
local_in_edges_tensor generation:  1.0592663288116455
mini_batch_src_global generation:  1.3951232433319092
r_  generation:  13.68700623512268
local_output_nid generation:  0.5240492820739746
local_in_edges_tensor generation:  1.0622589588165283
mini_batch_src_global generation:  1.3974363803863525
r_  generation:  13.505919218063354
----------------------check_connections_block total spend ----------------------------- 304.19047260284424
generate_one_block  18.484928846359253
generate_one_block  17.60602903366089
generate_one_block  17.690457582473755
generate_one_block  17.567906856536865
generate_one_block  18.01276993751526
generate_one_block  17.730416536331177
generate_one_block  17.84244418144226
generate_one_block  18.73351216316223
generate_one_block  18.19990587234497
generate_one_block  18.596551656723022
generate_one_block  18.009018421173096
generate_one_block  18.464068174362183
generate_one_block  18.47980308532715
generate_one_block  18.19737672805786
generate_one_block  17.943949460983276
generate_one_block  18.72005534172058
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  414.58386611938477
block generation total time  392.54154920578003
average batch blocks generation time:  8.177948941787085
block dataloader generation time/epoch 833.4142482280731
pseudo mini batch 0 input nodes size: 2130445
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.7944216728210449  GigaBytes
Max Memory Allocated: 0.7944216728210449  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.7945151329040527  GigaBytes
Max Memory Allocated: 0.7945151329040527  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.7945151329040527  GigaBytes
Max Memory Allocated: 0.7945151329040527  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 1.1280760765075684  GigaBytes
Max Memory Allocated: 1.1280760765075684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 1.1280760765075684  GigaBytes
Max Memory Allocated: 1.1280760765075684  GigaBytes

first layer input nodes number: 2130445
first layer output nodes number: 1553395
edges number: 33235371
torch.Size([2130445, 100])
torch.Size([1553395, 256])
input nodes number: 1553395
output nodes number: 341335
edges number: 11035558
torch.Size([1553395, 256])
torch.Size([341335, 256])
torch.Size([12523, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.8338623046875 GB
    Memory Allocated: 6.497960567474365  GigaBytes
Max Memory Allocated: 6.803462505340576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.8338623046875 GB
    Memory Allocated: 6.500154495239258  GigaBytes
Max Memory Allocated: 6.803462505340576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.4510498046875 GB
    Memory Allocated: 1.6062664985656738  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

pseudo mini batch 1 input nodes size: 2122728
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4510498046875 GB
    Memory Allocated: 0.7974777221679688  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4510498046875 GB
    Memory Allocated: 0.7974777221679688  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4510498046875 GB
    Memory Allocated: 1.5882558822631836  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4510498046875 GB
    Memory Allocated: 1.5883479118347168  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4510498046875 GB
    Memory Allocated: 0.7946014404296875  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4510498046875 GB
    Memory Allocated: 1.1252965927124023  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4510498046875 GB
    Memory Allocated: 1.1252965927124023  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

first layer input nodes number: 2122728
first layer output nodes number: 1535371
edges number: 32908618
torch.Size([2122728, 100])
torch.Size([1535371, 256])
input nodes number: 1535371
output nodes number: 334995
edges number: 10830660
torch.Size([1535371, 256])
torch.Size([334995, 256])
torch.Size([12289, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4510498046875 GB
    Memory Allocated: 6.425509452819824  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4510498046875 GB
    Memory Allocated: 6.427661895751953  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5976414680480957  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

pseudo mini batch 2 input nodes size: 2125260
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7950296401977539  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7950296401977539  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5867509841918945  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5868420600891113  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7959718704223633  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.1266603469848633  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.1266603469848633  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

first layer input nodes number: 2125260
first layer output nodes number: 1541299
edges number: 33020111
torch.Size([2125260, 100])
torch.Size([1541299, 256])
input nodes number: 1541299
output nodes number: 334388
edges number: 10828919
torch.Size([1541299, 256])
torch.Size([334388, 256])
torch.Size([12207, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.439111232757568  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.441732883453369  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5986151695251465  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

pseudo mini batch 3 input nodes size: 2127138
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7954883575439453  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7954883575439453  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.58790922164917  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5879998207092285  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7961874008178711  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.126230239868164  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.126230239868164  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

first layer input nodes number: 2127138
first layer output nodes number: 1540846
edges number: 33046636
torch.Size([2127138, 100])
torch.Size([1540846, 256])
input nodes number: 1540846
output nodes number: 331965
edges number: 10743066
torch.Size([1540846, 256])
torch.Size([331965, 256])
torch.Size([12121, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.431337356567383  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.433460235595703  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5970921516418457  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

pseudo mini batch 4 input nodes size: 2123949
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7969970703125  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7969970703125  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5882301330566406  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5883197784423828  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7958083152770996  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.1257481575012207  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.1257481575012207  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

first layer input nodes number: 2123949
first layer output nodes number: 1534231
edges number: 32900003
torch.Size([2123949, 100])
torch.Size([1534231, 256])
input nodes number: 1534231
output nodes number: 330972
edges number: 10715469
torch.Size([1534231, 256])
torch.Size([330972, 256])
torch.Size([11985, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.408043384552002  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.410991191864014  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5943999290466309  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

pseudo mini batch 5 input nodes size: 2129259
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7952985763549805  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7952985763549805  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5885095596313477  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.588602066040039  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7972793579101562  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.1297597885131836  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.1297597885131836  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

first layer input nodes number: 2129259
first layer output nodes number: 1546208
edges number: 33090364
torch.Size([2129259, 100])
torch.Size([1546208, 256])
input nodes number: 1546208
output nodes number: 338154
edges number: 10933453
torch.Size([1546208, 256])
torch.Size([338154, 256])
torch.Size([12388, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.469918727874756  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.4729461669921875  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.6034154891967773  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

pseudo mini batch 6 input nodes size: 2127825
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7976503372192383  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7976503372192383  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.590327262878418  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5904169082641602  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7971134185791016  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.1270170211791992  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.1270170211791992  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

first layer input nodes number: 2127825
first layer output nodes number: 1540896
edges number: 33051708
torch.Size([2127825, 100])
torch.Size([1540896, 256])
input nodes number: 1540896
output nodes number: 331094
edges number: 10724375
torch.Size([1540896, 256])
torch.Size([331094, 256])
torch.Size([12014, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.4278388023376465  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.430856227874756  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5960779190063477  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

pseudo mini batch 7 input nodes size: 2121638
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7965497970581055  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7965497970581055  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5869216918945312  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5870108604431152  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7942442893981934  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.1238350868225098  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.1238350868225098  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

first layer input nodes number: 2121638
first layer output nodes number: 1532097
edges number: 32873133
torch.Size([2121638, 100])
torch.Size([1532097, 256])
input nodes number: 1532097
output nodes number: 329950
edges number: 10682445
torch.Size([1532097, 256])
torch.Size([329950, 256])
torch.Size([11967, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.397403240203857  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.399499416351318  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5925359725952148  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

pseudo mini batch 8 input nodes size: 2130037
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7940950393676758  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7940950393676758  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5875959396362305  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5876903533935547  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7972292900085449  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.1308484077453613  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.1308484077453613  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

first layer input nodes number: 2130037
first layer output nodes number: 1552370
edges number: 33183579
torch.Size([2130037, 100])
torch.Size([1552370, 256])
input nodes number: 1552370
output nodes number: 343533
edges number: 11116212
torch.Size([1552370, 256])
torch.Size([343533, 256])
torch.Size([12621, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.50510835647583  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 6.507485389709473  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.6094484329223633  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

pseudo mini batch 9 input nodes size: 2131786
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7973437309265137  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7973437309265137  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5914959907531738  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.5915899276733398  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 0.7979946136474609  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.134164810180664  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9178466796875 GB
    Memory Allocated: 1.134164810180664  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

first layer input nodes number: 2131786
first layer output nodes number: 1556330
edges number: 33294689
torch.Size([2131786, 100])
torch.Size([1556330, 256])
input nodes number: 1556330
output nodes number: 342707
edges number: 11089145
torch.Size([1556330, 256])
torch.Size([342707, 256])
torch.Size([12583, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3709716796875 GB
    Memory Allocated: 6.518588542938232  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3709716796875 GB
    Memory Allocated: 6.520792484283447  GigaBytes
Max Memory Allocated: 8.48085069656372  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.6146368980407715  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 10 input nodes size: 2129840
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7979879379272461  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7979879379272461  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.5914154052734375  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.591508388519287  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7972621917724609  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.1306724548339844  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.1306724548339844  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2129840
first layer output nodes number: 1555049
edges number: 33245519
torch.Size([2129840, 100])
torch.Size([1555049, 256])
input nodes number: 1555049
output nodes number: 340093
edges number: 11003860
torch.Size([1555049, 256])
torch.Size([340093, 256])
torch.Size([12437, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 6.499765872955322  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 6.501944065093994  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.6067605018615723  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 11 input nodes size: 2130296
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.797236442565918  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.797236442565918  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.5908336639404297  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.590926170349121  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7974057197570801  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.129786491394043  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.129786491394043  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2130296
first layer output nodes number: 1548610
edges number: 33132001
torch.Size([2130296, 100])
torch.Size([1548610, 256])
input nodes number: 1548610
output nodes number: 338765
edges number: 10955262
torch.Size([1548610, 256])
torch.Size([338765, 256])
torch.Size([12412, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 6.477413177490234  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 6.479587078094482  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.6044354438781738  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 12 input nodes size: 2124369
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7974014282226562  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7974014282226562  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.5887908935546875  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.5888805389404297  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7951908111572266  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.1250677108764648  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.1250677108764648  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2124369
first layer output nodes number: 1538787
edges number: 32983166
torch.Size([2124369, 100])
torch.Size([1538787, 256])
input nodes number: 1538787
output nodes number: 330853
edges number: 10720879
torch.Size([1538787, 256])
torch.Size([330853, 256])
torch.Size([12002, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 6.4195451736450195  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 6.421647071838379  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.595046043395996  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 13 input nodes size: 2121806
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7951455116271973  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7951455116271973  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.5855798721313477  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.5856695175170898  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7941904067993164  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.1218500137329102  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.1218500137329102  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2121806
first layer output nodes number: 1531657
edges number: 32821357
torch.Size([2121806, 100])
torch.Size([1531657, 256])
input nodes number: 1531657
output nodes number: 328380
edges number: 10623724
torch.Size([1531657, 256])
torch.Size([328380, 256])
torch.Size([12001, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 6.388333320617676  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 6.3904619216918945  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.588496208190918  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 14 input nodes size: 2133062
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.794163703918457  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.794163703918457  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.589085578918457  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.5891785621643066  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7986545562744141  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.1322755813598633  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.1322755813598633  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2133062
first layer output nodes number: 1554258
edges number: 33243474
torch.Size([2133062, 100])
torch.Size([1554258, 256])
input nodes number: 1554258
output nodes number: 338695
edges number: 10941954
torch.Size([1554258, 256])
torch.Size([338695, 256])
torch.Size([12475, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 6.494823932647705  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 6.497008800506592  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.6063756942749023  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 15 input nodes size: 2131512
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7987375259399414  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7987375259399414  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.592787742614746  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.592881679534912  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 0.7978668212890625  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.1317148208618164  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.1317148208618164  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2131512
first layer output nodes number: 1555367
edges number: 33271298
torch.Size([2131512, 100])
torch.Size([1555367, 256])
input nodes number: 1555367
output nodes number: 342062
edges number: 11063015
torch.Size([1555367, 256])
torch.Size([342062, 256])
torch.Size([12546, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 6.509740352630615  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 6.512176036834717  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8572998046875 GB
    Memory Allocated: 1.6090502738952637  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.6105875968933105  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.6105875968933105  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.36423490941524506 |0.49984200298786163 |0.13967978954315186 |0.00013975799083709717 |0.014090776443481445 |0.007443666458129883 |
----------------------------------------------------------pseudo_mini_loss sum 7.16602897644043
Total (block generation + training)time/epoch 849.9051692485809
Training time/epoch 16.490636348724365
Training time without block to device /epoch 8.493164300918579
Training time without total dataloading part /epoch 2.4700088500976562
load block tensor time/epoch 5.827758550643921
block to device time/epoch 7.997472047805786
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64135662
Number of first layer input nodes during this epoch:  34040950
Number of first layer output nodes during this epoch:  24716771
----------------------------------------before generate dataloader block 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.6105871200561523  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4499211311340332
global_2_local spend time (sec) 0.5312063694000244
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.496 seconds
Metis partitioning: 2.947 seconds
Split the graph: 0.255 seconds
Construct subgraphs: 0.013 seconds
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
The batched output nid list before graph partition
total k batches seeds list generation spend  3.757664442062378
after graph partition
graph partition algorithm spend time 4.838053226470947
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
partition_len_list
[340460, 336447, 334323, 333946, 330893, 338812, 330675, 328399, 343614, 342975, 337751, 338140, 330230, 331437, 340060, 341675]
metis selection method  spend 5.6248931884765625
time for parepare:  0.2935163974761963
local_output_nid generation:  0.0038077831268310547
local_in_edges_tensor generation:  0.005629777908325195
mini_batch_src_global generation:  0.022687673568725586
r_  generation:  0.18167901039123535
local_output_nid generation:  0.004424571990966797
local_in_edges_tensor generation:  0.0065996646881103516
mini_batch_src_global generation:  0.0253140926361084
r_  generation:  0.20115327835083008
local_output_nid generation:  0.00443577766418457
local_in_edges_tensor generation:  0.005571126937866211
mini_batch_src_global generation:  0.01516413688659668
r_  generation:  0.2014017105102539
local_output_nid generation:  0.004450082778930664
local_in_edges_tensor generation:  0.005603313446044922
mini_batch_src_global generation:  0.01616978645324707
r_  generation:  0.21539783477783203
local_output_nid generation:  0.0043468475341796875
local_in_edges_tensor generation:  0.006581783294677734
mini_batch_src_global generation:  0.016170024871826172
r_  generation:  0.2235267162322998
local_output_nid generation:  0.004474163055419922
local_in_edges_tensor generation:  0.005579233169555664
mini_batch_src_global generation:  0.01905345916748047
r_  generation:  0.2351524829864502
local_output_nid generation:  0.00966024398803711
local_in_edges_tensor generation:  0.0056188106536865234
mini_batch_src_global generation:  0.019934654235839844
r_  generation:  0.25348615646362305
local_output_nid generation:  0.0043447017669677734
local_in_edges_tensor generation:  0.005464792251586914
mini_batch_src_global generation:  0.019621610641479492
r_  generation:  0.23931336402893066
local_output_nid generation:  0.004524946212768555
local_in_edges_tensor generation:  0.005736827850341797
mini_batch_src_global generation:  0.020879745483398438
r_  generation:  0.2643699645996094
local_output_nid generation:  0.004545450210571289
local_in_edges_tensor generation:  0.0073015689849853516
mini_batch_src_global generation:  0.02191448211669922
r_  generation:  0.26529884338378906
local_output_nid generation:  0.005765676498413086
local_in_edges_tensor generation:  0.022501707077026367
mini_batch_src_global generation:  0.023036718368530273
r_  generation:  0.2620656490325928
local_output_nid generation:  0.004549741744995117
local_in_edges_tensor generation:  0.012416362762451172
mini_batch_src_global generation:  0.022916793823242188
r_  generation:  0.2769498825073242
local_output_nid generation:  0.0043964385986328125
local_in_edges_tensor generation:  0.007998228073120117
mini_batch_src_global generation:  0.02983856201171875
r_  generation:  0.2647745609283447
local_output_nid generation:  0.007413387298583984
local_in_edges_tensor generation:  0.006348609924316406
mini_batch_src_global generation:  0.02348780632019043
r_  generation:  0.2615344524383545
local_output_nid generation:  0.0045053958892822266
local_in_edges_tensor generation:  0.00659942626953125
mini_batch_src_global generation:  0.024302005767822266
r_  generation:  0.26071763038635254
local_output_nid generation:  0.004517078399658203
local_in_edges_tensor generation:  0.005733013153076172
mini_batch_src_global generation:  0.025287389755249023
r_  generation:  0.27376461029052734
----------------------check_connections_block total spend ----------------------------- 5.537672758102417
generate_one_block  0.6383466720581055
generate_one_block  0.32544445991516113
generate_one_block  0.2843441963195801
generate_one_block  0.2740452289581299
generate_one_block  0.26566267013549805
generate_one_block  0.2777121067047119
generate_one_block  0.26489686965942383
generate_one_block  0.2629127502441406
generate_one_block  0.3437819480895996
generate_one_block  0.27434563636779785
generate_one_block  0.2724442481994629
generate_one_block  0.27385616302490234
generate_one_block  0.2678394317626953
generate_one_block  0.26608705520629883
generate_one_block  0.27916622161865234
generate_one_block  0.27694034576416016
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1733241081237793
gen group dst list time:  0.18308186531066895
time for parepare:  0.4626436233520508
local_output_nid generation:  0.1106865406036377
local_in_edges_tensor generation:  0.4656357765197754
mini_batch_src_global generation:  0.37714338302612305
r_  generation:  4.364574432373047
local_output_nid generation:  0.1122446060180664
local_in_edges_tensor generation:  0.35297489166259766
mini_batch_src_global generation:  0.48321008682250977
r_  generation:  4.620401620864868
local_output_nid generation:  0.14268159866333008
local_in_edges_tensor generation:  0.3586738109588623
mini_batch_src_global generation:  0.4333610534667969
r_  generation:  4.5186848640441895
local_output_nid generation:  0.11440777778625488
local_in_edges_tensor generation:  0.2894759178161621
mini_batch_src_global generation:  0.45788121223449707
r_  generation:  4.691890478134155
local_output_nid generation:  0.12598013877868652
local_in_edges_tensor generation:  0.2866935729980469
mini_batch_src_global generation:  0.47492527961730957
r_  generation:  4.820014238357544
local_output_nid generation:  0.12265372276306152
local_in_edges_tensor generation:  0.517951250076294
mini_batch_src_global generation:  0.507061243057251
r_  generation:  4.793613910675049
local_output_nid generation:  0.12290430068969727
local_in_edges_tensor generation:  0.3101482391357422
mini_batch_src_global generation:  0.4837515354156494
r_  generation:  4.694287300109863
local_output_nid generation:  0.11083579063415527
local_in_edges_tensor generation:  0.2989943027496338
mini_batch_src_global generation:  0.48375892639160156
r_  generation:  4.684323072433472
local_output_nid generation:  0.1138155460357666
local_in_edges_tensor generation:  0.2960176467895508
mini_batch_src_global generation:  0.5130298137664795
r_  generation:  4.924767017364502
local_output_nid generation:  0.11336469650268555
local_in_edges_tensor generation:  0.2919156551361084
mini_batch_src_global generation:  0.5071630477905273
r_  generation:  4.942990303039551
local_output_nid generation:  0.11188912391662598
local_in_edges_tensor generation:  0.41805243492126465
mini_batch_src_global generation:  0.5041112899780273
r_  generation:  4.860055685043335
local_output_nid generation:  0.13279008865356445
local_in_edges_tensor generation:  0.302217960357666
mini_batch_src_global generation:  0.5042314529418945
r_  generation:  4.838166236877441
local_output_nid generation:  0.10973858833312988
local_in_edges_tensor generation:  0.284609317779541
mini_batch_src_global generation:  0.49350547790527344
r_  generation:  4.731508731842041
local_output_nid generation:  0.11009454727172852
local_in_edges_tensor generation:  0.2832915782928467
mini_batch_src_global generation:  0.5008118152618408
r_  generation:  4.762479543685913
local_output_nid generation:  0.12448453903198242
local_in_edges_tensor generation:  0.290956974029541
mini_batch_src_global generation:  0.5028440952301025
r_  generation:  4.864737272262573
local_output_nid generation:  0.11298894882202148
local_in_edges_tensor generation:  0.29030466079711914
mini_batch_src_global generation:  0.5310440063476562
r_  generation:  4.954145669937134
----------------------check_connections_block total spend ----------------------------- 104.41424536705017
generate_one_block  6.477707386016846
generate_one_block  6.161057472229004
generate_one_block  6.166234493255615
generate_one_block  5.892781734466553
generate_one_block  6.337824821472168
generate_one_block  6.005686283111572
generate_one_block  6.227236747741699
generate_one_block  5.967614412307739
generate_one_block  6.362194061279297
generate_one_block  6.064133644104004
generate_one_block  6.10895299911499
generate_one_block  6.154922962188721
generate_one_block  6.124366283416748
generate_one_block  6.218964099884033
generate_one_block  6.341042995452881
generate_one_block  6.381204605102539
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3777053356170654
gen group dst list time:  0.9512531757354736
time for parepare:  0.48830103874206543
local_output_nid generation:  0.5151233673095703
local_in_edges_tensor generation:  1.3085741996765137
mini_batch_src_global generation:  1.1282901763916016
r_  generation:  13.762182235717773
local_output_nid generation:  0.5181143283843994
local_in_edges_tensor generation:  1.2545626163482666
mini_batch_src_global generation:  1.5240142345428467
r_  generation:  13.956743717193604
local_output_nid generation:  0.5794768333435059
local_in_edges_tensor generation:  1.1184847354888916
mini_batch_src_global generation:  1.3570308685302734
r_  generation:  13.895026445388794
local_output_nid generation:  0.5355496406555176
local_in_edges_tensor generation:  1.1173582077026367
mini_batch_src_global generation:  1.415982961654663
r_  generation:  14.030782222747803
local_output_nid generation:  0.5421719551086426
local_in_edges_tensor generation:  1.3660914897918701
mini_batch_src_global generation:  1.3995380401611328
r_  generation:  14.197407960891724
local_output_nid generation:  0.549567699432373
local_in_edges_tensor generation:  1.1145410537719727
mini_batch_src_global generation:  1.3919484615325928
r_  generation:  14.158624172210693
local_output_nid generation:  0.5756661891937256
local_in_edges_tensor generation:  1.0568525791168213
mini_batch_src_global generation:  1.3687505722045898
r_  generation:  13.934271574020386
local_output_nid generation:  0.530980110168457
local_in_edges_tensor generation:  1.0479304790496826
mini_batch_src_global generation:  1.4046947956085205
r_  generation:  13.70198106765747
local_output_nid generation:  0.5360431671142578
local_in_edges_tensor generation:  1.208033561706543
mini_batch_src_global generation:  1.4059350490570068
r_  generation:  13.70342469215393
local_output_nid generation:  0.5358583927154541
local_in_edges_tensor generation:  1.0781161785125732
mini_batch_src_global generation:  1.384375810623169
r_  generation:  13.786581039428711
local_output_nid generation:  0.5294833183288574
local_in_edges_tensor generation:  1.0746612548828125
mini_batch_src_global generation:  1.3854961395263672
r_  generation:  13.735578775405884
local_output_nid generation:  0.5915317535400391
local_in_edges_tensor generation:  1.063657522201538
mini_batch_src_global generation:  1.3809418678283691
r_  generation:  13.649036169052124
local_output_nid generation:  0.5293674468994141
local_in_edges_tensor generation:  1.0551855564117432
mini_batch_src_global generation:  1.4382762908935547
r_  generation:  13.596556425094604
local_output_nid generation:  0.5341660976409912
local_in_edges_tensor generation:  1.1899466514587402
mini_batch_src_global generation:  1.3746743202209473
r_  generation:  13.62988018989563
local_output_nid generation:  0.5329453945159912
local_in_edges_tensor generation:  1.0840494632720947
mini_batch_src_global generation:  1.4014253616333008
r_  generation:  13.884398698806763
local_output_nid generation:  0.5411157608032227
local_in_edges_tensor generation:  1.0630342960357666
mini_batch_src_global generation:  1.4254465103149414
r_  generation:  13.710243463516235
----------------------check_connections_block total spend ----------------------------- 310.36405539512634
generate_one_block  18.623350143432617
generate_one_block  19.311879873275757
generate_one_block  18.465196132659912
generate_one_block  18.093054056167603
generate_one_block  17.99029850959778
generate_one_block  18.51921582221985
generate_one_block  18.499550104141235
generate_one_block  18.681267261505127
generate_one_block  18.063668251037598
generate_one_block  18.924047231674194
generate_one_block  18.67250370979309
generate_one_block  18.11998462677002
generate_one_block  18.66512966156006
generate_one_block  18.625735998153687
generate_one_block  18.398778438568115
generate_one_block  18.753037214279175
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.6105871200561523  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

connection checking time:  420.31597352027893
block generation total time  400.24644804000854
average batch blocks generation time:  8.338467667500177
block dataloader generation time/epoch 840.9520189762115
pseudo mini batch 0 input nodes size: 2127269
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7994155883789062  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7994155883789062  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5918850898742676  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5919785499572754  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7978343963623047  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.130331039428711  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.130331039428711  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2127269
first layer output nodes number: 1546015
edges number: 33092560
torch.Size([2127269, 100])
torch.Size([1546015, 256])
input nodes number: 1546015
output nodes number: 340460
edges number: 11005870
torch.Size([1546015, 256])
torch.Size([340460, 256])
torch.Size([12523, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.477152347564697  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.47934627532959  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.6063055992126465  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 1 input nodes size: 2129300
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7978315353393555  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7978315353393555  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5910577774047852  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5911498069763184  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7985868453979492  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.1315412521362305  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.1315412521362305  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2129300
first layer output nodes number: 1546885
edges number: 33153974
torch.Size([2129300, 100])
torch.Size([1546885, 256])
input nodes number: 1546885
output nodes number: 336447
edges number: 10892156
torch.Size([1546885, 256])
torch.Size([336447, 256])
torch.Size([12289, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.466802597045898  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.468955039978027  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.6040120124816895  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 2 input nodes size: 2128609
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7985458374023438  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7985458374023438  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5915145874023438  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5916056632995605  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.1288928985595703  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.1288928985595703  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2128609
first layer output nodes number: 1543797
edges number: 33084216
torch.Size([2128609, 100])
torch.Size([1543797, 256])
input nodes number: 1543797
output nodes number: 334323
edges number: 10818671
torch.Size([1543797, 256])
torch.Size([334323, 256])
torch.Size([12207, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.449700832366943  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.4525322914123535  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.600766658782959  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 3 input nodes size: 2127558
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7988014221191406  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7988014221191406  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5913786888122559  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5914692878723145  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7984094619750977  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.1289591789245605  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.1289591789245605  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2127558
first layer output nodes number: 1543165
edges number: 33060587
torch.Size([2127558, 100])
torch.Size([1543165, 256])
input nodes number: 1543165
output nodes number: 333946
edges number: 10803635
torch.Size([1543165, 256])
torch.Size([333946, 256])
torch.Size([12121, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.4443840980529785  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.44705057144165  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.600785255432129  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 4 input nodes size: 2122646
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7978658676147461  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7978658676147461  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.588613510131836  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5887031555175781  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7960352897644043  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.1238007545471191  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.1238007545471191  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2122646
first layer output nodes number: 1532738
edges number: 32834316
torch.Size([2122646, 100])
torch.Size([1532738, 256])
input nodes number: 1532738
output nodes number: 330893
edges number: 10703105
torch.Size([1532738, 256])
torch.Size([330893, 256])
torch.Size([11985, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.401799201965332  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.403898239135742  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5917301177978516  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 5 input nodes size: 2129510
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7960114479064941  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7960114479064941  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5893158912658691  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5894083976745605  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7985711097717285  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.1311006546020508  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.1311006546020508  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2129510
first layer output nodes number: 1549897
edges number: 33155669
torch.Size([2129510, 100])
torch.Size([1549897, 256])
input nodes number: 1549897
output nodes number: 338812
edges number: 10948027
torch.Size([1549897, 256])
torch.Size([338812, 256])
torch.Size([12388, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.4823784828186035  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.484548091888428  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.6055545806884766  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 6 input nodes size: 2125315
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7989239692687988  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7989239692687988  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5906658172607422  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5907554626464844  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.797358512878418  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.1271734237670898  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.1271734237670898  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2125315
first layer output nodes number: 1535439
edges number: 32949075
torch.Size([2125315, 100])
torch.Size([1535439, 256])
input nodes number: 1535439
output nodes number: 330675
edges number: 10712455
torch.Size([1535439, 256])
torch.Size([330675, 256])
torch.Size([12014, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.413320064544678  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.415424346923828  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5977706909179688  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 7 input nodes size: 2127072
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7979683876037598  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7979683876037598  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5903644561767578  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5904536247253418  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7986221313476562  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.128115177154541  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.128115177154541  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2127072
first layer output nodes number: 1534610
edges number: 32885810
torch.Size([2127072, 100])
torch.Size([1534610, 256])
input nodes number: 1534610
output nodes number: 328399
edges number: 10626139
torch.Size([1534610, 256])
torch.Size([328399, 256])
torch.Size([11967, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.401729106903076  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.403825283050537  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.594672679901123  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 8 input nodes size: 2134212
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7976565361022949  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.7976565361022949  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5927128791809082  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5928072929382324  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.8003220558166504  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.134443759918213  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.134443759918213  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2134212
first layer output nodes number: 1555485
edges number: 33265634
torch.Size([2134212, 100])
torch.Size([1555485, 256])
input nodes number: 1555485
output nodes number: 343614
edges number: 11102314
torch.Size([1555485, 256])
torch.Size([343614, 256])
torch.Size([12621, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.518784046173096  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 6.520994663238525  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.6119704246520996  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

pseudo mini batch 9 input nodes size: 2131663
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.8005094528198242  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.8005094528198242  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5954313278198242  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.5955252647399902  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 0.8003745079040527  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.136497974395752  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8592529296875 GB
    Memory Allocated: 1.136497974395752  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

first layer input nodes number: 2131663
first layer output nodes number: 1558203
edges number: 33315861
torch.Size([2131663, 100])
torch.Size([1558203, 256])
input nodes number: 1558203
output nodes number: 342975
edges number: 11084164
torch.Size([1558203, 256])
torch.Size([342975, 256])
torch.Size([12583, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.0740966796875 GB
    Memory Allocated: 6.525150299072266  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.0740966796875 GB
    Memory Allocated: 6.5273542404174805  GigaBytes
Max Memory Allocated: 8.503273487091064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.615140438079834  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 10 input nodes size: 2128395
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.8002948760986328  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.8002948760986328  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.593183994293213  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.5932769775390625  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.7982611656188965  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.1312365531921387  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.1312365531921387  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128395
first layer output nodes number: 1548234
edges number: 33156823
torch.Size([2128395, 100])
torch.Size([1548234, 256])
input nodes number: 1548234
output nodes number: 337751
edges number: 10925200
torch.Size([1548234, 256])
torch.Size([337751, 256])
torch.Size([12437, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 6.473657608032227  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 6.476603031158447  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.6049137115478516  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 11 input nodes size: 2133199
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.7982354164123535  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.7982354164123535  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.5931572914123535  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.593249797821045  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.8002676963806152  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.133622646331787  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.133622646331787  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2133199
first layer output nodes number: 1549784
edges number: 33207683
torch.Size([2133199, 100])
torch.Size([1549784, 256])
input nodes number: 1549784
output nodes number: 338140
edges number: 10942596
torch.Size([1549784, 256])
torch.Size([338140, 256])
torch.Size([12412, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 6.482422351837158  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 6.484596252441406  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.608304500579834  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 12 input nodes size: 2122370
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.8002634048461914  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.8002634048461914  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.5909080505371094  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.5909976959228516  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.7959833145141602  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.1236639022827148  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.1236639022827148  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2122370
first layer output nodes number: 1529771
edges number: 32818153
torch.Size([2122370, 100])
torch.Size([1529771, 256])
input nodes number: 1529771
output nodes number: 330230
edges number: 10708547
torch.Size([1529771, 256])
torch.Size([330230, 256])
torch.Size([12002, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 6.391843795776367  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 6.394920349121094  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.5913267135620117  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 13 input nodes size: 2124869
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.7959113121032715  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.7959113121032715  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.587486743927002  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.5875763893127441  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.796842098236084  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.1267914772033691  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.1267914772033691  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2124869
first layer output nodes number: 1535523
edges number: 32928205
torch.Size([2124869, 100])
torch.Size([1535523, 256])
input nodes number: 1535523
output nodes number: 331437
edges number: 10730515
torch.Size([1535523, 256])
torch.Size([331437, 256])
torch.Size([12001, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 6.414758682250977  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 6.4170918464660645  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.5978569984436035  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 14 input nodes size: 2132438
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.7969379425048828  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.7969379425048828  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.5913333892822266  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.5914263725280762  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.7997612953186035  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.1332497596740723  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.1332497596740723  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2132438
first layer output nodes number: 1551620
edges number: 33225673
torch.Size([2132438, 100])
torch.Size([1551620, 256])
input nodes number: 1551620
output nodes number: 340060
edges number: 11003905
torch.Size([1551620, 256])
torch.Size([340060, 256])
torch.Size([12475, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 6.492374897003174  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 6.4945597648620605  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.6090455055236816  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 15 input nodes size: 2129534
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.799748420715332  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.799748420715332  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.593061923980713  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.593155860900879  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 0.7986674308776855  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.1320281028747559  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 1.1320281028747559  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2129534
first layer output nodes number: 1554706
edges number: 33208570
torch.Size([2129534, 100])
torch.Size([1554706, 256])
input nodes number: 1554706
output nodes number: 341675
edges number: 11036424
torch.Size([1554706, 256])
torch.Size([341675, 256])
torch.Size([12546, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 6.503889560699463  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5623779296875 GB
    Memory Allocated: 6.506096839904785  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0467529296875 GB
    Memory Allocated: 1.6074604988098145  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6074604988098145  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6074604988098145  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37119321525096893 |0.39603203535079956 |0.11897413432598114 |0.00014159083366394043 |0.009967833757400513 |0.004790306091308594 |
----------------------------------------------------------pseudo_mini_loss sum 12.427483558654785
Total (block generation + training)time/epoch 856.4757413864136
Training time/epoch 14.55608606338501
Training time without block to device /epoch 8.219573497772217
Training time without total dataloading part /epoch 2.070127248764038
load block tensor time/epoch 5.939091444015503
block to device time/epoch 6.336512565612793
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64149668
Number of first layer input nodes during this epoch:  34053959
Number of first layer output nodes during this epoch:  24715872
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6074600219726562  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3754448890686035
global_2_local spend time (sec) 0.584082841873169
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.432 seconds
Metis partitioning: 3.139 seconds
Split the graph: 0.319 seconds
Construct subgraphs: 0.046 seconds
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
The batched output nid list before graph partition
total k batches seeds list generation spend  3.9792845249176025
after graph partition
graph partition algorithm spend time 5.065932989120483
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
partition_len_list
[341611, 336011, 333776, 333159, 330355, 337899, 330140, 329614, 342772, 341604, 339253, 339219, 331051, 329708, 340445, 341695]
metis selection method  spend 5.923817157745361
time for parepare:  0.2741515636444092
local_output_nid generation:  0.003942251205444336
local_in_edges_tensor generation:  0.005263566970825195
mini_batch_src_global generation:  0.017291545867919922
r_  generation:  0.18448638916015625
local_output_nid generation:  0.004575252532958984
local_in_edges_tensor generation:  0.005150318145751953
mini_batch_src_global generation:  0.028966426849365234
r_  generation:  0.20408844947814941
local_output_nid generation:  0.004525899887084961
local_in_edges_tensor generation:  0.005206584930419922
mini_batch_src_global generation:  0.012733221054077148
r_  generation:  0.20766735076904297
local_output_nid generation:  0.004516124725341797
local_in_edges_tensor generation:  0.0051724910736083984
mini_batch_src_global generation:  0.01380157470703125
r_  generation:  0.217512845993042
local_output_nid generation:  0.0045201778411865234
local_in_edges_tensor generation:  0.005148887634277344
mini_batch_src_global generation:  0.013516426086425781
r_  generation:  0.22381186485290527
local_output_nid generation:  0.0046312808990478516
local_in_edges_tensor generation:  0.005240201950073242
mini_batch_src_global generation:  0.0212857723236084
r_  generation:  0.23705267906188965
local_output_nid generation:  0.00448918342590332
local_in_edges_tensor generation:  0.0060062408447265625
mini_batch_src_global generation:  0.017318010330200195
r_  generation:  0.25374650955200195
local_output_nid generation:  0.004505634307861328
local_in_edges_tensor generation:  0.005167245864868164
mini_batch_src_global generation:  0.017658472061157227
r_  generation:  0.2507150173187256
local_output_nid generation:  0.006207704544067383
local_in_edges_tensor generation:  0.005412578582763672
mini_batch_src_global generation:  0.018443822860717773
r_  generation:  0.25644803047180176
local_output_nid generation:  0.004694223403930664
local_in_edges_tensor generation:  0.007297039031982422
mini_batch_src_global generation:  0.019530296325683594
r_  generation:  0.2603724002838135
local_output_nid generation:  0.004639387130737305
local_in_edges_tensor generation:  0.0054168701171875
mini_batch_src_global generation:  0.020834684371948242
r_  generation:  0.2662034034729004
local_output_nid generation:  0.004601478576660156
local_in_edges_tensor generation:  0.006864309310913086
mini_batch_src_global generation:  0.02083754539489746
r_  generation:  0.26505041122436523
local_output_nid generation:  0.00447845458984375
local_in_edges_tensor generation:  0.005412101745605469
mini_batch_src_global generation:  0.02139592170715332
r_  generation:  0.2559657096862793
local_output_nid generation:  0.00468134880065918
local_in_edges_tensor generation:  0.005349874496459961
mini_batch_src_global generation:  0.021094560623168945
r_  generation:  0.2586510181427002
local_output_nid generation:  0.004607200622558594
local_in_edges_tensor generation:  0.005362749099731445
mini_batch_src_global generation:  0.024413108825683594
r_  generation:  0.2689783573150635
local_output_nid generation:  0.0046384334564208984
local_in_edges_tensor generation:  0.008583307266235352
mini_batch_src_global generation:  0.022931575775146484
r_  generation:  0.2682311534881592
----------------------check_connections_block total spend ----------------------------- 5.484508752822876
generate_one_block  0.6602764129638672
generate_one_block  0.33484935760498047
generate_one_block  0.28539061546325684
generate_one_block  0.2739136219024658
generate_one_block  0.2724785804748535
generate_one_block  0.2776651382446289
generate_one_block  0.2686629295349121
generate_one_block  0.26506590843200684
generate_one_block  0.28253769874572754
generate_one_block  0.2804415225982666
generate_one_block  0.279116153717041
generate_one_block  0.27483201026916504
generate_one_block  0.2881276607513428
generate_one_block  0.26841211318969727
generate_one_block  0.28602075576782227
generate_one_block  0.2819833755493164
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2654781341552734
gen group dst list time:  0.17546367645263672
time for parepare:  0.48190975189208984
local_output_nid generation:  0.11475229263305664
local_in_edges_tensor generation:  0.42971158027648926
mini_batch_src_global generation:  0.3862903118133545
r_  generation:  4.448060989379883
local_output_nid generation:  0.11120367050170898
local_in_edges_tensor generation:  0.33714818954467773
mini_batch_src_global generation:  0.4495053291320801
r_  generation:  4.7508533000946045
local_output_nid generation:  0.13364267349243164
local_in_edges_tensor generation:  0.31101369857788086
mini_batch_src_global generation:  0.4563586711883545
r_  generation:  4.590339183807373
local_output_nid generation:  0.11266970634460449
local_in_edges_tensor generation:  0.28949975967407227
mini_batch_src_global generation:  0.4640660285949707
r_  generation:  4.662661075592041
local_output_nid generation:  0.12170124053955078
local_in_edges_tensor generation:  0.31158947944641113
mini_batch_src_global generation:  0.4839615821838379
r_  generation:  4.729335308074951
local_output_nid generation:  0.11355710029602051
local_in_edges_tensor generation:  0.3060486316680908
mini_batch_src_global generation:  0.5083596706390381
r_  generation:  4.944591760635376
local_output_nid generation:  0.11623597145080566
local_in_edges_tensor generation:  0.5321681499481201
mini_batch_src_global generation:  0.527400016784668
r_  generation:  4.6819167137146
local_output_nid generation:  0.12171697616577148
local_in_edges_tensor generation:  0.3195149898529053
mini_batch_src_global generation:  0.4845883846282959
r_  generation:  4.710826873779297
local_output_nid generation:  0.11663126945495605
local_in_edges_tensor generation:  0.3069431781768799
mini_batch_src_global generation:  0.5036249160766602
r_  generation:  4.853787660598755
local_output_nid generation:  0.11676144599914551
local_in_edges_tensor generation:  0.3013298511505127
mini_batch_src_global generation:  0.5091714859008789
r_  generation:  4.886160850524902
local_output_nid generation:  0.12416243553161621
local_in_edges_tensor generation:  0.30302000045776367
mini_batch_src_global generation:  0.5035221576690674
r_  generation:  4.87104344367981
local_output_nid generation:  0.11378026008605957
local_in_edges_tensor generation:  0.2920396327972412
mini_batch_src_global generation:  0.505673885345459
r_  generation:  4.866008281707764
local_output_nid generation:  0.11133408546447754
local_in_edges_tensor generation:  0.36280369758605957
mini_batch_src_global generation:  0.4960482120513916
r_  generation:  4.772130012512207
local_output_nid generation:  0.1108407974243164
local_in_edges_tensor generation:  0.293870210647583
mini_batch_src_global generation:  0.4958474636077881
r_  generation:  4.8441808223724365
local_output_nid generation:  0.114013671875
local_in_edges_tensor generation:  0.35959959030151367
mini_batch_src_global generation:  0.5397622585296631
r_  generation:  4.876596927642822
local_output_nid generation:  0.13259673118591309
local_in_edges_tensor generation:  0.30030250549316406
mini_batch_src_global generation:  0.5114462375640869
r_  generation:  4.90510368347168
----------------------check_connections_block total spend ----------------------------- 104.78053331375122
generate_one_block  6.604053020477295
generate_one_block  5.990267753601074
generate_one_block  5.966176986694336
generate_one_block  5.974050045013428
generate_one_block  5.899057626724243
generate_one_block  6.069060564041138
generate_one_block  5.911595106124878
generate_one_block  5.87673544883728
generate_one_block  6.47620964050293
generate_one_block  6.142469644546509
generate_one_block  6.0637359619140625
generate_one_block  6.08306097984314
generate_one_block  6.046998023986816
generate_one_block  6.162606477737427
generate_one_block  6.196451902389526
generate_one_block  6.118031978607178
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3064992427825928
gen group dst list time:  0.911557674407959
time for parepare:  0.47441697120666504
local_output_nid generation:  0.5268421173095703
local_in_edges_tensor generation:  1.1889235973358154
mini_batch_src_global generation:  1.1597270965576172
r_  generation:  14.317261457443237
local_output_nid generation:  0.5501694679260254
local_in_edges_tensor generation:  1.0585033893585205
mini_batch_src_global generation:  1.444075107574463
r_  generation:  13.796773910522461
local_output_nid generation:  0.5276663303375244
local_in_edges_tensor generation:  1.1413776874542236
mini_batch_src_global generation:  1.3661463260650635
r_  generation:  14.493839263916016
local_output_nid generation:  0.5901668071746826
local_in_edges_tensor generation:  1.1346032619476318
mini_batch_src_global generation:  1.3808841705322266
r_  generation:  13.847461462020874
local_output_nid generation:  0.5490627288818359
local_in_edges_tensor generation:  1.0638506412506104
mini_batch_src_global generation:  1.3880658149719238
r_  generation:  14.368036270141602
local_output_nid generation:  0.539304256439209
local_in_edges_tensor generation:  1.0652906894683838
mini_batch_src_global generation:  1.467858076095581
r_  generation:  14.179388046264648
local_output_nid generation:  0.5370619297027588
local_in_edges_tensor generation:  1.0618174076080322
mini_batch_src_global generation:  1.4476501941680908
r_  generation:  14.57108449935913
local_output_nid generation:  0.544381856918335
local_in_edges_tensor generation:  1.1384100914001465
mini_batch_src_global generation:  1.4415795803070068
r_  generation:  13.809204578399658
local_output_nid generation:  0.5732824802398682
local_in_edges_tensor generation:  1.1556549072265625
mini_batch_src_global generation:  1.401684284210205
r_  generation:  13.685808420181274
local_output_nid generation:  0.5672144889831543
local_in_edges_tensor generation:  1.0740633010864258
mini_batch_src_global generation:  1.385535478591919
r_  generation:  13.757062435150146
local_output_nid generation:  0.5585734844207764
local_in_edges_tensor generation:  1.0834424495697021
mini_batch_src_global generation:  1.379446029663086
r_  generation:  13.706894636154175
local_output_nid generation:  0.5445950031280518
local_in_edges_tensor generation:  1.1326076984405518
mini_batch_src_global generation:  1.3861827850341797
r_  generation:  13.733823537826538
local_output_nid generation:  0.5508303642272949
local_in_edges_tensor generation:  1.0822651386260986
mini_batch_src_global generation:  1.3888566493988037
r_  generation:  13.688805103302002
local_output_nid generation:  0.5754668712615967
local_in_edges_tensor generation:  1.138584852218628
mini_batch_src_global generation:  1.376101016998291
r_  generation:  13.493957757949829
local_output_nid generation:  0.5620031356811523
local_in_edges_tensor generation:  1.0791223049163818
mini_batch_src_global generation:  1.3847413063049316
r_  generation:  13.76602578163147
local_output_nid generation:  0.550631046295166
local_in_edges_tensor generation:  1.0738375186920166
mini_batch_src_global generation:  1.4314210414886475
r_  generation:  13.856928825378418
----------------------check_connections_block total spend ----------------------------- 310.7839562892914
generate_one_block  18.477890491485596
generate_one_block  18.347779035568237
generate_one_block  17.895894527435303
generate_one_block  18.10201859474182
generate_one_block  17.989436864852905
generate_one_block  20.035133361816406
generate_one_block  18.166032552719116
generate_one_block  18.10141396522522
generate_one_block  19.063079357147217
generate_one_block  18.38991355895996
generate_one_block  18.722078800201416
generate_one_block  18.873380422592163
generate_one_block  18.128779411315918
generate_one_block  18.910005569458008
generate_one_block  18.83601450920105
generate_one_block  18.28957962989807
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6074600219726562  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

connection checking time:  421.0489983558655
block generation total time  398.788765668869
average batch blocks generation time:  8.308099284768105
block dataloader generation time/epoch 843.1027928988138
pseudo mini batch 0 input nodes size: 2129431
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7986788749694824  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7986788749694824  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5919537544250488  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5920472145080566  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7986397743225098  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.131706714630127  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.131706714630127  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2129431
first layer output nodes number: 1549542
edges number: 33169142
torch.Size([2129431, 100])
torch.Size([1549542, 256])
input nodes number: 1549542
output nodes number: 341611
edges number: 11044728
torch.Size([1549542, 256])
torch.Size([341611, 256])
torch.Size([12523, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.490882873535156  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.493114471435547  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.608177661895752  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 1 input nodes size: 2128364
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7986369132995605  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7986369132995605  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5915145874023438  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.591606616973877  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982382774353027  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.129209041595459  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.129209041595459  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128364
first layer output nodes number: 1543324
edges number: 33050608
torch.Size([2128364, 100])
torch.Size([1543324, 256])
input nodes number: 1543324
output nodes number: 336011
edges number: 10867613
torch.Size([1543324, 256])
torch.Size([336011, 256])
torch.Size([12289, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.4538068771362305  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.4562907218933105  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6022396087646484  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 2 input nodes size: 2126520
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7983169555664062  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7983169555664062  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5905075073242188  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5905985832214355  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7976288795471191  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.128100872039795  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.128100872039795  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2126520
first layer output nodes number: 1542556
edges number: 33061243
torch.Size([2126520, 100])
torch.Size([1542556, 256])
input nodes number: 1542556
output nodes number: 333776
edges number: 10800726
torch.Size([1542556, 256])
torch.Size([333776, 256])
torch.Size([12207, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.441955089569092  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.444093227386475  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5992012023925781  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 3 input nodes size: 2126183
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7974948883056641  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7974948883056641  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5895600318908691  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5896506309509277  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7973690032958984  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1277227401733398  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1277227401733398  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2126183
first layer output nodes number: 1543798
edges number: 33056764
torch.Size([2126183, 100])
torch.Size([1543798, 256])
input nodes number: 1543798
output nodes number: 333159
edges number: 10784851
torch.Size([1543798, 256])
torch.Size([333159, 256])
torch.Size([12121, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.443188190460205  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.446045398712158  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5997629165649414  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 4 input nodes size: 2126732
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980232238769531  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980232238769531  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5902929306030273  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5903825759887695  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982268333435059  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1281943321228027  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1281943321228027  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2126732
first layer output nodes number: 1535718
edges number: 32918642
torch.Size([2126732, 100])
torch.Size([1535718, 256])
input nodes number: 1535718
output nodes number: 330355
edges number: 10681127
torch.Size([1535718, 256])
torch.Size([330355, 256])
torch.Size([11985, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.413440227508545  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.415809154510498  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5970964431762695  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 5 input nodes size: 2127916
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7975335121154785  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7975335121154785  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5902442932128906  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.590336799621582  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7979774475097656  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.130772590637207  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.130772590637207  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2127916
first layer output nodes number: 1546313
edges number: 33132592
torch.Size([2127916, 100])
torch.Size([1546313, 256])
input nodes number: 1546313
output nodes number: 337899
edges number: 10951993
torch.Size([1546313, 256])
torch.Size([337899, 256])
torch.Size([12388, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.471007823944092  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.473519325256348  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6060738563537598  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 6 input nodes size: 2124602
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980480194091797  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980480194091797  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.589524269104004  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.589613914489746  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7968106269836426  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1264395713806152  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1264395713806152  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2124602
first layer output nodes number: 1534595
edges number: 32922113
torch.Size([2124602, 100])
torch.Size([1534595, 256])
input nodes number: 1534595
output nodes number: 330140
edges number: 10687492
torch.Size([1534595, 256])
torch.Size([330140, 256])
torch.Size([12014, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.407954216003418  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.410309791564941  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5961933135986328  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 7 input nodes size: 2125471
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7969965934753418  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7969965934753418  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.588796615600586  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.58888578414917  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7973198890686035  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1260976791381836  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1260976791381836  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2125471
first layer output nodes number: 1536015
edges number: 32907797
torch.Size([2125471, 100])
torch.Size([1536015, 256])
input nodes number: 1536015
output nodes number: 329614
edges number: 10663185
torch.Size([1536015, 256])
torch.Size([329614, 256])
torch.Size([11967, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.408609867095947  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.410965442657471  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5946102142333984  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 8 input nodes size: 2129054
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.797060489654541  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.797060489654541  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5901951789855957  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.59028959274292  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7984004020690918  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1320476531982422  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1320476531982422  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2129054
first layer output nodes number: 1549842
edges number: 33161101
torch.Size([2129054, 100])
torch.Size([1549842, 256])
input nodes number: 1549842
output nodes number: 342772
edges number: 11085441
torch.Size([1549842, 256])
torch.Size([342772, 256])
torch.Size([12621, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.495595455169678  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.497806072235107  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.607863426208496  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 9 input nodes size: 2127942
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7985148429870605  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7985148429870605  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5912351608276367  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5913290977478027  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980999946594238  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1311774253845215  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1311774253845215  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2127942
first layer output nodes number: 1551137
edges number: 33170510
torch.Size([2127942, 100])
torch.Size([1551137, 256])
input nodes number: 1551137
output nodes number: 341604
edges number: 11053746
torch.Size([1551137, 256])
torch.Size([341604, 256])
torch.Size([12583, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.494256496429443  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.496898651123047  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.607527732849121  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 10 input nodes size: 2131487
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.798093318939209  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.798093318939209  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5921344757080078  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5922274589538574  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7994132041931152  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1325554847717285  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1325554847717285  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2131487
first layer output nodes number: 1550559
edges number: 33179153
torch.Size([2131487, 100])
torch.Size([1550559, 256])
input nodes number: 1550559
output nodes number: 339253
edges number: 10972403
torch.Size([1550559, 256])
torch.Size([339253, 256])
torch.Size([12437, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.485701084136963  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.487879276275635  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6067004203796387  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 11 input nodes size: 2131753
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7993874549865723  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7993874549865723  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5943093299865723  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5944018363952637  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.8002676963806152  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.133375644683838  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.133375644683838  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2131753
first layer output nodes number: 1551856
edges number: 33174542
torch.Size([2131753, 100])
torch.Size([1551856, 256])
input nodes number: 1551856
output nodes number: 339219
edges number: 10960306
torch.Size([1551856, 256])
torch.Size([339219, 256])
torch.Size([12412, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.490110397338867  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.492284297943115  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6087646484375  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 12 input nodes size: 2127214
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.8002634048461914  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.8002634048461914  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.59271240234375  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5928020477294922  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7977876663208008  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.127558708190918  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.127558708190918  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2127214
first layer output nodes number: 1537843
edges number: 32981906
torch.Size([2127214, 100])
torch.Size([1537843, 256])
input nodes number: 1537843
output nodes number: 331051
edges number: 10706641
torch.Size([1537843, 256])
torch.Size([331051, 256])
torch.Size([12002, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.420230865478516  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.422344207763672  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5975003242492676  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 13 input nodes size: 2124618
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7977156639099121  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7977156639099121  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5891976356506348  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.589287281036377  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7967486381530762  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1262459754943848  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1262459754943848  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2124618
first layer output nodes number: 1532213
edges number: 32847854
torch.Size([2124618, 100])
torch.Size([1532213, 256])
input nodes number: 1532213
output nodes number: 329708
edges number: 10669942
torch.Size([1532213, 256])
torch.Size([329708, 256])
torch.Size([12001, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.39960241317749  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.40170431137085  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5942177772521973  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 14 input nodes size: 2128418
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7968530654907227  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7968530654907227  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5897507667541504  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.58984375  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982721328735352  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1311492919921875  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1311492919921875  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128418
first layer output nodes number: 1548579
edges number: 33143646
torch.Size([2128418, 100])
torch.Size([1548579, 256])
input nodes number: 1548579
output nodes number: 340445
edges number: 11015758
torch.Size([1548579, 256])
torch.Size([340445, 256])
torch.Size([12475, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.484023571014404  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.486208438873291  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6062870025634766  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 15 input nodes size: 2131662
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.798250675201416  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.798250675201416  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.593172550201416  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.593266487121582  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.8002758026123047  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1339006423950195  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1339006423950195  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2131662
first layer output nodes number: 1554072
edges number: 33243968
torch.Size([2131662, 100])
torch.Size([1554072, 256])
input nodes number: 1554072
output nodes number: 341695
edges number: 11056642
torch.Size([1554072, 256])
torch.Size([341695, 256])
torch.Size([12546, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.504927635192871  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.507124900817871  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6107406616210938  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6107406616210938  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6107406616210938  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3666287660598755 |0.3881169557571411 |0.10097454488277435 |0.00013828277587890625 |0.004999980330467224 |0.0027108192443847656 |
----------------------------------------------------------pseudo_mini_loss sum 3.6133034229278564
Total (block generation + training)time/epoch 858.1216566562653
Training time/epoch 14.00882339477539
Training time without block to device /epoch 7.798952102661133
Training time without total dataloading part /epoch 1.7005157470703125
load block tensor time/epoch 5.866060256958008
block to device time/epoch 6.209871292114258
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  64133641
Number of first layer input nodes during this epoch:  34047367
Number of first layer output nodes during this epoch:  24707962
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6107401847839355  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3464975357055664
global_2_local spend time (sec) 0.6162490844726562
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.470 seconds
Metis partitioning: 3.310 seconds
Split the graph: 0.345 seconds
Construct subgraphs: 0.066 seconds
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
The batched output nid list before graph partition
total k batches seeds list generation spend  4.248461961746216
after graph partition
graph partition algorithm spend time 5.32645583152771
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
partition_len_list
[338378, 330413, 332458, 339970, 329938, 337453, 337521, 342425, 334552, 341314, 340860, 335231, 334590, 339781, 332810, 332457]
metis selection method  spend 6.227312326431274
time for parepare:  0.28459811210632324
local_output_nid generation:  0.004004001617431641
local_in_edges_tensor generation:  0.008409738540649414
mini_batch_src_global generation:  0.01693558692932129
r_  generation:  0.17905068397521973
local_output_nid generation:  0.004509449005126953
local_in_edges_tensor generation:  0.00817251205444336
mini_batch_src_global generation:  0.020209312438964844
r_  generation:  0.19375896453857422
local_output_nid generation:  0.004469394683837891
local_in_edges_tensor generation:  0.0067675113677978516
mini_batch_src_global generation:  0.012792587280273438
r_  generation:  0.20145559310913086
local_output_nid generation:  0.004654407501220703
local_in_edges_tensor generation:  0.009656906127929688
mini_batch_src_global generation:  0.013958215713500977
r_  generation:  0.22417664527893066
local_output_nid generation:  0.004563808441162109
local_in_edges_tensor generation:  0.007592439651489258
mini_batch_src_global generation:  0.014079809188842773
r_  generation:  0.219482421875
local_output_nid generation:  0.004579782485961914
local_in_edges_tensor generation:  0.005290031433105469
mini_batch_src_global generation:  0.017611265182495117
r_  generation:  0.24106717109680176
local_output_nid generation:  0.005910634994506836
local_in_edges_tensor generation:  0.0068509578704833984
mini_batch_src_global generation:  0.01784372329711914
r_  generation:  0.25413990020751953
local_output_nid generation:  0.004694223403930664
local_in_edges_tensor generation:  0.023374557495117188
mini_batch_src_global generation:  0.018502235412597656
r_  generation:  0.2550034523010254
local_output_nid generation:  0.004585981369018555
local_in_edges_tensor generation:  0.01187896728515625
mini_batch_src_global generation:  0.018151521682739258
r_  generation:  0.24732160568237305
local_output_nid generation:  0.004647731781005859
local_in_edges_tensor generation:  0.009006738662719727
mini_batch_src_global generation:  0.02448582649230957
r_  generation:  0.26311564445495605
local_output_nid generation:  0.005924701690673828
local_in_edges_tensor generation:  0.006535768508911133
mini_batch_src_global generation:  0.020435094833374023
r_  generation:  0.2669978141784668
local_output_nid generation:  0.004593849182128906
local_in_edges_tensor generation:  0.007279396057128906
mini_batch_src_global generation:  0.02068471908569336
r_  generation:  0.26128482818603516
local_output_nid generation:  0.00460052490234375
local_in_edges_tensor generation:  0.005425691604614258
mini_batch_src_global generation:  0.020653963088989258
r_  generation:  0.2569141387939453
local_output_nid generation:  0.004661083221435547
local_in_edges_tensor generation:  0.008494853973388672
mini_batch_src_global generation:  0.02165699005126953
r_  generation:  0.2673184871673584
local_output_nid generation:  0.0045452117919921875
local_in_edges_tensor generation:  0.005407094955444336
mini_batch_src_global generation:  0.021797657012939453
r_  generation:  0.2594301700592041
local_output_nid generation:  0.004544973373413086
local_in_edges_tensor generation:  0.006373882293701172
mini_batch_src_global generation:  0.02327275276184082
r_  generation:  0.2578718662261963
----------------------check_connections_block total spend ----------------------------- 5.472677707672119
generate_one_block  0.6598691940307617
generate_one_block  0.3343522548675537
generate_one_block  0.2843775749206543
generate_one_block  0.2897961139678955
generate_one_block  0.2885701656341553
generate_one_block  0.27413415908813477
generate_one_block  0.2738492488861084
generate_one_block  0.28079867362976074
generate_one_block  0.2760789394378662
generate_one_block  0.2776975631713867
generate_one_block  0.2852599620819092
generate_one_block  0.2717156410217285
generate_one_block  0.2975325584411621
generate_one_block  0.2810707092285156
generate_one_block  0.3417165279388428
generate_one_block  0.4242062568664551
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.3468596935272217
gen group dst list time:  0.17014384269714355
time for parepare:  0.4640939235687256
local_output_nid generation:  0.11438584327697754
local_in_edges_tensor generation:  0.40895891189575195
mini_batch_src_global generation:  0.3701171875
r_  generation:  4.324291467666626
local_output_nid generation:  0.11031055450439453
local_in_edges_tensor generation:  0.2862894535064697
mini_batch_src_global generation:  0.46393609046936035
r_  generation:  4.407088279724121
local_output_nid generation:  0.12100505828857422
local_in_edges_tensor generation:  0.29079294204711914
mini_batch_src_global generation:  0.44528698921203613
r_  generation:  4.54405403137207
local_output_nid generation:  0.11150479316711426
local_in_edges_tensor generation:  0.31073951721191406
mini_batch_src_global generation:  0.469470739364624
r_  generation:  4.731431245803833
local_output_nid generation:  0.10849952697753906
local_in_edges_tensor generation:  0.4174351692199707
mini_batch_src_global generation:  0.47969913482666016
r_  generation:  4.691138982772827
local_output_nid generation:  0.11107063293457031
local_in_edges_tensor generation:  0.31665778160095215
mini_batch_src_global generation:  0.49294400215148926
r_  generation:  5.026892900466919
local_output_nid generation:  0.11289501190185547
local_in_edges_tensor generation:  0.4474670886993408
mini_batch_src_global generation:  0.533994197845459
r_  generation:  4.8160669803619385
local_output_nid generation:  0.1258106231689453
local_in_edges_tensor generation:  0.31449270248413086
mini_batch_src_global generation:  0.5031378269195557
r_  generation:  4.856223106384277
local_output_nid generation:  0.11345529556274414
local_in_edges_tensor generation:  0.2947232723236084
mini_batch_src_global generation:  0.4989323616027832
r_  generation:  4.772377252578735
local_output_nid generation:  0.12436389923095703
local_in_edges_tensor generation:  0.29579687118530273
mini_batch_src_global generation:  0.5050797462463379
r_  generation:  4.885831117630005
local_output_nid generation:  0.1146085262298584
local_in_edges_tensor generation:  0.29647397994995117
mini_batch_src_global generation:  0.508699893951416
r_  generation:  4.924642562866211
local_output_nid generation:  0.11253237724304199
local_in_edges_tensor generation:  0.2879202365875244
mini_batch_src_global generation:  0.5182845592498779
r_  generation:  4.858941555023193
local_output_nid generation:  0.11295247077941895
local_in_edges_tensor generation:  0.3599076271057129
mini_batch_src_global generation:  0.5073902606964111
r_  generation:  4.846601247787476
local_output_nid generation:  0.11458611488342285
local_in_edges_tensor generation:  0.29860448837280273
mini_batch_src_global generation:  0.5324180126190186
r_  generation:  4.9269773960113525
local_output_nid generation:  0.11209392547607422
local_in_edges_tensor generation:  0.29125404357910156
mini_batch_src_global generation:  0.5032167434692383
r_  generation:  4.8528969287872314
local_output_nid generation:  0.11203646659851074
local_in_edges_tensor generation:  0.3572359085083008
mini_batch_src_global generation:  0.5169966220855713
r_  generation:  4.9122209548950195
----------------------check_connections_block total spend ----------------------------- 104.85961318016052
generate_one_block  6.564732789993286
generate_one_block  5.887103319168091
generate_one_block  5.94085431098938
generate_one_block  6.060197353363037
generate_one_block  5.8877174854278564
generate_one_block  6.016669273376465
generate_one_block  6.042620420455933
generate_one_block  6.114722728729248
generate_one_block  6.328524351119995
generate_one_block  6.128800630569458
generate_one_block  6.0871262550354
generate_one_block  5.982198476791382
generate_one_block  5.979140281677246
generate_one_block  6.077358722686768
generate_one_block  5.9556357860565186
generate_one_block  5.936978101730347
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.328402042388916
gen group dst list time:  0.9061281681060791
time for parepare:  0.48261070251464844
local_output_nid generation:  0.5274155139923096
local_in_edges_tensor generation:  1.308927297592163
mini_batch_src_global generation:  1.1293885707855225
r_  generation:  13.07167363166809
local_output_nid generation:  0.5724236965179443
local_in_edges_tensor generation:  1.097297191619873
mini_batch_src_global generation:  1.3391749858856201
r_  generation:  13.315514326095581
local_output_nid generation:  0.5289366245269775
local_in_edges_tensor generation:  1.2067532539367676
mini_batch_src_global generation:  1.3839070796966553
r_  generation:  13.489110231399536
local_output_nid generation:  0.5272562503814697
local_in_edges_tensor generation:  1.1897926330566406
mini_batch_src_global generation:  1.4175410270690918
r_  generation:  13.697129011154175
local_output_nid generation:  0.5313014984130859
local_in_edges_tensor generation:  1.1263206005096436
mini_batch_src_global generation:  1.3708813190460205
r_  generation:  13.435318231582642
local_output_nid generation:  0.5420398712158203
local_in_edges_tensor generation:  1.1243534088134766
mini_batch_src_global generation:  1.3756296634674072
r_  generation:  13.655065298080444
local_output_nid generation:  0.5432758331298828
local_in_edges_tensor generation:  1.1348981857299805
mini_batch_src_global generation:  1.4335827827453613
r_  generation:  13.754944086074829
local_output_nid generation:  0.5262701511383057
local_in_edges_tensor generation:  1.2621748447418213
mini_batch_src_global generation:  1.3925609588623047
r_  generation:  13.841426372528076
local_output_nid generation:  0.5343499183654785
local_in_edges_tensor generation:  1.1010210514068604
mini_batch_src_global generation:  1.4055719375610352
r_  generation:  13.699815034866333
local_output_nid generation:  0.5267078876495361
local_in_edges_tensor generation:  1.2389540672302246
mini_batch_src_global generation:  1.4070122241973877
r_  generation:  13.734455585479736
local_output_nid generation:  0.5265424251556396
local_in_edges_tensor generation:  1.0794012546539307
mini_batch_src_global generation:  1.3854258060455322
r_  generation:  13.708627462387085
local_output_nid generation:  0.5605521202087402
local_in_edges_tensor generation:  1.0812106132507324
mini_batch_src_global generation:  1.447969913482666
r_  generation:  13.542350769042969
local_output_nid generation:  0.5525751113891602
local_in_edges_tensor generation:  1.0750668048858643
mini_batch_src_global generation:  1.4402532577514648
r_  generation:  13.485193490982056
local_output_nid generation:  0.5255589485168457
local_in_edges_tensor generation:  1.0584187507629395
mini_batch_src_global generation:  1.36783766746521
r_  generation:  13.549423456192017
local_output_nid generation:  0.521115779876709
local_in_edges_tensor generation:  1.1492347717285156
mini_batch_src_global generation:  1.4109745025634766
r_  generation:  13.50278639793396
local_output_nid generation:  0.5181572437286377
local_in_edges_tensor generation:  1.1219511032104492
mini_batch_src_global generation:  1.3806092739105225
r_  generation:  13.53842043876648
----------------------check_connections_block total spend ----------------------------- 305.1506142616272
generate_one_block  18.312843084335327
generate_one_block  18.05804204940796
generate_one_block  17.86457061767578
generate_one_block  17.825201988220215
generate_one_block  17.742957830429077
generate_one_block  19.762161254882812
generate_one_block  18.00141143798828
generate_one_block  18.010348558425903
generate_one_block  18.07504105567932
generate_one_block  18.43075919151306
generate_one_block  18.079445123672485
generate_one_block  18.643714666366577
generate_one_block  18.42659616470337
generate_one_block  18.229236841201782
generate_one_block  18.65990972518921
generate_one_block  18.393783807754517
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6107401847839355  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

connection checking time:  415.48290514945984
block generation total time  394.647429227829
average batch blocks generation time:  8.221821442246437
block dataloader generation time/epoch 841.8384163975716
pseudo mini batch 0 input nodes size: 2131144
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.8002872467041016  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.8002872467041016  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.594200611114502  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5942935943603516  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7992777824401855  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1320996284484863  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1320996284484863  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2131144
first layer output nodes number: 1549477
edges number: 33136236
torch.Size([2131144, 100])
torch.Size([1549477, 256])
input nodes number: 1549477
output nodes number: 338378
edges number: 10951288
torch.Size([1549477, 256])
torch.Size([338378, 256])
torch.Size([12432, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.480217933654785  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.482395648956299  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6067438125610352  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 1 input nodes size: 2125087
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7992587089538574  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7992587089538574  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5909156799316406  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.591005802154541  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.796999454498291  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1266732215881348  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1266732215881348  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2125087
first layer output nodes number: 1534004
edges number: 32904930
torch.Size([2125087, 100])
torch.Size([1534004, 256])
input nodes number: 1534004
output nodes number: 330413
edges number: 10693632
torch.Size([1534004, 256])
torch.Size([330413, 256])
torch.Size([12040, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.408468723297119  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.410577297210693  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.597313404083252  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 2 input nodes size: 2127224
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7972421646118164  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7972421646118164  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5896949768066406  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5897846221923828  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980375289916992  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1281137466430664  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1281137466430664  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2127224
first layer output nodes number: 1543170
edges number: 33044044
torch.Size([2127224, 100])
torch.Size([1543170, 256])
input nodes number: 1543170
output nodes number: 332458
edges number: 10747563
torch.Size([1543170, 256])
torch.Size([332458, 256])
torch.Size([12018, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.439896106719971  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.442626476287842  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5976839065551758  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 3 input nodes size: 2128489
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.797722339630127  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.797722339630127  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.590646743774414  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.59074068069458  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7981982231140137  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1306719779968262  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1306719779968262  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128489
first layer output nodes number: 1547771
edges number: 33093906
torch.Size([2128489, 100])
torch.Size([1547771, 256])
input nodes number: 1547771
output nodes number: 339970
edges number: 10989181
torch.Size([1547771, 256])
torch.Size([339970, 256])
torch.Size([12546, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.479758262634277  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.481955528259277  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6055951118469238  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 4 input nodes size: 2128670
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982907295227051  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982907295227051  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5912823677062988  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.591372013092041  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7983536720275879  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1280064582824707  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1280064582824707  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128670
first layer output nodes number: 1539008
edges number: 33015957
torch.Size([2128670, 100])
torch.Size([1539008, 256])
input nodes number: 1539008
output nodes number: 329938
edges number: 10690797
torch.Size([1539008, 256])
torch.Size([329938, 256])
torch.Size([12021, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.420678615570068  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.422783851623535  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5981688499450684  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 5 input nodes size: 2128219
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982616424560547  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982616424560547  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.591085433959961  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.591176986694336  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.798095703125  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1308155059814453  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1308155059814453  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128219
first layer output nodes number: 1548625
edges number: 33145510
torch.Size([2128219, 100])
torch.Size([1548625, 256])
input nodes number: 1548625
output nodes number: 337453
edges number: 10924972
torch.Size([1548625, 256])
torch.Size([337453, 256])
torch.Size([12287, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.474365234375  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.476517200469971  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6052579879760742  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 6 input nodes size: 2129174
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7981424331665039  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7981424331665039  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5913219451904297  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.591413974761963  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7984986305236816  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1314749717712402  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1314749717712402  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2129174
first layer output nodes number: 1548708
edges number: 33156948
torch.Size([2129174, 100])
torch.Size([1548708, 256])
input nodes number: 1548708
output nodes number: 337521
edges number: 10914681
torch.Size([1548708, 256])
torch.Size([337521, 256])
torch.Size([12319, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.474643230438232  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.476800918579102  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6048059463500977  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 7 input nodes size: 2128446
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7992405891418457  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7992405891418457  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.592148780822754  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.59224271774292  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7989711761474609  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1325922012329102  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1325922012329102  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128446
first layer output nodes number: 1552076
edges number: 33198200
torch.Size([2128446, 100])
torch.Size([1552076, 256])
input nodes number: 1552076
output nodes number: 342425
edges number: 11071523
torch.Size([1552076, 256])
torch.Size([342425, 256])
torch.Size([12608, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.501059055328369  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.503952980041504  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.608288288116455  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 8 input nodes size: 2124673
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7984714508056641  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7984714508056641  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5899739265441895  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.590064525604248  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7970623970031738  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1277499198913574  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1277499198913574  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2124673
first layer output nodes number: 1542380
edges number: 33049704
torch.Size([2124673, 100])
torch.Size([1542380, 256])
input nodes number: 1542380
output nodes number: 334552
edges number: 10829627
torch.Size([1542380, 256])
torch.Size([334552, 256])
torch.Size([12154, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.443329811096191  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.44545841217041  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5984611511230469  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 9 input nodes size: 2129396
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7967967987060547  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7967967987060547  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5900588035583496  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5901522636413574  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7985591888427734  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.132218360900879  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.132218360900879  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2129396
first layer output nodes number: 1553584
edges number: 33248627
torch.Size([2129396, 100])
torch.Size([1553584, 256])
input nodes number: 1553584
output nodes number: 341314
edges number: 11032027
torch.Size([1553584, 256])
torch.Size([341314, 256])
torch.Size([12544, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.501298904418945  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.503495693206787  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6083335876464844  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 10 input nodes size: 2131274
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7986273765563965  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7986273765563965  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5925889015197754  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5926823616027832  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7993268966674805  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1328449249267578  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1328449249267578  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2131274
first layer output nodes number: 1554245
edges number: 33229620
torch.Size([2131274, 100])
torch.Size([1554245, 256])
input nodes number: 1554245
output nodes number: 340860
edges number: 11035130
torch.Size([1554245, 256])
torch.Size([340860, 256])
torch.Size([12535, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.502277374267578  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.504598140716553  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6087875366210938  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 11 input nodes size: 2128025
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7993254661560059  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7993254661560059  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5920767784118652  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5921683311462402  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7981133460998535  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1289467811584473  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1289467811584473  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128025
first layer output nodes number: 1543291
edges number: 33054346
torch.Size([2128025, 100])
torch.Size([1543291, 256])
input nodes number: 1543291
output nodes number: 335231
edges number: 10849164
torch.Size([1543291, 256])
torch.Size([335231, 256])
torch.Size([12265, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.450255393981934  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.452807903289795  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6019015312194824  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 12 input nodes size: 2127686
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980661392211914  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980661392211914  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.590691089630127  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5907821655273438  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7979393005371094  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1285591125488281  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1285591125488281  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2127686
first layer output nodes number: 1544298
edges number: 33070685
torch.Size([2127686, 100])
torch.Size([1544298, 256])
input nodes number: 1544298
output nodes number: 334590
edges number: 10820557
torch.Size([1544298, 256])
torch.Size([334590, 256])
torch.Size([12199, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.449865818023682  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.45200252532959  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5999808311462402  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 13 input nodes size: 2128558
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7979278564453125  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7979278564453125  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5908775329589844  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.590970516204834  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982544898986816  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1308550834655762  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1308550834655762  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128558
first layer output nodes number: 1547889
edges number: 33114423
torch.Size([2128558, 100])
torch.Size([1547889, 256])
input nodes number: 1547889
output nodes number: 339781
edges number: 10989048
torch.Size([1547889, 256])
torch.Size([339781, 256])
torch.Size([12452, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.479501247406006  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.481682300567627  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.606274127960205  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 14 input nodes size: 2128830
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982988357543945  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982988357543945  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5913500785827637  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.591440200805664  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7983975410461426  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1285510063171387  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1285510063171387  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128830
first layer output nodes number: 1542284
edges number: 33018261
torch.Size([2128830, 100])
torch.Size([1542284, 256])
input nodes number: 1542284
output nodes number: 332810
edges number: 10757919
torch.Size([1542284, 256])
torch.Size([332810, 256])
torch.Size([12080, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.438579082489014  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.440694808959961  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6004343032836914  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 15 input nodes size: 2128540
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7983322143554688  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7983322143554688  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5912752151489258  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5913653373718262  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982239723205566  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.128300666809082  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.128300666809082  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128540
first layer output nodes number: 1540828
edges number: 33006619
torch.Size([2128540, 100])
torch.Size([1540828, 256])
input nodes number: 1540828
output nodes number: 332457
edges number: 10755916
torch.Size([1540828, 256])
torch.Size([332457, 256])
torch.Size([12071, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.435089588165283  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.437203884124756  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6002569198608398  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6002569198608398  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6002569198608398  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3806885629892349 |0.38877566158771515 |0.10236950218677521 |0.00014480948448181152 |0.005130797624588013 |0.0012845993041992188 |
----------------------------------------------------------pseudo_mini_loss sum 4.4645280838012695
Total (block generation + training)time/epoch 856.6671830415726
Training time/epoch 14.258009433746338
Training time without block to device /epoch 8.037598848342896
Training time without total dataloading part /epoch 1.7236063480377197
load block tensor time/epoch 6.091017007827759
block to device time/epoch 6.220410585403442
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  64165224
Number of first layer input nodes during this epoch:  34053435
Number of first layer output nodes during this epoch:  24731638
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6002564430236816  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3435237407684326
global_2_local spend time (sec) 0.6017122268676758
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.408 seconds
Metis partitioning: 3.217 seconds
Split the graph: 0.346 seconds
Construct subgraphs: 0.049 seconds
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
The batched output nid list before graph partition
total k batches seeds list generation spend  4.0686728954315186
after graph partition
graph partition algorithm spend time 5.151522159576416
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
partition_len_list
[341664, 336227, 334785, 332687, 329346, 337318, 330746, 331353, 344056, 341043, 339157, 339145, 328233, 332098, 337850, 342243]
metis selection method  spend 6.027963876724243
time for parepare:  0.2709920406341553
local_output_nid generation:  0.00411224365234375
local_in_edges_tensor generation:  0.005326986312866211
mini_batch_src_global generation:  0.019925832748413086
r_  generation:  0.1829366683959961
local_output_nid generation:  0.004552125930786133
local_in_edges_tensor generation:  0.00518798828125
mini_batch_src_global generation:  0.02312636375427246
r_  generation:  0.20069098472595215
local_output_nid generation:  0.0045511722564697266
local_in_edges_tensor generation:  0.0051190853118896484
mini_batch_src_global generation:  0.015650033950805664
r_  generation:  0.20174312591552734
local_output_nid generation:  0.004514217376708984
local_in_edges_tensor generation:  0.005233287811279297
mini_batch_src_global generation:  0.013463973999023438
r_  generation:  0.216630220413208
local_output_nid generation:  0.004512786865234375
local_in_edges_tensor generation:  0.005095005035400391
mini_batch_src_global generation:  0.014013051986694336
r_  generation:  0.21544909477233887
local_output_nid generation:  0.004648447036743164
local_in_edges_tensor generation:  0.00530552864074707
mini_batch_src_global generation:  0.016724109649658203
r_  generation:  0.2328643798828125
local_output_nid generation:  0.004512786865234375
local_in_edges_tensor generation:  0.00529789924621582
mini_batch_src_global generation:  0.017415761947631836
r_  generation:  0.23924517631530762
local_output_nid generation:  0.004500389099121094
local_in_edges_tensor generation:  0.005279541015625
mini_batch_src_global generation:  0.01748490333557129
r_  generation:  0.24289917945861816
local_output_nid generation:  0.004729747772216797
local_in_edges_tensor generation:  0.005361795425415039
mini_batch_src_global generation:  0.020334243774414062
r_  generation:  0.25479960441589355
local_output_nid generation:  0.004686117172241211
local_in_edges_tensor generation:  0.00844120979309082
mini_batch_src_global generation:  0.019500017166137695
r_  generation:  0.2633979320526123
local_output_nid generation:  0.004652500152587891
local_in_edges_tensor generation:  0.005376100540161133
mini_batch_src_global generation:  0.020480871200561523
r_  generation:  0.2601644992828369
local_output_nid generation:  0.00465846061706543
local_in_edges_tensor generation:  0.006916522979736328
mini_batch_src_global generation:  0.02046036720275879
r_  generation:  0.26234984397888184
local_output_nid generation:  0.004499197006225586
local_in_edges_tensor generation:  0.005277872085571289
mini_batch_src_global generation:  0.021036863327026367
r_  generation:  0.25272083282470703
local_output_nid generation:  0.0045146942138671875
local_in_edges_tensor generation:  0.005225419998168945
mini_batch_src_global generation:  0.021450281143188477
r_  generation:  0.25833654403686523
local_output_nid generation:  0.004634857177734375
local_in_edges_tensor generation:  0.01000070571899414
mini_batch_src_global generation:  0.021964550018310547
r_  generation:  0.26223063468933105
local_output_nid generation:  0.004665851593017578
local_in_edges_tensor generation:  0.00687861442565918
mini_batch_src_global generation:  0.02303481101989746
r_  generation:  0.2646167278289795
----------------------check_connections_block total spend ----------------------------- 5.362572431564331
generate_one_block  0.6628284454345703
generate_one_block  0.3360447883605957
generate_one_block  0.28634071350097656
generate_one_block  0.27374958992004395
generate_one_block  0.265885591506958
generate_one_block  0.2764279842376709
generate_one_block  0.2693953514099121
generate_one_block  0.27129530906677246
generate_one_block  0.29554009437561035
generate_one_block  0.27948808670043945
generate_one_block  0.2775692939758301
generate_one_block  0.27971601486206055
generate_one_block  0.2769346237182617
generate_one_block  0.26909518241882324
generate_one_block  0.2847318649291992
generate_one_block  0.2883734703063965
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2220983505249023
gen group dst list time:  0.1692662239074707
time for parepare:  0.4307987689971924
local_output_nid generation:  0.11561465263366699
local_in_edges_tensor generation:  0.34015560150146484
mini_batch_src_global generation:  0.37415599822998047
r_  generation:  4.504781723022461
local_output_nid generation:  0.13812756538391113
local_in_edges_tensor generation:  0.37169694900512695
mini_batch_src_global generation:  0.46113038063049316
r_  generation:  4.430722951889038
local_output_nid generation:  0.11560750007629395
local_in_edges_tensor generation:  0.2725234031677246
mini_batch_src_global generation:  0.45832133293151855
r_  generation:  4.574489593505859
local_output_nid generation:  0.12299156188964844
local_in_edges_tensor generation:  0.29387927055358887
mini_batch_src_global generation:  0.48487138748168945
r_  generation:  4.655863285064697
local_output_nid generation:  0.11246085166931152
local_in_edges_tensor generation:  0.3677029609680176
mini_batch_src_global generation:  0.48390936851501465
r_  generation:  4.627384424209595
local_output_nid generation:  0.11287140846252441
local_in_edges_tensor generation:  0.3164551258087158
mini_batch_src_global generation:  0.5132205486297607
r_  generation:  4.919410943984985
local_output_nid generation:  0.13407373428344727
local_in_edges_tensor generation:  0.4127509593963623
mini_batch_src_global generation:  0.4953169822692871
r_  generation:  4.639711380004883
local_output_nid generation:  0.11147522926330566
local_in_edges_tensor generation:  0.3074162006378174
mini_batch_src_global generation:  0.4868433475494385
r_  generation:  4.656219005584717
local_output_nid generation:  0.12423396110534668
local_in_edges_tensor generation:  0.30529022216796875
mini_batch_src_global generation:  0.5069231986999512
r_  generation:  4.822244644165039
local_output_nid generation:  0.11429643630981445
local_in_edges_tensor generation:  0.31046295166015625
mini_batch_src_global generation:  0.5038375854492188
r_  generation:  4.817657947540283
local_output_nid generation:  0.11888408660888672
local_in_edges_tensor generation:  0.29453349113464355
mini_batch_src_global generation:  0.5081243515014648
r_  generation:  4.826697587966919
local_output_nid generation:  0.1248939037322998
local_in_edges_tensor generation:  0.420551061630249
mini_batch_src_global generation:  0.5303668975830078
r_  generation:  4.859993934631348
local_output_nid generation:  0.10984611511230469
local_in_edges_tensor generation:  0.37009191513061523
mini_batch_src_global generation:  0.5426263809204102
r_  generation:  4.773211240768433
local_output_nid generation:  0.13439488410949707
local_in_edges_tensor generation:  0.2937471866607666
mini_batch_src_global generation:  0.4933183193206787
r_  generation:  4.731743574142456
local_output_nid generation:  0.11595797538757324
local_in_edges_tensor generation:  0.2958211898803711
mini_batch_src_global generation:  0.5057897567749023
r_  generation:  4.794983625411987
local_output_nid generation:  0.11543536186218262
local_in_edges_tensor generation:  0.2941164970397949
mini_batch_src_global generation:  0.5049467086791992
r_  generation:  4.84805154800415
----------------------check_connections_block total spend ----------------------------- 103.909108877182
generate_one_block  6.564448356628418
generate_one_block  5.97249174118042
generate_one_block  6.423321485519409
generate_one_block  6.032394647598267
generate_one_block  5.871891021728516
generate_one_block  6.012892246246338
generate_one_block  5.8980872631073
generate_one_block  5.897096872329712
generate_one_block  6.5949625968933105
generate_one_block  6.3914220333099365
generate_one_block  6.0424253940582275
generate_one_block  6.058011293411255
generate_one_block  5.872290849685669
generate_one_block  5.896240949630737
generate_one_block  5.999417781829834
generate_one_block  6.125407934188843
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3992724418640137
gen group dst list time:  0.9514422416687012
time for parepare:  0.446530818939209
local_output_nid generation:  0.5032298564910889
local_in_edges_tensor generation:  1.3256785869598389
mini_batch_src_global generation:  1.1216444969177246
r_  generation:  13.513380289077759
local_output_nid generation:  0.5432710647583008
local_in_edges_tensor generation:  1.1990656852722168
mini_batch_src_global generation:  1.378998041152954
r_  generation:  13.66769790649414
local_output_nid generation:  0.5351738929748535
local_in_edges_tensor generation:  1.4137370586395264
mini_batch_src_global generation:  1.435084342956543
r_  generation:  13.606761693954468
local_output_nid generation:  0.536266565322876
local_in_edges_tensor generation:  1.11098313331604
mini_batch_src_global generation:  1.3857200145721436
r_  generation:  13.678563356399536
local_output_nid generation:  0.49994897842407227
local_in_edges_tensor generation:  1.2951271533966064
mini_batch_src_global generation:  1.466712474822998
r_  generation:  13.7557852268219
local_output_nid generation:  0.5123300552368164
local_in_edges_tensor generation:  1.0979013442993164
mini_batch_src_global generation:  1.461329460144043
r_  generation:  13.70565152168274
local_output_nid generation:  0.5396847724914551
local_in_edges_tensor generation:  1.0872464179992676
mini_batch_src_global generation:  1.383683204650879
r_  generation:  13.527937889099121
local_output_nid generation:  0.5030138492584229
local_in_edges_tensor generation:  1.0866899490356445
mini_batch_src_global generation:  1.3836076259613037
r_  generation:  13.554163455963135
local_output_nid generation:  0.5103335380554199
local_in_edges_tensor generation:  1.1091761589050293
mini_batch_src_global generation:  1.4312264919281006
r_  generation:  13.738169431686401
local_output_nid generation:  0.509922981262207
local_in_edges_tensor generation:  1.2360737323760986
mini_batch_src_global generation:  1.3938226699829102
r_  generation:  14.09405779838562
local_output_nid generation:  0.5027871131896973
local_in_edges_tensor generation:  1.100862979888916
mini_batch_src_global generation:  1.4043552875518799
r_  generation:  13.782231330871582
local_output_nid generation:  0.5032458305358887
local_in_edges_tensor generation:  1.0952060222625732
mini_batch_src_global generation:  1.4034886360168457
r_  generation:  13.59951376914978
local_output_nid generation:  0.5220181941986084
local_in_edges_tensor generation:  1.0814802646636963
mini_batch_src_global generation:  1.3787944316864014
r_  generation:  13.526186227798462
local_output_nid generation:  0.501861572265625
local_in_edges_tensor generation:  1.0890564918518066
mini_batch_src_global generation:  1.4557175636291504
r_  generation:  13.672871351242065
local_output_nid generation:  0.5069413185119629
local_in_edges_tensor generation:  1.238718032836914
mini_batch_src_global generation:  1.4124972820281982
r_  generation:  14.098751544952393
local_output_nid generation:  0.5183403491973877
local_in_edges_tensor generation:  1.1049957275390625
mini_batch_src_global generation:  1.452141523361206
r_  generation:  13.774256467819214
----------------------check_connections_block total spend ----------------------------- 307.7797644138336
generate_one_block  18.75242042541504
generate_one_block  18.141227960586548
generate_one_block  18.074033975601196
generate_one_block  18.1223304271698
generate_one_block  18.302768230438232
generate_one_block  19.70423674583435
generate_one_block  17.977132558822632
generate_one_block  18.74708890914917
generate_one_block  18.38699984550476
generate_one_block  18.598276615142822
generate_one_block  18.785192489624023
generate_one_block  18.022798538208008
generate_one_block  18.748329877853394
generate_one_block  18.733109712600708
generate_one_block  18.20921802520752
generate_one_block  18.925068616867065
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6002564430236816  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

connection checking time:  417.05144572257996
block generation total time  398.7764518260956
average batch blocks generation time:  8.307842746376991
block dataloader generation time/epoch 842.1639596939087
pseudo mini batch 0 input nodes size: 2128399
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7990074157714844  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7990074157714844  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.591897964477539  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5919914245605469  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7989583015441895  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.131885051727295  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.131885051727295  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128399
first layer output nodes number: 1551294
edges number: 33156400
torch.Size([2128399, 100])
torch.Size([1551294, 256])
input nodes number: 1551294
output nodes number: 341664
edges number: 11047531
torch.Size([1551294, 256])
torch.Size([341664, 256])
torch.Size([12523, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.494510173797607  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.4967041015625  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.606764316558838  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 1 input nodes size: 2126264
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982525825500488  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982525825500488  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5903477668762207  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.590439796447754  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7974557876586914  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1285524368286133  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1285524368286133  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2126264
first layer output nodes number: 1542404
edges number: 33057684
torch.Size([2126264, 100])
torch.Size([1542404, 256])
input nodes number: 1542404
output nodes number: 336227
edges number: 10884562
torch.Size([1542404, 256])
torch.Size([336227, 256])
torch.Size([12289, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.451481342315674  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.453902244567871  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6015324592590332  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 2 input nodes size: 2128710
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7976832389831543  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7976832389831543  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5906896591186523  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5907807350158691  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7985935211181641  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.130523681640625  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.130523681640625  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128710
first layer output nodes number: 1546607
edges number: 33110661
torch.Size([2128710, 100])
torch.Size([1546607, 256])
input nodes number: 1546607
output nodes number: 334785
edges number: 10832342
torch.Size([1546607, 256])
torch.Size([334785, 256])
torch.Size([12207, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.459255695343018  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.4613938331604  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6026978492736816  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 3 input nodes size: 2128084
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7983107566833496  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7983107566833496  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5910840034484863  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.591174602508545  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980771064758301  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.129157543182373  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.129157543182373  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128084
first layer output nodes number: 1543915
edges number: 33134330
torch.Size([2128084, 100])
torch.Size([1543915, 256])
input nodes number: 1543915
output nodes number: 332687
edges number: 10785050
torch.Size([1543915, 256])
torch.Size([332687, 256])
torch.Size([12121, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.444187164306641  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.446310043334961  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6008977890014648  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 4 input nodes size: 2128263
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980618476867676  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980618476867676  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5909018516540527  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.590991497039795  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7981276512145996  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1275248527526855  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1275248527526855  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128263
first layer output nodes number: 1536612
edges number: 32932186
torch.Size([2128263, 100])
torch.Size([1536612, 256])
input nodes number: 1536612
output nodes number: 329346
edges number: 10656488
torch.Size([1536612, 256])
torch.Size([329346, 256])
torch.Size([11985, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.411139488220215  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.413238525390625  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5957326889038086  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 5 input nodes size: 2135104
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7981038093566895  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7981038093566895  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.593492031097412  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5935845375061035  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.8006548881530762  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1345086097717285  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1345086097717285  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2135104
first layer output nodes number: 1555988
edges number: 33274631
torch.Size([2135104, 100])
torch.Size([1555988, 256])
input nodes number: 1555988
output nodes number: 337318
edges number: 10899639
torch.Size([1555988, 256])
torch.Size([337318, 256])
torch.Size([12388, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.497018814086914  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.499188423156738  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6099166870117188  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 6 input nodes size: 2122916
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.8007254600524902  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.8007254600524902  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.591573715209961  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5916633605957031  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7961826324462891  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1260309219360352  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1260309219360352  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2122916
first layer output nodes number: 1537491
edges number: 32967576
torch.Size([2122916, 100])
torch.Size([1537491, 256])
input nodes number: 1537491
output nodes number: 330746
edges number: 10717055
torch.Size([1537491, 256])
torch.Size([330746, 256])
torch.Size([12014, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.416916370391846  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.419020652770996  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5971665382385254  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 7 input nodes size: 2124107
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7961993217468262  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7961993217468262  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5874910354614258  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5875802040100098  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7966423034667969  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1265392303466797  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1265392303466797  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2124107
first layer output nodes number: 1537586
edges number: 32968523
torch.Size([2124107, 100])
torch.Size([1537586, 256])
input nodes number: 1537586
output nodes number: 331353
edges number: 10723572
torch.Size([1537586, 256])
torch.Size([331353, 256])
torch.Size([11967, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.420646667480469  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.423018455505371  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5955567359924316  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 8 input nodes size: 2129818
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7965521812438965  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7965521812438965  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5899715423583984  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5900659561157227  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7986850738525391  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1339311599731445  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1339311599731445  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2129818
first layer output nodes number: 1556707
edges number: 33272115
torch.Size([2129818, 100])
torch.Size([1556707, 256])
input nodes number: 1556707
output nodes number: 344056
edges number: 11124099
torch.Size([1556707, 256])
torch.Size([344056, 256])
torch.Size([12621, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.52089786529541  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.52310848236084  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6110796928405762  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 9 input nodes size: 2128311
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7987995147705078  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7987995147705078  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5916571617126465  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5917510986328125  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982373237609863  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1307692527770996  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1307692527770996  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128311
first layer output nodes number: 1547972
edges number: 33097263
torch.Size([2128311, 100])
torch.Size([1547972, 256])
input nodes number: 1547972
output nodes number: 341043
edges number: 11025713
torch.Size([1547972, 256])
torch.Size([341043, 256])
torch.Size([12583, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.484809398651123  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.487013339996338  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6067252159118652  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 10 input nodes size: 2127896
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982306480407715  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7982306480407715  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5909337997436523  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.591026782989502  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980751991271973  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1296772956848145  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1296772956848145  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2127896
first layer output nodes number: 1545924
edges number: 33074618
torch.Size([2127896, 100])
torch.Size([1545924, 256])
input nodes number: 1545924
output nodes number: 339157
edges number: 10952383
torch.Size([1545924, 256])
torch.Size([339157, 256])
torch.Size([12437, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.471600532531738  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.473819732666016  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6044650077819824  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 11 input nodes size: 2129493
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980494499206543  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7980494499206543  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5913476943969727  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.591440200805664  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7986440658569336  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1317214965820312  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1317214965820312  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2129493
first layer output nodes number: 1549978
edges number: 33170519
torch.Size([2129493, 100])
torch.Size([1549978, 256])
input nodes number: 1549978
output nodes number: 339145
edges number: 10960678
torch.Size([1549978, 256])
torch.Size([339145, 256])
torch.Size([12412, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.483974456787109  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.486148357391357  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6063852310180664  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 12 input nodes size: 2125761
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7986397743225098  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7986397743225098  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5905475616455078  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.59063720703125  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7972464561462402  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.126452922821045  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.126452922821045  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2125761
first layer output nodes number: 1531850
edges number: 32856947
torch.Size([2125761, 100])
torch.Size([1531850, 256])
input nodes number: 1531850
output nodes number: 328233
edges number: 10630897
torch.Size([1531850, 256])
torch.Size([328233, 256])
torch.Size([12002, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.39451789855957  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.39661979675293  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5936732292175293  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 13 input nodes size: 2127473
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7971744537353516  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7971744537353516  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5897202491760254  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5898098945617676  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7978124618530273  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1280326843261719  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1280326843261719  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2127473
first layer output nodes number: 1541517
edges number: 33074046
torch.Size([2127473, 100])
torch.Size([1541517, 256])
input nodes number: 1541517
output nodes number: 332098
edges number: 10766929
torch.Size([1541517, 256])
torch.Size([332098, 256])
torch.Size([12001, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.433226108551025  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.435794830322266  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5989270210266113  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 14 input nodes size: 2126741
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7978124618530273  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7978124618530273  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.590085506439209  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5901784896850586  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7975430488586426  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1289324760437012  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1289324760437012  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2126741
first layer output nodes number: 1544411
edges number: 33032173
torch.Size([2126741, 100])
torch.Size([1544411, 256])
input nodes number: 1544411
output nodes number: 337850
edges number: 10923867
torch.Size([1544411, 256])
torch.Size([337850, 256])
torch.Size([12475, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.461727142333984  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.464376449584961  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.6027135848999023  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 15 input nodes size: 2129476
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7976260185241699  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7976260185241699  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5909180641174316  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.5910120010375977  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 0.7986459732055664  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1346216201782227  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 1.1346216201782227  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2129476
first layer output nodes number: 1557558
edges number: 33306721
torch.Size([2129476, 100])
torch.Size([1557558, 256])
input nodes number: 1557558
output nodes number: 342243
edges number: 11065036
torch.Size([1557558, 256])
torch.Size([342243, 256])
torch.Size([12546, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.521067142486572  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0487060546875 GB
    Memory Allocated: 6.523264408111572  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6151180267333984  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6151180267333984  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6151180267333984  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37421295046806335 |0.45519693195819855 |0.10212177038192749 |0.00013709068298339844 |0.006981968879699707 |0.00390934944152832 |
----------------------------------------------------------pseudo_mini_loss sum 3.3574378490448
Total (block generation + training)time/epoch 857.0694508075715
Training time/epoch 15.212035894393921
Training time without block to device /epoch 7.928884983062744
Training time without total dataloading part /epoch 1.7517626285552979
load block tensor time/epoch 5.987407207489014
block to device time/epoch 7.283150911331177
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  64152581
Number of first layer input nodes during this epoch:  34046816
Number of first layer output nodes during this epoch:  24727814
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6151175498962402  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.37271738052368164
global_2_local spend time (sec) 0.6328632831573486
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.518 seconds
Metis partitioning: 3.410 seconds
Split the graph: 0.326 seconds
Construct subgraphs: 0.059 seconds
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
The batched output nid list before graph partition
total k batches seeds list generation spend  4.375580310821533
after graph partition
graph partition algorithm spend time 5.4905383586883545
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
partition_len_list
[339919, 330826, 328841, 341882, 331075, 334209, 336436, 340888, 334677, 341752, 341222, 336489, 334084, 340591, 332456, 332162]
metis selection method  spend 6.406646728515625
time for parepare:  0.2803764343261719
local_output_nid generation:  0.004784584045410156
local_in_edges_tensor generation:  0.005697965621948242
mini_batch_src_global generation:  0.024055957794189453
r_  generation:  0.18383169174194336
local_output_nid generation:  0.0061261653900146484
local_in_edges_tensor generation:  0.005408048629760742
mini_batch_src_global generation:  0.022344112396240234
r_  generation:  0.20902252197265625
local_output_nid generation:  0.004649162292480469
local_in_edges_tensor generation:  0.00550079345703125
mini_batch_src_global generation:  0.015633344650268555
r_  generation:  0.20691299438476562
local_output_nid generation:  0.004718303680419922
local_in_edges_tensor generation:  0.009131908416748047
mini_batch_src_global generation:  0.017932891845703125
r_  generation:  0.22941160202026367
local_output_nid generation:  0.004600048065185547
local_in_edges_tensor generation:  0.005646705627441406
mini_batch_src_global generation:  0.01651477813720703
r_  generation:  0.22705364227294922
local_output_nid generation:  0.0046520233154296875
local_in_edges_tensor generation:  0.005705595016479492
mini_batch_src_global generation:  0.018881797790527344
r_  generation:  0.24390935897827148
local_output_nid generation:  0.004645586013793945
local_in_edges_tensor generation:  0.007308244705200195
mini_batch_src_global generation:  0.02008056640625
r_  generation:  0.25244736671447754
local_output_nid generation:  0.004789113998413086
local_in_edges_tensor generation:  0.007366180419921875
mini_batch_src_global generation:  0.02081465721130371
r_  generation:  0.2656073570251465
local_output_nid generation:  0.0045909881591796875
local_in_edges_tensor generation:  0.005688190460205078
mini_batch_src_global generation:  0.02036142349243164
r_  generation:  0.25531864166259766
local_output_nid generation:  0.004682302474975586
local_in_edges_tensor generation:  0.005738973617553711
mini_batch_src_global generation:  0.022291898727416992
r_  generation:  0.268430233001709
local_output_nid generation:  0.004759311676025391
local_in_edges_tensor generation:  0.007312297821044922
mini_batch_src_global generation:  0.023072242736816406
r_  generation:  0.27330827713012695
local_output_nid generation:  0.004658699035644531
local_in_edges_tensor generation:  0.008206367492675781
mini_batch_src_global generation:  0.0238189697265625
r_  generation:  0.27599215507507324
local_output_nid generation:  0.004633665084838867
local_in_edges_tensor generation:  0.0071408748626708984
mini_batch_src_global generation:  0.02357029914855957
r_  generation:  0.27184343338012695
local_output_nid generation:  0.004691362380981445
local_in_edges_tensor generation:  0.0061414241790771484
mini_batch_src_global generation:  0.026026248931884766
r_  generation:  0.2832965850830078
local_output_nid generation:  0.00455927848815918
local_in_edges_tensor generation:  0.00960230827331543
mini_batch_src_global generation:  0.024326086044311523
r_  generation:  0.2691366672515869
local_output_nid generation:  0.004593610763549805
local_in_edges_tensor generation:  0.00583958625793457
mini_batch_src_global generation:  0.02486109733581543
r_  generation:  0.2687256336212158
----------------------check_connections_block total spend ----------------------------- 5.628286123275757
generate_one_block  0.6903684139251709
generate_one_block  0.33757829666137695
generate_one_block  0.29599785804748535
generate_one_block  0.3014354705810547
generate_one_block  0.290041446685791
generate_one_block  0.29462528228759766
generate_one_block  0.2964038848876953
generate_one_block  0.28986334800720215
generate_one_block  0.2831284999847412
generate_one_block  0.2852029800415039
generate_one_block  0.2819483280181885
generate_one_block  0.27517080307006836
generate_one_block  0.28938746452331543
generate_one_block  0.28708362579345703
generate_one_block  0.2717559337615967
generate_one_block  0.2761096954345703
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.216019630432129
gen group dst list time:  0.19327640533447266
time for parepare:  0.48174142837524414
local_output_nid generation:  0.11463451385498047
local_in_edges_tensor generation:  0.4736337661743164
mini_batch_src_global generation:  0.40458202362060547
r_  generation:  4.487067699432373
local_output_nid generation:  0.10875225067138672
local_in_edges_tensor generation:  0.4176149368286133
mini_batch_src_global generation:  0.46982908248901367
r_  generation:  4.779014825820923
local_output_nid generation:  0.13337039947509766
local_in_edges_tensor generation:  0.4350090026855469
mini_batch_src_global generation:  0.4551239013671875
r_  generation:  4.570394277572632
local_output_nid generation:  0.11846542358398438
local_in_edges_tensor generation:  0.3183932304382324
mini_batch_src_global generation:  0.47485923767089844
r_  generation:  4.851148843765259
local_output_nid generation:  0.1232757568359375
local_in_edges_tensor generation:  0.30220580101013184
mini_batch_src_global generation:  0.4861164093017578
r_  generation:  4.852131605148315
local_output_nid generation:  0.11365723609924316
local_in_edges_tensor generation:  0.3606131076812744
mini_batch_src_global generation:  0.4905717372894287
r_  generation:  4.9122233390808105
local_output_nid generation:  0.1145477294921875
local_in_edges_tensor generation:  0.3040623664855957
mini_batch_src_global generation:  0.522376537322998
r_  generation:  5.097674131393433
local_output_nid generation:  0.1376969814300537
local_in_edges_tensor generation:  0.36134910583496094
mini_batch_src_global generation:  0.502532958984375
r_  generation:  5.080614328384399
local_output_nid generation:  0.11391329765319824
local_in_edges_tensor generation:  0.30165696144104004
mini_batch_src_global generation:  0.5014755725860596
r_  generation:  4.882387638092041
local_output_nid generation:  0.11588835716247559
local_in_edges_tensor generation:  0.2998673915863037
mini_batch_src_global generation:  0.5053105354309082
r_  generation:  4.984080791473389
local_output_nid generation:  0.12572240829467773
local_in_edges_tensor generation:  0.2983579635620117
mini_batch_src_global generation:  0.5166492462158203
r_  generation:  4.969433546066284
local_output_nid generation:  0.11380815505981445
local_in_edges_tensor generation:  0.2898437976837158
mini_batch_src_global generation:  0.5041239261627197
r_  generation:  4.8832385540008545
local_output_nid generation:  0.11333632469177246
local_in_edges_tensor generation:  0.3610103130340576
mini_batch_src_global generation:  0.5095641613006592
r_  generation:  4.857975482940674
local_output_nid generation:  0.11510419845581055
local_in_edges_tensor generation:  0.29897093772888184
mini_batch_src_global generation:  0.5335962772369385
r_  generation:  4.882619857788086
local_output_nid generation:  0.1127161979675293
local_in_edges_tensor generation:  0.2937450408935547
mini_batch_src_global generation:  0.5145003795623779
r_  generation:  4.937832832336426
local_output_nid generation:  0.11397862434387207
local_in_edges_tensor generation:  0.3692765235900879
mini_batch_src_global generation:  0.5079624652862549
r_  generation:  4.807464122772217
----------------------check_connections_block total spend ----------------------------- 106.75121855735779
generate_one_block  6.621552228927612
generate_one_block  5.911450386047363
generate_one_block  5.9282567501068115
generate_one_block  6.12866735458374
generate_one_block  5.908330202102661
generate_one_block  5.9902989864349365
generate_one_block  6.059831380844116
generate_one_block  6.117996454238892
generate_one_block  6.326121091842651
generate_one_block  6.135323524475098
generate_one_block  6.17359733581543
generate_one_block  6.04840087890625
generate_one_block  6.028607368469238
generate_one_block  6.1061365604400635
generate_one_block  5.962167978286743
generate_one_block  6.165485858917236
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3699703216552734
gen group dst list time:  0.8984026908874512
time for parepare:  0.43155598640441895
local_output_nid generation:  0.49914097785949707
local_in_edges_tensor generation:  1.309330940246582
mini_batch_src_global generation:  1.177879810333252
r_  generation:  13.010214567184448
local_output_nid generation:  0.5267739295959473
local_in_edges_tensor generation:  1.1189522743225098
mini_batch_src_global generation:  1.344320297241211
r_  generation:  13.067100524902344
local_output_nid generation:  0.49236249923706055
local_in_edges_tensor generation:  1.1370930671691895
mini_batch_src_global generation:  1.4109258651733398
r_  generation:  13.522059679031372
local_output_nid generation:  0.4963114261627197
local_in_edges_tensor generation:  1.2897629737854004
mini_batch_src_global generation:  1.3930675983428955
r_  generation:  13.718349933624268
local_output_nid generation:  0.4851810932159424
local_in_edges_tensor generation:  1.126875638961792
mini_batch_src_global generation:  1.4577150344848633
r_  generation:  13.518253087997437
local_output_nid generation:  0.49434447288513184
local_in_edges_tensor generation:  1.1268866062164307
mini_batch_src_global generation:  1.403325080871582
r_  generation:  13.516549825668335
local_output_nid generation:  0.5226686000823975
local_in_edges_tensor generation:  1.1476948261260986
mini_batch_src_global generation:  1.3761203289031982
r_  generation:  13.536561012268066
local_output_nid generation:  0.48897337913513184
local_in_edges_tensor generation:  1.1461713314056396
mini_batch_src_global generation:  1.3805031776428223
r_  generation:  13.569005250930786
local_output_nid generation:  0.4966747760772705
local_in_edges_tensor generation:  1.1338284015655518
mini_batch_src_global generation:  1.443915843963623
r_  generation:  13.498100280761719
local_output_nid generation:  0.4962453842163086
local_in_edges_tensor generation:  1.1376161575317383
mini_batch_src_global generation:  1.4435527324676514
r_  generation:  13.500206232070923
local_output_nid generation:  0.502063512802124
local_in_edges_tensor generation:  1.3638496398925781
mini_batch_src_global generation:  1.383847713470459
r_  generation:  13.574501752853394
local_output_nid generation:  0.5034120082855225
local_in_edges_tensor generation:  1.1897809505462646
mini_batch_src_global generation:  1.389289379119873
r_  generation:  13.56846809387207
local_output_nid generation:  0.5007851123809814
local_in_edges_tensor generation:  1.0581917762756348
mini_batch_src_global generation:  1.3859820365905762
r_  generation:  13.524052619934082
local_output_nid generation:  0.49336838722229004
local_in_edges_tensor generation:  1.0650725364685059
mini_batch_src_global generation:  1.38032865524292
r_  generation:  13.536848306655884
local_output_nid generation:  0.5260806083679199
local_in_edges_tensor generation:  1.0712716579437256
mini_batch_src_global generation:  1.3676154613494873
r_  generation:  13.470635414123535
local_output_nid generation:  0.4863457679748535
local_in_edges_tensor generation:  1.0645949840545654
mini_batch_src_global generation:  1.3719627857208252
r_  generation:  13.38993239402771
----------------------check_connections_block total spend ----------------------------- 302.44306349754333
generate_one_block  18.588618516921997
generate_one_block  17.730555772781372
generate_one_block  18.275394201278687
generate_one_block  17.97313904762268
generate_one_block  17.918431997299194
generate_one_block  19.306493997573853
generate_one_block  18.65210223197937
generate_one_block  18.85437774658203
generate_one_block  18.660029888153076
generate_one_block  19.586214065551758
generate_one_block  19.630063772201538
generate_one_block  18.617283582687378
generate_one_block  19.70103931427002
generate_one_block  19.419616222381592
generate_one_block  18.362241744995117
generate_one_block  19.642887115478516
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6151175498962402  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

connection checking time:  414.8225681781769
block generation total time  403.57681488990784
average batch blocks generation time:  8.407850310206413
block dataloader generation time/epoch 842.8658180236816
pseudo mini batch 0 input nodes size: 2133188
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7986574172973633  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7986574172973633  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5935792922973633  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.593672275543213  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.8002862930297852  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1362237930297852  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1362237930297852  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2133188
first layer output nodes number: 1555720
edges number: 33300209
torch.Size([2133188, 100])
torch.Size([1555720, 256])
input nodes number: 1555720
output nodes number: 339919
edges number: 10985609
torch.Size([1555720, 256])
torch.Size([339919, 256])
torch.Size([12432, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.508818626403809  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.511016368865967  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.614591121673584  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 1 input nodes size: 2122690
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.8003139495849609  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.8003139495849609  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5910778045654297  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.59116792678833  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7961530685424805  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1257915496826172  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1257915496826172  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2122690
first layer output nodes number: 1535934
edges number: 32887028
torch.Size([2122690, 100])
torch.Size([1535934, 256])
input nodes number: 1535934
output nodes number: 330826
edges number: 10688855
torch.Size([1535934, 256])
torch.Size([330826, 256])
torch.Size([12040, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.411920547485352  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.414029121398926  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5937237739562988  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 2 input nodes size: 2126095
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7960376739501953  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7960376739501953  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5880699157714844  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5881595611572266  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7973055839538574  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1265196800231934  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1265196800231934  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2126095
first layer output nodes number: 1535293
edges number: 32891237
torch.Size([2126095, 100])
torch.Size([1535293, 256])
input nodes number: 1535293
output nodes number: 328841
edges number: 10631931
torch.Size([1535293, 256])
torch.Size([328841, 256])
torch.Size([12018, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.404623031616211  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.407228469848633  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5938835144042969  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 3 input nodes size: 2129266
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7973017692565918  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7973017692565918  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5905156135559082  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5906095504760742  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.798487663269043  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1322059631347656  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1322059631347656  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2129266
first layer output nodes number: 1553465
edges number: 33250576
torch.Size([2129266, 100])
torch.Size([1553465, 256])
input nodes number: 1553465
output nodes number: 341882
edges number: 11064838
torch.Size([1553465, 256])
torch.Size([341882, 256])
torch.Size([12546, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.503953456878662  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.507011890411377  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6094894409179688  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 4 input nodes size: 2123738
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7985801696777344  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7985801696777344  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5897345542907715  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5898241996765137  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7965164184570312  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1263160705566406  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1263160705566406  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2123738
first layer output nodes number: 1535769
edges number: 32927036
torch.Size([2123738, 100])
torch.Size([1535769, 256])
input nodes number: 1535769
output nodes number: 331075
edges number: 10710425
torch.Size([1535769, 256])
torch.Size([331075, 256])
torch.Size([12021, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.413266181945801  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.416335582733154  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5957722663879395  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 5 input nodes size: 2125337
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.796656608581543  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.796656608581543  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5884065628051758  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5884981155395508  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7972540855407715  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.127875804901123  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.127875804901123  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2125337
first layer output nodes number: 1537641
edges number: 32972061
torch.Size([2125337, 100])
torch.Size([1537641, 256])
input nodes number: 1537641
output nodes number: 334209
edges number: 10820834
torch.Size([1537641, 256])
torch.Size([334209, 256])
torch.Size([12287, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.4312567710876465  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.433464050292969  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5988874435424805  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 6 input nodes size: 2126862
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7970685958862305  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7970685958862305  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5893864631652832  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5894784927368164  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7976369857788086  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1286487579345703  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1286487579345703  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2126862
first layer output nodes number: 1544979
edges number: 33073096
torch.Size([2126862, 100])
torch.Size([1544979, 256])
input nodes number: 1544979
output nodes number: 336436
edges number: 10873089
torch.Size([1544979, 256])
torch.Size([336436, 256])
torch.Size([12319, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.457765102386475  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.460228443145752  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6014885902404785  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 7 input nodes size: 2134700
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7976865768432617  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7976865768432617  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5929245948791504  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5930185317993164  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.8006086349487305  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1344709396362305  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1344709396362305  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2134700
first layer output nodes number: 1556232
edges number: 33275820
torch.Size([2134700, 100])
torch.Size([1556232, 256])
input nodes number: 1556232
output nodes number: 340888
edges number: 11030725
torch.Size([1556232, 256])
torch.Size([340888, 256])
torch.Size([12608, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.509192943572998  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.511775493621826  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.612053394317627  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 8 input nodes size: 2124704
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.8006153106689453  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.8006153106689453  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5921292304992676  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5922198295593262  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7968878746032715  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.127596378326416  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.127596378326416  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2124704
first layer output nodes number: 1540969
edges number: 33015880
torch.Size([2124704, 100])
torch.Size([1540969, 256])
input nodes number: 1540969
output nodes number: 334677
edges number: 10832479
torch.Size([1540969, 256])
torch.Size([334677, 256])
torch.Size([12154, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.440798282623291  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.44292688369751  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.599461555480957  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 9 input nodes size: 2130246
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7972946166992188  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7972946166992188  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5908732414245605  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5909667015075684  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7993621826171875  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1329779624938965  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1329779624938965  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2130246
first layer output nodes number: 1553656
edges number: 33244872
torch.Size([2130246, 100])
torch.Size([1553656, 256])
input nodes number: 1553656
output nodes number: 341752
edges number: 11055778
torch.Size([1553656, 256])
torch.Size([341752, 256])
torch.Size([12544, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.502438068389893  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.504634857177734  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6085491180419922  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 10 input nodes size: 2131658
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7989439964294434  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7989439964294434  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5938658714294434  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5939593315124512  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.8002872467041016  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1333065032958984  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1333065032958984  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2131658
first layer output nodes number: 1549445
edges number: 33175038
torch.Size([2131658, 100])
torch.Size([1549445, 256])
input nodes number: 1549445
output nodes number: 341222
edges number: 11036398
torch.Size([1549445, 256])
torch.Size([341222, 256])
torch.Size([12535, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.491337299346924  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.493532657623291  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6088638305664062  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 11 input nodes size: 2128605
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.800285816192627  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.800285816192627  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5932531356811523  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5933446884155273  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7983293533325195  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1313304901123047  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1313304901123047  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2128605
first layer output nodes number: 1548590
edges number: 33160269
torch.Size([2128605, 100])
torch.Size([1548590, 256])
input nodes number: 1548590
output nodes number: 336489
edges number: 10898834
torch.Size([1548590, 256])
torch.Size([336489, 256])
torch.Size([12265, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.470712184906006  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.472860336303711  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6045689582824707  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 12 input nodes size: 2126785
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7982821464538574  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7982821464538574  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.590571403503418  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5906624794006348  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7976036071777344  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1281604766845703  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1281604766845703  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2126785
first layer output nodes number: 1542076
edges number: 33036846
torch.Size([2126785, 100])
torch.Size([1542076, 256])
input nodes number: 1542076
output nodes number: 334084
edges number: 10812046
torch.Size([1542076, 256])
torch.Size([334084, 256])
torch.Size([12199, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.442702770233154  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.4448394775390625  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6001710891723633  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 13 input nodes size: 2129153
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7981462478637695  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7981462478637695  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5913176536560059  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5914106369018555  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7990303039550781  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.132176399230957  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.132176399230957  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2129153
first layer output nodes number: 1551030
edges number: 33205077
torch.Size([2129153, 100])
torch.Size([1551030, 256])
input nodes number: 1551030
output nodes number: 340591
edges number: 11012529
torch.Size([1551030, 256])
torch.Size([340591, 256])
torch.Size([12452, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.491241455078125  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.493422508239746  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6066255569458008  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 14 input nodes size: 2129869
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.798520565032959  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.798520565032959  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.591958999633789  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5920491218566895  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7987847328186035  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1289515495300293  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1289515495300293  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2129869
first layer output nodes number: 1540965
edges number: 33051729
torch.Size([2129869, 100])
torch.Size([1540965, 256])
input nodes number: 1540965
output nodes number: 332456
edges number: 10759725
torch.Size([1540965, 256])
torch.Size([332456, 256])
torch.Size([12080, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.435349941253662  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.437465667724609  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.6008849143981934  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

pseudo mini batch 15 input nodes size: 2120902
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7994894981384277  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7994894981384277  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5895872116088867  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.589677333831787  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 0.7961487770080566  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1262645721435547  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.1262645721435547  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

first layer input nodes number: 2120902
first layer output nodes number: 1535039
edges number: 32906142
torch.Size([2120902, 100])
torch.Size([1535039, 256])
input nodes number: 1535039
output nodes number: 332162
edges number: 10746098
torch.Size([1535039, 256])
torch.Size([332162, 256])
torch.Size([12071, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.415101051330566  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 6.417215347290039  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5954208374023438  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5954208374023438  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.5350341796875 GB
    Memory Allocated: 1.5954208374023438  GigaBytes
Max Memory Allocated: 8.512434482574463  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3798893839120865 |0.3930431455373764 |0.10169239342212677 |0.0001437067985534668 |0.004767760634422302 |0.0012621879577636719 |
----------------------------------------------------------pseudo_mini_loss sum 2.223398208618164
Total (block generation + training)time/epoch 857.6691808700562
Training time/epoch 14.29248046875
Training time without block to device /epoch 8.003790140151978
Training time without total dataloading part /epoch 1.7069239616394043
load block tensor time/epoch 6.078230142593384
block to device time/epoch 6.2886903285980225
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  64138110
Number of first layer input nodes during this epoch:  34043798
Number of first layer output nodes during this epoch:  24716803
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
