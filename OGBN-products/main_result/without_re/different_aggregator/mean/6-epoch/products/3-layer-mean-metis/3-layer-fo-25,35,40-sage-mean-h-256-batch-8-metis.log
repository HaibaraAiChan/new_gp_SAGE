main start at this time 1656971598.2772493
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3347327709197998
global_2_local spend time (sec) 0.44341254234313965
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 1.395 seconds
Metis partitioning: 2.111 seconds
Split the graph: 0.348 seconds
Construct subgraphs: 0.085 seconds
23972
25250
25248
23951
23957
25246
23854
25093
The batched output nid list before graph partition
total k batches seeds list generation spend  3.9863572120666504
after graph partition
graph partition algorithm spend time 5.191121339797974
23972
25250
25248
23951
23957
25246
23854
25093
partition_len_list
[535536, 554638, 553575, 535272, 536214, 554558, 534471, 552974]
metis selection method  spend 5.8866424560546875
time for parepare:  0.27658987045288086
local_output_nid generation:  0.005989789962768555
local_in_edges_tensor generation:  0.010586977005004883
mini_batch_src_global generation:  0.02862071990966797
r_  generation:  0.3962533473968506
local_output_nid generation:  0.0069577693939208984
local_in_edges_tensor generation:  0.020352602005004883
mini_batch_src_global generation:  0.038005828857421875
r_  generation:  0.46796536445617676
local_output_nid generation:  0.006960630416870117
local_in_edges_tensor generation:  0.009940147399902344
mini_batch_src_global generation:  0.027468204498291016
r_  generation:  0.4916234016418457
local_output_nid generation:  0.006784200668334961
local_in_edges_tensor generation:  0.009716510772705078
mini_batch_src_global generation:  0.029839515686035156
r_  generation:  0.4969778060913086
local_output_nid generation:  0.006866931915283203
local_in_edges_tensor generation:  0.009605646133422852
mini_batch_src_global generation:  0.03286457061767578
r_  generation:  0.5398256778717041
local_output_nid generation:  0.0069463253021240234
local_in_edges_tensor generation:  0.010090351104736328
mini_batch_src_global generation:  0.038372039794921875
r_  generation:  0.577261209487915
local_output_nid generation:  0.006746530532836914
local_in_edges_tensor generation:  0.009346485137939453
mini_batch_src_global generation:  0.03862166404724121
r_  generation:  0.5849447250366211
local_output_nid generation:  0.006850004196166992
local_in_edges_tensor generation:  0.009927749633789062
mini_batch_src_global generation:  0.03918647766113281
r_  generation:  0.5782060623168945
----------------------check_connections_block total spend ----------------------------- 5.565445184707642
generate_one_block  1.9837794303894043
generate_one_block  0.6050927639007568
generate_one_block  0.6142885684967041
generate_one_block  0.5758190155029297
generate_one_block  0.6026656627655029
generate_one_block  0.6156115531921387
generate_one_block  0.5806112289428711
generate_one_block  0.6093201637268066
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2138872146606445
gen group dst list time:  0.11894440650939941
time for parepare:  0.44268798828125
local_output_nid generation:  0.15408992767333984
local_in_edges_tensor generation:  0.5317323207855225
mini_batch_src_global generation:  0.5270693302154541
r_  generation:  7.004408597946167
local_output_nid generation:  0.16817140579223633
local_in_edges_tensor generation:  0.44566798210144043
mini_batch_src_global generation:  0.681100606918335
r_  generation:  7.616469621658325
local_output_nid generation:  0.16788792610168457
local_in_edges_tensor generation:  0.4529738426208496
mini_batch_src_global generation:  0.6758356094360352
r_  generation:  7.729459285736084
local_output_nid generation:  0.1616501808166504
local_in_edges_tensor generation:  0.599994421005249
mini_batch_src_global generation:  0.6804397106170654
r_  generation:  7.539541006088257
local_output_nid generation:  0.16198110580444336
local_in_edges_tensor generation:  0.6104135513305664
mini_batch_src_global generation:  0.7284178733825684
r_  generation:  7.610645532608032
local_output_nid generation:  0.19756054878234863
local_in_edges_tensor generation:  0.4483828544616699
mini_batch_src_global generation:  0.7253232002258301
r_  generation:  8.06525182723999
local_output_nid generation:  0.1643977165222168
local_in_edges_tensor generation:  0.42776012420654297
mini_batch_src_global generation:  0.7559225559234619
r_  generation:  7.659795761108398
local_output_nid generation:  0.17958426475524902
local_in_edges_tensor generation:  0.5578205585479736
mini_batch_src_global generation:  0.7524983882904053
r_  generation:  7.876906156539917
----------------------check_connections_block total spend ----------------------------- 82.41962671279907
generate_one_block  9.949551582336426
generate_one_block  10.273954391479492
generate_one_block  9.833467960357666
generate_one_block  9.756053447723389
generate_one_block  10.281920909881592
generate_one_block  10.444732427597046
generate_one_block  9.942099332809448
generate_one_block  9.917680501937866
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.298678398132324
gen group dst list time:  0.5115478038787842
time for parepare:  0.4911937713623047
local_output_nid generation:  0.565610408782959
local_in_edges_tensor generation:  1.314671516418457
mini_batch_src_global generation:  1.2108514308929443
r_  generation:  16.121089696884155
local_output_nid generation:  0.6233062744140625
local_in_edges_tensor generation:  1.2848069667816162
mini_batch_src_global generation:  1.4718177318572998
r_  generation:  16.197100162506104
local_output_nid generation:  0.5813336372375488
local_in_edges_tensor generation:  1.2941901683807373
mini_batch_src_global generation:  1.5070083141326904
r_  generation:  16.03498339653015
local_output_nid generation:  0.6009855270385742
local_in_edges_tensor generation:  1.2654414176940918
mini_batch_src_global generation:  1.4867866039276123
r_  generation:  16.076544284820557
local_output_nid generation:  0.6157004833221436
local_in_edges_tensor generation:  1.2281479835510254
mini_batch_src_global generation:  1.4481143951416016
r_  generation:  16.449472427368164
local_output_nid generation:  0.585700273513794
local_in_edges_tensor generation:  1.278740406036377
mini_batch_src_global generation:  1.484257459640503
r_  generation:  16.800530195236206
local_output_nid generation:  0.6095213890075684
local_in_edges_tensor generation:  1.2642021179199219
mini_batch_src_global generation:  1.576672077178955
r_  generation:  16.01504373550415
local_output_nid generation:  0.5829055309295654
local_in_edges_tensor generation:  1.1630101203918457
mini_batch_src_global generation:  1.5868041515350342
r_  generation:  16.3405659198761
----------------------check_connections_block total spend ----------------------------- 180.28204560279846
generate_one_block  21.261314630508423
generate_one_block  21.24878454208374
generate_one_block  21.89035391807556
generate_one_block  21.200822591781616
generate_one_block  20.701849460601807
generate_one_block  21.04251480102539
generate_one_block  21.103238344192505
generate_one_block  21.29478693008423
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  268.2671175003052
block generation total time  256.3303141593933
average batch blocks generation time:  10.680429756641388
block dataloader generation time/epoch 548.6065759658813
pseudo mini batch 0 input nodes size: 2182930
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.8139739036560059  GigaBytes
Max Memory Allocated: 0.8139739036560059  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.814152717590332  GigaBytes
Max Memory Allocated: 0.814152717590332  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.814152717590332  GigaBytes
Max Memory Allocated: 0.814152717590332  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.2198314666748047  GigaBytes
Max Memory Allocated: 1.2198314666748047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.2198314666748047  GigaBytes
Max Memory Allocated: 1.2198314666748047  GigaBytes

first layer input nodes number: 2182930
first layer output nodes number: 1751462
edges number: 36241462
torch.Size([2182930, 100])
torch.Size([1751462, 256])
input nodes number: 1751462
output nodes number: 535536
edges number: 17091212
torch.Size([1751462, 256])
torch.Size([535536, 256])
torch.Size([23972, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3592529296875 GB
    Memory Allocated: 7.784317493438721  GigaBytes
Max Memory Allocated: 8.256242275238037  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.3592529296875 GB
    Memory Allocated: 7.788516044616699  GigaBytes
Max Memory Allocated: 8.256242275238037  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.3983154296875 GB
    Memory Allocated: 1.828683853149414  GigaBytes
Max Memory Allocated: 9.57984209060669  GigaBytes

pseudo mini batch 1 input nodes size: 2188852
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.3983154296875 GB
    Memory Allocated: 0.819119930267334  GigaBytes
Max Memory Allocated: 9.57984209060669  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.3983154296875 GB
    Memory Allocated: 0.819119930267334  GigaBytes
Max Memory Allocated: 9.57984209060669  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.3983154296875 GB
    Memory Allocated: 1.634531021118164  GigaBytes
Max Memory Allocated: 9.57984209060669  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.4002685546875 GB
    Memory Allocated: 1.6347193717956543  GigaBytes
Max Memory Allocated: 9.57984209060669  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.4002685546875 GB
    Memory Allocated: 0.8213353157043457  GigaBytes
Max Memory Allocated: 9.57984209060669  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.4002685546875 GB
    Memory Allocated: 1.2334704399108887  GigaBytes
Max Memory Allocated: 9.57984209060669  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.4002685546875 GB
    Memory Allocated: 1.2334704399108887  GigaBytes
Max Memory Allocated: 9.57984209060669  GigaBytes

first layer input nodes number: 2188852
first layer output nodes number: 1768718
edges number: 36497425
torch.Size([2188852, 100])
torch.Size([1768718, 256])
input nodes number: 1768718
output nodes number: 554638
edges number: 17660543
torch.Size([1768718, 256])
torch.Size([554638, 256])
torch.Size([25250, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4686279296875 GB
    Memory Allocated: 7.907949924468994  GigaBytes
Max Memory Allocated: 9.57984209060669  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.4686279296875 GB
    Memory Allocated: 7.912912845611572  GigaBytes
Max Memory Allocated: 9.57984209060669  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.5135498046875 GB
    Memory Allocated: 1.8499236106872559  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

pseudo mini batch 2 input nodes size: 2185856
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.5135498046875 GB
    Memory Allocated: 0.821558952331543  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.5135498046875 GB
    Memory Allocated: 0.821558952331543  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.5135498046875 GB
    Memory Allocated: 1.6358537673950195  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.5135498046875 GB
    Memory Allocated: 1.6360421180725098  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.5135498046875 GB
    Memory Allocated: 0.8204426765441895  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.5135498046875 GB
    Memory Allocated: 1.2323336601257324  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5135498046875 GB
    Memory Allocated: 1.2323336601257324  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

first layer input nodes number: 2185856
first layer output nodes number: 1765591
edges number: 36444398
torch.Size([2185856, 100])
torch.Size([1765591, 256])
input nodes number: 1765591
output nodes number: 553575
edges number: 17627398
torch.Size([1765591, 256])
torch.Size([553575, 256])
torch.Size([25248, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5135498046875 GB
    Memory Allocated: 7.893190860748291  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.5135498046875 GB
    Memory Allocated: 7.89761209487915  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 1.8484134674072266  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

pseudo mini batch 3 input nodes size: 2183624
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 0.8204421997070312  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 0.8204421997070312  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 1.6339058876037598  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 1.634084701538086  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 0.8196015357971191  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 1.2249503135681152  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 1.2249503135681152  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

first layer input nodes number: 2183624
first layer output nodes number: 1753990
edges number: 36307085
torch.Size([2183624, 100])
torch.Size([1753990, 256])
input nodes number: 1753990
output nodes number: 535272
edges number: 17083863
torch.Size([1753990, 256])
torch.Size([535272, 256])
torch.Size([23951, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 7.791075229644775  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 7.79526948928833  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 1.828650951385498  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

pseudo mini batch 4 input nodes size: 2184367
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 0.8193745613098145  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 0.8193745613098145  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 1.6331148147583008  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 1.633293628692627  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 0.8196511268615723  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 1.224853515625  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 1.224853515625  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

first layer input nodes number: 2184367
first layer output nodes number: 1753522
edges number: 36274705
torch.Size([2184367, 100])
torch.Size([1753522, 256])
input nodes number: 1753522
output nodes number: 536214
edges number: 17106494
torch.Size([1753522, 256])
torch.Size([536214, 256])
torch.Size([23957, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 7.79252815246582  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.1990966796875 GB
    Memory Allocated: 7.796723365783691  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 1.8291025161743164  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

pseudo mini batch 5 input nodes size: 2187585
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 0.8196520805358887  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 0.8196520805358887  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 1.6345911026000977  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 1.634779453277588  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 0.8208603858947754  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 1.2329745292663574  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 1.2329745292663574  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

first layer input nodes number: 2187585
first layer output nodes number: 1771118
edges number: 36509301
torch.Size([2187585, 100])
torch.Size([1771118, 256])
input nodes number: 1771118
output nodes number: 554558
edges number: 17658926
torch.Size([1771118, 256])
torch.Size([554558, 256])
torch.Size([25246, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9412841796875 GB
    Memory Allocated: 7.913154125213623  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9412841796875 GB
    Memory Allocated: 7.917575359344482  GigaBytes
Max Memory Allocated: 9.68051815032959  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 1.8499135971069336  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 6 input nodes size: 2181288
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 0.8210864067077637  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 0.8210864067077637  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 1.6336798667907715  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 1.6338577270507812  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 0.818730354309082  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 1.2223691940307617  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 1.2223691940307617  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2181288
first layer output nodes number: 1750890
edges number: 36232062
torch.Size([2181288, 100])
torch.Size([1750890, 256])
input nodes number: 1750890
output nodes number: 534471
edges number: 17042929
torch.Size([1750890, 256])
torch.Size([534471, 256])
torch.Size([23854, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 7.777286529541016  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 7.781967639923096  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 1.8242383003234863  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 7 input nodes size: 2187430
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 0.818486213684082  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 0.818486213684082  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 1.633425235748291  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 1.6336126327514648  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 0.8208413124084473  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 1.2325453758239746  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 1.2325453758239746  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2187430
first layer output nodes number: 1767475
edges number: 36468701
torch.Size([2187430, 100])
torch.Size([1767475, 256])
input nodes number: 1767475
output nodes number: 552974
edges number: 17609388
torch.Size([1767475, 256])
torch.Size([552974, 256])
torch.Size([25093, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 7.895904064178467  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.2108154296875 GB
    Memory Allocated: 7.900298118591309  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.8983154296875 GB
    Memory Allocated: 1.8476691246032715  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8492064476013184  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8492064476013184  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3867010474205017 |0.5900728702545166 |0.2046183943748474 |0.00016519427299499512 |0.11804500222206116 |0.004230499267578125 |
----------------------------------------------------------pseudo_mini_loss sum 7.166693687438965
Total (block generation + training)time/epoch 559.2577238082886
Training time/epoch 10.650782823562622
Training time without block to device /epoch 5.930199861526489
Training time without total dataloading part /epoch 2.5868592262268066
load block tensor time/epoch 3.0936083793640137
block to device time/epoch 4.720582962036133
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  35921936
Number of first layer input nodes during this epoch:  17481932
Number of first layer output nodes during this epoch:  14082766
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8492059707641602  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.39661169052124023
global_2_local spend time (sec) 0.48946523666381836
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.521 seconds
Metis partitioning: 2.643 seconds
Split the graph: 0.325 seconds
Construct subgraphs: 0.046 seconds
24711
24528
24069
25123
24034
24272
25029
24805
The batched output nid list before graph partition
total k batches seeds list generation spend  3.585298538208008
after graph partition
graph partition algorithm spend time 4.869287967681885
24711
24528
24069
25123
24034
24272
25029
24805
partition_len_list
[546749, 544496, 537410, 553232, 536173, 540190, 550405, 548254]
metis selection method  spend 5.662181377410889
time for parepare:  0.28606605529785156
local_output_nid generation:  0.006354808807373047
local_in_edges_tensor generation:  0.016082763671875
mini_batch_src_global generation:  0.030942916870117188
r_  generation:  0.4191317558288574
local_output_nid generation:  0.007177829742431641
local_in_edges_tensor generation:  0.01342630386352539
mini_batch_src_global generation:  0.04120182991027832
r_  generation:  0.5027375221252441
local_output_nid generation:  0.007045269012451172
local_in_edges_tensor generation:  0.011696577072143555
mini_batch_src_global generation:  0.0328669548034668
r_  generation:  0.48235487937927246
local_output_nid generation:  0.007440328598022461
local_in_edges_tensor generation:  0.010020971298217773
mini_batch_src_global generation:  0.03990912437438965
r_  generation:  0.5857079029083252
local_output_nid generation:  0.008221864700317383
local_in_edges_tensor generation:  0.01922297477722168
mini_batch_src_global generation:  0.04724740982055664
r_  generation:  0.558903694152832
local_output_nid generation:  0.009839534759521484
local_in_edges_tensor generation:  0.04361724853515625
mini_batch_src_global generation:  0.03946042060852051
r_  generation:  0.5550003051757812
local_output_nid generation:  0.007224321365356445
local_in_edges_tensor generation:  0.015222311019897461
mini_batch_src_global generation:  0.043442487716674805
r_  generation:  0.6022238731384277
local_output_nid generation:  0.007427692413330078
local_in_edges_tensor generation:  0.010192394256591797
mini_batch_src_global generation:  0.04270029067993164
r_  generation:  0.5880630016326904
----------------------check_connections_block total spend ----------------------------- 5.9252588748931885
generate_one_block  1.0084257125854492
generate_one_block  0.650930643081665
generate_one_block  0.6715967655181885
generate_one_block  0.8126213550567627
generate_one_block  0.650376558303833
generate_one_block  0.7447061538696289
generate_one_block  0.631126880645752
generate_one_block  0.6272704601287842
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.176255226135254
gen group dst list time:  0.15001606941223145
time for parepare:  0.48453521728515625
local_output_nid generation:  0.18182921409606934
local_in_edges_tensor generation:  0.5716650485992432
mini_batch_src_global generation:  0.5611698627471924
r_  generation:  7.637426853179932
local_output_nid generation:  0.21221113204956055
local_in_edges_tensor generation:  0.5607855319976807
mini_batch_src_global generation:  0.71193528175354
r_  generation:  7.58009147644043
local_output_nid generation:  0.16826748847961426
local_in_edges_tensor generation:  0.5339009761810303
mini_batch_src_global generation:  0.7575576305389404
r_  generation:  8.46845293045044
local_output_nid generation:  0.20070552825927734
local_in_edges_tensor generation:  0.6502203941345215
mini_batch_src_global generation:  0.7468061447143555
r_  generation:  8.045448541641235
local_output_nid generation:  0.1679990291595459
local_in_edges_tensor generation:  0.55751633644104
mini_batch_src_global generation:  0.734769344329834
r_  generation:  7.586638689041138
local_output_nid generation:  0.18703746795654297
local_in_edges_tensor generation:  0.4385230541229248
mini_batch_src_global generation:  0.72762131690979
r_  generation:  7.895155429840088
local_output_nid generation:  0.18230462074279785
local_in_edges_tensor generation:  0.5564849376678467
mini_batch_src_global generation:  0.72998046875
r_  generation:  7.855815172195435
local_output_nid generation:  0.18785357475280762
local_in_edges_tensor generation:  0.4510631561279297
mini_batch_src_global generation:  0.7493977546691895
r_  generation:  8.174977779388428
----------------------check_connections_block total spend ----------------------------- 85.66105890274048
generate_one_block  10.24109411239624
generate_one_block  9.857313394546509
generate_one_block  10.023211002349854
generate_one_block  9.910543203353882
generate_one_block  10.002833366394043
generate_one_block  10.030210733413696
generate_one_block  10.217909574508667
generate_one_block  9.854942798614502
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.283416509628296
gen group dst list time:  0.5234420299530029
time for parepare:  0.49311184883117676
local_output_nid generation:  0.5766985416412354
local_in_edges_tensor generation:  1.2641658782958984
mini_batch_src_global generation:  1.1765408515930176
r_  generation:  16.360265731811523
local_output_nid generation:  0.6300356388092041
local_in_edges_tensor generation:  1.2403571605682373
mini_batch_src_global generation:  1.6346404552459717
r_  generation:  16.01767635345459
local_output_nid generation:  0.6076686382293701
local_in_edges_tensor generation:  1.3069958686828613
mini_batch_src_global generation:  1.5511271953582764
r_  generation:  16.088027715682983
local_output_nid generation:  0.6298589706420898
local_in_edges_tensor generation:  1.2113232612609863
mini_batch_src_global generation:  1.618201732635498
r_  generation:  16.12115716934204
local_output_nid generation:  0.5989058017730713
local_in_edges_tensor generation:  1.2103378772735596
mini_batch_src_global generation:  1.7060356140136719
r_  generation:  18.12769865989685
local_output_nid generation:  0.6286845207214355
local_in_edges_tensor generation:  1.2274255752563477
mini_batch_src_global generation:  1.6701090335845947
r_  generation:  16.220848083496094
local_output_nid generation:  0.6117720603942871
local_in_edges_tensor generation:  1.2289958000183105
mini_batch_src_global generation:  1.6434895992279053
r_  generation:  16.549347162246704
local_output_nid generation:  0.6409313678741455
local_in_edges_tensor generation:  1.2398881912231445
mini_batch_src_global generation:  1.5881857872009277
r_  generation:  16.208664894104004
----------------------check_connections_block total spend ----------------------------- 183.01955938339233
generate_one_block  21.404484272003174
generate_one_block  21.34529447555542
generate_one_block  21.072060108184814
generate_one_block  21.433866500854492
generate_one_block  21.243372678756714
generate_one_block  21.161210536956787
generate_one_block  21.344908714294434
generate_one_block  21.385111570358276
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8492059707641602  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

connection checking time:  274.605877161026
block generation total time  256.32542157173157
average batch blocks generation time:  10.68022589882215
block dataloader generation time/epoch 552.0439960956573
pseudo mini batch 0 input nodes size: 2184990
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8225946426391602  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8225946426391602  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6365671157836914  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.636751651763916  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8216252326965332  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2292771339416504  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2292771339416504  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2184990
first layer output nodes number: 1760638
edges number: 36350369
torch.Size([2184990, 100])
torch.Size([1760638, 256])
input nodes number: 1760638
output nodes number: 546749
edges number: 17429712
torch.Size([1760638, 256])
torch.Size([546749, 256])
torch.Size([24711, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.851099967956543  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.855494499206543  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8401341438293457  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 1 input nodes size: 2187173
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8215594291687012  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8215594291687012  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6364984512329102  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6366815567016602  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8225245475769043  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.230466365814209  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.230466365814209  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2187173
first layer output nodes number: 1760221
edges number: 36402942
torch.Size([2187173, 100])
torch.Size([1760221, 256])
input nodes number: 1760221
output nodes number: 544496
edges number: 17363305
torch.Size([1760221, 256])
torch.Size([544496, 256])
torch.Size([24528, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.8445611000061035  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.848856449127197  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8391423225402832  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 2 input nodes size: 2181416
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8224925994873047  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8224925994873047  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6351337432861328  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6353135108947754  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8201913833618164  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2253422737121582  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2253422737121582  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2181416
first layer output nodes number: 1753018
edges number: 36253269
torch.Size([2181416, 100])
torch.Size([1753018, 256])
input nodes number: 1753018
output nodes number: 537410
edges number: 17130880
torch.Size([1753018, 256])
torch.Size([537410, 256])
torch.Size([24069, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.795520305633545  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.799735069274902  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8292951583862305  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 3 input nodes size: 2186584
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8201107978820801  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8201107978820801  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.635049819946289  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.635237216949463  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8224163055419922  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2342100143432617  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2342100143432617  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2186584
first layer output nodes number: 1769615
edges number: 36521286
torch.Size([2186584, 100])
torch.Size([1769615, 256])
input nodes number: 1769615
output nodes number: 553232
edges number: 17621249
torch.Size([1769615, 256])
torch.Size([553232, 256])
torch.Size([25123, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.904515743255615  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.908915042877197  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8499250411987305  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 4 input nodes size: 2183529
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8226008415222168  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8226008415222168  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6360292434692383  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6362085342407227  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8210821151733398  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2264080047607422  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2264080047607422  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2183529
first layer output nodes number: 1754471
edges number: 36289643
torch.Size([2183529, 100])
torch.Size([1754471, 256])
input nodes number: 1754471
output nodes number: 536173
edges number: 17106681
torch.Size([1754471, 256])
torch.Size([536173, 256])
torch.Size([24034, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.796015739440918  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.800224304199219  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8294391632080078  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 5 input nodes size: 2182080
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8208913803100586  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8208913803100586  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.633779525756836  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6339607238769531  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8203530311584473  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2260751724243164  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2260751724243164  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2182080
first layer output nodes number: 1754517
edges number: 36278277
torch.Size([2182080, 100])
torch.Size([1754517, 256])
input nodes number: 1754517
output nodes number: 540190
edges number: 17213187
torch.Size([1754517, 256])
torch.Size([540190, 256])
torch.Size([24272, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.809960842132568  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.814455986022949  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8326702117919922  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 6 input nodes size: 2185124
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8203949928283691  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8203949928283691  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6344175338745117  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6346044540405273  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8215351104736328  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2336835861206055  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2336835861206055  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2185124
first layer output nodes number: 1765741
edges number: 36464209
torch.Size([2185124, 100])
torch.Size([1765741, 256])
input nodes number: 1765741
output nodes number: 550405
edges number: 17540721
torch.Size([1765741, 256])
torch.Size([550405, 256])
torch.Size([25029, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.884492874145508  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.888875961303711  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8490386009216309  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 7 input nodes size: 2186171
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8216676712036133  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8216676712036133  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.636080265045166  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6362652778625488  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8220558166503906  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2304201126098633  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2304201126098633  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2186171
first layer output nodes number: 1762447
edges number: 36404354
torch.Size([2186171, 100])
torch.Size([1762447, 256])
input nodes number: 1762447
output nodes number: 548254
edges number: 17468040
torch.Size([1762447, 256])
torch.Size([548254, 256])
torch.Size([24805, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.86213493347168  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.86647891998291  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8406124114990234  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8406124114990234  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8406124114990234  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.42672911286354065 |0.38026073575019836 |0.11462363600730896 |0.00015288591384887695 |0.0041488707065582275 |0.0013158321380615234 |
----------------------------------------------------------pseudo_mini_loss sum 12.492077827453613
Total (block generation + training)time/epoch 561.2072775363922
Training time/epoch 7.6751344203948975
Training time without block to device /epoch 4.6330485343933105
Training time without total dataloading part /epoch 0.95271897315979
load block tensor time/epoch 3.413832902908325
block to device time/epoch 3.042085886001587
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  35914644
Number of first layer input nodes during this epoch:  17477067
Number of first layer output nodes during this epoch:  14080668
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8406119346618652  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.33649420738220215
global_2_local spend time (sec) 0.5199193954467773
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.417 seconds
Metis partitioning: 2.663 seconds
Split the graph: 0.311 seconds
Construct subgraphs: 0.050 seconds
23972
25250
25248
23951
23957
25246
23854
25093
The batched output nid list before graph partition
total k batches seeds list generation spend  3.48687744140625
after graph partition
graph partition algorithm spend time 4.762192964553833
23972
25250
25248
23951
23957
25246
23854
25093
partition_len_list
[536588, 554394, 554310, 534766, 537201, 554064, 535314, 552570]
metis selection method  spend 5.585888862609863
time for parepare:  0.27555227279663086
local_output_nid generation:  0.006256818771362305
local_in_edges_tensor generation:  0.029720783233642578
mini_batch_src_global generation:  0.03148627281188965
r_  generation:  0.3929274082183838
local_output_nid generation:  0.007468461990356445
local_in_edges_tensor generation:  0.019353151321411133
mini_batch_src_global generation:  0.041664838790893555
r_  generation:  0.49073219299316406
local_output_nid generation:  0.008277177810668945
local_in_edges_tensor generation:  0.013836860656738281
mini_batch_src_global generation:  0.0280454158782959
r_  generation:  0.5201342105865479
local_output_nid generation:  0.007291316986083984
local_in_edges_tensor generation:  0.013123750686645508
mini_batch_src_global generation:  0.030025720596313477
r_  generation:  0.5527365207672119
local_output_nid generation:  0.009788036346435547
local_in_edges_tensor generation:  0.011275291442871094
mini_batch_src_global generation:  0.03358769416809082
r_  generation:  0.5265226364135742
local_output_nid generation:  0.00970768928527832
local_in_edges_tensor generation:  0.009654521942138672
mini_batch_src_global generation:  0.038053274154663086
r_  generation:  0.5831563472747803
local_output_nid generation:  0.0071184635162353516
local_in_edges_tensor generation:  0.009281158447265625
mini_batch_src_global generation:  0.03832101821899414
r_  generation:  0.5536861419677734
local_output_nid generation:  0.007586479187011719
local_in_edges_tensor generation:  0.021283864974975586
mini_batch_src_global generation:  0.04134726524353027
r_  generation:  0.5813469886779785
----------------------check_connections_block total spend ----------------------------- 5.770713567733765
generate_one_block  0.9734611511230469
generate_one_block  0.6514699459075928
generate_one_block  0.6193184852600098
generate_one_block  0.5918140411376953
generate_one_block  0.6111030578613281
generate_one_block  0.6413931846618652
generate_one_block  0.7451431751251221
generate_one_block  0.848374605178833
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0726375579833984
gen group dst list time:  0.15323543548583984
time for parepare:  0.47395849227905273
local_output_nid generation:  0.17159390449523926
local_in_edges_tensor generation:  0.5751643180847168
mini_batch_src_global generation:  0.5589072704315186
r_  generation:  7.311460733413696
local_output_nid generation:  0.20873618125915527
local_in_edges_tensor generation:  0.6005563735961914
mini_batch_src_global generation:  0.7193965911865234
r_  generation:  7.885800838470459
local_output_nid generation:  0.20410895347595215
local_in_edges_tensor generation:  0.6410431861877441
mini_batch_src_global generation:  0.699488639831543
r_  generation:  7.84272837638855
local_output_nid generation:  0.17034626007080078
local_in_edges_tensor generation:  0.49867916107177734
mini_batch_src_global generation:  0.7794723510742188
r_  generation:  7.509608268737793
local_output_nid generation:  0.18690943717956543
local_in_edges_tensor generation:  0.4969310760498047
mini_batch_src_global generation:  0.7105238437652588
r_  generation:  7.614304780960083
local_output_nid generation:  0.17560386657714844
local_in_edges_tensor generation:  0.4562978744506836
mini_batch_src_global generation:  0.7656683921813965
r_  generation:  8.118204593658447
local_output_nid generation:  0.1905522346496582
local_in_edges_tensor generation:  0.49262094497680664
mini_batch_src_global generation:  0.7206230163574219
r_  generation:  7.6161415576934814
local_output_nid generation:  0.18318700790405273
local_in_edges_tensor generation:  0.5089197158813477
mini_batch_src_global generation:  0.7498195171356201
r_  generation:  8.048348665237427
----------------------check_connections_block total spend ----------------------------- 84.17769074440002
generate_one_block  10.083449602127075
generate_one_block  10.408675909042358
generate_one_block  10.237454414367676
generate_one_block  9.704339742660522
generate_one_block  9.705241918563843
generate_one_block  10.28657078742981
generate_one_block  9.68200397491455
generate_one_block  10.14980697631836
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.314854383468628
gen group dst list time:  0.529139518737793
time for parepare:  0.4785163402557373
local_output_nid generation:  0.5925998687744141
local_in_edges_tensor generation:  1.2477800846099854
mini_batch_src_global generation:  1.1535661220550537
r_  generation:  15.999600648880005
local_output_nid generation:  0.6192963123321533
local_in_edges_tensor generation:  1.2870705127716064
mini_batch_src_global generation:  1.4802730083465576
r_  generation:  16.67607831954956
local_output_nid generation:  0.6281630992889404
local_in_edges_tensor generation:  1.2341368198394775
mini_batch_src_global generation:  1.5052192211151123
r_  generation:  16.499249696731567
local_output_nid generation:  0.6009941101074219
local_in_edges_tensor generation:  1.223059892654419
mini_batch_src_global generation:  1.4739336967468262
r_  generation:  16.41922163963318
local_output_nid generation:  0.592735767364502
local_in_edges_tensor generation:  1.2347071170806885
mini_batch_src_global generation:  1.5258471965789795
r_  generation:  16.28093910217285
local_output_nid generation:  0.619870662689209
local_in_edges_tensor generation:  1.0922646522521973
mini_batch_src_global generation:  1.6757123470306396
r_  generation:  16.28596067428589
local_output_nid generation:  0.612293004989624
local_in_edges_tensor generation:  1.2354671955108643
mini_batch_src_global generation:  1.657646656036377
r_  generation:  16.353617191314697
local_output_nid generation:  0.6264641284942627
local_in_edges_tensor generation:  1.2415781021118164
mini_batch_src_global generation:  1.5437514781951904
r_  generation:  16.71148681640625
----------------------check_connections_block total spend ----------------------------- 181.06877398490906
generate_one_block  21.332041263580322
generate_one_block  21.514446258544922
generate_one_block  21.47805142402649
generate_one_block  21.274792432785034
generate_one_block  21.164384365081787
generate_one_block  21.129244804382324
generate_one_block  21.880566120147705
generate_one_block  21.17938780784607
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8406119346618652  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

connection checking time:  271.01717829704285
block generation total time  256.89253544807434
average batch blocks generation time:  10.703855643669764
block dataloader generation time/epoch 551.9049155712128
pseudo mini batch 0 input nodes size: 2184279
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8220157623291016  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8220157623291016  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6357231140136719  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.635901927947998  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8213043212890625  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2265543937683105  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2265543937683105  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2184279
first layer output nodes number: 1754514
edges number: 36280003
torch.Size([2184279, 100])
torch.Size([1754514, 256])
input nodes number: 1754514
output nodes number: 536588
edges number: 17109320
torch.Size([1754514, 256])
torch.Size([536588, 256])
torch.Size([23972, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.797980785369873  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.802179336547852  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8301458358764648  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 1 input nodes size: 2185917
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8211593627929688  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8211593627929688  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6355719566345215  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6357603073120117  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8218741416931152  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2340044975280762  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2340044975280762  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2185917
first layer output nodes number: 1765783
edges number: 36442492
torch.Size([2185917, 100])
torch.Size([1765783, 256])
input nodes number: 1765783
output nodes number: 554394
edges number: 17659182
torch.Size([1765783, 256])
torch.Size([554394, 256])
torch.Size([25250, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.898829460144043  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.9032511711120605  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.850250244140625  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 2 input nodes size: 2187425
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8220977783203125  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8220977783203125  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.636977195739746  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6371655464172363  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8225646018981934  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.234570026397705  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.234570026397705  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2187425
first layer output nodes number: 1768304
edges number: 36464301
torch.Size([2187425, 100])
torch.Size([1768304, 256])
input nodes number: 1768304
output nodes number: 554310
edges number: 17643737
torch.Size([1768304, 256])
torch.Size([554310, 256])
torch.Size([25248, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.904314041137695  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.908735275268555  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8503799438476562  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 3 input nodes size: 2181387
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8225641250610352  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8225641250610352  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6351943016052246  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6353731155395508  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.820305347442627  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2253718376159668  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2253718376159668  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2181387
first layer output nodes number: 1752943
edges number: 36278717
torch.Size([2181387, 100])
torch.Size([1752943, 256])
input nodes number: 1752943
output nodes number: 534766
edges number: 17065212
torch.Size([1752943, 256])
torch.Size([534766, 256])
torch.Size([23951, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.78639554977417  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.790589809417725  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8282232284545898  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 4 input nodes size: 2182643
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8200783729553223  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8200783729553223  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.633176326751709  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6333551406860352  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8205461502075195  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2260761260986328  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2260761260986328  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2182643
first layer output nodes number: 1754371
edges number: 36303971
torch.Size([2182643, 100])
torch.Size([1754371, 256])
input nodes number: 1754371
output nodes number: 537201
edges number: 17136810
torch.Size([1754371, 256])
torch.Size([537201, 256])
torch.Size([23957, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.799338340759277  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.803533554077148  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8301239013671875  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 5 input nodes size: 2186827
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8205471038818359  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8205471038818359  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6352038383483887  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.635392189025879  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.822115421295166  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.234117031097412  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.234117031097412  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2186827
first layer output nodes number: 1768866
edges number: 36496454
torch.Size([2186827, 100])
torch.Size([1768866, 256])
input nodes number: 1768866
output nodes number: 554064
edges number: 17644372
torch.Size([1768866, 256])
torch.Size([554064, 256])
torch.Size([25246, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.906827449798584  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.911248683929443  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8511714935302734  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 6 input nodes size: 2183319
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8223414421081543  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8223414421081543  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6356911659240723  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.635869026184082  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8210239410400391  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2255024909973145  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2255024909973145  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2183319
first layer output nodes number: 1749815
edges number: 36206198
torch.Size([2183319, 100])
torch.Size([1749815, 256])
input nodes number: 1749815
output nodes number: 535314
edges number: 17057070
torch.Size([1749815, 256])
torch.Size([535314, 256])
torch.Size([23854, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.78034782409668  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.784524917602539  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8284425735473633  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

pseudo mini batch 7 input nodes size: 2188817
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8207798004150391  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8207798004150391  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6361780166625977  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6363654136657715  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8228378295898438  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2344589233398438  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2344589233398438  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

first layer input nodes number: 2188817
first layer output nodes number: 1770635
edges number: 36537485
torch.Size([2188817, 100])
torch.Size([1770635, 256])
input nodes number: 1770635
output nodes number: 552570
edges number: 17599363
torch.Size([1770635, 256])
torch.Size([552570, 256])
torch.Size([25093, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.905686855316162  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.910080909729004  GigaBytes
Max Memory Allocated: 9.689786911010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8507204055786133  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8507204055786133  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8507204055786133  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.41949376463890076 |0.3823898136615753 |0.11450281739234924 |0.0001525282859802246 |0.004204064607620239 |0.0013003349304199219 |
----------------------------------------------------------pseudo_mini_loss sum 3.621471881866455
Total (block generation + training)time/epoch 560.5593738555908
Training time/epoch 7.63659405708313
Training time without block to device /epoch 4.577475547790527
Training time without total dataloading part /epoch 0.9521756172180176
load block tensor time/epoch 3.355950117111206
block to device time/epoch 3.0591185092926025
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  35925052
Number of first layer input nodes during this epoch:  17480614
Number of first layer output nodes during this epoch:  14085231
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.850719928741455  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.30380868911743164
global_2_local spend time (sec) 0.5454502105712891
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.503 seconds
Metis partitioning: 2.732 seconds
Split the graph: 0.314 seconds
Construct subgraphs: 0.071 seconds
23972
25250
25248
23951
23957
25246
23854
25093
The batched output nid list before graph partition
total k batches seeds list generation spend  3.6695055961608887
after graph partition
graph partition algorithm spend time 4.909878730773926
23972
25250
25248
23951
23957
25246
23854
25093
partition_len_list
[537160, 554434, 555986, 532493, 537639, 553618, 533917, 552407]
metis selection method  spend 5.742419958114624
time for parepare:  0.26725292205810547
local_output_nid generation:  0.006522178649902344
local_in_edges_tensor generation:  0.0140838623046875
mini_batch_src_global generation:  0.03195643424987793
r_  generation:  0.40224504470825195
local_output_nid generation:  0.007367610931396484
local_in_edges_tensor generation:  0.02654242515563965
mini_batch_src_global generation:  0.04515695571899414
r_  generation:  0.4828178882598877
local_output_nid generation:  0.007519960403442383
local_in_edges_tensor generation:  0.028915882110595703
mini_batch_src_global generation:  0.029967308044433594
r_  generation:  0.5126917362213135
local_output_nid generation:  0.008319854736328125
local_in_edges_tensor generation:  0.01337575912475586
mini_batch_src_global generation:  0.03977704048156738
r_  generation:  0.5478804111480713
local_output_nid generation:  0.007173776626586914
local_in_edges_tensor generation:  0.009176254272460938
mini_batch_src_global generation:  0.03482508659362793
r_  generation:  0.5733239650726318
local_output_nid generation:  0.007584095001220703
local_in_edges_tensor generation:  0.010703325271606445
mini_batch_src_global generation:  0.04402446746826172
r_  generation:  0.5814394950866699
local_output_nid generation:  0.008559703826904297
local_in_edges_tensor generation:  0.009133100509643555
mini_batch_src_global generation:  0.04093480110168457
r_  generation:  0.5731377601623535
local_output_nid generation:  0.0074880123138427734
local_in_edges_tensor generation:  0.009399890899658203
mini_batch_src_global generation:  0.04112720489501953
r_  generation:  0.5808899402618408
----------------------check_connections_block total spend ----------------------------- 5.798376560211182
generate_one_block  0.9848260879516602
generate_one_block  0.644183874130249
generate_one_block  0.6298985481262207
generate_one_block  0.5898478031158447
generate_one_block  0.6052463054656982
generate_one_block  0.6634654998779297
generate_one_block  0.5977506637573242
generate_one_block  0.6308553218841553
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1252939701080322
gen group dst list time:  0.14412617683410645
time for parepare:  0.44890904426574707
local_output_nid generation:  0.17925286293029785
local_in_edges_tensor generation:  0.49802231788635254
mini_batch_src_global generation:  0.5619950294494629
r_  generation:  7.190721035003662
local_output_nid generation:  0.17636895179748535
local_in_edges_tensor generation:  0.5864419937133789
mini_batch_src_global generation:  0.7991018295288086
r_  generation:  7.494714021682739
local_output_nid generation:  0.19182038307189941
local_in_edges_tensor generation:  0.5202846527099609
mini_batch_src_global generation:  0.7104711532592773
r_  generation:  7.9307801723480225
local_output_nid generation:  0.18729257583618164
local_in_edges_tensor generation:  0.5427877902984619
mini_batch_src_global generation:  0.7011752128601074
r_  generation:  7.405527353286743
local_output_nid generation:  0.17238092422485352
local_in_edges_tensor generation:  0.5020554065704346
mini_batch_src_global generation:  0.71846604347229
r_  generation:  7.653148889541626
local_output_nid generation:  0.1812000274658203
local_in_edges_tensor generation:  0.45854926109313965
mini_batch_src_global generation:  0.7755825519561768
r_  generation:  7.865761041641235
local_output_nid generation:  0.18825578689575195
local_in_edges_tensor generation:  0.5281860828399658
mini_batch_src_global generation:  0.7286965847015381
r_  generation:  7.539203882217407
local_output_nid generation:  0.18257904052734375
local_in_edges_tensor generation:  0.4575233459472656
mini_batch_src_global generation:  0.7925043106079102
r_  generation:  7.984767436981201
----------------------check_connections_block total spend ----------------------------- 82.95000386238098
generate_one_block  10.047229766845703
generate_one_block  10.410738229751587
generate_one_block  10.318976163864136
generate_one_block  9.600316762924194
generate_one_block  9.71030879020691
generate_one_block  10.317354440689087
generate_one_block  9.633030891418457
generate_one_block  9.970018148422241
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2746386528015137
gen group dst list time:  0.5153350830078125
time for parepare:  0.4931316375732422
local_output_nid generation:  0.6002018451690674
local_in_edges_tensor generation:  1.3797383308410645
mini_batch_src_global generation:  1.196079969406128
r_  generation:  16.03925609588623
local_output_nid generation:  0.6177935600280762
local_in_edges_tensor generation:  1.3226966857910156
mini_batch_src_global generation:  1.5007290840148926
r_  generation:  16.30064296722412
local_output_nid generation:  0.616196870803833
local_in_edges_tensor generation:  1.3010196685791016
mini_batch_src_global generation:  1.4696156978607178
r_  generation:  15.964561223983765
local_output_nid generation:  0.5950193405151367
local_in_edges_tensor generation:  1.2283217906951904
mini_batch_src_global generation:  1.513028621673584
r_  generation:  15.880956649780273
local_output_nid generation:  0.6214783191680908
local_in_edges_tensor generation:  1.2371594905853271
mini_batch_src_global generation:  1.5300683975219727
r_  generation:  16.188335180282593
local_output_nid generation:  0.6153402328491211
local_in_edges_tensor generation:  1.091951608657837
mini_batch_src_global generation:  1.4721016883850098
r_  generation:  16.45072364807129
local_output_nid generation:  0.5863053798675537
local_in_edges_tensor generation:  1.23115873336792
mini_batch_src_global generation:  1.49114990234375
r_  generation:  15.984107494354248
local_output_nid generation:  0.6046180725097656
local_in_edges_tensor generation:  1.2698593139648438
mini_batch_src_global generation:  1.5265922546386719
r_  generation:  16.066879272460938
----------------------check_connections_block total spend ----------------------------- 178.99827814102173
generate_one_block  20.961124897003174
generate_one_block  21.247684478759766
generate_one_block  21.388265132904053
generate_one_block  21.023829460144043
generate_one_block  21.15678858757019
generate_one_block  21.214967727661133
generate_one_block  21.84295654296875
generate_one_block  21.40817403793335
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.850719928741455  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

connection checking time:  267.7466585636139
block generation total time  255.59783816337585
average batch blocks generation time:  10.649909923473993
block dataloader generation time/epoch 550.8623299002647
pseudo mini batch 0 input nodes size: 2183116
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8230538368225098  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8230538368225098  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6363282203674316  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6365070343017578  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8209214210510254  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2262969017028809  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2262969017028809  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2183116
first layer output nodes number: 1752963
edges number: 36277936
torch.Size([2183116, 100])
torch.Size([1752963, 256])
input nodes number: 1752963
output nodes number: 537160
edges number: 17143036
torch.Size([1752963, 256])
torch.Size([537160, 256])
torch.Size([23972, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.796339511871338  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.800538063049316  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.831740379333496  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 1 input nodes size: 2186840
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8216333389282227  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8216333389282227  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6370315551757812  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6372199058532715  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8237667083740234  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2359647750854492  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2359647750854492  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2186840
first layer output nodes number: 1769625
edges number: 36534826
torch.Size([2186840, 100])
torch.Size([1769625, 256])
input nodes number: 1769625
output nodes number: 554434
edges number: 17668829
torch.Size([1769625, 256])
torch.Size([554434, 256])
torch.Size([25250, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.908714294433594  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.913136005401611  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.850595474243164  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 2 input nodes size: 2188971
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8230834007263184  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8230834007263184  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6385388374328613  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6387271881103516  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8231406211853027  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.235551357269287  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.235551357269287  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2188971
first layer output nodes number: 1769137
edges number: 36482528
torch.Size([2188971, 100])
torch.Size([1769137, 256])
input nodes number: 1769137
output nodes number: 555986
edges number: 17699188
torch.Size([1769137, 256])
torch.Size([555986, 256])
torch.Size([25248, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.913973331451416  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.918395042419434  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8533554077148438  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 3 input nodes size: 2182269
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8231401443481445  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8231401443481445  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.636098861694336  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.636277675628662  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8206338882446289  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2234563827514648  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2234563827514648  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2182269
first layer output nodes number: 1747901
edges number: 36174530
torch.Size([2182269, 100])
torch.Size([1747901, 256])
input nodes number: 1747901
output nodes number: 532493
edges number: 16988260
torch.Size([1747901, 256])
torch.Size([532493, 256])
torch.Size([23951, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.763546943664551  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.7677412033081055  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.8240704536437988  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 4 input nodes size: 2182724
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8208513259887695  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8208513259887695  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6339797973632812  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6341586112976074  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8210210800170898  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.226600170135498  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.226600170135498  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2182724
first layer output nodes number: 1755000
edges number: 36312243
torch.Size([2182724, 100])
torch.Size([1755000, 256])
input nodes number: 1755000
output nodes number: 537639
edges number: 17136220
torch.Size([1755000, 256])
torch.Size([537639, 256])
torch.Size([23957, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.803708553314209  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.80790376663208  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.831716537475586  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 5 input nodes size: 2188687
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8205776214599609  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8205776214599609  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.6359272003173828  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.636115550994873  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 0.8228082656860352  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2346067428588867  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 1.2346067428588867  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2188687
first layer output nodes number: 1769719
edges number: 36501922
torch.Size([2188687, 100])
torch.Size([1769719, 256])
input nodes number: 1769719
output nodes number: 553618
edges number: 17614908
torch.Size([1769719, 256])
torch.Size([553618, 256])
torch.Size([25246, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.907037258148193  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9002685546875 GB
    Memory Allocated: 7.911458492279053  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8502535820007324  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 6 input nodes size: 2181119
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8230342864990234  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8230342864990234  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6355648040771484  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6357426643371582  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8202047348022461  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2237749099731445  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2237749099731445  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2181119
first layer output nodes number: 1749270
edges number: 36223295
torch.Size([2181119, 100])
torch.Size([1749270, 256])
input nodes number: 1749270
output nodes number: 533917
edges number: 17039437
torch.Size([1749270, 256])
torch.Size([533917, 256])
torch.Size([23854, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.772190093994141  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.776729106903076  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.826004981994629  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 7 input nodes size: 2186663
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8199605941772461  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8199605941772461  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.635310173034668  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6354975700378418  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.822789192199707  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2344732284545898  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2344732284545898  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2186663
first layer output nodes number: 1767820
edges number: 36490157
torch.Size([2186663, 100])
torch.Size([1767820, 256])
input nodes number: 1767820
output nodes number: 552407
edges number: 17607659
torch.Size([1767820, 256])
torch.Size([552407, 256])
torch.Size([25093, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.896888256072998  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.90128231048584  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8492546081542969  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8492546081542969  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8492546081542969  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.43684032559394836 |0.5449334383010864 |0.11579832434654236 |0.00014969706535339355 |0.004685878753662109 |0.002943277359008789 |
----------------------------------------------------------pseudo_mini_loss sum 4.522913455963135
Total (block generation + training)time/epoch 559.6259491443634
Training time/epoch 9.09087586402893
Training time without block to device /epoch 4.731408357620239
Training time without total dataloading part /epoch 0.9680144786834717
load block tensor time/epoch 3.494722604751587
block to device time/epoch 4.359467506408691
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  35919478
Number of first layer input nodes during this epoch:  17480389
Number of first layer output nodes during this epoch:  14081435
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8492541313171387  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.33896946907043457
global_2_local spend time (sec) 0.5462372303009033
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.438 seconds
Metis partitioning: 2.750 seconds
Split the graph: 0.345 seconds
Construct subgraphs: 0.055 seconds
23972
25250
25248
23951
23957
25246
23854
25093
The batched output nid list before graph partition
total k batches seeds list generation spend  3.6365859508514404
after graph partition
graph partition algorithm spend time 4.947879076004028
23972
25250
25248
23951
23957
25246
23854
25093
partition_len_list
[538268, 553788, 555328, 535974, 535086, 553351, 533439, 552912]
metis selection method  spend 5.7752525806427
time for parepare:  0.2668039798736572
local_output_nid generation:  0.008187055587768555
local_in_edges_tensor generation:  0.009070634841918945
mini_batch_src_global generation:  0.030858516693115234
r_  generation:  0.3973369598388672
local_output_nid generation:  0.0074388980865478516
local_in_edges_tensor generation:  0.00907588005065918
mini_batch_src_global generation:  0.042670249938964844
r_  generation:  0.4730565547943115
local_output_nid generation:  0.0074083805084228516
local_in_edges_tensor generation:  0.017674922943115234
mini_batch_src_global generation:  0.03096914291381836
r_  generation:  0.4980630874633789
local_output_nid generation:  0.007336139678955078
local_in_edges_tensor generation:  0.012857913970947266
mini_batch_src_global generation:  0.03136157989501953
r_  generation:  0.5146315097808838
local_output_nid generation:  0.007334709167480469
local_in_edges_tensor generation:  0.010258913040161133
mini_batch_src_global generation:  0.03325700759887695
r_  generation:  0.5355503559112549
local_output_nid generation:  0.007632017135620117
local_in_edges_tensor generation:  0.0210421085357666
mini_batch_src_global generation:  0.040897369384765625
r_  generation:  0.5752542018890381
local_output_nid generation:  0.0075109004974365234
local_in_edges_tensor generation:  0.012067794799804688
mini_batch_src_global generation:  0.03866720199584961
r_  generation:  0.569159746170044
local_output_nid generation:  0.008824348449707031
local_in_edges_tensor generation:  0.02543926239013672
mini_batch_src_global generation:  0.039934635162353516
r_  generation:  0.6170849800109863
----------------------check_connections_block total spend ----------------------------- 5.717428684234619
generate_one_block  0.9868762493133545
generate_one_block  0.7026607990264893
generate_one_block  0.7807824611663818
generate_one_block  0.7787032127380371
generate_one_block  0.6091728210449219
generate_one_block  0.6179001331329346
generate_one_block  0.5842733383178711
generate_one_block  0.6288869380950928
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.191650152206421
gen group dst list time:  0.1389777660369873
time for parepare:  0.44353556632995605
local_output_nid generation:  0.17369318008422852
local_in_edges_tensor generation:  0.5557496547698975
mini_batch_src_global generation:  0.5622096061706543
r_  generation:  7.0927183628082275
local_output_nid generation:  0.18384242057800293
local_in_edges_tensor generation:  0.4458150863647461
mini_batch_src_global generation:  0.7084624767303467
r_  generation:  7.680811643600464
local_output_nid generation:  0.20095324516296387
local_in_edges_tensor generation:  0.5212938785552979
mini_batch_src_global generation:  0.711625337600708
r_  generation:  7.620379686355591
local_output_nid generation:  0.1786479949951172
local_in_edges_tensor generation:  0.4959559440612793
mini_batch_src_global generation:  0.7060976028442383
r_  generation:  7.617030382156372
local_output_nid generation:  0.18490839004516602
local_in_edges_tensor generation:  0.44495701789855957
mini_batch_src_global generation:  0.8021223545074463
r_  generation:  7.59943699836731
local_output_nid generation:  0.20455002784729004
local_in_edges_tensor generation:  0.5680224895477295
mini_batch_src_global generation:  0.7333860397338867
r_  generation:  7.775485992431641
local_output_nid generation:  0.20027565956115723
local_in_edges_tensor generation:  0.53470778465271
mini_batch_src_global generation:  0.7618722915649414
r_  generation:  7.840831995010376
local_output_nid generation:  0.1840505599975586
local_in_edges_tensor generation:  0.5058979988098145
mini_batch_src_global generation:  0.778123140335083
r_  generation:  7.82143497467041
----------------------check_connections_block total spend ----------------------------- 82.99152159690857
generate_one_block  10.130095720291138
generate_one_block  10.579587936401367
generate_one_block  10.101916551589966
generate_one_block  9.711636066436768
generate_one_block  9.945622682571411
generate_one_block  10.001954317092896
generate_one_block  9.677805662155151
generate_one_block  10.301892042160034
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.29890775680542
gen group dst list time:  0.5515224933624268
time for parepare:  0.46815967559814453
local_output_nid generation:  0.570310115814209
local_in_edges_tensor generation:  1.3347291946411133
mini_batch_src_global generation:  1.1580970287322998
r_  generation:  16.063100576400757
local_output_nid generation:  0.6215009689331055
local_in_edges_tensor generation:  1.322270154953003
mini_batch_src_global generation:  1.5104916095733643
r_  generation:  16.310880184173584
local_output_nid generation:  0.6006035804748535
local_in_edges_tensor generation:  1.2846310138702393
mini_batch_src_global generation:  1.5005111694335938
r_  generation:  16.154918909072876
local_output_nid generation:  0.6023881435394287
local_in_edges_tensor generation:  1.2411000728607178
mini_batch_src_global generation:  1.5779597759246826
r_  generation:  15.985017776489258
local_output_nid generation:  0.6138811111450195
local_in_edges_tensor generation:  1.1752831935882568
mini_batch_src_global generation:  1.6061146259307861
r_  generation:  16.31726574897766
local_output_nid generation:  0.6075716018676758
local_in_edges_tensor generation:  1.1723558902740479
mini_batch_src_global generation:  1.4888134002685547
r_  generation:  16.441798210144043
local_output_nid generation:  0.5802388191223145
local_in_edges_tensor generation:  1.2684102058410645
mini_batch_src_global generation:  1.5629115104675293
r_  generation:  16.156399726867676
local_output_nid generation:  0.6275639533996582
local_in_edges_tensor generation:  1.2471191883087158
mini_batch_src_global generation:  1.5912353992462158
r_  generation:  16.262863874435425
----------------------check_connections_block total spend ----------------------------- 179.83074140548706
generate_one_block  21.14498472213745
generate_one_block  21.318952560424805
generate_one_block  21.48058557510376
generate_one_block  21.271601915359497
generate_one_block  21.228323221206665
generate_one_block  21.107190132141113
generate_one_block  21.795552015304565
generate_one_block  21.174459218978882
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8492541313171387  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

connection checking time:  268.53969168663025
block generation total time  256.66141629219055
average batch blocks generation time:  10.694225678841272
block dataloader generation time/epoch 550.6812363624573
pseudo mini batch 0 input nodes size: 2182355
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.823005199432373  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.823005199432373  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.635995864868164  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6361746788024902  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8206377029418945  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2256298065185547  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2256298065185547  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2182355
first layer output nodes number: 1754758
edges number: 36285735
torch.Size([2182355, 100])
torch.Size([1754758, 256])
input nodes number: 1754758
output nodes number: 538268
edges number: 17164248
torch.Size([1754758, 256])
torch.Size([538268, 256])
torch.Size([23972, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.8026323318481445  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.806830883026123  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8299322128295898  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 1 input nodes size: 2189960
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8204426765441895  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8204426765441895  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6362667083740234  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6364550590515137  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8232855796813965  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2351202964782715  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2351202964782715  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2189960
first layer output nodes number: 1770071
edges number: 36497414
torch.Size([2189960, 100])
torch.Size([1770071, 256])
input nodes number: 1770071
output nodes number: 553788
edges number: 17621925
torch.Size([1770071, 256])
torch.Size([553788, 256])
torch.Size([25250, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.909667015075684  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.914088726043701  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8516559600830078  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 2 input nodes size: 2185951
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8235092163085938  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8235092163085938  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6378397941589355  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6380281448364258  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8220157623291016  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2343711853027344  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2343711853027344  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2185951
first layer output nodes number: 1767287
edges number: 36450199
torch.Size([2185951, 100])
torch.Size([1767287, 256])
input nodes number: 1767287
output nodes number: 555328
edges number: 17689388
torch.Size([1767287, 256])
torch.Size([555328, 256])
torch.Size([25248, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.905173301696777  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.909594535827637  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8508214950561523  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 3 input nodes size: 2183626
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8220152854919434  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8220152854919434  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.63547945022583  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6356582641601562  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8211393356323242  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.226891040802002  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.226891040802002  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2183626
first layer output nodes number: 1755363
edges number: 36343376
torch.Size([2183626, 100])
torch.Size([1755363, 256])
input nodes number: 1755363
output nodes number: 535974
edges number: 17119534
torch.Size([1755363, 256])
torch.Size([535974, 256])
torch.Size([23951, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.799568176269531  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.803762435913086  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8315324783325195  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 4 input nodes size: 2183132
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8209123611450195  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8209123611450195  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6341924667358398  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.634371280670166  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8207283020019531  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2256059646606445  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2256059646606445  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2183132
first layer output nodes number: 1752405
edges number: 36249052
torch.Size([2183132, 100])
torch.Size([1752405, 256])
input nodes number: 1752405
output nodes number: 535086
edges number: 17069971
torch.Size([1752405, 256])
torch.Size([535086, 256])
torch.Size([23957, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.787559986114502  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.791755199432373  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.828991413116455  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 5 input nodes size: 2186591
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8207292556762695  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8207292556762695  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.635298252105713  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6354866027832031  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8220276832580566  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2318634986877441  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2318634986877441  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2186591
first layer output nodes number: 1765477
edges number: 36430740
torch.Size([2186591, 100])
torch.Size([1765477, 256])
input nodes number: 1765477
output nodes number: 553351
edges number: 17622287
torch.Size([1765477, 256])
torch.Size([553351, 256])
torch.Size([25246, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.889795780181885  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.894217014312744  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8451738357543945  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 6 input nodes size: 2183885
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8222537040710449  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8222537040710449  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6358146667480469  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6359925270080566  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.821235179901123  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.224963665008545  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.224963665008545  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2183885
first layer output nodes number: 1751916
edges number: 36259963
torch.Size([2183885, 100])
torch.Size([1751916, 256])
input nodes number: 1751916
output nodes number: 533439
edges number: 17025363
torch.Size([1751916, 256])
torch.Size([533439, 256])
torch.Size([23854, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.778675556182861  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.783529281616211  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8265509605407715  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 7 input nodes size: 2186851
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.820991039276123  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.820991039276123  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6356568336486816  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6358442306518555  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8221054077148438  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2338438034057617  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2338438034057617  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2186851
first layer output nodes number: 1770589
edges number: 36546590
torch.Size([2186851, 100])
torch.Size([1770589, 256])
input nodes number: 1770589
output nodes number: 552912
edges number: 17615510
torch.Size([1770589, 256])
torch.Size([552912, 256])
torch.Size([25093, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.908325672149658  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.9127197265625  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8499493598937988  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8499493598937988  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8499493598937988  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4188244640827179 |0.43156543374061584 |0.11386927962303162 |0.00014951825141906738 |0.004242658615112305 |0.0013103485107421875 |
----------------------------------------------------------pseudo_mini_loss sum 3.393775701522827
Total (block generation + training)time/epoch 559.297072315216
Training time/epoch 8.024410486221313
Training time without block to device /epoch 4.571887016296387
Training time without total dataloading part /epoch 0.9474020004272461
load block tensor time/epoch 3.350595712661743
block to device time/epoch 3.4525234699249268
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  35928363
Number of first layer input nodes during this epoch:  17482351
Number of first layer output nodes during this epoch:  14087866
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8499488830566406  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.31685423851013184
global_2_local spend time (sec) 0.5430600643157959
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.514 seconds
Metis partitioning: 2.774 seconds
Split the graph: 0.335 seconds
Construct subgraphs: 0.053 seconds
23972
25250
25248
23951
23957
25246
23854
25093
The batched output nid list before graph partition
total k batches seeds list generation spend  3.7262818813323975
after graph partition
graph partition algorithm spend time 4.987441062927246
23972
25250
25248
23951
23957
25246
23854
25093
partition_len_list
[534666, 554016, 552404, 535868, 536727, 555611, 535327, 552497]
metis selection method  spend 5.816054821014404
time for parepare:  0.2669801712036133
local_output_nid generation:  0.0064160823822021484
local_in_edges_tensor generation:  0.00898885726928711
mini_batch_src_global generation:  0.030341625213623047
r_  generation:  0.39005160331726074
local_output_nid generation:  0.007441997528076172
local_in_edges_tensor generation:  0.009185791015625
mini_batch_src_global generation:  0.0399472713470459
r_  generation:  0.47261524200439453
local_output_nid generation:  0.007399797439575195
local_in_edges_tensor generation:  0.016016244888305664
mini_batch_src_global generation:  0.027540206909179688
r_  generation:  0.49159741401672363
local_output_nid generation:  0.007336139678955078
local_in_edges_tensor generation:  0.009284257888793945
mini_batch_src_global generation:  0.030579328536987305
r_  generation:  0.4977385997772217
local_output_nid generation:  0.007422208786010742
local_in_edges_tensor generation:  0.01076817512512207
mini_batch_src_global generation:  0.033010005950927734
r_  generation:  0.5288290977478027
local_output_nid generation:  0.007712125778198242
local_in_edges_tensor generation:  0.014600753784179688
mini_batch_src_global generation:  0.037711381912231445
r_  generation:  0.5813379287719727
local_output_nid generation:  0.007353305816650391
local_in_edges_tensor generation:  0.014204978942871094
mini_batch_src_global generation:  0.048772335052490234
r_  generation:  0.5584285259246826
local_output_nid generation:  0.007617950439453125
local_in_edges_tensor generation:  0.01204824447631836
mini_batch_src_global generation:  0.04045820236206055
r_  generation:  0.5908505916595459
----------------------check_connections_block total spend ----------------------------- 5.598705053329468
generate_one_block  0.9787740707397461
generate_one_block  0.6683886051177979
generate_one_block  0.6622583866119385
generate_one_block  0.5921463966369629
generate_one_block  0.6068336963653564
generate_one_block  0.9344091415405273
generate_one_block  0.6945018768310547
generate_one_block  0.6385116577148438
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.298581600189209
gen group dst list time:  0.13965368270874023
time for parepare:  0.45733070373535156
local_output_nid generation:  0.1753072738647461
local_in_edges_tensor generation:  0.5784621238708496
mini_batch_src_global generation:  0.5901269912719727
r_  generation:  7.264351844787598
local_output_nid generation:  0.20879125595092773
local_in_edges_tensor generation:  0.6160731315612793
mini_batch_src_global generation:  0.7281203269958496
r_  generation:  7.869351148605347
local_output_nid generation:  0.19414520263671875
local_in_edges_tensor generation:  0.5790586471557617
mini_batch_src_global generation:  0.7027602195739746
r_  generation:  7.680588006973267
local_output_nid generation:  0.1772937774658203
local_in_edges_tensor generation:  0.514244556427002
mini_batch_src_global generation:  0.7255876064300537
r_  generation:  7.770168304443359
local_output_nid generation:  0.1890394687652588
local_in_edges_tensor generation:  0.5072147846221924
mini_batch_src_global generation:  0.7164123058319092
r_  generation:  7.565936088562012
local_output_nid generation:  0.18262457847595215
local_in_edges_tensor generation:  0.520744800567627
mini_batch_src_global generation:  0.7669563293457031
r_  generation:  8.068142890930176
local_output_nid generation:  0.16966652870178223
local_in_edges_tensor generation:  0.5156240463256836
mini_batch_src_global generation:  0.7549259662628174
r_  generation:  7.549760818481445
local_output_nid generation:  0.18309760093688965
local_in_edges_tensor generation:  0.44909238815307617
mini_batch_src_global generation:  0.7404828071594238
r_  generation:  7.944464445114136
----------------------check_connections_block total spend ----------------------------- 83.96712255477905
generate_one_block  10.189197540283203
generate_one_block  10.63625192642212
generate_one_block  10.365193843841553
generate_one_block  10.153258562088013
generate_one_block  9.7590651512146
generate_one_block  10.241453170776367
generate_one_block  9.615905284881592
generate_one_block  10.464651584625244
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2873241901397705
gen group dst list time:  0.5336086750030518
time for parepare:  0.45970606803894043
local_output_nid generation:  0.5584735870361328
local_in_edges_tensor generation:  1.2731318473815918
mini_batch_src_global generation:  1.2176735401153564
r_  generation:  15.879738330841064
local_output_nid generation:  0.6033086776733398
local_in_edges_tensor generation:  1.2388832569122314
mini_batch_src_global generation:  1.5048882961273193
r_  generation:  16.168800115585327
local_output_nid generation:  0.6164119243621826
local_in_edges_tensor generation:  1.2306513786315918
mini_batch_src_global generation:  1.4857888221740723
r_  generation:  15.919373750686646
local_output_nid generation:  0.5731337070465088
local_in_edges_tensor generation:  1.2683382034301758
mini_batch_src_global generation:  1.5571420192718506
r_  generation:  15.839093446731567
local_output_nid generation:  0.5924785137176514
local_in_edges_tensor generation:  1.177320957183838
mini_batch_src_global generation:  1.5648906230926514
r_  generation:  16.138343811035156
local_output_nid generation:  0.6068084239959717
local_in_edges_tensor generation:  1.220893383026123
mini_batch_src_global generation:  1.4663996696472168
r_  generation:  16.5385422706604
local_output_nid generation:  0.5917336940765381
local_in_edges_tensor generation:  1.152339220046997
mini_batch_src_global generation:  1.4683363437652588
r_  generation:  16.065408945083618
local_output_nid generation:  0.581383228302002
local_in_edges_tensor generation:  1.2251670360565186
mini_batch_src_global generation:  1.6455638408660889
r_  generation:  16.223180770874023
----------------------check_connections_block total spend ----------------------------- 178.839421749115
generate_one_block  21.277512550354004
generate_one_block  21.01793599128723
generate_one_block  21.419068098068237
generate_one_block  21.417102813720703
generate_one_block  21.282999515533447
generate_one_block  21.453412771224976
generate_one_block  22.194052696228027
generate_one_block  21.08866000175476
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8499488830566406  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

connection checking time:  268.4052493572235
block generation total time  258.3515453338623
average batch blocks generation time:  10.764647722244263
block dataloader generation time/epoch 550.8456189235052
pseudo mini batch 0 input nodes size: 2179881
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8223214149475098  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8223214149475098  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6343908309936523  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6345696449279785  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8197164535522461  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.222757339477539  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.222757339477539  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2179881
first layer output nodes number: 1747520
edges number: 36152713
torch.Size([2179881, 100])
torch.Size([1747520, 256])
input nodes number: 1747520
output nodes number: 534666
edges number: 17036350
torch.Size([1747520, 256])
torch.Size([534666, 256])
torch.Size([23972, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.768770217895508  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.773164749145508  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8240876197814941  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 1 input nodes size: 2185951
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.819521427154541  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.819521427154541  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6341872215270996  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6343755722045898  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8221273422241211  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2341289520263672  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2341289520263672  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2185951
first layer output nodes number: 1767306
edges number: 36464865
torch.Size([2185951, 100])
torch.Size([1767306, 256])
input nodes number: 1767306
output nodes number: 554016
edges number: 17644630
torch.Size([1767306, 256])
torch.Size([554016, 256])
torch.Size([25250, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.90001106262207  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.904432773590088  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8493413925170898  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 2 input nodes size: 2187184
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8223509788513184  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8223509788513184  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6371407508850098  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6373291015625  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8224749565124512  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2341876029968262  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2341876029968262  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2187184
first layer output nodes number: 1769090
edges number: 36509936
torch.Size([2187184, 100])
torch.Size([1769090, 256])
input nodes number: 1769090
output nodes number: 552404
edges number: 17604882
torch.Size([1769090, 256])
torch.Size([552404, 256])
torch.Size([25248, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.900852203369141  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.9052734375  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8498878479003906  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 3 input nodes size: 2184357
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.822474479675293  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.822474479675293  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6371402740478516  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6373190879821777  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8223409652709961  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2279138565063477  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2279138565063477  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2184357
first layer output nodes number: 1755453
edges number: 36332310
torch.Size([2184357, 100])
torch.Size([1755453, 256])
input nodes number: 1755453
output nodes number: 535868
edges number: 17092088
torch.Size([1755453, 256])
torch.Size([535868, 256])
torch.Size([23951, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.799317836761475  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.803512096405029  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8311853408813477  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 4 input nodes size: 2183308
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8221139907836914  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8221139907836914  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6354598999023438  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.63563871383667  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8207941055297852  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2261667251586914  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2261667251586914  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2183308
first layer output nodes number: 1753152
edges number: 36283966
torch.Size([2183308, 100])
torch.Size([1753152, 256])
input nodes number: 1753152
output nodes number: 536727
edges number: 17132973
torch.Size([1753152, 256])
torch.Size([536727, 256])
torch.Size([23957, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.7956719398498535  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.800282955169678  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8310179710388184  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

pseudo mini batch 5 input nodes size: 2190225
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8207950592041016  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8207950592041016  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6367177963256836  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6369061470031738  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8233814239501953  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2357721328735352  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2357721328735352  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

first layer input nodes number: 2190225
first layer output nodes number: 1771132
edges number: 36539081
torch.Size([2190225, 100])
torch.Size([1771132, 256])
input nodes number: 1771132
output nodes number: 555611
edges number: 17694549
torch.Size([1771132, 256])
torch.Size([555611, 256])
torch.Size([25246, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.918335914611816  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.922757148742676  GigaBytes
Max Memory Allocated: 9.690299034118652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8522849082946777  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

pseudo mini batch 6 input nodes size: 2182191
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8236074447631836  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8236074447631836  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6365370750427246  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6367149353027344  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8206038475036621  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2257652282714844  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2257652282714844  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

first layer input nodes number: 2182191
first layer output nodes number: 1754948
edges number: 36291564
torch.Size([2182191, 100])
torch.Size([1754948, 256])
input nodes number: 1754948
output nodes number: 535327
edges number: 17071456
torch.Size([1754948, 256])
torch.Size([535327, 256])
torch.Size([23854, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.7945098876953125  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.798686981201172  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8300628662109375  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

pseudo mini batch 7 input nodes size: 2184696
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8203597068786621  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8203597068786621  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6342225074768066  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.6344099044799805  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 0.8213024139404297  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2309560775756836  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.2309560775756836  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

first layer input nodes number: 2184696
first layer output nodes number: 1763845
edges number: 36418274
torch.Size([2184696, 100])
torch.Size([1763845, 256])
input nodes number: 1763845
output nodes number: 552497
edges number: 17616178
torch.Size([1763845, 256])
torch.Size([552497, 256])
torch.Size([25093, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.882349967956543  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 7.886744022369385  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8445024490356445  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8445024490356445  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.5897216796875 GB
    Memory Allocated: 1.8445024490356445  GigaBytes
Max Memory Allocated: 9.692166805267334  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4191872477531433 |0.4856036305427551 |0.11551007628440857 |0.00014904141426086426 |0.023171603679656982 |0.002791166305541992 |
----------------------------------------------------------pseudo_mini_loss sum 2.2356276512145996
Total (block generation + training)time/epoch 559.4623592694601
Training time/epoch 8.621044874191284
Training time without block to device /epoch 4.736215829849243
Training time without total dataloading part /epoch 1.1134369373321533
load block tensor time/epoch 3.3534979820251465
block to device time/epoch 3.884829044342041
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  35917355
Number of first layer input nodes during this epoch:  17477793
Number of first layer output nodes during this epoch:  14082446
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
