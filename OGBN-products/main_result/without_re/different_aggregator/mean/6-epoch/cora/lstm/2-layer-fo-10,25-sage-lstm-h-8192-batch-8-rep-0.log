main start at this time 1656400950.7459219
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001239776611328125
global_2_local spend time (sec) 0.00011348724365234375
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0005042552947998047
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 488, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 8: 3, 10: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.0005419254302978516
auxiliary_graph
Graph(num_nodes=628, num_edges=436,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0007698535919189453
remove nodes length  488

auxiliary_graph.remove_nodes spent  0.0018639564514160156
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=436,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0009214878082275391

the counter of shared neighbor distribution
Counter({1.0: 250, 2.0: 30, 3.0: 14, 4.0: 2})
296
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.003123044967651367
18
18
18
18
18
17
16
17
total k batches seeds list generation spend  0.012886524200439453
after graph partition
graph partition algorithm spend time 0.10517764091491699
18
18
18
18
18
17
16
17
partition_len_list
[83, 98, 101, 72, 93, 81, 57, 63]
REG selection method  spend 0.10546755790710449
time for parepare:  5.53131103515625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00012135505676269531
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.86102294921875e-05
----------------------check_connections_block total spend ----------------------------- 0.0017707347869873047
generate_one_block  0.0023789405822753906
generate_one_block  0.0010690689086914062
generate_one_block  0.0010464191436767578
generate_one_block  0.0010242462158203125
generate_one_block  0.0010404586791992188
generate_one_block  0.0010676383972167969
generate_one_block  0.0010249614715576172
generate_one_block  0.0010180473327636719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005331039428710938
gen group dst list time:  7.033348083496094e-05
time for parepare:  0.00013828277587890625
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00017833709716796875
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00018405914306640625
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00018334388732910156
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001723766326904297
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00015735626220703125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00010037422180175781
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010991096496582031
----------------------check_connections_block total spend ----------------------------- 0.0031828880310058594
generate_one_block  0.0012209415435791016
generate_one_block  0.0012023448944091797
generate_one_block  0.0012230873107910156
generate_one_block  0.0011222362518310547
generate_one_block  0.0012402534484863281
generate_one_block  0.0011894702911376953
generate_one_block  0.0010983943939208984
generate_one_block  0.0011153221130371094
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

connection checking time:  0.004953622817993164
block generation total time  0.019081830978393555
average batch blocks generation time:  0.0011926144361495972
block dataloader generation time/epoch 0.1368873119354248
pseudo mini batch 0 input nodes size: 290
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 2.152225971221924  GigaBytes
Max Memory Allocated: 2.152225971221924  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 2.152226448059082  GigaBytes
Max Memory Allocated: 2.152226448059082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 2.152226448059082  GigaBytes
Max Memory Allocated: 2.152226448059082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2537841796875 GB
    Memory Allocated: 2.152231216430664  GigaBytes
Max Memory Allocated: 2.152231216430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2537841796875 GB
    Memory Allocated: 2.152231216430664  GigaBytes
Max Memory Allocated: 2.152231216430664  GigaBytes

first layer input nodes number: 290
first layer output nodes number: 83
edges number: 466
torch.Size([290, 1433])
torch.Size([83, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 2.2377519607543945  GigaBytes
Max Memory Allocated: 2.241424083709717  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 2.237753391265869  GigaBytes
Max Memory Allocated: 2.241424083709717  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.4373779296875 GB
    Memory Allocated: 4.301620006561279  GigaBytes
Max Memory Allocated: 6.2352190017700195  GigaBytes

pseudo mini batch 1 input nodes size: 272
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.4373779296875 GB
    Memory Allocated: 4.301604747772217  GigaBytes
Max Memory Allocated: 6.2352190017700195  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.4373779296875 GB
    Memory Allocated: 4.301604747772217  GigaBytes
Max Memory Allocated: 6.2352190017700195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4373779296875 GB
    Memory Allocated: 4.3030571937561035  GigaBytes
Max Memory Allocated: 6.2352190017700195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4373779296875 GB
    Memory Allocated: 4.303057670593262  GigaBytes
Max Memory Allocated: 6.2352190017700195  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.4373779296875 GB
    Memory Allocated: 4.301508903503418  GigaBytes
Max Memory Allocated: 6.2352190017700195  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.4373779296875 GB
    Memory Allocated: 4.301513671875  GigaBytes
Max Memory Allocated: 6.2352190017700195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4373779296875 GB
    Memory Allocated: 4.301513671875  GigaBytes
Max Memory Allocated: 6.2352190017700195  GigaBytes

first layer input nodes number: 272
first layer output nodes number: 98
edges number: 474
torch.Size([272, 1433])
torch.Size([98, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4412841796875 GB
    Memory Allocated: 4.391324996948242  GigaBytes
Max Memory Allocated: 6.2352190017700195  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.4412841796875 GB
    Memory Allocated: 4.391325950622559  GigaBytes
Max Memory Allocated: 6.2352190017700195  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.3015241622924805  GigaBytes
Max Memory Allocated: 8.387906551361084  GigaBytes

pseudo mini batch 2 input nodes size: 285
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301508903503418  GigaBytes
Max Memory Allocated: 8.387906551361084  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301508903503418  GigaBytes
Max Memory Allocated: 8.387906551361084  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.3030571937561035  GigaBytes
Max Memory Allocated: 8.387906551361084  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.303057670593262  GigaBytes
Max Memory Allocated: 8.387906551361084  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301604747772217  GigaBytes
Max Memory Allocated: 8.387906551361084  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301609516143799  GigaBytes
Max Memory Allocated: 8.387906551361084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301609516143799  GigaBytes
Max Memory Allocated: 8.387906551361084  GigaBytes

first layer input nodes number: 285
first layer output nodes number: 101
edges number: 481
torch.Size([285, 1433])
torch.Size([101, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4451904296875 GB
    Memory Allocated: 4.396358013153076  GigaBytes
Max Memory Allocated: 8.387906551361084  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4451904296875 GB
    Memory Allocated: 4.396358966827393  GigaBytes
Max Memory Allocated: 8.387906551361084  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.301620006561279  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

pseudo mini batch 3 input nodes size: 164
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.301604747772217  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.301604747772217  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.302480697631836  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.302481174468994  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.30093240737915  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.300936222076416  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.300936222076416  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

first layer input nodes number: 164
first layer output nodes number: 72
edges number: 279
torch.Size([164, 1433])
torch.Size([72, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.357221603393555  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.357222557067871  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.300944805145264  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

pseudo mini batch 4 input nodes size: 216
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.30093240737915  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.30093240737915  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.302122592926025  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.302123069763184  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.301246643066406  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.301251411437988  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.301251411437988  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

first layer input nodes number: 216
first layer output nodes number: 93
edges number: 457
torch.Size([216, 1433])
torch.Size([93, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.397486686706543  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4471435546875 GB
    Memory Allocated: 4.397487640380859  GigaBytes
Max Memory Allocated: 8.392848014831543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.3012614250183105  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

pseudo mini batch 5 input nodes size: 252
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.301246643066406  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.301246643066406  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.3025922775268555  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.302592754364014  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.3014020919799805  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.3014068603515625  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.3014068603515625  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

first layer input nodes number: 252
first layer output nodes number: 81
edges number: 395
torch.Size([252, 1433])
torch.Size([81, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.37634801864624  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.376348972320557  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.301416873931885  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

pseudo mini batch 6 input nodes size: 114
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.3014020919799805  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.3014020919799805  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.302011013031006  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.302011489868164  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.300665378570557  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.300668239593506  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.300668239593506  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

first layer input nodes number: 114
first layer output nodes number: 57
edges number: 227
torch.Size([114, 1433])
torch.Size([57, 8192])
torch.Size([16, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.353938102722168  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.353939056396484  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.300674915313721  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

pseudo mini batch 7 input nodes size: 152
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.300665378570557  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.300665378570557  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.301476955413818  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.301477432250977  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.300868034362793  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.300871849060059  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.300871849060059  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

first layer input nodes number: 152
first layer output nodes number: 63
edges number: 264
torch.Size([152, 1433])
torch.Size([63, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.35363245010376  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.353633403778076  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4490966796875 GB
    Memory Allocated: 4.300879955291748  GigaBytes
Max Memory Allocated: 8.39422082901001  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.599633693695068  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.599633693695068  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5770975649356842 |0.04396688938140869 |0.19704300165176392 |0.0001519620418548584 |0.293999046087265 |0.012511730194091797 |
----------------------------------------------------------pseudo_mini_loss sum 1.948232650756836
Total (block generation + training)time/epoch 9.55862021446228
Training time/epoch 9.421472787857056
Training time without block to device /epoch 9.069737672805786
Training time without total dataloading part /epoch 3.942063808441162
load block tensor time/epoch 4.616780519485474
block to device time/epoch 0.35173511505126953
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2393
Number of first layer input nodes during this epoch:  1745
Number of first layer output nodes during this epoch:  648
----------------------------------------before generate dataloader block 
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.59963321685791  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009443759918212891
global_2_local spend time (sec) 0.0001327991485595703
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.000331878662109375
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 493, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 8: 3, 10: 3, 25: 2, 12: 2, 11: 1, 21: 1, 19: 1})

A = g.adjacency_matrix() spent  0.0001666545867919922
auxiliary_graph
Graph(num_nodes=633, num_edges=430,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.00044035911560058594
remove nodes length  493

auxiliary_graph.remove_nodes spent  0.0014638900756835938
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=430,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006921291351318359

the counter of shared neighbor distribution
Counter({1.0: 244, 2.0: 30, 3.0: 14, 4.0: 2})
290
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0027184486389160156
18
18
18
17
17
18
17
17
total k batches seeds list generation spend  0.00783395767211914
after graph partition
graph partition algorithm spend time 0.0489041805267334
18
18
18
17
17
18
17
17
partition_len_list
[84, 87, 53, 73, 107, 97, 92, 59]
REG selection method  spend 0.04922127723693848
time for parepare:  6.198883056640625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.0279159545898438e-05
----------------------check_connections_block total spend ----------------------------- 0.0019249916076660156
generate_one_block  0.0025305747985839844
generate_one_block  0.0012085437774658203
generate_one_block  0.0010707378387451172
generate_one_block  0.001065969467163086
generate_one_block  0.0010895729064941406
generate_one_block  0.0010790824890136719
generate_one_block  0.001062154769897461
generate_one_block  0.0010428428649902344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007193088531494141
gen group dst list time:  6.437301635742188e-05
time for parepare:  0.00017714500427246094
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00018906593322753906
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0001823902130126953
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00014901161193847656
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002148151397705078
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00019073486328125
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00017333030700683594
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00011277198791503906
----------------------check_connections_block total spend ----------------------------- 0.003592252731323242
generate_one_block  0.0017442703247070312
generate_one_block  0.0012269020080566406
generate_one_block  0.0011279582977294922
generate_one_block  0.0011897087097167969
generate_one_block  0.0012879371643066406
generate_one_block  0.00125885009765625
generate_one_block  0.0012125968933105469
generate_one_block  0.0011386871337890625
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.59963321685791  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

connection checking time:  0.005517244338989258
block generation total time  0.020336389541625977
average batch blocks generation time:  0.0012710243463516235
block dataloader generation time/epoch 0.11142289638519287
pseudo mini batch 0 input nodes size: 279
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.599620819091797  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.599620819091797  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.601110458374023  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.601110935211182  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.600298881530762  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.600303649902344  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.600303649902344  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

first layer input nodes number: 279
first layer output nodes number: 84
edges number: 471
torch.Size([279, 1433])
torch.Size([84, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.68814992904663  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4490966796875 GB
    Memory Allocated: 8.688151359558105  GigaBytes
Max Memory Allocated: 11.599633693695068  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.60031509399414  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

pseudo mini batch 1 input nodes size: 241
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600299835205078  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600299835205078  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.601586818695068  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.601587295532227  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600097179412842  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600101947784424  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600101947784424  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

first layer input nodes number: 241
first layer output nodes number: 87
edges number: 400
torch.Size([241, 1433])
torch.Size([87, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.680690288543701  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.680691242218018  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600111961364746  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

pseudo mini batch 2 input nodes size: 123
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600097179412842  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600097179412842  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600754261016846  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600754737854004  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.599467277526855  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.599470138549805  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.599470138549805  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

first layer input nodes number: 123
first layer output nodes number: 53
edges number: 187
torch.Size([123, 1433])
torch.Size([53, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.64527702331543  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.645277976989746  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.59947681427002  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

pseudo mini batch 3 input nodes size: 218
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.599467277526855  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.599467277526855  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.60065746307373  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600657939910889  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

first layer input nodes number: 218
first layer output nodes number: 73
edges number: 344
torch.Size([218, 1433])
torch.Size([73, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.662366390228271  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.662367343902588  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

pseudo mini batch 4 input nodes size: 308
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.60164499282837  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.601645469665527  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600454807281494  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600460529327393  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4490966796875 GB
    Memory Allocated: 8.600460529327393  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

first layer input nodes number: 308
first layer output nodes number: 107
edges number: 541
torch.Size([308, 1433])
torch.Size([107, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.705018043518066  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.705018997192383  GigaBytes
Max Memory Allocated: 12.68515920639038  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.60047197341919  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

pseudo mini batch 5 input nodes size: 235
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600454807281494  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600454807281494  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.601709365844727  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.601709842681885  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600064754486084  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600069522857666  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600069522857666  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

first layer input nodes number: 235
first layer output nodes number: 97
edges number: 485
torch.Size([235, 1433])
torch.Size([97, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.697072982788086  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.697073936462402  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600079536437988  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

pseudo mini batch 6 input nodes size: 210
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600064754486084  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600064754486084  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.601254940032959  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.601255416870117  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600005149841309  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600005149841309  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

first layer input nodes number: 210
first layer output nodes number: 92
edges number: 398
torch.Size([210, 1433])
torch.Size([92, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.679839611053467  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.679840564727783  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.60001516342163  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

pseudo mini batch 7 input nodes size: 137
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.60073184967041  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600732326507568  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.599541664123535  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.599544525146484  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.599544525146484  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

first layer input nodes number: 137
first layer output nodes number: 59
edges number: 223
torch.Size([137, 1433])
torch.Size([59, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.645921230316162  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.645922183990479  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.599551677703857  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.599551677703857  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.599551677703857  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5407448410987854 |0.0003923773765563965 |0.13744306564331055 |0.00013208389282226562 |0.3149006962776184 |0.00422215461730957 |
----------------------------------------------------------pseudo_mini_loss sum 45.558990478515625
Total (block generation + training)time/epoch 9.066609859466553
Training time/epoch 8.488426208496094
Training time without block to device /epoch 8.485287189483643
Training time without total dataloading part /epoch 3.6240289211273193
load block tensor time/epoch 4.325958728790283
block to device time/epoch 0.003139019012451172
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2403
Number of first layer input nodes during this epoch:  1751
Number of first layer output nodes during this epoch:  652
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.5995512008667  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007359981536865234
global_2_local spend time (sec) 0.0001285076141357422
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00030159950256347656
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 489, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 8: 3, 10: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.0001583099365234375
auxiliary_graph
Graph(num_nodes=629, num_edges=432,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.00043272972106933594
remove nodes length  489

auxiliary_graph.remove_nodes spent  0.00164031982421875
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=432,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0007021427154541016

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 12, 4.0: 2})
292
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0027267932891845703
18
18
18
17
18
17
17
17
total k batches seeds list generation spend  0.009225845336914062
after graph partition
graph partition algorithm spend time 0.054898738861083984
18
18
18
17
18
17
17
17
partition_len_list
[81, 75, 74, 83, 126, 56, 98, 56]
REG selection method  spend 0.05527949333190918
time for parepare:  0.0001251697540283203
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00022745132446289062
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.00010919570922851562
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  8.20159912109375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00011301040649414062
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0001049041748046875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  6.961822509765625e-05
----------------------check_connections_block total spend ----------------------------- 0.0036668777465820312
generate_one_block  0.010696172714233398
generate_one_block  0.0015285015106201172
generate_one_block  0.0014526844024658203
generate_one_block  0.0014362335205078125
generate_one_block  0.0014834403991699219
generate_one_block  0.0014243125915527344
generate_one_block  0.0013148784637451172
generate_one_block  0.0010383129119873047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.012432336807250977
gen group dst list time:  6.031990051269531e-05
time for parepare:  0.0001537799835205078
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00018215179443359375
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00015425682067871094
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001323223114013672
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001544952392578125
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00023937225341796875
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00010585784912109375
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00020360946655273438
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001049041748046875
----------------------check_connections_block total spend ----------------------------- 0.0034286975860595703
generate_one_block  0.0012965202331542969
generate_one_block  0.0015327930450439453
generate_one_block  0.0011720657348632812
generate_one_block  0.001207113265991211
generate_one_block  0.001329660415649414
generate_one_block  0.0011434555053710938
generate_one_block  0.0012805461883544922
generate_one_block  0.0011408329010009766
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.5995512008667  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

connection checking time:  0.0070955753326416016
block generation total time  0.030477523803710938
average batch blocks generation time:  0.0019048452377319336
block dataloader generation time/epoch 0.11240228017171223
pseudo mini batch 0 input nodes size: 289
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.599540710449219  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.599540710449219  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.601083755493164  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.601084232330322  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.60035228729248  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600357055664062  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600357055664062  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

first layer input nodes number: 289
first layer output nodes number: 81
edges number: 459
torch.Size([289, 1433])
torch.Size([81, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.68421745300293  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.684218883514404  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.60036849975586  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

pseudo mini batch 1 input nodes size: 193
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600353240966797  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600353240966797  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.601543426513672  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.60154390335083  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

first layer input nodes number: 193
first layer output nodes number: 75
edges number: 345
torch.Size([193, 1433])
torch.Size([75, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.670081615447998  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.670082569122314  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

pseudo mini batch 2 input nodes size: 171
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600913524627686  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600914001464844  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.59972333908081  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.599727153778076  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.599727153778076  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

first layer input nodes number: 171
first layer output nodes number: 74
edges number: 283
torch.Size([171, 1433])
torch.Size([74, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.658324241638184  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.6583251953125  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.599735736846924  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

pseudo mini batch 3 input nodes size: 210
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.59972333908081  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.59972333908081  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600913524627686  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600914001464844  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

first layer input nodes number: 210
first layer output nodes number: 83
edges number: 359
torch.Size([210, 1433])
torch.Size([83, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.670868396759033  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.67086935043335  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

pseudo mini batch 4 input nodes size: 334
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.601783752441406  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.601784229278564  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.600593566894531  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.60059928894043  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 8.60059928894043  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

first layer input nodes number: 334
first layer output nodes number: 126
edges number: 625
torch.Size([334, 1433])
torch.Size([126, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4725341796875 GB
    Memory Allocated: 8.72240924835205  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4725341796875 GB
    Memory Allocated: 8.722410202026367  GigaBytes
Max Memory Allocated: 12.701324939727783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600611209869385  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 5 input nodes size: 143
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600593566894531  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600593566894531  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601356983184814  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601357460021973  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599573612213135  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599576473236084  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599576473236084  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 143
first layer output nodes number: 56
edges number: 202
torch.Size([143, 1433])
torch.Size([56, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.64168643951416  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.641687393188477  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599583625793457  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 6 input nodes size: 274
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599573612213135  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599573612213135  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601036548614502  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60103702545166  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600273132324219  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600278854370117  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600278854370117  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 274
first layer output nodes number: 98
edges number: 534
torch.Size([274, 1433])
torch.Size([98, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.703915119171143  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.703916072845459  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600290298461914  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 7 input nodes size: 132
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600273132324219  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600273132324219  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600977897644043  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600978374481201  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599514961242676  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599517822265625  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599517822265625  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 132
first layer output nodes number: 56
edges number: 227
torch.Size([132, 1433])
torch.Size([56, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.65142822265625  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.651429176330566  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599524974822998  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599524974822998  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599524974822998  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5588672161102295 |0.000383228063583374 |0.1454615294933319 |0.00012814998626708984 |0.32037535309791565 |0.004120588302612305 |
----------------------------------------------------------pseudo_mini_loss sum 30.071483612060547
Total (block generation + training)time/epoch 8.989037036895752
Training time/epoch 8.719382047653198
Training time without block to device /epoch 8.716316223144531
Training time without total dataloading part /epoch 3.7318408489227295
load block tensor time/epoch 4.470937728881836
block to device time/epoch 0.003065824508666992
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2395
Number of first layer input nodes during this epoch:  1746
Number of first layer output nodes during this epoch:  649
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.59952449798584  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010704994201660156
global_2_local spend time (sec) 0.00014162063598632812
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0003974437713623047
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 489, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 8: 3, 10: 3, 25: 2, 12: 2, 21: 1, 11: 1, 19: 1})

A = g.adjacency_matrix() spent  0.0002033710479736328
auxiliary_graph
Graph(num_nodes=629, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0004658699035644531
remove nodes length  489

auxiliary_graph.remove_nodes spent  0.0010666847229003906
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0008912086486816406

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 14, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0030231475830078125
18
16
18
18
17
17
18
18
total k batches seeds list generation spend  0.00844883918762207
after graph partition
graph partition algorithm spend time 0.05098080635070801
18
16
18
18
17
17
18
18
partition_len_list
[79, 96, 76, 66, 90, 74, 90, 85]
REG selection method  spend 0.05136275291442871
time for parepare:  8.535385131835938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  5.269050598144531e-05
----------------------check_connections_block total spend ----------------------------- 0.002969026565551758
generate_one_block  0.0030715465545654297
generate_one_block  0.001458883285522461
generate_one_block  0.0013718605041503906
generate_one_block  0.0013437271118164062
generate_one_block  0.0013713836669921875
generate_one_block  0.0013713836669921875
generate_one_block  0.0013470649719238281
generate_one_block  0.0012302398681640625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007715225219726562
gen group dst list time:  6.508827209472656e-05
time for parepare:  0.00015735626220703125
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0001666545867919922
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00019741058349609375
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00011420249938964844
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001742839813232422
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00014901161193847656
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001709461212158203
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00015544891357421875
----------------------check_connections_block total spend ----------------------------- 0.0038001537322998047
generate_one_block  0.0013797283172607422
generate_one_block  0.001795053482055664
generate_one_block  0.0013518333435058594
generate_one_block  0.0012438297271728516
generate_one_block  0.0013518333435058594
generate_one_block  0.0013163089752197266
generate_one_block  0.0013148784637451172
generate_one_block  0.0013637542724609375
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.59952449798584  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

connection checking time:  0.0067691802978515625
block generation total time  0.02368330955505371
average batch blocks generation time:  0.001480206847190857
block dataloader generation time/epoch 0.10796374082565308
pseudo mini batch 0 input nodes size: 250
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.59951400756836  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.59951400756836  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60084867477417  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600849151611328  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600143909454346  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600148677825928  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600148677825928  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 250
first layer output nodes number: 79
edges number: 409
torch.Size([250, 1433])
torch.Size([79, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.67890739440918  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.678908824920654  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600159645080566  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 1 input nodes size: 255
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600144863128662  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600144863128662  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601506233215332  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60150671005249  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600171566009521  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600176334381104  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600176334381104  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 255
first layer output nodes number: 96
edges number: 479
torch.Size([255, 1433])
torch.Size([96, 8192])
torch.Size([16, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.690882682800293  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.69088363647461  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600186347961426  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 2 input nodes size: 215
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600171566009521  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600171566009521  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601361751556396  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601362228393555  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 215
first layer output nodes number: 76
edges number: 342
torch.Size([215, 1433])
torch.Size([76, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.665791988372803  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.66579294204712  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 3 input nodes size: 166
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600886821746826  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600887298583984  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599696636199951  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599700450897217  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599700450897217  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 166
first layer output nodes number: 66
edges number: 257
torch.Size([166, 1433])
torch.Size([66, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.651363372802734  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.65136432647705  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599709033966064  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 4 input nodes size: 216
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599696636199951  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599696636199951  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600886821746826  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600887298583984  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600005149841309  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600005149841309  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 216
first layer output nodes number: 90
edges number: 444
torch.Size([216, 1433])
torch.Size([90, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.693897247314453  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.69389820098877  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60001516342163  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 5 input nodes size: 203
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601190567016602  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60119104385376  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 203
first layer output nodes number: 74
edges number: 365
torch.Size([203, 1433])
torch.Size([74, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.673746585845947  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.673747539520264  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 6 input nodes size: 228
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60121774673462  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601218223571777  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600027561187744  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600032329559326  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600032329559326  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 228
first layer output nodes number: 90
edges number: 418
torch.Size([228, 1433])
torch.Size([90, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.679588317871094  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.67958927154541  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600042343139648  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 7 input nodes size: 221
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600027561187744  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600027561187744  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60121774673462  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601218223571777  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 221
first layer output nodes number: 85
edges number: 362
torch.Size([221, 1433])
torch.Size([85, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.672791004180908  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.672791957855225  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5702930688858032 |0.0004399716854095459 |0.139926016330719 |0.00013774633407592773 |0.3112223148345947 |0.14422273635864258 |
----------------------------------------------------------pseudo_mini_loss sum 41.4410514831543
Total (block generation + training)time/epoch 9.00742506980896
Training time/epoch 8.967732429504395
Training time without block to device /epoch 8.964212656021118
Training time without total dataloading part /epoch 3.7545113563537598
load block tensor time/epoch 4.562344551086426
block to device time/epoch 0.003519773483276367
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  2410
Number of first layer input nodes during this epoch:  1754
Number of first layer output nodes during this epoch:  656
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007567405700683594
global_2_local spend time (sec) 0.00013709068298339844
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0003142356872558594
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 490, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 10: 3, 8: 3, 25: 2, 12: 2, 21: 1, 11: 1, 19: 1})

A = g.adjacency_matrix() spent  0.00016736984252929688
auxiliary_graph
Graph(num_nodes=630, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0004398822784423828
remove nodes length  490

auxiliary_graph.remove_nodes spent  0.0010330677032470703
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0007131099700927734

the counter of shared neighbor distribution
Counter({1.0: 250, 2.0: 30, 3.0: 12, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.002801656723022461
18
17
18
17
16
18
18
18
total k batches seeds list generation spend  0.0074710845947265625
after graph partition
graph partition algorithm spend time 0.0414273738861084
18
17
18
17
16
18
18
18
partition_len_list
[103, 84, 89, 66, 68, 81, 100, 72]
REG selection method  spend 0.04187941551208496
time for parepare:  0.00012969970703125
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00025177001953125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  9.107589721679688e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  7.128715515136719e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00011038780212402344
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  7.867813110351562e-05
----------------------check_connections_block total spend ----------------------------- 0.004023075103759766
generate_one_block  0.009364604949951172
generate_one_block  0.0017631053924560547
generate_one_block  0.0015468597412109375
generate_one_block  0.0012929439544677734
generate_one_block  0.0010669231414794922
generate_one_block  0.0010409355163574219
generate_one_block  0.0015735626220703125
generate_one_block  0.0016503334045410156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.005113124847412109
gen group dst list time:  8.320808410644531e-05
time for parepare:  0.00017595291137695312
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00023245811462402344
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0001647472381591797
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00017189979553222656
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00011801719665527344
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0001285076141357422
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001499652862548828
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0001976490020751953
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00013971328735351562
----------------------check_connections_block total spend ----------------------------- 0.003511190414428711
generate_one_block  0.0014467239379882812
generate_one_block  0.001638650894165039
generate_one_block  0.0012774467468261719
generate_one_block  0.00116729736328125
generate_one_block  0.0011725425720214844
generate_one_block  0.001219034194946289
generate_one_block  0.0012731552124023438
generate_one_block  0.001199960708618164
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

connection checking time:  0.0075342655181884766
block generation total time  0.029694080352783203
average batch blocks generation time:  0.0018558800220489502
block dataloader generation time/epoch 0.10509271621704101
pseudo mini batch 0 input nodes size: 328
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.59999942779541  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.59999942779541  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60175085067749  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601751327514648  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600560665130615  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600566387176514  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600566387176514  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 328
first layer output nodes number: 103
edges number: 599
torch.Size([328, 1433])
torch.Size([103, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.70960521697998  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.709606647491455  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600579261779785  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 1 input nodes size: 240
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600561618804932  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600561618804932  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601842880249023  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601843357086182  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600091457366943  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600095272064209  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600095272064209  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 240
first layer output nodes number: 84
edges number: 367
torch.Size([240, 1433])
torch.Size([84, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.67536735534668  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.675368309020996  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600104331970215  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 2 input nodes size: 277
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600091457366943  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600091457366943  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601842880249023  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601843357086182  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600561618804932  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600566387176514  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600566387176514  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 277
first layer output nodes number: 89
edges number: 426
torch.Size([277, 1433])
torch.Size([89, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.682941913604736  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.682942867279053  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600576877593994  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 3 input nodes size: 157
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600561618804932  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600561618804932  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601399898529053  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601400375366211  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599648475646973  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599651336669922  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599651336669922  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 157
first layer output nodes number: 66
edges number: 255
torch.Size([157, 1433])
torch.Size([66, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.651946067810059  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.651947021484375  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599658966064453  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 4 input nodes size: 172
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599648475646973  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599648475646973  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600566864013672  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60056734085083  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.59972858428955  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599732398986816  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599732398986816  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 172
first layer output nodes number: 68
edges number: 274
torch.Size([172, 1433])
torch.Size([68, 8192])
torch.Size([16, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.654082298278809  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.654083251953125  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599740982055664  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 5 input nodes size: 222
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.59972858428955  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.59972858428955  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600918769836426  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600919246673584  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 222
first layer output nodes number: 81
edges number: 347
torch.Size([222, 1433])
torch.Size([81, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.667120933532715  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.667121887207031  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 6 input nodes size: 225
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60120153427124  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601202011108398  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600011348724365  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600016117095947  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600016117095947  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 225
first layer output nodes number: 100
edges number: 506
torch.Size([225, 1433])
torch.Size([100, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.703546047210693  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.70354700088501  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60002613067627  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 7 input nodes size: 183
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600011348724365  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600011348724365  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60120153427124  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601202011108398  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 183
first layer output nodes number: 72
edges number: 333
torch.Size([183, 1433])
torch.Size([72, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.666083335876465  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.666084289550781  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5884283483028412 |0.0004400312900543213 |0.1281282901763916 |0.0001322627067565918 |0.24930205941200256 |0.00416874885559082 |
----------------------------------------------------------pseudo_mini_loss sum 64.88909912109375
Total (block generation + training)time/epoch 8.900555992126465
Training time/epoch 8.379281520843506
Training time without block to device /epoch 8.375761270523071
Training time without total dataloading part /epoch 3.024669647216797
load block tensor time/epoch 4.7074267864227295
block to device time/epoch 0.0035202503204345703
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  2467
Number of first layer input nodes during this epoch:  1804
Number of first layer output nodes during this epoch:  663
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600012302398682  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007963180541992188
global_2_local spend time (sec) 0.00016498565673828125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00036215782165527344
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 491, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 10: 3, 8: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.0001888275146484375
auxiliary_graph
Graph(num_nodes=631, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0005373954772949219
remove nodes length  491

auxiliary_graph.remove_nodes spent  0.0010676383972167969
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0008037090301513672

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 14, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0029146671295166016
18
16
18
18
17
17
18
18
total k batches seeds list generation spend  0.008152961730957031
after graph partition
graph partition algorithm spend time 0.040126800537109375
18
16
18
18
17
17
18
18
partition_len_list
[83, 50, 93, 71, 86, 93, 94, 86]
REG selection method  spend 0.04058670997619629
time for parepare:  0.00012540817260742188
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.00010848045349121094
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  9.107589721679688e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00021600723266601562
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.125999450683594e-05
----------------------check_connections_block total spend ----------------------------- 0.0034596920013427734
generate_one_block  0.003510713577270508
generate_one_block  0.0015377998352050781
generate_one_block  0.0015616416931152344
generate_one_block  0.001505136489868164
generate_one_block  0.0012712478637695312
generate_one_block  0.0010876655578613281
generate_one_block  0.001096963882446289
generate_one_block  0.0010976791381835938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008149147033691406
gen group dst list time:  5.9604644775390625e-05
time for parepare:  0.00013446807861328125
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00016736984252929688
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  9.655952453613281e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00017571449279785156
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00013756752014160156
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00018405914306640625
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00018930435180664062
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001971721649169922
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00016379356384277344
----------------------check_connections_block total spend ----------------------------- 0.0035104751586914062
generate_one_block  0.0012717247009277344
generate_one_block  0.0014786720275878906
generate_one_block  0.0013079643249511719
generate_one_block  0.0011737346649169922
generate_one_block  0.001219034194946289
generate_one_block  0.001270294189453125
generate_one_block  0.0012295246124267578
generate_one_block  0.0012061595916748047
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600012302398682  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

connection checking time:  0.00697016716003418
block generation total time  0.022825956344604492
average batch blocks generation time:  0.0014266222715377808
block dataloader generation time/epoch 0.10104457537333171
pseudo mini batch 0 input nodes size: 219
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.59999942779541  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.59999942779541  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601189613342285  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601190090179443  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.59999942779541  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600003242492676  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600003242492676  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 219
first layer output nodes number: 83
edges number: 364
torch.Size([219, 1433])
torch.Size([83, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.675529956817627  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.675531387329102  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 1 input nodes size: 129
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60068941116333  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600689888000488  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599499225616455  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599502086639404  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599502086639404  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 129
first layer output nodes number: 50
edges number: 200
torch.Size([129, 1433])
torch.Size([50, 8192])
torch.Size([16, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.645392894744873  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.64539384841919  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599509239196777  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 2 input nodes size: 272
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599499225616455  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.599499225616455  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600951671600342  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.6009521484375  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600262641906738  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60026741027832  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60026741027832  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 272
first layer output nodes number: 93
edges number: 423
torch.Size([272, 1433])
torch.Size([93, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.682785034179688  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.682785987854004  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.6002779006958  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 3 input nodes size: 190
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600262641906738  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600262641906738  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601452827453613  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601453304290771  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 190
first layer output nodes number: 71
edges number: 300
torch.Size([190, 1433])
torch.Size([71, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.658318519592285  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.658319473266602  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 4 input nodes size: 258
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601377964019775  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601378440856934  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.6001877784729  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600192546844482  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600192546844482  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 258
first layer output nodes number: 86
edges number: 448
torch.Size([258, 1433])
torch.Size([86, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.684885025024414  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.68488597869873  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600203037261963  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 5 input nodes size: 261
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.6001877784729  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.6001877784729  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60158109664917  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601581573486328  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600203514099121  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600208282470703  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600208282470703  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 261
first layer output nodes number: 93
edges number: 477
torch.Size([261, 1433])
torch.Size([93, 8192])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.689234733581543  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.68923568725586  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600218772888184  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 6 input nodes size: 223
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600203514099121  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600203514099121  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60158109664917  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601581573486328  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.6001877784729  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600192546844482  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600192546844482  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 223
first layer output nodes number: 94
edges number: 477
torch.Size([223, 1433])
torch.Size([94, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.697195529937744  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.69719648361206  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600202560424805  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

pseudo mini batch 7 input nodes size: 239
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.6001877784729  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.6001877784729  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.601463794708252  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.60146427154541  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600086212158203  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600090980529785  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600090980529785  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

first layer input nodes number: 239
first layer output nodes number: 86
edges number: 399
torch.Size([239, 1433])
torch.Size([86, 8192])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.675021171569824  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.67502212524414  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600100994110107  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600100994110107  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 8.600100994110107  GigaBytes
Max Memory Allocated: 12.718136310577393  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5574669241905212 |0.000406801700592041 |0.1356479525566101 |0.000129014253616333 |0.3052590787410736 |0.1384294033050537 |
----------------------------------------------------------pseudo_mini_loss sum 51.26948165893555
Total (block generation + training)time/epoch 8.885317087173462
Training time/epoch 8.728167533874512
Training time without block to device /epoch 8.724913120269775
Training time without total dataloading part /epoch 3.666717767715454
load block tensor time/epoch 4.45973539352417
block to device time/epoch 0.003254413604736328
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  2447
Number of first layer input nodes during this epoch:  1791
Number of first layer output nodes during this epoch:  656
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=8192, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=8192, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(8192, 8192, batch_first=True)
      (fc_self): Linear(in_features=8192, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=8192, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  576968784
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([8192, 1433])
layers.0.fc_neigh.weight, torch.Size([8192, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([32768, 8192])
layers.1.lstm.weight_hh_l0, torch.Size([32768, 8192])
layers.1.lstm.bias_ih_l0, torch.Size([32768])
layers.1.lstm.bias_hh_l0, torch.Size([32768])
layers.1.fc_self.weight, torch.Size([7, 8192])
layers.1.fc_neigh.weight, torch.Size([7, 8192])
----------------------------------------
un-trainable parameters
