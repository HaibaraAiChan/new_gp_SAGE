main start at this time 1656401089.6542776
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0015053749084472656
global_2_local spend time (sec) 0.00020933151245117188
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0006649494171142578
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 488, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 8: 3, 10: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.0005846023559570312
auxiliary_graph
Graph(num_nodes=628, num_edges=436,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0007870197296142578
remove nodes length  488

auxiliary_graph.remove_nodes spent  0.0020630359649658203
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=436,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.00093841552734375

the counter of shared neighbor distribution
Counter({1.0: 250, 2.0: 30, 3.0: 14, 4.0: 2})
296
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.004991292953491211
9
9
9
9
8
8
9
9
9
8
9
9
8
9
9
9
total k batches seeds list generation spend  0.0163118839263916
after graph partition
graph partition algorithm spend time 0.0414426326751709
9
9
9
9
8
8
9
9
9
8
9
9
8
9
9
9
partition_len_list
[44, 54, 70, 41, 37, 32, 38, 39, 60, 35, 34, 32, 38, 41, 39, 29]
REG selection method  spend 0.041962385177612305
time for parepare:  5.53131103515625e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  1.430511474609375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0265579223632812e-05
----------------------check_connections_block total spend ----------------------------- 0.0029494762420654297
generate_one_block  0.0024864673614501953
generate_one_block  0.0010628700256347656
generate_one_block  0.0010356903076171875
generate_one_block  0.0010454654693603516
generate_one_block  0.001008749008178711
generate_one_block  0.0010082721710205078
generate_one_block  0.0009980201721191406
generate_one_block  0.0009989738464355469
generate_one_block  0.0010519027709960938
generate_one_block  0.0010290145874023438
generate_one_block  0.0009639263153076172
generate_one_block  0.0010006427764892578
generate_one_block  0.0009648799896240234
generate_one_block  0.0009672641754150391
generate_one_block  0.0009632110595703125
generate_one_block  0.0009572505950927734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006184577941894531
gen group dst list time:  0.000125885009765625
time for parepare:  0.00014853477478027344
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  9.989738464355469e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00011754035949707031
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  8.869171142578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  9.036064147949219e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.341934204101562e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012803077697753906
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  7.867813110351562e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.890296936035156e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.222724914550781e-05
----------------------check_connections_block total spend ----------------------------- 0.004835844039916992
generate_one_block  0.0011487007141113281
generate_one_block  0.001184225082397461
generate_one_block  0.001165628433227539
generate_one_block  0.001104593276977539
generate_one_block  0.0010750293731689453
generate_one_block  0.0010852813720703125
generate_one_block  0.0010530948638916016
generate_one_block  0.001062154769897461
generate_one_block  0.0011453628540039062
generate_one_block  0.0011026859283447266
generate_one_block  0.0010464191436767578
generate_one_block  0.0010769367218017578
generate_one_block  0.0010571479797363281
generate_one_block  0.0010731220245361328
generate_one_block  0.0019390583038330078
generate_one_block  0.0010492801666259766
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

connection checking time:  0.007785320281982422
block generation total time  0.03591132164001465
average batch blocks generation time:  0.0011222288012504578
block dataloader generation time/epoch 0.09579968452453613
pseudo mini batch 0 input nodes size: 157
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1515159606933594  GigaBytes
Max Memory Allocated: 2.1515159606933594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1515164375305176  GigaBytes
Max Memory Allocated: 2.1515164375305176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1515164375305176  GigaBytes
Max Memory Allocated: 2.1515164375305176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2342529296875 GB
    Memory Allocated: 2.151519298553467  GigaBytes
Max Memory Allocated: 2.151519298553467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2342529296875 GB
    Memory Allocated: 2.151519298553467  GigaBytes
Max Memory Allocated: 2.151519298553467  GigaBytes

first layer input nodes number: 157
first layer output nodes number: 44
edges number: 249
torch.Size([157, 1433])
torch.Size([44, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4002685546875 GB
    Memory Allocated: 2.196735382080078  GigaBytes
Max Memory Allocated: 2.1986355781555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4002685546875 GB
    Memory Allocated: 2.1967368125915527  GigaBytes
Max Memory Allocated: 2.1986355781555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.4002685546875 GB
    Memory Allocated: 4.300904750823975  GigaBytes
Max Memory Allocated: 6.195392608642578  GigaBytes

pseudo mini batch 1 input nodes size: 177
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.4002685546875 GB
    Memory Allocated: 4.300894737243652  GigaBytes
Max Memory Allocated: 6.195392608642578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.4002685546875 GB
    Memory Allocated: 4.300894737243652  GigaBytes
Max Memory Allocated: 6.195392608642578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4002685546875 GB
    Memory Allocated: 4.301839828491211  GigaBytes
Max Memory Allocated: 6.195392608642578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4002685546875 GB
    Memory Allocated: 4.301840305328369  GigaBytes
Max Memory Allocated: 6.195392608642578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.4002685546875 GB
    Memory Allocated: 4.30100154876709  GigaBytes
Max Memory Allocated: 6.195392608642578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.4002685546875 GB
    Memory Allocated: 4.3010053634643555  GigaBytes
Max Memory Allocated: 6.195392608642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4002685546875 GB
    Memory Allocated: 4.3010053634643555  GigaBytes
Max Memory Allocated: 6.195392608642578  GigaBytes

first layer input nodes number: 177
first layer output nodes number: 54
edges number: 279
torch.Size([177, 1433])
torch.Size([54, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4061279296875 GB
    Memory Allocated: 4.353201389312744  GigaBytes
Max Memory Allocated: 6.195392608642578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.4061279296875 GB
    Memory Allocated: 4.3532023429870605  GigaBytes
Max Memory Allocated: 6.195392608642578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4061279296875 GB
    Memory Allocated: 4.301013469696045  GigaBytes
Max Memory Allocated: 8.351125717163086  GigaBytes

pseudo mini batch 2 input nodes size: 205
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4061279296875 GB
    Memory Allocated: 4.30100154876709  GigaBytes
Max Memory Allocated: 8.351125717163086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4061279296875 GB
    Memory Allocated: 4.30100154876709  GigaBytes
Max Memory Allocated: 8.351125717163086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4061279296875 GB
    Memory Allocated: 4.302191734313965  GigaBytes
Max Memory Allocated: 8.351125717163086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4061279296875 GB
    Memory Allocated: 4.302192211151123  GigaBytes
Max Memory Allocated: 8.351125717163086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4061279296875 GB
    Memory Allocated: 4.301246643066406  GigaBytes
Max Memory Allocated: 8.351125717163086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4061279296875 GB
    Memory Allocated: 4.301250457763672  GigaBytes
Max Memory Allocated: 8.351125717163086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4061279296875 GB
    Memory Allocated: 4.301250457763672  GigaBytes
Max Memory Allocated: 8.351125717163086  GigaBytes

first layer input nodes number: 205
first layer output nodes number: 70
edges number: 345
torch.Size([205, 1433])
torch.Size([70, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.370697498321533  GigaBytes
Max Memory Allocated: 8.351125717163086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.37069845199585  GigaBytes
Max Memory Allocated: 8.351125717163086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301259517669678  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 3 input nodes size: 122
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301246643066406  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301246643066406  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301898002624512  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.30189847946167  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300707817077637  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300710678100586  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300710678100586  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 122
first layer output nodes number: 41
edges number: 197
torch.Size([122, 1433])
torch.Size([41, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.340088844299316  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.340089797973633  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300717353820801  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 4 input nodes size: 99
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300707817077637  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300707817077637  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301236629486084  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301237106323242  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3005852699279785  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300588130950928  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300588130950928  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 99
first layer output nodes number: 37
edges number: 207
torch.Size([99, 1433])
torch.Size([37, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.343578338623047  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.343579292297363  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300594806671143  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 5 input nodes size: 80
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3005852699279785  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3005852699279785  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3010125160217285  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301012992858887  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300483703613281  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300485610961914  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300485610961914  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 80
first layer output nodes number: 32
edges number: 124
torch.Size([80, 1433])
torch.Size([32, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.325329780578613  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.32533073425293  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3004913330078125  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 6 input nodes size: 72
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300483703613281  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300483703613281  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300868511199951  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300868988037109  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300441265106201  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.30044412612915  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.30044412612915  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 72
first layer output nodes number: 38
edges number: 146
torch.Size([72, 1433])
torch.Size([38, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.330021858215332  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.330022811889648  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300450801849365  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 7 input nodes size: 91
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300441265106201  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300441265106201  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.30092716217041  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300927639007568  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.30054235458374  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3005452156066895  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3005452156066895  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 91
first layer output nodes number: 39
edges number: 152
torch.Size([91, 1433])
torch.Size([39, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.331127166748047  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.331128120422363  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300551891326904  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 8 input nodes size: 173
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.30054235458374  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.30054235458374  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.30146598815918  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301466464996338  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300980091094971  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300983905792236  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300983905792236  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 173
first layer output nodes number: 60
edges number: 337
torch.Size([173, 1433])
torch.Size([60, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3684210777282715  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.368422031402588  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300992012023926  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 9 input nodes size: 98
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300980091094971  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300980091094971  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301503658294678  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301504135131836  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300580024719238  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3005828857421875  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3005828857421875  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 98
first layer output nodes number: 35
edges number: 167
torch.Size([98, 1433])
torch.Size([35, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.332446575164795  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.332447528839111  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300589561462402  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 10 input nodes size: 67
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300580024719238  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300580024719238  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300938129425049  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300938606262207  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300414562225342  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300416469573975  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300416469573975  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 67
first layer output nodes number: 34
edges number: 126
torch.Size([67, 1433])
torch.Size([34, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.327234268188477  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.327235221862793  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300422191619873  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 11 input nodes size: 109
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300414562225342  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300414562225342  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300996780395508  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300997257232666  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300638675689697  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3006415367126465  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3006415367126465  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 109
first layer output nodes number: 32
edges number: 147
torch.Size([109, 1433])
torch.Size([32, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3274383544921875  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.327439308166504  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300648212432861  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 12 input nodes size: 149
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300638675689697  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300638675689697  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301434516906738  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3014349937438965  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300852298736572  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3008551597595215  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3008551597595215  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 149
first layer output nodes number: 38
edges number: 217
torch.Size([149, 1433])
torch.Size([38, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.338283061981201  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.338284015655518  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3008623123168945  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 13 input nodes size: 101
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300852298736572  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300852298736572  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3013916015625  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301392078399658  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300595760345459  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300598621368408  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300598621368408  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 101
first layer output nodes number: 41
edges number: 169
torch.Size([101, 1433])
torch.Size([41, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.333653450012207  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.333654403686523  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300605297088623  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 14 input nodes size: 91
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300595760345459  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300595760345459  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301081657409668  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301082134246826  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.30054235458374  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3005452156066895  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.3005452156066895  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 91
first layer output nodes number: 39
edges number: 165
torch.Size([91, 1433])
torch.Size([39, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.333090782165527  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.333091735839844  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300551891326904  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

pseudo mini batch 15 input nodes size: 93
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.30054235458374  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.30054235458374  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301039218902588  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.301039695739746  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300553321838379  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300555229187012  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.300555229187012  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

first layer input nodes number: 93
first layer output nodes number: 29
edges number: 122
torch.Size([93, 1433])
torch.Size([29, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.324616432189941  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.324617385864258  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4217529296875 GB
    Memory Allocated: 4.30056095123291  GigaBytes
Max Memory Allocated: 8.368133544921875  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.59931468963623  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.59931468963623  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4628434181213379 |0.022367209196090698 |0.11847512423992157 |0.00012965500354766846 |0.12000058591365814 |0.008382558822631836 |
----------------------------------------------------------pseudo_mini_loss sum 1.9487041234970093
Total (block generation + training)time/epoch 12.192701816558838
Training time/epoch 12.096703290939331
Training time without block to device /epoch 11.73882794380188
Training time without total dataloading part /epoch 3.82606840133667
load block tensor time/epoch 7.405494689941406
block to device time/epoch 0.35787534713745117
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2547
Number of first layer input nodes during this epoch:  1884
Number of first layer output nodes during this epoch:  663
----------------------------------------before generate dataloader block 
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.599314212799072  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006852149963378906
global_2_local spend time (sec) 0.00012683868408203125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0002944469451904297
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 493, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 8: 3, 10: 3, 25: 2, 12: 2, 11: 1, 21: 1, 19: 1})

A = g.adjacency_matrix() spent  0.00015878677368164062
auxiliary_graph
Graph(num_nodes=633, num_edges=430,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.00043511390686035156
remove nodes length  493

auxiliary_graph.remove_nodes spent  0.0014178752899169922
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=430,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006775856018066406

the counter of shared neighbor distribution
Counter({1.0: 244, 2.0: 30, 3.0: 14, 4.0: 2})
290
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.003 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.004662036895751953
9
9
9
9
9
9
9
8
9
8
8
9
9
9
9
8
total k batches seeds list generation spend  0.009688854217529297
after graph partition
graph partition algorithm spend time 0.03844332695007324
9
9
9
9
9
9
9
8
9
8
8
9
9
9
9
8
partition_len_list
[44, 57, 41, 43, 48, 37, 34, 39, 62, 26, 51, 47, 23, 36, 38, 38]
REG selection method  spend 0.03878951072692871
time for parepare:  7.891654968261719e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.193450927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.0033311843872070312
generate_one_block  0.002604961395263672
generate_one_block  0.0012547969818115234
generate_one_block  0.0011010169982910156
generate_one_block  0.0011060237884521484
generate_one_block  0.001092672348022461
generate_one_block  0.0010766983032226562
generate_one_block  0.0010666847229003906
generate_one_block  0.0010693073272705078
generate_one_block  0.0010671615600585938
generate_one_block  0.0009737014770507812
generate_one_block  0.0010251998901367188
generate_one_block  0.0010495185852050781
generate_one_block  0.001043558120727539
generate_one_block  0.0009756088256835938
generate_one_block  0.001032114028930664
generate_one_block  0.000993490219116211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006556510925292969
gen group dst list time:  0.00010180473327636719
time for parepare:  0.0001659393310546875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00014400482177734375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  9.72747802734375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  9.870529174804688e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.677078247070312e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00014352798461914062
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010156631469726562
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.179115295410156e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.1975250244140625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.581710815429688e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.416175842285156e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.653236389160156e-05
----------------------check_connections_block total spend ----------------------------- 0.005076408386230469
generate_one_block  0.0012202262878417969
generate_one_block  0.0012209415435791016
generate_one_block  0.0011489391326904297
generate_one_block  0.0011565685272216797
generate_one_block  0.0011603832244873047
generate_one_block  0.0011358261108398438
generate_one_block  0.0011217594146728516
generate_one_block  0.0011196136474609375
generate_one_block  0.0012891292572021484
generate_one_block  0.0011005401611328125
generate_one_block  0.0011992454528808594
generate_one_block  0.001153707504272461
generate_one_block  0.0010428428649902344
generate_one_block  0.001058816909790039
generate_one_block  0.0010449886322021484
generate_one_block  0.0010318756103515625
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.599314212799072  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

connection checking time:  0.0084075927734375
block generation total time  0.036737918853759766
average batch blocks generation time:  0.0011480599641799927
block dataloader generation time/epoch 0.09716999530792236
pseudo mini batch 0 input nodes size: 152
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.599306106567383  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.599306106567383  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.600117683410645  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.600118160247803  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.599620819091797  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.599623680114746  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.599623680114746  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

first layer input nodes number: 152
first layer output nodes number: 44
edges number: 249
torch.Size([152, 1433])
torch.Size([44, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.6448392868042  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4217529296875 GB
    Memory Allocated: 8.644840717315674  GigaBytes
Max Memory Allocated: 11.59931468963623  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599631786346436  GigaBytes
Max Memory Allocated: 12.64306926727295  GigaBytes

pseudo mini batch 1 input nodes size: 202
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599621772766113  GigaBytes
Max Memory Allocated: 12.64306926727295  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599621772766113  GigaBytes
Max Memory Allocated: 12.64306926727295  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600811958312988  GigaBytes
Max Memory Allocated: 12.64306926727295  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600812435150146  GigaBytes
Max Memory Allocated: 12.64306926727295  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.64306926727295  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.64306926727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.64306926727295  GigaBytes

first layer input nodes number: 202
first layer output nodes number: 57
edges number: 344
torch.Size([202, 1433])
torch.Size([57, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.659028053283691  GigaBytes
Max Memory Allocated: 12.64306926727295  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.659029006958008  GigaBytes
Max Memory Allocated: 12.64306926727295  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

pseudo mini batch 2 input nodes size: 127
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600678443908691  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.60067892074585  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599488258361816  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599491119384766  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599491119384766  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

first layer input nodes number: 127
first layer output nodes number: 41
edges number: 180
torch.Size([127, 1433])
torch.Size([41, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.635697364807129  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.635698318481445  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.59949779510498  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

pseudo mini batch 3 input nodes size: 111
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599488258361816  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599488258361816  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600080966949463  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600081443786621  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599402904510498  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599405765533447  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599405765533447  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

first layer input nodes number: 111
first layer output nodes number: 43
edges number: 186
torch.Size([111, 1433])
torch.Size([43, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.635835647583008  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.635836601257324  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599412441253662  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

pseudo mini batch 4 input nodes size: 142
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599402904510498  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599402904510498  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600161075592041  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.6001615524292  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599568367004395  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599571228027344  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599571228027344  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

first layer input nodes number: 142
first layer output nodes number: 48
edges number: 225
torch.Size([142, 1433])
torch.Size([48, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.645061492919922  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.645062446594238  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599578380584717  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

pseudo mini batch 5 input nodes size: 124
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599568367004395  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599568367004395  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600230693817139  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600231170654297  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599472522735596  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599475383758545  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599475383758545  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

first layer input nodes number: 124
first layer output nodes number: 37
edges number: 176
torch.Size([124, 1433])
torch.Size([37, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.631855487823486  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.631856441497803  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.59948205947876  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

pseudo mini batch 6 input nodes size: 93
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599472522735596  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599472522735596  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599969387054443  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599969863891602  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.5993070602417  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599309921264648  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599309921264648  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

first layer input nodes number: 93
first layer output nodes number: 34
edges number: 141
torch.Size([93, 1433])
torch.Size([34, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.626887321472168  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.626888275146484  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599316596984863  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

pseudo mini batch 7 input nodes size: 80
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.5993070602417  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.5993070602417  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.59973430633545  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599734783172607  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599237442016602  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.59924030303955  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.59924030303955  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

first layer input nodes number: 80
first layer output nodes number: 39
edges number: 156
torch.Size([80, 1433])
torch.Size([39, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.631843566894531  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.631844520568848  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599246978759766  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

pseudo mini batch 8 input nodes size: 160
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599237442016602  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599237442016602  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.600091934204102  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.60009241104126  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599664688110352  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599668502807617  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 8.599668502807617  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

first layer input nodes number: 160
first layer output nodes number: 62
edges number: 341
torch.Size([160, 1433])
torch.Size([62, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.667596817016602  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.667597770690918  GigaBytes
Max Memory Allocated: 12.656860828399658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599676609039307  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

pseudo mini batch 9 input nodes size: 63
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599664688110352  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599664688110352  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600001335144043  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600001811981201  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599146842956543  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599148750305176  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599148750305176  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

first layer input nodes number: 63
first layer output nodes number: 26
edges number: 99
torch.Size([63, 1433])
torch.Size([26, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.62006425857544  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.620065212249756  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599153995513916  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

pseudo mini batch 10 input nodes size: 156
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599146842956543  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599146842956543  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599979877471924  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599980354309082  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599643230438232  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599646091461182  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599646091461182  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

first layer input nodes number: 156
first layer output nodes number: 51
edges number: 244
torch.Size([156, 1433])
torch.Size([51, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.647711277008057  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.647712230682373  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599653244018555  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

pseudo mini batch 11 input nodes size: 110
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599643230438232  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599643230438232  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600230693817139  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600231170654297  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599397659301758  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599400520324707  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599400520324707  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

first layer input nodes number: 110
first layer output nodes number: 47
edges number: 196
torch.Size([110, 1433])
torch.Size([47, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.638816356658936  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.638817310333252  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599407196044922  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

pseudo mini batch 12 input nodes size: 56
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599397659301758  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599397659301758  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599696636199951  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.59969711303711  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599109172821045  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599111080169678  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599111080169678  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

first layer input nodes number: 56
first layer output nodes number: 23
edges number: 93
torch.Size([56, 1433])
torch.Size([23, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.623966217041016  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.623967170715332  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599116325378418  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

pseudo mini batch 13 input nodes size: 98
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599109172821045  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599109172821045  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599632740020752  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.59963321685791  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599333763122559  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599336624145508  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599336624145508  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

first layer input nodes number: 98
first layer output nodes number: 36
edges number: 154
torch.Size([98, 1433])
torch.Size([36, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.629449367523193  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.62945032119751  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599343299865723  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

pseudo mini batch 14 input nodes size: 109
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599333763122559  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599333763122559  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599915981292725  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599916458129883  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599392414093018  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599395275115967  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599395275115967  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

first layer input nodes number: 109
first layer output nodes number: 38
edges number: 193
torch.Size([109, 1433])
torch.Size([38, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.635469436645508  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.635470390319824  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599401950836182  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

pseudo mini batch 15 input nodes size: 92
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599392414093018  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599392414093018  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599883556365967  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599884033203125  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.5993013381958  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.59930419921875  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.59930419921875  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

first layer input nodes number: 92
first layer output nodes number: 38
edges number: 147
torch.Size([92, 1433])
torch.Size([38, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.629306316375732  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.629307270050049  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599310874938965  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599310874938965  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599310874938965  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5037990510463715 |0.0004322230815887451 |0.08733993768692017 |0.00012390315532684326 |0.09319183230400085 |0.004205226898193359 |
----------------------------------------------------------pseudo_mini_loss sum 48.60517883300781
Total (block generation + training)time/epoch 11.910982728004456
Training time/epoch 11.53054141998291
Training time without block to device /epoch 11.52362585067749
Training time without total dataloading part /epoch 2.894695997238159
load block tensor time/epoch 8.060784816741943
block to device time/epoch 0.006915569305419922
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2539
Number of first layer input nodes during this epoch:  1875
Number of first layer output nodes during this epoch:  664
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599310398101807  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009555816650390625
global_2_local spend time (sec) 0.00016570091247558594
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00037479400634765625
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 489, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 8: 3, 10: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.0001957416534423828
auxiliary_graph
Graph(num_nodes=629, num_edges=432,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0005314350128173828
remove nodes length  489

auxiliary_graph.remove_nodes spent  0.0013668537139892578
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=432,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0007989406585693359

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 12, 4.0: 2})
292
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.003 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.00483250617980957
9
9
9
9
9
9
9
9
9
8
9
9
8
8
8
9
total k batches seeds list generation spend  0.01055145263671875
after graph partition
graph partition algorithm spend time 0.061177968978881836
9
9
9
9
9
9
9
9
9
8
9
9
8
8
8
9
partition_len_list
[44, 40, 41, 27, 75, 51, 33, 39, 61, 30, 32, 31, 53, 32, 42, 35]
REG selection method  spend 0.06163144111633301
time for parepare:  0.00013589859008789062
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  5.626678466796875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  8.20159912109375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  5.9604644775390625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  4.2438507080078125e-05
----------------------check_connections_block total spend ----------------------------- 0.006291627883911133
generate_one_block  0.003439664840698242
generate_one_block  0.001474142074584961
generate_one_block  0.0014178752899169922
generate_one_block  0.0013976097106933594
generate_one_block  0.001439809799194336
generate_one_block  0.0014042854309082031
generate_one_block  0.001268148422241211
generate_one_block  0.0010213851928710938
generate_one_block  0.0010304450988769531
generate_one_block  0.001001119613647461
generate_one_block  0.001005411148071289
generate_one_block  0.0010178089141845703
generate_one_block  0.0010867118835449219
generate_one_block  0.0010106563568115234
generate_one_block  0.0010194778442382812
generate_one_block  0.0009703636169433594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005986690521240234
gen group dst list time:  9.393692016601562e-05
time for parepare:  0.00013208389282226562
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00010657310485839844
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  9.965896606445312e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  8.96453857421875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00014543533325195312
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00011944770812988281
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.225440979003906e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.000133514404296875
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.818771362304688e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00010180473327636719
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.699562072753906e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.96453857421875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.295608520507812e-05
----------------------check_connections_block total spend ----------------------------- 0.00485992431640625
generate_one_block  0.001199960708618164
generate_one_block  0.001134634017944336
generate_one_block  0.0011243820190429688
generate_one_block  0.0010700225830078125
generate_one_block  0.0012159347534179688
generate_one_block  0.0011560916900634766
generate_one_block  0.0010819435119628906
generate_one_block  0.0011260509490966797
generate_one_block  0.001270294189453125
generate_one_block  0.0010824203491210938
generate_one_block  0.001117706298828125
generate_one_block  0.0010590553283691406
generate_one_block  0.0010476112365722656
generate_one_block  0.0010547637939453125
generate_one_block  0.0010516643524169922
generate_one_block  0.0010023117065429688
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599310398101807  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

connection checking time:  0.011151552200317383
block generation total time  0.03879976272583008
average batch blocks generation time:  0.00121249258518219
block dataloader generation time/epoch 0.10684839884440105
pseudo mini batch 0 input nodes size: 157
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599300384521484  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599300384521484  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600138664245605  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600139141082764  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599647521972656  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599650382995605  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599650382995605  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

first layer input nodes number: 157
first layer output nodes number: 44
edges number: 249
torch.Size([157, 1433])
torch.Size([44, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.644865989685059  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.644867420196533  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599658489227295  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

pseudo mini batch 1 input nodes size: 153
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599648475646973  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599648475646973  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600465297698975  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600465774536133  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599627017974854  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599629878997803  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599629878997803  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

first layer input nodes number: 153
first layer output nodes number: 40
edges number: 223
torch.Size([153, 1433])
torch.Size([40, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.639201164245605  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.639202117919922  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599637031555176  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

pseudo mini batch 2 input nodes size: 121
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599627017974854  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599627017974854  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600273132324219  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600273609161377  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599456310272217  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599459171295166  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599459171295166  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

first layer input nodes number: 121
first layer output nodes number: 41
edges number: 197
torch.Size([121, 1433])
torch.Size([41, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.638837337493896  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.638838291168213  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.59946584701538  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

pseudo mini batch 3 input nodes size: 51
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599456310272217  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599456310272217  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.59972858428955  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599729061126709  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599082469940186  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599084377288818  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599084377288818  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

first layer input nodes number: 51
first layer output nodes number: 27
edges number: 104
torch.Size([51, 1433])
torch.Size([27, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.627023696899414  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.62702465057373  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599089622497559  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

pseudo mini batch 4 input nodes size: 217
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599082469940186  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.599082469940186  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.60027265548706  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600273132324219  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4237060546875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

first layer input nodes number: 217
first layer output nodes number: 75
edges number: 362
torch.Size([217, 1433])
torch.Size([75, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.673532485961914  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.67353343963623  GigaBytes
Max Memory Allocated: 12.665277004241943  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 5 input nodes size: 166
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600886821746826  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600887298583984  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599696636199951  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599700450897217  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599700450897217  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 166
first layer output nodes number: 51
edges number: 272
torch.Size([166, 1433])
torch.Size([51, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.647849082946777  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.647850036621094  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599708557128906  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 6 input nodes size: 66
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599696636199951  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599696636199951  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600049018859863  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600049495697021  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599162578582764  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599164485931396  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599164485931396  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 66
first layer output nodes number: 33
edges number: 111
torch.Size([66, 1433])
torch.Size([33, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.623342514038086  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.623343467712402  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599170207977295  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 7 input nodes size: 120
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599162578582764  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599162578582764  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599803447723389  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599803924560547  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599451065063477  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599453926086426  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599453926086426  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 120
first layer output nodes number: 39
edges number: 179
torch.Size([120, 1433])
torch.Size([39, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.632188320159912  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.632189273834229  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59946060180664  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 8 input nodes size: 166
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599451065063477  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599451065063477  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600337505340576  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600337982177734  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599696636199951  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599700450897217  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599700450897217  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 166
first layer output nodes number: 61
edges number: 341
torch.Size([166, 1433])
torch.Size([61, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.667536735534668  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.667537689208984  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599708557128906  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 9 input nodes size: 70
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599696636199951  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599696636199951  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600070476531982  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60007095336914  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599184036254883  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599185943603516  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599185943603516  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 70
first layer output nodes number: 30
edges number: 106
torch.Size([70, 1433])
torch.Size([30, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.621479511260986  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.621480464935303  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599191665649414  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 10 input nodes size: 134
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599184036254883  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599184036254883  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599899768829346  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599900245666504  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599525928497314  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599528789520264  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599528789520264  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 134
first layer output nodes number: 32
edges number: 177
torch.Size([134, 1433])
torch.Size([32, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.629171371459961  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.629172325134277  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599535942077637  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 11 input nodes size: 88
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599525928497314  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599525928497314  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599996089935303  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599996566772461  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59928035736084  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599283218383789  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599283218383789  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 88
first layer output nodes number: 31
edges number: 132
torch.Size([88, 1433])
torch.Size([31, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.624326229095459  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.624327182769775  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599289894104004  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 12 input nodes size: 125
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59928035736084  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59928035736084  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599947929382324  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599948406219482  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599477767944336  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599480628967285  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599480628967285  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 125
first layer output nodes number: 53
edges number: 233
torch.Size([125, 1433])
torch.Size([53, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.646835327148438  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.646836280822754  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.5994873046875  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 13 input nodes size: 74
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599477767944336  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599477767944336  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599873065948486  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599873542785645  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599205493927002  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599208354949951  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599208354949951  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 74
first layer output nodes number: 32
edges number: 130
torch.Size([74, 1433])
torch.Size([32, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.625917434692383  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.6259183883667  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599215030670166  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 14 input nodes size: 87
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599205493927002  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599205493927002  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599669933319092  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59967041015625  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599274635314941  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59927749633789  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59927749633789  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 87
first layer output nodes number: 42
edges number: 193
torch.Size([87, 1433])
torch.Size([42, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.636487007141113  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.63648796081543  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599284172058105  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 15 input nodes size: 104
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599274635314941  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599274635314941  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599830150604248  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599830627441406  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599365711212158  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599368572235107  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599368572235107  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 104
first layer output nodes number: 35
edges number: 142
torch.Size([104, 1433])
torch.Size([35, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.62707233428955  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.627073287963867  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599375247955322  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599375247955322  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599375247955322  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4429950565099716 |0.0003445744514465332 |0.0872909277677536 |0.00011935830116271973 |0.13269779086112976 |0.004138946533203125 |
----------------------------------------------------------pseudo_mini_loss sum 32.02661895751953
Total (block generation + training)time/epoch 11.6718381245931
Training time/epoch 11.067181825637817
Training time without block to device /epoch 11.061668634414673
Training time without total dataloading part /epoch 3.5258681774139404
load block tensor time/epoch 7.087920904159546
block to device time/epoch 0.005513191223144531
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2565
Number of first layer input nodes during this epoch:  1899
Number of first layer output nodes during this epoch:  666
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599374771118164  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007243156433105469
global_2_local spend time (sec) 0.00013136863708496094
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0002980232238769531
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 489, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 8: 3, 10: 3, 25: 2, 12: 2, 21: 1, 11: 1, 19: 1})

A = g.adjacency_matrix() spent  0.000156402587890625
auxiliary_graph
Graph(num_nodes=629, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.00043845176696777344
remove nodes length  489

auxiliary_graph.remove_nodes spent  0.002109527587890625
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0007090568542480469

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 14, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.00476527214050293
9
8
9
9
8
9
9
9
9
9
9
8
8
9
9
9
total k batches seeds list generation spend  0.010569572448730469
after graph partition
graph partition algorithm spend time 0.03862786293029785
9
8
9
9
8
9
9
9
9
9
9
8
8
9
9
9
partition_len_list
[60, 36, 35, 39, 31, 42, 36, 32, 46, 64, 45, 35, 50, 27, 49, 42]
REG selection method  spend 0.038921356201171875
time for parepare:  5.9604644775390625e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.193450927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.003007650375366211
generate_one_block  0.006215095520019531
generate_one_block  0.0011248588562011719
generate_one_block  0.001055002212524414
generate_one_block  0.0010485649108886719
generate_one_block  0.0010275840759277344
generate_one_block  0.0010249614715576172
generate_one_block  0.0009691715240478516
generate_one_block  0.0009555816650390625
generate_one_block  0.0010023117065429688
generate_one_block  0.0010182857513427734
generate_one_block  0.0009670257568359375
generate_one_block  0.0009613037109375
generate_one_block  0.0011260509490966797
generate_one_block  0.0010342597961425781
generate_one_block  0.0010008811950683594
generate_one_block  0.0009696483612060547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007183551788330078
gen group dst list time:  9.250640869140625e-05
time for parepare:  0.0001227855682373047
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00013208389282226562
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.414817810058594e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010418891906738281
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00015997886657714844
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  9.775161743164062e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  9.846687316894531e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.009506225585938e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.322166442871094e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  9.202957153320312e-05
----------------------check_connections_block total spend ----------------------------- 0.004801511764526367
generate_one_block  0.0012161731719970703
generate_one_block  0.0011162757873535156
generate_one_block  0.0011146068572998047
generate_one_block  0.0011184215545654297
generate_one_block  0.0011060237884521484
generate_one_block  0.0011324882507324219
generate_one_block  0.0011050701141357422
generate_one_block  0.0010967254638671875
generate_one_block  0.0012559890747070312
generate_one_block  0.0012257099151611328
generate_one_block  0.0011382102966308594
generate_one_block  0.0011224746704101562
generate_one_block  0.0011706352233886719
generate_one_block  0.0010154247283935547
generate_one_block  0.001051187515258789
generate_one_block  0.0010421276092529297
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599374771118164  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

connection checking time:  0.007809162139892578
block generation total time  0.03952813148498535
average batch blocks generation time:  0.0012352541089057922
block dataloader generation time/epoch 0.10503321886062622
pseudo mini batch 0 input nodes size: 175
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599364757537842  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599364757537842  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60029935836792  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600299835205078  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599743843078613  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599747657775879  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599747657775879  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 175
first layer output nodes number: 60
edges number: 330
torch.Size([175, 1433])
torch.Size([60, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.666616439819336  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.66661787033081  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599756717681885  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 1 input nodes size: 79
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59974479675293  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59974479675293  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60016679763794  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600167274475098  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599232196807861  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59923505783081  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59923505783081  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 79
first layer output nodes number: 36
edges number: 143
torch.Size([79, 1433])
torch.Size([36, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.629254341125488  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.629255294799805  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599241733551025  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 2 input nodes size: 106
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599232196807861  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599232196807861  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599798202514648  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599798679351807  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599376201629639  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599379062652588  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599379062652588  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 106
first layer output nodes number: 35
edges number: 166
torch.Size([106, 1433])
torch.Size([35, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.629477500915527  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.629478454589844  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599385738372803  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 3 input nodes size: 81
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599376201629639  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599376201629639  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599808692932129  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599809169769287  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599242687225342  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599245548248291  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599245548248291  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 81
first layer output nodes number: 39
edges number: 156
torch.Size([81, 1433])
torch.Size([39, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.631984233856201  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.631985187530518  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599252223968506  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 4 input nodes size: 76
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599242687225342  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599242687225342  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599648475646973  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59964895248413  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599215984344482  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599218845367432  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599218845367432  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 76
first layer output nodes number: 31
edges number: 132
torch.Size([76, 1433])
torch.Size([31, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.625522136688232  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.625523090362549  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599225521087646  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 5 input nodes size: 117
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599215984344482  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599215984344482  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599840641021729  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599841117858887  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599434852600098  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599437713623047  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599437713623047  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 117
first layer output nodes number: 42
edges number: 190
torch.Size([117, 1433])
torch.Size([42, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.634702682495117  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.634703636169434  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599444389343262  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 6 input nodes size: 90
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599434852600098  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599434852600098  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599915504455566  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599915981292725  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59929084777832  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59929370880127  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59929370880127  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 90
first layer output nodes number: 36
edges number: 146
torch.Size([90, 1433])
torch.Size([36, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.62783145904541  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.627832412719727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599300384521484  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 7 input nodes size: 89
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59929084777832  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59929084777832  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599766254425049  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599766731262207  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59928560256958  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599287509918213  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599287509918213  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 89
first layer output nodes number: 32
edges number: 119
torch.Size([89, 1433])
torch.Size([32, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.623394012451172  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.623394966125488  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599293231964111  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 8 input nodes size: 165
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59928560256958  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59928560256958  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60016679763794  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600167274475098  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599691390991211  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59969425201416  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59969425201416  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 165
first layer output nodes number: 46
edges number: 254
torch.Size([165, 1433])
torch.Size([46, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.646417140960693  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.64641809463501  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599701404571533  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 9 input nodes size: 198
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599691390991211  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599691390991211  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600881576538086  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600882053375244  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 198
first layer output nodes number: 64
edges number: 381
torch.Size([198, 1433])
torch.Size([64, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.666269302368164  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.66627025604248  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 10 input nodes size: 121
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600646495819092  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60064697265625  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599456310272217  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599459171295166  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599459171295166  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 121
first layer output nodes number: 45
edges number: 193
torch.Size([121, 1433])
torch.Size([45, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.639801979064941  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.639802932739258  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59946584701538  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 11 input nodes size: 104
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599456310272217  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599456310272217  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600011825561523  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600012302398682  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599365711212158  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599368572235107  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599368572235107  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 104
first layer output nodes number: 35
edges number: 158
torch.Size([104, 1433])
torch.Size([35, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.630541801452637  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.630542755126953  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599375247955322  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 12 input nodes size: 149
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599365711212158  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599365711212158  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.6001615524292  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600162029266357  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599606037139893  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599608898162842  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599608898162842  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 149
first layer output nodes number: 50
edges number: 233
torch.Size([149, 1433])
torch.Size([50, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.646245956420898  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.646246910095215  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599616050720215  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 13 input nodes size: 98
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599606037139893  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599606037139893  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.6001296043396  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600130081176758  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599333763122559  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599336624145508  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599336624145508  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 98
first layer output nodes number: 27
edges number: 147
torch.Size([98, 1433])
torch.Size([27, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.631163120269775  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.631164073944092  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599343299865723  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 14 input nodes size: 120
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599333763122559  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599333763122559  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599974632263184  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599975109100342  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599451065063477  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599453926086426  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599453926086426  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 120
first layer output nodes number: 49
edges number: 206
torch.Size([120, 1433])
torch.Size([49, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.64167070388794  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.641671657562256  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59946060180664  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 15 input nodes size: 150
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599451065063477  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599451065063477  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600252151489258  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600252628326416  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599611282348633  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599614143371582  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599614143371582  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 150
first layer output nodes number: 42
edges number: 204
torch.Size([150, 1433])
torch.Size([42, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.636003017425537  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.636003971099854  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599621295928955  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599621295928955  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599621295928955  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4678923636674881 |0.0003475099802017212 |0.08150650560855865 |0.00011189281940460205 |0.09767968952655792 |0.004134654998779297 |
----------------------------------------------------------pseudo_mini_loss sum 60.62250900268555
Total (block generation + training)time/epoch 11.523865759372711
Training time/epoch 10.98021388053894
Training time without block to device /epoch 10.974653720855713
Training time without total dataloading part /epoch 2.872904062271118
load block tensor time/epoch 7.48627781867981
block to device time/epoch 0.005560159683227539
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  2587
Number of first layer input nodes during this epoch:  1918
Number of first layer output nodes during this epoch:  669
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599620819091797  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007660388946533203
global_2_local spend time (sec) 0.0001285076141357422
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0002982616424560547
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 490, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 10: 3, 8: 3, 25: 2, 12: 2, 21: 1, 11: 1, 19: 1})

A = g.adjacency_matrix() spent  0.0001614093780517578
auxiliary_graph
Graph(num_nodes=630, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0004487037658691406
remove nodes length  490

auxiliary_graph.remove_nodes spent  0.001010894775390625
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006928443908691406

the counter of shared neighbor distribution
Counter({1.0: 250, 2.0: 30, 3.0: 12, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0046367645263671875
9
9
8
9
9
8
9
9
9
9
9
9
9
9
8
8
total k batches seeds list generation spend  0.009427547454833984
after graph partition
graph partition algorithm spend time 0.046752214431762695
9
9
8
9
9
8
9
9
9
9
9
9
9
9
8
8
partition_len_list
[68, 38, 39, 30, 50, 28, 36, 44, 44, 62, 48, 31, 62, 32, 39, 27]
REG selection method  spend 0.047041893005371094
time for parepare:  6.0558319091796875e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.71661376953125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.71661376953125e-05
----------------------check_connections_block total spend ----------------------------- 0.0030825138092041016
generate_one_block  0.001966714859008789
generate_one_block  0.001100301742553711
generate_one_block  0.0010690689086914062
generate_one_block  0.0010521411895751953
generate_one_block  0.001065969467163086
generate_one_block  0.001043558120727539
generate_one_block  0.0010585784912109375
generate_one_block  0.001065969467163086
generate_one_block  0.0010640621185302734
generate_one_block  0.001013040542602539
generate_one_block  0.0009732246398925781
generate_one_block  0.0009908676147460938
generate_one_block  0.0010898113250732422
generate_one_block  0.0009613037109375
generate_one_block  0.0009634494781494141
generate_one_block  0.001027822494506836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006315708160400391
gen group dst list time:  9.417533874511719e-05
time for parepare:  0.00014090538024902344
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00014162063598632812
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  9.274482727050781e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00010228157043457031
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  9.965896606445312e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00010228157043457031
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001480579376220703
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00010347366333007812
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  9.369850158691406e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.412101745605469e-05
----------------------check_connections_block total spend ----------------------------- 0.0048656463623046875
generate_one_block  0.0012211799621582031
generate_one_block  0.00112152099609375
generate_one_block  0.0011332035064697266
generate_one_block  0.0011119842529296875
generate_one_block  0.0011632442474365234
generate_one_block  0.0010781288146972656
generate_one_block  0.0011146068572998047
generate_one_block  0.0011365413665771484
generate_one_block  0.0012369155883789062
generate_one_block  0.0012140274047851562
generate_one_block  0.0011637210845947266
generate_one_block  0.0010941028594970703
generate_one_block  0.0011322498321533203
generate_one_block  0.001005411148071289
generate_one_block  0.001117706298828125
generate_one_block  0.0009860992431640625
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599620819091797  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

connection checking time:  0.007948160171508789
block generation total time  0.03553652763366699
average batch blocks generation time:  0.0011105164885520935
block dataloader generation time/epoch 0.10483250617980958
pseudo mini batch 0 input nodes size: 185
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599610328674316  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599610328674316  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600800514221191  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60080099105835  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59999942779541  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600003242492676  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600003242492676  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 185
first layer output nodes number: 68
edges number: 336
torch.Size([185, 1433])
torch.Size([68, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.666245460510254  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.666246891021729  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 1 input nodes size: 101
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600539684295654  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600540161132812  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59934949874878  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599352359771729  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599352359771729  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 101
first layer output nodes number: 38
edges number: 141
torch.Size([101, 1433])
torch.Size([38, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.628523349761963  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.62852430343628  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599359035491943  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 2 input nodes size: 106
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59934949874878  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59934949874878  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599915504455566  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599915981292725  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599376201629639  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599379062652588  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599379062652588  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 106
first layer output nodes number: 39
edges number: 202
torch.Size([106, 1433])
torch.Size([39, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.63657283782959  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.636573791503906  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599385738372803  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 3 input nodes size: 100
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599376201629639  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599376201629639  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599910259246826  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599910736083984  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599344253540039  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599347114562988  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599347114562988  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 100
first layer output nodes number: 30
edges number: 135
torch.Size([100, 1433])
torch.Size([30, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.624082565307617  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.624083518981934  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599353790283203  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 4 input nodes size: 145
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599344253540039  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599344253540039  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600118637084961  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60011911392212  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599584579467773  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599587440490723  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599587440490723  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 145
first layer output nodes number: 50
edges number: 230
torch.Size([145, 1433])
torch.Size([50, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.643820762634277  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.643821716308594  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599594593048096  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 5 input nodes size: 57
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599584579467773  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599584579467773  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599889278411865  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599889755249023  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599114894866943  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599116802215576  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599116802215576  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 57
first layer output nodes number: 28
edges number: 83
torch.Size([57, 1433])
torch.Size([28, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.61846113204956  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.618462085723877  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599122047424316  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 6 input nodes size: 95
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599114894866943  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599114894866943  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599622249603271  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59962272644043  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59931755065918  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599320411682129  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599320411682129  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 95
first layer output nodes number: 36
edges number: 139
torch.Size([95, 1433])
torch.Size([36, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.627315998077393  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.627316951751709  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599327087402344  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 7 input nodes size: 105
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59931755065918  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59931755065918  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599878311157227  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599878787994385  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599370956420898  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599373817443848  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599373817443848  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 105
first layer output nodes number: 44
edges number: 199
torch.Size([105, 1433])
torch.Size([44, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.636460304260254  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.63646125793457  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599380493164062  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 8 input nodes size: 151
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599370956420898  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599370956420898  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60017728805542  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600177764892578  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599616527557373  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599619388580322  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599619388580322  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 151
first layer output nodes number: 44
edges number: 249
torch.Size([151, 1433])
torch.Size([44, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.644834995269775  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.644835948944092  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599626541137695  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 9 input nodes size: 205
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599616527557373  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599616527557373  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600806713104248  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600807189941406  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 205
first layer output nodes number: 62
edges number: 366
torch.Size([205, 1433])
torch.Size([62, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.664443969726562  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.664444923400879  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 10 input nodes size: 148
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60079050064087  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600790977478027  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599600315093994  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599603176116943  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599603176116943  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 148
first layer output nodes number: 48
edges number: 225
torch.Size([148, 1433])
torch.Size([48, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.645093441009521  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.645094394683838  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599610328674316  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 11 input nodes size: 63
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599600315093994  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599600315093994  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599936962127686  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599937438964844  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599146842956543  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599148750305176  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599148750305176  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 63
first layer output nodes number: 31
edges number: 107
torch.Size([63, 1433])
torch.Size([31, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.625382423400879  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.625383377075195  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599153995513916  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 12 input nodes size: 172
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599146842956543  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599146842956543  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600065231323242  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.6000657081604  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59972858428955  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599732398986816  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599732398986816  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 172
first layer output nodes number: 62
edges number: 343
torch.Size([172, 1433])
torch.Size([62, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.667815208435059  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.667816162109375  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599740505218506  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 13 input nodes size: 72
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59972858428955  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59972858428955  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60011339187622  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600113868713379  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599195003509521  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599196910858154  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599196910858154  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 72
first layer output nodes number: 32
edges number: 120
torch.Size([72, 1433])
torch.Size([32, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.625657558441162  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.625658512115479  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599202632904053  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 14 input nodes size: 136
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599195003509521  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599195003509521  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599921226501465  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599921703338623  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599536418914795  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599539279937744  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599539279937744  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 136
first layer output nodes number: 39
edges number: 221
torch.Size([136, 1433])
torch.Size([39, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.636447429656982  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.636448383331299  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599546432495117  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 15 input nodes size: 56
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599536418914795  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599536418914795  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599835395812988  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599835872650146  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599109172821045  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599111080169678  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599111080169678  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 56
first layer output nodes number: 27
edges number: 88
torch.Size([56, 1433])
torch.Size([27, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.618309497833252  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.618310451507568  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599116325378418  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599116325378418  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599116325378418  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4556658864021301 |0.0003276020288467407 |0.08526888489723206 |0.0001084059476852417 |0.12976448237895966 |0.004118204116821289 |
----------------------------------------------------------pseudo_mini_loss sum 128.883056640625
Total (block generation + training)time/epoch 11.467273283004761
Training time/epoch 11.136710166931152
Training time without block to device /epoch 11.131468534469604
Training time without total dataloading part /epoch 3.4463865756988525
load block tensor time/epoch 7.290654182434082
block to device time/epoch 0.0052416324615478516
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  2575
Number of first layer input nodes during this epoch:  1897
Number of first layer output nodes during this epoch:  678
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59911584854126  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.008341073989868164
global_2_local spend time (sec) 0.00013780593872070312
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0003104209899902344
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 491, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 10: 3, 8: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.0001690387725830078
auxiliary_graph
Graph(num_nodes=631, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.00044918060302734375
remove nodes length  491

auxiliary_graph.remove_nodes spent  0.0009891986846923828
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0007047653198242188

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 14, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.003 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.004808187484741211
9
9
9
9
8
9
9
9
9
8
8
9
9
9
9
8
total k batches seeds list generation spend  0.009492874145507812
after graph partition
graph partition algorithm spend time 0.09382176399230957
9
9
9
9
8
9
9
9
9
8
8
9
9
9
9
8
partition_len_list
[66, 46, 49, 42, 38, 56, 28, 43, 55, 39, 19, 27, 62, 30, 30, 42]
REG selection method  spend 0.09423470497131348
time for parepare:  0.00012683868408203125
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0002262592315673828
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  6.103515625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  6.866455078125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  4.696846008300781e-05
----------------------check_connections_block total spend ----------------------------- 0.006489753723144531
generate_one_block  0.003354310989379883
generate_one_block  0.0014719963073730469
generate_one_block  0.0014317035675048828
generate_one_block  0.0014226436614990234
generate_one_block  0.0014171600341796875
generate_one_block  0.0014355182647705078
generate_one_block  0.0014004707336425781
generate_one_block  0.0010263919830322266
generate_one_block  0.0010528564453125
generate_one_block  0.0010256767272949219
generate_one_block  0.0010142326354980469
generate_one_block  0.0010187625885009766
generate_one_block  0.0011148452758789062
generate_one_block  0.0010156631469726562
generate_one_block  0.0010228157043457031
generate_one_block  0.0010302066802978516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006384849548339844
gen group dst list time:  9.131431579589844e-05
time for parepare:  0.00011873245239257812
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00014400482177734375
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  9.775161743164062e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00011134147644042969
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  8.726119995117188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.463859558105469e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00011014938354492188
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  0.00010418891906738281
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0001010894775390625
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  7.009506225585938e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00012874603271484375
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.843971252441406e-05
----------------------check_connections_block total spend ----------------------------- 0.004675149917602539
generate_one_block  0.001219034194946289
generate_one_block  0.0011374950408935547
generate_one_block  0.0011563301086425781
generate_one_block  0.0011243820190429688
generate_one_block  0.001127004623413086
generate_one_block  0.0011513233184814453
generate_one_block  0.001064300537109375
generate_one_block  0.00112152099609375
generate_one_block  0.0012066364288330078
generate_one_block  0.0010998249053955078
generate_one_block  0.0010349750518798828
generate_one_block  0.0010614395141601562
generate_one_block  0.0011353492736816406
generate_one_block  0.001073598861694336
generate_one_block  0.0010869503021240234
generate_one_block  0.001132965087890625
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59911584854126  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

connection checking time:  0.01116490364074707
block generation total time  0.039188385009765625
average batch blocks generation time:  0.0012246370315551758
block dataloader generation time/epoch 0.1150985558827718
pseudo mini batch 0 input nodes size: 196
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599108219146729  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599108219146729  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600298404693604  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600298881530762  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59999942779541  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600003242492676  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600003242492676  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 196
first layer output nodes number: 66
edges number: 380
torch.Size([196, 1433])
torch.Size([66, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.66914701461792  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.669148445129395  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 1 input nodes size: 152
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600811958312988  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600812435150146  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599621772766113  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599624633789062  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599624633789062  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 152
first layer output nodes number: 46
edges number: 239
torch.Size([152, 1433])
torch.Size([46, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.643288612365723  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.643289566040039  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599631786346436  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 2 input nodes size: 178
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599621772766113  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599621772766113  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600572109222412  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60057258605957  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59976053237915  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599764347076416  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599764347076416  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 178
first layer output nodes number: 49
edges number: 278
torch.Size([178, 1433])
torch.Size([49, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.650041580200195  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.650042533874512  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599772453308105  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 3 input nodes size: 144
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59976053237915  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59976053237915  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600529670715332  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60053014755249  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599579334259033  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599582195281982  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599582195281982  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 144
first layer output nodes number: 42
edges number: 201
torch.Size([144, 1433])
torch.Size([42, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.637092113494873  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.63709306716919  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599589347839355  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 4 input nodes size: 127
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599579334259033  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599579334259033  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600257396697998  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600257873535156  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599488258361816  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599491119384766  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599491119384766  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 127
first layer output nodes number: 38
edges number: 201
torch.Size([127, 1433])
torch.Size([38, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.637021541595459  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.637022495269775  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59949779510498  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 5 input nodes size: 150
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599488258361816  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599488258361816  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600289344787598  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600289821624756  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599611282348633  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599615097045898  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599615097045898  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 150
first layer output nodes number: 56
edges number: 283
torch.Size([150, 1433])
torch.Size([56, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.650927066802979  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.650928020477295  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599623203277588  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 6 input nodes size: 68
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599611282348633  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599611282348633  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599974632263184  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599975109100342  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599173545837402  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599175453186035  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599175453186035  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 68
first layer output nodes number: 28
edges number: 100
torch.Size([68, 1433])
torch.Size([28, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.620018482208252  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.620019435882568  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599181175231934  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 7 input nodes size: 101
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599173545837402  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599173545837402  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59971284866333  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599713325500488  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59934949874878  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599352359771729  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599352359771729  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 101
first layer output nodes number: 43
edges number: 174
torch.Size([101, 1433])
torch.Size([43, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.633888244628906  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.633889198303223  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599359035491943  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 8 input nodes size: 156
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59934949874878  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59934949874878  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.60018253326416  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600183010101318  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599643230438232  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599646091461182  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599646091461182  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 156
first layer output nodes number: 55
edges number: 239
torch.Size([156, 1433])
torch.Size([55, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.648713111877441  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.648714065551758  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599653244018555  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 9 input nodes size: 110
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599643230438232  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599643230438232  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600230693817139  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600231170654297  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599397659301758  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599400520324707  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599400520324707  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 110
first layer output nodes number: 39
edges number: 170
torch.Size([110, 1433])
torch.Size([39, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.631767749786377  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.631768703460693  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599407196044922  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 10 input nodes size: 41
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599397659301758  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599397659301758  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599617004394531  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59961748123169  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599029541015625  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599031448364258  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599031448364258  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 41
first layer output nodes number: 19
edges number: 72
torch.Size([41, 1433])
torch.Size([19, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.617607593536377  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.617608547210693  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599036693572998  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 11 input nodes size: 61
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599029541015625  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599029541015625  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599355220794678  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599355697631836  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599135875701904  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599137783050537  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599137783050537  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 61
first layer output nodes number: 27
edges number: 105
torch.Size([61, 1433])
torch.Size([27, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.6221284866333  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.622129440307617  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599143028259277  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 12 input nodes size: 171
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599135875701904  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599135875701904  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600049018859863  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600049495697021  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59972333908081  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599727153778076  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599727153778076  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 171
first layer output nodes number: 62
edges number: 342
torch.Size([171, 1433])
torch.Size([62, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.667743682861328  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.667744636535645  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599735260009766  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 13 input nodes size: 81
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59972333908081  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59972333908081  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.6001558303833  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.600156307220459  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599242687225342  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599244594573975  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599244594573975  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 81
first layer output nodes number: 30
edges number: 119
torch.Size([81, 1433])
torch.Size([30, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.623620986938477  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.623621940612793  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599250316619873  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 14 input nodes size: 74
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599242687225342  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599242687225342  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599637985229492  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59963846206665  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599205493927002  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599207401275635  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599207401275635  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 74
first layer output nodes number: 30
edges number: 109
torch.Size([74, 1433])
torch.Size([30, 8192])
torch.Size([9, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.622323513031006  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.622324466705322  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599213123321533  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

pseudo mini batch 15 input nodes size: 97
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599205493927002  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599205493927002  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59972333908081  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599723815917969  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59932804107666  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59933090209961  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.59933090209961  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

first layer input nodes number: 97
first layer output nodes number: 42
edges number: 161
torch.Size([97, 1433])
torch.Size([42, 8192])
torch.Size([8, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.632596015930176  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.632596969604492  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599337577819824  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599337577819824  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4276123046875 GB
    Memory Allocated: 8.599337577819824  GigaBytes
Max Memory Allocated: 12.67081594467163  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.45277898013591766 |0.000440940260887146 |0.08431307971477509 |0.00012031197547912598 |0.10626338422298431 |0.004175901412963867 |
----------------------------------------------------------pseudo_mini_loss sum 152.97293090820312
Total (block generation + training)time/epoch 11.419941782951355
Training time/epoch 11.016725063323975
Training time without block to device /epoch 11.00967001914978
Training time without total dataloading part /epoch 3.0553243160247803
load block tensor time/epoch 7.244463682174683
block to device time/epoch 0.007055044174194336
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  2579
Number of first layer input nodes during this epoch:  1907
Number of first layer output nodes during this epoch:  672
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=8192, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=8192, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(8192, 8192, batch_first=True)
      (fc_self): Linear(in_features=8192, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=8192, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  576968784
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([8192, 1433])
layers.0.fc_neigh.weight, torch.Size([8192, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([32768, 8192])
layers.1.lstm.weight_hh_l0, torch.Size([32768, 8192])
layers.1.lstm.bias_ih_l0, torch.Size([32768])
layers.1.lstm.bias_hh_l0, torch.Size([32768])
layers.1.fc_self.weight, torch.Size([7, 8192])
layers.1.fc_neigh.weight, torch.Size([7, 8192])
----------------------------------------
un-trainable parameters
