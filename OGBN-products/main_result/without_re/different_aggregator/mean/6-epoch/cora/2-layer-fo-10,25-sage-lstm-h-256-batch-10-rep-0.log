main start at this time 1656402563.215938
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012962818145751953
global_2_local spend time (sec) 0.00017547607421875
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0007510185241699219
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 488, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 8: 3, 10: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.0005185604095458984
auxiliary_graph
Graph(num_nodes=628, num_edges=436,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0007946491241455078
remove nodes length  488

auxiliary_graph.remove_nodes spent  0.001954317092895508
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=436,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0008921623229980469

the counter of shared neighbor distribution
Counter({1.0: 250, 2.0: 30, 3.0: 14, 4.0: 2})
296
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0035872459411621094
14
14
14
14
14
14
14
14
14
14
total k batches seeds list generation spend  0.01448512077331543
after graph partition
graph partition algorithm spend time 0.06022238731384277
14
14
14
14
14
14
14
14
14
14
partition_len_list
[96, 55, 91, 51, 65, 78, 56, 57, 44, 66]
REG selection method  spend 0.06079864501953125
time for parepare:  0.0001289844512939453
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  7.128715515136719e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  9.775161743164062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  6.651878356933594e-05
----------------------check_connections_block total spend ----------------------------- 0.004450559616088867
generate_one_block  0.004360675811767578
generate_one_block  0.0014653205871582031
generate_one_block  0.0014500617980957031
generate_one_block  0.001421213150024414
generate_one_block  0.0014448165893554688
generate_one_block  0.0014982223510742188
generate_one_block  0.0012171268463134766
generate_one_block  0.001026153564453125
generate_one_block  0.0010499954223632812
generate_one_block  0.001035451889038086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006110668182373047
gen group dst list time:  0.00010609626770019531
time for parepare:  0.00013947486877441406
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00018525123596191406
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001068115234375
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00018358230590820312
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00010585784912109375
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00016045570373535156
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  9.989738464355469e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.894371032714844e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00014495849609375
----------------------check_connections_block total spend ----------------------------- 0.003658771514892578
generate_one_block  0.0012671947479248047
generate_one_block  0.0011990070343017578
generate_one_block  0.0012311935424804688
generate_one_block  0.0011479854583740234
generate_one_block  0.0011773109436035156
generate_one_block  0.0012049674987792969
generate_one_block  0.001146078109741211
generate_one_block  0.0011298656463623047
generate_one_block  0.001119852066040039
generate_one_block  0.0011990070343017578
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

connection checking time:  0.008109331130981445
block generation total time  0.027791500091552734
average batch blocks generation time:  0.0013895750045776368
block dataloader generation time/epoch 0.10524535179138184
pseudo mini batch 0 input nodes size: 283
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06876134872436523  GigaBytes
Max Memory Allocated: 0.06876134872436523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06876182556152344  GigaBytes
Max Memory Allocated: 0.06876182556152344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06876182556152344  GigaBytes
Max Memory Allocated: 0.06876182556152344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.06876659393310547  GigaBytes
Max Memory Allocated: 0.06876659393310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.06876659393310547  GigaBytes
Max Memory Allocated: 0.06876659393310547  GigaBytes

first layer input nodes number: 283
first layer output nodes number: 96
edges number: 479
torch.Size([283, 1433])
torch.Size([96, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.11088371276855469  GigaBytes
Max Memory Allocated: 0.11285400390625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.1108851432800293  GigaBytes
Max Memory Allocated: 0.11285400390625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13602876663208008  GigaBytes
Max Memory Allocated: 0.23714637756347656  GigaBytes

pseudo mini batch 1 input nodes size: 143
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13601350784301758  GigaBytes
Max Memory Allocated: 0.23714637756347656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13601350784301758  GigaBytes
Max Memory Allocated: 0.23714637756347656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13677692413330078  GigaBytes
Max Memory Allocated: 0.23714637756347656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13677740097045898  GigaBytes
Max Memory Allocated: 0.23714637756347656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13526582717895508  GigaBytes
Max Memory Allocated: 0.23714637756347656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1352686882019043  GigaBytes
Max Memory Allocated: 0.23714637756347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1352686882019043  GigaBytes
Max Memory Allocated: 0.23714637756347656  GigaBytes

first layer input nodes number: 143
first layer output nodes number: 55
edges number: 234
torch.Size([143, 1433])
torch.Size([55, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1560497283935547  GigaBytes
Max Memory Allocated: 0.23714637756347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1560506820678711  GigaBytes
Max Memory Allocated: 0.23714637756347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.13527584075927734  GigaBytes
Max Memory Allocated: 0.27962493896484375  GigaBytes

pseudo mini batch 2 input nodes size: 254
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.13526582717895508  GigaBytes
Max Memory Allocated: 0.27962493896484375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.13526582717895508  GigaBytes
Max Memory Allocated: 0.27962493896484375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.13677692413330078  GigaBytes
Max Memory Allocated: 0.27962493896484375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.13677740097045898  GigaBytes
Max Memory Allocated: 0.27962493896484375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.13601350784301758  GigaBytes
Max Memory Allocated: 0.27962493896484375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.1360182762145996  GigaBytes
Max Memory Allocated: 0.27962493896484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.1360182762145996  GigaBytes
Max Memory Allocated: 0.27962493896484375  GigaBytes

first layer input nodes number: 254
first layer output nodes number: 91
edges number: 475
torch.Size([254, 1433])
torch.Size([91, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.17757368087768555  GigaBytes
Max Memory Allocated: 0.27962493896484375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.17757463455200195  GigaBytes
Max Memory Allocated: 0.27962493896484375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13602828979492188  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

pseudo mini batch 3 input nodes size: 143
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13601350784301758  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13601350784301758  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13677692413330078  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13677740097045898  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13526582717895508  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1352686882019043  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1352686882019043  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

first layer input nodes number: 143
first layer output nodes number: 51
edges number: 248
torch.Size([143, 1433])
torch.Size([51, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1573472023010254  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1573481559753418  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13527584075927734  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

pseudo mini batch 4 input nodes size: 211
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13526582717895508  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13526582717895508  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13677692413330078  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13677740097045898  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13601350784301758  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1360173225402832  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1360173225402832  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

first layer input nodes number: 211
first layer output nodes number: 65
edges number: 331
torch.Size([211, 1433])
torch.Size([65, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1650867462158203  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.16508769989013672  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13602638244628906  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

pseudo mini batch 5 input nodes size: 191
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13601350784301758  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13601350784301758  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13703346252441406  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13703393936157227  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13552236557006836  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1355271339416504  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1355271339416504  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

first layer input nodes number: 191
first layer output nodes number: 78
edges number: 412
torch.Size([191, 1433])
torch.Size([78, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.17185735702514648  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1718583106994629  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13553667068481445  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

pseudo mini batch 6 input nodes size: 129
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13552236557006836  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13552236557006836  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13621139526367188  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13621187210083008  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351914405822754  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351943016052246  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351943016052246  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

first layer input nodes number: 129
first layer output nodes number: 56
edges number: 212
torch.Size([129, 1433])
torch.Size([56, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1542067527770996  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.15420770645141602  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13520145416259766  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

pseudo mini batch 7 input nodes size: 121
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351914405822754  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351914405822754  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13583755493164062  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13583803176879883  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351485252380371  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13515138626098633  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13515138626098633  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

first layer input nodes number: 121
first layer output nodes number: 57
edges number: 210
torch.Size([121, 1433])
torch.Size([57, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.15404415130615234  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.15404510498046875  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13515806198120117  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

pseudo mini batch 8 input nodes size: 118
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351485252380371  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351485252380371  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13577890396118164  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13577938079833984  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351327896118164  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13513565063476562  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13513565063476562  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

first layer input nodes number: 118
first layer output nodes number: 44
edges number: 157
torch.Size([118, 1433])
torch.Size([44, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.14932918548583984  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.14933013916015625  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13514232635498047  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

pseudo mini batch 9 input nodes size: 223
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351327896118164  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351327896118164  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1366438865661621  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1366443634033203  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13601350784301758  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1360173225402832  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1360173225402832  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

first layer input nodes number: 223
first layer output nodes number: 66
edges number: 363
torch.Size([223, 1433])
torch.Size([66, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.16759061813354492  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.16759157180786133  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13602638244628906  GigaBytes
Max Memory Allocated: 0.2984352111816406  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.2705268859863281  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.2705268859863281  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014812350273132324 |0.03816783428192139 |0.07232556343078614 |0.00013136863708496094 |0.024854469299316406 |0.006392717361450195 |
----------------------------------------------------------pseudo_mini_loss sum 1.945688247680664
Total (block generation + training)time/epoch 1.6638023853302002
Training time/epoch 1.5580871105194092
Training time without block to device /epoch 1.1764087677001953
Training time without total dataloading part /epoch 0.9795067310333252
load block tensor time/epoch 0.14812350273132324
block to device time/epoch 0.38167834281921387
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2475
Number of first layer input nodes during this epoch:  1816
Number of first layer output nodes during this epoch:  659
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.2705264091491699  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007088184356689453
global_2_local spend time (sec) 0.00014090538024902344
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0002932548522949219
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 493, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 8: 3, 10: 3, 25: 2, 12: 2, 11: 1, 21: 1, 19: 1})

A = g.adjacency_matrix() spent  0.0001647472381591797
auxiliary_graph
Graph(num_nodes=633, num_edges=430,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0004506111145019531
remove nodes length  493

auxiliary_graph.remove_nodes spent  0.0015070438385009766
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=430,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0007183551788330078

the counter of shared neighbor distribution
Counter({1.0: 244, 2.0: 30, 3.0: 14, 4.0: 2})
290
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.002984762191772461
14
14
14
14
14
14
14
14
14
14
total k batches seeds list generation spend  0.00818324089050293
after graph partition
graph partition algorithm spend time 0.0538020133972168
14
14
14
14
14
14
14
14
14
14
partition_len_list
[53, 50, 58, 61, 75, 77, 63, 99, 72, 58]
REG selection method  spend 0.05410289764404297
time for parepare:  5.745887756347656e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.9087066650390625e-05
----------------------check_connections_block total spend ----------------------------- 0.0020644664764404297
generate_one_block  0.0023157596588134766
generate_one_block  0.0011513233184814453
generate_one_block  0.0010895729064941406
generate_one_block  0.0010771751403808594
generate_one_block  0.0010447502136230469
generate_one_block  0.0010514259338378906
generate_one_block  0.0010833740234375
generate_one_block  0.0010709762573242188
generate_one_block  0.001035928726196289
generate_one_block  0.0013077259063720703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006794929504394531
gen group dst list time:  6.914138793945312e-05
time for parepare:  0.0001575946807861328
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00012063980102539062
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00010991096496582031
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00013947486877441406
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.000156402587890625
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001571178436279297
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00013208389282226562
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00019311904907226562
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00012969970703125
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00010895729064941406
----------------------check_connections_block total spend ----------------------------- 0.003847360610961914
generate_one_block  0.0011677742004394531
generate_one_block  0.0010979175567626953
generate_one_block  0.0011792182922363281
generate_one_block  0.00116729736328125
generate_one_block  0.0011928081512451172
generate_one_block  0.0012369155883789062
generate_one_block  0.0011456012725830078
generate_one_block  0.0012383460998535156
generate_one_block  0.001245737075805664
generate_one_block  0.0010509490966796875
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.2705264091491699  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

connection checking time:  0.005911827087402344
block generation total time  0.023950576782226562
average batch blocks generation time:  0.0011975288391113282
block dataloader generation time/epoch 0.10024333000183105
pseudo mini batch 0 input nodes size: 178
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.27051305770874023  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.27051305770874023  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.27146339416503906  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.27146387100219727  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.26995229721069336  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.269956111907959  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.269956111907959  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

first layer input nodes number: 178
first layer output nodes number: 53
edges number: 260
torch.Size([178, 1433])
torch.Size([53, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.29273128509521484  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.29273271560668945  GigaBytes
Max Memory Allocated: 0.3642768859863281  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26996517181396484  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

pseudo mini batch 1 input nodes size: 114
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26995325088500977  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26995325088500977  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27056217193603516  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27056264877319336  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26961183547973633  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26961469650268555  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26961469650268555  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

first layer input nodes number: 114
first layer output nodes number: 50
edges number: 177
torch.Size([114, 1433])
torch.Size([50, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2855949401855469  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2855958938598633  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2696213722229004  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

pseudo mini batch 2 input nodes size: 141
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26961183547973633  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26961183547973633  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27036476135253906  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27036523818969727  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26975584030151367  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2697587013244629  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2697587013244629  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

first layer input nodes number: 141
first layer output nodes number: 58
edges number: 254
torch.Size([141, 1433])
torch.Size([58, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2924208641052246  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.292421817779541  GigaBytes
Max Memory Allocated: 0.41575050354003906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26976585388183594  GigaBytes
Max Memory Allocated: 0.4157724380493164  GigaBytes

pseudo mini batch 3 input nodes size: 216
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26975584030151367  GigaBytes
Max Memory Allocated: 0.4157724380493164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26975584030151367  GigaBytes
Max Memory Allocated: 0.4157724380493164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2712669372558594  GigaBytes
Max Memory Allocated: 0.4157724380493164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2712674140930176  GigaBytes
Max Memory Allocated: 0.4157724380493164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4157724380493164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4157724380493164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4157724380493164  GigaBytes

first layer input nodes number: 216
first layer output nodes number: 61
edges number: 344
torch.Size([216, 1433])
torch.Size([61, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.30051374435424805  GigaBytes
Max Memory Allocated: 0.4157724380493164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.30051469802856445  GigaBytes
Max Memory Allocated: 0.4157724380493164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2705264091491699  GigaBytes
Max Memory Allocated: 0.4229140281677246  GigaBytes

pseudo mini batch 4 input nodes size: 240
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4229140281677246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4229140281677246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27179527282714844  GigaBytes
Max Memory Allocated: 0.4229140281677246  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27179574966430664  GigaBytes
Max Memory Allocated: 0.4229140281677246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27028417587280273  GigaBytes
Max Memory Allocated: 0.4229140281677246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27028894424438477  GigaBytes
Max Memory Allocated: 0.4229140281677246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27028894424438477  GigaBytes
Max Memory Allocated: 0.4229140281677246  GigaBytes

first layer input nodes number: 240
first layer output nodes number: 75
edges number: 386
torch.Size([240, 1433])
torch.Size([75, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.30417394638061523  GigaBytes
Max Memory Allocated: 0.4229140281677246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.30417490005493164  GigaBytes
Max Memory Allocated: 0.4229140281677246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27029895782470703  GigaBytes
Max Memory Allocated: 0.42592620849609375  GigaBytes

pseudo mini batch 5 input nodes size: 180
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27028417587280273  GigaBytes
Max Memory Allocated: 0.42592620849609375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27028417587280273  GigaBytes
Max Memory Allocated: 0.42592620849609375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27124547958374023  GigaBytes
Max Memory Allocated: 0.42592620849609375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27124595642089844  GigaBytes
Max Memory Allocated: 0.42592620849609375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26996421813964844  GigaBytes
Max Memory Allocated: 0.42592620849609375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26996898651123047  GigaBytes
Max Memory Allocated: 0.42592620849609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26996898651123047  GigaBytes
Max Memory Allocated: 0.42592620849609375  GigaBytes

first layer input nodes number: 180
first layer output nodes number: 77
edges number: 401
torch.Size([180, 1433])
torch.Size([77, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.30533504486083984  GigaBytes
Max Memory Allocated: 0.42592620849609375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.30533599853515625  GigaBytes
Max Memory Allocated: 0.42592620849609375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26997852325439453  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

pseudo mini batch 6 input nodes size: 163
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26996421813964844  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26996421813964844  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27083444595336914  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27083492279052734  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26987314224243164  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26987695693969727  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26987695693969727  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

first layer input nodes number: 163
first layer output nodes number: 63
edges number: 291
torch.Size([163, 1433])
torch.Size([63, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2955002784729004  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2955012321472168  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2698850631713867  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

pseudo mini batch 7 input nodes size: 270
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26987314224243164  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.26987314224243164  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27138423919677734  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27138471603393555  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27051877975463867  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.27051877975463867  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

first layer input nodes number: 270
first layer output nodes number: 99
edges number: 483
torch.Size([270, 1433])
torch.Size([99, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.3129262924194336  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.31292724609375  GigaBytes
Max Memory Allocated: 0.4271993637084961  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27052927017211914  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

pseudo mini batch 8 input nodes size: 189
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27152299880981445  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27152347564697266  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27001190185546875  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2700157165527344  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2700157165527344  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

first layer input nodes number: 189
first layer output nodes number: 72
edges number: 296
torch.Size([189, 1433])
torch.Size([72, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.29650449752807617  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2965054512023926  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27002429962158203  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

pseudo mini batch 9 input nodes size: 135
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27001190185546875  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27001190185546875  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2707328796386719  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2707333564758301  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.26972389221191406  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2697267532348633  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2697267532348633  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

first layer input nodes number: 135
first layer output nodes number: 58
edges number: 243
torch.Size([135, 1433])
torch.Size([58, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2913484573364258  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2913494110107422  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.26973390579223633  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.26973390579223633  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.26973390579223633  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01519927978515625 |0.00042395591735839845 |0.02512822151184082 |0.00010585784912109375 |0.024490857124328615 |0.00391387939453125 |
----------------------------------------------------------pseudo_mini_loss sum 4.21816349029541
Total (block generation + training)time/epoch 1.2366901636123657
Training time/epoch 0.7141826152801514
Training time without block to device /epoch 0.7099430561065674
Training time without total dataloading part /epoch 0.5011632442474365
load block tensor time/epoch 0.1519927978515625
block to device time/epoch 0.004239559173583984
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2492
Number of first layer input nodes during this epoch:  1826
Number of first layer output nodes during this epoch:  666
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2697334289550781  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000732421875
global_2_local spend time (sec) 0.00012135505676269531
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0002586841583251953
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 489, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 8: 3, 10: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.00016450881958007812
auxiliary_graph
Graph(num_nodes=629, num_edges=432,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0004169940948486328
remove nodes length  489

auxiliary_graph.remove_nodes spent  0.0007545948028564453
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=432,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006811618804931641

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 12, 4.0: 2})
292
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.00292205810546875
14
14
14
14
14
14
14
14
14
14
total k batches seeds list generation spend  0.0071485042572021484
after graph partition
graph partition algorithm spend time 0.12686848640441895
14
14
14
14
14
14
14
14
14
14
partition_len_list
[110, 50, 67, 67, 52, 79, 42, 67, 55, 66]
REG selection method  spend 0.12712931632995605
time for parepare:  5.8650970458984375e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.602836608886719e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.9802322387695312e-05
----------------------check_connections_block total spend ----------------------------- 0.002105236053466797
generate_one_block  0.0016009807586669922
generate_one_block  0.0011026859283447266
generate_one_block  0.0010476112365722656
generate_one_block  0.0010395050048828125
generate_one_block  0.0010344982147216797
generate_one_block  0.0010724067687988281
generate_one_block  0.0010516643524169922
generate_one_block  0.0010426044464111328
generate_one_block  0.0010325908660888672
generate_one_block  0.0009734630584716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005929470062255859
gen group dst list time:  6.461143493652344e-05
time for parepare:  0.00013208389282226562
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00021266937255859375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  8.940696716308594e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00013446807861328125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00014281272888183594
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  9.989738464355469e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001571178436279297
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  9.918212890625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00013136863708496094
----------------------check_connections_block total spend ----------------------------- 0.003692626953125
generate_one_block  0.0015056133270263672
generate_one_block  0.0011210441589355469
generate_one_block  0.001165151596069336
generate_one_block  0.0011925697326660156
generate_one_block  0.0011267662048339844
generate_one_block  0.001196146011352539
generate_one_block  0.0011131763458251953
generate_one_block  0.0011682510375976562
generate_one_block  0.0011150836944580078
generate_one_block  0.00112152099609375
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2697334289550781  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

connection checking time:  0.005797863006591797
block generation total time  0.022823333740234375
average batch blocks generation time:  0.0011411666870117187
block dataloader generation time/epoch 0.12264124552408855
pseudo mini batch 0 input nodes size: 315
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.26972293853759766  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.26972293853759766  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2714047431945801  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2714052200317383  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27068376541137695  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2706894874572754  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2706894874572754  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

first layer input nodes number: 315
first layer output nodes number: 110
edges number: 561
torch.Size([315, 1433])
torch.Size([110, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.3199620246887207  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.3199634552001953  GigaBytes
Max Memory Allocated: 0.4344353675842285  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27070188522338867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 1 input nodes size: 98
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27068471908569336  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27068471908569336  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2712082862854004  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2712087631225586  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26952648162841797  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2695293426513672  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2695293426513672  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 98
first layer output nodes number: 50
edges number: 175
torch.Size([98, 1433])
torch.Size([50, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.28543853759765625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.28543949127197266  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26953601837158203  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 2 input nodes size: 181
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26952648162841797  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26952648162841797  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2704930305480957  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2704935073852539  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26996946334838867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2699732780456543  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2699732780456543  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 181
first layer output nodes number: 67
edges number: 321
torch.Size([181, 1433])
torch.Size([67, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29828977584838867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2982907295227051  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26998186111450195  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 3 input nodes size: 230
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26996946334838867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26996946334838867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2714805603027344  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2714810371398926  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 230
first layer output nodes number: 67
edges number: 352
torch.Size([230, 1433])
torch.Size([67, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.30138111114501953  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.30138206481933594  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705268859863281  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 4 input nodes size: 141
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2712669372558594  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2712674140930176  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26975584030151367  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697587013244629  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697587013244629  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 141
first layer output nodes number: 52
edges number: 238
torch.Size([141, 1433])
torch.Size([52, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2910041809082031  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29100513458251953  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26976585388183594  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 5 input nodes size: 193
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26975584030151367  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26975584030151367  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2712669372558594  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2712674140930176  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051877975463867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051877975463867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 193
first layer output nodes number: 79
edges number: 412
torch.Size([193, 1433])
torch.Size([79, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.306821346282959  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3068222999572754  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27052879333496094  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 6 input nodes size: 129
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27120304107666016  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27120351791381836  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26969194412231445  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26969480514526367  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26969480514526367  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 129
first layer output nodes number: 42
edges number: 173
torch.Size([129, 1433])
torch.Size([42, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2850480079650879  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2850489616394043  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697019577026367  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 7 input nodes size: 209
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26969194412231445  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26969194412231445  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27120304107666016  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27120351791381836  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 209
first layer output nodes number: 67
edges number: 301
torch.Size([209, 1433])
torch.Size([67, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29716062545776367  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2971615791320801  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705268859863281  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 8 input nodes size: 117
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27113866806030273  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27113914489746094  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26962757110595703  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26963043212890625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26963043212890625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 117
first layer output nodes number: 55
edges number: 219
torch.Size([117, 1433])
torch.Size([55, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.28922319412231445  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.28922414779663086  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2696371078491211  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 9 input nodes size: 190
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26962757110595703  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26962757110595703  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27113866806030273  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27113914489746094  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 190
first layer output nodes number: 66
edges number: 321
torch.Size([190, 1433])
torch.Size([66, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29866743087768555  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29866838455200195  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705264091491699  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705264091491699  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705264091491699  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013862037658691406 |0.0004290342330932617 |0.02693159580230713 |0.00010535717010498046 |0.02426760196685791 |0.003958702087402344 |
----------------------------------------------------------pseudo_mini_loss sum 5.467227935791016
Total (block generation + training)time/epoch 1.1190152168273926
Training time/epoch 0.7160818576812744
Training time without block to device /epoch 0.7117915153503418
Training time without total dataloading part /epoch 0.5170042514801025
load block tensor time/epoch 0.13862037658691406
block to device time/epoch 0.004290342330932617
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2458
Number of first layer input nodes during this epoch:  1803
Number of first layer output nodes during this epoch:  655
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705259323120117  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006709098815917969
global_2_local spend time (sec) 0.00012826919555664062
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00026988983154296875
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 489, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 8: 3, 10: 3, 25: 2, 12: 2, 21: 1, 11: 1, 19: 1})

A = g.adjacency_matrix() spent  0.00014662742614746094
auxiliary_graph
Graph(num_nodes=629, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0004055500030517578
remove nodes length  489

auxiliary_graph.remove_nodes spent  0.0008389949798583984
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0007305145263671875

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 14, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0032062530517578125
14
14
14
14
14
14
14
14
14
14
total k batches seeds list generation spend  0.007637739181518555
after graph partition
graph partition algorithm spend time 0.06369495391845703
14
14
14
14
14
14
14
14
14
14
partition_len_list
[66, 59, 98, 62, 77, 81, 48, 58, 54, 61]
REG selection method  spend 0.06400656700134277
time for parepare:  6.866455078125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.956390380859375e-05
----------------------check_connections_block total spend ----------------------------- 0.0022225379943847656
generate_one_block  0.002069234848022461
generate_one_block  0.0011830329895019531
generate_one_block  0.0011625289916992188
generate_one_block  0.001100778579711914
generate_one_block  0.0011072158813476562
generate_one_block  0.005491495132446289
generate_one_block  0.0010952949523925781
generate_one_block  0.001001119613647461
generate_one_block  0.0009815692901611328
generate_one_block  0.0010602474212646484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006556510925292969
gen group dst list time:  7.367134094238281e-05
time for parepare:  0.0001304149627685547
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001404285430908203
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00014090538024902344
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00020885467529296875
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00016546249389648438
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00016570091247558594
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00010585784912109375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  9.822845458984375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010609626770019531
----------------------check_connections_block total spend ----------------------------- 0.003885030746459961
generate_one_block  0.0017170906066894531
generate_one_block  0.001218557357788086
generate_one_block  0.0013048648834228516
generate_one_block  0.001216888427734375
generate_one_block  0.0012226104736328125
generate_one_block  0.0012443065643310547
generate_one_block  0.0011429786682128906
generate_one_block  0.0011701583862304688
generate_one_block  0.0011322498321533203
generate_one_block  0.001039266586303711
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705259323120117  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

connection checking time:  0.0061075687408447266
block generation total time  0.028661489486694336
average batch blocks generation time:  0.0014330744743347168
block dataloader generation time/epoch 0.11968761682510376
pseudo mini batch 0 input nodes size: 190
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051305770874023  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051305770874023  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2715277671813965  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2715282440185547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2700166702270508  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2700204849243164  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2700204849243164  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 190
first layer output nodes number: 66
edges number: 307
torch.Size([190, 1433])
torch.Size([66, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2970700263977051  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2970714569091797  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27003002166748047  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 1 input nodes size: 203
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2700176239013672  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2700176239013672  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2715287208557129  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2715291976928711  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 203
first layer output nodes number: 59
edges number: 306
torch.Size([203, 1433])
torch.Size([59, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2971940040588379  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2971949577331543  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705264091491699  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 2 input nodes size: 289
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27205705642700195  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27205753326416016  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27054595947265625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705516815185547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705516815185547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 289
first layer output nodes number: 98
edges number: 534
torch.Size([289, 1433])
torch.Size([98, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3176765441894531  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.31767749786376953  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27056312561035156  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 3 input nodes size: 206
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27054595947265625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27054595947265625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27205705642700195  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27205753326416016  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 206
first layer output nodes number: 62
edges number: 334
torch.Size([206, 1433])
torch.Size([62, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2996950149536133  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2996959686279297  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705264091491699  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 4 input nodes size: 209
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27162981033325195  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27163028717041016  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27011871337890625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2701225280761719  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2701225280761719  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 209
first layer output nodes number: 77
edges number: 353
torch.Size([209, 1433])
torch.Size([77, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.301422119140625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3014230728149414  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27013158798217773  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 5 input nodes size: 210
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27011871337890625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27011871337890625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27162981033325195  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27163028717041016  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051877975463867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051877975463867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 210
first layer output nodes number: 81
edges number: 413
torch.Size([210, 1433])
torch.Size([81, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3069882392883301  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3069891929626465  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27052879333496094  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 6 input nodes size: 127
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2711920738220215  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2711925506591797  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2696809768676758  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.269683837890625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.269683837890625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 127
first layer output nodes number: 48
edges number: 180
torch.Size([127, 1433])
torch.Size([48, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.28586864471435547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2858695983886719  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26969051361083984  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 7 input nodes size: 136
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2696809768676758  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2696809768676758  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27040719985961914  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27040767669677734  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697291374206543  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697319984436035  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697319984436035  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 136
first layer output nodes number: 58
edges number: 244
torch.Size([136, 1433])
torch.Size([58, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2916703224182129  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2916712760925293  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26973915100097656  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 8 input nodes size: 118
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697291374206543  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697291374206543  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27035951614379883  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27035999298095703  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26963329315185547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2696361541748047  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2696361541748047  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 118
first layer output nodes number: 54
edges number: 216
torch.Size([118, 1433])
torch.Size([54, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.28892993927001953  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.28893089294433594  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26964282989501953  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 9 input nodes size: 131
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26963329315185547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26963329315185547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27033281326293945  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27033329010009766  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697024345397949  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26970529556274414  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26970529556274414  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 131
first layer output nodes number: 61
edges number: 228
torch.Size([131, 1433])
torch.Size([61, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29019880294799805  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29019975662231445  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697124481201172  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697124481201172  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697124481201172  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014197230339050293 |0.0004370450973510742 |0.025830531120300294 |0.00011179447174072265 |0.025366330146789552 |0.004083156585693359 |
----------------------------------------------------------pseudo_mini_loss sum 8.262628555297852
Total (block generation + training)time/epoch 1.0455888509750366
Training time/epoch 0.7143161296844482
Training time without block to device /epoch 0.7099456787109375
Training time without total dataloading part /epoch 0.517169713973999
load block tensor time/epoch 0.14197230339050293
block to device time/epoch 0.004370450973510742
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  2483
Number of first layer input nodes during this epoch:  1819
Number of first layer output nodes during this epoch:  664
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.269711971282959  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008311271667480469
global_2_local spend time (sec) 0.0001628398895263672
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0003421306610107422
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 490, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 10: 3, 8: 3, 25: 2, 12: 2, 21: 1, 11: 1, 19: 1})

A = g.adjacency_matrix() spent  0.00017261505126953125
auxiliary_graph
Graph(num_nodes=630, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0005359649658203125
remove nodes length  490

auxiliary_graph.remove_nodes spent  0.0012362003326416016
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006897449493408203

the counter of shared neighbor distribution
Counter({1.0: 250, 2.0: 30, 3.0: 12, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0030059814453125
14
14
14
14
14
14
14
14
14
14
total k batches seeds list generation spend  0.008209466934204102
after graph partition
graph partition algorithm spend time 0.04387712478637695
14
14
14
14
14
14
14
14
14
14
partition_len_list
[89, 57, 55, 63, 71, 77, 55, 55, 80, 75]
REG selection method  spend 0.04425382614135742
time for parepare:  9.083747863769531e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.887580871582031e-05
----------------------check_connections_block total spend ----------------------------- 0.0031020641326904297
generate_one_block  0.003129720687866211
generate_one_block  0.0014986991882324219
generate_one_block  0.0014190673828125
generate_one_block  0.0010461807250976562
generate_one_block  0.0010623931884765625
generate_one_block  0.0010647773742675781
generate_one_block  0.0010004043579101562
generate_one_block  0.0009975433349609375
generate_one_block  0.0010204315185546875
generate_one_block  0.001020193099975586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006878376007080078
gen group dst list time:  6.651878356933594e-05
time for parepare:  0.00014400482177734375
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00016808509826660156
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00010800361633300781
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00015664100646972656
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00010895729064941406
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00010561943054199219
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00019598007202148438
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00015425682067871094
----------------------check_connections_block total spend ----------------------------- 0.0038902759552001953
generate_one_block  0.0014007091522216797
generate_one_block  0.0011751651763916016
generate_one_block  0.001138925552368164
generate_one_block  0.0011782646179199219
generate_one_block  0.0011649131774902344
generate_one_block  0.0012166500091552734
generate_one_block  0.0011518001556396484
generate_one_block  0.001149892807006836
generate_one_block  0.0012493133544921875
generate_one_block  0.001209259033203125
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.269711971282959  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

connection checking time:  0.006992340087890625
block generation total time  0.02529430389404297
average batch blocks generation time:  0.0012647151947021485
block dataloader generation time/epoch 0.11368122100830078
pseudo mini batch 0 input nodes size: 231
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697014808654785  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697014808654785  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2712125778198242  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2712130546569824  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051305770874023  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 231
first layer output nodes number: 89
edges number: 407
torch.Size([231, 1433])
torch.Size([89, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.306577205657959  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3065786361694336  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27052879333496094  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 1 input nodes size: 177
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27145910263061523  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27145957946777344  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26994800567626953  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26995182037353516  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26995182037353516  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 177
first layer output nodes number: 57
edges number: 290
torch.Size([177, 1433])
torch.Size([57, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29532718658447266  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29532814025878906  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2699599266052246  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 2 input nodes size: 145
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26994800567626953  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26994800567626953  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2707223892211914  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2707228660583496  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697772979736328  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26978015899658203  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26978015899658203  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 145
first layer output nodes number: 55
edges number: 230
torch.Size([145, 1433])
torch.Size([55, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2902054786682129  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2902064323425293  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697873115539551  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 3 input nodes size: 190
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697772979736328  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697772979736328  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2712883949279785  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2712888717651367  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051782608032227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 190
first layer output nodes number: 63
edges number: 273
torch.Size([190, 1433])
torch.Size([63, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2947072982788086  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.294708251953125  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705259323120117  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 4 input nodes size: 157
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27135229110717773  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27135276794433594  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26984119415283203  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26984500885009766  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26984500885009766  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 157
first layer output nodes number: 71
edges number: 285
torch.Size([157, 1433])
torch.Size([71, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2953042984008789  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2953052520751953  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2698535919189453  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 5 input nodes size: 188
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26984119415283203  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26984119415283203  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27135229110717773  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27135276794433594  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051877975463867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051877975463867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 188
first layer output nodes number: 77
edges number: 399
torch.Size([188, 1433])
torch.Size([77, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3057069778442383  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3057079315185547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27052831649780273  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 6 input nodes size: 161
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2713737487792969  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2713742256164551  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26986265182495117  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2698655128479004  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2698655128479004  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 161
first layer output nodes number: 55
edges number: 242
torch.Size([161, 1433])
torch.Size([55, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29127073287963867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2912716865539551  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26987266540527344  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 7 input nodes size: 144
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26986265182495117  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26986265182495117  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2706317901611328  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.270632266998291  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697720527648926  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697749137878418  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697749137878418  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 144
first layer output nodes number: 55
edges number: 238
torch.Size([144, 1433])
torch.Size([55, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2909426689147949  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29094362258911133  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26978206634521484  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 8 input nodes size: 270
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697720527648926  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2697720527648926  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2712831497192383  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2712836265563965  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051877975463867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051877975463867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 270
first layer output nodes number: 80
edges number: 468
torch.Size([270, 1433])
torch.Size([80, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.31116485595703125  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.31116580963134766  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27052927017211914  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 9 input nodes size: 241
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2718009948730469  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2718014717102051  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27028989791870117  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2702937126159668  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2702937126159668  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 241
first layer output nodes number: 75
edges number: 365
torch.Size([241, 1433])
torch.Size([75, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.30244874954223633  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.30244970321655273  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27030277252197266  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27030277252197266  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27030277252197266  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015018939971923828 |0.00045623779296875 |0.02474977970123291 |9.9945068359375e-05 |0.021402740478515626 |0.0039212703704833984 |
----------------------------------------------------------pseudo_mini_loss sum 6.975220203399658
Total (block generation + training)time/epoch 0.9901965141296387
Training time/epoch 0.6788263320922852
Training time without block to device /epoch 0.6742639541625977
Training time without total dataloading part /epoch 0.4664459228515625
load block tensor time/epoch 0.15018939971923828
block to device time/epoch 0.0045623779296875
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  2581
Number of first layer input nodes during this epoch:  1904
Number of first layer output nodes during this epoch:  677
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27030229568481445  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006153583526611328
global_2_local spend time (sec) 0.0001251697540283203
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00026106834411621094
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 491, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 10: 3, 8: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.00013875961303710938
auxiliary_graph
Graph(num_nodes=631, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.00040221214294433594
remove nodes length  491

auxiliary_graph.remove_nodes spent  0.0007569789886474609
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006833076477050781

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 14, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.003101825714111328
14
14
14
14
14
14
14
14
14
14
total k batches seeds list generation spend  0.007218599319458008
after graph partition
graph partition algorithm spend time 0.04215574264526367
14
14
14
14
14
14
14
14
14
14
partition_len_list
[65, 62, 84, 63, 98, 77, 52, 55, 64, 52]
REG selection method  spend 0.04244256019592285
time for parepare:  6.937980651855469e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.8848648071289062e-05
----------------------check_connections_block total spend ----------------------------- 0.002438783645629883
generate_one_block  0.0015530586242675781
generate_one_block  0.0012586116790771484
generate_one_block  0.0012662410736083984
generate_one_block  0.001251220703125
generate_one_block  0.0012691020965576172
generate_one_block  0.0012700557708740234
generate_one_block  0.001230478286743164
generate_one_block  0.0010597705841064453
generate_one_block  0.0010499954223632812
generate_one_block  0.0010406970977783203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006003379821777344
gen group dst list time:  8.440017700195312e-05
time for parepare:  0.00014734268188476562
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0001494884490966797
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00014209747314453125
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.000194549560546875
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00017404556274414062
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00025582313537597656
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00018906593322753906
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00011610984802246094
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.000133514404296875
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00013566017150878906
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00010800361633300781
----------------------check_connections_block total spend ----------------------------- 0.004395484924316406
generate_one_block  0.0015535354614257812
generate_one_block  0.0013854503631591797
generate_one_block  0.0014495849609375
generate_one_block  0.0014195442199707031
generate_one_block  0.0015060901641845703
generate_one_block  0.0014414787292480469
generate_one_block  0.001163482666015625
generate_one_block  0.0011529922485351562
generate_one_block  0.001093149185180664
generate_one_block  0.001117706298828125
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27030229568481445  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

connection checking time:  0.006834268569946289
block generation total time  0.025532245635986328
average batch blocks generation time:  0.0012766122817993164
block dataloader generation time/epoch 0.10904121398925781
pseudo mini batch 0 input nodes size: 185
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27028894424438477  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27028894424438477  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27180004119873047  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27180051803588867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051305770874023  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051687240600586  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051687240600586  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 185
first layer output nodes number: 65
edges number: 289
torch.Size([185, 1433])
torch.Size([65, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2960691452026367  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29607057571411133  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705264091491699  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 1 input nodes size: 155
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27134180068969727  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27134227752685547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26983070373535156  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2698345184326172  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2698345184326172  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 155
first layer output nodes number: 62
edges number: 280
torch.Size([155, 1433])
torch.Size([62, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29456472396850586  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29456567764282227  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26984262466430664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 2 input nodes size: 248
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26983070373535156  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26983070373535156  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27134180068969727  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27134227752685547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051877975463867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051877975463867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 248
first layer output nodes number: 84
edges number: 410
torch.Size([248, 1433])
torch.Size([84, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3065452575683594  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3065462112426758  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27052879333496094  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 3 input nodes size: 216
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27051401138305664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27166748046875  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2716679573059082  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2701563835144043  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2701601982116699  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2701601982116699  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 216
first layer output nodes number: 63
edges number: 341
torch.Size([216, 1433])
torch.Size([63, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29999303817749023  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29999399185180664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2701687812805176  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 4 input nodes size: 289
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2701563835144043  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2701563835144043  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2716994285583496  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2716999053955078  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27054595947265625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705516815185547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2705516815185547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 289
first layer output nodes number: 98
edges number: 530
torch.Size([289, 1433])
torch.Size([98, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3169407844543457  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3169417381286621  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27056312561035156  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 5 input nodes size: 203
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27054595947265625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27054595947265625  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2716994285583496  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2716999053955078  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2701563835144043  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27016115188598633  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.27016115188598633  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 203
first layer output nodes number: 77
edges number: 395
torch.Size([203, 1433])
torch.Size([77, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.30497169494628906  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.30497264862060547  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2701711654663086  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 6 input nodes size: 149
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2701563835144043  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2701563835144043  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2709522247314453  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2709527015686035  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26979875564575195  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26980161666870117  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26980161666870117  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 149
first layer output nodes number: 52
edges number: 215
torch.Size([149, 1433])
torch.Size([52, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2889571189880371  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2889580726623535  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2698087692260742  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 7 input nodes size: 181
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26979875564575195  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26979875564575195  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2707653045654297  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2707657814025879  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26996946334838867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2699723243713379  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2699723243713379  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 181
first layer output nodes number: 55
edges number: 253
torch.Size([181, 1433])
torch.Size([55, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2922549247741699  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.29225587844848633  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26997947692871094  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 8 input nodes size: 155
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26996946334838867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26996946334838867  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2707972526550293  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2707977294921875  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26983070373535156  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2698345184326172  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2698345184326172  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 155
first layer output nodes number: 64
edges number: 268
torch.Size([155, 1433])
torch.Size([64, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2938389778137207  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2938399314880371  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26984262466430664  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

pseudo mini batch 9 input nodes size: 116
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26983070373535156  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26983070373535156  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2704501152038574  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2704505920410156  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2696223258972168  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.269625186920166  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.269625186920166  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

first layer input nodes number: 116
first layer output nodes number: 52
edges number: 188
torch.Size([116, 1433])
torch.Size([52, 256])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2865900993347168  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2865910530090332  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26963186264038086  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26963186264038086  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.26963186264038086  GigaBytes
Max Memory Allocated: 0.4402942657470703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015014553070068359 |0.00043523311614990234 |0.02477843761444092 |0.00010035037994384765 |0.023723292350769042 |0.0038814544677734375 |
----------------------------------------------------------pseudo_mini_loss sum 5.493153095245361
Total (block generation + training)time/epoch 0.9559206167856852
Training time/epoch 0.6985583305358887
Training time without block to device /epoch 0.6942059993743896
Training time without total dataloading part /epoch 0.4899022579193115
load block tensor time/epoch 0.1501455307006836
block to device time/epoch 0.0043523311614990234
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  2569
Number of first layer input nodes during this epoch:  1897
Number of first layer output nodes during this epoch:  672
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  17702992
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([256, 1433])
layers.0.fc_neigh.weight, torch.Size([256, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([7, 256])
layers.1.fc_neigh.weight, torch.Size([7, 256])
----------------------------------------
un-trainable parameters
