main start at this time 1656400754.813271
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.6066102981567383  GigaBytes
Max Memory Allocated: 0.6066102981567383  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.6066102981567383  GigaBytes
Max Memory Allocated: 0.6066102981567383  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.6066102981567383  GigaBytes
Max Memory Allocated: 0.6066102981567383  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0031404495239257812
pseudo mini batch 0 input nodes size: 1368
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.6066102981567383  GigaBytes
Max Memory Allocated: 0.6066102981567383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.6066102981567383  GigaBytes
Max Memory Allocated: 0.6066102981567383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.6139135360717773  GigaBytes
Max Memory Allocated: 0.6139135360717773  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.613914966583252  GigaBytes
Max Memory Allocated: 0.613914966583252  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.613914966583252  GigaBytes
Max Memory Allocated: 0.613914966583252  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.6139416694641113  GigaBytes
Max Memory Allocated: 0.6139416694641113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.6139416694641113  GigaBytes
Max Memory Allocated: 0.6139416694641113  GigaBytes

first layer input nodes number: 1368
first layer output nodes number: 628
edges number: 2928
torch.Size([1368, 1433])
torch.Size([628, 4096])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 1.0407218933105469  GigaBytes
Max Memory Allocated: 1.0544791221618652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 1.040726661682129  GigaBytes
Max Memory Allocated: 1.0544791221618652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.2193083763122559  GigaBytes
Max Memory Allocated: 2.030799388885498  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.430732250213623  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.430732250213623  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008025884628295898 |0.3373880386352539 |0.6262321472167969 |0.0002734661102294922 |0.5101838111877441 |0.04729628562927246 |
----------------------------------------------------------pseudo_mini_loss sum 1.9450273513793945
Total (block generation + training)time/epoch 1.7212247848510742
Training time/epoch 1.7176423072814941
Training time without block to device /epoch 1.3802542686462402
Training time without total dataloading part /epoch 1.183985710144043
load block tensor time/epoch 0.008025884628295898
block to device time/epoch 0.3373880386352539
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1996
Number of first layer input nodes during this epoch:  1368
Number of first layer output nodes during this epoch:  628
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.430731773376465  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.430731773376465  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.002608180046081543
pseudo mini batch 0 input nodes size: 1368
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.430652141571045  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.430652141571045  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.437955379486084  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.4379568099975586  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.430652141571045  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.4306788444519043  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.4306788444519043  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

first layer input nodes number: 1368
first layer output nodes number: 633
edges number: 2935
torch.Size([1368, 1433])
torch.Size([633, 4096])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.858552932739258  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 2.85855770111084  GigaBytes
Max Memory Allocated: 3.180732250213623  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430732250213623  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430732250213623  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430732250213623  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004454851150512695 |0.0003459453582763672 |0.14614200592041016 |0.00013875961303710938 |0.513207197189331 |0.037430524826049805 |
----------------------------------------------------------pseudo_mini_loss sum 30.075000762939453
Total (block generation + training)time/epoch 1.310109257698059
Training time/epoch 0.8968288898468018
Training time without block to device /epoch 0.8964829444885254
Training time without total dataloading part /epoch 0.6969184875488281
load block tensor time/epoch 0.004454851150512695
block to device time/epoch 0.0003459453582763672
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2001
Number of first layer input nodes during this epoch:  1368
Number of first layer output nodes during this epoch:  633
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430731773376465  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430731773376465  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0024051666259765625
pseudo mini batch 0 input nodes size: 1368
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430652141571045  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430652141571045  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.437955379486084  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4379568099975586  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430652141571045  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306788444519043  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306788444519043  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

first layer input nodes number: 1368
first layer output nodes number: 629
edges number: 2919
torch.Size([1368, 1433])
torch.Size([629, 4096])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.8574771881103516  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.8574819564819336  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430732250213623  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430732250213623  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430732250213623  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003627777099609375 |0.0003409385681152344 |0.14938020706176758 |0.00012922286987304688 |0.51230788230896 |0.0372767448425293 |
----------------------------------------------------------pseudo_mini_loss sum 20.787973403930664
Total (block generation + training)time/epoch 1.1738492647806804
Training time/epoch 0.8992455005645752
Training time without block to device /epoch 0.89890456199646
Training time without total dataloading part /epoch 0.6990940570831299
load block tensor time/epoch 0.003627777099609375
block to device time/epoch 0.0003409385681152344
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1997
Number of first layer input nodes during this epoch:  1368
Number of first layer output nodes during this epoch:  629
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430731773376465  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430731773376465  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.002355813980102539
pseudo mini batch 0 input nodes size: 1355
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430652141571045  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430652141571045  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4378857612609863  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.437887191772461  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4305825233459473  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306092262268066  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306092262268066  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

first layer input nodes number: 1355
first layer output nodes number: 629
edges number: 2917
torch.Size([1355, 1433])
torch.Size([629, 4096])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.8577966690063477  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.8578014373779297  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306626319885254  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306626319885254  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306626319885254  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008336782455444336 |0.0003733634948730469 |0.14798617362976074 |0.0001342296600341797 |0.5126817226409912 |0.0364687442779541 |
----------------------------------------------------------pseudo_mini_loss sum 40.58345031738281
Total (block generation + training)time/epoch 1.1066445708274841
Training time/epoch 0.9027221202850342
Training time without block to device /epoch 0.9023487567901611
Training time without total dataloading part /epoch 0.6972708702087402
load block tensor time/epoch 0.008336782455444336
block to device time/epoch 0.0003733634948730469
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1984
Number of first layer input nodes during this epoch:  1355
Number of first layer output nodes during this epoch:  629
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430662155151367  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430662155151367  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.002426338195800781
pseudo mini batch 0 input nodes size: 1367
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4305825233459473  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4305825233459473  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4378857612609863  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.437887191772461  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430652141571045  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306788444519043  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306788444519043  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

first layer input nodes number: 1367
first layer output nodes number: 630
edges number: 2922
torch.Size([1367, 1433])
torch.Size([630, 4096])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.8581137657165527  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.8581185340881348  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430732250213623  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430732250213623  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430732250213623  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005172014236450195 |0.0004787445068359375 |0.14715218544006348 |0.0001544952392578125 |0.5124382972717285 |0.037447452545166016 |
----------------------------------------------------------pseudo_mini_loss sum 28.774091720581055
Total (block generation + training)time/epoch 1.065735673904419
Training time/epoch 0.8992421627044678
Training time without block to device /epoch 0.8987634181976318
Training time without total dataloading part /epoch 0.6971924304962158
load block tensor time/epoch 0.005172014236450195
block to device time/epoch 0.0004787445068359375
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1997
Number of first layer input nodes during this epoch:  1367
Number of first layer output nodes during this epoch:  630
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430731773376465  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430731773376465  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0023819605509440103
pseudo mini batch 0 input nodes size: 1358
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430652141571045  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430652141571045  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4379019737243652  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.43790340423584  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.430598735809326  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306254386901855  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306254386901855  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

first layer input nodes number: 1358
first layer output nodes number: 631
edges number: 2929
torch.Size([1358, 1433])
torch.Size([631, 4096])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.858419418334961  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.858424186706543  GigaBytes
Max Memory Allocated: 3.848203182220459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306788444519043  GigaBytes
Max Memory Allocated: 3.8482375144958496  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306788444519043  GigaBytes
Max Memory Allocated: 3.8482375144958496  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 2.4306788444519043  GigaBytes
Max Memory Allocated: 3.8482375144958496  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004031658172607422 |0.0003566741943359375 |0.14641714096069336 |0.00017404556274414062 |0.5123279094696045 |0.0376734733581543 |
----------------------------------------------------------pseudo_mini_loss sum 78.38851928710938
Total (block generation + training)time/epoch 1.037933588027954
Training time/epoch 0.8966798782348633
Training time without block to device /epoch 0.8963232040405273
Training time without total dataloading part /epoch 0.6965925693511963
load block tensor time/epoch 0.004031658172607422
block to device time/epoch 0.0003566741943359375
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  1989
Number of first layer input nodes during this epoch:  1358
Number of first layer output nodes during this epoch:  631
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=4096, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=4096, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(4096, 4096, batch_first=True)
      (fc_self): Linear(in_features=4096, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=4096, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  162486352
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([4096, 1433])
layers.0.fc_neigh.weight, torch.Size([4096, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([16384, 4096])
layers.1.lstm.weight_hh_l0, torch.Size([16384, 4096])
layers.1.lstm.bias_ih_l0, torch.Size([16384])
layers.1.lstm.bias_hh_l0, torch.Size([16384])
layers.1.fc_self.weight, torch.Size([7, 4096])
layers.1.fc_neigh.weight, torch.Size([7, 4096])
----------------------------------------
un-trainable parameters
