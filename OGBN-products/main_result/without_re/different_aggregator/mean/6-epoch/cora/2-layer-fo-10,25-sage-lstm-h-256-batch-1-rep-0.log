main start at this time 1656400593.6877205
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.00286865234375
pseudo mini batch 0 input nodes size: 1368
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0745534896850586  GigaBytes
Max Memory Allocated: 0.0745534896850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0745549201965332  GigaBytes
Max Memory Allocated: 0.0745549201965332  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0745549201965332  GigaBytes
Max Memory Allocated: 0.0745549201965332  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.07458162307739258  GigaBytes
Max Memory Allocated: 0.07458162307739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.07458162307739258  GigaBytes
Max Memory Allocated: 0.07458162307739258  GigaBytes

first layer input nodes number: 1368
first layer output nodes number: 628
edges number: 2928
torch.Size([1368, 1433])
torch.Size([628, 256])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5447998046875 GB
    Memory Allocated: 0.3380422592163086  GigaBytes
Max Memory Allocated: 0.3496255874633789  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5447998046875 GB
    Memory Allocated: 0.3380470275878906  GigaBytes
Max Memory Allocated: 0.3496255874633789  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.14250850677490234  GigaBytes
Max Memory Allocated: 0.4454479217529297  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2770090103149414  GigaBytes
Max Memory Allocated: 0.4454479217529297  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2770090103149414  GigaBytes
Max Memory Allocated: 0.4454479217529297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008217573165893555 |0.359102725982666 |0.5457625389099121 |0.00022339820861816406 |0.05001258850097656 |0.007340431213378906 |
----------------------------------------------------------pseudo_mini_loss sum 1.9465960264205933
Total (block generation + training)time/epoch 1.001664400100708
Training time/epoch 0.9985208511352539
Training time without block to device /epoch 0.6394181251525879
Training time without total dataloading part /epoch 0.6033389568328857
load block tensor time/epoch 0.008217573165893555
block to device time/epoch 0.359102725982666
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1996
Number of first layer input nodes during this epoch:  1368
Number of first layer output nodes during this epoch:  628
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2770085334777832  GigaBytes
Max Memory Allocated: 0.4454479217529297  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2770085334777832  GigaBytes
Max Memory Allocated: 0.4454479217529297  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0025968551635742188
pseudo mini batch 0 input nodes size: 1368
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2769289016723633  GigaBytes
Max Memory Allocated: 0.4454479217529297  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2769289016723633  GigaBytes
Max Memory Allocated: 0.4454479217529297  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.28423213958740234  GigaBytes
Max Memory Allocated: 0.4454479217529297  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.28423357009887695  GigaBytes
Max Memory Allocated: 0.4454479217529297  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2769289016723633  GigaBytes
Max Memory Allocated: 0.4454479217529297  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.27695560455322266  GigaBytes
Max Memory Allocated: 0.4454479217529297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.27695560455322266  GigaBytes
Max Memory Allocated: 0.4454479217529297  GigaBytes

first layer input nodes number: 1368
first layer output nodes number: 633
edges number: 2935
torch.Size([1368, 1433])
torch.Size([633, 256])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.5414175987243652  GigaBytes
Max Memory Allocated: 0.5530853271484375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.5414223670959473  GigaBytes
Max Memory Allocated: 0.5530853271484375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2770090103149414  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2770090103149414  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2770090103149414  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00477147102355957 |0.0003533363342285156 |0.04718613624572754 |0.0001270771026611328 |0.0390164852142334 |0.0023043155670166016 |
----------------------------------------------------------pseudo_mini_loss sum 4.879343509674072
Total (block generation + training)time/epoch 0.565672755241394
Training time/epoch 0.12726116180419922
Training time without block to device /epoch 0.1269078254699707
Training time without total dataloading part /epoch 0.08863401412963867
load block tensor time/epoch 0.00477147102355957
block to device time/epoch 0.0003533363342285156
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2001
Number of first layer input nodes during this epoch:  1368
Number of first layer output nodes during this epoch:  633
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2770085334777832  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2770085334777832  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.002396106719970703
pseudo mini batch 0 input nodes size: 1368
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2769289016723633  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2769289016723633  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.28423213958740234  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.28423357009887695  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2769289016723633  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27695560455322266  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27695560455322266  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

first layer input nodes number: 1368
first layer output nodes number: 629
edges number: 2919
torch.Size([1368, 1433])
torch.Size([629, 256])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.5377359390258789  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.5377407073974609  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2770090103149414  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2770090103149414  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2770090103149414  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003770112991333008 |0.0003254413604736328 |0.045094966888427734 |0.00013327598571777344 |0.0381321907043457 |0.0023889541625976562 |
----------------------------------------------------------pseudo_mini_loss sum 5.656123161315918
Total (block generation + training)time/epoch 0.41784191131591797
Training time/epoch 0.12010383605957031
Training time without block to device /epoch 0.11977839469909668
Training time without total dataloading part /epoch 0.08574938774108887
load block tensor time/epoch 0.003770112991333008
block to device time/epoch 0.0003254413604736328
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1997
Number of first layer input nodes during this epoch:  1368
Number of first layer output nodes during this epoch:  629
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2770085334777832  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2770085334777832  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.00231170654296875
pseudo mini batch 0 input nodes size: 1355
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2769289016723633  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2769289016723633  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2841625213623047  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2841639518737793  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2768592834472656  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.276885986328125  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.276885986328125  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

first layer input nodes number: 1355
first layer output nodes number: 629
edges number: 2917
torch.Size([1355, 1433])
torch.Size([629, 256])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.5385785102844238  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.5385832786560059  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27693939208984375  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27693939208984375  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27693939208984375  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003512144088745117 |0.0003261566162109375 |0.045273542404174805 |0.00012350082397460938 |0.043750762939453125 |0.0024771690368652344 |
----------------------------------------------------------pseudo_mini_loss sum 9.984169960021973
Total (block generation + training)time/epoch 0.345267117023468
Training time/epoch 0.12539887428283691
Training time without block to device /epoch 0.12507271766662598
Training time without total dataloading part /epoch 0.09162497520446777
load block tensor time/epoch 0.003512144088745117
block to device time/epoch 0.0003261566162109375
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1984
Number of first layer input nodes during this epoch:  1355
Number of first layer output nodes during this epoch:  629
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27693891525268555  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27693891525268555  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0022557735443115234
pseudo mini batch 0 input nodes size: 1367
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2768592834472656  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2768592834472656  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.28415679931640625  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.28415822982788086  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27692317962646484  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2769498825073242  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2769498825073242  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

first layer input nodes number: 1367
first layer output nodes number: 630
edges number: 2922
torch.Size([1367, 1433])
torch.Size([630, 256])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.538762092590332  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.5387668609619141  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27700328826904297  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27700328826904297  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27700328826904297  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036880970001220703 |0.0003707408905029297 |0.04578590393066406 |0.0001304149627685547 |0.04349565505981445 |0.002336740493774414 |
----------------------------------------------------------pseudo_mini_loss sum 8.328173637390137
Total (block generation + training)time/epoch 0.30188789367675783
Training time/epoch 0.1262528896331787
Training time without block to device /epoch 0.12588214874267578
Training time without total dataloading part /epoch 0.09174871444702148
load block tensor time/epoch 0.0036880970001220703
block to device time/epoch 0.0003707408905029297
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1997
Number of first layer input nodes during this epoch:  1367
Number of first layer output nodes during this epoch:  630
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27700281143188477  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27700281143188477  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0022385120391845703
pseudo mini batch 0 input nodes size: 1358
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27692317962646484  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27692317962646484  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.28417301177978516  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.28417444229125977  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27687549591064453  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2769021987915039  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.2769021987915039  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

first layer input nodes number: 1358
first layer output nodes number: 631
edges number: 2929
torch.Size([1358, 1433])
torch.Size([631, 256])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.5394997596740723  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.5395045280456543  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27695560455322266  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27695560455322266  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.27695560455322266  GigaBytes
Max Memory Allocated: 0.6440792083740234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004160404205322266 |0.00033545494079589844 |0.045105934143066406 |0.00015115737915039062 |0.0439152717590332 |0.0038957595825195312 |
----------------------------------------------------------pseudo_mini_loss sum 3.2370200157165527
Total (block generation + training)time/epoch 0.27375177542368573
Training time/epoch 0.1308298110961914
Training time without block to device /epoch 0.1304943561553955
Training time without total dataloading part /epoch 0.09306812286376953
load block tensor time/epoch 0.004160404205322266
block to device time/epoch 0.00033545494079589844
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  1989
Number of first layer input nodes during this epoch:  1358
Number of first layer output nodes during this epoch:  631
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  17702992
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([256, 1433])
layers.0.fc_neigh.weight, torch.Size([256, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([7, 256])
layers.1.fc_neigh.weight, torch.Size([7, 256])
----------------------------------------
un-trainable parameters
